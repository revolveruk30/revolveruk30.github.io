<html>
<title>Detection Rules</title>
<meta name="robots" content="noindex,nofollow" />
<link rel="stylesheet" href="w2.css">

<head>
<style>
html, body {
background-color: #f0f0f0;
}

.w3-topbar {
width: 100%;
height:5%;
background-color: black;
position: fixed;
top: 1px;
overflow: hidden;
}
#myInput {
background-repeat: no-repeat;
width: 40%;
border: 1px solid #ddd;
margin-left: 300px;
text-align: center;
font-family: "Roboto", sans-serif
}
#keywords {
background-repeat: no-repeat;
width: 28%;
border: 1px solid #ddd;
border: 1px solid #ddd;
margin-bottom: 2px;
margin-left: 300px;
text-align: center;
font-family: "Roboto", sans-serif
}
#myUL {
list-style-type: none;
padding: 0;
text-align: center;
margin-top: 10px;
width: 100%;
}
#myUL li a {
margin-top: -1px;
padding: 8px;
text-decoration: none;
font-size: 14px;
color: black;
display: block
}
}
</style>
</head>
<body>
<!-- Topbar -->
<div class="w3-topbar"></div>
<!-- Sidebar -->
<BR>
<p>
<BR>
<center><H3>Detection Rules</H3></center>
<BR>
<input type="text" id="myInput" onkeyup="myFunction()" placeholder="Filter Paragraph by Keyword" title="Search">
<form method="GET" onsubmit="myHilitor.apply(hilite.value); return false;">
<input type="text" id="keywords" size="20" name="hilite" placeholder="Highlight Multiple Keywords">
<input type="submit" value="Apply">
<input type="button" value="Remove" onclick="myHilitor.remove();">
</span>
</form>
</nav>
<div class="w3-main w3-theme-l5" style="margin-left:100px, margin-right:50px">
<div id="playground">
<center>
<ul id="myUL">
<p>

<li><a href="#">code: ' `wineventlog_system` eventcode=7045 service_file_name = "*\.exe" not (service_file_name in ("c:\\windows\\*", "%windir%\\*", "c:\\program file*", "c:\\programdata\\*", "%systemroot%\\*")) service_type = "user mode service" | stats count min(_time) as firsttime max(_time) as lasttime by eventcode service_file_name service_name service_start_type service_type'
<li><a href="#">code: ((((((eventcode in ["4688", "1"] commandline="*new-item*" commandline="*reg add*" commandline in "*minint*") or (commandline="*stop-service*" commandline="*eventlog*")) or (commandline in ["*set-service*", "*reg add*", "*set-itemproperty*", "*new-itemproperty*", "*sc config*"] commandline in "*eventlog*")) or (commandline in "*auditpol*" commandline in ["*/set*", "*/clear*", "*/revove*"])) or (commandline in "*wevtutil*" commandline in ["*sl*", "*set-log*"]) or eventcode in "4719") or (eventcode in ["4657", "13"] objectname in "*eventlog*" objectvaluename in ["start", "file", "maxsize"]))
<li><a href="#">code: (((((eventcode="4688" or eventcode="1") ((commandline="*reg*" commandline="*add*" commandline="*/d*") or ((commandline="*set-itemproperty*" or commandline="*new-itemproperty*") commandline="*-value*")) commandline="*\\microsoft\\windows nt\\currentversion\\winlogon*" (commandline="*userinit*" or commandline="*shell*" or commandline="*notify*")) or ((eventcode="4657") (objectvaluename="userinit" or objectvaluename="shell" or objectvaluename="notify"))) or ((eventcode="13") (targetobject="*userinit" or targetobject="*shell" or targetobject="*notify"))))
<li><a href="#">code: (((eventcode in ["4688", "1"] ((commandline="*reg*" commandline="*add*" commandline="*/d*") or (commandline in ["*set-itemproperty*", "*new-itemproperty*"] commandline="*-value*")) commandline="*\\microsoft\\windows nt\\currentversion\\winlogon*" commandline in ["*userinit*", "*shell*", "*notify*"]) or (eventcode in "4657" objectvaluename in ["userinit", "shell", "notify"])) or (eventcode in "13" targetobject in ["*userinit", "*shell", "*notify"]))
<li><a href="#">code: (((eventcode in ["4688", "1"] ((commandline="*reg*" commandline="*add*" commandline="*/d*") or (commandline="*set-itemproperty*" commandline="*-value*")) commandline in ["*00000000*", "*0*"] commandline="*safedllsearchmode*") or (eventcode in "4657" objectvaluename="safedllsearchmode" value="0")) or (eventcode in "13" eventtype="setvalue" targetobject="*safedllsearchmode" details="dword (0x00000000)")) data_model: win. eventlog/sysmon native
<li><a href="#">code: (((eventcode:("4688" or "1") and ((process.command_line:*reg* and process.command_line:*add* and process.command_line:*\/d*) or (process.command_line:(*set\-itemproperty* or *new\-itemproperty*) and process.command_line:*\-value*)) and process.command_line:*\\microsoft\\windows\ nt\\currentversion\\winlogon* and process.command_line:(*userinit* or *shell* or *notify*)) or (eventcode:"4657" and winlog.event_data.objectvaluename:("userinit" or "shell" or "notify"))) or (eventcode:"13" and winlog.event_data.targetobject:(*userinit or *shell or *notify)))
<li><a href="#">code: (((eventcode:("4688" or "1") and ((process.command_line:*reg* and process.command_line:*add* and process.command_line:*\/d*) or (process.command_line:*set\-itemproperty* and process.command_line:*\-value*)) and process.command_line:(*00000000* or *0*) and process.command_line:*safedllsearchmode*) or (eventcode:"4657" and winlog.event_data.objectvaluename:"safedllsearchmode" and value:"0")) or (eventcode:"13" and winlog.event_data.event
<li><a href="#">code: (((eventcode="4688" or eventcode="1") (commandline="*reg*" and commandline="*add*" and commandline="*/d*") or (commandline="*set-itemproperty*" and commandline="*-value*") commandline="*common startup*") or ((eventcode="4657" objectvaluename="common startup") or (eventcode="13" targetobject="*common startup")))
<li><a href="#">code: (((eventcode="4688" or eventcode="1") commandline="*schtasks*" (commandline="*/create*" or commandline="*/change*")) ((commandline="*.cmd*" or commandline="*.ps1*" or commandline="*.vbs*" or commandline="*.py*" or commandline="*.js*" or commandline="*.exe*" or commandline="*.bat*") or (commandline="*javascript*" or commandline="*powershell*" or commandline="*wmic*" or commandline="*rundll32*" or commandline="*cmd*" or commandline="*cscript*" or commandline="*wscript*" or commandline="*regsvr32*" or commandline="*mshta*" or commandline="*bitsadmin*" or commandline="*certutil*" or commandline="*msiexec*" or commandline="*javaw*") or (commandline="*%appdata%*" or commandline="*\\appdata\\roaming*" or commandline="*%public%*" or commandline="*c:\\users\\public*" or commandline="*%programdata%*" or commandline="*c:\\programdata*" or commandline="*%temp%*" or commandline="*\\appdata\\local\\temp*" or commandline="*\\windows\\pla\\system*" or commandline="*\\tasks*" or commandline="*\\registration\\crmlog*" or commandline="*\\fxstmp*" or commandline="*\\spool\\drivers\\color*" or commandline="*\\tracing*"))) or ((eventcode="4698" or eventcode="4702") ((taskcontent="*.cmd*" or taskcontent="*.ps1*" or taskcontent="*.vbs*" or taskcontent="*.py*" or taskcontent="*.js*" or taskcontent="*.exe*" or taskcontent="*.bat*") or (taskcontent="*javascript*" or taskcontent="*powershell*" or taskcontent="*wmic*" or taskcontent="*rundll32*" or taskcontent="*cmd*" or taskcontent="*cscript*" or taskcontent="*wscript*" or taskcontent="*regsvr32*" or taskcontent="*mshta*" or taskcontent="*bitsadmin*" or taskcontent="*certutil*" or taskcontent="*msiexec*" or taskcontent="*javaw*") or (taskcontent="*%appdata%*" or taskcontent="*\\appdata\\roaming*" or taskcontent="*%public%*" or taskcontent="*c:\\users\\public*" or taskcontent="*%programdata%*" or taskcontent="*c:\\programdata*" or taskcontent="*%temp%*" or taskcontent="*\\appdata\\local\\temp*" or taskcontent="*\\windows\\pla\\system*" or taskcontent="*\\tasks*" or taskcontent="*\\registration\\crmlog*" or taskcontent="*\\fxstmp*" or taskcontent="*\\spool\\drivers\\color*" or taskcontent="*\\tracing*")))
<li><a href="#">code: ((event_id in ["4688", "1"] commandline="*schtasks*" commandline in ["*/create*", "*/change*"]) (commandline in ["*.cmd*", "*.ps1*", "*.vbs*", "*.py*", "*.js*", "*.exe*", "*.bat*"] or commandline in ["*javascript*", "*powershell*", "*wmic*", "*rundll32*", "*cmd*", "*cscript*", "*wscript*", "*regsvr32*", "*mshta*", "*bitsadmin*", "*certutil*", "*msiexec*", "*javaw*"] or commandline in ["*%appdata%*", "*\\appdata\\roaming*", "*%public%*", "*c:\\users\\public*", "*%programdata%*", "*c:\\programdata*", "*%temp%*", "*\\appdata\\local\\temp*", "*\\windows\\pla\\system*", "*\\tasks*", "*\\registration\\crmlog*", "*\\fxstmp*", "*\\spool\\drivers\\color*", "*\\tracing*"])) or (event_id in ["4698", "4702"] (taskcontent in ["*.cmd*", "*.ps1*", "*.vbs*", "*.py*", "*.js*", "*.exe*", "*.bat*"] or taskcontent in ["*javascript*", "*powershell*", "*wmic*", "*rundll32*", "*cmd*", "*cscript*", "*wscript*", "*regsvr32*", "*mshta*", "*bitsadmin*", "*certutil*", "*msiexec*", "*javaw*"] or taskcontent in ["*%appdata%*", "*\\appdata\\roaming*", "*%public%*", "*c:\\users\\public*", "*%programdata%*", "*c:\\programdata*", "*%temp%*", "*\\appdata\\local\\temp*", "*\\windows\\pla\\system*", "*\\tasks*", "*\\registration\\crmlog*", "*\\fxstmp*", "*\\spool\\drivers\\color*", "*\\tracing*"]))
<li><a href="#">code: ((eventcode="4688" or eventcode="1") ((commandline="*new-item*" or commandline="*reg add*") commandline="*minint*")or (commandline="*stop-service*" commandline="*eventlog*")or (commandline="*eventlog*" (commandline="*set-service*" or commandline="*reg add*" or commandline="*set-itemproperty*" or commandline="*new-itemproperty*" or commandline="*sc config*")) or (commandline="*auditpol*" (commandline="*/set*" or commandline="*/clear*" or commandline="*/revove*")) or ((commandline="*wevtutil*" (commandline="*sl*" or commandline="*set-log*")))) or (eventcode="4719") or ((eventcode="4657" or eventcode="13") (objectname="*eventlog*") (objectvaluename="start" or objectvaluename="file" or objectvaluename="maxsize"))
<li><a href="#">code: ((eventcode="4688" or eventcode="1") (commandline="*vssadmin* *delete* *shadows*" or commandline="*wmic* *shadowcopy* *delete*" or commandline="*vssadmin* *resize* *shadowstorage*")) or (eventcode="5857" providername="msvss__provider") or (eventcode="5858" operation="*win32_shadowcopy*")
<li><a href="#">code: ((eventlog:"security" and (winlog.event_id:"4688" or winlog.event_id:"1") and ((process.command_line:*reg* and process.command_line:*add* and process.command_line:*\/d*) or (process.command_line:*set\-itemproperty* and process.command_line:*\-value*)) and process.command_line:*common\ startup*) or (winlog.event_id:"4657" and winlog.event_data.objectvaluename:"common\ startup") or (winlog.event_id:"13" and winlog.event_data.targetobject:"*common startup"))
<li><a href="#">code: ((eventlog="security" (event_id="4688" or event_id="1") ((commandline="*reg*" commandline="*add*" commandline="*/d*") or (commandline="*set-itemproperty*" commandline="*-value*")) commandline="*common startup*") or (event_id="4657" objectvaluename="common startup") or (event_id="13" targetobject="*common startup"))
<li><a href="#">code: ((index=__your_sysmon_index__ eventcode=1) or (index=__your_win_syslog_index__ eventcode=4688)) (commandline="*reg* query hklm /f password /t reg_sz /s*" or commandline="reg* query hkcu /f password /t reg_sz /s" or commandline="*get-unattendedinstallfile*" or commandline="*get-webconfig*" or commandline="*get-applicationhost*" or commandline="*get-sitelistpassword*" or commandline="*get-cachedgpppassword*" or commandline="*get-registryautologon*") data_model: sysmon native
<li><a href="#">code: ((winlog.event_id:("4688" or "1") and process.command_line:*schtasks* and process.command_line:(*\/create* or *\/change*)) and (process.command_line:(*.cmd* or *.ps1* or *.vbs* or *.py* or *.js* or *.exe* or *.bat*) or process.command_line:(*javascript* or *powershell* or *wmic* or *rundll32* or *cmd* or *cscript* or *wscript* or *regsvr32* or *mshta* or *bitsadmin* or *certutil* or *msiexec* or *javaw*) or process.command_line:(*%appdata%* or *\\appdata\\roaming* or *%public%* or *c\:\\users\\public* or *%programdata%* or *c\:\\programdata* or *%temp%* or *\\appdata\\local\\temp* or *\\windows\\pla\\system* or *\\tasks* or *\\registration\\crmlog* or *\\fxstmp* or *\\spool\\drivers\\color* or *\\tracing*))) or (winlog.event_id:("4698" or "4702") and (winlog.event_data.taskcontent:(*.cmd* or *.ps1* or *.vbs* or *.py* or *.js* or *.exe* or *.bat*) or winlog.event_data.taskcontent:(*javascript* or *powershell* or *wmic* or *rundll32* or *cmd* or *cscript* or *wscript* or *regsvr32* or *mshta* or *bitsadmin* or *certutil* or *msiexec* or *javaw*) or winlog.event_data.taskcontent:(*%appdata%* or *\\appdata\\roaming* or *%public%* or *c\:\\users\\public* or *%programdata%* or *c\:\\programdata* or *%temp%* or *\\appdata\\local\\temp* or *\\windows\\pla\\system* or *\\tasks* or *\\registration\\crmlog* or *\\fxstmp* or *\\spool\\drivers\\color* or *\\tracing*)))
<li><a href="#">code: ([log_name] == "security" and [event_code] in [1100, 1102, 1104]) or ([log_name] == "system" and [event_code] == 104)
<li><a href="#">code: (eventcode in ["4688", "1"] commandline in ["*vssadmin* *delete* *shadows*", "*wmic* *shadowcopy* *delete*", "*vssadmin* *resize* *shadowstorage*"]) or (eventcode in "5857" providername in "msvss__provider") or (eventcode in "5858" operation in "*win32_shadowcopy*")
<li><a href="#">code: (eventcode:("4688" or "1") and process.command_line:(*vssadmin*\ *delete*\ *shadows* or *wmic*\ *shadowcopy*\ *delete* or *vssadmin*\ *resize*\ *shadowstorage*)) or (eventcode:"5857" and providername:"msvss__provider") or (eventcode:"5858" and operation:*win32_shadowcopy*)
<li><a href="#">code: (index=__your_sysmon_index__ eventcode=1 image="c:\\windows\\system32\\reg.exe" commandline="*add*\\environment*userinitmprlogonscript") or (index=__your_sysmon_index__ (eventcode=12 or eventcode=14 or eventcode=13) targetobject="*\\environment*userinitmprlogonscript") data_model: sysmon native
<li><a href="#">code: (index=__your_sysmon_index__ eventcode=1) ((image="c:\\windows\\system32\\net.exe" and commandline="*delete*") or commandline="*remove-smbshare*" or commandline="*remove-fileshare*") data_model: sysmon native
<li><a href="#">code: (index=__your_sysmon_index__ eventcode=1) (commandline="*rm (get-psreadlineoption).historysavepath*" or commandline="*del (get-psreadlineoption).historysavepath*" or commandline="*set-psreadlineoption â€“historysavestyle savenothing*" or commandline="*remove-item (get-psreadlineoption).historysavepath*" or commandline="del*microsoft\\windows\\powershell\\psreadline\\consolehost_history.txt") data_model: sysmon native
<li><a href="#">code: (index=__your_sysmon_index__ eventcode=1) (image="*tshark.exe" or image="*windump.exe" or (image="*logman.exe" and parentimage!="?" and parentimage!="c:\\program files\\windows event reporting\\core\\eventreporting.agentservice.exe") or image="*tcpdump.exe" or image="*wprui.exe" or image="*wpr.exe") data_model: sysmon native
<li><a href="#">code: (index=__your_sysmon_index__ eventcode=1) (image="c:\\program files (x86)\\microsoft visual studio\\*\\bin\\msbuild.exe" or image="c:\\windows\\microsoft.net\\framework*\\msbuild.exe" or image="c:\\users\\*\\appdata\\roaming\\microsoft\\msxsl.exe") parentimage!="*\\microsoft visual studio*") data_model: sysmon native
<li><a href="#">code: (index=__your_sysmon_index__ eventcode=1) (image="c:\\windows\\syswow64\\hh.exe" or image="c:\\windows\\system32\\hh.exe") data_model: sysmon native
<li><a href="#">code: (index=__your_sysmon_index__ eventcode=1) (image="c:\\windows\\syswow64\\mavinject.exe" or image="c:\\windows\\system32\\mavinject.exe" or commandline="*\injectrunning*") data_model: sysmon native
<li><a href="#">code: (index=__your_sysmon_index__ eventcode=1) (image=c:\\windows\\system32\\spoolsv.exe* or image=c:\\windows\\system32\\conhost.exe) parentimage = "c:\\windows\\system32\\cmd.exe" data_model: sysmon native
<li><a href="#">code: (index=__your_sysmon_index__ eventcode=1) (parentimage="c:\\windows\\system32\\*w3wp.exe" or parentimage="*httpd.exe" or parentimage="*tomcat*.exe" or parentimage="*nginx.exe") (image="c:\\windows\\system32\\cmd.exe or image="c:\\windows\\syswow64\\cmd.exe" or image="c:\\windows\\system32\\*\\powershell.exe or image="c:\\windows\syswow64\\*\powershell.exe or image="c:\\windows\\system32\\net.exe" or image="c:\\windows\\system32\\hostname.exe" or image="c:\\windows\\system32\\whoami.exe" or image="*systeminfo.exe or image="c:\\windows\\system32\\ipconfig.exe") data_model: sysmon native
<li><a href="#">code: (index=__your_sysmon_index__ eventcode=1) and parentimage!="?" and parentimage!="c:\\program files\\splunkuniversalforwarder\\bin\\splunk-regmon.exe" and parentimage!="c:\\program files\\splunkuniversalforwarder\\bin\\splunk-powershell.exe" and ((image="c:\\windows\system32\\smss.exe" and (parentimage!="c:\\windows\\system32\\smss.exe" and parentimage!="system")) or (image="c:\\windows\\system32\\csrss.exe" and (parentimage!="c:\\windows\\system32\\smss.exe" and parentimage!="c:\\windows\\system32\\svchost.exe")) or (image="c:\\windows\\system32\\wininit.exe" and parentimage!="c:\\windows\\system32\\smss.exe") or (image="c:\\windows\\system32\\winlogon.exe" and parentimage!="c:\\windows\\system32\\smss.exe") or (image="c:\\windows\\system32\\lsass.exe" and parentimage!="c:\\windows\\system32\\wininit.exe") or (image="c:\\windows\\system32\\logonui.exe" and (parentimage!="c:\\windows\\system32\\winlogon.exe" and parentimage!="c:\\windows\\system32\\wininit.exe")) or (image="c:\\windows\\system32\\services.exe" and parentimage!="c:\\windows\\system32\\wininit.exe") or (image="c:\\windows\\system32\\spoolsv.exe" and parentimage!="c:\\windows\\system32\\services.exe") or (image="c:\\windows\\system32\\taskhost.exe" and (parentimage!="c:\\windows\\system32\\services.exe" and parentimage!="c:\\windows\\system32\\svchost.exe")) or (image="c:\\windows\\system32\\taskhostw.exe" and (parentimage!="c:\\windows\\system32\\services.exe" and parentimage!="c:\\windows\\system32\\svchost.exe")) or (image="c:\\windows\system32\\userinit.exe" and (parentimage!="c:\\windows\\system32\\dwm.exe" and parentimage!="c:\\windows\\system32\\winlogon.exe"))) data_model: sysmon native
<li><a href="#">code: (index=__your_sysmon_index__ eventcode=1) image="c:\\windows\\system32\\net.exe" and (commandline="* user*" or commandline="* group*" or commandline="* localgroup*" or commandline="*get-localgroup*" or commandline="*get-adprincipalgroupmembership*") data_model: sysmon native
<li><a href="#">code: (index=__your_sysmon_index__ eventcode=3) image="c:\\windows\\system32\\cmstp.exe" | where ((!cidrmatch("10.0.0.0/8", sourceip) and !cidrmatch("192.168.0.0/16", sourceip) and !cidrmatch("172.16.0.0/12", sourceip)) data_model: sysmon native
<li><a href="#">code: (source="wineventlog:*" ((((eventcode="4688" or eventcode="1") ((commandline="*reg*" commandline="*add*" commandline="*/d*") or (commandline="*set-itemproperty*" commandline="*-value*")) (commandline="*00000000*" or commandline="*0*") commandline="*safedllsearchmode*") or ((eventcode="4657") objectvaluename="safedllsearchmode" value="0")) or ((eventcode="13") eventtype="setvalue" targetobject="*safedllsearchmode" details="dword (0x00000000)"))) data_model: win. eventlog/sysmon native
<li><a href="#">code: [eventcode] == 4624 and [authenticationpackagename] == 'negotiate' and [severity] == "information" and [logontype] == 10
<li><a href="#">code: _fetch * from event where $logname=windows-nxlog-audit and $subsystem=authentication and $action=login group count_unique $scopeid, $user limit 30 >>_store in_disk david_test win_top_30 stack_replace >>_fetch * from event where $logname=windows-nxlog-audit and $subsystem=authentication and $action=login limit 10000 >>_checkif lookup david_test win_top_30 join $scopeid = $scopeid str_compare $user eq $user exclude
<li><a href="#">code: _fetch * from event where $logname=windows-sysmon and $eventid=1 and $app=at.exe limit 100
<li><a href="#">code: _fetch * from event where $logname=windows-sysmon and $eventid=1 and $app=cmd.exe and $parentprocess=regex(.*services.exe.*)i limit 30
<li><a href="#">code: _fetch * from event where $logname=windows-sysmon and $eventid=1 and $app=powershell.exe not $parentprocess=regex(.*explorer.exe.*)i limit 30
<li><a href="#">code: _fetch * from event where $logname=windows-sysmon and $eventid=1 and $app=regex(arp\.exe|at\.exe|attrib\.exe|cscript\.exe|dsquery\.exe|hostname\.exe|ipconfig\.exe|mimikatz.exe|nbstat\.exe|net\.exe|netsh\.exe|nslookup\.exe|ping\.exe|quser\.exe|qwinsta\.exe|reg\.exe|runas\.exe|sc\.exe|schtasks\.exe|ssh\.exe|systeminfo\.exe|taskkill\.exe|telnet\.exe|tracert\.exe|wscript\.exe|xcopy\.exe)i group count_unique $app limit 100 >>_agg count >>_checkif int_compare count > 1 include
<li><a href="#">code: _fetch * from event where $logname=windows-sysmon and $eventid=1 and $app=rundll32.exe limit 100
<li><a href="#">code: _fetch * from event where $logname=windows-sysmon and $eventid=1 and $app=schtasks.exe and $process=regex(.*(\/create|\/run|\/query|\/delete|\/change|\/end).*)i limit 100
<li><a href="#">code: _fetch * from event where $logname=windows-sysmon and $eventid=1 and $process=regex(.* a .*)i limit 100
<li><a href="#">code: _fetch * from event where $logname=windows-sysmon and $eventid=1 and $process=regex(.*(\:\\recycler\\|\:\\systemvolumeinformation\\|\%windir\%\\tasks\\|\%systemroot\%\\debug\\).*)i group count_unique $app limit 100
<li><a href="#">code: _fetch * from event where $logname=windows-sysmon and $eventid=1 and $process=regex(.*(\-r.*\-pw|\-pw.*\@|sekurlsa|\-hp| a |\\d\{1\,3\}\\\.\\d\{1\,3\}\\\.\\d\{1\,3\}).*)i limit 100
<li><a href="#">code: _fetch * from event where $logname=windows-sysmon and $eventid=1 and $process=regex(.*cmd\.exe.*)i limit 100
<li><a href="#">code: _fetch * from event where $logname=windows-sysmon and $eventid=1 and $process=regex(.*reg\.exe.*)i and $parentprocess=regex(.*cmd\.exe.*)i as #a limit 100 >>_fetch * from event where $logname=windows-sysmon and $eventid=1 and $process=regex(.*cmd\.exe.*)i not $parentprocess=regex(.*explorer\.exe.*)i as #b limit 100 >>_checkif sjoin #b.$ppid = #a.$cpid str_compare #b.$systemname eq #a.$systemname include
<li><a href="#">code: _fetch * from event where $logname=windows-sysmon and $eventid=1 group count_unique $app, $hashmd5 limit 100 >>_agg count_unique $hashmd5 >>_checkif int_compare count_unique > 1 include
<li><a href="#">code: '`sysmon` eventid=8 targetimage=*lsass.exe | stats count min(_time) as firsttime max(_time) as lasttime by computer, eventcode, targetimage, targetprocessid | rename computer as dest'
<li><a href="#">code: '| tstats count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process_name = bcdedit.exe processes.process="*recoveryenabled*" (processes.process="* no*") by processes.process_name processes.process processes.parent_process_name processes.dest processes.user'
<li><a href="#">code: '| tstats count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process_name=bitsadmin.exe processes.process in (*create*, *addfile*, *setnotifyflags*, *setnotifycmdline*, *setminretrydelay*, *setcustomheaders*, *resume* ) by processes.dest processes.user processes.parent_process processes.process_name processes.process processes.process_id processes.parent_process_id'
<li><a href="#">code: '| tstats count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process_name=bitsadmin.exe processes.process=*transfer* by processes.dest processes.user processes.parent_process processes.process_name processes.process processes.process_id processes.parent_process_id'
<li><a href="#">code: '| tstats count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process_name=certutil.exe processes.process=*decode* by processes.dest processes.user processes.parent_process processes.process_name processes.process processes.process_id processes.parent_process_id'
<li><a href="#">code: '| tstats count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process_name=certutil.exe processes.process=*urlcache* processes.process=*split* by processes.dest processes.user processes.parent_process processes.process_name processes.process processes.process_id processes.parent_process_id'
<li><a href="#">code: '| tstats count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process_name=certutil.exe processes.process=*verifyctl* processes.process=*split* by processes.dest processes.user processes.parent_process processes.process_name processes.process processes.process_id processes.parent_process_id'
<li><a href="#">code: '| tstats count min(_time) as firsttime max(_time) as lasttime values(filesystem.dest) as dest values(filesystem.file_name) as file_name values(filesystem.user) as user from datamodel=endpoint.filesystem by filesystem.file_path | rex field=file_name "(?<file_extension>\.[^\.]+)$" | search file_path=*system32* and file_extension=.bat'
<li><a href="#">code: '| tstats count min(_time) as firsttime values(processes.process) as process max(_time) as lasttime from datamodel=endpoint.processes where processes.process_name=*certutil* (processes.process=*-addstore*) by processes.parent_process processes.process_name processes.user'
<li><a href="#">code: '| tstats count min(_time) as firsttime values(processes.process) as process max(_time) as lasttime from datamodel=endpoint.processes where processes.process_name=certutil.exe processes.process = "* -exportpfx *" by processes.parent_process processes.process_name processes.process processes.user'
<li><a href="#">code: '| tstats count values(processes.user) as user values(processes.parent_process) as parent_process min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where (processes.process_name=net.exe or processes.process_name=net1.exe) and (processes.process=*localgroup* or processes.process=*/add* or processes.process=*user*) by processes.process processes.process_name processes.dest |`create_local_admin_accounts_using_net_exe_filter`'
<li><a href="#">code: earliest=-d@d latest=now() index=__your_sysmon_data__ eventcode=10 targetimage="c:\\windows\\system32\\lsass.exe" (grantedaccess=0x1410 or grantedaccess=0x1010 or grantedaccess=0x1438 or grantedaccess=0x143a or grantedaccess=0x1418) | search not [ search earliest=-7d@d latest=-2d@d index=__your_sysmon_data__ eventcode=10 targetimage="c:\\windows\\system32\\lsass.exe" (grantedaccess=0x1410 or grantedaccess=0x1010 or grantedaccess=0x1438 or grantedaccess=0x143a or grantedaccess=0x1418) | dedup sourceimage | fields sourceimage ] | table _time hostname user sourceimage grantedaccess
<li><a href="#">code: eventcode == 4624 and [target_user_name] != "anonymous logon" and [authentication_package_name] == "ntlm"
<li><a href="#">code: file where file_name == "lsass*.dmp" and process_name == "taskmgr.exe"
<li><a href="#">code: file where file_name == "ntds.dit" and process_name == "ntdsutil.exe"
<li><a href="#">code: files = search file:create batch_files = filter files where ( extension =".bat" and file_path = "c:\windows\system32*" ) output batch_files data_model: car native
<li><a href="#">code: files = search file:create lsass_dump = filter files where ( file_name = "lsass*.dmp" and image_path = "c:\windows\*\taskmgr.exe") output lsass_dump
<li><a href="#">code: files = search file:create ntds_dump = filter files where ( file_name = "ntds.dit" and image_path = "*ntdsutil.exe") output ntds_dump
<li><a href="#">code: files = search file:create task_files = filter files where ( (file_path = "c:\windows\system32\tasks\*" or file_path = "c:\windows\tasks\*") and image_path != "c:\windows\system32\svchost.exe") output task_files data_model: car native
<li><a href="#">code: flow = search flow:message smb_events = filter flow where (dest_port == "445" and protocol == "smb") smb_events.file_name = smb_events.proto_info.file_name output smb_write
<li><a href="#">code: flow = search flow:message smb_setup = filter flow where (dest_port == 445 and protocol == smb.setup) smb_setup.user = smb_write.proto_info.user_name smb_setup.target_host = smb_write.proto_info.hostname output smb_write
<li><a href="#">code: flow = search flow:message smb_write = filter flow where (dest_port == "445" and protocol == "smb.write") smb_write.file_name = smb_write.proto_info.file_name output smb_write
<li><a href="#">code: flow = search flow:message smb_write = filter flow where (dest_port == "445" and protocol == "smb.write_pipe") smb_write.pipe_name = smb_write.proto_info.pipe_name output smb_write
<li><a href="#">code: flow = search flow:start winrm = filter flow where (dest_port == 5985) winrm_s = filter flow where (dest_port == 5986) output winrm, winrm_s
<li><a href="#">code: flow_start = search flow:start flow_end = search flow:end rdp_start = filter flow_start where (port == "3389") rdp_end = filter flow_start where (port == "3389") rdp = group flow_start, flow_end by src_ip, src_port, dest_ip, dest_port output rdp
<li><a href="#">code: flows = search flow:message at_proto = filter flows where (dest_port == 445 and proto_info.pipe == "atsvc") at_create = filter flows where (proto_info.function == "jobadd") output at_create
<li><a href="#">code: flows = search flow:message schtasks_rpc = filter flows where ( src_port >= 49152 and dest_port >= 49152 and proto_info.rpc_interface == "itaskschedulerservice" ) output schtasks_rpc
<li><a href="#">code: flows = search flow:message winreg = filter flows where (dest_port == 445 and proto_info.pipe == "winreg") winreg_modify = filter flows where (proto_info.function == "create*" or proto_info.function == "setvalue*") output winreg_modify
<li><a href="#">code: flows = search flow:message wmi_flow = filter flows where (dest_port == 135 and proto_info.rpc_interface == "iremunknown2") output wmi_flow
<li><a href="#">code: flows = search flow:start rpc_mapper = filter flows where (dest_port == 135) rpc_endpoint = filter flows where (dest_port >= 49152 and src_port >= 49152) rpc = join rpc_mapper, rpc_endpoint where ( (rpc_mapper.time < rpc_endpoint.time < rpc_mapper.time + 2 seconds) and (rpc_mapper.src_ip == rpc_endpoint.src_ip and rpc_mapper.dest_ip == rpc_endpoint.dest_ip) ) output rpc
<li><a href="#">code: index = __your_sysmon__index__ (parentimage="*excel.exe" or parentimage="*word.exe" or parentimage="*outlook.exe") image="*.exe" data_model: sysmon native
<li><a href="#">code: index= __your_sysmon__index__ eventcode=1 image = "c:\\windows\\system32\\sc.exe" | regex commandline="^sc\s*(config|stop|query)\swindefend$" data_model: sysmon native
<li><a href="#">code: index=* sourcetype="xmlwineventlog" eventcode=4688 |eval cmd_len=len(commandline) | eventstats avg(cmd_len) as avg by host| stats max(cmd_len) as maxlen, values(avg) as avgperhost by host, commandline | where maxlen > 10*avgperhost data_model: sysmon native
<li><a href="#">code: index=__sysmon_index__ eventcode=1 (image="c:\\program files\\microsoft office\\root\\client\\appvlp.exe" or image="c:\\program files (x86)\\microsoft office\\root\\client\\appvlp.exe") | regex commandline="(\w+(\.\w+)?):(\w+(\.\w+)?)"
<li><a href="#">code: index=__sysmon_index__ eventcode=1 (image=c:\\windows\\*\\wscript.exe or image=c:\\windows\\*\\cscript.exe) | regex commandline="(?<!\/)\b\w+(\.\w+)?:\w+(\.\w+)?$"
<li><a href="#">code: index=__sysmon_index__ eventcode=1 (image=c:\\windows\\system32\\bash.exe or c:\\windows\\syswow64\\bash.exe) | regex commandline="-c.*(\w+(\.\w+)?):(\w+(\.\w+)?)"
<li><a href="#">code: index=__sysmon_index__ eventcode=1 (image=c:\\windows\\system32\\bitsadmin.exe or c:\\windows\\syswow64\\bitsadmin.exe) | regex commandline="\/create.*\/addfile.*\/setnotifycmdline.*\b(\w+\.\w+):(\w+(\.\w+)?)"
<li><a href="#">code: index=__sysmon_index__ eventcode=1 (image=c:\\windows\\system32\\cmd.exe or image=c:\\windows\\syswow64\\cmd.exe) | regex commandline="-\s+<.*\b(\w+(\.\w+)?):(\w+(\.\w+)?)"
<li><a href="#">code: index=__sysmon_index__ eventcode=1 (image=c:\\windows\\system32\\ftp.exe or image=c:\\windows\\syswow64\\ftp.exe) | regex commandline="-s:(\w+(\.\w+)?):(\w+(\.\w+)?)"
<li><a href="#">code: index=__sysmon_index__ eventcode=1 (image=c:\\windows\\system32\\mavinject.exe or c:\\windows\\syswow64\\mavinject.exe) | regex commandline="\d+\s+\/injectrunning.*\b(\w+(\.\w+)?):(\w+(\.\w+)?)"
<li><a href="#">code: index=__sysmon_index__ eventcode=1 (image=c:\\windows\system32\\control.exe or image=c:\\windows\syswow64\\control.exe) | regex commandline="(\w+(\.\w+)?):(\w+\.dll)"
<li><a href="#">code: index=__sysmon_index__ eventcode=1 image=c:\\windows\\*\\powershell.exe|regex commandline="invoke-cimmethod\s+-classname\s+win32_process\s+-methodname\s+create.*\b(\w+(\.\w+)?):(\w+(\.\w+)?)|-ep bypass\s+-\s+<.*\b(\w+(\.\w+)?):(\w+(\.\w+)?)|-command.*get-content.*-stream.*set-content.*start-process .*(\w+(\.\w+)?)"
<li><a href="#">code: index=__sysmon_index__ eventcode=1 image=c:\\windows\\*\\rundll32.exe | regex commandline="\"?(\w+(\.\w+)?):(\w+(\.\w+)?)?\"?,\w+\|(advpack\.dll\|ieadvpack\.dll),registerocx\s+(\w+\.\w+):(\w+(\.\w+)?)\|(shdocvw\.dll\|ieframe\.dll),openurl.*(\w+\.\w+):(\w+(\.\w+)?)"
<li><a href="#">code: index=__sysmon_index__ eventcode=1 image=c:\\windows\\*\\wmic.exe | regex commandline="process call create.*\"(\w+(\.\w+)?):(\w+(\.\w+)?)"
<li><a href="#">code: index=__your_sysmon_data__ earliest=-d@d latest=now() eventcode=1 regsvr32.exe | search parentimage="*regsvr32.exe" and image!="*regsvr32.exe*" | search not [ search index=__your_sysmon_data__ earliest=-60d@d latest=-30d@d eventcode=1 regsvr32.exe | search parentimage="*regsvr32.exe" and image!="*regsvr32.exe*" | dedup commandline | fields commandline ]
<li><a href="#">code: index=__your_sysmon_data__ eventcode=1 (parentimage="c:\\windows\\system32\\regsvr32.exe" or parentimage="c:\\windows\\syswow64\\regsvr32.exe") and image!="c:\\windows\\system32\\regsvr32.exe" and image!="c:\\windows\\syswow64\\regsvr32.exe" and image!="c:\\windows\\system32\\regsvr32.exe" and image!="c:\\windows\\syswow64\\regsvr32.exe" and image!="c:\\windows\\syswow64\\werfault.exe" and image!="c:\\windows\\system32\\wevtutil.exe" and image!="c:\\windows\\system32\\werfault.exe"|stats values(computername) as "computer name" values(parentcommandline) as "parent command line" count(image) as imagecount by image
<li><a href="#">code: index=__your_sysmon_data__ eventcode=1 regsvr32.exe | search parentimage="*regsvr32.exe" and image!="*regsvr32.exe*"
<li><a href="#">code: index=__your_sysmon_data__ eventcode=10 targetimage="c:\\windows\\system32\\lsass.exe" (grantedaccess=0x1410 or grantedaccess=0x1010 or grantedaccess=0x1438 or grantedaccess=0x143a or grantedaccess=0x1418) calltrace="c:\\windows\\system32\\ntdll.dll+*|c:\\windows\\system32\\kernelbase.dll+20edd|unknown(*)" | table _time hostname user sourceimage grantedaccess
<li><a href="#">code: index=__your_sysmon_data__ eventcode=7 (image="c:\\windows\\system32\\regsvr32.exe" or image="c:\\windows\\syswow64\\regsvr32.exe") signed=false imageloaded!="c:\\program files*" imageloaded!="c:\\windows\\*"|stats values(computername) as "computer name" count(imageloaded) as imageloadedcount by imageloaded
<li><a href="#">code: index=__your_sysmon_events__ eventcode=1 regsvr32.exe scrobj.dll | search image="*regsvr32.exe"
<li><a href="#">code: index=__your_sysmon_index__ (eventcode=12 or eventcode=13 or eventcode=14) (targetobject="*\\software\\microsoft\\windows nt\\currentversion\\windows\\appinit_dlls\\*" or targetobject="*\\software\\wow6432node\\microsoft\\windows nt\\currentversion\\windows\\appinit_dlls\\*") data_model: sysmon native
<li><a href="#">code: index=__your_sysmon_index__ (eventcode=12 or eventcode=13 or eventcode=14) targetobject="*\\software\\classes\\clsid\\*" data_model: sysmon native
<li><a href="#">code: index=__your_sysmon_index__ (image="c:\\windows\\system32\\cmd.exe" or commandline="*%comspec%*") (commandline="*echo*" and commandline="*\pipe\*") data_model: sysmon native
<li><a href="#">code: index=__your_sysmon_index__ (parentimage="c:\\windows\\system32\\services.exe" image="c:\\windows\\system32\\cmd.exe" (commandline="*echo*" and commandline="*\\pipe\\*")) or (image="c:\\windows\\system32\\rundll32.exe" commandline="*,a /p:*") data_model: sysmon native
<li><a href="#">code: index=__your_sysmon_index__ eventcode=1 (commandline="* -r * -pw*" or commandline="* -pw * *@*" or commandline="*sekurlsa*" or commandline="* -hp *" or commandline="* a *")
<li><a href="#">code: index=__your_sysmon_index__ eventcode=1 (image="c:\\windows\\*\\hostname.exe" or image="c:\\windows\\*\\ipconfig.exe" or image="c:\\windows\\*\\net.exe" or image="c:\\windows\\*\\quser.exe" or image="c:\\windows\\*\\qwinsta.exe" or (image="c:\\windows\\*\\sc.exe" and (commandline="* query *" or commandline="* qc *")) or image="c:\\windows\\*\\systeminfo.exe" or image="c:\\windows\\*\\tasklist.exe" or image="c:\\windows\\*\\whoami.exe")|stats values(image) as "images" values(commandline) as "command lines" by computername
<li><a href="#">code: index=__your_sysmon_index__ eventcode=1 (originalfilename = at.exe or originalfilename = atbroker.exe or originalfilename = bash.exe or originalfilename = bitsadmin.exe or originalfilename = certutil.exe or originalfilename = cmd.exe or originalfilename = cmdkey.exe or originalfilename = cmstp.exe or originalfilename = control.exe or originalfilename = csc.exe or originalfilename = cscript.exe or originalfilename = dfsvc.exe or originalfilename = diskshadow.exe or originalfilename = dnscmd.exe or originalfilename = esentutl.exe or originalfilename = eventvwr.exe or originalfilename = expand.exe or originalfilename = extexport.exe or originalfilename = extrac32.exe or originalfilename = findstr.exe or originalfilename = forfiles.exe or originalfilename = ftp.exe or originalfilename = gpscript.exe or originalfilename = hh.exe or originalfilename = ie4uinit.exe or originalfilename = ieexec.exe or originalfilename = infdefaultinstall.exe or originalfilename = installutil.exe or originalfilename = jsc.exe or originalfilename = makecab.exe or originalfilename = mavinject.exe or originalfilename = microsoft.workflow.r.exe or originalfilename = mmc.exe or originalfilename = msbuild.exe or originalfilename = msconfig.exe or originalfilename = msdt.exe or originalfilename = mshta.exe or originalfilename = msiexec.exe or originalfilename = odbcconf.exe or originalfilename = pcalua.exe or originalfilename = pcwrun.exe or originalfilename = presentationhost.exe or originalfilename = print.exe or originalfilename = reg.exe or originalfilename = regasm.exe or originalfilename = regedit.exe or originalfilename = register-cimprovider.exe or originalfilename = regsvcs.exe or originalfilename = regsvr32.exe or originalfilename = replace.exe or originalfilename = rpcping.exe or originalfilename = rundll32.exe or originalfilename = runonce.exe or originalfilename = runscripthelper.exe or originalfilename = sc.exe or originalfilename = schtasks.exe or originalfilename = scriptrunner.exe or originalfilename = syncappvpublishingserver.exe or originalfilename = tttracer.exe or originalfilename = verclsid.exe or originalfilename = wab.exe or originalfilename = wmic.exe or originalfilename = wscript.exe or originalfilename = wsreset.exe or originalfilename = xwizard.exe or originalfilename = advpack.dll or originalfilename = comsvcs.dll or originalfilename = ieadvpack.dll or originalfilename = ieaframe.dll or originalfilename = mshtml.dll or originalfilename = pcwutl.dll or originalfilename = setupapi.dll or originalfilename = shdocvw.dll or originalfilename = shell32.dll or originalfilename = syssetup.dll or originalfilename = url.dll or originalfilename = zipfldr.dll or originalfilename = appvlp.exe or originalfilename = bginfo.exe or originalfilename = cdb.exe or originalfilename = csi.exe or originalfilename = devtoolslauncher.exe or originalfilename = dnx.exe or originalfilename = dxcap.exe or originalfilename = excel.exe or originalfilename = mftrace.exe or originalfilename = msdeploy.exe or originalfilename = msxsl.exe or originalfilename = powerpnt.exe or originalfilename = rcsi.exe or originalfilename = sqler.exe or originalfilename = sqlps.exe or originalfilename = sqltoolsps.exe or originalfilename = squirrel.exe or originalfilename = te.exe or originalfilename = tracker.exe or originalfilename = update.exe or originalfilename = vsjitdebugger.exe or originalfilename = winword.exe or originalfilename = wsl.exe or originalfilename = cl_mutexverifiers.ps1 or originalfilename = cl_invocation.ps1 or originalfilename = manage-bde.wsf or originalfilename = pubprn.vbs or originalfilename = slmgr.vbs or originalfilename = syncappvpublishingserver.vbs or originalfilename = winrm.vbs or originalfilename = pester.bat)|eval commandline=lower(commandline)|eventstats count(process) as proccount by process|eventstats avg(proccount) as avg stdev(proccount) as stdev|eval lowerbound=(avg-stdev*1.5)|eval isoutlier=if((proccount < lowerbound),1,0)|where isoutlier=1|table host, image, parentimage, commandline, parentcommandline, proccount
<li><a href="#">code: index=__your_sysmon_index__ eventcode=1 |regex commandline=".*\b(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)(\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}\b.*"
<li><a href="#">code: index=__your_sysmon_index__ eventcode=1 image="*\\procdump*.exe" commandline="*lsass*"
<li><a href="#">code: index=__your_sysmon_index__ eventcode=1 image="c:\\windows\\*\\cmd.exe" parentimage="c:\\windows\\*\\services.exe"
<li><a href="#">code: index=__your_sysmon_index__ eventcode=1 image="c:\\windows\\*\\powershell.exe" parentimage!="c:\\windows\\explorer.exe"|stats values(commandline) as "command lines" values(parentimage) as "parent images" by computername
<li><a href="#">code: index=__your_sysmon_index__ eventcode=1 image="c:\\windows\\*\\wmic.exe" commandline="* process call create *"|search commandline="* /node:*"
<li><a href="#">code: index=__your_sysmon_index__ eventcode=1 parentimage="c:\\windows\\*\\winlogon.exe" image="c:\\windows\\*\\cmd.exe"
<li><a href="#">code: index=__your_sysmon_index__ eventcode=1|stats dc(hashes) as num_hashes values(hashes) as "hashes" by image|where num_hashes > 1
<li><a href="#">code: index=__your_sysmon_index__ eventcode=10 targetimage="c:\\windows\\system32\\lsass.exe" (calltrace="*dbghelp.dll*" or calltrace="*dbgcore.dll*")| table _time host sourceprocessid sourceimage
<li><a href="#">code: index=__your_sysmon_index__ eventcode=10 targetimage="c:\\windows\\system32\\lsass.exe" grantedaccess="0x1fffff" ("procdump")
<li><a href="#">code: index=__your_sysmon_index__ eventcode=11 image!="c:\\windows\\system32\\svchost.exe" (targetfilename="c:\\windows\\system32\\tasks\\ *" or targetfilename="c:\\windows\\tasks\\*") data_model: sysmon native
<li><a href="#">code: index=__your_sysmon_index__ eventcode=11 targetfilename="*lsass*.dmp" image="c:\\windows\\*\\taskmgr.exe"
<li><a href="#">code: index=__your_sysmon_index__ eventcode=11 targetfilename="*ntds.dit" image="*ntdsutil.exe"
<li><a href="#">code: index=__your_sysmon_index__ image="c:\\windows\\*\\at.exe"|stats values(commandline) as "command lines" by computername
<li><a href="#">code: index=__your_sysmon_index__ source="xmlwineventlog:microsoft-windows-sysmon/operational" and ( (process_name=svchost.exe and not (process_path="c:\\windows\\system32\\svchost.exe" or process_path="c:\\windows\\syswow64\\svchost.exe")) or (process_name=smss.exe and not process_path="c:\\windows\\system32\\smss.exe") or (process_name=wininit.exe and not process_path="c:\\windows\\system32\\wininit.exe") or (process_name=taskhost.exe and not process_path="c:\\windows\\system32\\taskhost.exe") or (process_name=lasass.exe and not process_path="c:\\windows\\system32\\lsass.exe") or (process_name=winlogon.exe and not process_path="c:\\windows\\system32\\winlogon.exe") or (process_name=csrss.exe and not process_path="c:\\windows\\system32\\csrss.exe") or (process_name=services.exe and not process_path="c:\\windows\\system32\\services.exe") or (process_name=lsm.exe and not process_path="c:\\windows\\system32\\lsm.exe") or (process_name=explorer.exe and not process_path="c:\\windows\\explorer.exe") ) data_model: sysmon native
<li><a href="#">code: index=__your_sysmon_index__ sourcetype= __your__windows__sysmon__sourcetype eventcode=1 (image=*wevtutil* commandline=*cl* (commandline=*system* or commandline=*security* or commandline=*setup* or commandline=*application*) or clear-eventlog or limit-eventlog or (remove-item and .evtx) or remove-eventlog) data_model: sysmon native
<li><a href="#">code: index=__your_sysmon_index__ sourcetype= __your__windows__sysmon__sourcetype eventcode=1 image=*wevtutil* commandline=*cl* (commandline=*system* or commandline=*security* or commandline=*setup* or commandline=*application*) data_model: sysmon native
<li><a href="#">code: index=__your_win_event_log_index__ eventcode=4624|search not [search index=__your_win_event_log_index__ eventcode=4624|top 30 account_name|table account_name]
<li><a href="#">code: index=__your_windows_security_log_index__ eventcode=4670 object_type="file" security_id!="nt authority\\system"
<li><a href="#">code: index=_your_sysmon_index_ eventcode=1 integritylevel=high|search (parentcommandline="\"c:\\windows\\system32\\dism.exe\"*""*.xml" and image!="c:\\users\\*\\appdata\\local\\temp\\*\\dismhost.exe") or parentimage=c:\\windows\\system32\\fodhelper.exe or (commandline="\"c:\\windows\\system32\\wusa.exe\"*/quiet*" and user!=not_translated and currentdirectory=c:\\windows\\system32\\ and parentimage!=c:\\windows\\explorer.exe) or commandline="*.exe\"*cleanmgr.exe /autoclean*" or (parentimage="c:\\windows\\*dccw.exe" and image!="c:\\windows\\system32\\cttune.exe") or image="c:\\program files\\windows media player\\osk.exe" or parentimage="c:\\windows\\system32\\slui.exe"|eval possibletechniques=case(like(lower(parentcommandline),"%c:\\windows\\system32\\dism.exe%"), "uacme #23", like(lower(image),"c:\\program files\\windows media player\\osk.exe"), "uacme #32", like(lower(parentimage),"c:\\windows\\system32\\fodhelper.exe"), "uacme #33", like(lower(commandline),"%.exe\"%cleanmgr.exe /autoclean%"), "uacme #34", like(lower(image),"c:\\windows\\system32\\wusa.exe"), "uacme #36", like(lower(parentimage),"c:\\windows\\%dccw.exe"), "uacme #37", like(lower(parentimage),"c:\\windows\\system32\\slui.exe"), "uacme #45")
<li><a href="#">code: index=client eventcode=1 commandline="*unload*" (image="c:\\windows\\syswow64\\fltmc.exe" or image="c:\\windows\\system32\\fltmc.exe") data_model: sysmon native
<li><a href="#">code: index=your_sysmon_index (eventcode=12 or eventcode=13 or eventcode=14) targetobject="*\\software\\policies\\microsoft\\windows\\control panel\\desktop\\scrnsave.exe" data_model: sysmon native
<li><a href="#">code: input target_host input event_time all_boots = search systemlogs:bootup where (hostname == target_host and time < event_time) boot_time = max(all_boots.time) user_logins = search usersession:login host_logins = filter user_logins where (hostname == target_host and boot_time < time < event_time) compromised_accounts = unique(user_logins.user) output users
<li><a href="#">code: legitimate_installers = ["c:\windows\system32\msiexec.exe", "c:\windows\syswow64\msiexec.exe", ...] file_change = search file:create,modify process = search process:create service_process = filter processes where (parent_exe == "services.exe") modified_service = join (search, filter) where ( file_change.time < service_process.time and file_change.file_path == service_process.image_path ) modified_service = filter modified_service where (modified_service.file_change.image_path not in legitimate_installers) output modified_service
<li><a href="#">code: log_name == "security" and event_code == "4670" and object_type == "file" and subject_security_id != "nt authority\system"
<li><a href="#">code: log_name == "system" and event_code == "7036" param1 in ["windows defender", "windows firewall"] and param2 == "stopped"
<li><a href="#">code: logon_events = search user_session:login filtered_logons = filter logon_events where ( user not in top30(user)) output filtered_logons
<li><a href="#">code: modules = search module:load unsigned_modules = filter modules where ( (image_path == "c:\windows\system32\regsvr32.exe" or image_path == "c:\windows\syswow64\regsvr32.exe") and signer == null and module_path != "c:\program files*" and module_path != "c:\windows\*" ) output unsigned_modules
<li><a href="#">code: norm_id=windowssysmon ((event_id=1 image="c:\windows\system32\reg.exe" command="*add*\environment*userinitmprlogonscript") or (event_id in [12, 13, 14] target_object="*\environment*userinitmprlogonscript")) data_model: logpoint native
<li><a href="#">code: norm_id=windowssysmon channel="security" event_id=4670 object_type="file" -user_id="s-1-5-18"
<li><a href="#">code: norm_id=windowssysmon command="*unload*" (image="c:\windows\syswow64\fltmc.exe" or image="c:\windows\system32\fltmc.exe") data_model: logpoint native
<li><a href="#">code: norm_id=windowssysmon event_id in [12, 13, 14] target_object in ["*\software\microsoft\windows nt\currentversion\windows\appinit_dlls\*", "*\software\wow6432node\microsoft\windows nt\currentversion\windows\appinit_dlls\*"] data_model: logpoint native
<li><a href="#">code: norm_id=windowssysmon event_id in [12, 13, 14] target_object="*\software\classes\clsid\*" data_model: logpoint native
<li><a href="#">code: norm_id=windowssysmon event_id in [12, 13, 14] target_object="*\software\policies\microsoft\windows\control panel\desktop\scrnsave.exe" data_model: logpoint native
<li><a href="#">code: norm_id=windowssysmon event_id=1 ((image="c:\windows\system32\net.exe" command="*delete*") or command="*remove-smbshare*" or command="*remove-fileshare*") data_model: logpoint native
<li><a href="#">code: norm_id=windowssysmon event_id=1 (command="* -r * -pw*" or command="* -pw * *@*" or command="*sekurlsa*" or command="* -hp *" or command="* a *")
<li><a href="#">code: norm_id=windowssysmon event_id=1 (command="*rm (get-psreadlineoption).historysavepath*" or command="*del (get-psreadlineoption).historysavepath*" or command="*set-psreadlineoption â€“historysavestyle savenothing*" or command="*remove-item (get-psreadlineoption).historysavepath*" or command="del*microsoft\windows\powershell\psreadline\consolehost_history.txt") data_model: logpoint native
<li><a href="#">code: norm_id=windowssysmon event_id=1 (image in ["*\hostname.exe", "*\ipconfig.exe", "*\net.exe", "*\quser.exe", "*\qwinsta.exe", "*\systeminfo.exe", "*\tasklist.exe", "*\whoami.exe"] or (image="*\sc.exe" command in ["* query *", "* qc *"))
<li><a href="#">code: norm_id=windowssysmon event_id=1 (image in ["c:\program files (x86)\microsoft visual studio\*\bin\msbuild.exe", "c:\windows\microsoft.net\framework*\msbuild.exe", "c:\users\*\appdata\roaming\microsoft\msxsl.exe") -parent_image="*\microsoft visual studio*") data_model: logpoint native
<li><a href="#">code: norm_id=windowssysmon event_id=1 (image="*\tshark.exe" or image="*\windump.exe" or (image="*\logman.exe" -parent_image="?" -parent_image="c:\program files\windows event reporting\core\eventreporting.agentservice.exe") or image="*\tcpdump.exe" or image="*\wprui.exe" or image="*\wpr.exe") data_model: logpoint native
<li><a href="#">code: norm_id=windowssysmon event_id=1 (image="c:\windows\syswow64\hh.exe" or image="c:\windows\system32\hh.exe") data_model: logpoint native
<li><a href="#">code: norm_id=windowssysmon event_id=1 (image="c:\windows\syswow64\mavinject.exe" or image="c:\windows\system32\mavinject.exe" or command="*\injectrunning*") data_model: logpoint native
<li><a href="#">code: norm_id=windowssysmon event_id=1 | chart distinct_count(hash) as cnt by image | search cnt > 1
<li><a href="#">code: norm_id=windowssysmon event_id=1 command in ["$* *sethc.exe", "$* *utilman.exe", "$* *osk.exe", "$* *narrator.exe", "$* *magnify.exe"]
<li><a href="#">code: norm_id=windowssysmon event_id=1 command in ["*reg* query hklm /f password /t reg_sz /s*", "reg* query hkcu /f password /t reg_sz /s", "*get-unattendedinstallfile*", "*get-webconfig*", "*get-applicationhost*", "*get-sitelistpassword*", "*get-cachedgpppassword*", "*get-registryautologon*"] data_model: logpoint native
<li><a href="#">code: norm_id=windowssysmon event_id=1 command="* a *"
<li><a href="#">code: norm_id=windowssysmon event_id=1 image in ["*:\recycler\*", "*:\systemvolumeinformation\*", "c:\windows\tasks\*", "c:\windows\system32\debug\*"]
<li><a href="#">code: norm_id=windowssysmon event_id=1 image in ["*\arp.exe", "*\at.exe", "*\attrib.exe", "*\cscript.exe", "*\dsquery.exe", "*\hostname.exe", "*\ipconfig.exe", "*\mimikatz.exe", "*\nbstat.exe", "*\net.exe", "*\netsh.exe", "*\nslookup.exe", "*\ping.exe", "*\quser.exe", "*\qwinsta.exe", "*\reg.exe", "*\runas.exe", "*\sc.exe", "*\schtasks.exe", "*\ssh.exe", "*\systeminfo.exe", "*\taskkill.exe", "*\telnet.exe", "*\tracert.exe", "*\wscript.exe", "*\xcopy.exe"] | chart count() as cnt by host | search cnt > 1
<li><a href="#">code: norm_id=windowssysmon event_id=1 image="*\at.exe"
<li><a href="#">code: norm_id=windowssysmon event_id=1 image="*\cmd.exe"
<li><a href="#">code: norm_id=windowssysmon event_id=1 image="*\powershell.exe" -parent_image="c:\windows\explorer.exe"
<li><a href="#">code: norm_id=windowssysmon event_id=1 image="*\procdump*.exe" command="*lsass*"
<li><a href="#">code: norm_id=windowssysmon event_id=1 image="*\regsvr32.exe" command="*scrobj.dll"
<li><a href="#">code: norm_id=windowssysmon event_id=1 image="*\rundll32.exe"
<li><a href="#">code: norm_id=windowssysmon event_id=1 image="*\schtasks.exe" command in ["*/create*", "*/run*", "*/query*", "*/delete*", "*/change*", "*/end*"]
<li><a href="#">code: norm_id=windowssysmon event_id=1 image="*\wsmprovhost.exe" parent_image="*\svchost.exe"
<li><a href="#">code: norm_id=windowssysmon event_id=1 image="c:\\windows\\*\\wmic.exe" command="* process call create *" command="* /node:*"
<li><a href="#">code: norm_id=windowssysmon event_id=1 image="c:\windows\system32\cmd.exe" parent_image="c:\windows\system32\services.exe"
<li><a href="#">code: norm_id=windowssysmon event_id=1 image="c:\windows\system32\net.exe" (command="* user*" or command="* group*" or command="* localgroup*" or command="*get-localgroup*" or command="*get-adprincipalgroupmembership*") data_model: logpoint native
<li><a href="#">code: norm_id=windowssysmon event_id=1 integrity_level="high" ((parent_image="c:\windows\system32\fodhelper.exe" or command='*.exe"*cleanmgr.exe /autoclean*' or image="c:\program files\windows media player\osk.exe" or parent_image="c:\windows\system32\slui.exe") or (parent_command='"c:\windows\system32\dism.exe"*""*.xml"' -image="c:\users\*\appdata\local\temp\*\dismhost.exe") or (parent_image="c:\windows\*dccw.exe" -image="c:\windows\system32\cttune.exe") or (command='"c:\windows\system32\wusa.exe"*/quiet*' -user="not_translated" path="c:\windows\system32\" -parent_image="c:\windows\explorer.exe"))
<li><a href="#">code: norm_id=windowssysmon event_id=1 -parent_image="?" ((image="*\smss.exe" (-parent_image="*\smss.exe" -parent_image="*\system")) or (image="*\csrss.exe" (-parent_image="*\smss.exe" -parent_image="*\svchost.exe")) or (image="*\wininit.exe" -parent_image="*\smss.exe") or (image="*\winlogon.exe" -parent_image="*\smss.exe") or (image="*\lsass.exe" (-parent_image="*\wininit.exe" -parent_image="*\winlogon.exe")) or (image="*\logonui.exe" (-parent_image="*\winlogon.exe" -parent_image="*\wininit.exe")) or (image="*\services.exe" -parent_image="*\wininit.exe") or (image="*\spoolsv.exe" -parent_image="*\services.exe") or (image="*\taskhost.exe" (-parent_image="*\services.exe" -parent_image="*\svchost.exe")) or (image="*\taskhostw.exe" (-parent_image="*\services.exe" -parent_image="*\svchost.exe")) or (image="*\userinit.exe" (-parent_image="*\dwm.exe" -parent_image="*\winlogon.exe"))) data_model: logpoint native
<li><a href="#">code: norm_id=windowssysmon event_id=1 parent_image="c:\windows\system32\winlogon.exe" parent_image="c:\windows\system32\cmd.exe"
<li><a href="#">code: norm_id=windowssysmon event_id=10 image="c:\windows\system32\lsass.exe" (access="0x1410" or access="0x1010" or access="0x1438" or access="0x143a" or access="0x1418") call_trace="c:\windows\system32\ntdll.dll+*|c:\windows\system32\kernelbase.dll+20edd|unknown(*)" | fields log_ts, host, user, source_image, access
<li><a href="#">code: norm_id=windowssysmon event_id=10 image="c:\windows\system32\lsass.exe" call_trace in ["*dbghelp.dll*", "*dbgcore.dll*"] | fields log_ts host source_process_id source_image
<li><a href="#">code: norm_id=windowssysmon event_id=11 file="*lsass*.dmp" source_image="c:\windows\*\taskmgr.exe"
<li><a href="#">code: norm_id=windowssysmon event_id=11 file="*ntds.dit" source_image="*ntdsutil.exe"
<li><a href="#">code: norm_id=windowssysmon event_id=11 -source_image="c:\windows\system32\svchost.exe" (path="c:\windows\system32\tasks*" or path="c:\windows\tasks*") data_model: logpoint native
<li><a href="#">code: norm_id=windowssysmon event_id=3 image="c:\windows\system32\cmstp.exe" -source_address in homenet data_model: logpoint native
<li><a href="#">code: norm_id=windowssysmon event_id=8 start_function in ["loadlibrarya", "loadlibraryw"] -source_image="c:\path\to\trustedprogram.exe"
<li><a href="#">code: norm_id=winserver ((channel="security" event_id in [1100,1102]) or (channel="system" event_id=104))
<li><a href="#">code: norm_id=winserver channel="system" event_id=7036 param1 in ["windows defender", "windows firewall"] param2="stopped"
<li><a href="#">code: norm_id=winserver event_id=4624 package="negotiate" log_level="info" logon_type=10
<li><a href="#">code: norm_id=winserver event_id=7045 | chart count() as cnt by file | search cnt < 5
<li><a href="#">code: process = search process:create at = filter process where (exe == "at.exe") output at
<li><a href="#">code: process = search process:create cmd = filter process where (exe == "cmd.exe" and parent_exe == "services.exe") output cmd
<li><a href="#">code: process = search process:create cmd = filter process where (exe == "cmd.exe") output cmd
<li><a href="#">code: process = search process:create debuggers = filter process where (command_line match "$.* .*(sethc{{pipe}}utilman{{pipe}}osk{{pipe}}narrator{{pipe}}magnify)\.exe") output debuggers
<li><a href="#">code: process = search process:create flow = search flow:start service = filter process where (parent_exe == "services.exe") remote_start = join (flow, service ) where ( flow.hostname == service.hostname and flow.pid == service.pid and (flow.time < service.time < flow.time + 1 second) ) output remote_start
<li><a href="#">code: process = search process:create info_command = filter process where ( exe == "hostname.exe" or exe == "ipconfig.exe" or exe == "net.exe" or exe == "quser.exe" or exe == "qwinsta.exe" or exe == "sc" and (command_line match " query" or command_line match " qc")) or exe == "systeminfo.exe" or exe == "tasklist.exe" or exe == "whoami.exe" ) output info_command
<li><a href="#">code: process = search process:create port_fwd = filter process where (command_line match "-r .* -pw") scp = filter process where (command_line match "-pw .* .* .*@.*" mimikatz = filter process where (command_line match "sekurlsa") rar = filter process where (command_line match " -hp ") archive = filter process where (command_line match ".* a .*") ip_addr = filter process where (command_line match \d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}) output port_fwd, scp, mimikatz, rar, archive, ip_addr
<li><a href="#">code: process = search process:create powershell = filter process where (exe == "powershell.exe" and parent_exe != "explorer.exe" ) output powershell
<li><a href="#">code: process = search process:create rundll32 = filter process where (exe == "rundll32.exe") output rundll32
<li><a href="#">code: process = search process:create schtasks = filter process where (exe == "schtasks.exe") output schtasks
<li><a href="#">code: process = search process:create services = filter processes where (parent_exe == "services.exe") unquoted_services = filter services where (command_line != "\"*" and command_line == "* *") intercepted_service = filter unquoted_service where (image_path != "* *" and exe not in command_line) output intercepted_service
<li><a href="#">code: process = search process:create smb_write = run analytic:car-2013-05-003 remote_start = join (smb_write, process) where ( smb_write.hostname == process.hostname and smb_write.file_path == process.image_path (smb_write.time < process.time) ) output remote_start
<li><a href="#">code: process = search process:create wsmprovhost = filter process where (exe == "wsmprovhost.exe" and parent_exe == "svchost.exe")
<li><a href="#">code: process where subtype.create and (command_line == "* -r * -pw*" or command_line == "* -pw * *@*" or command_line == "*sekurlsa*" or command_line == "* -hp *" or command_line == "* a *")
<li><a href="#">code: process where subtype.create and (process_name == "cmd.exe" and parent_process_name == "services.exe")
<li><a href="#">code: process where subtype.create and (process_name == "cmd.exe" and parent_process_name == "winlogon.exe")
<li><a href="#">code: process where subtype.create and (process_name == "hostname.exe" or process_name == "ipconfig.exe" or process_name == "net.exe" or process_name == "quser.exe" process_name == "qwinsta.exe" or process_name == "systeminfo.exe" or process_name == "tasklist.exe" or process_name == "whoami.exe" or (process_name == "sc.exe" and (command_line == "* query *" or command_line == "* qc *")))
<li><a href="#">code: process where subtype.create and (process_name == "powershell.exe" and parent_process_name != "explorer.exe")
<li><a href="#">code: process where subtype.create and (process_name == "wmic.exe" and command_line == "* process call create ") |filter command_line == "* /node:*"
<li><a href="#">code: process where subtype.create and (process_name == "wsmprovhost.exe" and parent_process_name == "svchost.exe")
<li><a href="#">code: process where subtype.create and (process_path == "*regsvr32.exe" and command_line == "*scrobj.dll")
<li><a href="#">code: process where subtype.create and process_name == "at.exe"
<li><a href="#">code: processes = search process suspicious_processes = filter processes where ( (image_path == "c:\windows\system32\cmd.exe" or command_line == "*%comspec%*") and command_line == "*echo*" and command_line == "*\pipe\*")) output suspicious_processes data_model: car native
<li><a href="#">code: processes = search process suspicious_processes = filter processes where ( (parent_image_path == c:\windows\system32\services.exe" and image_path == "c:\windows\system32\cmd.exe" and command_line == "*echo*" and command_line == "*\pipe\*") or (image_path == "c:\windows\system32\rundll32.exe" and command_line == "*,a /p:*")) output suspicious_processes data_model: car native
<li><a href="#">code: processes = search process:* suspicious_processes = filter processes where ( (exe=svchost.exe and (image_path!="c:\\windows\\system32\\svchost.exe" or process_path!="c:\\windows\\syswow64\\svchost.exe")) or (exe=smss.exe and image_path!="c:\\windows\\system32\\smss.exe") or (exe=wininit.exe and image_path!="c:\\windows\\system32\\wininit.exe") or (exe=taskhost.exe and image_path!="c:\\windows\\system32\\taskhost.exe") or (exe=lasass.exe and image_path!="c:\\windows\\system32\\lsass.exe") or (exe=winlogon.exe and image_path!="c:\\windows\\system32\\winlogon.exe") or (exe=csrss.exe and image_path!="c:\\windows\\system32\\csrss.exe") or (exe=services.exe and image_path!="c:\\windows\\system32\\services.exe") or (exe=lsm.exe and image_path!="c:\\windows\\system32\\lsm.exe") or (exe=explorer.exe and image_path!="c:\\windows\\explorer.exe") ) output suspicious_processes data_model: car native
<li><a href="#">code: processes = search process:create addstore_commands = filter processes where ( exe =â€c:\windows\system32\certutil.exeâ€ and command_line="*-addstore*â€ ) output addstore_commands data_model: car native
<li><a href="#">code: processes = search process:create ads_processes = filter processes where ( exe == "control.exe or appvlp.exe or cmd.exe or ftp.exe or bash.exe or mavinject.exe or bitsadmin.exe" and command_line.matches("__some_regex__") ) output ads_processes
<li><a href="#">code: processes = search process:create ads_processes = filter processes where ( exe == "powershell.exe or rundll32.exe or wmic.exe or wscript.exe or cscript.exe" and command_line.matches("__some_regex__") ) output ads_processes
<li><a href="#">code: processes = search process:create bcdedit_commands = filter processes where ( exe = "c:\windows\system32\bcdedit.exe" and command_line="*recoveryenabled*" ) output bcedit_commands data_model: car native
<li><a href="#">code: processes = search process:create bitsadmin_commands = filter processes where ( exe ="c:\windows\system32\bitsadmin.exe" and command_line = *transfer*) output bitsadmin_commands data_model: car native
<li><a href="#">code: processes = search process:create bitsadmin_commands = filter processes where ( exe ="c:\windows\system32\bitsadmin.exe" and command_line includes one of [*create*, *addfile*, *setnotifyflags*, *setnotifycmdline*, *setminretrydelay*, *setcustomheaders*,*resume*]) output bitsadmin_commands data_model: car native
<li><a href="#">code: processes = search process:create certutil_downloads = filter processes where ( (exe = c:\windows\system32\net.exe or exe = c:\windows\system32\net1.exe ) and command_line = * -exportpfx * ) output certutil_downloads data_model: car native
<li><a href="#">code: processes = search process:create certutil_downloads = filter processes where ( exe = "c:\windows\system32\certutil.exe" and command_line = *verifyctl* and command_line = *split*) output certutil_downloads data_model: car native
<li><a href="#">code: processes = search process:create certutil_downloads = filter processes where ( exe ="c:\windows\system32\certutil.exe" and command_line = *urlcache* and command_line = *split*) output certutil_downloads data_model: car native
<li><a href="#">code: processes = search process:create certutil_downloads = filter processes where ( exe =â€c:\windows\system32\certutil.exe and command_line = * -exportpfx * ) output certutil_downloads data_model: car native
<li><a href="#">code: processes = search process:create certutil_downloads = filter processes where ( exe =â€c:\windows\system32\certutil.exeâ€ and command_line = *decode* ) output certutil_downloads data_model: car native
<li><a href="#">code: processes = search process:create chmod_processes = filter processes where command_line == "chmod *" output chmod_processes
<li><a href="#">code: processes = search process:create clear_commands = filter processes where ( command_line ="*rm (get-psreadlineoption).historysavepath*" or command_line="*del (get-psreadlineoption).historysavepath*" or command_line="*set-psreadlineoption â€“historysavestyle savenothing*" or command_line="*remove-item (get-psreadlineoption).historysavepath*") or command_linee="del*microsoft\windows\powershell\psreadline\consolehost_history.txt") output clear_commands data_model: car native
<li><a href="#">code: processes = search process:create cmd = filter processes where (exe == "cmd.exe") cmd = from cmd select parent_exe historic_cmd = filter cmd (where timestamp < now - 1 day and timestamp > now - 1 day) current_cmd = filter cmd (where timestamp >= now - 1 day) new_cmd = historic_cmd - current_cmd output new_cmd
<li><a href="#">code: processes = search process:create cmd_processes = filter processes where ( (parent_image = "c:\\windows\\system32\\cmd.exe") and (command_line = "reg.exe%hklm\\software\\microsoft\\windows\\currentversion\\policies\\system%reg_dword /d 0%") ) data_model: sysmon native
<li><a href="#">code: processes = search process:create cred_processes = filter processes where ( command_line = "*reg* query hklm /f password /t reg_sz /s*" or command_line = "reg* query hkcu /f password /t reg_sz /s" or command_line = "*get-unattendedinstallfile*" or command_line = "*get-webconfig*" or command_line = "*get-applicationhost*" or command_line = "*get-sitelistpassword*" or command_line = "*get-cachedgpppassword*" or command_line = "*get-registryautologon*") output cred_processes data_model: car native
<li><a href="#">code: processes = search process:create fltmc_processes = filter processes where ( exe = "fltmc.exe" and command_line = "*unload*") output fltmc_processes data_model: car native
<li><a href="#">code: processes = search process:create logon_reg_processes = filter processes where (command_line contains("*reg*") and command_line contains("*add*") and command_line contains("*/d*") or (command_line contains("*set-itemproperty*") and command_line contains("*-value*")) and command_line contains("*common startup*")) reg_keys = search registry:value_edit logon_reg_keys = filter reg_keys where value="common startup" output logon_reg_processes, logon_reg_keys data_model: car native
<li><a href="#">code: processes = search process:create logon_reg_processes = filter processes where command_line contains("*\\microsoft\\windows nt\\currentversion\\winlogon*") and (command_line contains("*userinit*") or command_line contains("*shell*") or command_line contains("*notify*")) and (((command_line contains("*reg*") or command_line contains("*add*") or command_line contains("*/d*")) or (command_line contains("*set-itemproperty*") or command_line contains("*new-itemproperty*") or command_line contains("*-value*")))) reg_keys = search registry:value_edit logon_reg_keys = filter reg_keys where (value="userinit" or value="shell" or value="notify") output logon_reg_processes, logon_reg_keys data_model: car native
<li><a href="#">code: processes = search process:create logon_script_key_processes = filter processes where ( command_line = "*reg*add*\environment*userinitmprlogonscript") registry = search (registry:add or registry:edit) registry_logon_key_events = filter registry where ( key = "*\environment*userinitmprlogonscript") output (logon_script_key_processes, registry_logon_key_events) data_model: car native
<li><a href="#">code: processes = search process:create lolbas_processes = filter processes where (exe = "at.exe" or exe = "atbroker.exe" or exe = "bash.exe" or exe = "bitsadmin.exe" or exe = "certutil.exe" or exe = "cmd.exe" or exe = "cmdkey.exe" or exe = "cmstp.exe" or exe = "control.exe" or exe = "csc.exe" or exe = "cscript.exe" or exe = "dfsvc.exe" or exe = "diskshadow.exe" or exe = "dnscmd.exe" or exe = "esentutl.exe" or exe = "eventvwr.exe" or exe = "expand.exe" or exe = "extexport.exe" or exe = "extrac32.exe" or exe = "findstr.exe" or exe = "forfiles.exe" or exe = "ftp.exe" or exe = "gpscript.exe" or exe = "hh.exe" or exe = "ie4uinit.exe" or exe = "ieexec.exe" or exe = "infdefaultinstall.exe" or exe = "installutil.exe" or exe = "jsc.exe" or exe = "makecab.exe" or exe = "mavinject.exe" or exe = "microsoft.workflow.r.exe" or exe = "mmc.exe" or exe = "msbuild.exe" or exe = "msconfig.exe" or exe = "msdt.exe" or exe = "mshta.exe" or exe = "msiexec.exe" or exe = "odbcconf.exe" or exe = "pcalua.exe" or exe = "pcwrun.exe" or exe = "presentationhost.exe" or exe = "print.exe" or exe = "reg.exe" or exe = "regasm.exe" or exe = "regedit.exe" or exe = "register-cimprovider.exe" or exe = "regsvcs.exe" or exe = "regsvr32.exe" or exe = "replace.exe" or exe = "rpcping.exe" or exe = "rundll32.exe" or exe = "runonce.exe" or exe = "runscripthelper.exe" or exe = "sc.exe" or exe = "schtasks.exe" or exe = "scriptrunner.exe" or exe = "syncappvpublishingserver.exe" or exe = "tttracer.exe" or exe = "verclsid.exe" or exe = "wab.exe" or exe = "wmic.exe" or exe = "wscript.exe" or exe = "wsreset.exe" or exe = "xwizard.exe" or exe = "advpack.dll or exe = "comsvcs.dll or exe = "ieadvpack.dll or exe = "ieaframe.dll or exe = "mshtml.dll or exe = "pcwutl.dll or exe = "setupapi.dll or exe = "shdocvw.dll or exe = "shell32.dll or exe = "syssetup.dll or exe = "url.dll or exe = "zipfldr.dll or exe = "appvlp.exe" or exe = "bginfo.exe" or exe = "cdb.exe" or exe = "csi.exe" or exe = "devtoolslauncher.exe" or exe = "dnx.exe" or exe = "dxcap.exe" or exe = "excel.exe" or exe = "mftrace.exe" or exe = "msdeploy.exe" or exe = "msxsl.exe" or exe = "powerpnt.exe" or exe = "rcsi.exe" or exe = "sqler.exe" or exe = "sqlps.exe" or exe = "sqltoolsps.exe" or exe = "squirrel.exe" or exe = "te.exe" or exe = "tracker.exe" or exe = "update.exe" or exe = "vsjitdebugger.exe" or exe = "winword.exe" or exe = "wsl.exe" or exe = "cl_mutexverifiers.ps1 or exe = "cl_invocation.ps1 or exe = "manage-bde.wsf or exe = "pubprn.vbs or exe = "slmgr.vbs or exe = "syncappvpublishingserver.vbs or exe = "winrm.vbs or exe = "pester.bat) process_count = count(lolbas_processes) by process process_count_avg = average(process_count) process_count_stdev = standard_deviation(process_count) lower_bound = process_count_avg - stdev * 1.5 outliers = filter lolbas_processes where (process_count < lower_bound) return outliers
<li><a href="#">code: processes = search process:create mavinject_processes = filter processes where ( exe = "c:\\windows\\syswow64\\mavinject.exe" or image="c:\\windows\\system32\\mavinject.exe" or command_line = "*/injectrunning*" output mavinject_processes data_model: car native
<li><a href="#">code: processes = search process:create mismatch_processes = filter processes where ( parent_exe exists and (exe="smss.exe" and (parent_exe!="smss.exe" and parent_exe!="system") or (exe="csrss.exe" and (parent_exe!="smss.exe" and parent_exe!="svchost.exe")) or (exe="wininit.exe" and parent_exe!="smss.exe") or (exe="winlogon.exe" and parent_exe!="smss.exe") or (exe="lsass.exe" and (parent_exe!="wininit.exe" and parent_exe!="winlogon.exe")) or (exe="logonui.exe" and (parent_exe!="winlogon.exe" and parent_exe!="wininit.exe")) or (exe="services.exe" and parent_exe!="wininit.exe") or (exe="spoolsv.exe" and parent_exe!="services.exe") or (exe="taskhost.exe" and (parent_exe!="services.exe" and parent_exe!="svchost.exe")) or (exe="taskhostw.exe" and (parent_exe!="services.exe" and parent_exe!="svchost.exe")) or (exe="userinit.exe" and (parent_exe!="dwm.exe" and parent_exe!="winlogon.exe")) output mismatch_processes data_model: car native
<li><a href="#">code: processes = search process:create net_processes = filter processes where ( exe = "net.exe" and ( command_line="*net* user*" or command_line="*net* group*" or command_line="*net* localgroup*" or command_line="*get-localgroup*" or command_line="*get-adprincipalgroupmembership*" ) output net_processes data_model: car native
<li><a href="#">code: processes = search process:create possible_uac_bypass = filter processes where ( integrity_level == "high" and (parent_image_path == "c:\windows\system32\fodhelper.exe") or (command_line == "*.exe\"*cleanmgr.exe /autoclean*") or (image_path == "c:\program files\windows media player\osk.exe") or (parent_image_path == "c:\windows\system32\slui.exe") or (parent_command_line == '"c:\windows\system32\dism.exe"*""*.xml"' and image_path != "c:\users\*\appdata\local\temp\*\dismhost.exe") or (command_line == '"c:\windows\system32\wusa.exe"*/quiet*' and user != "not_translated" and current_working_directory == "c:\windows\system32\" and parent_image_path != "c:\windows\explorer.exe") or (parent_image_path == "c:\windows\*dccw.exe" and image_path != "c:\windows\system32\cttune.exe") ) output possible_uac_bypass
<li><a href="#">code: processes = search process:create procdump_lsass = filter processes where ( exe = "procdump*.exe" and command_line = "*lsass*") output procdump_lsass
<li><a href="#">code: processes = search process:create rar_argument = filter processes where (command_line == "* a *") output rar_argument
<li><a href="#">code: processes = search process:create reg = filter processes where (exe == "reg.exe" and parent_exe == "cmd.exe") cmd = filter processes where (exe == "cmd.exe" and parent_exe != "explorer.exe"") reg_and_cmd = join (reg, cmd) where (reg.ppid == cmd.pid and reg.hostname == cmd.hostname) output reg_and_cmd
<li><a href="#">code: processes = search process:create reg_processes = filter processes where (exe == "arp.exe" or exe == "at.exe" or exe == "attrib.exe" or exe == "cscript.exe" or exe == "dsquery.exe" or exe == "hostname.exe" or exe == "ipconfig.exe" or exe == "mimikatz.exe" or exe == "nbstat.exe" or exe == "net.exe" or exe == "netsh.exe" or exe == "nslookup.exe" or exe == "ping.exe" or exe == "quser.exe" or exe == "qwinsta.exe" or exe == "reg.exe" or exe == "runas.exe" or exe == "sc.exe" or exe == "schtasks.exe" or exe == "ssh.exe" or exe == "systeminfo.exe" or exe == "taskkill.exe" or exe == "telnet.exe" or exe == "tracert.exe" or exe == "wscript.exe" or exe == "xcopy.exe") reg_grouped = group reg by hostname, ppid where(max time between two events is 30 minutes) output reg_grouped
<li><a href="#">code: processes = search process:create regsvr_processes = filter processes where ( (parent_image_path == "c:\windows\system32\regsvr32.exe" or parent_image_path == "c:\windows\syswow64\regsvr32.exe") and image_path != "c:\windows\system32\regsvr32.exe" and image_path != "c:\windows\syswow64\regsvr32.exe" and image_path != "c:\windows\syswow64\werfault.exe" and image_path != "c:\windows\system32\werfault.exe" and image_path != "c:\windows\system32\wevtutil.exe" ) output regsvr_processes
<li><a href="#">code: processes = search process:create regsvr_processes = filter processes where ( parent_image_path == "*regsvr32.exe" and image_path != "*regsvr32.exe*" ) output regsvr_processes
<li><a href="#">code: processes = search process:create safe_dll_search_processes = filter processes where command_line contains("*safedllsearchmode*") and ((command_line contains("*reg*") and command_line contains("*add*") and command_line contains("*/d*")) or (command_line contains("*set-itemproperty*") and command_line contains(*-value*)) or ((command_line contains("*00000000*") and command_line contains(*0*))) reg_keys = search registry:value_edit safe_dll_reg_keys = filter reg_keys where value="safedllsearchmode" and value_data="0" output safe_dll_search_processes, safe_dll_reg_keys data_model: car native
<li><a href="#">code: processes = search process:create services = filter processes where (parent_image_path == "c:\windows\system32\services.exe") historic_services = filter services (where timestamp < now - 1 day and timestamp > now - 1 day) current_services = filter services (where timestamp >= now - 1 day) new_services = historic_services - current_services output new_services
<li><a href="#">code: processes = search process:create sniffer_processes = filter processes where ( exe = "tshark.exe" or exe = "windump.exe" or (exe = "logman.exe" and parent_exe exists and parent_exe!="c:\program files\windows event reporting\core\eventreporting.agentservice.exe") or exe = "tcpdump.exe" or exe = "wprui.exe" or exe = "wpr.exe" ) output sniffer_processes data_model: car native
<li><a href="#">code: processes = search process:create squiblydoo_processes = filter processes where ( image_path == "*regsvr32.exe" and command_line == "*scrobj.dll" ) output squiblydoo_processes
<li><a href="#">code: processes = search process:create susp_processes = filter processes where ((command_line contains("*new-item*") or command_line contains("*reg add*")) or command_line contains("*minint*")) or (command_line contains("*stop-service*")and command_line contains("*eventlog*")) or (command_line contains("*eventlog*") and (command_line contains("*set-service*") or command_line contains("*reg add*") or command_line contains("*set-itemproperty*") or command_line contains("*new-itemproperty*") or command_line contains("*sc config*"))) or (command_line contains("*auditpol*") and (command_line contains("*/set*") or command_line contains("*/clear*") or command_line contains("*/revove*"))) or ((command_line contains("*wevtutil*") and (command_line contains("*sl*") or command_line contains("*set-log*")))) reg_keys = search registry:value_edit event_log_reg_keys = filter reg_keys where key="*eventlog*" and (value="start" or value="file" or value="maxsize") output susp_processes, event_log_reg_keys
<li><a href="#">code: processes = search process:create susp_tasks_processes = filter processes where command_line contains("*schtasks*") and (command_line contains("*/create*") or command_line contains("*/change*")) and (command_line contains("*.cmd*") or command_line contains("*.ps1*") or command_line contains("*.vbs*") or command_line contains("*.py*") or command_line contains("*.js*") or command_line contains("*.exe*") or command_line contains("*.bat*") or (command_line contains("*javascript*") or command_line contains("*powershell*") or command_line contains("*wmic*") or command_line contains("*rundll32*") or command_line contains("*cmd*") or command_line contains("*cscript*") or command_line contains("*wscript*") or command_line contains("*regsvr32*") or command_line contains("*mshta*") or command_line contains("*bitsadmin*") or command_line contains("*certutil*") or command_line contains("*msiexec*") or command_line contains("*javaw*") or (command_line contains("*%appdata%*") or command_line contains("*\\appdata\\roaming*") or command_line contains("*%public%*") or command_line contains("*c:\\users\\public*") or command_line contains("*%programdata%*") or command_line contains("*c:\\programdata*") or command_line contains("*%temp%*") or command_line contains("*\\appdata\\local\\temp*") or command_line contains("*\\windows\\pla\\system*") or command_line contains("*\\tasks*") or command_line contains("*\\registration\\crmlog*") or command_line contains("*\\fxstmp*") or command_line contains("*\\spool\\drivers\\color*") or command_line contains("*\\tracing*")))) tasks = search task:create susp_tasks = filter tasks where (task_content contains("*.cmd*") or task_content contains("*.ps1*") or task_content contains("*.vbs*") or task_content contains("*.py*") or task_content contains("*.js*") or task_content contains("*.exe*") or task_content contains("*.bat*") or (task_content contains("*javascript*") or task_content contains("*powershell*") or task_content contains("*wmic*") or task_content contains("*rundll32*") or task_content contains("*cmd*") or task_content contains("*cscript*") or task_content contains("*wscript*") or task_content contains("*regsvr32*") or task_content contains("*mshta*") or task_content contains("*bitsadmin*") or task_content contains("*certutil*") or task_content contains("*msiexec*") or task_content contains("*javaw*") or (task_content contains("*%appdata%*") or task_content contains("*\\appdata\\roaming*") or task_content contains("*%public%*") or task_content contains("*c:\\users\\public*") or task_content contains("*%programdata%*") or task_content contains("*c:\\programdata*") or task_content contains("*%temp%*") or task_content contains("*\\appdata\\local\\temp*") or task_content contains("*\\windows\\pla\\system*") or task_content contains("*\\tasks*") or task_content contains("*\\registration\\crmlog*") or task_content contains("*\\fxstmp*") or task_content contains("*\\spool\\drivers\\color*") or task_content contains("*\\tracing*")))) output susp_tasks_processes, susp_tasks data_model: car native
<li><a href="#">code: processes = search process:create suspicious_locations = filter process where ( image_path == "*:\recycler\*" or image_path == "*:\systemvolumeinformation\*" or image_path == "%windir%\tasks\*" or image_path == "%systemroot%\debug\*" ) output suspicious_locations
<li><a href="#">code: processes = search process:create suspicious_processes = filter processes where ( (parent_exe == "w3wp.exe" or parent_exe == "httpd.exe" or parent_exe == "tomcat*.exe" or parent_exe == "nginx.exe" ) and (exe == "cmd.exe" or exe == "powershell.exe" or exe == "net.exe" or exe == "whoami.exe" or exe == "hostname.exe" or exe == "systeminfo.exe" or exe == "ipconfig.exe) ) output suspicious_processes data_model: car native
<li><a href="#">code: processes = search process:create target_processes = filter processes where ( (exe="c:\\windows\\system32\\net.exe" and command_line="*delete*") or command_line="*remove-smbshare*" or comman_line="*remove-fileshare*" ) output target_processes data_model: car native
<li><a href="#">code: processes = search process:create target_processes = filter processes where ( (exe="c:\\windows\\system32\\sc.exe") and (command_line="sc *config*" or command_line="sc *stop*" or command_line="sc *query*") ) output target_processes
<li><a href="#">code: processes = search process:create target_processes = filter processes where ( (exe="c:\program files (x86)\microsoft visual studio\*\bin\msbuild.exe" or exe="c:\windows\microsoft.net\framework*\msbuild.exe" or exe="c:\users\*\appdata\roaming\microsoft\msxsl.exe") and image_path!="*microsoft visual studio*") output target_processes data_model: car native
<li><a href="#">code: processes = search process:create target_processes = filter processes where ( (parent_image="*excel.exe" or parent_image="*word.exe" or parent_image="*outlook.exe") and image="*.exe" )
<li><a href="#">code: processes = search process:create target_processes = filter processes where ( exe="c:\windows\system32\cmstp.exe" and src_ip not in [10.0.0.0/8,192.168.0.0/16, 172.16.0.0/12] ) output target_processes data_model: car native
<li><a href="#">code: processes = search process:create target_processes = filter processes where (exe="c:\windows\syswow64\hh.exe" or exe="c:\windows\system32\hh.exe") output target_processes data_model: car native
<li><a href="#">code: processes = search process:create winlogon_cmd = filter processes where (parent_exe == "winlogon.exe" and exe == "cmd.exe") output winlogon_cmd
<li><a href="#">code: processes = search process:create wmi_children = filter processes where (parent_exe == "wmiprvse.exe") flows = search flow:message wmi_flow = filter flows where (src_port >= 49152 and dest_port >= 49152 and proto_info.rpc_interface == "iremunknown2") remote_wmi_process = join wmi_children, wmi_flow where ( wmi_flow.time < wmi_children.time < wmi_flow.time + 1sec and wmi_flow.hostname == wmi_children.hostname ) output remote_wmi_process
<li><a href="#">code: processes = search process:create wmic = filter processes where (exe == "wmic.exe" and command_line == "* process call create *" and command_line == "* /node:*") output wmic
<li><a href="#">code: reg_events = search registry:add or registry:edit scr_reg_events = filter processes where ( key="*\\software\\policies\\microsoft\\windows\\control panel\\desktop\\scrnsave.exe" and output scr_reg_events data_model: car native
<li><a href="#">code: registry_keys = search (registry:create and registry:remove and registry:edit) appinit_keys = filter registry_keys where ( key = "*\software\microsoft\windows nt\currentversion\windows\appinit_dlls\*" or key = "*\software\\wow6432node\microsoft\windows nt\currentversion\windows\appinit_dlls\*"" ) output clsid_keys data_model: car native
<li><a href="#">code: registry_keys = search (registry:create and registry:remove and registry:edit) clsid_keys = filter registry_keys where ( key = "*\software\classes\clsid\*") output clsid_keys data_model: car native
<li><a href="#">code: remote_thread = search thread:remotecreate remote_thread = filter (start_function == "loadlibrarya" or start_function == "loadlibraryw") remote_thread = filter (src_image_path != "c:\path\to\trustedprogram.exe") output remote_thread
<li><a href="#">code: remote_threads = search thread:remote_create lsass_remote_create = filter remote_threads where "lsass" in raw event output lsass_remote_create data_model: car native
<li><a href="#">code: services = search service:create suspicious_services = filter services where image_path = "*\.exe" and image_path does not contain ["c:\\windows\\*", "%windir%\\*", "c:\\program file*", "c:\\programdata\\*", "%systemroot%\\*"] ) output suspicious_services data_model: car native
<li><a href="#">code: sourcetype = __your_sysmon_index__ parentimage = "c:\\windows\\system32\\cmd.exe" | where like(commandline,"reg.exe%hklm\\software\\microsoft\\windows\\currentversion\\policies\\system%reg_dword /d 0%") data_model: sysmon native
<li><a href="#">code: sourcetype='firewall_logs' dest_ip = 'internal_subnet' | stats dc(dest_port) as pcount by src_ip | where pcount >5 data_model: sysmon native
<li><a href="#">code: users_list = search usersession:login users_grouped = group users_list by hostname users_grouped = from users_grouped select min(time) as earliest_time, max(time) as latest_time count(user) as user_count multiple_logins = filter users_grouped where (latest_time - earliest_time <= 1 hour and user_count > 1) output multiple_logins
<li><a href="#">detection: # binary selector selection_base: image|endswith: '\mshta.exe' # suspicious parents selection1: parentimage|endswith: - '\cmd.exe' - '\powershell.exe' # suspicious folders selection2: commandline|contains: - '\appdata\local' - 'c:\windows\temp' - 'c:\users\public' # suspicious execution locations filter3: image|contains: - 'c:\windows\system32' - 'c:\windows\syswow64' # suspicious extensions filter4: commandline|contains: - '.htm' - '.hta' commandline|endswith: - 'mshta.exe' - 'mshta'
<li><a href="#">detection: # cmstp spawning child process selection: parentimage|endswith: '\cmstp.exe'
<li><a href="#">detection: # dropper selection1: parentimage|endswith: '\winword.exe' image|endswith: '.tmp' # binary execution selection2: image|endswith: '\wmic.exe' parentimage|contains: '\temp\' commandline|endswith: 'shadowcopy delete' # specific pattern selection3: commandline|endswith: 'shadowcopy delete' commandline|contains: '\..\..\system32'
<li><a href="#">detection: # process access call trace selection: calltrace|contains: 'cmlua.dll'
<li><a href="#">detection: # shutdown in safe mode immediately selection: commandline|contains: - 'shutdown /r /f /t 00' - 'net stop superbackupman'
<li><a href="#">detection: # webserver selection_webserver_image: parentimage|endswith: - '\w3wp.exe' - '\php-cgi.exe' - '\nginx.exe' - '\httpd.exe' - '\caddy.exe' - '\ws_tomcatservice.exe' selection_webserver_characteristics_tomcat1: parentimage|endswith: - '\java.exe' - '\javaw.exe' parentimage|contains: - '-tomcat-' - '\tomcat' selection_webserver_characteristics_tomcat2: parentimage|endswith: - '\java.exe' - '\javaw.exe' commandline|contains: - 'catalina.jar' - 'catalina_home' # suspicious child processes selection_child_1: # process dumping commandline|contains|all: - 'rundll32' - 'comsvcs.dll' selection_child_2: # winrar exfil commandline|contains|all: - ' -hp' - ' a ' - ' -m' selection_child_3: # user add commandline|contains|all: - 'net' - ' user ' - ' /add' selection_child_4: commandline|contains|all: - 'net' - ' localgroup ' - ' administrators ' - '/add' selection_child_5: image|endswith: # credential stealing - '\ntdsutil.exe' # ad recon - '\ldifde.exe' - '\adfind.exe' # process dumping - '\procdump.exe' - '\nanodump.exe' # destruction / ransom groups - '\vssadmin.exe' - '\fsutil.exe' selection_child_6: # suspicious patterns commandline|contains: - ' -nop ' # often used in malicious powershell commands - ' -w hidden ' # often used in malicious powershell commands - ' -decode ' # used with certutil - ' /decode ' # used with certutil - 'reg save ' # save registry sam - syskey extraction - '.downloadstring(' # powershell download command - '.downloadfile(' # powershell download command - 'frombase64string' # powershell encoded payload - ' /ticket:' # rubeus - ' sekurlsa' # mimikatz - '.dmp full' # process dumping method apart from procdump - 'process call create' # wmic process creation - 'whoami /priv'
<li><a href="#">detection: #useful_information: add more lolbins to the rules logic of your choice. selection: image|endswith: - '\regsvr32.exe' - '\rundll32.exe' - '\msiexec.exe' - '\mshta.exe' - '\verclsid.exe' - '\msdt.exe' parentimage|endswith: - '\winword.exe' - '\excel.exe' - '\powerpnt.exe' - '\msaccess.exe' - '\mspub.exe' - '\eqnedt32.exe'
<li><a href="#">detection: #useful_information: add more lolbins to the rules logic of your choice. selection_img: - image|endswith: '\wbem\wmic.exe' - originalfilename: 'wmic.exe' selection_other: commandline|contains: - 'regsvr32' - 'rundll32' - 'msiexec' - 'mshta' - 'verclsid' parentimage|endswith: - '\winword.exe' - '\excel.exe' - '\powerpnt.exe' commandline|contains|all: - 'process' - 'create' - 'call'
<li><a href="#">detection: #useful_information: add more lolbins to the rules logic of your choice. selection1: commandline|contains: - 'regsvr32' - 'rundll32' - 'msiexec' - 'mshta' - 'verclsid' selection2: - image|endswith: '\wbem\wmic.exe' - commandline|contains: 'wmic ' selection3: parentimage|endswith: - '\winword.exe' - '\excel.exe' - '\powerpnt.exe' selection4: commandline|contains|all: - 'process' - 'create' - 'call'
<li><a href="#">detection: #useful_information: add more lolbins to the rules logic of your choice. selection1: image|endswith: - '\regsvr32' - '\rundll32' - '\msiexec' - '\mshta' - '\verclsid' selection2: parentimage|endswith: \wbem\wmiprvse.exe
<li><a href="#">detection: #useful_information: add more office applications to the rule logic of choice selection_img: - image|endswith: '\wbem\wmic.exe' - originalfilename: 'wmic.exe' selection_parent: parentimage|endswith: - '\winword.exe' - '\excel.exe' - '\powerpnt.exe'
<li><a href="#">detection: #useful_information: add more office applications to the rule logic of choice selection1: - image|endswith: '\wbem\wmic.exe' - commandline|contains: 'wmic ' selection2: parentimage|endswith: - '\winword.exe' - '\excel.exe' - '\powerpnt.exe' - '\msaccess.exe' - '\mspub.exe' - '\eqnedt32.exe' - '\visio.exe'
<li><a href="#">detection: #useful_information: please add more file extensions to the logic of your choice. selection1: image|endswith: - '\winword.exe' - '\excel.exe' - '\powerpnt.exe' selection2: targetfilename|endswith: - '.exe' - '.dll' - '.ocx' - '.com' - '.ps1' - '.vbs' - '.sys' - '.bat' - '.scr' - '.proj' filter_webservicecache: # matches e.g. directory with name *.microsoft.com targetfilename|contains|all: - 'c:\users\' - '\appdata\local\microsoft\office\' - '\webservicecache\allusers' targetfilename|endswith: '.com' filter_webex: image|endswith: '\winword.exe' targetfilename|contains: '\appdata\local\temp\webexdelta\' targetfilename|endswith: - '.dll' - '.exe' filter_localassembly: targetfilename|contains: '\appdata\local\assembly\tmp\' targetfilename|endswith: '.dll'
<li><a href="#">detection: b64encoding: c-uri|contains: - '_2f' - '_2b' urlpatterns: c-uri|contains|all: - '.avi' - '/images/'
<li><a href="#">detection: base_url: cs-method: 'get' c-uri|contains|all: - '/include/makecvs.php' - '?event=' payload: c-uri|contains: - 'curl' - 'wget' - '.py' - '.sh' - 'chmod' - '_get'
<li><a href="#">detection: basic: - image|endswith: '\csi.exe' - image|endswith: '\rcsi.exe' renamed: - originalfilename: 'csi.exe' - originalfilename: 'rcsi.exe' selection: company: 'microsoft corporation'
<li><a href="#">detection: binary_1: image|endswith: '\fsutil.exe' binary_2: originalfilename: 'fsutil.exe' selection: commandline|contains: - 'deletejournal' # usn deletejournal ==> generally ransomware or attacker - 'createjournal' # usn createjournal ==> can modify config to set it to a tiny size
<li><a href="#">detection: binary_1: image|endswith: '\fsutil.exe' binary_2: originalfilename: 'fsutil.exe' selection: commandline|contains: 'drives'
<li><a href="#">detection: classes_base: eventtype: setvalue targetobject|contains: '\software\classes' classes: targetobject|contains: - '\folder\shellex\extshellfolderviews' - '\folder\shellex\dragdrophandlers' - '\folder\shellex\columnhandlers' - '\filter' - '\exefile\shell\open\command\(default)' - '\directory\shellex\dragdrophandlers' - '\directory\shellex\copyhookhandlers' - '\clsid\{ac757296-3522-4e11-9862-c17be5a1767e}\instance' - '\clsid\{abe3b9a4-257d-4b97-bd1a-294af496222e}\instance' - '\clsid\{7ed96837-96f0-4812-b211-f13c24117ed3}\instance' - '\clsid\{083863f1-70de-11d0-bd40-00a0c911ce86}\instance' - '\classes\allfilesystemobjects\shellex\dragdrophandlers' - '\.exe' - '\.cmd' - '\shellex\propertysheethandlers' - '\shellex\contextmenuhandlers' filter_empty: details: '(empty)' filter_msoffice: details: '{807583e5-5146-11d5-a672-00b0d022e945}' filter_drivers: image: 'c:\windows\system32\drvinst.exe'
<li><a href="#">detection: clientmailrules: commandline|contains: 'enableunsafeclientmailrules' outlookexec: parentimage|endswith: '\outlook.exe' commandline|contains|all: - '\\\\' - '\\' - '.exe'
<li><a href="#">detection: cmd1: a1|startswith: '--cpu-priority' cmd2: a2|startswith: '--cpu-priority' cmd3: a3|startswith: '--cpu-priority' cmd4: a4|startswith: '--cpu-priority' cmd5: a5|startswith: '--cpu-priority' cmd6: a6|startswith: '--cpu-priority' cmd7: a7|startswith: '--cpu-priority'
<li><a href="#">detection: cmd1: type: 'execve' a0: 'chmod' a1: '777' cmd2: type: 'execve' a0: 'chmod' a1: 'u+s' cmd3: type: 'execve' a0: 'cp' a1: '/bin/ksh' cmd4: type: 'execve' a0: 'cp' a1: '/bin/sh'
<li><a href="#">detection: cmdlet: scriptblocktext|contains: 'set-executionpolicy' option: scriptblocktext|contains: - 'unrestricted' - 'bypass' - 'remotesigned' filter: - parentimage: - 'c:\programdata\chocolatey\choco.exe' - scriptblocktext|contains: - "(new-object system.net.webclient).downloadstring('')" - "(new-object system.net.webclient).downloadstring('')"
<li><a href="#">detection: command: - 'remove-mailboxexportrequest' - ' -identity ' - ' -confirm "false"'
<li><a href="#">detection: commands: type: execve a0: - mkdir - touch - vim - nano - vi arguments: - a1|contains: '/.' - a1|startswith: '.' - a2|contains: '/.' - a2|startswith: '.'
<li><a href="#">detection: commands: type: execve a0: cat a1: a1|endswith: - '.jpg' - '.png' a2: a2|endswith: '.zip'
<li><a href="#">detection: commands: type: execve a0: unzip a1: a1|endswith: - '.jpg' - '.png'
<li><a href="#">detection: contains_format_pretty_arg: commandline|contains: - 'format:pretty' - 'format:"pretty"' - 'format:"text"' - 'format:text' image_from_system_folder: image|startswith: - 'c:\windows\system32\' - 'c:\windows\syswow64\' contains_winrm: commandline|contains: 'winrm'
<li><a href="#">detection: create_key: eventtype: renamekey newname: hkcr\clsid\{645ff040-5081-101b-9f08-00aa002f954e}\shell\open set_key: eventtype: setvalue targetobject: hkcr\clsid\{645ff040-5081-101b-9f08-00aa002f954e}\shell\open\command\(default)
<li><a href="#">detection: creation: targetobject|contains: 'software\microsoft\windows nt\currentversion\accessibility\ats' persistence: targetobject|contains: 'software\microsoft\windows nt\currentversion\accessibility\configuration'
<li><a href="#">detection: current_version_base: eventtype: setvalue targetobject|contains: '\software\microsoft\windows\currentversion' current_version: targetobject|contains: - '\shellserviceobjectdelayload' - '\run\' - '\runonce\' - '\policies\system\shell' - '\policies\explorer\run' - '\group policy\scripts\startup' - '\group policy\scripts\shutdown' - '\group policy\scripts\logon' - '\group policy\scripts\logoff' - '\explorer\shellserviceobjects' - '\explorer\shelliconoverlayidentifiers' - '\explorer\shellexecutehooks' - '\explorer\sharedtaskscheduler' - '\explorer\browser helper objects' - '\authentication\plap providers' - '\authentication\credential providers' - '\authentication\credential provider filters' filter_all: - details: '(empty)' - targetobject|endswith: '\ngcfirst\consecutiveswitchcount' - image|endswith: - '\appdata\local\microsoft\onedrive\update\onedrivesetup.exe' # c:\users\*\appdata\local\microsoft\onedrive\update\onedrivesetup.exe - '\appdata\roaming\spotify\spotify.exe' - image: - 'c:\windows\system32\devicecensus.exe' - 'c:\program files\microsoft onedrive\standaloneupdater\onedrivesetup.exe' - 'c:\program files\microsoft onedrive\update\onedrivesetup.exe' - 'c:\program files (x86)\microsoft onedrive\update\onedrivesetup.exe' - 'c:\program files\keepass password safe 2\shinstutil.exe' - 'c:\program files\everything\everything.exe' - 'c:\program files (x86)\microsoft office\root\integration\integrator.exe' filter_logonui: image: 'c:\windows\system32\logonui.exe' targetobject|contains: - '\authentication\credential providers\{d6886603-9d2f-4eb2-b667-1971041fa96b}\' # pin - '\authentication\credential providers\{bec09223-b018-416d-a0ac-523971b639f5}\' # fingerprint - '\authentication\credential providers\{8af662bf-65a0-4d0a-a540-a338a999d36f}\' # facial recognizion - '\authentication\credential providers\{27fbdb57-b613-4af2-9d7e-4fa7a66c21ad}\' # trusted signal (phone proximity, network location) filter_edge: image|startswith: - 'c:\program files (x86)\microsoft\edgeupdate\install\' - 'c:\program files (x86)\microsoft\edgewebview\' - 'c:\program files (x86)\microsoft\edge\application\msedge.exe' filter_dropbox: image: 'c:\windows\system32\regsvr32.exe' targetobject|contains: 'dropboxext' details|endswith: 'a251-47b7-93e1-cdd82e34af8b}' filter_opera: targetobject|endswith: '\software\microsoft\windows\currentversion\run\opera browser assistant' details: 'c:\program files\opera\assistant\browser_assistant.exe' filter_itunes: targetobject|endswith: '\software\microsoft\windows\currentversion\run\ituneshelper' details: '"c:\program files\itunes\ituneshelper.exe"' filter_zoom: targetobject|endswith: '\software\microsoft\windows\currentversion\runonce\zoommsirepair' details: '"c:\program files\zoom\bin\installer.exe" /repair' filter_greenshot: targetobject|endswith: '\software\microsoft\windows\currentversion\run\greenshot' details: 'c:\program files\greenshot\greenshot.exe' filter_googledrive1: targetobject|endswith: '\software\microsoft\windows\currentversion\run\googledrivefs' details|startswith: 'c:\program files\google\drive file stream\' details|endswith: '\googledrivefs.exe --startup_mode' filter_googledrive2: targetobject|contains: 'googledrive' details: - '{cfe8b367-77a7-41d7-9c90-75d16d7dc6b6}' - '{a8e52322-8734-481d-a7e2-27b309ef8d56}' - '{c973da94-cbdf-4e77-81d1-e5b794fbd146}' - '{51ef1569-67ee-4ad6-9646-e726c3ffc8a2}' filter_onedrive: details|startswith: 'c:\windows\system32\cmd.exe /q /c rmdir /s /q "c:\users\' details|contains: '\appdata\local\microsoft\onedrive\' filter_python: targetobject|endswith: '\software\microsoft\windows\currentversion\runonce\{c60fd5ac-367d-4e3a-a975-f157502ac30a}' details|contains: '\appdata\local\package cache\{c60fd5ac-367d-4e3a-a975-f157502ac30a}\python' details|endswith: '.exe" /burn.runonce' filter_officeclicktorun: image|startswith: - 'c:\program files\common files\microsoft shared\clicktorun\' - 'c:\program files\common files\microsoft shared\clicktorun\updates\' image|endswith: '\officeclicktorun.exe' filter_defender: image: 'c:\program files\windows defender\msmpeng.exe'
<li><a href="#">detection: detect_by_option: commandline|contains|all: - '--config ' - '--no-check-certificate ' - ' copy ' exec_selection: image|endswith: '\rclone.exe' parentimage|endswith: - '\powershell.exe' - '\cmd.exe' command_selection: commandline|contains: - 'pass' - 'user' - 'copy' - 'sync' - 'config' - 'lsd' - 'remote' - 'ls' - 'mega' - 'pcloud' - 'ftp' - 'ignore-existing' - 'auto-confirm' - 'transfers' - 'multi-thread-streams' - 'no-check-certificate ' description_selection: description: 'rsync for cloud storage'
<li><a href="#">detection: dns_answer: queryname: '*' querystatus: '0' filter_int_ip: queryresults|startswith: - '(::ffff:)?10.' - '(::ffff:)?192.168.' - '(::ffff:)?172.16.' - '(::ffff:)?172.17.' - '(::ffff:)?172.18.' - '(::ffff:)?172.19.' - '(::ffff:)?172.20.' - '(::ffff:)?172.21.' - '(::ffff:)?172.22.' - '(::ffff:)?172.23.' - '(::ffff:)?172.24.' - '(::ffff:)?172.25.' - '(::ffff:)?172.26.' - '(::ffff:)?172.27.' - '(::ffff:)?172.28.' - '(::ffff:)?172.29.' - '(::ffff:)?172.30.' - '(::ffff:)?172.31.' - '(::ffff:)?127.' timeframe: 30s
<li><a href="#">detection: dns_request: queryname: - canireachthe.net - ipv4.icanhazip.com - ip.anysrc.net - edns.ip-api.com - wtfismyip.com - checkip.dyndns.org - api.2ip.ua - icanhazip.com - api.ipify.org - ip-api.com - checkip.amazonaws.com - ipecho.net - ipinfo.io - ipv4bot.whatismyipaddress.com - freegeoip.app browser_process: image|endswith: - \chrome.exe - \iexplore.exe - \firefox.exe - \brave.exe - \opera.exe - \msedge.exe - \vivaldi.exe
<li><a href="#">detection: dns_request: queryname: - 'taf.teamviewer.com' - 'udp.ping.teamviewer.com' filter: image|contains: 'teamviewer'
<li><a href="#">detection: downloadfile: hostapplication|contains|all: - 'system.net.webclient' - '.downloadfile(' downloadstring: hostapplication|contains|all: - 'system.net.webclient' - '.downloadstring('
<li><a href="#">detection: dscl_create: image|endswith: '/dscl' commandline|contains: 'create' id_below_500: commandline|contains: uniqueid commandline|re: '([0-9]|[1-9][0-9]|[1-4][0-9]{2})' ishidden_option_declaration: commandline|contains: 'ishidden' ishidden_option_confirmation: commandline|contains: - 'true' - 'yes' - '1'
<li><a href="#">detection: empire: scriptblocktext|contains|all: # better to randomise the order - 'system.diagnostics.process' - 'stop-computer' - 'restart-computer' - 'exception in execution' - '$cmdargs' - 'close-dnscat2tunnel' dnscat: scriptblocktext|contains|all: # better to randomise the order - 'set type=$lookuptype`nserver' - '$command | nslookup 2>&1 | out-string' - 'new-randomdnsfield' - '[convert]::tostring($synoptions, 16)' - '$session.dead = $true' - '$session["driver"] -eq'
<li><a href="#">detection: encoded: image|endswith: '\powershell.exe' commandline|contains: - ' -e ' - ' -en ' - ' -enc ' - ' -enco' selection: commandline|contains: - ' jab' - ' suvyi' - ' sqbfafga' - ' awv4i' - ' iab' - ' paa' - ' aqblahga'
<li><a href="#">detection: encoded: image|endswith: '\powershell.exe' commandline|contains: ' hidden ' selection: commandline|contains: - 'agkadabzageazabtagkabgagac8adabyageabgbzagyazqbya' - 'axrzywrtaw4gl3ryyw5zzmvy' - 'iaaqb0ahmayqbkag0aaqbuacaalwb0ahiayqbuahmazgblahia' - 'jpdhnhzg1pbiavdhjhbnnmzx' - 'ygbpahqacwbhagqabqbpag4aiaavahqacgbhag4acwbmaguacg' - 'yml0c2fkbwluic90cmfuc2zlc' - 'agmaaab1ag4aawbfahmaaqb6agua' - 'jabjaggadqbuagsaxwbzagkaegbla' - 'jgnodw5rx3npem' - 'qaywboahuabgbraf8acwbpahoazq' - 'rjahvua19zaxpl' - 'y2h1bmtfc2l6z' - 'ae8algbdag8abqbwahiazqbzahmaaqbvag4a' - 'katwauaemabwbtahaacgblahmacwbpag8abg' - 'lplknvbxbyzxnzaw9u' - 'sqbpac4aqwbvag0acabyaguacwbzagkabwbua' - 'su8uq29tchjlc3npb2' - 'ty5db21wcmvzc2lvb' - 'ae8algbnaguabqbvahiaeqbtahqacgblageabq' - 'katwauae0azqbtag8acgb5afmadabyaguayqbta' - 'lplk1lbw9yevn0cmvhb' - 'sqbpac4atqblag0abwbyahkauwb0ahiazqbhag0a' - 'su8utwvtb3j5u3ryzwft' - 'ty5nzw1vcnltdhjlyw' - '4arwblahqaqwboahuabgbra' - '5hzxrdahvua' - 'aecazqb0aemaaab1ag4aaw' - 'lgbhaguadabdaggadqbuagsa' - 'lkdldenodw5r' - 'r2v0q2h1bm' - 'aegaugbfaeearabfaekatgbgae8anga0a' - 'qasabsaeuaqqbeaf8asqboaeyatwa2adqa' - 'riukvbrf9jtkzpnj' - 'sfjfqurfsu5gtzy0' - 'vabiafiarqbbaeqaxwbjae4argbpadyana' - 'vehsrufex0lork82n' - 'ahiazqbhahqazqbsaguabqbvahqazqbuaggacgblageaza' - 'cmvhdgvszw1vdgvuahjlyw' - 'macgblageadablafiazqbtag8adablafqaaabyaguayqbka' - 'nyzwf0zvjlbw90zvrocmvhz' - 'q3jlyxrlumvtb3rlvghyzwfk' - 'qwbyaguayqb0aguaugblag0abwb0aguavaboahiazqbhagqa' - '0azqbtag0abwb2agua' - '1lbw1vdm' - 'aguabqbtag8adgbla' - 'bqblag0abqbvahyazq' - 'bwvtbw92z' - 'zw1tb3zl'
<li><a href="#">detection: event_id: eventid: 4697 selection1: servicefilename|contains|all: - 'admin$' - '.exe' selection2: servicefilename|contains|all: - '%comspec%' - 'start' - 'powershell' selection3: servicefilename|contains: 'powershell -nop -w hidden -encodedcommand' selection4: servicefilename|base64offset|contains: "iex (new-object net.webclient).downloadstring(':"
<li><a href="#">detection: exec_selection: parentimage|endswith: '\userinit.exe' exec_exclusion1: image|endswith: - 'explorer.exe' - '\proquota.exe' exec_exclusion2: commandline|contains: - 'netlogon*.bat' - 'usrlogon.cmd' - 'c:\windows\explorer.exe' exec_exclusion3: image|endswith: '\citrix\system32\icast.exe' create_keywords_cli: commandline|contains: 'userinitmprlogonscript'
<li><a href="#">detection: execve: type: execve history: - '.bash_history' - '.zsh_history' - '.zhistory' - '.history' - '.sh_history' - 'fish_history'
<li><a href="#">detection: execve: type: 'execve' passwordgrep: - 'grep' - 'password'
<li><a href="#">detection: execve: type: 'execve' shutdowncmd: - 'shutdown' - 'reboot' - 'halt' - 'poweroff' init: - 'init' - 'telinit' initselection: - '0' - '6'
<li><a href="#">detection: execve: type: 'execve' touch: - 'touch' selection2: - '-t' - '-acmr' - '-d' - '-r'
<li><a href="#">detection: execve: type: 'execve' truncate: - 'truncate' - '-s' dd: - 'dd' - 'if=' filter: - 'of='
<li><a href="#">detection: export_command: - 'new-exchangecertificate' - ' -generaterequest' - ' -binaryencoded' - ' -requestfile' export_params: - '\\\\localhost\\c$' - '\\\\127.0.0.1\\c$' - 'c:\\inetpub' - '.aspx'
<li><a href="#">detection: export_command: - 'new-mailboxexportrequest' - ' -mailbox ' export_params: - '-filepath "\\\\localhost\\c$' - '-filepath "\\\\127.0.0.1\\c$' - '.aspx' role_assignment: - 'new-managementroleassignment' - ' -role "mailbox import export"' - ' -user '
<li><a href="#">detection: files: type: 'path' name: - '/etc/pam.d/common-password' - '/etc/security/pwquality.conf' - '/etc/pam.d/system-auth' - '/etc/login.defs' chage: type: 'execve' a0: 'chage' a1: - '--list' - '-l' passwd: type: 'execve' a0: 'passwd' a1: - '-s' - '--status'
<li><a href="#">detection: filter_1: device|contains: floppy filter_2: image|startswith: - 'c:\windows\system32\' - 'c:\windows\systemapps\' - 'c:\windows\winsxs\' - 'c:\windows\servicing\' - 'c:\windows\ccm\' - 'c:\windows\uus\' - 'c:\windows\winsxs\' filter_3: processid: 4 filter_specific: image: - 'c:\windows\uus\amd64\mousocoreworker.exe' - 'c:\windows\explorer.exe' filter_system: image: - 'system' - 'registry' filter_keybase: image|endswith: '\keybase\upd.exe' filter_windefender: image|startswith: 'c:\programdata\microsoft\windows defender\platform\' image|endswith: '\msmpeng.exe' filter_programfiles: # this rule causes so many fps that we have to do this image|startswith: - 'c:\program files\' - 'c:\program files (x86)\' filter_appdata: image|contains|all: - 'c:\users\' - '\appdata\' - '\microsoft\' filter_nextron: image|startswith: 'c:\windows\temp\asgard2-agent\' image|endswith: '\thor.exe' filter_startmenu_xphost: image|startswith: 'c:\windows\systemapps\microsoft.windows.startmenuexperiencehost' image|endswith: '\startmenuexperiencehost.exe'
<li><a href="#">detection: ftp_path: image|endswith: 'ftp.exe' ftp_metadata: originalfilename: 'ftp.exe' cmd_with_script_modifier: commandline|contains: '-s:' parent_path: parentimage|endswith: 'ftp.exe'
<li><a href="#">detection: generic_search: eventid: 30 searchfilter|contains: - '(grouptype:1.2.840.113556.1.4.803:=2147483648)' - '(grouptype:1.2.840.113556.1.4.803:=2147483656)' - '(grouptype:1.2.840.113556.1.4.803:=2147483652)' - '(grouptype:1.2.840.113556.1.4.803:=2147483650)' - '(samaccounttype=805306369)' - '(samaccounttype=805306368)' - '(samaccounttype=536870913)' - '(samaccounttype=536870912)' - '(samaccounttype=268435457)' - '(samaccounttype=268435456)' - '(objectcategory=grouppolicycontainer)' - '(objectcategory=organizationalunit)' - '(objectcategory=computer)' - '(objectcategory=ntdsdsa)' - '(objectcategory=server)' - '(objectcategory=domain)' - '(objectcategory=person)' - '(objectcategory=group)' - '(objectcategory=user)' - '(objectclass=trusteddomain)' - '(objectclass=computer)' - '(objectclass=server)' - '(objectclass=group)' - '(objectclass=user)' - '(primarygroupid=521)' - '(primarygroupid=516)' - '(primarygroupid=515)' - '(primarygroupid=512)' - 'domain admins' suspicious_flag: eventid: 30 searchfilter|contains: - '(useraccountcontrol:1.2.840.113556.1.4.803:=4194304)' - '(useraccountcontrol:1.2.840.113556.1.4.803:=2097152)' - '!(useraccountcontrol:1.2.840.113556.1.4.803:=1048574)' - '(useraccountcontrol:1.2.840.113556.1.4.803:=524288)' - '(useraccountcontrol:1.2.840.113556.1.4.803:=65536)' - '(useraccountcontrol:1.2.840.113556.1.4.803:=8192)' - '(useraccountcontrol:1.2.840.113556.1.4.803:=544)' - '!(useraccountcontrol:1.2.840.113556.1.4.803:=2)' - 'msds-allowedtoactonbehalfofotheridentity' - 'msds-allowedtodelegateto' - '(accountexpires=9223372036854775807)' - '(accountexpires=0)' - '(admincount=1)' - 'ms-mcs-admpwd' narrow_down_filter: eventid: 30 searchfilter|contains: - '(domainsid=*)' - '(objectsid=*)'
<li><a href="#">detection: grep_execution: image: '/usr/bin/grep' security_services_and_processes: commandline|contains: - 'nessusd' # nessus vulnerability scanner - 'santad' # google santa - 'cbdefense' # carbon black - 'falcond' # crowdstrike falcon - 'td-agent' # fluentd log shipper - 'packetbeat' # elastic network logger/shipper - 'filebeat' # elastic log file shipper - 'auditbeat' # elastic auditing agent/log shipper - 'osqueryd' # facebook osquery - 'blockblock' # objective-see persistence locations watcher/blocker - 'lulu' # objective-see firewall management utility little_snitch_process: # objective development software firewall management utility commandline|contains|all: - 'little' - 'snitch'
<li><a href="#">detection: grep_execution: image|endswith: '/grep' security_services_and_processes: commandline|contains: - 'nessusd' # nessus vulnerability scanner - 'td-agent' # fluentd log shipper - 'packetbeat' # elastic network logger/shipper - 'filebeat' # elastic log file shipper - 'auditbeat' # elastic auditing agent/log shipper - 'osqueryd' # facebook osquery - 'cbagentd' # carbon black - 'falcond' # crowdstrike falcon
<li><a href="#">detection: hashcat_basic: image|endswith: '\hashcat.exe' hashcat_option: commandline|contains|all: - '-a ' - '-m 1000 ' - '-r '
<li><a href="#">detection: ie: eventtype: setvalue targetobject|contains: - '\software\wow6432node\microsoft\internet explorer' - '\software\microsoft\internet explorer' ie_details: targetobject|contains: - '\toolbar' - '\extensions' - '\explorer bars' filter_empty: details: '(empty)' filter_extensions: targetobject|contains: - '\extensions\{2670000a-7350-4f3c-8081-5663ee0c6c49}' - '\extensions\{31d09ba0-12f5-4cce-be8a-2923e76605da}' - '\extensions\{789fe86f-6fc4-46a1-9849-ede0db0c95ca}' - '\extensions\{a95fe080-8f5d-11d2-a20b-00aa003c157a}' filter_toolbar: targetobject|endswith: - '\toolbar\shellbrowser\itbar7layout' - '\toolbar\showdiscussionbutton' - '\toolbar\locked'
<li><a href="#">detection: image: image|endswith: - '\cmd.exe' - '\powershell.exe' parent_image: parentimage|contains|all: - '\windows\installer\' - 'msi' parentimage|endswith: 'tmp'
<li><a href="#">detection: image_absolute_path: image|contains: '\' filter_null: image: null filter_empty: image: - '-' - '' filter_4688: - image: - 'registry' - 'memcompression' - commandline: - 'registry' - 'memcompression'
<li><a href="#">detection: image_path: image|endswith: '\gfxdownloadwrapper.exe' cmd_known_url: commandline|contains: 'gameplayapi.intel.com' same_parent: parentimage|endswith: '\gfxdownloadwrapper.exe'
<li><a href="#">detection: image_path: image|endswith: '\runscripthelper.exe' cmd: commandline|contains: 'surfacecheck'
<li><a href="#">detection: image_path: image|endswith: '\verclsid.exe' cmd_s: commandline|contains: '/s' cmd_c: commandline|contains: '/c'
<li><a href="#">detection: image_path: image|endswith: '\winword.exe' cmd: commandline|contains: '/l'
<li><a href="#">detection: import: type: execve a0: import import_window_root: a1: '-window' a2: 'root' a3|endswith: - '.png' - '.jpg' - '.jpeg' import_no_window_root: a1|endswith: - '.png' - '.jpg' - '.jpeg'
<li><a href="#">detection: integrity_level: integritylevel: 'medium' reg: commandline|contains|all: - 'reg' - 'add' powershell_1: commandline|contains: 'powershell' powershell_2: commandline|contains: - 'set-itemproperty' - ' sp ' - 'new-itemproperty' registry_folder: commandline|contains|all: - 'controlset' - 'services' registry_key: commandline|contains: - 'imagepath' - 'failurecommand' - 'servicedll'
<li><a href="#">detection: integrity_level: integritylevel: 'system' user: user|contains: # covers many language settings - 'authori' - 'autori' image_1: image|contains|all: - '\windows\installer\' - 'msi' image|endswith: 'tmp' image_2: image|endswith: '\msiexec.exe' filter_installer: parentimage: 'c:\windows\system32\services.exe' filter_repair: - commandline|endswith: '\system32\msiexec.exe /v' # ignore "repair option" - parentcommandline|endswith: '\system32\msiexec.exe /v' # ignore "repair option"
<li><a href="#">detection: keyword: - 'cat </dev/tcp/' - 'exec 3<>/dev/tcp/' - 'echo >/dev/tcp/' - 'bash -i >& /dev/tcp/' - 'sh -i >& /dev/udp/' - '0<&196;exec 196<>/dev/tcp/' - 'exec 5<>/dev/tcp/' - '(sh)0>/dev/tcp/' - 'bash -c ''bash -i >& /dev/tcp/' - 'echo -e ''#!/bin/bash\nbash -i >& /dev/tcp/'
<li><a href="#">detection: keyword: - 'networkd-dispatcher' - 'error handling notification for interface' - '../../'
<li><a href="#">detection: keyword: - 'pkexec' - 'the value for environment variable xauthority contains suscipious content' - '[user=root] [tty=/dev/pts/0]'
<li><a href="#">detection: keywords: - '${jndi:ldap:/' - '${jndi:rmi:/' - '${jndi:ldaps:/' - '${jndi:dns:/' - '/$%7bjndi:' - '%24%7bjndi:' - '$%7bjndi:' - '%2524%257bjndi' - '%2f%252524%25257bjndi%3a' - '${jndi:${lower:' - '${::-j}${' - '${jndi:nis' - '${jndi:nds' - '${jndi:corba' - '${jndi:iiop' - 'reference class name: foo' - '${${env:barfoo:-j}' - '${::-l}${::-d}${::-a}${::-p}' - '${base64:jhtqbmrp' - '${${env:env_name:-j}ndi${env:env_name:-:}$' - '${${lower:j}ndi:' - '${${upper:j}ndi:' - '${${::-j}${::-n}${::-d}${::-i}:' filter: - 'w.nessus.org/nessus' - '/nessus}'
<li><a href="#">detection: keywords: - '%24%7b%28%23a%3d%40' - '${(#a=@' - '%24%7b%40java' - '${@java' - 'u0022java' - '%2f%24%7b%23' - '/${#' - 'new+java.'
<li><a href="#">detection: keywords: - '(){:;};' - '() {:;};' - '() { :;};' - '() { :; };'
<li><a href="#">detection: keywords: - '* dropping source port zero packet from *' - '* denied axfr from *' - '* exiting (due to fatal error)*'
<li><a href="#">detection: keywords: - '*stopping iptables*' - '*stopping ip6tables*' - '*stopping firewalld*' - '*stopping cbdaemon*' - '*stopping falcon-sensor*'
<li><a href="#">detection: keywords: - '*unexpected internal error*' - '*unknown or unsupported key type*' - '*invalid certificate signing key*' - '*invalid elliptic curve value*' - '*incorrect signature*' - '*error in libcrypto*' - '*unexpected bytes remain after decoding*' - '*fatal: buffer_get_string: bad string*' - '*local: crc32 compensation attack*' - '*bad client public dh value*' - '*corrupted mac on input*'
<li><a href="#">detection: keywords: - '/basic/command/base64/' - '/basic/reverseshell/' - '/basic/tomcatmemshell' - '/basic/jettymemshell' - '/basic/weblogicmemshell' - '/basic/jbossmemshell' - '/basic/webspherememshell' - '/basic/springmemshell' - '/deserialization/urldns/' - '/deserialization/commonscollections1/dnslog/' - '/deserialization/commonscollections2/command/base64/' - '/deserialization/commonsbeanutils1/reverseshell/' - '/deserialization/jre8u20/tomcatmemshell' - '/tomcatbypass/dnslog/' - '/tomcatbypass/command/' - '/tomcatbypass/reverseshell/' - '/tomcatbypass/tomcatmemshell' - '/tomcatbypass/springmemshell' - '/groovybypass/command/' - '/webspherebypass/upload/'
<li><a href="#">detection: keywords: - '/etc/ld.so.preload'
<li><a href="#">detection: keywords: - '__pthread_tpp_change_priority: assertion `new_prio == -1 || (new_prio >= fifo_min_prio && new_prio <= fifo_max_prio)'
<li><a href="#">detection: keywords: - accessdeniedexception - csrfexception - invalidcsrftokenexception - missingcsrftokenexception - cookietheftexception - invalidcookieexception - requestrejectedexception
<li><a href="#">detection: keywords: - actioncontroller::invalidauthenticitytoken - actioncontroller::invalidcrossoriginrequest - actioncontroller::methodnotallowed - actioncontroller::badrequest - actioncontroller::parametermissing
<li><a href="#">detection: keywords: - 'attempt to execute code on stack by' - 'ftp login from .* 0bin0sh' - 'rpc.statd[\d+]: gethostbyname error for' - 'aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa'
<li><a href="#">detection: keywords: - 'begin {s = "/inet/tcp/0/' - 'bash -i >& /dev/tcp/' - 'bash -i >& /dev/udp/' - 'sh -i >$ /dev/udp/' - 'sh -i >$ /dev/tcp/' - '&& while read line 0<&5; do' - '/bin/bash -c exec 5<>/dev/tcp/' - '/bin/bash -c exec 5<>/dev/udp/' - 'nc -e /bin/sh ' - '/bin/sh | nc' - 'rm -f backpipe; mknod /tmp/backpipe p && nc ' - ';socket(s,pf_inet,sock_stream,getprotobyname("tcp"));if(connect(s,sockaddr_in($p,inet_aton($i))))' - ';stdin->fdopen($c,r);$~->fdopen($c,w);system$_ while<>;' - '/bin/sh -i <&3 >&3 2>&3' - 'uname -a; w; id; /bin/bash -i' - '$sendbyte = ([text.encoding]::ascii).getbytes($sendback2); $stream.write($sendbyte,0,$sendbyte.length); $stream.flush()};' - ';os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);os.putenv(''histfile'',''/dev/null'');' - '.to_i;exec sprintf("/bin/sh -i <&%d >&%d 2>&%d",f,f,f)' - ';while(cmd=c.gets);io.popen(cmd,"r"){|io|c.print' - 'socat exec:''bash -li'',pty,stderr,setsid,sigint,sane tcp:' - 'rm -f /tmp/p; mknod /tmp/p p &&' - ' | /bin/bash | telnet ' - ',echo=0,raw tcp-listen:' - 'nc -lvvp ' - 'xterm -display 1'
<li><a href="#">detection: keywords: - 'clear logging' - 'clear archive'
<li><a href="#">detection: keywords: - 'connection refused: too many sessions for this address.' - 'connection refused: tcp_wrappers denial.' - 'bad http verb.' - 'port and pasv both active' - 'pasv and port both active' - 'transfer done (but failed to open directory).' - 'could not set file modification time.' - 'bug: pid active in ptrace_sandbox_free' - 'ptrace_setoptions failure' - 'weird status:' - 'couldn''t handle sandbox event' - 'syscall * out of bounds' - 'syscall not permitted:' - 'syscall validate failed:' - 'input line too long.' - 'poor buffer accounting in str_netfd_alloc' - 'vsf_sysutil_read_loop'
<li><a href="#">detection: keywords: - 'crypto pki export' - 'crypto pki import' - 'crypto pki trustpoint'
<li><a href="#">detection: keywords: - dataerror - integrityerror - programmingerror - operationalerror
<li><a href="#">detection: keywords: - 'dir' - 'show processes' - 'show arp' - 'show cdp' - 'show version' - 'show ip route' - 'show ip interface' - 'show ip sockets' - 'show users' - 'show ssh' - 'show clock'
<li><a href="#">detection: keywords: - 'dpapi::masterkey' - 'eo.oe.kiwi' - 'event::clear' - 'event::drop' - 'gentilkiwi.com' - 'kerberos::golden' - 'kerberos::ptc' - 'kerberos::ptt' - 'kerberos::tgt' - 'kiwi legit printer' - 'lsadump::' - 'mimidrv.sys' - '\mimilib.dll' - 'misc::printnightmare' - 'misc::shadowcopies' - 'misc::skeleton' - 'privilege::backup' - 'privilege::debug' - 'privilege::driver' - 'sekurlsa::' filter: eventid: 15 # sysmon's filestream events (could cause false positives when sigma rules get copied on/to a system)
<li><a href="#">detection: keywords: - entered promiscuous mode - deactivating service - oversized packet received from - imuxsock begins to drop messages
<li><a href="#">detection: keywords: - 'erase' - 'delete' - 'format'
<li><a href="#">detection: keywords: - 'error: buffer_get_ret: trying to get more bytes 1907 than in buffer 308 [preauth]'
<li><a href="#">detection: keywords: - 'exit signal segmentation fault'
<li><a href="#">detection: keywords: - 'exited on signal 6 (core dumped)'
<li><a href="#">detection: keywords: - 'htool-' - 'hacktool' - 'asp/backdoor' - 'jsp/backdoor' - 'php/backdoor' - 'backdoor.asp' - 'backdoor.jsp' - 'backdoor.php' - 'webshell' - 'portscan' - 'mimikatz' - '.wincred.' # . are needed to avoid false positives with many other strings - 'plugx' - 'korplug' - 'pwdump' - 'chopper' - 'wmiexec' - 'xscan' - 'clearlog' - 'aspxspy' - 'ransom' - 'filecoder' - 'cobaltstr' # update 12.05.22 - 'pwcrack' - 'dumpcreds' - 'mpreter' - 'koadic' - 'packed.generic.347' - 'cobeacon' - 'cometer' - 'keylogger' - 'metetool' filter: - 'keygen' - 'crack' - 'anti_ransomware_service.exe' - 'cyber-protect-service.exe' filter_information: level: 4 # information level
<li><a href="#">detection: keywords: - 'http_proxy=*' - 'https_proxy=*'
<li><a href="#">detection: keywords: - 'ip http server' - 'ip https server' - 'kron policy-list' - 'kron occurrence' - 'policy-list' - 'access-list' - 'ip access-group' - 'archive maximum'
<li><a href="#">detection: keywords: - 'ln -s -f /etc/passwd' - 'ln -s /etc/passwd'
<li><a href="#">detection: keywords: - microsoft.authorization/roleassignments/write
<li><a href="#">detection: keywords: - microsoft.compute/virtualmachines/write - microsoft.resources/deployments/write
<li><a href="#">detection: keywords: - microsoft.documentdb/databaseaccounts/listkeys/action - microsoft.maps/accounts/listkeys/action - microsoft.media/mediaservices/listkeys/action - microsoft.cognitiveservices/accounts/listkeys/action - microsoft.storage/storageaccounts/listkeys/action - microsoft.compute/snapshots/write - microsoft.network/networksecuritygroups/write
<li><a href="#">detection: keywords: - 'monitor capture point' - 'set span' - 'set rspan'
<li><a href="#">detection: keywords: - 'no logging' - 'no aaa new-model'
<li><a href="#">detection: keywords: - 'rm *bash_history' - 'echo "" > *bash_history' - 'cat /dev/null > *bash_history' - 'cat /dev/zero > *bash_history' - 'ln -sf /dev/null *bash_history' - 'ln -sf /dev/zero *bash_history' - 'truncate -s0 *bash_history' # - 'unset histfile' # prone to false positives - 'export histfilesize=0' - 'history -c' - 'history -w' - 'shred *bash_history' - 'empty_bash_history' - 'chattr +i *bash_history'
<li><a href="#">detection: keywords: - 'show history' - 'show history all' - 'show logging'
<li><a href="#">detection: keywords: - 'show running-config' - 'show startup-config' - 'show archive config' - 'more'
<li><a href="#">detection: keywords: - 'shutdown' - 'config-register 0x2100' - 'config-register 0x2142'
<li><a href="#">detection: keywords: - suspiciousoperation # subclasses of suspiciousoperation - disallowedhost - disallowedmodeladminlookup - disallowedmodeladmintofield - disallowedredirect - invalidsessionkey - requestdatatoobig - suspiciousfileoperation - suspiciousmultipartform - suspicioussession - toomanyfieldssent # further security-related exceptions - permissiondenied
<li><a href="#">detection: keywords: - 'tftp' - 'rcp' - 'puts' - 'copy' - 'configure replace' - 'archive tar'
<li><a href="#">detection: keywords: - 'that did not meet the microsoft signing level requirements'
<li><a href="#">detection: keywords: - 'trojan*found' - 'virtool*found' - 'webshell*found' - 'rootkit*found' - 'htran*found'
<li><a href="#">detection: keywords: - 'username' - 'aaa'
<li><a href="#">detection: keywords: # distribution type and kernel version - 'cat /etc/issue' - 'cat /etc/*-release' - 'cat /proc/version' - 'uname -a' - 'uname -mrs' - 'rpm -q kernel' - 'dmesg | grep linux' - 'ls /boot | grep vmlinuz-' # environment variables - 'cat /etc/profile' - 'cat /etc/bashrc' - 'cat ~/.bash_profile' - 'cat ~/.bashrc' - 'cat ~/.bash_logout' # applications and services as root - 'ps -aux | grep root' - 'ps -ef | grep root' # scheduled tasks - 'crontab -l' - 'cat /etc/cron*' - 'cat /etc/cron.allow' - 'cat /etc/cron.deny' - 'cat /etc/crontab' # search for plain text user/passwords - 'grep -i user *' - 'grep -i pass *' # networking - 'ifconfig' - 'cat /etc/network/interfaces' - 'cat /etc/sysconfig/network' - 'cat /etc/resolv.conf' - 'cat /etc/networks' - 'iptables -l' - 'lsof -i' - 'netstat -antup' - 'netstat -antpx' - 'netstat -tulpn' - 'arp -e' - 'route' # sensitive files - 'cat /etc/passwd' - 'cat /etc/group' - 'cat /etc/shadow' # sticky bits - 'find / -perm -u=s' - 'find / -perm -g=s' - 'find / -perm -4000' - 'find / -perm -2000' timeframe: 30m
<li><a href="#">detection: keywords: # generic suspicious commands - 'wget * - http* | perl' - 'wget * - http* | sh' - 'wget * - http* | bash' - 'python -m simplehttpserver' - '-m http.server' # python 3 - 'import pty; pty.spawn*' - 'socat exec:*' - 'socat -o /tmp/*' - 'socat tcp-connect*' - '*echo binary >>*' # malware - '*wget *; chmod +x*' - '*wget *; chmod 777 *' - '*cd /tmp || cd /var/run || cd /mnt*' # apache struts in-the-wild exploit codes - '*stop;service iptables stop;*' - '*stop;susefirewall2 stop;*' - 'chmod 777 2020*' - '*>>/etc/rc.local' # metasploit framework exploit codes - '*base64 -d /tmp/*' - '* | base64 -d *' - '*/chmod u+s *' - '*chmod +s /tmp/*' - '*chmod u+s /tmp/*' - '* /tmp/haxhax*' - '* /tmp/ns_sploit*' - 'nc -l -p *' - 'cp /bin/ksh *' - 'cp /bin/sh *' - '* /tmp/*.b64 *' - '*/tmp/ysocereal.jar*' - '*/tmp/x *' - '*; chmod +x /tmp/*' - '*;chmod +x /tmp/*'
<li><a href="#">detection: keywords: # oracle - quoted string not properly terminated # mysql - you have an error in your sql syntax # sql server - unclosed quotation mark # sqlite - 'near "*": syntax error' - selects to the left and right of union do not have the same number of result columns
<li><a href="#">detection: known_image_extension: image|endswith: - '.exe' - '.tmp' # sadly many installers use this extension filter_null: image: null filter_image: # windows utilities without extension image: - 'registry' - 'memcompression' filter_empty: image: - '-' - '' filter_starts: image|startswith: 'c:\windows\installer\msi' filter_pstarts: parentimage|startswith: - 'c:\programdata\avira\' - 'c:\windows\system32\driverstore\filerepository\' filter_screensaver: image|endswith: '.scr' filter_nvidia: image|contains: 'nvidia\nvbackend\' image|endswith: '.dat' filter_com: image|startswith: - 'c:\windows\system32\' - 'c:\windows\syswow64\' image|endswith: '.com' filter_winscp: image|endswith: '\winscp.com' filter_vscode: image|contains|all: - 'c:\users\' - '\appdata\' - '.tmp' - 'codesetup' filter_libreoffice: image|endswith: '\program\soffice.bin' filter_emc_networker: image: - 'c:\program files\emc networker\management\gst\apache\cgi-bin\update_jnlp.cgi' - 'c:\program files (x86)\emc networker\management\gst\apache\cgi-bin\update_jnlp.cgi' filter_winpakpro: image|startswith: - 'c:\program files (x86)\winpakpro\' - 'c:\program files\winpakpro\' image|endswith: '.ngn' filter_myq_server: image: - 'c:\program files (x86)\myq\server\pcltool.dll' - 'c:\program files\myq\server\pcltool.dll' filter_visualstudio: image|startswith: - 'c:\program files\microsoft visual studio\' - 'c:\program files (x86)\microsoft visual studio' image|endswith: '.com' filter_msi_rollbackfiles: image|startswith: 'c:\config.msi\' image|endswith: - '.rbf' - '.rbs' filter_wsl: image|contains|all: - '\appdata\local\packages\' - '\localstate\rootfs\' filter_lzma_exe: image|endswith: '\lzma_exe'
<li><a href="#">detection: launchctl_unload: image: '/bin/launchctl' commandline|contains: 'unload' security_plists: commandline|contains: - 'com.objective-see.lulu.plist' # objective-see firewall management utility - 'com.objective-see.blockblock.plist' # objective-see persistence locations watcher/blocker - 'com.google.santad.plist' # google santa - 'com.carbonblack.defense.daemon.plist' # carbon black - 'com.carbonblack.daemon.plist' # carbon black - 'at.obdev.littlesnitchd.plist' # objective development software firewall management utility - 'com.tenablesecurity.nessusagent.plist' # tenable nessus - 'com.opendns.osx.roamingclientconfigupdater.plist' # opendns umbrella - 'com.crowdstrike.falcond.plist' # crowdstrike falcon - 'com.crowdstrike.userdaemon.plist' # crowdstrike falcon - 'osquery' # facebook osquery - 'filebeat' # elastic log file shipper - 'auditbeat' # elastic auditing agent/log shipper - 'packetbeat' # elastic network logger/shipper - 'td-agent' # fluentd log shipper disable_gatekeeper: image: '/usr/sbin/spctl' commandline|contains: 'disable'
<li><a href="#">detection: legitimate_process_path: image|contains: - ':\program files(x86)\' - ':\program files\' legitimate_executable: sha1: 'e570585edc69f9074cb5e8a790708336bd45ca0f'
<li><a href="#">detection: lolbas: - commandline|contains: configsecuritypolicy.exe - image|endswith: '\configsecuritypolicy.exe' - originalfilename: 'configsecuritypolicy.exe' remote: commandline|contains: - 'https://' - 'http://' - 'ftp://'
<li><a href="#">detection: lolbas: - image|endswith: '\ieexec.exe' - originalfilename: 'ieexec.exe' remote: commandline|contains: - 'https://' - 'http://'
<li><a href="#">detection: lolbas: image|endswith: '\offlinescannershell.exe' filter_correct: currentdirectory: 'c:\program files\windows defender\offline\' filter_missing: currentdirectory: null
<li><a href="#">detection: lolbin: - image|endswith: '\ie4uinit.exe' - originalfilename: 'ie4uinit.exe' filter_correct: currentdirectory: - 'c:\windows\system32\' - 'c:\windows\syswow64\' filter_missing: currentdirectory: null
<li><a href="#">detection: main_selection: eventtype: setvalue targetobject|contains: - '\software\wow6432node\microsoft\windows ce services\autostart' - '\software\wow6432node\microsoft\command processor\autorun' - '\software\wow6432node\microsoft\active setup\installed components' - '\software\microsoft\windows ce services\autostartondisconnect' - '\software\microsoft\windows ce services\autostartonconnect' - '\system\setup\cmdline' - '\software\microsoft\ctf\langbaraddin' - '\software\microsoft\command processor\autorun' - '\software\microsoft\active setup\installed components' - '\software\classes\protocols\handler' - '\software\classes\protocols\filter' - '\software\classes\htmlfile\shell\open\command\(default)' - '\environment\userinitmprlogonscript' - '\software\policies\microsoft\windows\control panel\desktop\scrnsave.exe' - '\software\microsoft\internet explorer\urlsearchhooks' - '\software\microsoft\internet explorer\desktop\components' - '\software\classes\clsid\{ab8902b4-09ca-4bb6-b78d-a8f59079a8d5}\inprocserver32' - '\control panel\desktop\scrnsave.exe' filter_empty: details: '(empty)' filter_msoffice: - targetobject|contains: - '\office\clicktorun\registry\machine\software\classes\protocols\handler\' - '\clicktorunstore\hkmu\software\classes\protocols\handler\' - details: - '{314111c7-a502-11d2-bbca-00c04f8ec294}' - '{3459b272-cc19-4448-86c9-ddc3b4b2fad3}' - '{42089d2d-912d-4018-9087-2b87803e93fb}' - '{5504be45-a83b-4808-900a-3a5c36e7f77a}' - '{807583e5-5146-11d5-a672-00b0d022e945}' filter_chrome: targetobject|contains: '\software\microsoft\active setup\installed components\{8a69d345-d564-463c-aff1-a69d9e530f96}\' filter_edge: targetobject|contains: '\software\microsoft\active setup\installed components\{9459c573-b17a-45ae-9f64-1857b5d58cee}\' filter_ie: targetobject|contains: '\software\microsoft\active setup\installed components\{89820200-ecbd-11cf-8b85-00aa005b4383}\' filter_image: image: - 'c:\windows\system32\poqexec.exe' - 'c:\program files (x86)\microsoft office\root\integration\integrator.exe' filter_office: image|startswith: - 'c:\program files\common files\microsoft shared\clicktorun\' - 'c:\program files\common files\microsoft shared\clicktorun\updates\' image|endswith: '\officeclicktorun.exe'
<li><a href="#">detection: methprocess: parentimage|endswith: '\eventvwr.exe' filterprocess: image|endswith: '\mmc.exe'
<li><a href="#">detection: netcat: image|endswith: - '/nc' - '/netcat' network_scanning_tools: image|endswith: - '/telnet' # could be wget, curl, ssh, many things. basically everything that is able to do network connection. consider fine tuning - '/nmap' netcat_listen_flag: commandline|contains: 'l'
<li><a href="#">detection: netcommand1: commandline: 'net view /domain' netcommand2: commandline: 'net session' netcommand3: commandline: 'net share' timeframe: 1m
<li><a href="#">detection: netstat: commandline|contains: netstat net_cmd: commandline|contains: 'net ' net_opt: - commandline|endswith: - ' use' - ' sessions' - commandline|contains: - ' use ' - ' sessions '
<li><a href="#">detection: network_cmd1: commandline|contains|all: - 'netsh ' - 'show ' - 'firewall ' network_cmd2: commandline|contains: - 'config ' - 'state ' - 'rule ' - 'name=all'
<li><a href="#">detection: nt_current_version_base: eventtype: setvalue targetobject|contains: '\software\microsoft\windows nt\currentversion' nt_current_version: targetobject|contains: - '\winlogon\vmapplet' - '\winlogon\userinit' - '\winlogon\taskman' - '\winlogon\shell' - '\winlogon\gpextensions' - '\winlogon\appsetup' - '\winlogon\alternateshells\availableshells' - '\windows\iconservicelib' - '\windows\appinit_dlls' - '\image file execution options' - '\font drivers' - '\drivers32' - '\windows\run' - '\windows\load' filter_empty: details: '(empty)' filter_edge: image|startswith: 'c:\program files (x86)\microsoft\temp\' image|endswith: '\microsoftedgeupdate.exe' filter_msoffice: - targetobject|contains: - '\clicktorunstore\hklm\software\microsoft\windows nt\currentversion\' - '\clicktorun\registry\machine\software\microsoft\windows nt\currentversion\' - image: - 'c:\program files\microsoft office\root\integration\integrator.exe' - 'c:\program files (x86)\microsoft office\root\integration\integrator.exe' - targetobject|endswith: - '\image file execution options\ospprearm.exe\disableexceptionchainvalidation' - '\image file execution options\liclua.exe\disableexceptionchainvalidation' filter_dropbox: image|endswith: '\dropboxupdate.exe' targetobject|endswith: '\image file execution options\dropboxupdate.exe\disableexceptionchainvalidation' filter_officeclicktorun: image|startswith: - 'c:\program files\common files\microsoft shared\clicktorun\' - 'c:\program files\common files\microsoft shared\clicktorun\updates\' image|endswith: '\officeclicktorun.exe' filter_security_extension_dc: image: 'c:\windows\system32\svchost.exe' targetobject|contains: - '\winlogon\gpextensions\{827d319e-6eac-11d2-a4ea-00c04f79f83a}\previouspolicyareas' - '\winlogon\gpextensions\{827d319e-6eac-11d2-a4ea-00c04f79f83a}\maxnogpolistchangesinterval' details: - 'dword (0x00000009)' - 'dword (0x000003c0)' filter_ngen: image|startswith: 'c:\windows\microsoft.net\framework' image|endswith: '\ngen.exe'
<li><a href="#">detection: office: eventtype: setvalue targetobject|contains: - '\software\wow6432node\microsoft\office' - '\software\microsoft\office' office_details: targetobject|contains: - '\word\addins' - '\powerpoint\addins' - '\outlook\addins' - '\onenote\addins' - '\excel\addins' - '\access\addins' - 'test\special\perf' filter_empty: details: '(empty)' filter_excel: # known addins for excel targetobject|contains: - '\excel\addins\adhocreportingexcelclientlib.adhocreportingexcelclientaddin.1\' - '\excel\addins\excelpluginshell.powermapconnect\' - '\excel\addins\nativeshim\' - '\excel\addins\nativeshim.inquireconnector.1\' - '\excel\addins\powerpivotexcelclientaddin.nativeentry.1\' filter_outlook: # known addins for outlook targetobject|contains: - '\outlook\addins\accessaddin.dc\' - '\outlook\addins\colleagueimport.colleagueimportaddin\' - '\outlook\addins\evernotecc.evernotecontactconnector\' - '\outlook\addins\evernoteolrd.connect\' - '\outlook\addins\microsoft.vbaaddinforoutlook.1\' - '\outlook\addins\ocoffice.ocforms\' - '\outlook\addins\oscaddin.connect\' - '\outlook\addins\outlookchangenotifier.connect\' - '\outlook\addins\ucaddin.lyncaddin.1' - '\outlook\addins\ucaddin.ucaddin.1' - '\outlook\addins\umoutlookaddin.formregionaddin\' filter_officeclicktorun: image|startswith: - 'c:\program files\common files\microsoft shared\clicktorun\' - 'c:\program files\common files\microsoft shared\clicktorun\updates\' image|endswith: '\officeclicktorun.exe' filter_avg: image: 'c:\program files\avg\antivirus\regsvr.exe' targetobject|contains: '\microsoft\office\outlook\addins\antivirus.asoutext\'
<li><a href="#">detection: op1: endpoint: 'jobadd' operation: 'atsvc' op2: endpoint: 'itaskschedulerservice' operation: 'schrpcenabletask' op3: endpoint: 'itaskschedulerservice' operation: 'schrpcregistertask' op4: endpoint: 'itaskschedulerservice' operation: 'schrpcrun' op5: endpoint: 'iwbemservices' operation: 'execmethod' op6: endpoint: 'iwbemservices' operation: 'execmethodasync' op7: endpoint: 'svcctl' operation: 'createservicea' op8: endpoint: 'svcctl' operation: 'createservicew' op9: endpoint: 'svcctl' operation: 'startservicea' op10: endpoint: 'svcctl' operation: 'startservicew'
<li><a href="#">detection: op1: endpoint: 'spoolss' operation: 'rpcaddmonitor' op2: endpoint: 'spoolss' operation: 'rpcaddprintprocessor' op3: endpoint: 'iremotewinspool' operation: 'rpcasyncaddmonitor' op4: endpoint: 'iremotewinspool' operation: 'rpcasyncaddprintprocessor' op5: endpoint: 'iseclogon' operation: 'seclcreateprocesswithlogonw' op6: endpoint: 'iseclogon' operation: 'seclcreateprocesswithlogonexw'
<li><a href="#">detection: option: commandline|contains: - ' -executionpolicy ' - ' -ep ' - ' -exec ' level: commandline|contains: - 'unrestricted' - 'bypass' - 'remotesigned'
<li><a href="#">detection: parameters: commandline|contains: - ' -decode ' - ' -decodehex ' - ' -urlcache ' - ' -verifyctl ' - ' -encode ' - ' /decode ' - ' /decodehex ' - ' /urlcache ' - ' /verifyctl ' - ' /encode ' certutil: image|endswith: '\certutil.exe' commandline|contains: - 'url' - 'ping'
<li><a href="#">detection: parent_selection: parentimage|endswith: '\cmd.exe' parentcommandline|endswith: '.bat' selection1: image|endswith: '\xcopy.exe' commandline|contains|all: - 'powershell.exe' - '.bat.exe' selection2: image|endswith: '\attrib.exe' commandline|contains|all: - '+s' - '+h' - '.bat.exe'
<li><a href="#">detection: path: type: 'path' nametype: 'create' name_1: name|startswith: - '/usr/lib/systemd/system/' - '/etc/systemd/system/' name_2: name|contains: '/.config/systemd/user/'
<li><a href="#">detection: path_events: type: path name: - '/etc/pam.d/system-auth' - '/etc/pam.d/password-auth' tty_events: type: - 'tty' - 'user_tty'
<li><a href="#">detection: path_traversal: # cve-2021-20090 (bypass auth: path traversal) c-uri|contains: '..%2f' config_file_inj: c-uri|contains|all: # chaining of cve-2021-20090 (bypass auth) and cve-2021-20091 (config file injection) - '..%2f' - 'apply_abstract.cgi' noauth_list: c-uri|contains: - '/images/' - '/js/' - '/css/' - '/setup_top_login.htm' - '/login.html' - '/loginerror.html' - '/loginexclude.html' - '/loginlock.html'
<li><a href="#">detection: powershell_execution: commandline|contains: 'powershell.exe' snippets: commandline|contains: - 'join*split' # line 343ff - '( $shellid[1]+$shellid[13]+''x'')' - '( $pshome[*]+$pshome[*]+' - '( $env:public[13]+$env:public[5]+''x'')' - '( $env:comspec[4,*,25]-join'''')' - '[1,3]+''x''-join'''')'
<li><a href="#">detection: powershell_module: image|endswith: '\powershell.exe' commandline|contains|all: - 'pester' - 'get-help' cmd_execution: image|endswith: '\cmd.exe' commandline|contains|all: - 'pester' - ';' get_help: commandline|contains: - 'help' - '?'
<li><a href="#">detection: powershell_started: image|endswith: '\powershell.exe' redirect_to_input_stream: commandline|re: '\s-\s*<'
<li><a href="#">detection: process_name: image|endswith: '\runonce.exe' process_description: description: 'run once wrapper' command_line: commandline|contains: ' /alternateshellstartup'
<li><a href="#">detection: process_name: image|endswith: '\tracker.exe' process_description: description: 'tracker' commandline_param1: commandline|contains: ' /d ' commandline_param2: commandline|contains: ' /c '
<li><a href="#">detection: reg: image|endswith: \reg.exe commandline|contains|all: - ' query ' - '/t ' - 'reg_sz' - '/s' hive: - commandline|contains|all: - '/f ' - 'hklm' - commandline|contains|all: - '/f ' - 'hkcu' - commandline|contains: 'hkcu\software\simontatham\putty\sessions'
<li><a href="#">detection: request_client: - imageloaded|endswith: - '\wsmsvc.dll' - '\wsmauto.dll' - '\microsoft.wsman.management.ni.dll' - originalfilename: - wsmsvc.dll - wsmanautomation.dll - microsoft.wsman.management.dll respond_server: image|endswith: '\svchost.exe' originalfilename: 'wsmwmipl.dll' filter_general: image|endswith: - '\powershell.exe' - 'c:\windows\system32\sdiagnhost.exe' - 'c:\windows\system32\services.exe' filter_svchost: # not available in sysmon data, but aurora logs commandline|contains: - 'svchost.exe -k netsvcs -p -s bits' - 'svchost.exe -k graphicsperfsvcgroup -s graphicsperfsvc' - 'svchost.exe -k networkservice -p -s wecsvc' - 'svchost.exe -k netsvcs' filter_mscorsvw: #image: c:\windows\microsoft.net\framework64\v4.0.30319\mscorsvw.exe image|startswith: - c:\windows\microsoft.net\framework64\v - c:\windows\microsoft.net\framework\v image|endswith: \mscorsvw.exe filter_svr_2019: image: - 'c:\windows\system32\configure-smremoting.exe' - 'c:\windows\system32\servermanager.exe' filter_nextron: image|startswith: 'c:\windows\temp\asgard2-agent\' filter_citrix: image|startswith: 'c:\program files\citrix\'
<li><a href="#">detection: run: commandline|contains|all: - '/generic:microsoft_windows_shell_zipfolder:filename=' - '.zip' - '/pass:' - '/user:' delete: commandline|contains|all: - '/delete' - 'microsoft_windows_shell_zipfolder:filename=' - '.zip'
<li><a href="#">detection: rundll_image: image|endswith: '\rundll32.exe' rundll_ofn: originalfilename: 'rundll32.exe' selection: commandline|contains|all: - 'comsvcs' - 'minidump' #matches minidump and minidumpw - 'full'
<li><a href="#">detection: samrpipe: eventid: 5145 relativetargetname: samr passwordchanged: eventid: 4738 passwordchanged_filter: passwordlastset: timeframe: 15s
<li><a href="#">detection: sc: - image|endswith: '\sc.exe' - originalfilename: 'sc.exe' cli: commandline|contains|all: - 'sdset' - 'dclcwpdtsd'
<li><a href="#">detection: sc_cmd: image|endswith: '\cmd.exe' commandline|contains|all: - 'sc config' - 'wercplsupporte.dll' wmic_cmd: image|endswith: '\wmic.exe' commandline|endswith: 'cor_profiler'
<li><a href="#">detection: scbynonadmin: image|endswith: '\sc.exe' integritylevel: 'medium' binpath: commandline|contains|all: - 'config' - 'binpath' failurecommand: commandline|contains|all: - 'failure' - 'command'
<li><a href="#">detection: schtasks: image|endswith: '\schtasks.exe' option: commandline|contains|all: - '/create ' - '\appdata\local\temp' filter_klite_codec: commandline|contains|all: - '/create /tn "klcp_update" /xml ' - '\klcp_update_task.xml'
<li><a href="#">detection: schtasks_exe: image|endswith: \schtasks.exe commandline|contains|all: - /change - /tn - /disable #split to add other schtasks_name: commandline|contains: '\microsoft\windows\systemrestore\sr'
<li><a href="#">detection: scripts_base: eventtype: setvalue targetobject|contains: '\software\policies\microsoft\windows\system\scripts' scripts: targetobject|contains: - '\startup' - '\shutdown' - '\logon' - '\logoff' filter: details: '(empty)'
<li><a href="#">detection: select_convert_b64: scriptblocktext|contains|all: - '-nop' - ' -w ' - 'hidden' - ' -c ' - '[convert]::frombase64string' select_iex_selection: scriptblocktext|contains|all: - ' -w ' - 'hidden' - '-noni' - '-nop' - ' -c ' - 'iex' - 'new-object' select_enc_selection: scriptblocktext|contains|all: - ' -w ' - 'hidden' - '-ep' - 'bypass' - '-enc' select_reg_selection: scriptblocktext|contains|all: - 'powershell' - 'reg' - 'add' - 'hkcu\software\microsoft\windows\currentversion\run' select_webclient_selection: scriptblocktext|contains|all: - 'bypass' - '-noprofile' - '-windowstyle' - 'hidden' - 'new-object' - 'system.net.webclient' - '.download' select_iex_webclient: scriptblocktext|contains|all: - 'iex' - 'new-object' - 'net.webclient' - '.download' filter_chocolatey: scriptblocktext|contains: - "(new-object system.net.webclient).downloadstring('" - "(new-object system.net.webclient).downloadstring('')" - 'write-chocolateywarning'
<li><a href="#">detection: select_file_with_asterisk: image: '/usr/bin/file' commandline|re: '(.){200,}' # execution of the 'file */* *>> /tmp/output.txt' will produce huge commandline select_recursive_ls: image: '/bin/ls' commandline|contains: '-r' select_find_execution: image: '/usr/bin/find' select_mdfind_execution: image: '/usr/bin/mdfind' select_tree_execution|endswith: image: '/tree'
<li><a href="#">detection: select_file_with_asterisk: image|endswith: '/file' commandline|re: '(.){200,}' # execution of the 'file */* *>> /tmp/output.txt' will produce huge commandline select_recursive_ls: image|endswith: '/ls' commandline|contains: '-r' select_find_execution: image|endswith: '/find' select_tree_execution: image|endswith: '/tree'
<li><a href="#">detection: select_malicious: scriptblocktext|contains: - 'invoke-dllinjection' - 'invoke-shellcode' - 'invoke-wmicommand' - 'get-gpppassword' - 'get-keystrokes' - 'get-timedscreenshot' - 'get-vaultcredential' - 'invoke-credentialinjection' - 'invoke-mimikatz' - 'invoke-ninjacopy' - 'invoke-tokenmanipulation' - 'out-minidump' - 'volumeshadowcopytools' - 'invoke-reflectivepeinjection' - 'invoke-userhunter' - 'find-gpolocation' - 'invoke-aclscanner' - 'invoke-downgradeaccount' - 'get-serviceunquoted' - 'get-servicefilepermission' - 'get-servicepermission' - 'invoke-serviceabuse' - 'install-servicebinary' - 'get-regautologon' - 'get-vulnautorun' - 'get-vulnschtask' - 'get-unattendedinstallfile' - 'get-applicationhost' - 'get-regalwaysinstallelevated' - 'get-unconstrained' - 'add-regbackdoor' - 'add-scrnsavebackdoor' - 'gupt-backdoor' - 'invoke-adsbackdoor' - 'enabled-duplicatetoken' - 'invoke-psuacme' - 'remove-update' - 'check-vm' - 'get-lsasecret' - 'get-passhashes' - 'show-targetscreen' - 'port-scan' - 'invoke-poshrathttp' - 'invoke-powershelltcp' - 'invoke-powershellwmi' - 'add-exfiltration' - 'add-persistence' - 'do-exfiltration' - 'start-captureserver' - 'get-chromedump' - 'get-clipboardcontents' - 'get-foxdump' - 'get-indexeditem' - 'get-screenshot' - 'invoke-inveigh' - 'invoke-netripper' - 'invoke-egresscheck' - 'invoke-postexfil' - 'invoke-psinject' - 'invoke-runas' - 'mailraider' - 'new-honeyhash' - 'set-macattribute' - 'invoke-dcsync' - 'invoke-powerdump' - 'exploit-jboss' - 'invoke-thunderstruck' - 'invoke-voicetroll' - 'set-wallpaper' - 'invoke-inveighrelay' - 'invoke-psexec' - 'invoke-sshcommand' - 'get-securitypackages' - 'install-ssp' - 'invoke-backdoorlnk' - 'powerbreach' - 'get-sitelistpassword' - 'get-system' - 'invoke-bypassuac' - 'invoke-tater' - 'invoke-wscriptbypassuac' - 'powerup' - 'powerview' - 'get-rickastley' - 'find-fruit' - 'http-login' - 'find-trusteddocuments' - 'invoke-paranoia' - 'invoke-winenum' - 'invoke-arpscan' - 'invoke-portscan' - 'invoke-reversednslookup' - 'invoke-smbscanner' - 'invoke-mimikittenz' - 'invoke-allchecks' - 'invoke-badpotato' - 'invoke-bettersafetykatz' - 'invoke-carbuncle' - 'invoke-certify' - 'invoke-daft' - 'invoke-dinvokekatz' - 'invoke-eyewitness' - 'invoke-fakelogonscreen' - 'invoke-farmer' - 'invoke-get-rbcd-threaded' - 'invoke-gopher' - 'invoke-grouper2' - 'invoke-handlekatz' - 'invoke-internalmonologue' - 'invoke-krbrelayup' - 'invoke-ldapsigncheck' - 'invoke-lockless' - 'invoke-mitm6' - 'invoke-nanodump' - 'invoke-oxidresolver' - 'invoke-p0wnedshell' - 'invoke-ppldump' - 'invoke-rubeus' - 'invoke-scshell' - 'invoke-safetykatz' - 'invoke-sauroneye' - 'invoke-seatbelt' - 'invoke-sharpersist' - 'invoke-sharpallowedtoact' - 'invoke-sharpblock' - 'invoke-sharpbypassuac' - 'invoke-sharpchromium' - 'invoke-sharpclipboard' - 'invoke-sharpcloud' - 'invoke-sharpdpapi' - 'invoke-sharpdump' - 'invoke-sharpgpo-remoteaccesspolicies' - 'invoke-sharpgpoabuse' - 'invoke-sharphandler' - 'invoke-sharphide' - 'invoke-sharphound4' - 'invoke-sharpimpersonation' - 'invoke-sharpimpersonationnospace' - 'invoke-sharpkatz' - 'invoke-sharpldaprelayscan' - 'invoke-sharploginprompt' - 'invoke-sharpmove' - 'invoke-sharpprintnightmare' - 'invoke-sharpprinter' - 'invoke-sharprdp' - 'invoke-sharpssdp' - 'invoke-sharpsecdump' - 'invoke-sharpsniper' - 'invoke-sharpsploit' - 'invoke-sharpspray' - 'invoke-sharpstay' - 'invoke-sharpup' - 'invoke-sharpwatson' - 'invoke-sharphound2' - 'invoke-sharphound3' - 'invoke-sharplocker' - 'invoke-sharpshares' - 'invoke-sharpview' - 'invoke-sharpweb' - 'invoke-snaffler' - 'invoke-spoolsample' - 'invoke-standin' - 'invoke-stickynotesextract' - 'invoke-thunderfox' - 'invoke-tokenvator' - 'invoke-urbanbishop' - 'invoke-whisker' - 'invoke-wiretap' - 'invoke-winpeas' - 'invoke-zerologon' - 'get-usbkeystrokes' - 'start-webcamrecorder' false_positive1: scriptblocktext|contains: - get-systemdriveinfo # - c:\programdata\amazon\ec2-windows\launch\module\ # false positive form amazon ec2 false_positive2: scriptblocktext|startswith: '# copyright 2016 amazon.com, inc. or its affiliates. all rights reserved'
<li><a href="#">detection: select_method: cs-method: 'get' keywords: - '=(script)' - '=%3cscript%3e' - '=%253cscript%253e' - 'iframe ' - '%3ciframe ' - 'svg ' - '%3csvg ' - 'document.cookie' - 'document.domain' - ' onerror=' - ' onresize=' - ' onload="' - 'onmouseover=' - '${alert' - 'javascript:alert' - 'javascript%3aalert' filter: sc-status: 404
<li><a href="#">detection: select_method: cs-method: 'get' keywords: - '={{' - '=%7b%7b' - '=${' - '=$%7b' - '=<%=' - '=%3c%25=' - '=@(' - 'freemarker.template.utility.execute' - .getclass().forname('javax.script.scriptenginemanager') - 't(org.apache.commons.io.ioutils)' filter: sc-status: 404
<li><a href="#">detection: select_method: cs-method: 'get' keywords: - '=select' - 'union select' - 'union%20select' - 'union all select' - 'union%20all%20select' - 'concat(0x' - 'order by ' - 'order%20by%20' - 'information_schema.tables' - 'group_concat(' - 'table_schema' - 'select%28sleep%2810%29' - '@@version' - "'1'='1" - '%271%27%3d%271' - 'selectchar(' - 'select * ' - 'select%20*%20' - 'or 1=1#' - 'or%201=1#' filter: sc-status: 404 filter_fps: - '=select2'
<li><a href="#">detection: select_method: cs-method: 'get' keywords: - =whoami - =net%20user - =cmd%20/c%20 - =powershell%20 - =tasklist%20 - =wmic%20 - =ssh%20 #available on windows - =python%20 - =ipconfig - =wget%20 #available on windows - =curl%20 #available on windows - =certutil - =copy%20%5c%5c
<li><a href="#">detection: select_pipe_com: commandline|contains|all: - '\appdata\local\temp\' - '\\\\.\\pipe\\' select_rundll32_dash1: image|endswith: '\rundll32.exe' commandline|endswith: - '.dat,#1' - '.dat #1' # sysmon removes comma select_perfc_keyword: - '\perfc.dat'
<li><a href="#">detection: selection: - commandline: - tasklist - net time - systeminfo - whoami - nbtstat - net start - qprocess - nslookup - hostname.exe - 'netstat -an' - commandline|endswith: - '\net1 start' - '\net1 user /domain' - '\net1 group /domain' - '\net1 group "domain admins" /domain' - '\net1 group "exchange trusted subsystem" /domain' - '\net1 accounts /domain' - '\net1 user net localgroup administrators' timeframe: 15s
<li><a href="#">detection: selection: - commandline|base64offset|contains: - 'iex ([' - 'iex ([' - 'iex (new' - 'iex (new' # utf16 le - commandline|contains: - 'sqbfafgaiaaoafsa' - 'karqbyacaakabba' - 'jaeuawaagacgaww' - 'aqblahgaiaaoafsa' - 'kazqb4acaakabba' - 'paguaeaagacgaww' - 'aqblahgaiaaoae4azqb3a' - 'kazqb4acaakaboaguadw' - 'paguaeaagacgatgblahca' - 'sqbfafgaiaaoae4azqb3a' - 'karqbyacaakaboaguadw' - 'jaeuawaagacgatgblahca'
<li><a href="#">detection: selection: - commandline|base64offset|contains: '::frombase64string' # utf-16 le - commandline|contains: - 'oga6aeyacgbvag0aqgbhahmazqa2adqauwb0ahiaaqbuagca' - 'oaogbgahiabwbtaeiayqbzaguanga0afmadabyagkabgbna' - '6adoargbyag8abqbcageacwbladyanabtahqacgbpag4azw'
<li><a href="#">detection: selection: - commandline|contains: extexport.exe - image|endswith: '\extexport.exe' - originalfilename: 'extexport.exe'
<li><a href="#">detection: selection: - commandline|contains: tasklist - image: c:\windows\system32\tasklist.exe
<li><a href="#">detection: selection: - commandline|contains|all: - '\appdata\roaming\oracle' - '\java' - '.exe ' - commandline|contains|all: - 'cscript.exe' - 'retrive' - '.vbs '
<li><a href="#">detection: selection: - commandline|contains|all: - '\regsvr32' - '\appdata\local\' - commandline|contains|all: - '\appdata\local\' - ',dllentry' filter_1: - commandline|contains: 'appdata\local\microsoft\teamsmeetingaddin\' - commandline|endswith: - '\x86\microsoft.teams.addinloader.dll' - '\x86\microsoft.teams.addinloader.dll"' - '\x64\microsoft.teams.addinloader.dll' - '\x64\microsoft.teams.addinloader.dll"'
<li><a href="#">detection: selection: - commandline|contains|all: - 'del ' - /f - commandline|contains|all: - rmdir - /s - /q
<li><a href="#">detection: selection: - commandline|contains|all: - 'javascript:' - '.registerxll' - commandline|contains|all: - 'url.dll' - 'openurl' - commandline|contains|all: - 'url.dll' - 'openurla' - commandline|contains|all: - 'url.dll' - 'fileprotocolhandler' - commandline|contains|all: - 'zipfldr.dll' - 'routethecall' - commandline|contains|all: - 'shell32.dll' - 'control_rundll' - commandline|contains|all: - 'shell32.dll' - 'shellexec_rundll' - commandline|contains|all: - 'mshtml.dll' - 'printhtml' - commandline|contains|all: - 'advpack.dll' - 'launchinfsection' - commandline|contains|all: - 'advpack.dll' - 'registerocx' - commandline|contains|all: - 'ieadvpack.dll' - 'launchinfsection' - commandline|contains|all: - 'ieadvpack.dll' - 'registerocx' - commandline|contains|all: - 'ieframe.dll' - 'openurl' - commandline|contains|all: - 'shdocvw.dll' - 'openurl' - commandline|contains|all: - 'syssetup.dll' - 'setupinfobjectinstallaction' - commandline|contains|all: - 'setupapi.dll' - 'installhinfsection' - commandline|contains|all: - 'pcwutl.dll' - 'launchapplication' - commandline|contains|all: - 'dfshim.dll' - 'shopenverbapplication' - commandline|contains|all: - 'dfshim.dll' - 'shopenverbshortcut'
<li><a href="#">detection: selection: - commandline|contains|all: - 'localgroup' - 'admin' - '/add' - commandline|contains: - '\win64.exe'
<li><a href="#">detection: selection: - commandline|re: '\$pshome\[\s*\d{1,3}\s*\]\s*\+\s*\$pshome\[' - commandline|re: '\$shellid\[\s*\d{1,3}\s*\]\s*\+\s*\$shellid\[' - commandline|re: '\$env:public\[\s*\d{1,3}\s*\]\s*\+\s*\$env:public\[' - commandline|re: '\$env:comspec\[(\s*\d{1,3}\s*,){2}' - commandline|re: '\\\\*mdr\\\\*\w\s*\)\.name' - commandline|re: '\$verbosepreference\.tostring\(' - commandline|re: '\\\\string\]\s*\$verbosepreference'
<li><a href="#">detection: selection: - c-uri-query|contains: '/flash_install.php' - c-uri-query|endswith: '/install_flash_player.exe' filter: c-uri-stem|contains: '.adobe.com/'
<li><a href="#">detection: selection: - description: anydesk - product: anydesk - company: anydesk software gmbh
<li><a href="#">detection: selection: - description: 'goto opener' - product: 'goto opener' - company: 'logmein, inc.'
<li><a href="#">detection: selection: - description: lmiguardiansvc - product: lmiguardiansvc - company: logmein, inc.
<li><a href="#">detection: selection: - description: 'radmin viewer' - product: 'radmin viewer' - originalfilename: 'radmin.exe'
<li><a href="#">detection: selection: - description: 'screenconnect service' - product: 'screenconnect' - company: 'screenconnect software'
<li><a href="#">detection: selection: - description: 'windows powershell' - product: 'powershell core 6' filter: commandline|contains: - 'bxor' - '-join ' - '-join''' - '-join"' - '-join`' - 'char' false_positives: parentimage: c:\program files\amazon\ssm\ssm-document-worker.exe
<li><a href="#">detection: selection: - eventid: 4624 subjectusersid: 's-1-0-0' logontype: '3' logonprocessname: 'ntlmssp' keylength: '0' - eventid: 4624 logontype: '9' logonprocessname: 'seclogo' filter: targetusername: 'anonymous logon'
<li><a href="#">detection: selection: - filename|contains: - '\appdata\local\google\chrome\user data\default\network\cookies' - '\appdata\local\chrome\user data\default\login data' - '\appdata\local\google\chrome\user data\local state' - filename|endswith: - '\appdata\local\microsoft\windows\webcache\webcachev01.dat' - '\cookies.sqlite' - 'release\key3.db' #firefox - 'release\key4.db' #firefox - 'release\logins.json' #firefox filter_browser: image|endswith: - '\firefox.exe' - '\chrome.exe' filter_programfile: image|startswith: - 'c:\program files\' - 'c:\program files (x86)\' - 'c:\windows\system32\' filter_antimalware: image|endswith: - '\msmpeng.exe' - '\mpcopyaccelerator.exe'
<li><a href="#">detection: selection: - filename|startswith: - 'c:\windows\' - 'c:\temp\' - 'c:\perflogs\' - 'c:\users\public\' - 'c:\users\default\' - filename|contains: - '\client\' - '\tsclient\' - '\inetpub\' - '/www/' - 'apache' - 'tomcat' - 'nginx' - 'weblogic' selection2: filename|endswith: - '.asax' - '.ashx' - '.asmx' - '.asp' - '.aspx' - '.bat' - '.cfm' - '.cgi' - '.chm' - '.cmd' - '.dat' - '.ear' - '.gif' - '.hta' - '.jpeg' - '.jpg' - '.jsp' - '.jspx' - '.lnk' - '.php' - '.pl' - '.png' - '.ps1' - '.psm1' - '.py' - '.pyc' - '.rb' - '.scf' - '.sct' - '.sh' - '.svg' - '.txt' - '.vbe' - '.vbs' - '.war' - '.wsf' - '.wsh' - '.xml'
<li><a href="#">detection: selection: - image|contains: - ':\recycler\' - ':\systemvolumeinformation\' - image|startswith: - 'c:\windows\tasks\' - 'c:\windows\debug\' - 'c:\windows\fonts\' - 'c:\windows\help\' - 'c:\windows\drivers\' - 'c:\windows\addins\' - 'c:\windows\cursors\' - 'c:\windows\system32\tasks\'
<li><a href="#">detection: selection: - image|contains: - '\$recycle.bin\' - '\config\systemprofile\' - '\intel\logs\' - '\rsa\machinekeys\' - '\users\all users\' - '\users\default\' - '\users\networkservice\' - '\users\public\' - '\windows\addins\' - '\windows\debug\' - '\windows\fonts\' - '\windows\help\' - '\windows\ime\' - '\windows\media\' - '\windows\repair\' - '\windows\security\' - '\windows\system32\tasks\' - '\windows\tasks\' - image|startswith: 'c:\perflogs\' false_positive: image|startswith: 'c:\users\public\ibm\clientsolutions\start_programs\'
<li><a href="#">detection: selection: - image|contains: - '\goldenpac' - '\karmasmb' - '\kintercept' - '\ntlmrelayx' - '\rpcdump' - '\samrdump' - '\secretsdump' - '\smbexec' - '\smbrelayx' - '\wmiexec' - '\wmipersist' - image|endswith: # - '\addcomputer_windows.exe' - '\atexec_windows.exe' - '\dcomexec_windows.exe' - '\dpapi_windows.exe' # - '\esentutl_windows.exe' - '\finddelegation_windows.exe' - '\getadusers_windows.exe' # - '\getarch_windows.exe' - '\getnpusers_windows.exe' - '\getpac_windows.exe' - '\getst_windows.exe' - '\gettgt_windows.exe' - '\getuserspns_windows.exe' - '\ifmap_windows.exe' # - '\lookupsid_windows.exe' - '\mimikatz_windows.exe' # - '\mqtt_check_windows.exe' # - '\mssqlclient_windows.exe' # - '\mssqlinstance_windows.exe' - '\netview_windows.exe' - '\nmapanswermachine_windows.exe' #- '\ntfs-read_windows.exe' - '\opdump_windows.exe' # - '\ping6_windows.exe' # - '\ping_windows.exe' - '\psexec_windows.exe' # - '\raisechild_windows.exe' - '\rdp_check_windows.exe' #- '\registry-read_windows.exe' #- '\reg_windows.exe' - '\sambapipe_windows.exe' # - '\services_windows.exe' - '\smbclient_windows.exe' - '\smbserver_windows.exe' - '\sniffer_windows.exe' - '\sniff_windows.exe' - '\split_windows.exe' - '\ticketer_windows.exe' # - '\wmiquery_windows.exe'
<li><a href="#">detection: selection: - image|contains: # - '\programdata\\' # too many false positives, e.g. with webex for windows - '\users\all users\' - '\users\default\' - '\users\public\' - '\users\contacts\' - '\users\searches\' - '\config\systemprofile\' - '\windows\fonts\' - '\windows\ime\' - '\windows\addins\' - image|endswith: - '\$recycle.bin' - image|startswith: - 'c:\perflogs\' false_positive1: image|startswith: 'c:\users\public\ibm\clientsolutions\start_programs\' # ibm client solutions default location
<li><a href="#">detection: selection: - image|endswith: - '\rar.exe' - '\winrar.exe' - description: 'command line rar' dumpfile: commandline|contains: '.dmp'
<li><a href="#">detection: selection: - image|endswith: - '\rar.exe' - '\winrar.exe' - description: 'command line rar' filter: image|contains: - '\winrar' - 'c:\windows\temp' - '\unrar.exe'
<li><a href="#">detection: selection: - image|endswith: '\anydesk.exe' - description: anydesk - product: anydesk - company: anydesk software gmbh filter: image|contains: - '\\appdata\\' - 'program files (x86)\\anydesk' - 'program files\\anydesk'
<li><a href="#">detection: selection: - image|endswith: '\curl.exe' - product: 'the curl executable'
<li><a href="#">detection: selection: - image|endswith: '\dumpminitool.exe' - originalname: 'dumpminitool.exe' filter_folder: image|contains: - '\microsoft visual studio\' - '\extensions\' # susp_flags: commandline|contains: '.txt' cmd_has_flags: commandline|contains: ' full' filter_cmd_misses_flags: commandline|contains: '--dumptype'
<li><a href="#">detection: selection: - image|endswith: '\esentutl.exe' commandline|contains: - 'vss' - ' /m ' - ' /y ' - commandline|contains: - '\windows\ntds\ntds.dit' - '\config\sam' - '\config\security' - '\config\system ' # space needed to avoid false positives with \config\systemprofile\ - '\repair\sam' - '\repair\system' - '\repair\security' - '\config\regback\sam' - '\config\regback\system' - '\config\regback\security'
<li><a href="#">detection: selection: - image|endswith: \fsianycpu.exe - originalfilename: fsianycpu.exe - image|endswith: \fsi.exe - originalfilename: fsi.exe
<li><a href="#">detection: selection: - image|endswith: '\ilasm.exe' - originalfilename: 'ilasm.exe'
<li><a href="#">detection: selection: - image|endswith: '\iodine.exe' - image|contains: '\dnscat2'
<li><a href="#">detection: selection: - image|endswith: '\regini.exe' - originalfilename: 'regini.exe' filter: commandline|re: ':[^ \\\\]' # to avoid intersection with ads rule
<li><a href="#">detection: selection: - image|endswith: '\regini.exe' - originalfilename: 'regini.exe' selection_re: commandline|re: ':[^ \\\\]'
<li><a href="#">detection: selection: - image|endswith: \remote.exe - originalfilename: remote.exe
<li><a href="#">detection: selection: - image|endswith: '\sc.exe' commandline|contains|all: - 'create' - 'binpath' - image|endswith: '\powershell.exe' commandline|contains: 'new-service'
<li><a href="#">detection: selection: - image|endswith: '\tshark.exe' commandline|contains: '-i' - image|endswith: '\windump.exe'
<li><a href="#">detection: selection: - image|endswith: '\visualuiaverifynative.exe' - originalfilename: 'visualuiaverifynative.exe'
<li><a href="#">detection: selection: - image|endswith: '\wfc.exe' - originalfilename: 'wfc.exe'
<li><a href="#">detection: selection: - image|endswith: '\whoami.exe' - originalfilename: 'whoami.exe'
<li><a href="#">detection: selection: - image|endswith: '\whoami.exe' - originalfilename: 'whoami.exe' filter1: parentimage|endswith: - '\cmd.exe' - '\powershell.exe' filter2: parentimage: - 'c:\program files\microsoft monitoring agent\agent\monitoringhost.exe' - '' filter3: parentimage: null selection_special: commandline|contains: - 'whoami -all' - 'whoami /all' - 'whoami.exe -all' - 'whoami.exe /all'
<li><a href="#">detection: selection: - image|endswith: '\wmic.exe' - originalfilename: 'wmic.exe' selection2: commandline|contains|all: - 'process' - 'call' - 'create ' recon_part1: commandline|contains: ' path ' recon_part2: commandline|contains: - 'antivirus' - 'firewall' commandline|contains|all: - 'product' - ' get '
<li><a href="#">detection: selection: - image|endswith: '\wmic.exe' commandline|contains: '/format' # wmic process list /format /? - image|endswith: '\msxsl.exe' false_positives: commandline|contains: - '/format:list' - '/format:htable' - '/format:hform' - '/format:table' - '/format:mof' - '/format:value' - '/format:rawxml' - '/format:xml' - '/format:csv'
<li><a href="#">detection: selection: - image|endswith: '\wsmprovhost.exe' - parentimage|endswith: '\wsmprovhost.exe'
<li><a href="#">detection: selection: - image|endswith: '\xordump.exe' - commandline|contains: - ' -process lsass.exe ' - ' -m comsvcs ' - ' -m dbghelp ' - ' -m dbgcore '
<li><a href="#">detection: selection: - image|endswith: ëš\rubeus.exe' - originalfilename: 'rubeus.exe' - commandline|contains: - ' asreproast ' - ' dump /service:krbtgt ' - ' kerberoast ' - ' createnetonly /program:' - ' ptt /ticket:' - ' /impersonateuser:' - ' renew /ticket:' - ' asktgt /user:' - ' harvest /interval:' - ' s4u /user:' - ' s4u /ticket:' - ' hash /password:'
<li><a href="#">detection: selection: - image|endswith: pktmon.exe - originalfilename: pktmon.exe
<li><a href="#">detection: selection: - image|endswith: ttdinject.exe - originalfilename: ttdinject.exe
<li><a href="#">detection: selection: - imageloaded|endswith: - '\credui.dll' - '\wincredui.dll' - originalfilename: - 'credui.dll' - 'wincredui.dll' filter: - image|startswith: - 'c:\windows\system32\' - 'c:\windows\explorer.exe' - 'c:\program files\' - 'c:\users\\*\appdata\local\microsoft\onedrive\\*\microsoft.sharepoint.exe' - 'c:\program files (x86)\' - 'c:\windows\immersivecontrolpanel\systemsettings.exe' - 'c:\users\\*\appdata\local\microsoft\onedrive\onedrive.exe' - 'c:\users\\*\appdata\roaming\spotify\spotify.exe' - image|endswith: '\opera_autoupdate.exe' - image|contains: '\local\microsoft\onedrive\'
<li><a href="#">detection: selection: - imphash: - bcca3c247b619dcd13c8cdff5f123932 # petitpotam - 3a19059bd7688cb88e70005f18efc439 # petitpotam - 9da6d5d77be11712527dcab86df449a3 # mimikatz - a6e01bc1ab89f8d91d9eab72032aae88 # mimikatz - d21bbc50dcc169d7b4d0f01962793154 # mimikatz - 9528a0e91e28fbb88ad433feabca2456 # mimikatz - 4c1b52a19748428e51b14c278d0f58e3 # mimikatz - 725bb81dc24214f6ecacc0cfb36ad30d # mimikatz - 672b13f4a0b6f27d29065123fe882dfc # mimikatz - 0c106686a31bfe2ba931ae1cf6e9dbc6 # mimikatz - 23867a89c2b8fc733be6cf5ef902f2d1 # juicypotato - 9fb060c2977a9d9b782440b98d410c3e # roguepotato - b18a1401ff8f444056d29450fbc0a6ce # pwdump - 13f08707f759af6003837a150a371ba1 # pwdump - 749a7bb1f0b4c4455949c0b2bf7f9e9f # pwdump - 94cb940a1a6b65bed4d5a8f849ce9793 # pwdumpx - 1781f06048a7e58b323f0b9259be798b # pwdump - cb567f9498452721d77a451374955f5f # pwdump - 730073214094cd328547bf1f72289752 # htran - 6eefd92bffbfb27f378b81c09ca96786 # ncat - ac615fb1d93576fa3c26077a619c9144 # ncat - dc25ee78e2ef4d36faa0badf1e7461c9 # cobalt strike beacons - 17b461a082950fc6332228572138b80c # cobalt strike beacons - c547f2e66061a8dffb6f5a3ff63c0a74 # ppldump - 0588081ab0e63ba785938467e1b10cca # ppldump - ada161bf41b8e5e9132858cb54cab5fb # driploader - 2a1bc4913cd5ecb0434df07cb675b798 # driploader - 11083e75553baae21dc89ce8f9a195e4 # driploader - a23d29c9e566f2fa8ffbb79267f5df80 # driploader - hashes|contains: # sysmon field hashes contains all types - imphash=bcca3c247b619dcd13c8cdff5f123932 # petitpotam - imphash=3a19059bd7688cb88e70005f18efc439 # petitpotam - imphash=9da6d5d77be11712527dcab86df449a3 # mimikatz - imphash=a6e01bc1ab89f8d91d9eab72032aae88 # mimikatz - imphash=d21bbc50dcc169d7b4d0f01962793154 # mimikatz - imphash=9528a0e91e28fbb88ad433feabca2456 # mimikatz - imphash=4c1b52a19748428e51b14c278d0f58e3 # mimikatz - imphash=725bb81dc24214f6ecacc0cfb36ad30d # mimikatz - imphash=672b13f4a0b6f27d29065123fe882dfc # mimikatz - imphash=0c106686a31bfe2ba931ae1cf6e9dbc6 # mimikatz - imphash=23867a89c2b8fc733be6cf5ef902f2d1 # juicypotato - imphash=9fb060c2977a9d9b782440b98d410c3e # roguepotato - imphash=b18a1401ff8f444056d29450fbc0a6ce # pwdump - imphash=13f08707f759af6003837a150a371ba1 # pwdump - imphash=749a7bb1f0b4c4455949c0b2bf7f9e9f # pwdump - imphash=94cb940a1a6b65bed4d5a8f849ce9793 # pwdumpx - imphash=1781f06048a7e58b323f0b9259be798b # pwdump - imphash=cb567f9498452721d77a451374955f5f # pwdump - imphash=730073214094cd328547bf1f72289752 # htran - imphash=6eefd92bffbfb27f378b81c09ca96786 # ncat - imphash=ac615fb1d93576fa3c26077a619c9144 # ncat - imphash=dc25ee78e2ef4d36faa0badf1e7461c9 # cobalt strike beacons - imphash=17b461a082950fc6332228572138b80c # cobalt strike beacons - imphash=c547f2e66061a8dffb6f5a3ff63c0a74 # ppldump - imphash=0588081ab0e63ba785938467e1b10cca # ppldump - imphash=ada161bf41b8e5e9132858cb54cab5fb # driploader - imphash=2a1bc4913cd5ecb0434df07cb675b798 # driploader - imphash=11083e75553baae21dc89ce8f9a195e4 # driploader - imphash=a23d29c9e566f2fa8ffbb79267f5df80 # driploader
<li><a href="#">detection: selection: - 'install-transportagent'
<li><a href="#">detection: selection: - 'mod_security: access denied' - 'modsecurity: access denied' - 'mod_security-message: access denied' timeframe: 120m
<li><a href="#">detection: selection: - originalfilename: 'advancedrun.exe' - commandline|contains|all: - ' /exefilename ' - ' /run' - commandline|contains|all: - ' /windowstate 0' - ' /runas ' - ' /commandline '
<li><a href="#">detection: selection: - originalfilename: 'openconsole.exe' - image|endswith: '\openconsole.exe' filter: image|startswith: 'c:\program files\windowsapps\microsoft.windowsterminal' # we exclude the default path for windowsterminal
<li><a href="#">detection: selection: - originalfilename: 'psservice.exe' - image|endswith: - '\psservice.exe' - '\psservice64.exe'
<li><a href="#">detection: selection: - payload|contains: get-smbshare - contextinfo|contains: get-smbshare
<li><a href="#">detection: selection: - pipename|re: '\\\\mojo\.5688\.8052\.(?:183894939787088877|35780273329370473)[0-9a-f]{2}' - pipename|re: '\\\\wkssvc_?[0-9a-f]{2}' - pipename|re: '\\\\ntsvcs[0-9a-f]{2}' - pipename|re: '\\\\dsernamepipe[0-9a-f]{2}' - pipename|re: '\\\\searchtextharvester[0-9a-f]{2}' - pipename|re: '\\\\mypipe\-(?:f|h)[0-9a-f]{2}' - pipename|re: '\\\\windows\.update\.manager[0-9a-f]{2,3}' - pipename|re: '\\\\ntsvcs_[0-9a-f]{2}' - pipename|re: '\\\\scerpc_?[0-9a-f]{2}' - pipename|re: '\\\\pgmessagepipe[0-9a-f]{2}' - pipename|re: '\\\\msftewds[0-9a-f]{2}' - pipename|re: '\\\\f4c3[0-9a-f]{2}' - pipename|re: '\\\\fullduplex_[0-9a-f]{2}' - pipename|re: '\\\\msrpc_[0-9a-f]{4}' - pipename|re: '\\\\win\\\\msrpc_[0-9a-f]{2}' - pipename|re: '\\\\f53f[0-9a-f]{2}' - pipename|re: '\\\\rpc_[0-9a-f]{2}' - pipename|re: '\\\\spoolss_[0-9a-f]{2}' - pipename|re: '\\\\winsock2\\\\catalogchangelistener-[0-9a-f]{3}-0,'
<li><a href="#">detection: selection: - product: 'uacme' - company: 'revol corp' - originalfilename: 'akagi.exe'
<li><a href="#">detection: selection: - product|contains: 'mouse lock' - company|contains: 'misc314' - commandline|contains: 'mouse lock_'
<li><a href="#">detection: selection: - 'rm /var/log/syslog' - 'rm -r /var/log/syslog' - 'rm -f /var/log/syslog' - 'rm -rf /var/log/syslog' - 'mv /var/log/syslog' - ' >/var/log/syslog' - ' > /var/log/syslog' falsepositives: - '/syslog.'
<li><a href="#">detection: selection: - 'set-oabvirtualdirectory' - 'externalurl' - 'page_load' - 'script'
<li><a href="#">detection: selection: - signature|startswith: - 'htool' - 'hktl' - 'securitytool' - 'atk/' # sophos - signature|contains: - 'hacktool'
<li><a href="#">detection: selection: - signature|startswith: - 'php/' - 'jsp/' - 'asp/' - 'perl/' - 'php.' - 'jsp.' - 'asp.' - 'perl.' - 'vbs/uxor' # looking for 'vbs/' would also find downloaders and droppers meant for desktops - 'iis/backdoor' - 'java/backdoor' - 'troj/asp' - 'troj/php' - 'troj/jsp' - signature|contains: - 'webshell' - 'chopper' - 'sinochoper' - 'aspxspy' - 'aspdoor' - 'filebrowser' - 'php_' - 'jsp_' - 'asp_' # looking for 'vbs_' would also find downloaders and droppers meant for desktops - 'php:' - 'jsp:' - 'asp:' - 'perl:' - 'phpshell' - 'trojan.php' - 'trojan.asp' - 'trojan.jsp' - 'trojan.vbs' - 'php?agent' - 'asp?agent' - 'jsp?agent' - 'vbs?agent' - 'backdoor?php' - 'backdoor?jsp' - 'backdoor?asp' - 'backdoor?vbs' - 'backdoor?java' - 'pshlspy'
<li><a href="#">detection: selection: - targetfilename|contains: - '\hive_sam_' # go version - '\sam-2021-' # c++ version - '\sam-2022-' # c++ version - '\sam-2023-' # c++ version - '\sam-haxx' # early c++ versions - '\sam.save' # powershell version - targetfilename: - 'c:\windows\temp\sam' # c# version of hivenightmare
<li><a href="#">detection: selection: - targetfilename|contains: - '\pwdump' - '\kirbi' - '\pwhashes' - '\wce_ccache' - '\wce_krbtkts' - '\fgdump-log' - targetfilename|endswith: - '\test.pwd' - '\lsremora64.dll' - '\lsremora.dll' - '\fgexec.exe' - '\wceaux.dll' - '\sam.out' - '\security.out' - '\system.out' - '\ntds.out' - '\dumpext.dll' - '\dumpsvc.exe' - '\cachedump64.exe' - '\cachedump.exe' - '\pstgdump.exe' - '\servpw.exe' - '\servpw64.exe' - '\pwdump.exe' - '\procdump64.exe'
<li><a href="#">detection: selection: - targetfilename|contains|all: - '\appdata\roaming\oracle\bin\java' - '.exe' - targetfilename|contains|all: - '\retrive' - '.vbs'
<li><a href="#">detection: selection: - targetfilename|endswith: - '\temp\sam' - '\sam.sav' - '\intel\sam' - '\sam.hive' - '\perflogs\sam' - '\programdata\sam' - '\users\public\sam' - '\appdata\local\sam' - '\appdata\roaming\sam' - '_shadowsteal.zip' # - '\documents\sam.export' # - targetfilename: 'c:\sam' - targetfilename|contains: - '\hive_sam_' # - '\sam.save' - '\sam.export' - '\~reg_sam.save' - '\sam_backup' - '\sam.bck' - '\sam.backup'
<li><a href="#">detection: selection: - targetobject: - 'hklm\hardware\{804423c2-f490-4ac3-bfa5-13dede63a71a}' - 'hklm\hardware\{a5124af5-df23-49bf-b0ed-a18ed3dea027}' - 'hklm\hardware\{2db80286-1784-48b5-a751-b6ed1f490303}' - targetobject|startswith: - 'hklm\system\setup\printresponsor\'
<li><a href="#">detection: selection: - targetobject|endswith: - '\software\microsoft\windows nt\currentversion\windows\appinit_dlls' - '\software\wow6432node\microsoft\windows nt\currentversion\windows\appinit_dlls' #key rename - newname|endswith: - '\software\microsoft\windows nt\currentversion\windows\appinit_dlls' - '\software\wow6432node\microsoft\windows nt\currentversion\windows\appinit_dlls' filter: details: '(empty)'
<li><a href="#">detection: selection: # can not use originalfilename as is empty image|endswith: - '\ncat.exe' - '\netcat.exe' selection_cmdline: # typical command lines commandline|contains: - ' -lvp ' - ' -lvnp' - ' -l -v -p ' - ' -lv -p ' - ' -l --proxy-type http ' - ' --exec cmd.exe ' - ' -vnl --exec '
<li><a href="#">detection: selection: # detect new com servers in the user hive eventtype: setvalue targetobject|startswith: - 'hkcr\clsid\' - 'hkcu\software\classes\clsid\' targetobject|endswith: '\inprocserver32\(default)' filter1: details|contains: # exclude privileged directories and observed fps - '%%systemroot%%\system32\' - '%%systemroot%%\syswow64\' filteronedrive: details|contains: - '\appdata\local\microsoft\onedrive\' - '\filecoauthlib64.dll' - '\filesyncshell64.dll' - '\filesyncapi64.dll' filter2: details|contains|all: - '\appdata\local\microsoft\teamsmeetingaddin\' - '\microsoft.teams.addinloader.dll' filter3: details|contains|all: - '\appdata\roaming\dropbox\' - '\dropboxext64.*.dll' filter4: details|endswith: tmopieplg.dll #trendmicro osce filter5: image: - c:\windows\system32\wuauclt.exe - c:\windows\system32\svchost.exe filter_defender: image|startswith: - 'c:\programdata\microsoft\windows defender\platform\' - 'c:\program files\windows defender\' image|endswith: '\msmpeng.exe' filter_nvidia: details|contains: '\filerepository\nvmdi.inf' filter_edge: image|endswith: '\microsoftedgeupdatecomregistershell64.exe' filter_dx: image: 'c:\windows\system32\dxdiag.exe' filter_python: details: - 'c:\windows\pyshellext.amd64.dll' - 'c:\windows\pyshellext.dll' filter_bonjourlib: details: - 'c:\windows\system32\dnssdx.dll' - 'c:\windows\syswow64\dnssdx.dll' filter_printextensionmanager: details: 'c:\windows\system32\spool\drivers\x64\3\printconfig.dll' filter_programfiles: details|startswith: - 'c:\program files\' - 'c:\program files (x86)\' filter_gameservice: details|contains: 'c:\windows\system32\gamingservicesproxy.dll'
<li><a href="#">detection: selection: # empty string - as used by powershell's (new-object net.webclient).downloadstring c-useragent: ''
<li><a href="#">detection: selection: # feel free to add more targetfilename: 'c:\program.exe'
<li><a href="#">detection: selection: # marker commandline|contains: - '.downloadstring(' - '.downloadfile('
<li><a href="#">detection: selection: # meterpreter getsystem technique 1: cmd.exe /c echo 559891bb017 > \\.\pipe\5e120a - imagepath|contains|all: - 'cmd' - '/c' - 'echo' - '\pipe\' # cobaltstrike getsystem technique 1: %comspec% /c echo 559891bb017 > \\.\pipe\5e120a - imagepath|contains|all: - '%comspec%' - '/c' - 'echo' - '\pipe\' # cobaltstrike getsystem technique 1b (expanded %comspec%): %comspec% /c echo 559891bb017 > \\.\pipe\5e120a - imagepath|contains|all: - 'cmd.exe' - '/c' - 'echo' - '\pipe\' # meterpreter getsystem technique 2: rundll32.exe c:\users\test\appdata\local\temp\tmexsn.dll,a /p:tmexsn - imagepath|contains|all: - 'rundll32' - '.dll,a' - '/p:'
<li><a href="#">detection: selection: # monitor suspicious child processes spawned by confluence parentimage|endswith: '\atlassian\confluence\jre\bin\java.exe' commandline|contains: - 'cmd /c' - 'cmd /k' - 'powershell' - 'certutil' - 'curl' - 'whoami' - 'ipconfig'
<li><a href="#">detection: selection: # monitor suspicious child processes spawned by confluence parentimage|startswith: '/opt/atlassian/confluence/' parentimage|endswith: '/java' commandline|contains: - '/bin/sh' - 'bash' - 'dash' - 'ksh' - 'zsh' - 'csh' - 'fish' - 'curl' - 'wget' - 'python'
<li><a href="#">detection: selection: # parent command line should not contain a space value # this avoids false positives not caused by process injection # e.g. wscript.exe /b sysmon-install.vbs parentcommandline|startswith: - 'c:\windows\system32\' - 'c:\windows\syswow64\' parentcommandline|endswith: '.exe' selection2: - commandline|contains|all: - '/c' - 'del' - 'c:\users\' - '\appdata\local\temp\' - commandline|contains|all: - '/c' - 'del' - 'c:\users\' - '\desktop\' - commandline|contains|all: - '/c' - 'type nul >' - 'c:\users\' - '\desktop\' selection3: commandline|endswith: '.exe'
<li><a href="#">detection: selection: # see clsid_separatemultipleprocessexplorerhost in the registry for reference commandline|contains: '/factory,{75dff2b7-6936-4c06-a8bb-676a7b00b24b}'
<li><a href="#">detection: selection: # sysmon gives us hklm\system\currentcontrolset\.. if controlsetxx is the selected one - targetobject: 'hklm\system\currentcontrolset\control\minint' eventtype: 'createkey' # we don't want deletekey # key rename - newname: 'hklm\system\currentcontrolset\control\minint'
<li><a href="#">detection: selection: # sysmon gives us hklm\system\currentcontrolset\.. if controlsetxx is the selected one - targetobject: 'hklm\system\currentcontrolset\control\session manager\appcertdlls' # key rename - newname: 'hklm\system\curentcontrolset\control\session manager\appcertdlls'
<li><a href="#">detection: selection: # sysmon: file creation (id 11) targetfilename|contains|all: - '\appdata\local\temp\sam-' - '.dmp'
<li><a href="#">detection: selection: # win32_shadowcopy | foreach-object commandline|contains: - 'vwbpag4amwayaf8auwboageazabvahcaywbvahaaeqagahwaiabgag8acgbfageaywboac0atwbiagoazqbjahqa' - 'caaqbuadmamgbfafmaaabhagqabwb3agmabwbwahkaiab8acaargbvahiarqbhagmaaaatae8aygbqaguaywb0a' - 'xagkabgazadiaxwbtaggayqbkag8adwbjag8acab5acaafaagaeyabwbyaeuayqbjaggalqbpagiaagblagmada'
<li><a href="#">detection: selection: #4194304 dont_req_preauth scriptblocktext|contains|all: - 'get-aduser' - '-filter' - 'useraccountcontrol' - '-band' - '4194304'
<li><a href="#">detection: selection: #find the sysmon event commandline|contains: - 'ã¢' - 'â‚¬' - 'â£' - 'â¯' - 'â®' - 'âµ' - 'â¶'
<li><a href="#">detection: selection: action: denied timeframe: 24h
<li><a href="#">detection: selection: activitydisplayname: set federation settings on domain
<li><a href="#">detection: selection: authenticationrequirement: 'multifactorauthentication' status|contains: 'mfa denied'
<li><a href="#">detection: selection: authenticationrequirement: singlefactorauthentication resulttype: '0' networklocationdetails: '[]' devicedetail.deviceid: ''
<li><a href="#">detection: selection: calltrace|contains: 'editionupgrademanagerobj.dll'
<li><a href="#">detection: selection: calltrace|re: '^c:\\\\windows\\\\system32\\\\ntdll\\.dll\+[a-z0-9]{4,6}\|c:\\\\windows\\\\system32\\\\kernelbase\\.dll\+[a-z0-9]{4,6}\|unknown\([a-z0-9]{16}\)$' grantedaccess: - '0x1028' - '0x1fffff'
<li><a href="#">detection: selection: calltrace|startswith: 'unknown' falsepositive1: targetimage: 'c:\program files\cylance\desktop\cylanceui.exe' sourceimage: 'c:\windows\explorer.exe' falsepositive2: targetimage: 'c:\program files (x86)\microsoft\edgeupdate\microsoftedgeupdate.exe' sourceimage: 'c:\program files (x86)\microsoft\temp\*\microsoftedgeupdate.exe' falsepositive3: targetimage|endswith: 'vcredist_x64.exe' sourceimage|endswith: 'vcredist_x64.exe' falsepositive4: targetimage: 'c:\windows\system32\systeminfo.exe' sourceimage|endswith: 'setup64.exe' #vmware falsepositive5: targetimage|endswith: 'amazonssmagentsetup.exe' sourceimage|endswith: 'amazonssmagentsetup.exe' falsepositive6: targetimage|endswith: 'c:\program files\mozilla firefox\firefox.exe' sourceimage|endswith: 'c:\program files\mozilla firefox\firefox.exe'
<li><a href="#">detection: selection: category: 'administrative' operationname: 'assigns the caller to user access admin'
<li><a href="#">detection: selection: category: keymanagement operationname: read bitlocker key
<li><a href="#">detection: selection: category: 'policy' activitydisplayname: 'set device registration policies'
<li><a href="#">detection: selection: category: rolemanagement operationname|contains|all: - 'add' - 'member to role' targetresources|contains: - '7698a772-787b-4ac8-901f-60d6b08affd2' - '62e90394-69f5-4237-9190-012177145e10'
<li><a href="#">detection: selection: categoryvalue: 'administrative' resourceprovidervalue: 'microsoft.adhybridhealthservice' resourceid|contains: 'adfederationservice' operationnamevalue: 'microsoft.adhybridhealthservice/services/delete'
<li><a href="#">detection: selection: categoryvalue: 'administrative' resourceprovidervalue: 'microsoft.adhybridhealthservice' resourceid|contains: 'adfederationservice' operationnamevalue: 'microsoft.adhybridhealthservice/services/servicemembers/action'
<li><a href="#">detection: selection: certificate.serial: 8bb00ee
<li><a href="#">detection: selection: commandline: - 'net use \\%domaincontroller%\c$ "p@ssw0rd" *' - 'dir c:\\*.doc* /s' - 'dir %temp%\\*.exe'
<li><a href="#">detection: selection: commandline: - reg query "hkey_current_user\software\microsoft\terminal server client\default" - powershell.exe mshta.exe http* - cmd.exe /c taskkill /im cmd.exe
<li><a href="#">detection: selection: commandline: c:\windows\psexesvc.exe
<li><a href="#">detection: selection: commandline: 'copy /y c:\windows\system32\cmd.exe c:\windows\system32\sethc.exe'
<li><a href="#">detection: selection: commandline: 'ps.exe -accepteula'
<li><a href="#">detection: selection: commandline: 'rundll32.exe'
<li><a href="#">detection: selection: commandline|contains: - ' /am51' - ' /password' filter_fps: - commandline|contains: ' /passwordchg' # net user - parentimage: - 'c:\program files\ceetis\ceetis_ide.exe' # ceetis from weetech - 'c:\program files (x86)\ceetis\ceetis_ide.exe'
<li><a href="#">detection: selection: commandline|contains: - ' --cpu-priority=' - '--donate-level=0' - ' -o pool.' - ' --nicehash' - ' --algo=rx/0 ' - 'stratum+tcp://' - 'stratum+udp://' # base64 encoded: --donate-level= - 'ls1kb25hdgutbgv2zww9' - '0tzg9uyxrllwxldmvsp' - 'tlwrvbmf0zs1szxzlbd' # base64 encoded: stratum+tcp:// and stratum+udp:// - 'c3ryyxr1bst0y3a6ly' - 'n0cmf0dw0rdgnwoi8v' - 'zdhjhdhvtk3rjcdovl' - 'c3ryyxr1bst1zha6ly' - 'n0cmf0dw0rdwrwoi8v' - 'zdhjhdhvtk3vkcdovl'
<li><a href="#">detection: selection: commandline|contains: - ' --cpu-priority=' - '--donate-level=0' - ' -o pool.' - ' --nicehash' - ' --algo=rx/0 ' - 'stratum+tcp://' - 'stratum+udp://' # sub process started by xmrig - the most popular monero crypto miner - unknown if this causes any false positives - 'sh -c /sbin/modprobe msr allow_writes=on' # base64 encoded: --donate-level= - 'ls1kb25hdgutbgv2zww9' - '0tzg9uyxrllwxldmvsp' - 'tlwrvbmf0zs1szxzlbd' # base64 encoded: stratum+tcp:// and stratum+udp:// - 'c3ryyxr1bst0y3a6ly' - 'n0cmf0dw0rdgnwoi8v' - 'zdhjhdhvtk3rjcdovl' - 'c3ryyxr1bst1zha6ly' - 'n0cmf0dw0rdwrwoi8v' - 'zdhjhdhvtk3vkcdovl'
<li><a href="#">detection: selection: commandline|contains: - ' -e* paa' - 'jablag4adga6ahuacwblahiacabyag8azgbpagwazq' # $env:userprofile - 'qazqbuahyaogb1ahmazqbyahaacgbvagyaaqbsagua' # $env:userprofile - 'kaguabgb2adoadqbzaguacgbwahiabwbmagkababla' # $env:userprofile - 'igaoaccakganackaowaka' # "('*');$ - 'iakaanacoajwapadsaja' # "('*');$ - 'iacgajwaqaccakqa7acqa' # "('*');$ - 'jabgagwaeabyaggaywbmagq' - 'pqakaguabgb2adoadablag0acaaracga' # =$env:temp+( - '0ajablag4adga6ahqazqbtahaakwaoa' # =$env:temp+( - '9acqazqbuahyaogb0aguabqbwacsaka' # =$env:temp+(
<li><a href="#">detection: selection: commandline|contains: - ' -name .htpasswd' - ' -perm -4000 '
<li><a href="#">detection: selection: commandline|contains: - ' -nop -noni -w hidden -c $x=$((gp hkcu:software\\microsoft\\windows update).update)' - ' -nop -noni -c $x=$((gp hkcu:software\\microsoft\\windows update).update);'
<li><a href="#">detection: selection: commandline|contains: - ' -nop -sta -noni -w hidden -enc ' - ' -nop -sta -w 1 -enc ' - ' -nop -noni -w hidden -enc ' - ' -nop -sta -w 1 -enc' - ' -enc sqb' - ' -nop -exec bypass -encodedcommand '
<li><a href="#">detection: selection: commandline|contains: - ' -version 2 ' - ' -versio 2 ' - ' -versi 2 ' - ' -vers 2 ' - ' -ver 2 ' - ' -ve 2 ' image|endswith: '\powershell.exe'
<li><a href="#">detection: selection: commandline|contains: - '.bash_history' - '.zsh_history' - '.zhistory' - '.history' - '.sh_history' - 'fish_history'
<li><a href="#">detection: selection: commandline|contains: - '.downloadstring(' - '.downloadfile(' execution: commandline|contains: - 'iex(' - 'iex (' - 'i`ex' - 'ie`x' - 'i`e`x' - ' | iex' - '|iex ' - 'invoke-execution' - ';iex $'
<li><a href="#">detection: selection: commandline|contains: ' /dest:rdp-tcp:'
<li><a href="#">detection: selection: commandline|contains: - '/exefilename' - '/commandline' selection_runas: - commandline|contains: - ' /runas 8 ' - ' /runas 4 ' - ' /runas 10 ' - ' /runas 11 ' - commandline|endswith: - '/runas 8' - '/runas 4' - '/runas 10' - '/runas 11'
<li><a href="#">detection: selection: commandline|contains: ' /injectrunning '
<li><a href="#">detection: selection: commandline|contains: - '/logon:none' - '/system:none' - '/sam:none' - '/privilege:none' - '/object:none' - '/process:none' - '/policy:none'
<li><a href="#">detection: selection: commandline|contains: - '\cl_loadassembly.ps1' - 'loadassemblyfrompath '
<li><a href="#">detection: selection: commandline|contains: - '\msdt.exe' - '\installutil.exe' - '\regsvcs.exe' - '\regasm.exe' # - '\regsvr32.exe' # too many fps, very noisy - '\msbuild.exe' - '\ieexec.exe' #- '\mshta.exe' #- '\csc.exe'
<li><a href="#">detection: selection: commandline|contains: - '^^' # - '""' - ',;,' - '%comspec:~' # - '%%' # - '&&' - ' s^et ' - ' s^e^t ' - ' se^t '
<li><a href="#">detection: selection: commandline|contains: - '> \\\\127.0.0.1\\admin$' - '> \\\\localhost\\admin$'
<li><a href="#">detection: selection: commandline|contains: ' -accepteula'
<li><a href="#">detection: selection: commandline|contains: - arp.exe - at.exe - attrib.exe - cscript.exe - dsquery.exe - hostname.exe - ipconfig.exe - mimikatz.exe - nbtstat.exe - net.exe - netsh.exe - nslookup.exe - ping.exe - quser.exe - qwinsta.exe - reg.exe - runas.exe - sc.exe - schtasks.exe - ssh.exe - systeminfo.exe - taskkill.exe - telnet.exe - tracert.exe - wscript.exe - xcopy.exe - pscp.exe - copy.exe - robocopy.exe - certutil.exe - vssadmin.exe - powershell.exe - wevtutil.exe - psexec.exe - bcedit.exe - wbadmin.exe - icacls.exe - diskpart.exe timeframe: 5m
<li><a href="#">detection: selection: commandline|contains: - 'checkadmin.exe 127.0.0.1 -all' - 'netsh advfirewall firewall add rule name=powershell dir=in' - 'cmd /c powershell.exe -ep bypass -file c:\s.ps1' - '/tn win32times /f' - 'create win32times binpath=' - '\c$\windows\system32\devmgr.dll' - ' -exec bypass -enc jgag' - 'type *keepass\keepass.config.xml' - 'iie.exe iie.txt' - 'reg query hkey_current_user\software\\*\putty\sessions\'
<li><a href="#">detection: selection: commandline|contains: - 'domainlist' - 'trustdmp' - 'dcmodes' - 'adinfo' - ' dclist ' - 'computer_pwdnotreqd' - 'objectcategory=' - '-subnets -f' - 'name="domain admins"' - '-sc u:' - 'domainncs' - 'dompol' - ' oudmp ' - 'subnetdmp' - 'gpodmp' - 'fspdmp' - 'users_noexpire' - 'computers_active'
<li><a href="#">detection: selection: commandline|contains: ' -e' # covers -en and -enc selection2: commandline|contains: ' jab' selection3: commandline|contains|all: - ' -w' - ' hidden ' selection4: commandline|contains: - ' ba^j' - ' suvyi' - ' sqbfafga' - ' aqblahga' - ' awv4i' - ' iaa' - ' iab' - ' uwb' - ' cwb' selection5: commandline|contains: '.exe -encod ' falsepositive1: commandline|contains|all: - ' -executionpolicy' - 'remotesigned '
<li><a href="#">detection: selection: commandline|contains: ' echo eeee > '
<li><a href="#">detection: selection: commandline|contains: - 'grpconv.exe -o' - 'grpconv -o'
<li><a href="#">detection: selection: commandline|contains: - '-i' - '/install' - '-a' - '/add-driver' - '.inf' image|endswith: '\pnputil.exe'
<li><a href="#">detection: selection: commandline|contains: - 'invoke-webrequest' - 'iwr ' - 'wget ' - 'curl ' - 'net.webclient' - 'start-bitstransfer'
<li><a href="#">detection: selection: commandline|contains: - 'ipconfig /all' - 'netsh interface show interface' - 'arp -a' - 'nbtstat -n' - 'net config' - 'route print'
<li><a href="#">detection: selection: commandline|contains: - net group "domain admins" - net localgroup administrators - net group "enterprise admins" - net accounts /do
<li><a href="#">detection: selection: commandline|contains: - 'objectcategory' - 'trustdmp' - 'dcmodes' - 'dclist' - 'computers_pwdnotreqd' image|endswith: '\adfind.exe'
<li><a href="#">detection: selection: commandline|contains: - 'printnightmare.gentilkiwi.com' - ' /user:gentilguest ' - 'kiwi legit printer'
<li><a href="#">detection: selection: commandline|contains: - 'rm /var/log/syslog' - 'rm -r /var/log/syslog' - 'rm -f /var/log/syslog' - 'rm -rf /var/log/syslog' - 'mv /var/log/syslog' - ' >/var/log/syslog' - ' > /var/log/syslog'
<li><a href="#">detection: selection: commandline|contains: ' runassystem '
<li><a href="#">detection: selection: commandline|contains: - 'type %windir%\system32\ntdll.dll' - 'type %systemroot%\system32\ntdll.dll' - 'type c:\windows\system32\ntdll.dll' - '\\ntdll.dll > \\\\.\\pipe\\'
<li><a href="#">detection: selection: commandline|contains: - 'utilityfunctions.ps1' - 'regsnapin '
<li><a href="#">detection: selection: commandline|contains: - 'xcopy*\system32\' - 'cmd.exe*/c*copy*\system32\'
<li><a href="#">detection: selection: commandline|contains: # - <tab> # no tab modifier in sigmac yet, so this matches <tab> (or tab in elasticsearch backends without dsl queries) - 'h^t^t^p' - 'h"t"t"p'
<li><a href="#">detection: selection: commandline|contains: # ::("l"+"oad") - 'oga6acgaigbmaciakwaiag8ayqbkaciakq' - 'oaogaoaciataaiacsaigbvageazaaiacka' - '6adoakaaiaewaigaraciabwbhagqaigapa' # ::("lo"+"ad") - 'oga6acgaigbmag8aigaraciayqbkaciakq' - 'oaogaoaciatabvaciakwaiageazaaiacka' - '6adoakaaiaewabwaiacsaigbhagqaigapa' # ::("loa"+"d") - 'oga6acgaigbmag8ayqaiacsaigbkaciakq' - 'oaogaoaciatabvageaigaraciazaaiacka' - '6adoakaaiaewabwbhaciakwaiagqaigapa' # ::('l'+'oad') - 'oga6acgajwbmaccakwanag8ayqbkaccakq' - 'oaogaoaccataanacsajwbvageazaanacka' - '6adoakaanaewajwaraccabwbhagqajwapa' # ::('lo'+'ad') - 'oga6acgajwbmag8ajwaraccayqbkaccakq' - 'oaogaoaccatabvaccakwanageazaanacka' - '6adoakaanaewabwanacsajwbhagqajwapa' # ::('loa'+'d') - 'oga6acgajwbmag8ayqanacsajwbkaccakq' - 'oaogaoaccatabvageajwaraccazaanacka' - '6adoakaanaewabwbhaccakwanagqajwapa'
<li><a href="#">detection: selection: commandline|contains: # [reflection.assembly]::load( - 'wwbsaguazgbsaguaywb0agkabwbuac4aqqbzahmazqbtagiabab5af0aoga6aewabwbhagqaka' - 'saugblagyabablagmadabpag8abgauaeeacwbzaguabqbiagwaeqbdadoaogbmag8ayqbkacga' - 'bafiazqbmagwazqbjahqaaqbvag4algbbahmacwblag0aygbsahkaxqa6adoatabvageazaaoa' # [reflection.assembly]::("load") - 'afsacgblagyabablagmadabpag8abgauageacwbzaguabqbiagwaeqbdadoaogaoaciatabvageazaaiac' - 'bbahiazqbmagwazqbjahqaaqbvag4algbhahmacwblag0aygbsahkaxqa6adoakaaiaewabwbhagqaigap' - 'awwbyaguazgbsaguaywb0agkabwbuac4ayqbzahmazqbtagiabab5af0aoga6acgaigbmag8ayqbkaciak' # [reflection.assembly]::("load") - 'wwbsaguazgbsaguaywb0agkabwbuac4aqqbzahmazqbtagiabab5af0aoga6acgaigbmag8ayqbkaciakq' - 'saugblagyabablagmadabpag8abgauaeeacwbzaguabqbiagwaeqbdadoaogaoaciatabvageazaaiacka' - 'bafiazqbmagwazqbjahqaaqbvag4algbbahmacwblag0aygbsahkaxqa6adoakaaiaewabwbhagqaigapa' # [reflection.assembly]::load( - 'wwbyaguazgbsaguaywb0agkabwbuac4ayqbzahmazqbtagiabab5af0aoga6aewabwbhagqaka' - 'sacgblagyabablagmadabpag8abgauageacwbzaguabqbiagwaeqbdadoaogbmag8ayqbkacga' - 'bahiazqbmagwazqbjahqaaqbvag4algbhahmacwblag0aygbsahkaxqa6adoatabvageazaaoa'
<li><a href="#">detection: selection: commandline|contains: # add more paths as they are discovered - '\software\simontatham\putty\sessions' - '\software\\simontatham\\putty\sshhostkeys\' - '\software\mobatek\mobaxterm\' - '\software\wow6432node\radmin\v3.0\server\parameters\radmin' - '\software\aerofox\foxmailpreview' - '\software\aerofox\foxmail\v3.1' - '\software\incredimail\identities' - '\software\qualcomm\eudora\commandline' - '\software\rimarts\b2\settings' - '\software\openvpn-gui\configs' - '\software\martin prikryl\winscp 2\sessions' - '\software\ftpware\coreftp\sites' - '\software\downloadmanager\passwords' - '\software\openssh\agent\keys' - '\software\tightvnc\server' - '\software\orl\winvnc3\password' - '\software\realvnc\winvnc4'
<li><a href="#">detection: selection: commandline|contains: # invoke- - 'sqbuahyabwbragualq' - 'kabgb2ag8aawblac0a' - 'jag4adgbvagsazqata' filter_other_rule: # already covered in fd6e2919-3936-40c9-99db-0aa922c356f7 commandline|contains: # invoke-bloodhound - 'sqbuahyabwbragualqbcagwabwbvagqasabvahuabgbka' - 'kabgb2ag8aawblac0aqgbsag8abwbkaegabwb1ag4aza' - 'jag4adgbvagsazqataeiababvag8azabiag8adqbuagqa' # invoke-mimikatz - 'sqbuahyabwbragualqbnagkabqbpagsayqb0ahoa' - 'kabgb2ag8aawblac0atqbpag0aaqbrageadab6a' - 'jag4adgbvagsazqatae0aaqbtagkaawbhahqaeg' # invoke-wmiexec - 'sqbuahyabwbragualqbxae0asqbfahgazqbja' - 'kabgb2ag8aawblac0avwbnaekarqb4aguayw' - 'jag4adgbvagsazqatafcatqbjaeuaeablagma'
<li><a href="#">detection: selection: commandline|contains: # invoke-bloodhound - 'sqbuahyabwbragualqbcagwabwbvagqasabvahuabgbka' - 'kabgb2ag8aawblac0aqgbsag8abwbkaegabwb1ag4aza' - 'jag4adgbvagsazqataeiababvag8azabiag8adqbuagqa' # invoke-mimikatz - 'sqbuahyabwbragualqbnagkabqbpagsayqb0ahoa' - 'kabgb2ag8aawblac0atqbpag0aaqbrageadab6a' - 'jag4adgbvagsazqatae0aaqbtagkaawbhahqaeg' # invoke-wmiexec - 'sqbuahyabwbragualqbxae0asqbfahgazqbja' - 'kabgb2ag8aawblac0avwbnaekarqb4aguayw' - 'jag4adgbvagsazqatafcatqbjaeuaeablagma'
<li><a href="#">detection: selection: commandline|contains: # make sure that your backend applies the strings case-insensitive - 'iex ((new-object net.webclient).downloadstring' - 'iex (new-object net.webclient).downloadstring' - 'iex((new-object net.webclient).downloadstring' - 'iex(new-object net.webclient).downloadstring' - ' -command (new-object system.net.webclient).downloadfile(' - ' -c (new-object system.net.webclient).downloadfile('
<li><a href="#">detection: selection: commandline|contains: # we assume that the lsass.exe process has a process id that's between 700 and 999 and the dumper uses just the pid as parameter - '\trolleyexpress 7' - '\trolleyexpress 8' - '\trolleyexpress 9' - '\trolleyexpress.exe 7' - '\trolleyexpress.exe 8' - '\trolleyexpress.exe 9' # common dumpers - '\trolleyexpress.exe -ma ' renamed: image|endswith: '\trolleyexpress.exe' filter_renamed: originalfilename|contains: 'ctxinstall' filter_empty: originalfilename: null
<li><a href="#">detection: selection: commandline|contains: '(wchar)0x'
<li><a href="#">detection: selection: commandline|contains: '.exe whoami'
<li><a href="#">detection: selection: commandline|contains: '.settingcontent-ms' filter: commandline|contains: 'immersivecontrolpanel'
<li><a href="#">detection: selection: commandline|contains: '::frombase64string('
<li><a href="#">detection: selection: commandline|contains: 'abccccccccccccccccccccccccccccccccccccccccccccccc'
<li><a href="#">detection: selection: commandline|contains: 'complus_etwenabled=0'
<li><a href="#">detection: selection: commandline|contains: 'copy \\\\\?\\globalroot\\device\\harddiskvolumeshadowcopy'
<li><a href="#">detection: selection: commandline|contains: 'cyzfc.dat,' commandline|endswith: 'pointfunctioncall'
<li><a href="#">detection: selection: commandline|contains: 'get-clipboard'
<li><a href="#">detection: selection: commandline|contains: 'get-process lsass'
<li><a href="#">detection: selection: commandline|contains: '-i sm-tgytutrc -s'
<li><a href="#">detection: selection: commandline|contains: 'install-transportagent'
<li><a href="#">detection: selection: commandline|contains: 'sc query'
<li><a href="#">detection: selection: commandline|contains: 'start /min msedge'
<li><a href="#">detection: selection: commandline|contains: 'transport=dt_socket,address=' exclusion: - commandline|contains: 'address=127.0.0.1' - commandline|contains: 'address=localhost'
<li><a href="#">detection: selection: commandline|contains: 'windowsaudiodevice-powershell-cmdlet'
<li><a href="#">detection: selection: commandline|contains|all: - ' /account=system ' - '/exec='
<li><a href="#">detection: selection: commandline|contains|all: - ' /injectrunning' - '.dll' # space some time in the end originalfilename: - 'mavinject32.exe' - 'mavinject64.exe'
<li><a href="#">detection: selection: commandline|contains|all: - ' --adcs ' - ' --port '
<li><a href="#">detection: selection: commandline|contains|all: - ' -ma ' - ' -accepteula '
<li><a href="#">detection: selection: commandline|contains|all: - ' msiexec' - '://'
<li><a href="#">detection: selection: commandline|contains|all: - ' -t msi-install ' - ' -i http'
<li><a href="#">detection: selection: commandline|contains|all: - '&&' - 'rundll32' - 'shell32.dll' - 'shellexec_rundll' commandline|contains: - 'value' - 'invoke' - 'comspec' - 'iex'
<li><a href="#">detection: selection: commandline|contains|all: - '\cl_mutexverifiers.ps1' - 'runaftercancelprocess '
<li><a href="#">detection: selection: commandline|contains|all: - '\pubprn.vbs' - 'script:'
<li><a href="#">detection: selection: commandline|contains|all: - '\syncappvpublishingserver.vbs' - ';' # at a minimum, a semi-colon is required
<li><a href="#">detection: selection: commandline|contains|all: - '\sysvol\' - '\policies\'
<li><a href="#">detection: selection: commandline|contains|all: - '\windowssensor.exe' - ' /uninstall' - ' /quiet'
<li><a href="#">detection: selection: commandline|contains|all: - '7za.exe' - '\\c$\\temp\\log.zip'
<li><a href="#">detection: selection: commandline|contains|all: - 'activescripteventconsumer' - ' create '
<li><a href="#">detection: selection: commandline|contains|all: - '-autoreconnect ' - '-connect ' - '-id:'
<li><a href="#">detection: selection: commandline|contains|all: - bash.exe - '-c '
<li><a href="#">detection: selection: commandline|contains|all: - 'cl_invocation.ps1' - 'syncinvoke' # example commandline: "powershell import-module c:\windows\diagnostics\system\audio\cl_invocation.ps1; syncinvoke c:\evil.exe"
<li><a href="#">detection: selection: commandline|contains|all: - 'cmd' - ' /c ' - 'assoc ' - 'exefile' filter: commandline|contains: '.exe=exefile'
<li><a href="#">detection: selection: commandline|contains|all: - 'cmd' - '/c' - 'assoc'
<li><a href="#">detection: selection: commandline|contains|all: - 'compress-archive ' - ' -path ' - ' -destinationpath ' - '$env:temp\'
<li><a href="#">detection: selection: commandline|contains|all: - 'conhost.exe' - '0xffffffff' - '-forcev1'
<li><a href="#">detection: selection: commandline|contains|all: - 'cscript' - 'manage-bde.wsf'
<li><a href="#">detection: selection: commandline|contains|all: - 'cscript.exe' - 'gathernetworkinfo.vbs'
<li><a href="#">detection: selection: commandline|contains|all: - diantz.exe - ' \\' - '.cab'
<li><a href="#">detection: selection: commandline|contains|all: - diantz.exe - .cab commandline|re: ':[^\\\\]'
<li><a href="#">detection: selection: commandline|contains|all: - 'dir ' - ' /s' - ' /b'
<li><a href="#">detection: selection: commandline|contains|all: - 'e=access&' - 'y=guest&' - '&p=' - '&c=' - '&k='
<li><a href="#">detection: selection: commandline|contains|all: - 'esentutl' - ' /p'
<li><a href="#">detection: selection: commandline|contains|all: - 'execute' - 'createobject' - 'regread' - 'window.close' - '\microsoft\windows\currentversion' filter: commandline|contains: '\software\microsoft\windows\currentversion\run'
<li><a href="#">detection: selection: commandline|contains|all: - extrac32.exe - .cab commandline|re: ':[^\\\\]'
<li><a href="#">detection: selection: commandline|contains|all: - 'infdefaultinstall.exe ' - '.inf'
<li><a href="#">detection: selection: commandline|contains|all: - '--install' - '--start-with-win' - '--silent'
<li><a href="#">detection: selection: commandline|contains|all: - '-m ' - '-net ' - '-size ' #size 10 in references - '-nomutex ' - '-p \\' - '$'
<li><a href="#">detection: selection: commandline|contains|all: - 'microsoft\windows\currentversion\run' - 'c:\users\public\'
<li><a href="#">detection: selection: commandline|contains|all: - mklink - harddiskvolumeshadowcopy
<li><a href="#">detection: selection: commandline|contains|all: - 'net ' - 'localgroup' - 'remote desktop users' - '/add'
<li><a href="#">detection: selection: commandline|contains|all: - netsh - trace - start
<li><a href="#">detection: selection: commandline|contains|all: - 'new-mailboxexport' - ' -mailbox ' - ' -filepath \\\\127.0.0.1\\c$'
<li><a href="#">detection: selection: commandline|contains|all: - 'new-object' - 'text.encoding]::ascii' commandline|contains: - 'system.io.compression.deflatestream' - 'system.io.streamreader' commandline|endswith: 'readtoend'
<li><a href="#">detection: selection: commandline|contains|all: - 'noconsentprompt' - 'shadow:'
<li><a href="#">detection: selection: commandline|contains|all: - '-noni' - '-ep' - 'bypass' - '$'
<li><a href="#">detection: selection: commandline|contains|all: - 'powershell' - '.downloadfile' - 'system.net.webclient'
<li><a href="#">detection: selection: commandline|contains|all: - 'process call create' - 'rundll32'
<li><a href="#">detection: selection: commandline|contains|all: - 'reg' - ' add ' - '\services\vss\diag' - '/d disabled'
<li><a href="#">detection: selection: commandline|contains|all: - 'reg' - ' add ' - 'software\microsoft\windows\currentversion\run'
<li><a href="#">detection: selection: commandline|contains|all: - 'reg add' - 'hklm\system\currentcontrolset\control' - 'write protection' - '0' commandline|contains: - 'storage' - 'storagedevicepolicies'
<li><a href="#">detection: selection: commandline|contains|all: - 'regsvr32' - '/s' - '/i' - '\appdata\roaming\' - '.ocx'
<li><a href="#">detection: selection: commandline|contains|all: - 'rundll32.exe' - '.dll' - 'startnoderelay'
<li><a href="#">detection: selection: commandline|contains|all: - 'rundll32.exe' - '.dll' commandline|endswith: - ' startw' - ',startw'
<li><a href="#">detection: selection: commandline|contains|all: - 'rundll32.exe' - 'execute' - 'regread' - 'window.close'
<li><a href="#">detection: selection: commandline|contains|all: - 'rundll32.exe' - 'installarchersvc'
<li><a href="#">detection: selection: commandline|contains|all: - 'rundll32.exe' - 'shell32.dll' - 'shellexec_rundll' - 'powershell'
<li><a href="#">detection: selection: commandline|contains|all: - 'schtasks' - '\application experience\microsoft compatibility appraiser'
<li><a href="#">detection: selection: commandline|contains|all: - 'schtasks' - 'create' - 'wscript' - 'e:vbscript'
<li><a href="#">detection: selection: commandline|contains|all: - 'set' - '&&' - 'mshta' - 'vbscript:createobject' - '.run' - '(window.close)'
<li><a href="#">detection: selection: commandline|contains|all: - '-sta' - '-nop' - '-window' - 'hidden' commandline|contains: - '-command' - '-encodedcommand' selection2: commandline|contains: - 'sv o (new-object io.memorysteam);sv d ' - 'mshta file.hta' - 'grunthttp' - '-encodedcommand cwb2acaabwaga'
<li><a href="#">detection: selection: commandline|contains|all: - 'verb:sync' - '-source:runcommand' - '-dest:runcommand' image|endswith: '\msdeploy.exe'
<li><a href="#">detection: selection: commandline|contains|all: - 'vssadmin list shadows' - 'log.txt'
<li><a href="#">detection: selection: commandline|contains|all: - 'winget' - 'install' commandline|contains: - '-m ' - '--manifest'
<li><a href="#">detection: selection: commandline|endswith: - ' -windowstyle hidden"' - ' -windowstyle hidden' - " -windowstyle hidden'" - ' -w hidden"' - ' -w hidden' - " -w hidden'" - ' -ep bypass"' - ' -ep bypass' - " -ep bypass'" - ' -noni"' - ' -noni' - " -noni'"
<li><a href="#">detection: selection: commandline|endswith: - '.dll' - '.csproj' image|endswith: '\dotnet.exe'
<li><a href="#">detection: selection: commandline|endswith: '"\system32\cleanmgr.exe /autoclean /d c:' parentcommandline: 'c:\windows\system32\svchost.exe -k netsvcs -p -s schedule' integritylevel: - 'high' - 'system'
<li><a href="#">detection: selection: commandline|endswith: # cme/protocols/smb/wmiexec.py (generalized execute_remote and execute_fileless) - 'cmd.exe /q /c * 1> \\\\*\\*\\* 2>&1' # cme/protocols/smb/atexec.py:109 (fileless output via share) - 'cmd.exe /c * > \\\\*\\*\\* 2>&1' # cme/protocols/smb/atexec.py:111 (fileless output via share) - 'cmd.exe /c * > *\\temp\\* 2>&1' commandline|contains: # cme/helpers/powershell.py:139 (powershell execution with obfuscation) - 'powershell.exe -exec bypass -noni -nop -w 1 -c "' # cme/helpers/powershell.py:149 (powershell execution without obfuscation) - 'powershell.exe -noni -nop -w 1 -enc '
<li><a href="#">detection: selection: commandline|endswith: '\rundll32.exe' filter1: parentimage|endswith: '\svchost.exe' filter2: parentimage|contains: - '\appdata\local\' - '\microsoft\edge\'
<li><a href="#">detection: selection: commandline|endswith: 'dllhost.exe' image|endswith: '\dllhost.exe'
<li><a href="#">detection: selection: commandline|endswith: 'svchost.exe' image|endswith: '\svchost.exe' filter: - parentimage|endswith: - '\rpcnet.exe' - '\rpcnetp.exe' - commandline: null # no commandline value available
<li><a href="#">detection: selection: commandline|re: '(?i).*&&set.*(\{\d\}){2,}\\\"\s+?\-f.*&&.*cmd.*\/c' # fps with |\/r
<li><a href="#">detection: selection: commandline|re: '(?i).*(set).*&&\s?set.*(environment|invoke).*&&.*"'
<li><a href="#">detection: selection: commandline|re: '(?i).*?echo.*clip.*&&.*(clipboard|i`?n`?v`?o`?k`?e`?).*'
<li><a href="#">detection: selection: commandline|re: '.*cmd.{0,5}(?:\/c|\/r)(?:\s|)\"set\s[a-za-z]{3,6}.*(?:\{\d\}){1,}\\\"\s+?\-f(?:.*\)){1,}.*\"'
<li><a href="#">detection: selection: commandline|re: '.*cmd.{0,5}(?:\/c|\/r).+clip(?:\.exe)?.{0,4}&&.+clipboard]::\(\s\\\"\{\d\}.+\-f.+\"'
<li><a href="#">detection: selection: commandline|re: '.*cmd.{0,5}(?:\/c|\/r).+powershell.+(?:\$\{?input\}?|noexit).+\"'
<li><a href="#">detection: selection: commandline|startswith: - 'cmd.exe' - 'c:\windows\system32\cmd.exe' commandline|contains: - invoke-userhunter - invoke-sharefinder - invoke-kerberoast - invoke-smbautobrute - invoke-nightmare - zerologon - av_query image|endswith: '\cmd.exe'
<li><a href="#">detection: selection: commandline|startswith: - 'cmd.exe' - 'c:\windows\system32\cmd.exe' commandline|contains: - psinject - spawnas - make_token - remote-exec - rev2self - dcsync - logonpasswords - execute-assembly - getsystem image|endswith: '\cmd.exe'
<li><a href="#">detection: selection: commandline|startswith: - 'sh -c ' - 'bash -c ' commandline|endswith: - '| bash' - '|bash' - '| sh' - '|sh'
<li><a href="#">detection: selection: company: 'cube0x0'
<li><a href="#">detection: selection: contextinfo: '*' filter: contextinfo|contains: 'powershell.exe' # host application=...powershell.exe or application hote=...powershell.exe in french win10 event filter_citrix: contextinfo|contains: 'configsyncrun.exe' filter_adace: # active directory administrative center enhancements contextinfo|contains: 'c:\windows\system32\dsac.exe' filter_winrm: contextinfo|contains: 'c:\windows\system32\wsmprovhost.exe -embedding'
<li><a href="#">detection: selection: contextinfo|contains: - 'powercat ' - 'powercat.ps1'
<li><a href="#">detection: selection: contextinfo|contains: 'get-nettcpconnection'
<li><a href="#">detection: selection: contextinfo|contains: 'reset-computermachinepassword'
<li><a href="#">detection: selection: contextinfo|contains: 'syncappvpublishingserver.exe'
<li><a href="#">detection: selection: contextinfo|contains|all: - ' = serverremotehost ' # hostname: 'serverremotehost' french : nom dâ€™hã´te = - 'wsmprovhost.exe' # hostapplication|contains: 'wsmprovhost.exe' french application hã´te = false_positive_1: contextinfo|contains: '\windows\system32\windowspowershell\v1.0\modules\microsoft.powershell.archive\microsoft.powershell.archive.psm1'
<li><a href="#">detection: selection: cs-method: 'get' c-uri|contains|all: - 'com.bea.console.handles.jndibindinghandle' - 'ldap://' - 'adminserver'
<li><a href="#">detection: selection: cs-method: 'get' c-uri|endswith: '?manifest=wac' cs-host: 'onedrive.live.com' filter: c-uri|startswith: 'http' c-uri|contains: '://onedrive.live.com/'
<li><a href="#">detection: selection: cs-method: 'post' c-uri: '/ui/vropspluginui/rest/services/uploadova'
<li><a href="#">detection: selection: cs-method: 'post' c-uri|contains: '/analytics/telemetry/ph/api/hyper/send?'
<li><a href="#">detection: selection: cs-method: 'post' c-uri|contains: '/sitecore/shell/clientbin/reporting/report.ashx' sc-status: 200
<li><a href="#">detection: selection: cs-method: 'post' c-uri|contains|all: - '/upload.action' - 'filename=../../../../'
<li><a href="#">detection: selection: cs-method: 'post' c-uri|contains|all: - 'logupload' - 'logmetadata' - 'wsgi_log_upload.py'
<li><a href="#">detection: selection: cs-method: 'post' sc-status: 200 cs-uri-stem: '/ecp/ddi/ddiservice.svc/setobject' cs-uri-query|contains|all: - 'schema=reset' - 'virtualdirectory' cs-username|endswith: '$' keywords: - 'post' - '200' - '/ecp/ddi/ddiservice.svc/setobject' - 'schema=reset' - 'virtualdirectory' - '$'
<li><a href="#">detection: selection: cs-uri-query|contains: - 'cmd=read' - 'connect&target' - 'cmd=connect' - 'cmd=disconnect' - 'cmd=forward' filter: cs-referer: null cs-user-agent: null cs-method: post
<li><a href="#">detection: selection: c-uri: - '*/../vpns/*' - '*/vpns/cfg/smb.conf' - '*/vpns/portal/scripts/*.pl*'
<li><a href="#">detection: selection: c-uri: '*/config/keystore/*.js*'
<li><a href="#">detection: selection: c-uri: '*?/dana/html5acc/guacamole/*'
<li><a href="#">detection: selection: c-uri|contains: - '../../../../../etc/passwd' - '../../../../windows/' - '../../../../../lib/password'
<li><a href="#">detection: selection: c-uri|contains: - '.paste.ee/r/' - '.pastebin.com/raw/' - '.hastebin.com/raw/' - '.ghostbin.co/paste/*/raw/'
<li><a href="#">detection: selection: c-uri|contains: - '/cgi-bin/.%2e/' - '/icons/.%2e/' - '/cgi-bin/.%%32%65/' - '/icons/.%%32%65/' - '/cgi-bin/.%%%25%33' - '/icons/.%%%25%33' selection_success: sc-status: - 200 - 301
<li><a href="#">detection: selection: c-uri|contains: - '/console/images/%252e%252e%252fconsole.portal' - '/console/css/%2e'
<li><a href="#">detection: selection: c-uri|contains: - '/help/admin-guide/reports/reportgenerate.jsp' - '/restapi/logoncustomization' - '/restapi/connection'
<li><a href="#">detection: selection: c-uri|contains: - '/help/admin-guide/reports/reportgenerate.jsp' - '/servletapi/../restapi/logoncustomization' - '/servletapi/../restapi/connection'
<li><a href="#">detection: selection: c-uri|contains: - '=c:/users' - '=c:/program%20files' - '=c:/windows' - '=c%3a%5cusers' - '=c%3a%5cprogram%20files' - '=c%3a%5cwindows'
<li><a href="#">detection: selection: c-uri|contains: - 'get~~~allbrowser' - 'get~~~hardwareinfo' - 'take~~recordcall' - 'reset~~~allcommand'
<li><a href="#">detection: selection: c-uri|contains: - 'webresource.axd' - 'scriptresource.axd' - 'i18n.ashx' - 'skipi18n' valid_request_1: c-uri|contains: 'orion/skipi18n/profiler/' valid_request_2: c-uri|contains: - 'css.i18n.ashx' - 'js.i18n.ashx'
<li><a href="#">detection: selection: c-uri|contains: '/api/v2.0/user/remoteserver.saml' cs-method: post filter1: cs-referer|contains: '/root/user/remote-user/saml-user/' filter2: cs-referer: null
<li><a href="#">detection: selection: c-uri|contains: '/asp.asp?ui='
<li><a href="#">detection: selection: c-uri|contains: '/cgi-bin/jarrewrite.sh' c-useragent|contains: - ':;' - '() {' - '/bin/bash -c'
<li><a href="#">detection: selection: c-uri|contains: '/index/index.php?h='
<li><a href="#">detection: selection: c-uri|contains: '/list/suc?name='
<li><a href="#">detection: selection: c-uri|contains: /manager/controllers/default/resource/tvs.php?class_key=../../../../../../../../../../windows/win.ini%00
<li><a href="#">detection: selection: c-uri|contains: '/manager/files?path=etc/lists/../../../../..'
<li><a href="#">detection: selection: c-uri|contains: '/oscp/' cs-host: 'ocsp.verisign.com'
<li><a href="#">detection: selection: c-uri|contains: '/owa/calendar/a' cs-method: 'post' filter: sc-status: 503
<li><a href="#">detection: selection: c-uri|contains: '/pwndrop/'
<li><a href="#">detection: selection: c-uri|contains: '~1' c-uri|endswith: 'a.aspx' cs-method: - get - options #only succes sc-status: - 200 - 301
<li><a href="#">detection: selection: c-uri|contains: 'momyshark?key='
<li><a href="#">detection: selection: c-uri|contains|all: - '/' - '.php?l=' c-uri|endswith: '.cab' sc-status: 200
<li><a href="#">detection: selection: c-uri|contains|all: - '/ecp/default.aspx' - '__viewstategenerator=' - '__viewstate='
<li><a href="#">detection: selection: c-uri|contains|all: - 'lang=/../../' - '/dev/cmdb/sslvpn_websession'
<li><a href="#">detection: selection: c-uri|endswith: '.class'
<li><a href="#">detection: selection: c-uri-extension: - 'exe' - 'vbs' - 'bat' - 'rar' - 'ps1' - 'doc' - 'docm' - 'xls' - 'xlsm' - 'pptm' - 'rtf' - 'hta' - 'dll' - 'ws' - 'wsf' - 'sct' - 'zip' # if you want to add more extensions - see filter: r-dns|endswith: - '.com' - '.org' - '.net' - '.edu' - '.gov' - '.uk' - '.ca' - '.de' - '.jp' - '.fr' - '.au' - '.us' - '.ch' - '.it' - '.nl' - '.se' - '.no' - '.es' # extend this list as needed
<li><a href="#">detection: selection: c-uri-extension: - 'exe' - 'vbs' - 'bat' - 'rar' - 'ps1' - 'doc' - 'docm' - 'xls' - 'xlsm' - 'pptm' - 'rtf' - 'hta' - 'dll' - 'ws' - 'wsf' - 'sct' - 'zip' # if you want to add more extensions - see r-dns|endswith: - '.hopto.org' - '.no-ip.org' - '.no-ip.info' - '.no-ip.biz' - '.no-ip.com' - '.noip.com' - '.ddns.name' - '.myftp.org' - '.myftp.biz' - '.serveblog.net' - '.servebeer.com' - '.servemp3.com' - '.serveftp.com' - '.servequake.com' - '.servehalflife.com' - '.servehttp.com' - '.servegame.com' - '.servepics.com' - '.myvnc.com' - '.ignorelist.com' - '.jkub.com' - '.dlinkddns.com' - '.jumpingcrab.com' - '.ddns.info' - '.mooo.com' - '.dns-dns.com' - '.strangled.net' - '.adultdns.net' - '.craftx.biz' - '.ddns01.com' - '.dns53.biz' - '.dnsapi.info' - '.dnsd.info' - '.dnsdynamic.com' - '.dnsdynamic.net' - '.dnsget.org' - '.fe100.net' - '.flashserv.net' - '.ftp21.net' - '.http01.com' - '.http80.info' - '.https443.com' - '.imap01.com' - '.kadm5.com' - '.mysq1.net' - '.ns360.info' - '.ntdll.net' - '.ole32.com' - '.proxy8080.com' - '.sql01.com' - '.ssh01.com' - '.ssh22.net' - '.tempors.com' - '.tftpd.net' - '.ttl60.com' - '.ttl60.org' - '.user32.com' - '.voip01.com' - '.wow64.net' - '.x64.me' - '.xns01.com' - '.dyndns.org' - '.dyndns.info' - '.dyndns.tv' - '.dyndns-at-home.com' - '.dnsomatic.com' - '.zapto.org' - '.webhop.net' - '.25u.com' - '.slyip.net'
<li><a href="#">detection: selection: c-uri-extension: - 'exe' - 'vbs' - 'bat' - 'rar' - 'ps1' - 'doc' - 'docm' - 'xls' - 'xlsm' - 'pptm' - 'rtf' - 'hta' - 'dll' - 'ws' - 'wsf' - 'sct' - 'zip' # if you want to add more extensions - see r-dns|endswith: # symantec / chris larsen analysis - '.country' - '.stream' - '.gdn' - '.mom' - '.xin' - '.kim' - '.men' - '.loan' - '.download' - '.racing' - '.online' - '.science' - '.ren' - '.gb' - '.win' - '.top' - '.review' - '.vip' - '.party' - '.tech' - '.xyz' - '.date' - '.faith' - '.zip' - '.cricket' - '.space' # mcafee report - '.info' - '.vn' - '.cm' - '.am' - '.cc' - '.asia' - '.ws' - '.tk' - '.biz' - '.su' - '.st' - '.ro' - '.ge' - '.ms' - '.pk' - '.nu' - '.me' - '.ph' - '.to' - '.tt' - '.name' - '.tv' - '.kz' - '.tc' - '.mobi' # spamhaus - '.study' - '.click' - '.link' - '.trade' - '.accountant' # spamhaus 2018 - '.cf' - '.gq' - '.ml' - '.ga' # custom - '.pw'
<li><a href="#">detection: selection: c-useragent: # apt related - 'sjzj (compatible; msie 6.0; win32)' # apt backspace - 'mozilla/5.0 (windows nt 6.; wow64; rv:20.0) gecko/20100101 firefox/20.0' # apt grizzlysteppe - chopstick - us cert - 'user-agent: mozilla/4.0 (compatible; msie 8.0; windows nt 6.1; trident/4.0; slcc' # comment crew miniasp - 'mozilla/4.0 (compatible; msie 7.4; win32;32-bit)' # comment crew miniasp - 'webclient' # naikon apt - 'mozilla/5.0 (windows; u; windows nt 5.1; zh-en; rv:1.7.12) gecko/200' # naikon apt - 'mozilla/4.0 (compatible; msi 6.0;' # snowglobe babar - yes, it is cut - 'mozilla/5.0 (windows nt 6.3; wow64; rv:28.0) gecko/20100101 firefox/28.0' # sofacy - xtunnel - 'mozilla/5.0 (windows nt 6.2; wow64; rv:20.0) gecko/20100101 firefox/' # sofacy - xtunnel - 'mozilla/5.0 (windows nt 6.; wow64; rv:20.0) gecko/20100101 firefox/2' # sofacy - xtunnel - 'mozilla/4.0' # derusbi backdoor elf - 'netscape' # unit78020 malware - 'mozilla/5.0 (windows; u; windows nt 5.1; zh-en; rv:1.7.12) gecko/20100719 firefox/1.0.7' # unit78020 malware - 'mozilla/5.0 (windows; u; windows nt 5.1; en-us; rv:1.9.2.13) firefox/3.6.13 gtb7.1' # winnti related - 'mozilla/5.0 (compatible; msie 9.0; windows nt 6.1; wow64; trident/5.0)' # winnti related - 'mozilla/4.0 (compatible; msie 8.0; windows nt 6.1; wow64; trident/4.0; slcc2; .netclr 2.0.50727)' # apt17 - 'mozilla/4.0 (compatible; msie 8.0; windows nt 6.0; sv1)' # bronze butler - daserf - 'mozilla/4.0 (compatible; msie 11.0; windows nt 6.1; sv1)' # bronze butler - daserf - 'mozilla/4.0 (compatible; msie 8.0; win32)' # tscookie - 'mozilla v5.1 (windows nt 6.1; rv:6.0.1) gecko/20100101 firefox/6.0.1' # delphi downloader - 'mozilla/6.1 (compatible; msie 9.0; windows nt 5.3; trident/5.0)' # vpnfilter - 'mozilla/4.0 (compatible; msie 6.0; windows nt 5.1; sv1; .net clr 1.1.4322; .net clr 2.0.50727; .net clr 3.0.04506.30; .net clr 3.0.04506.648; infopath.1)' # sofacy user-agent - 'mozilla/5.0 (windows nt 6.1; wow64) winhttp/1.6.3.8 (winhttp/5.1) like gecko' # sofacy user-agent - 'mozilla v5.1 *' # sofacy zebrocy samples - 'msie 8.0' # sofacy azzy backdoor from - 'mozilla/4.0 (compatible; msie 7.0; windows nt 6.1; slcc2; .net clr 2.0.50727; .net clr 3.5.30729; .net clr 3.0.30729; media center pc 6.0; .net4.0c; .net4.0e; infopath.2)' # - 'mozilla/4.0 (compatible; rms)' # attacks on industrial enterprises using rms and teamviewer - 'mozilla/4.0 (compatible; msie 6.0; dyngate)' # attacks on industrial enterprises using rms and teamviewer - 'o/9.27 (w; u; z)' # cmstar - 'mozilla/5.0 (compatible; msie 9.0; windows nt 6.0; trident/5.0; trident/5.0*' # kerrdown ua - 'mozilla/5.0 (windows nt 9; *' # suspicious 'windows nt 9' user agent - used by apt33 malware in 2018 - 'hots scot' # unknown ios zero-day implant - 'mozilla/5.0 (compatible; msie 10.0; windows nt)' # - 'mozilla/5.0 (windows nt 6.1; wow64) chrome/28.0.1500.95 safari/537.36' # hidden cobra malware - 'mozilla/5.0 (windows nt 6.2; win32; rv:47.0)' # strong pity loader - 'mozilla/4.0 (compatible; msie 6.0; windows nt 5.1;sv1;' # mustang panda - 'mozilla/5.0 (x11; linux i686; rv:22.0) firefox/22.0' # backdoordiplomacy - 'mozilla/5.0 chrome/72.0.3626.109 safari/537.36' # sidewalk malware used by sparkling goblin - 'mozilla/5.0 (windows nt 10.0; win64; x64; rv:fts_06) gecko/22.36.35.06 firefox/2.0' # litepower stager used by write
<li><a href="#">detection: selection: c-useragent: # cobalt strike - 'internet explorer *' - 'mozilla/4.0 (compatible; msie 6.0; windows nt 5.1; sv1; infopath.2)' # # metasploit framework - analysis by didier stevens - 'mozilla/4.0 (compatible; metasploit rspec)' - 'mozilla/4.0 (compatible; msie 6.1; windows nt)' - 'mozilla/4.0 (compatible; msie 6.0; windows nt 5.1)' # old browser, rare, base-lining needed - 'mozilla/4.0 (compatible; msie 7.0; windows nt 6.0)' # old browser, rare, base-lining needed - 'mozilla/4.0 (compatible; msie 8.0; windows nt 6.0; trident/4.0)' # old browser, rare, base-lining needed - 'mozilla/4.0 (compatible; msie 7.0; windows nt 6.0; trident/4.0; simbar={7db0f6de-8de7-4841-9084-28fa914b0f2e}; slcc1; .n' - 'mozilla/5.0 (compatible; googlebot/2.1; +)' # only use in proxy logs - not for detection in web server logs - 'mozilla/5.0 (windows; u; windows nt 5.1; en-us) applewebkit/525.13 (khtml, like gecko) chrome/4.0.221.6 safari/525.13' - 'mozilla/5.0 (compatible; msie 9.0; windows nt 6.1; wow64; trident/5.0; maau)' # payloads # metasploit update by florian roth 08.07.2017 - 'mozilla/5.0' - 'mozilla/4.0 (compatible; spipe/1.0' # - 'mozilla/5.0 (compatible; msie 10.0; windows nt 6.1; trident/6.0)' # too many false positives expected # - 'mozilla/5.0 (windows nt 6.1; trident/7.0; rv:11.0) like gecko' # too many false positives expected - 'mozilla/5.0 (windows nt 6.3; rv:39.0) gecko/20100101 firefox/35.0' - 'sametime community agent' # unknown if prone to false positives - used in - 'x-forwarded-for' - 'dotdotpwn v2.1' - 'sipdroid' - 'mozilla/5.0 (windows nt 10.0; win32; x32; rv:60.0)' # cobaltstrike # empire - 'mozilla/6.0 (x11; linux x86_64; rv:24.0) gecko/20140205 firefox/27.0 iceweasel/25.3.0' # exploits - '*wordpress hash grabber*' - '*exploit*'
<li><a href="#">detection: selection: c-useragent: # rats - 'mozilla/5.0 (windows nt 6.1; wow64; rv:53.0) gecko/20100101 chrome /53.0' # dargonok - 'mozilla/4.0 (compatible; msie 8.0; windows nt 5.1)' # used by plugx - base-lining recommended - - 'mozilla/4.0 (compatible; msie 7.0; windows nt 5.1; trident/4.0)' # used by plugx - base-lining recommended - - 'mozilla/4.0 (compatible; msie 6.0; windows nt 5.0; .net clr 1.1.4322)' # used by plugx - old - - 'httpbrowser/1.0' # httpbrowser rat - '*<|>*' # houdini / iniduoh / njrat - 'nsis_inetc (mozilla)' # zeroaccess - 'wget/1.9+cvs-stable (red hat modified)' # dyre / upatre # ghost419 - 'mozilla/4.0 (compatible; msie 8.0; windows nt 6.1; trident/4.0; .net clr 1.1.4322)' # malware - '*zeroup*' # w32/renos.downloader - 'mozilla/5.0 (windows nt 5.1 ; v.*' # kazy - '* adlib/*' # - '* tiny' # trojan downloader - '* bgroom *' # trojan downloader - '* changhuatong' - '* choltbagent' - 'mozilla/5.0 wininet' - 'rookie/1.0' - 'm' # hkmain - 'mozilla/4.0 (compatible; msie 8.0; windows nt 5.1; trident/4.0)' # egamipload - old ua - probable prone to false positives - 'mozilla/4.0 (compatible;msie 7.0;windows nt 6.0)' # yakes - 'backdoorbot' - 'mozilla/5.0 (windows; u; windows nt 5.1; en-us; rv:1.9.2.3) gecko/20100401 firefox/3.6.1 (.net clr 3.5.30731)' # sality - 'opera/8.81 (windows nt 6.0; u; en)' # sality - 'mozilla/5.0 (windows; u; windows nt 5.1; en-us; rv:1.9.2.3) gecko/20100401 firefox/3.6.1 (.net clr 3.5.30729)' # sality - 'opera' # trojan keragany - 'mozilla/4.0 (compatible; msie 5.0; windows 98)' # fareit - 'mozilla/4.0 (compatible; msie 5.01; windows nt 5.0)' # webshell's back connect - 'msie' # toby web shell - '*(charon; inferno)' # loki bot - 'mozilla/4.0 (compatible; msie 8.0; windows nt 5.1; trident/5.0)' # fareit / pony - 'mozilla/4.0 (compatible; msie 6.1; windows nt)' # - 'mozilla/4.0(compatible; msie 6.0; windows nt 5.1)' # maccontrol malware - 'mozilla/5.0 (windows nt 10.0; win64; x64)' # used by zebrocy malware # ursnif - 'mozilla/4.0 (compatible; msie 8.0; windows nt 10.0; win64; x64)' - 'mozilla/4.0 (compatible; msie 8.0; windows nt 6.1; win64; x64)' # emotet - 'mozilla/4.0 (compatible; msie 7.0; windows nt 6.2; wow64; trident/7.0; .net4.0c; .net4.0e; infopath.3)' # # others - '* pxyscand*' - '* asd' - '* mdms' - 'sample' - 'nocase' - 'moxilla' - 'win32 *' - '*microsoft internet explorer*' - 'agent *' - 'autoit' # suspicious - base-lining recommended - 'iczeliondownload' - 'mozilla/4.0 (compatible; msie 9.0; windows nt 10.0; .net4.0c; .net4.0e; tablet pc 2.0)' #
<li><a href="#">detection: selection: c-useragent: 'mozilla/5.0 (windows nt 6.1; wow64) applewebkit/537.36 (khtml, like gecko) chrome/36.0.1985.143 safari/537.36' r-dns: 'api.dropbox.com'
<li><a href="#">detection: selection: c-useragent: 'mozilla/5.0 (windows nt 6.1; wow64; trident/7.0; rv:11.0) like gecko' cs-uri-query: - '/admin/get.php' - '/news.php' - '/login/process.php' cs-method: 'post'
<li><a href="#">detection: selection: c-useragent|contains: ' windowspowershell/'
<li><a href="#">detection: selection: c-useragent|contains: # vulnerability scanner and brute force tools - '(hydra)' - ' arachni/' - ' bfac ' - ' brutus ' - ' cgichk ' - 'core-project/1.0' - ' crimscanner/' - 'datacha0s' - 'dirbuster' - 'domino hunter' - 'dotdotpwn' - 'fhscan core' - 'floodgate' - 'get-minimal' - 'gootkit auto-rooter scanner' - 'grendel-scan' - ' inspath ' - 'internet ninja' - 'jaascois' - ' zmeu ' - 'masscan' - ' metis ' - 'morfeus fucking scanner' - 'n-stealth' - 'nsauditor' - 'pmafind' - 'security scan' - 'springenwerk' - 'teh forest lobster' - 'toata dragostea' - ' vega/' - 'voideye' - 'webshag' - 'webvulnscan' - ' whcc/' # sql injection - ' havij' - 'absinthe' - 'bsqlbf' - 'mysqloit' - 'pangolin' - 'sql power injector' - 'sqlmap' - 'sqlninja' - 'uil2pn' # hack tool - 'ruler' # - 'mozilla/5.0 (windows; u; windows nt 5.1; pt-pt; rv:1.9.1.2) gecko/20090729 firefox/3.5.2 (.net clr 3.5.30729)' # sqli dumper
<li><a href="#">detection: selection: c-useragent|startswith: # xmrig - 'xmrig ' # ccminer - 'ccminer'
<li><a href="#">detection: selection: c-useragent|startswith: 'microsoft bits/' cs-host|startswith: - '1' - '2' - '3' - '4' - '5' - '6' - '7' - '8' - '9'
<li><a href="#">detection: selection: c-useragent|startswith: 'microsoft bits/' falsepositives: r-dns|endswith: - '.com' - '.net' - '.org' - '.scdn.co' # spotify streaming
<li><a href="#">detection: selection: c-useragent|startswith: 'microsoft-webdav-miniredir/' cs-method: 'get'
<li><a href="#">detection: selection: description: 'command-line ssh, telnet, and rlogin client' commandline|contains: ' -r '
<li><a href="#">detection: selection: description: 'execute processes remotely' product: 'sysinternals psexec' filter: image|endswith: - '\psexec.exe' - '\psexec64.exe'
<li><a href="#">detection: selection: description: 'python core' filter: - image|contains: - 'python' # fps with python38.dll, python.exe etc. - image|startswith: - 'c:\program files\' - 'c:\program files (x86)\'
<li><a href="#">detection: selection: description: 'system.management.automation' imageloaded|contains: 'system.management.automation' filter: - image|endswith: - '\powershell.exe' - '\mscorsvw.exe' - image|startswith: - 'c:\program files (x86)\microsoft visual studio\' - 'c:\program files\microsoft visual studio\' - 'c:\windows\system32\' - 'c:\program files\citrix\configsync\'
<li><a href="#">detection: selection: description|contains: 'st2stager'
<li><a href="#">detection: selection: description|startswith: - 'windows powershell' - 'pwsh' company: 'microsoft corporation' filter: image|endswith: - '\powershell.exe' - '\powershell_ise.exe' - '\pwsh.exe'
<li><a href="#">detection: selection: destination.port: - 8080 - 21 - 80 - 23 - 50000 - 1521 - 27017 - 1433 - 11211 - 3306 - 15672 - 5900 - 5901 - 5902 - 5903 - 5904
<li><a href="#">detection: selection: destinationhostname: - 'pool.minexmr.com' - 'fr.minexmr.com' - 'de.minexmr.com' - 'sg.minexmr.com' - 'ca.minexmr.com' - 'us-west.minexmr.com' - 'pool.supportxmr.com' - 'mine.c3pool.com' - 'xmr-eu1.nanopool.org' - 'xmr-eu2.nanopool.org' - 'xmr-us-east1.nanopool.org' - 'xmr-us-west1.nanopool.org' - 'xmr-asia1.nanopool.org' - 'xmr-jp1.nanopool.org' - 'xmr-au1.nanopool.org' - 'xmr.2miners.com' - 'xmr.hashcity.org' - 'xmr.f2pool.com' - 'xmrpool.eu' - 'pool.hashvault.pro' - 'moneroocean.stream' - 'monerocean.stream'
<li><a href="#">detection: selection: destinationport: - 25 - 587 - 465 - 2525 initiated: 'true' filter_clients: image|endswith: - \thunderbird.exe - \outlook.exe filter_mailserver: image|startswith: 'c:\program files\microsoft\exchange server\'
<li><a href="#">detection: selection: destinationport: - 5985 - 5986 filter: - user|contains: # covers many language settings - 'authori' - 'autori' - sourceip|startswith: '0:0:'
<li><a href="#">detection: selection: destinationport: 3389 initiated: 'true' filter: - image|endswith: - '\mstsc.exe' - '\rtsapp.exe' - '\rts2app.exe' - '\rdcman.exe' - '\ws_tunnelservice.exe' - '\rssensor.exe' - '\remotedesktopmanagerfree.exe' - '\remotedesktopmanager.exe' - '\remotedesktopmanager64.exe' - '\mremoteng.exe' - '\mremote.exe' - '\terminals.exe' - '\spiceworks-finder.exe' - '\fsdiscovery.exe' - '\fsassessment.exe' - '\mobarte.exe' - '\chrome.exe' - '\system32\dns.exe' - '\thor.exe' - '\thor64.exe' - '\passwordstate.exe' - '\avast software\avast\avastsvc.exe' - '\ranger\sentinelranger.exe' # sentinel one - '\avast\avastsvc.exe' - image|startswith: 'c:\program files\splunkuniversalforwarder\bin\'
<li><a href="#">detection: selection: destinationport: 88 initiated: 'true' filter: image|endswith: - '\lsass.exe' - '\opera.exe' - '\chrome.exe' - '\firefox.exe' - '\tomcat\bin\tomcat8.exe'
<li><a href="#">detection: selection: devicedetail.iscompliant: 'false'
<li><a href="#">detection: selection: displaymessage: max sign in attempts exceeded
<li><a href="#">detection: selection: displaymessage: user attempted unauthorized access to app
<li><a href="#">detection: selection: dst_port: 53 timeframe: 1m
<li><a href="#">detection: selection: engineversion|startswith: '2.' filter: hostversion|startswith: '2.'
<li><a href="#">detection: selection: event.category: security policy host.scan.vuln_name: firewall product not detected*
<li><a href="#">detection: selection: eventid: - 1006 - 1116 - 1015 - 1117
<li><a href="#">detection: selection: eventid: - 1031 - 1032 - 1034 provider_name: microsoft-windows-dhcp-server
<li><a href="#">detection: selection: eventid: - 12 - 13 targetobject|contains: 'system\' targetobject|endswith: '\services\localnetservice'
<li><a href="#">detection: selection: eventid: - 2002 # a windows firewall setting has changed. - 2003 # a windows firewall setting in the %1 profile has changed. - 2008 # windows firewall group policy settings have changed. the new settings have been applied # - 2010 # network profile changed on an interface.
<li><a href="#">detection: selection: eventid: - 2003 # loading drivers - 2100 # pnp or power management - 2102 # pnp or power management
<li><a href="#">detection: selection: eventid: - 2006 - 2033 #all rules filter: - modifyingapplication: 'c:\windows\system32\svchost.exe' - modifyingapplication|startswith: - 'c:\program files\' - 'c:\program files (x86)\'
<li><a href="#">detection: selection: eventid: - 40300 - 40301 - 40302 keywords: - 'hybridconnection' - 'sb://' - 'servicebus.windows.net' - 'hybridconnectionmanage'
<li><a href="#">detection: selection: eventid: - 4624 - 4625 logontype: '3' logonprocessname: 'ntlmssp' workstationname: '%workstations%' computername: '%workstations%' filter: targetusername: 'anonymous logon'
<li><a href="#">detection: selection: eventid: - 4625 - 4776 status: - '0xc0000072' # user logon to account disabled by administrator - '0xc000006f' # user logon outside authorized hours - '0xc0000070' # user logon from unauthorized workstation - '0xc0000413' # logon failure: the machine you are logging onto is protected by an authentication firewall. the specified account is not allowed to authenticate to the machine - '0xc000018c' # the logon request failed because the trust relationship between the primary domain and the trusted domain failed - '0xc000015b' # the user has not been granted the requested logon type (aka logon right) at this machine filter: subjectusersid: 's-1-0-0'
<li><a href="#">detection: selection: eventid: - 4656 - 4658 - 4660 - 4663 objectname|endswith: '\wceaux.dll'
<li><a href="#">detection: selection: eventid: - 4656 - 4663 - 4658 objectname|endswith: - '.aaa' - '.zzz'
<li><a href="#">detection: selection: eventid: - 4656 - 4663 objecttype: 'key' objectname: '\registry\machine\software\microsoft\adhealthagent' filter: processname|contains: - 'microsoft.identity.health.adfs.diagnosticsagent.exe' - 'microsoft.identity.health.adfs.insightsservice.exe' - 'microsoft.identity.health.adfs.monitoringagent.startup.exe' - 'microsoft.identity.health.adfs.pshsurrogate.exe' - 'microsoft.identity.health.common.clients.resourcemonitor.exe'
<li><a href="#">detection: selection: eventid: - 4656 - 4663 objecttype: 'key' objectname: '\registry\machine\software\microsoft\microsoft online\reporting\monitoringagent' filter: processname|contains: - 'microsoft.identity.health.adfs.diagnosticsagent.exe' - 'microsoft.identity.health.adfs.insightsservice.exe' - 'microsoft.identity.health.adfs.monitoringagent.startup.exe' - 'microsoft.identity.health.adfs.pshsurrogate.exe' - 'microsoft.identity.health.common.clients.resourcemonitor.exe'
<li><a href="#">detection: selection: eventid: - 4656 - 4663 objecttype: 'key' objectname|endswith: - 'lsa\jd' - 'lsa\gbg' - 'lsa\skew1' - 'lsa\data'
<li><a href="#">detection: selection: eventid: - 4657 - 4656 - 4660 - 4663 objectname|contains: '\microsoft\windows defender\exclusions\'
<li><a href="#">detection: selection: eventid: - 4657 - 4656 - 4663 objectname|contains: - '\software\microsoft\windows\currentversion\capabilityaccessmanager\consentstore\microphone\nonpackaged' - '\software\microsoft\windows\currentversion\capabilityaccessmanager\consentstore\webcam\nonpackaged'
<li><a href="#">detection: selection: eventid: - 4663 - 4656 accessmask: - '0x40' - '0x1400' # - '0x1000' # minimum access requirements to query basic info from service - '0x100000' - '0x1410' # car.2019-04-004 - '0x1010' # car.2019-04-004 - '0x1438' # car.2019-04-004 - '0x143a' # car.2019-04-004 - '0x1418' # car.2019-04-004 - '0x1f0fff' - '0x1f1fff' - '0x1f2fff' - '0x1f3fff' - '40' - '1400' - '1000' - '100000' - '1410' # car.2019-04-004 - '1010' # car.2019-04-004 - '1438' # car.2019-04-004 - '143a' # car.2019-04-004 - '1418' # car.2019-04-004 - '1f0fff' - '1f1fff' - '1f2fff' - '1f3fff' objecttype: 'process' objectname|endswith: '\lsass.exe' filter1: subjectusername|endswith: '$' filter2: processname|startswith: 'c:\program files' # too many false positives with legitimate av and edr solutions
<li><a href="#">detection: selection: eventid: - 4720 # create user - 4781 # rename user samaccountname|contains: '$'
<li><a href="#">detection: selection: eventid: - 4728 - 4729 - 4730 - 633 - 632 - 634
<li><a href="#">detection: selection: eventid: - 5001 - 5010 - 5012 - 5101
<li><a href="#">detection: selection: eventid: - 5038 - 6281
<li><a href="#">detection: selection: eventid: - 528 - 529 - 4624 - 4625 logontype: 2 computername: - '%serversystems%' - '%domaincontrollers%' filter: logonprocessname: advapi computername: '%workstations%'
<li><a href="#">detection: selection: eventid: - 56 - 50 provider_name: termdd
<li><a href="#">detection: selection: eventid: - 5805 - 5723 keywords: - kali - mimikatz
<li><a href="#">detection: selection: eventid: - 6 - 8 keywords: - 'cmdlet failed. cmdlet get-app, ' - 'task get-app throwing unhandled exception: system.invalidcastexception:'
<li><a href="#">detection: selection: eventid: - 675 - 4768 - 4769 - 4771 failurecode: - '0x9' - '0xa' - '0xb' - '0xf' - '0x10' - '0x11' - '0x13' - '0x14' - '0x1a' - '0x1f' - '0x21' - '0x22' - '0x23' - '0x24' - '0x26' - '0x27' - '0x28' - '0x29' - '0x2c' - '0x2d' - '0x2e' - '0x2f' - '0x31' - '0x32' - '0x3e' - '0x3f' - '0x40' - '0x41' - '0x43' - '0x44'
<li><a href="#">detection: selection: eventid: - 8 - 10 sourceimage|endswith: '\powershell.exe' targetimage|endswith: '\lsass.exe'
<li><a href="#">detection: selection: eventid: - 8004 - 8007
<li><a href="#">detection: selection: eventid: - 808 # old id - 4909 # new id errorcode: - '0x45a' - '0x7e' keywords: - 'the print spooler failed to load a plug-in module' # default file names used in poc codes - 'myexploit.dll' - 'evil.dll' - '\addcube.dll' - '\rev.dll' - '\rev2.dll' - '\main64.dll' - '\mimilib.dll' - '\mimispool.dll' falsepositive: - ' registration timed out' # ex: the print spooler failed to load a plug-in module printconfig registration timed out
<li><a href="#">detection: selection: eventid: 1013 eventtype: 4
<li><a href="#">detection: selection: eventid: 1033 provider_name: microsoft-windows-dhcp-server
<li><a href="#">detection: selection: eventid: 1033 provider_name: 'msiinstaller' keywords: - 'test pkg'
<li><a href="#">detection: selection: eventid: 1033 provider_name: msiinstaller message|contains: ateraagent
<li><a href="#">detection: selection: eventid: 104 provider_name: microsoft-windows-eventlog
<li><a href="#">detection: selection: eventid: 104 provider_name: microsoft-windows-eventlog channel: - "system" - "security" - "application"
<li><a href="#">detection: selection: eventid: 106 filter1: taskname: \microsoft\windows\windows defender\windows defender scheduled scan timeframe: 7d
<li><a href="#">detection: selection: eventid: 1102 provider_name: microsoft-windows-eventlog
<li><a href="#">detection: selection: eventid: 1116 source_name: 'amsi'
<li><a href="#">detection: selection: eventid: 1121 path|endswith: '\lsass.exe' filter_thor: processname|startswith: 'c:\windows\temp\asgard2-agent\' processname|endswith: - '\thor64.exe' - '\thor.exe' filter_exact: processname: - 'c:\windows\system32\atiesrxx.exe' - 'c:\windows\system32\compattelrunner.exe' - 'c:\windows\system32\msiexec.exe' - 'c:\windows\system32\nvwmi64.exe' - 'c:\windows\system32\svchost.exe' - 'c:\windows\system32\taskmgr.exe' - 'c:\windows\system32\wbem\wmiprvse.exe' - 'c:\windows\syswow64\msiexec.exe' filter_begins: processname|startswith: - 'c:\windows\system32\\driverstore\' - 'c:\windows\installer\' - 'c:\program files\' - 'c:\program files (x86)\'
<li><a href="#">detection: selection: eventid: 1121 processname|endswith: - '\wmiprvse.exe' - '\psexesvc.exe'
<li><a href="#">detection: selection: eventid: 16 # to avoid fp just add # filter: # configurationfilehash: 'sha256=the_hash_of_your_valid_config_xml' #
<li><a href="#">detection: selection: eventid: 16 provider_name: microsoft-windows-kernel-general hivename|contains: '\appdata\local\temp\sam' hivename|endswith: '.dmp'
<li><a href="#">detection: selection: eventid: 16403 filter: remotename|contains: - '.com' - '.azureedge.net' - '.sfx.ms' - 'download.mozilla.org' #
<li><a href="#">detection: selection: eventid: 16403 localname|contains: - 'c:\users\public\' - '%public%' - '\desktop\'
<li><a href="#">detection: selection: eventid: 16403 localname|endswith: - '.ps1' - '.exe' - '.vbs' - '.bat' filter: # typical updates: chrome, dropbox etc. localname|contains: '\appdata\' remotename|contains: '.com'
<li><a href="#">detection: selection: eventid: 16403 remotename|contains: - 'raw.githubusercontent.com' - 'gist.githubusercontent.com' - 'pastebin.com' - 'cdn.discordapp.com/attachments/' - 'mediafire.com' - 'mega.nz' - 'ddns.net' - '.paste.ee' - '.hastebin.com' - '.ghostbin.co/' - 'ufile.io' - 'storage.googleapis.com'
<li><a href="#">detection: selection: eventid: 2004 filter_block: action: 2 filter_installations: - applicationpath|startswith: - 'c:\program files\' - 'c:\program files (x86)\' - modifyingapplication: 'c:\windows\system32\oobe\setup.exe' - modifyingapplication|startswith: 'c:\windows\winsxs\' # tiworker.exe - modifyingapplication: - 'c:\windows\syswow64\msiexec.exe' - 'c:\windows\system32\svchost.exe' - 'c:\windows\system32\dllhost.exe' - 'c:\program files\windows defender\msmpeng.exe'
<li><a href="#">detection: selection: eventid: 2005 filter: modifyingapplication|startswith: - 'c:\program files (x86)\' - 'c:\program files\'
<li><a href="#">detection: selection: eventid: 21 address|contains: '16777216'
<li><a href="#">detection: selection: eventid: 22 message|contains: 'c:\\program files\\nxlog\\nxlog.exe' hostname|startswith: 'ec2amaz'
<li><a href="#">detection: selection: eventid: 257 qname: - 'asyspy256.ddns.net' - 'hotkillmail9sddcc.ddns.net' - 'rosaf112.ddns.net' - 'cvdfhjh1231.myftp.biz' - 'sz2016rose.ddns.net' - 'dffwescwer4325.myftp.biz' - 'cvdfhjh1231.ddns.net'
<li><a href="#">detection: selection: eventid: 3 processpath|endswith: '\bitsadmin.exe'
<li><a href="#">detection: selection: eventid: 3 processpath|endswith: '\powershell.exe'
<li><a href="#">detection: selection: eventid: 31017 description|contains: 'rejected an insecure guest logon' username: '' servername|startswith: '\1'
<li><a href="#">detection: selection: eventid: '316' keywords: - 'unidrv.dll, kernelbase.dll, ' - ' 123 ' - ' 1234 ' - 'mimispool'
<li><a href="#">detection: selection: eventid: 4611 logonprocessname: 'user32logonprocesss'
<li><a href="#">detection: selection: eventid: 4616 filter1: processname: - 'c:\program files\vmware\vmware tools\vmtoolsd.exe' - 'c:\windows\system32\vboxservice.exe' - 'c:\windows\system32\oobe\msoobe.exe' filter2: processname: 'c:\windows\system32\svchost.exe' subjectusersid: 's-1-5-19'
<li><a href="#">detection: selection: eventid: 4624 logontype: 10 authenticationpackagename: negotiate targetusername|startswith: 'admin'
<li><a href="#">detection: selection: eventid: 4624 logontype: 10 ipaddress: - '::1' - '127.0.0.1'
<li><a href="#">detection: selection: eventid: 4624 logontype: 3 authenticationpackagename: 'kerberos' ipaddress: '127.0.0.1' targetusersid|startswith: 's-1-5-21-' targetusersid|endswith: '-500'
<li><a href="#">detection: selection: eventid: 4624 logontype: 3 processname|endswith: 'scrcons.exe' filter: targetlogonid: '0x3e7'
<li><a href="#">detection: selection: eventid: 4624 logontype: 3 targetusername: 'anonymous_logon' workstationname: '-' ipaddress: '127.0.0.1'
<li><a href="#">detection: selection: eventid: 4624 logontype: 9
<li><a href="#">detection: selection: eventid: 4624 logontype: 9 logonprocessname: seclogo authenticationpackagename: negotiate
<li><a href="#">detection: selection: eventid: 4624 processname|endswith: '\wmiprvse.exe'
<li><a href="#">detection: selection: eventid: 4625 ip_unknown: ipaddress|contains: '-' ip_privatev4: ipaddress|startswith: - '10.' #10.0.0.0/8 - '192.168.' #192.168.0.0/16 - '172.16.' #172.16.0.0/12 - '172.17.' - '172.18.' - '172.19.' - '172.20.' - '172.21.' - '172.22.' - '172.23.' - '172.24.' - '172.25.' - '172.26.' - '172.27.' - '172.28.' - '172.29.' - '172.30.' - '172.31.' - '127.' #127.0.0.0/8 - '169.254.' #169.254.0.0/16 ip_privatev6: - ipaddress: '::1' #loopback - ipaddress|startswith: - 'fe80::' #link-local - 'fc00::' #unique local
<li><a href="#">detection: selection: eventid: 4625 targetusername: aaaaaaa
<li><a href="#">detection: selection: eventid: 4648 processname|endswith: - '\cmd.exe' - '\powershell.exe' - '\pwsh.exe' - '\winrs.exe' - '\wmic.exe' - '\net.exe' - '\net1.exe' - '\reg.exe' filter: targetservername: 'localhost'
<li><a href="#">detection: selection: eventid: 4656 objecttype: 'key' objectname|endswith: '\sam'
<li><a href="#">detection: selection: eventid: 4656 objecttype: 'sc_manager object' objectname: 'servicesactive' #keywords: 'audit failure' <-> in the ref 'keywords':-9214364837600034816 filter: subjectlogonid: '0x3e4'
<li><a href="#">detection: selection: eventid: 4656 processname|endswith: '\lsass.exe' accessmask: '0x705' objecttype: 'sam_domain'
<li><a href="#">detection: selection: eventid: 4657 objectname|contains|all: - '\registry\machine\system' - 'controlset' - '\control\lsa' objectvaluename: - 'lmcompatibilitylevel' - 'ntlmminclientsec' - 'restrictsendingntlmtraffic'
<li><a href="#">detection: selection: eventid: 4657 objectname|endswith: '\software\microsoft\.netframework' objectvaluename: 'etwenabled' newvalue: '0'
<li><a href="#">detection: selection: eventid: 4661 objecttype: - 'sam_user' - 'sam_group' objectname|startswith: 's-1-5-21-' accessmask: '0x2d' selection2: objectname|endswith: - '-500' - '-512'
<li><a href="#">detection: selection: eventid: 4661 objecttype: - 'sam_user' - 'sam_group' selection_object: - objectname|endswith: - '-512' - '-502' - '-500' - '-505' - '-519' - '-520' - '-544' - '-551' - '-555' - objectname|contains: 'admin'
<li><a href="#">detection: selection: eventid: 4662 accessmask: '0x100' properties|contains: - '1131f6aa-9c07-11d1-f79f-00c04fc2dcd2' - '1131f6ad-9c07-11d1-f79f-00c04fc2dcd2' - '89e95b76-444d-4c62-991a-0facbeda640c' filter: - subjectusername|endswith: '$' - subjectusername|startswith: 'msol_' #
<li><a href="#">detection: selection: eventid: 4662 objectserver: 'ds' accessmask: '0x40000' objecttype: - '19195a5b-6da0-11d0-afd3-00c04fd930c9' - 'domaindns'
<li><a href="#">detection: selection: eventid: 4662 objecttype: 'secretobject' accessmask: '0x2' objectname|contains: 'bckupkey'
<li><a href="#">detection: selection: eventid: 4662 objecttype: 'wmi namespace' objectname|contains: 'subscription'
<li><a href="#">detection: selection: eventid: 4662 objecttype|contains: 'bf967aba-0de6-11d0-a285-00aa003049e2' # using contains as the data commonly is structured as "%{bf967aba-0de6-11d0-a285-00aa003049e2}" # the user class () filter: - subjectusername|endswith: '$' # exclude machine accounts - subjectusername|startswith: 'msol_' #
<li><a href="#">detection: selection: eventid: 4662 properties|contains: - 'replicating directory changes all' - '1131f6ad-9c07-11d1-f79f-00c04fc2dcd2' - '1131f6aa-9c07-11d1-f79f-00c04fc2dcd2' - '9923a32a-3607-11d2-b9be-0000f87a36b2' - '89e95b76-444d-4c62-991a-0facbeda640c' accessmask: '0x100' filter1: subjectdomainname: 'window manager' filter2: subjectusername|startswith: - 'nt aut' - 'msol_' filter3: subjectusername|endswith: '$'
<li><a href="#">detection: selection: eventid: 4663 objectserver: 'security' objecttype: 'file' objectname: '\device\cdrom*' filter: objectname: '\device\cdrom0\setup.exe'
<li><a href="#">detection: selection: eventid: 4663 objecttype: 'file' accesslist: '%%1537' keywords: '0x8020000000000000' timeframe: 30s
<li><a href="#">detection: selection: eventid: 4674 objecttype: 'sc_manager object' objectname: 'servicesactive' privilegelist: 'setakeownershipprivilege' filter: subjectlogonid: '0x3e4' processname|endswith: ':\windows\system32\services.exe'
<li><a href="#">detection: selection: eventid: 4689 processname|endswith: nltest.exe status: '0x0'
<li><a href="#">detection: selection: eventid: 4697 malsvc_apt29: servicename: 'javamtsup'
<li><a href="#">detection: selection: eventid: 4697 selection_1: - servicefilename|re: '\$pshome\[\s*\d{1,3}\s*\]\s*\+\s*\$pshome\[' - servicefilename|re: '\$shellid\[\s*\d{1,3}\s*\]\s*\+\s*\$shellid\[' - servicefilename|re: '\$env:public\[\s*\d{1,3}\s*\]\s*\+\s*\$env:public\[' - servicefilename|re: '\$env:comspec\[(\s*\d{1,3}\s*,){2}' - servicefilename|re: '\\*mdr\*\w\s*\)\.name' - servicefilename|re: '\$verbosepreference\.tostring\(' - servicefilename|re: '\string\]\s*\$verbosepreference'
<li><a href="#">detection: selection: eventid: 4697 servicefilename|contains: - 'fgexec' - 'dumpsvc' - 'cachedump' - 'mimidrv' - 'gsecdump' - 'servpw' - 'pwdump'
<li><a href="#">detection: selection: eventid: 4697 servicefilename|contains: - 'pcap' - 'npcap' - 'npf' - 'nm3' - 'ndiscap' - 'nmnt' - 'windivert' - 'usbpcap' - 'pktmon'
<li><a href="#">detection: selection: eventid: 4697 servicefilename|contains: - 'powershell' - 'pwsh'
<li><a href="#">detection: selection: eventid: 4697 servicefilename|contains: '(clipboard|i'
<li><a href="#">detection: selection: eventid: 4697 servicefilename|contains: 'tap0901'
<li><a href="#">detection: selection: eventid: 4697 servicefilename|contains|all: - '&&' - 'rundll32' - 'shell32.dll' - 'shellexec_rundll' servicefilename|contains: - value - invoke - comspec - iex
<li><a href="#">detection: selection: eventid: 4697 servicefilename|contains|all: - 'cmd' - 'powershell' selection2: servicefilename|contains: - '${input}' - 'noexit' selection3: servicefilename|contains: - ' /c ' - ' /r '
<li><a href="#">detection: selection: eventid: 4697 servicefilename|contains|all: - 'mshta' - 'vbscript:createobject' - '.run' - 'window.close'
<li><a href="#">detection: selection: eventid: 4697 servicefilename|contains|all: - 'new-object' - 'text.encoding]::ascii' - 'readtoend' selection2: servicefilename|contains: - 'system.io.compression.deflatestream' - 'system.io.streamreader'
<li><a href="#">detection: selection: eventid: 4697 servicefilename|contains|all: - 'rundll32.exe' - 'shell32.dll' - 'shellexec_rundll' - 'powershell'
<li><a href="#">detection: selection: eventid: 4697 servicefilename|contains|all: - 'set' - '&&' servicefilename|contains: - 'environment' - 'invoke' - '${input)'
<li><a href="#">detection: selection: eventid: 4697 servicefilename|re: '(?i).*&&set.*(\{\d\}){2,}\\\"\s+?\-f.*&&.*cmd.*\/c' # fps with |\/r
<li><a href="#">detection: selection: eventid: 4697 servicefilename|re: '.*cmd.{0,5}(?:\/c|\/r)(?:\s|)\"set\s[a-za-z]{3,6}.*(?:\{\d\}){1,}\\\"\s+?\-f(?:.*\)){1,}.*\"'
<li><a href="#">detection: selection: eventid: 4697 servicefilename|re: '^%systemroot%\\[a-za-z]{8}\.exe$' servicename|re: '(^[a-za-z]{4}$)|(^[a-za-z]{8}$)|(^[a-za-z]{16}$)' servicestarttype: '3' # on-demand start, see servicetype: '0x10' filter: servicename: 'psexesvc'
<li><a href="#">detection: selection: eventid: 4697 servicename: hybridconnectionmanager servicefilename|contains: hybridconnectionmanager
<li><a href="#">detection: selection: eventid: 4698 timeframe: 7d
<li><a href="#">detection: selection: eventid: 4699 falsepositive1: taskname: '\microsoft\windows\removaltools\mrt_error_hb' # triggered by parentcommandline=c:\windows\system32\mrt.exe /ehb /heartbeatfailure errorstack,previous=errorstack,previous=errorstack,previous=errorstack,previous=errorstack,previous=submitheartbeatreportdata,hr=0x80072f8f,hr=0x80072f8f,hr=0x80072f8f,hr=0x80072f8f,hr=0x80072f8f /heartbeaterror 0x80072f8f
<li><a href="#">detection: selection: eventid: 4701 taskname: '\microsoft\windows\defrag\scheduleddefrag'
<li><a href="#">detection: selection: eventid: 4719 auditpolicychanges|contains: - '%%8448' # this is "success removed" - '%%8450' # this is "failure removed"
<li><a href="#">detection: selection: eventid: 4720 samaccountname|contains|all: - 'anonymous' - 'logon'
<li><a href="#">detection: selection: eventid: 4720 targetusername|endswith: '$'
<li><a href="#">detection: selection: eventid: 4738 # according to microsoft, the bit values are listed here: # however, that seems to be a simple copy from # and the actual flags that are used are quite different and, unfortunately, not documented. # contains a number of evtx files with relevant events, which can be used to extract # the following values. olduac_des: # 0x8000 olduacvalue|endswith: - 8??? - 9??? - a??? - b??? - c??? - d??? - e??? - f??? newuac_des: newuacvalue|endswith: - 8??? - 9??? - a??? - b??? - c??? - d??? - e??? - f??? olduac_preauth: # 0x10000 olduacvalue|endswith: - 1???? - 3???? - 5???? - 7???? - 9???? - b???? - d???? - f???? newuac_preauth: newuacvalue|endswith: - 1???? - 3???? - 5???? - 7???? - 9???? - b???? - d???? - f???? olduac_encrypted: # 0x800 olduacvalue|endswith: - 8?? - 9?? - a?? - b?? - c?? - d?? - e?? - f?? newuac_encrypted: newuacvalue|endswith: - 8?? - 9?? - a?? - b?? - c?? - d?? - e?? - f??
<li><a href="#">detection: selection: eventid: 4742 subjectusername: 'anonymous logon' targetusername: '%dc-machine-name%' # dc machine account name that ends with '$' filter: passwordlastset: '-'
<li><a href="#">detection: selection: eventid: 4768 status: '0x12' filter_computer: targetusername|endswith: '$' timeframe: 24h
<li><a href="#">detection: selection: eventid: 4768 status: '0x6' filter_computer: targetusername|endswith: '$' timeframe: 24h
<li><a href="#">detection: selection: eventid: 4768 targetusername|endswith: '$' certthumbprint: '*' filter_local: ipaddress: '::1' filter_thumbprint: certthumbprint: ''
<li><a href="#">detection: selection: eventid: 4769 ticketoptions: '0x40810000' ticketencryptiontype: '0x17' reduction: servicename|endswith: '$'
<li><a href="#">detection: selection: eventid: 4771 status: '0x18' filter_computer: targetusername|endswith: '$' timeframe: 24h
<li><a href="#">detection: selection: eventid: 4781 # rename user oldtargetusername|contains: '$' filter: newtargetusername|contains: '$'
<li><a href="#">detection: selection: eventid: 4799 targetusername|startswith: 'administr' callerprocessname|endswith: '\checkadmin.exe'
<li><a href="#">detection: selection: eventid: 5013 value|endswith: - '\windows defender\disableantispyware = 0x1()' - '\real-time protection\disablerealtimemonitoring = (current)'
<li><a href="#">detection: selection: eventid: 5136 attributeldapdisplayname: 'ntsecuritydescriptor' attributevalue|contains: - '1131f6ad-9c07-11d1-f79f-00c04fc2dcd2' - '1131f6aa-9c07-11d1-f79f-00c04fc2dcd2' - '89e95b76-444d-4c62-991a-0facbeda640c' filter1: objecttype: - 'dnsnode' - 'dnszonescope'
<li><a href="#">detection: selection: eventid: 5136 attributevalue: '*' attributeldapdisplayname: - 'primaryinternationalisdnnumber' - 'otherfacsimiletelephonenumber' - 'primarytelexnumber'
<li><a href="#">detection: selection: eventid: 5140 sharename: admin$ filter: subjectusername|endswith: '$'
<li><a href="#">detection: selection: eventid: 5145 objecttype: file relativetargetname|endswith: '\desktop.ini' accesslist|contains: - 'writedata' - 'delete' - 'writedac' - 'appenddata' - 'addsubdirectory'
<li><a href="#">detection: selection: eventid: 5145 relativetargetname|endswith: - '.pst' - '.ost' - '.msg' - '.nst' - '.oab' - '.edb' - '.nsf' - '.bak' - '.dmp' - '.kirbi' - '\groups.xml' - '.rdp'
<li><a href="#">detection: selection: eventid: 5145 relativetargetname|endswith: '\internet explorer\iertutil.dll' filter: subjectusername|endswith: '$'
<li><a href="#">detection: selection: eventid: 5145 sharename: \\\*\admin$ relativetargetname|contains|all: - 'system32\' - '.tmp'
<li><a href="#">detection: selection: eventid: 5145 sharename: \\\*\ipc$ relativetargetname: atsvc accesses|contains: 'writedata'
<li><a href="#">detection: selection: eventid: 5145 sharename: \\\*\ipc$ relativetargetname: spoolss
<li><a href="#">detection: selection: eventid: '5145' sharename: '\\\*\ipc$' relativetargetname: 'spoolss' accessmask: '0x3' objecttype: 'file'
<li><a href="#">detection: selection: eventid: 5145 sharename: \\\*\ipc$ relativetargetname: svcctl accesses|contains: 'writedata'
<li><a href="#">detection: selection: eventid: 5145 sharename: \\\*\sysvol relativetargetname|endswith: 'scheduledtasks.xml' accesses|contains: - 'writedata' - '%%4417'
<li><a href="#">detection: selection: eventid: 5145 sharename|contains: 'ipc' relativetargetname: 'protected_storage'
<li><a href="#">detection: selection: eventid: 5145 sharename|endswith: 'c$' accessmask: '0x2' filter: subjectusername|endswith: '$'
<li><a href="#">detection: selection: eventid: 5145 sharename|startswith: '\\' sharename|endswith: '\ipc$' relativetargetname: lsarpc subjectusername: anonymous logon
<li><a href="#">detection: selection: eventid: 5156 destinationport: - 3268 - 3269 timeframe: 1h
<li><a href="#">detection: selection: eventid: 5156 destinationport: 88 filter: image|endswith: - '\lsass.exe' - '\opera.exe' - '\chrome.exe' - '\firefox.exe'
<li><a href="#">detection: selection: eventid: 5156 destport: - 5985 - 5986 layerrtid: 44
<li><a href="#">detection: selection: eventid: 5156 sourcerdp: sourceport: 3389 destaddress: - '127.*' - '::1' destinationrdp: destport: 3389 sourceaddress: - '127.*' - '::1' filter_thor: # checking bluekeep vulnerability application|endswith: - '\thor.exe' - '\thor64.exe'
<li><a href="#">detection: selection: eventid: 524 provider_name: microsoft-windows-backup
<li><a href="#">detection: selection: eventid: 5379 targetname|contains: 'microsoft_windows_shell_zipfolder:filename' filter: # avoid overlaps with 54f0434b-726f-48a1-b2aa-067df14516e4 targetname|contains: '\temporary internet files\content.outlook'
<li><a href="#">detection: selection: eventid: 5379 targetname|contains: 'microsoft_windows_shell_zipfolder:filename' selection_filename: targetname|contains: - 'invoice' - 'new order' - 'rechnung' - 'factura' - 'delivery' - 'purchase' - 'order' - 'payment'
<li><a href="#">detection: selection: eventid: 5379 targetname|contains|all: - 'microsoft_windows_shell_zipfolder:filename' - '\temporary internet files\content.outlook'
<li><a href="#">detection: selection: eventid: 6 keywords: - 'install-transportagent'
<li><a href="#">detection: selection: eventid: 6416 classname: 'diskdrive' selection2: devicedescription: 'usb mass storage device'
<li><a href="#">detection: selection: eventid: 7036 provider_name: 'service control manager' param1: - 'windows defender antivirus service' - 'service antivirus microsoft defender' #french os param2: 'stopped'
<li><a href="#">detection: selection: eventid: 7045 selection_1: - imagepath|re: '\$pshome\[\s*\d{1,3}\s*\]\s*\+\s*\$pshome\[' - imagepath|re: '\$shellid\[\s*\d{1,3}\s*\]\s*\+\s*\$shellid\[' - imagepath|re: '\$env:public\[\s*\d{1,3}\s*\]\s*\+\s*\$env:public\[' - imagepath|re: '\$env:comspec\[(\s*\d{1,3}\s*,){2}' - imagepath|re: '\\*mdr\*\w\s*\)\.name' - imagepath|re: '\$verbosepreference\.tostring\(' - imagepath|re: '\string\]\s*\$verbosepreference'
<li><a href="#">detection: selection: eventid: '7045' servicename: 'krbscm'
<li><a href="#">detection: selection: eventid: 8001 targetname|startswith: termsrv
<li><a href="#">detection: selection: eventid: 8002 processname: '*' # we use this to avoid false positives with id 8002 on other log sources if the logsource isn't set correctly
<li><a href="#">detection: selection: eventid: 8004 devicename: workstationname: - 'rdesktop' - 'remmina' - 'freerdp' - 'windows7' - 'windows8' - 'windows2012' - 'windows2016' - 'windows2019'
<li><a href="#">detection: selection: eventlog: rpcfw eventid: 3 interfaceuuid: - 12345678-1234-abcd-ef00-0123456789ab - 76f03f96-cdfd-44fc-a22c-64950a001209 - 0b6edbfa-4a24-4fc6-8a23-942b1eca65d1 - ae33069b-a2a8-46ee-a235-ddfd339be281
<li><a href="#">detection: selection: eventlog: rpcfw eventid: 3 interfaceuuid: - 4d9f4ab8-7d1c-11cf-861e-0020af6e7c57 - 99fcfec4-5260-101b-bbcb-00aa0021347a - 000001a0-0000-0000-c000-000000000046 - 00000131-0000-0000-c000-000000000046 - 00000143-0000-0000-c000-000000000046 - 00000000-0000-0000-c000-000000000046
<li><a href="#">detection: selection: eventlog: rpcfw eventid: 3 interfaceuuid: - 82273fdc-e32a-18c3-3f78-827929dc23ea - f6beaff7-1e19-4fbb-9f8f-b89e2018337c
<li><a href="#">detection: selection: eventlog: rpcfw eventid: 3 interfaceuuid: - df1941c5-fe89-4e79-bf10-463657acf44d - c681d488-d850-11d0-8c52-00c04fd90f7e
<li><a href="#">detection: selection: eventlog: rpcfw eventid: 3 interfaceuuid: 1ff70682-0a51-30e8-076d-740be8cee98b filter: opnum: - 0 - 1
<li><a href="#">detection: selection: eventlog: rpcfw eventid: 3 interfaceuuid: 1ff70682-0a51-30e8-076d-740be8cee98b opnum: - 0 - 1
<li><a href="#">detection: selection: eventlog: rpcfw eventid: 3 interfaceuuid: 338cd001-2244-31f1-aaaa-900038001003 filter: opnum: - 6 - 7 - 8 - 13 - 18 - 19 - 21 - 22 - 23 - 35
<li><a href="#">detection: selection: eventlog: rpcfw eventid: 3 interfaceuuid: 338cd001-2244-31f1-aaaa-900038001003 opnum: - 6 - 7 - 8 - 13 - 18 - 19 - 21 - 22 - 23 - 35
<li><a href="#">detection: selection: eventlog: rpcfw eventid: 3 interfaceuuid: 367abb81-9844-35f1-ad32-98f038001003
<li><a href="#">detection: selection: eventlog: rpcfw eventid: 3 interfaceuuid: 378e52b0-c0a9-11cf-822d-00aa0051e40f filter: opnum: - 0 - 1
<li><a href="#">detection: selection: eventlog: rpcfw eventid: 3 interfaceuuid: 378e52b0-c0a9-11cf-822d-00aa0051e40f opnum: - 0 - 1
<li><a href="#">detection: selection: eventlog: rpcfw eventid: 3 interfaceuuid: 4b324fc8-1670-01d3-1278-5a47bf6ee188
<li><a href="#">detection: selection: eventlog: rpcfw eventid: 3 interfaceuuid: 4b324fc8-1670-01d3-1278-5a47bf6ee188 opnum: 12
<li><a href="#">detection: selection: eventlog: rpcfw eventid: 3 interfaceuuid: 6bffd098-a112-3610-9833-46c3f87e345a opnum: 2
<li><a href="#">detection: selection: eventlog: rpcfw eventid: 3 interfaceuuid: 86d35949-83c9-4044-b424-db363231fd0c filter: opnum: - 1 - 3 - 4 - 10 - 11 - 12 - 13 - 14 - 15
<li><a href="#">detection: selection: eventlog: rpcfw eventid: 3 interfaceuuid: 86d35949-83c9-4044-b424-db363231fd0c opnum: - 1 - 3 - 4 - 10 - 11 - 12 - 13 - 14 - 15
<li><a href="#">detection: selection: eventlog: rpcfw eventid: 3 interfaceuuid: e3514235-4b06-11d1-ab04-00c04fc2dcd2 filter: opnum: - 0 - 1 - 12
<li><a href="#">detection: selection: eventname: - 'archivefindings' - 'createfindingsfilter' - 'deletemember' - 'disassociatefrommasteraccount' - 'disassociatemember' - 'disablemacie' - 'disableorganizationadminaccount' - 'updatefindingsfilter' - 'updatemaciesession' - 'updatemembersession' - 'updateclassificationjob' timeframe: 10m
<li><a href="#">detection: selection: eventname: 'createinstanceexporttask' eventsource: 'ec2.amazonaws.com' filter1: errormessage: '*' filter2: errorcode: '*' filter3: responseelements|contains: 'failure'
<li><a href="#">detection: selection: eventservice: admin.googleapis.com eventname: - delete_role - rename_role - update_role
<li><a href="#">detection: selection: eventservice: admin.googleapis.com eventname: - grant_delegated_admin_privileges - grant_admin_privilege
<li><a href="#">detection: selection: eventservice: admin.googleapis.com eventname: - remove_application - remove_application_from_whitelist
<li><a href="#">detection: selection: eventservice: admin.googleapis.com eventname: authorize_api_client_access
<li><a href="#">detection: selection: eventservice: admin.googleapis.com eventname: remove_privilege
<li><a href="#">detection: selection: eventsource: azureactivedirectory eventname: 'disable strong authentication.' status: success
<li><a href="#">detection: selection: eventsource: ec2.amazonaws.com eventname: disableebsencryptionbydefault
<li><a href="#">detection: selection: eventsource: ecs.amazonaws.com eventname: - describetaskdefinition - registertaskdefinition - runtask requestparameters.containerdefinitions.command|contains|all: - '169.254' - '$aws_container_credentials'
<li><a href="#">detection: selection: eventsource: eks.amazonaws.com eventname: - createcluster - deletecluster
<li><a href="#">detection: selection: eventsource: elasticache.amazonaws.com eventname: - 'deletecachesecuritygroup' - 'authorizecachesecuritygroupingress' - 'revokecachesecuritygroupingress' - 'authorizecachesecuritygroupegress' - 'revokecachesecuritygroupegress'
<li><a href="#">detection: selection: eventsource: elasticache.amazonaws.com eventname: 'createcachesecuritygroup'
<li><a href="#">detection: selection: eventsource: elasticfilesystem.amazonaws.com eventname: deletefilesystem
<li><a href="#">detection: selection: eventsource: elasticfilesystem.amazonaws.com eventname: deletemounttarget
<li><a href="#">detection: selection: eventsource: exchange eventname: 'add-federateddomain' status: success
<li><a href="#">detection: selection: eventsource: lambda.amazonaws.com eventname|startswith: updatefunctionconfiguration
<li><a href="#">detection: selection: eventsource: route53.amazonaws.com eventname: disabledomaintransferlock
<li><a href="#">detection: selection: eventsource: route53.amazonaws.com eventname: transferdomaintoanotherawsaccount
<li><a href="#">detection: selection: eventsource: s3.amazonaws.com eventname: - putbucketlogging - putbucketwebsite - putencryptionconfiguration - putlifecycleconfiguration - putreplicationconfiguration - replicateobject - restoreobject
<li><a href="#">detection: selection: eventsource: securitycompliancecenter eventname: 'activity from anonymous ip addresses' status: success
<li><a href="#">detection: selection: eventsource: securitycompliancecenter eventname: 'activity from infrequent country' status: success
<li><a href="#">detection: selection: eventsource: securitycompliancecenter eventname: 'activity from suspicious ip addresses' status: success
<li><a href="#">detection: selection: eventsource: securitycompliancecenter eventname: 'activity performed by terminated user' status: success
<li><a href="#">detection: selection: eventsource: securitycompliancecenter eventname: 'data exfiltration to unsanctioned apps' status: success
<li><a href="#">detection: selection: eventsource: securitycompliancecenter eventname: 'impossible travel activity' status: success
<li><a href="#">detection: selection: eventsource: securitycompliancecenter eventname: 'log on from a risky ip address' status: success
<li><a href="#">detection: selection: eventsource: securitycompliancecenter eventname: 'potential ransomware activity' status: success
<li><a href="#">detection: selection: eventsource: securitycompliancecenter eventname: 'suspicious inbox forwarding' status: success
<li><a href="#">detection: selection: eventsource: securitycompliancecenter eventname: 'suspicious oauth app file download activities' status: success
<li><a href="#">detection: selection: eventsource: securitycompliancecenter eventname: 'unusual volume of file deletion' status: success
<li><a href="#">detection: selection: eventsource: securitycompliancecenter eventname: 'user restricted from sending email' status: success
<li><a href="#">detection: selection: eventsource: securityhub.amazonaws.com eventname: - 'batchupdatefindings' - 'deleteinsight' - 'updatefindings' - 'updateinsight'
<li><a href="#">detection: selection: eventsource: sts.amazonaws.com eventname: getsessiontoken useridentity.type: iamuser
<li><a href="#">detection: selection: eventtype: - application.lifecycle.update - application.lifecycle.delete
<li><a href="#">detection: selection: eventtype: - application.policy.sign_on.update - application.policy.sign_on.rule.delete
<li><a href="#">detection: selection: eventtype: - group.privilege.grant - user.account.privilege.grant
<li><a href="#">detection: selection: eventtype: - policy.lifecycle.update - policy.lifecycle.delete
<li><a href="#">detection: selection: eventtype: - policy.rule.update - policy.rule.delete
<li><a href="#">detection: selection: eventtype: - user.mfa.factor.deactivate - user.mfa.factor.reset_all
<li><a href="#">detection: selection: eventtype: - zone.deactivate - zone.delete
<li><a href="#">detection: selection: eventtype: 'createkey' # don't want deletekey events targetobject|contains|all: - 'hku\' - 'classes\clsid\' - '\treatas'
<li><a href="#">detection: selection: eventtype: createkey targetobject|contains: '\software\appdatalow\software\microsoft\' filter: targetobject|contains: - '\software\appdatalow\software\microsoft\internet explorer\' - '\software\appdatalow\software\microsoft\repservice\' - '\software\appdatalow\software\microsoft\ime\' - '\software\appdatalow\software\microsoft\edge\'
<li><a href="#">detection: selection: eventtype: createkey targetobject|contains: '\software\netwire'
<li><a href="#">detection: selection: eventtype: createkey targetobject|contains: '\software\sysinternals\sdelete'
<li><a href="#">detection: selection: eventtype: createkey targetobject|contains: 'userinitmprlogonscript'
<li><a href="#">detection: selection: eventtype: createkey targetobject|endswith: '\eulaaccepted'
<li><a href="#">detection: selection: eventtype: deletekey targetobject|contains|all: - '\software\microsoft\windows nt\currentversion\schedule\taskcache\tree\' - 'sd'
<li><a href="#">detection: selection: eventtype: deletekey targetobject|endswith: - '{2781761e-28e0-4109-99fe-b9d127c57afe}' - '{a7c452ef-8e9f-42eb-9f2b-245613ca0dc9}'
<li><a href="#">detection: selection: eventtype: 'deletekey' targetobject|endswith: '\shell\open\command' filter_svchost: image: 'c:\windows\system32\svchost.exe' filter_office: image|startswith: - 'c:\program files\common files\microsoft shared\clicktorun\' - 'c:\program files\common files\microsoft shared\clicktorun\updates\' image|endswith: '\officeclicktorun.exe' filter_integrator: image: 'c:\program files (x86)\microsoft office\root\integration\integrator.exe' filter_dropbox: image|endswith: '\dropbox.exe' targetobject|startswith: 'hkcr\dropbox.'
<li><a href="#">detection: selection: eventtype: security.threat.detected
<li><a href="#">detection: selection: eventtype: setvalue #hkey_local_machine\system\currentcontrolset\services\sharedaccess\parameters\firewallpolicy\domainprofile\enablefirewall #hkey_local_machine\system\currentcontrolset\services\sharedaccess\parameters\firewallpolicy\publicprofile\enablefirewall #hkey_local_machine\system\currentcontrolset\services\sharedaccess\parameters\firewallpolicy\standardprofile\enablefirewall targetobject|startswith: hklm\system\currentcontrolset\services\sharedaccess\parameters\firewallpolicy\ targetobject|endswith: \enablefirewall details: dword (0x00000000)
<li><a href="#">detection: selection: eventtype: setvalue image|endswith: '\rundll32.exe' registry: targetobject|contains: '\control panel\desktop\scrnsave.exe' details|endswith: '.scr' filter: details|contains: - 'c:\windows\system32\' - 'c:\windows\syswow64\'
<li><a href="#">detection: selection: eventtype: setvalue targetobject: - hklm\software\microsoft\windows\currentversion\explorer\advanced\showsuperhidden - hklm\software\microsoft\windows\currentversion\explorer\advanced\hidden details: 'dword (0x00000000)'
<li><a href="#">detection: selection: eventtype: setvalue targetobject: - hklm\software\microsoft\windows\currentversion\policies\system\localaccounttokenfilterpolicy - hklm\software\microsoft\windows\currentversion\policies\system\enablelinkedconnections - hklm\system\currentcontrolset\control\filesystem\longpathsenabled details: dword (0x00000001)
<li><a href="#">detection: selection: eventtype: setvalue targetobject: 'hkcu\software\classes\folder\shell\open\command\delegateexecute'
<li><a href="#">detection: selection: eventtype: setvalue targetobject: hklm\software\microsoft\windows\currentversion\policies\system\enablelua details: dword (0x00000000)
<li><a href="#">detection: selection: eventtype: setvalue targetobject: 'hklm\software\policies\microsoft\windows\scripteddiagnostics\turnoffcheck' details: 'dword (0x00000001)'
<li><a href="#">detection: selection: eventtype: setvalue targetobject: hklm\system\currentcontrolset\control\terminal server\winstations\rdp-tcp\portnumber filter: details: dword (0x00000d3d)
<li><a href="#">detection: selection: eventtype: setvalue targetobject|contains: - '\software\microsoft\office\outlook\addins\' - '\software\microsoft\office\word\addins\' - '\software\microsoft\office\excel\addins\' - '\software\microsoft\office\powerpoint\addins\' - '\software\microsoft\vsto\security\inclusion\' filter_image: image|endswith: - '\msiexec.exe' - '\regsvr32.exe' # e.g. default evernote installation # triggered by a default office 2019 installation filter_office: image|endswith: - '\winword.exe' - '\integrator.exe' - '\officeclicktorun.exe' filter_avg: image: 'c:\program files\avg\antivirus\regsvr.exe' targetobject|contains: '\microsoft\office\outlook\addins\antivirus.asoutext\'
<li><a href="#">detection: selection: eventtype: setvalue targetobject|contains: - '\software\microsoft\systemcertificates\root\certificates\' - '\software\policies\microsoft\systemcertificates\root\certificates\' - '\software\microsoft\enterprisecertificates\root\certificates\' - '\software\microsoft\systemcertificates\ca\certificates\' - '\software\policies\microsoft\systemcertificates\ca\certificates\' - '\software\microsoft\enterprisecertificates\ca\certificates\' - '\software\microsoft\systemcertificates\authroot\certificates\' - '\software\policies\microsoft\systemcertificates\authroot\certificates\' - '\software\microsoft\enterprisecertificates\authroot\certificates\' targetobject|endswith: '\blob' details: 'binary data'
<li><a href="#">detection: selection: eventtype: setvalue targetobject|contains: - '\software\microsoft\windows\currentversion\run' - '\software\microsoft\windows\currentversion\runonce' details|contains: - 'powershell' - 'frombase64string' - '.downloadfile(' - '.downloadstring(' - ' -w hidden ' - ' -nop ' - ' -encodedcommand '
<li><a href="#">detection: selection: eventtype: setvalue targetobject|contains: - '\software\microsoft\windows\currentversion\run\' - '\software\microsoft\windows\currentversion\runonce\' selection2: - details|contains: - 'c:\windows\temp\' - 'c:\$recycle.bin\' - 'c:\temp\' - 'c:\users\public\' - 'c:\users\default\' - 'c:\users\desktop\' - '\appdata\local\temp\' - details|startswith: - '%public%\' - 'wscript' - 'cscript'
<li><a href="#">detection: selection: eventtype: setvalue targetobject|contains: '\appcompatflags\compatibility assistant\store\'
<li><a href="#">detection: selection: eventtype: setvalue targetobject|contains: '\microsoft\windows defender\features\tamperprotection' details: dword (0x00000000) filter_msmpeng_client: # only disabled temporarily during updates image|startswith: 'c:\programdata\microsoft\windows defender\platform\' image|endswith: '\msmpeng.exe' filter_msmpeng_domain_controller: # only disabled temporarily during updates image: 'c:\program files\windows defender\msmpeng.exe'
<li><a href="#">detection: selection: eventtype: setvalue targetobject|contains: '\microsoft\windows\currentversion\winevt\channels\microsoft-windows-windows defender/operational\enabled' details: 'dword (0x00000000)'
<li><a href="#">detection: selection: eventtype: setvalue targetobject|contains: '\policies\microsoft\windows defender\puaprotection' details: 'dword (0x00000000)'
<li><a href="#">detection: selection: eventtype: setvalue targetobject|contains: '\root\inventoryapplicationfile\winsat.exe|' targetobject|endswith: '\lowercaselongpath' details|startswith: 'c:\users\' details|endswith: '\appdata\local\temp\system32\winsat.exe'
<li><a href="#">detection: selection: eventtype: setvalue targetobject|contains: '\services\' targetobject|endswith: '\imagepath' details|contains: - 'powershell' - 'pwsh'
<li><a href="#">detection: selection: eventtype: setvalue targetobject|contains: '\software\microsoft\office\' targetobject|endswith: - vbawarnings - disableinternetfilesinpv - disableunsafelocationsinpv - disableattachementsinpv details: 'dword (0x00000001)'
<li><a href="#">detection: selection: eventtype: setvalue targetobject|contains: '\software\microsoft\onedrive\updateofficeconfig\updateringsettingurlfromoc'
<li><a href="#">detection: selection: eventtype: setvalue targetobject|contains: 'hklm\software\microsoft\windows nt\currentversion\appcompatflags\telemetrycontroller\' details|endswith: - .sh - .exe - .dll - .bin - .bat - .cmd - .js - .ps - .vb - .jar - .hta - .msi - .vbs
<li><a href="#">detection: selection: eventtype: setvalue targetobject|contains: 'hklm\software\policies\microsoft\windows defender security center\app and browser protection\disallowexploitprotectionoverride' details: 'dword (00000001)'
<li><a href="#">detection: selection: eventtype: setvalue targetobject|contains: 'microsoft\windows nt\currentversion\silentprocessexit' details|contains: 'monitorprocess'
<li><a href="#">detection: selection: eventtype: setvalue targetobject|contains: 'software\microsoft\windows nt\currentversion\schedule\taskcache\' filter: targetobject|contains: - 'microsoft\windows\updateorchestrator' - 'microsoft\windows\softwareprotectionplatform\svcrestarttask\index' - 'microsoft\windows\flighting\onesettings\refreshcache\index' filter_tiworker: image|startswith: 'c:\windows\' image|endswith: '\tiworker.exe' targetobject|contains: '\microsoft\windows nt\currentversion\schedule\taskcache\plain\{1a552422-f571-4376-a7f1-5941e63d7b40}' filter_svchost: image: 'c:\windows\system32\svchost.exe'
<li><a href="#">detection: selection: eventtype: setvalue targetobject|contains: 'software\microsoft\windows\currentversion' details|contains: - 'vbscript' - 'jscript' - 'mshtml' - 'runhtmlapplication' - 'execute(' - 'createobject' - 'regread' - 'window.close' filter: targetobject|contains: 'software\microsoft\windows\currentversion\run' filter_dotnet: image|endswith: '\msiexec.exe' targetobject|contains: '\software\microsoft\windows\currentversion\installer\userdata\' details|contains: - '\microsoft.net\primary interop assemblies\microsoft.mshtml.dll' - '<\microsoft.mshtml,fileversion=' - 'fl_microsoft_mshtml_dll_____x86.' - 'microsoft_mshtml_dll_1_____x86.' - '<\microsoft.mshtml,culture='
<li><a href="#">detection: selection: eventtype: setvalue targetobject|contains|all: - '\control\print\environments\windows x64\drivers' - '\manufacturer' details: '(empty)' filter_cutepdf: targetobject|contains: '\cutepdf writer v4.0\'
<li><a href="#">detection: selection: eventtype: setvalue targetobject|contains|all: - '\software\microsoft\windows nt\currentversion\appcompatflags\telemetrycontroller\' - '\command' details|contains: '.exe' filter: details|contains: - '\system32\compattelrunner.exe' - '\system32\devicecensus.exe'
<li><a href="#">detection: selection: eventtype: setvalue targetobject|endswith: - '\cor_enable_profiling' - '\cor_profiler'
<li><a href="#">detection: selection: eventtype: setvalue targetobject|endswith: - '\currentcontrolset\control\terminal server\winstations\rdp-tcp\userauthentication' - '\currentcontrolset\control\terminal server\fdenytsconnections' details: 'dword (0x00000000)'
<li><a href="#">detection: selection: eventtype: setvalue targetobject|endswith: - '\security\trusted documents\trustrecords' - '\security\accessvbom' - '\security\vbawarnings'
<li><a href="#">detection: selection: eventtype: setvalue targetobject|endswith: - '\services\dhcpserver\parameters\calloutdlls' - '\services\dhcpserver\parameters\calloutenabled'
<li><a href="#">detection: selection: eventtype: setvalue targetobject|endswith: - software\policies\microsoft\windows\powershell\modulelogging\enablemodulelogging - software\policies\microsoft\windows\powershell\scriptblocklogging\enablescriptblocklogging - software\policies\microsoft\windows\powershell\transcription\enabletranscripting - software\policies\microsoft\windows\powershell\enablescripts details: 'dword (0x00000000)'
<li><a href="#">detection: selection: eventtype: setvalue targetobject|endswith: '\currentcontrolset\services\wercplsupport\parameters\servicedll'
<li><a href="#">detection: selection: eventtype: setvalue targetobject|endswith: '\microsoft\windows\currentversion\policies\explorer\run' selection2: - details|startswith: - 'c:\windows\temp\' - 'c:\programdata\' - 'c:\$recycle.bin\' - 'c:\temp\' - 'c:\users\public\' - 'c:\users\default\' - details|contains: - '\appdata\'
<li><a href="#">detection: selection: eventtype: setvalue targetobject|endswith: \open\command\delegateexecute details: (empty)
<li><a href="#">detection: selection: eventtype: setvalue targetobject|endswith: '\software\microsoft\wab\dllpath' filter: details: '%commonprogramfiles%\system\wab32.dll'
<li><a href="#">detection: selection: eventtype: setvalue targetobject|endswith: '\software\microsoft\windows nt\currentversion\appcompatflags\compatibility assistant\store\c:\program files\windows media player\osk.exe' details: 'binary data'
<li><a href="#">detection: selection: eventtype: setvalue targetobject|endswith: '_classes\mscfile\shell\open\command\(default)' filter: details: '%systemroot%\system32\mmc.exe "%1" %*'
<li><a href="#">detection: selection: eventtype: setvalue targetobject|endswith: 'software\microsoft\.netframework\etwenabled' details: 'dword (0x00000000)'
<li><a href="#">detection: selection: eventtype: setvalue targetobject|endswith: 'wdigest\uselogoncredential' details: dword (0x00000001)
<li><a href="#">detection: selection: eventtype: setvalue targetobject|startswith: - 'hklm\software\policies\microsoft\windows nt\systemrestore' - 'hklm\software\microsoft\windows nt\currentversion\systemrestore' targetobject|endswith: - disableconfig - disablesr details: 'dword (0x00000001)'
<li><a href="#">detection: selection: eventtype: setvalue targetobject|startswith: - 'hklm\system\currentcontrolset\control\safeboot\minimal\' - 'hklm\system\currentcontrolset\control\safeboot\network\' targetobject|endswith: '\(default)' details: service filter_sophos: image: 'c:\windows\system32\msiexec.exe' targetobject: - 'hklm\system\currentcontrolset\control\safeboot\minimal\savservice\(default)' - 'hklm\system\currentcontrolset\control\safeboot\network\savservice\(default)'
<li><a href="#">detection: selection: eventtype: setvalue targetobject|startswith: 'hkcr\ms-msdt\'
<li><a href="#">detection: selection: eventtype: setvalue targetobject|startswith: 'hklm\software\microsoft\windows nt\currentversion\ports' details|contains: - '.dll' - '.exe' - '.bat' - '.com' - 'c:'
<li><a href="#">detection: selection: eventtype: setvalue targetobject|startswith: hklm\software\microsoft\windows\currentversion\run details|startswith: '%appdata%\roaming\oracle\bin\'
<li><a href="#">detection: selection: eventtype: setvalue targetobject|startswith: hklm\software\microsoft\windows\currentversion\winevt\channels\ targetobject|endswith: \enabled details: dword (0x00000000) filter: image|endswith: '\windows\system32\wevtutil.exe' #fp generated during installation of manifests via wevtutil
<li><a href="#">detection: selection: eventtype: setvalue targetobject|startswith: 'hklm\system\currentcontrolset\services\' targetobject|endswith: '\parameters\servicedll' filter_printextensionmanger: details: 'c:\windows\system32\spool\drivers\x64\3\printconfig.dll' filter_domain_controller: image: 'c:\windows\system32\lsass.exe' targetobject|endswith: '\currentcontrolset\services\ntds\parameters\servicedll' details: '%%systemroot%%\system32\ntdsa.dll'
<li><a href="#">detection: selection: eventtype: setvalue targetobject|startswith: hklm\system\currentcontrolset\services\lanmanserver\parameters\ targetobject|endswith: - autosharewks - autoshareserver details: dword (0x00000000)
<li><a href="#">detection: selection: eventtype: setvalue targetobject|startswith: 'hklm\system\currentcontrolset\services\w32time\timeproviders' targetobject|endswith: 'dllname' filter: details: 'c:\windows\system32\w32time.dll'
<li><a href="#">detection: selection: eventtype: system.api_token.create
<li><a href="#">detection: selection: eventtype: system.api_token.revoke
<li><a href="#">detection: selection: filename|contains: 'c:\windows\system32\spool\drivers\x64\' keywords: - 'file submitted to symantec' # symantec fp, pending analysis, more generic
<li><a href="#">detection: selection: gcp.audit.method_name: - cloudsql.instances.create - cloudsql.instances.delete - cloudsql.users.update - cloudsql.users.delete
<li><a href="#">detection: selection: gcp.audit.method_name: - compute.vpntunnels.insert - compute.vpntunnels.delete
<li><a href="#">detection: selection: gcp.audit.method_name: - dns.managedzones.delete - dns.managedzones.update - dns.managedzones.patch
<li><a href="#">detection: selection: gcp.audit.method_name: - io.k8s.api.batch.v*.job - io.k8s.api.batch.v*.cronjob
<li><a href="#">detection: selection: gcp.audit.method_name: - io.k8s.authorization.rbac.v*.clusterrolebindings.create - io.k8s.authorization.rbac.v*.rolebindings.create - io.k8s.authorization.rbac.v*.clusterrolebindings.patch - io.k8s.authorization.rbac.v*.rolebindings.patch - io.k8s.authorization.rbac.v*.clusterrolebindings.update - io.k8s.authorization.rbac.v*.rolebindings.update - io.k8s.authorization.rbac.v*.clusterrolebindings.delete - io.k8s.authorization.rbac.v*.rolebindings.delete
<li><a href="#">detection: selection: gcp.audit.method_name: - io.k8s.core.v*.secrets.create - io.k8s.core.v*.secrets.update - io.k8s.core.v*.secrets.patch - io.k8s.core.v*.secrets.delete
<li><a href="#">detection: selection: gcp.audit.method_name: - storage.buckets.delete - storage.buckets.insert - storage.buckets.update - storage.buckets.patch
<li><a href="#">detection: selection: gcp.audit.method_name: - storage.buckets.list - storage.buckets.listchannels
<li><a href="#">detection: selection: gcp.audit.method_name: - v*.compute.firewalls.delete - v*.compute.firewalls.patch - v*.compute.firewalls.update - v*.compute.firewalls.insert
<li><a href="#">detection: selection: gcp.audit.method_name: - v*.compute.packetmirrorings.get - v*.compute.packetmirrorings.delete - v*.compute.packetmirrorings.insert - v*.compute.packetmirrorings.patch - v*.compute.packetmirrorings.list - v*.compute.packetmirrorings.aggregatedlist
<li><a href="#">detection: selection: gcp.audit.method_name: projects.content.reidentify
<li><a href="#">detection: selection: gcp.audit.method_name|endswith: - .serviceaccounts.disable - .serviceaccounts.delete
<li><a href="#">detection: selection: gcp.audit.method_name|endswith: - .serviceaccounts.patch - .serviceaccounts.create - .serviceaccounts.update - .serviceaccounts.enable - .serviceaccounts.undelete
<li><a href="#">detection: selection: grantedaccess: - '0x147a' - '0x1f3fff' calltrace|contains: 'unknown'
<li><a href="#">detection: selection: hashes|contains: '09d278f9de118ef09163c6140255c690'
<li><a href="#">detection: selection: hashes|contains: '6834b1b94e49701d77ccb3c0895e1afd' filter: image|endswith: '\dctask64.exe'
<li><a href="#">detection: selection: hashes|contains: 'imphash=' filter: hashes|contains: 'imphash=00000000000000000000000000000000'
<li><a href="#">detection: selection: host.scan.vuln: - 10693 - 11507 - 11633 - 11804 - 11821 - 11847 - 11867 - 11931 - 11935 - 11950 - 12541 - 12558 - 12559 - 12560 - 12562 - 12563 - 12565 - 12587 - 12590 - 12599 - 12702 - 12705 - 12706 - 12907 - 12928 - 12929 - 13053 - 13178 - 13200 - 13218 - 13241 - 13253 - 13274 - 13296 - 13301 - 13327 - 13373 - 13374 - 13409 - 13530 - 13532 - 20065 - 20073 - 20081 - 27202 - 27358 - 38702 - 38719 - 42045 - 42417 - 43029 - 43220 - 43221 - 43222 - 43223 - 43225 - 43246 - 43431 - 43484 - 86857 - 87098 - 87106
<li><a href="#">detection: selection: hostapplication: '*' filter: - hostapplication|startswith: 'c:\windows\system32\windowspowershell\v1.0\powershell.exe' - contextinfo|contains: 'citrix\configsync\configsync.ps1'
<li><a href="#">detection: selection: hostapplication|contains: - 'powercat ' - 'powercat.ps1'
<li><a href="#">detection: selection: hostapplication|contains: get-nettcpconnection
<li><a href="#">detection: selection: hostapplication|contains|all: - 'compress-archive ' - ' -path ' - ' -destinationpath ' - '$env:temp\'
<li><a href="#">detection: selection: hostname: 'consolehost' filter: hostapplication|contains: - 'bxor' - 'join' - 'char'
<li><a href="#">detection: selection: hostname: consolehost filter: hostapplication|startswith: - powershell.exe - c:\windows\system32\windowspowershell\v1.0\powershell.exe
<li><a href="#">detection: selection: hostname: 'serverremotehost' hostapplication|contains: 'wsmprovhost.exe'
<li><a href="#">detection: selection: id.orig_h|startswith: - '192.168.' - '10.' - '172.16.' - '172.17.' - '172.18.' - '172.19.' - '172.20.' - '172.21.' - '172.22.' - '172.23.' - '172.24.' - '172.25.' - '172.26.' - '172.27.' - '172.28.' - '172.29.' - '172.30.' - '172.31.' - 'fd' - '2620:83:800f' #approved_rdp: #dst_ip: #- x.x.x.x
<li><a href="#">detection: selection: image: - '/usr/bin/who' - '/usr/bin/w' - '/usr/bin/last' - '/usr/sbin/lsof' - '/usr/sbin/netstat'
<li><a href="#">detection: selection: image: '*\powershell.exe' commandline: '*add-pssnapin microsoft.exchange.powershell.snapin*'
<li><a href="#">detection: selection: image: '/usr/bin/base64' commandline|contains: '-d'
<li><a href="#">detection: selection: image: '/usr/sbin/screencapture'
<li><a href="#">detection: selection: image: 'c:\program files\internet explorer\ieinstal.exe' targetfilename|startswith: 'c:\users\' targetfilename|contains: '\appdata\local\temp\' targetfilename|endswith: 'consent.exe'
<li><a href="#">detection: selection: image: c:\windows\adfs\version.dll
<li><a href="#">detection: selection: image: 'c:\windows\system32\wbem\scrcons.exe'
<li><a href="#">detection: selection: image: c:\windows\system32\wbem\scrcons.exe parentimage: c:\windows\system32\svchost.exe
<li><a href="#">detection: selection: image: 'c:\windows\system32\wbem\wmiprvse.exe' imageloaded|endswith: '\wbemcons.dll'
<li><a href="#">detection: selection: image: c:\windows\system32\werfault.exe targetfilename|contains: - '\lsass' - 'lsass.exe'
<li><a href="#">detection: selection: image: hxtsr.exe filter: currentdirectory|startswith: 'c:\program files\windowsapps\microsoft.windowscommunicationsapps_' currentdirectory|endswith: '\hxtsr.exe'
<li><a href="#">detection: selection: image: system targetfilename|endswith: '\wbem\wbemcomn.dll'
<li><a href="#">detection: selection: image|contains: - '\desktop\' - '\temp\' - '\temporary internet' filter_parent: - parentimage: - 'c:\windows\system32\cleanmgr.exe' - 'c:\program files (x86)\microsoft visual studio\installer\resources\app\servicehub\services\microsoft.visualstudio.setup.service\backgrounddownload.exe' - 'c:\windows\system32\dxgiadaptercache.exe' - parentimage|startswith: 'c:\program files (x86)\nvidia corporation\' filter_other: image|endswith: 'setup.exe' # the missing \ at the beginning is intended - to cover e.g. mysoftwaresetup.exe as well
<li><a href="#">detection: selection: image|contains: - '\downloads\' - '\temporary internet files\content.outlook\' - '\local settings\temporary internet files\' targetobject|contains: '\software\microsoft\windows\currentversion\run\'
<li><a href="#">detection: selection: image|contains: - '\users\public\' - '\$recycle.bin' - '\users\all users\' - '\users\default\' - '\users\contacts\' - '\users\searches\' - 'c:\perflogs\' - '\config\systemprofile\' - '\windows\fonts\' - '\windows\ime\' - '\windows\addins\' parentimage|endswith: - '\services.exe' - '\svchost.exe'
<li><a href="#">detection: selection: image|contains: - '\wwwroot\' - '\wmpub\' - '\htdocs\' filter: image|contains: - 'bin\' - '\tools\' - '\smscomponent\' parentimage|endswith: '\services.exe'
<li><a href="#">detection: selection: image|contains: - rundll32.exe - cmd.exe commandline|contains: - gthread-3.6.dll - \windows\temp\tmp.bat - sigcmm-2.4.dll
<li><a href="#">detection: selection: image|contains: '\temporary internet files\content.outlook\'
<li><a href="#">detection: selection: image|contains: 'c:\windows \system32\'
<li><a href="#">detection: selection: image|contains: wuauclt
<li><a href="#">detection: selection: image|contains|all: - c:\windows\microsoft.net\framework - aspnet_compiler.exe
<li><a href="#">detection: selection: image|endswith: - '.doc.exe' - '.docx.exe' - '.xls.exe' - '.xlsx.exe' - '.ppt.exe' - '.pptx.exe' - '.rtf.exe' - '.pdf.exe' - '.txt.exe' - ' .exe' - '______.exe'
<li><a href="#">detection: selection: image|endswith: - '/at' - '/atd'
<li><a href="#">detection: selection: image|endswith: - '/cat' - 'grep' commandline|contains: ' /etc/sudoers'
<li><a href="#">detection: selection: image|endswith: - '/ps' - '/top'
<li><a href="#">detection: selection: image|endswith: - '/rm' # covers /rmdir as well - '/shred'
<li><a href="#">detection: selection: image|endswith: - '/rm' # covers /rmdir as well - '/shred' commandline|contains: - '/var/log' - '/var/spool/mail'
<li><a href="#">detection: selection: image|endswith: - '/shutdown' - '/reboot' - '/halt'
<li><a href="#">detection: selection: image|endswith: - '/tcpdump' - '/tshark'
<li><a href="#">detection: selection: image|endswith: - '/uname' - '/hostname' - '/uptime' - '/lspci' - '/dmidecode' - '/lscpu' - '/lsmod'
<li><a href="#">detection: selection: image|endswith: - '/update-ca-certificates' - '/update-ca-trust'
<li><a href="#">detection: selection: image|endswith: - '/who' - '/w' - '/last' - '/lsof' - '/netstat'
<li><a href="#">detection: selection: image|endswith: - '\chrome.exe' - '\firefox.exe' - '\microsoftedge.exe' - '\microsoftedgecp.exe' - '\msedge.exe' - '\iexplorer.exe' - '\brave.exe' - '\opera.exe' targetfilename|contains: '.vhd' #not endswith to get the alternate data stream log too targetfilename: c:\users\frack113\downloads\windows.vhd:zone.identifier
<li><a href="#">detection: selection: image|endswith: - '\msdtc.exe' - '\gpvc.exe' filter: image|startswith: - 'c:\windows\system32\' - 'c:\windows\syswow64\'
<li><a href="#">detection: selection: image|endswith: - '\msedge.exe' - '\chrome.exe' commandline|contains|all: - '--headless' - 'dump-dom' - 'http'
<li><a href="#">detection: selection: image|endswith: - '\net.exe' - '\net1.exe' cmdline: commandline|contains: - ' group' - ' localgroup' - ' user' - ' view' - ' share' - ' accounts' - ' stop ' - ' start'
<li><a href="#">detection: selection: image|endswith: - '\net.exe' - '\net1.exe' commandline|contains: ' start ' # space character after the 'start' keyword indicates that a service name follows, in contrast to `net start` discovery expression
<li><a href="#">detection: selection: image|endswith: - '\net.exe' - '\net1.exe' commandline|contains: 'view' filter: commandline|contains: \\\
<li><a href="#">detection: selection: image|endswith: - '\net.exe' - '\net1.exe' commandline|contains|all: - ' use ' - '\\\*\\*$' # (specs) if some wildcard after a backslash should be searched, the backslash has to be escaped: \\*
<li><a href="#">detection: selection: image|endswith: - '\net.exe' - '\net1.exe' commandline|contains|all: - 'user' - 'add'
<li><a href="#">detection: selection: image|endswith: - '\plink.exe' - '\socat.exe' - '\stunnel.exe' - '\httptunnel.exe'
<li><a href="#">detection: selection: image|endswith: - '\powerpnt.exe' - '\winword.exe' - '\excel.exe' commandline|contains: 'http'
<li><a href="#">detection: selection: image|endswith: - '\powershell.exe' - '\cmd.exe' parentcommandline|contains|all: - 'msiexec.exe' - '-embedding ' filter_splunk_ufw: image|endswith: ':\windows\system32\cmd.exe' commandline|contains: 'c:\program files\splunkuniversalforwarder\bin\'
<li><a href="#">detection: selection: image|endswith: - '\powershell.exe' - '\mshta.exe' - '\wscript.exe' - '\cscript.exe' commandline|contains: - '\windows\temp' - '\temporary internet' - '\appdata\local\temp' - '\appdata\roaming\temp' - '%temp%' - '%tmp%' - '%localappdata%\temp' filter: commandline|contains: - ' >' - 'out-file' - 'convertto-json' - '-windowstyle hidden -verb runas' # vscode behaviour if file cannot be written as current user
<li><a href="#">detection: selection: image|endswith: - '\powershell.exe' - '\powershell_ise.exe' - '\pwsh.exe' commandline|contains: - 'get-bitstransfer' - 'add-bitsfile'
<li><a href="#">detection: selection: image|endswith: - '\powershell.exe' - '\wmic.exe' - '\vssadmin.exe' commandline|contains|all: - shadow - create
<li><a href="#">detection: selection: image|endswith: - \pypykatz.exe - \python.exe commandline|contains|all: - live - registry
<li><a href="#">detection: selection: image|endswith: - '\svchost.exe' - '\rundll32.exe' - '\services.exe' - '\powershell.exe' - '\powershell_ise.exe' - '\regsvr32.exe' - '\spoolsv.exe' - '\lsass.exe' - '\smss.exe' - '\csrss.exe' - '\conhost.exe' - '\wininit.exe' - '\lsm.exe' - '\winlogon.exe' - '\explorer.exe' - '\taskhost.exe' - '\taskmgr.exe' - '\sihost.exe' - '\runtimebroker.exe' - '\smartscreen.exe' - '\dllhost.exe' - '\audiodg.exe' - '\wlanext.exe' - '\dashost.exe' - '\schtasks.exe' - '\cscript.exe' - '\wscript.exe' - '\wsl.exe' - '\bitsadmin.exe' - '\atbroker.exe' - '\bcdedit.exe' - '\certutil.exe' - '\certreq.exe' - '\cmstp.exe' - '\consent.exe' - '\defrag.exe' - '\dism.exe' - '\dllhst3g.exe' - '\eventvwr.exe' - '\msiexec.exe' - '\runonce.exe' - '\winver.exe' - '\logonui.exe' - '\userinit.exe' - '\dwm.exe' - '\lsaiso.exe' - '\ntoskrnl.exe' filter: - image|startswith: - 'c:\windows\system32\' - 'c:\windows\syswow64\' - 'c:\windows\winsxs\' - 'c:\avast! sandbox' - image|contains: '\systemroot\system32\' - image: 'c:\windows\explorer.exe'
<li><a href="#">detection: selection: image|endswith: - '\svchost.exe' - '\taskhost.exe' - '\lsm.exe' - '\lsass.exe' - '\services.exe' - '\lsaiso.exe' - '\csrss.exe' - '\wininit.exe' - '\winlogon.exe' filter_sys: - parentimage|endswith: - '\savservice.exe' - '\ngen.exe' - parentimage|contains: - '\system32\' - '\syswow64\' filter_msmpeng: parentimage|contains: - '\windows defender\' - '\microsoft security client\' parentimage|endswith: '\msmpeng.exe' filter_null: - parentimage: null - parentimage: '-'
<li><a href="#">detection: selection: image|endswith: - \sysmon64.exe - \sysmon.exe commandline|contains: '-u'
<li><a href="#">detection: selection: image|endswith: - '\takeown.exe' - '\cacls.exe' - '\icacls.exe' commandline|contains: '/grant' selection2: image|endswith: '\attrib.exe' commandline|contains: '-r' filter_reset: commandline|endswith: 'icacls c:\programdata\dynatrace\gateway\config\connectivity.history /reset' filter_grant: commandline|contains|all: - 'icacls c:\programdata\dynatrace\gateway\config\config.properties /grant :r ' - 's-1-5-19:f' filter_programs: commandline|contains: '\appdata\local\programs\microsoft vs code'
<li><a href="#">detection: selection: image|endswith: - '\tor.exe' - '\tor browser\browser\firefox.exe'
<li><a href="#">detection: selection: image|endswith: - '\winword.exe' - '\powerpnt.exe' - '\excel.exe' - '\outlook.exe' imageloaded|contains: '\clr.dll'
<li><a href="#">detection: selection: image|endswith: - '\winword.exe' - '\powerpnt.exe' - '\excel.exe' - '\outlook.exe' imageloaded|contains: '\dsparse.dll'
<li><a href="#">detection: selection: image|endswith: - '\winword.exe' - '\powerpnt.exe' - '\excel.exe' - '\outlook.exe' imageloaded|endswith: - '\vbe7.dll' - '\vbeui.dll' - '\vbe7intl.dll'
<li><a href="#">detection: selection: image|endswith: - '\winword.exe' - '\powerpnt.exe' - '\excel.exe' - '\outlook.exe' imageloaded|endswith: '\kerberos.dll'
<li><a href="#">detection: selection: image|endswith: - '\winword.exe' - '\powerpnt.exe' - '\excel.exe' - '\outlook.exe' imageloaded|startswith: 'c:\windows\assembly\'
<li><a href="#">detection: selection: image|endswith: - '\winword.exe' - '\powerpnt.exe' - '\excel.exe' - '\outlook.exe' imageloaded|startswith: 'c:\windows\microsoft.net\assembly\gac_msil'
<li><a href="#">detection: selection: image|endswith: - '\wscript.exe' - '\cscript.exe' - '\mshta.exe' imageloaded|endswith: - '\clr.dll' - '\mscoree.dll' - '\mscorlib.dll'
<li><a href="#">detection: selection: image|endswith: - '\wscript.exe' - '\cscript.exe' commandline|contains: - '.jse' - '.vbe' - '.js' - '.vba'
<li><a href="#">detection: selection: image|endswith: - '\wscript.exe' - '\cscript.exe' targetfilename|startswith: - 'c:\users\' - 'c:\programdata' targetfilename|endswith: - '.jse' - '.vbe' - '.js' - '.vba' - '.vbs'
<li><a href="#">detection: selection: image|endswith: '.exe' targetfilename|endswith: '.exe' filter_whitelist: image: - 'c:\windows\system32\msiexec.exe' - 'c:\windows\system32\cleanmgr.exe' - 'c:\windows\explorer.exe' - 'c:\windows\system32\dxgiadaptercache.exe' - 'c:\windows\system32\dism.exe' filter_update: image: 'c:\windows\system32\svchost.exe' targetfilename|startswith: 'c:\windows\softwaredistribution\download\install\' # security_userid: s-1-5-18 filter_tiworker: image|startswith: 'c:\windows\winsxs\' image|endswith: '\tiworker.exe' filter_programfiles: - image|startswith: - 'c:\program files\' - 'c:\program files (x86)\' - targetfilename|startswith: - 'c:\program files\' - 'c:\program files (x86)\' filter_defender: image|startswith: 'c:\programdata\microsoft\windows defender\' filter_windows_apps: targetfilename|contains: '\microsoft\windowsapps\'
<li><a href="#">detection: selection: image|endswith: '/base64' commandline|contains: '-d'
<li><a href="#">detection: selection: image|endswith: '/bin/bash' filter: destinationip: - '127.0.0.1' - '0.0.0.0'
<li><a href="#">detection: selection: image|endswith: '/cat' selection_history: - commandline|contains: - '/.bash_history' - '/.zsh_history' - commandline|endswith: '_history'
<li><a href="#">detection: selection: image|endswith: '/chmod' commandline|contains: - '/tmp/' - '/.library/' - '/etc/' - '/opt/'
<li><a href="#">detection: selection: image|endswith: '/crontab' commandline|contains: '/tmp/'
<li><a href="#">detection: selection: image|endswith: '/doas'
<li><a href="#">detection: selection: image|endswith: '/dscl' commandline|contains: 'create'
<li><a href="#">detection: selection: image|endswith: '/nohup'
<li><a href="#">detection: selection: image|endswith: '/osascript' commandline|contains: '-e'
<li><a href="#">detection: selection: image|endswith: '/rm' selection_history: - commandline|contains: - '/.bash_history' - '/.zsh_history' - commandline|endswith: '_history'
<li><a href="#">detection: selection: image|endswith: '/split'
<li><a href="#">detection: selection: image|endswith: '/xattr' commandline|contains|all: - '-r' - 'com.apple.quarantine'
<li><a href="#">detection: selection: image|endswith: '\adfind.exe' test_5: #listing password policy commandline|contains: - lockoutduration - lockoutthreshold - lockoutobservationwindow - maxpwdage - minpwdage - minpwdlength - pwdhistorylength - pwdproperties test_6: #enumerate active directory admins commandline|contains: '-sc admincountdmp' test_8: #enumerate active directory exchange ad objects commandline|contains: '-sc exchaddresses'
<li><a href="#">detection: selection: image|endswith: '\adobe creative cloud experience\libs\node.exe' filter: commandline|contains: 'adobe creative cloud experience\js' # folder where creative cloud's js resources are located
<li><a href="#">detection: selection: image|endswith: '\appcmd.exe' commandline|contains|all: - 'install' - 'module' - '/name:'
<li><a href="#">detection: selection: image|endswith: \appcmd.exe commandline|contains|all: - set - config - '/section:httplogging' - '/dontlog:true'
<li><a href="#">detection: selection: image|endswith: '\at.exe' commandline|contains: 'interactive'
<li><a href="#">detection: selection: image|endswith: '\attrib.exe' commandline|contains: ' +h ' ini: commandline|contains: '\desktop.ini ' intel: parentimage|endswith: '\cmd.exe' commandline: +r +h +s +a \\*.cui parentcommandline: c:\windows\system32\\*.bat
<li><a href="#">detection: selection: image|endswith: \attrib.exe commandline|contains: ' +s '
<li><a href="#">detection: selection: image|endswith: '\bcdedit.exe' commandline|contains: - 'delete' - 'deletevalue' - 'import' - 'safeboot' - 'network'
<li><a href="#">detection: selection: image|endswith: '\bginfo.exe' commandline|contains|all: - '/popup' - '/nolicprompt'
<li><a href="#">detection: selection: image|endswith: '\bitsadmin.exe' commandline|contains: - ' /transfer ' - ' /create ' - ' /addfile ' selection_domain: commandline|contains: - 'raw.githubusercontent.com' - 'gist.githubusercontent.com' - 'pastebin.com' - 'cdn.discordapp.com/attachments/' - 'mediafire.com' - 'mega.nz' - 'ddns.net' - '.paste.ee' - '.hastebin.com' - '.ghostbin.co/' - 'ufile.io' - 'storage.googleapis.com'
<li><a href="#">detection: selection: image|endswith: '\bitsadmin.exe' commandline|contains: - ' /transfer ' - ' /create ' - ' /addfile ' selection_extension: commandline|contains: - '' - '' - '' - '' - '' - '' - '' - '' - '' - '' - '' - '' - '' - '' - '' - '' - '' - ''
<li><a href="#">detection: selection: image|endswith: '\bitsadmin.exe' commandline|contains: - ' /transfer ' - ' /create ' - ' /addfile ' selection_extension: commandline|contains: - '.asax' - '.ashx' - '.asmx' - '.asp' - '.aspx' - '.bat' - '.cfm' - '.cgi' - '.chm' - '.cmd' - '.gif' - '.jpeg' - '.jpg' - '.jsp' - '.jspx' - '.png' - '.ps1' - '.psm1' - '.scf' - '.sct' - '.txt' - '.vbe' - '.vbs' - '.war' - '.wsf' - '.wsh' - '.zip' - '.rar' - '.dll'
<li><a href="#">detection: selection: image|endswith: '\bitsadmin.exe' commandline|contains: - ' /transfer ' - ' /create ' - ' /addfile ' selection_folder: commandline|contains: - 'c:\users\public\' - '%public%' - '\desktop\'
<li><a href="#">detection: selection: image|endswith: '\bitsadmin.exe' commandline|contains: - ' /transfer ' - ' /create ' - ' /addfile ' selection_folder: commandline|contains: - 'c:\windows\temp\' - '%temp%' - 'c:\programdata\' - '%programdata%' - '\appdata\local\' - '%appdata%'
<li><a href="#">detection: selection: image|endswith: '\certutil.exe' commandline|contains|all: - '-f' - '-encode'
<li><a href="#">detection: selection: image|endswith: '\changepk.exe' parentimage|endswith: '\slui.exe' integritylevel: - 'high' - 'system'
<li><a href="#">detection: selection: image|endswith: '\chcp.com' commandline|endswith: - ' 936' # chinese # - ' 1256' # arabic - ' 1258' # vietnamese # - ' 855' # russian # - ' 866' # russian # - ' 864' # arabic
<li><a href="#">detection: selection: image|endswith: '\chrome.exe' parentimage|endswith: '\powershell.exe' commandline|contains|all: - '--load-extension=' - '\appdata\local\'
<li><a href="#">detection: selection: image|endswith: \cipher.exe commandline|contains: ' /w:'
<li><a href="#">detection: selection: image|endswith: '\cmd.exe' commandline|contains: '>'
<li><a href="#">detection: selection: image|endswith: \cmd.exe commandline|contains: '>*:'
<li><a href="#">detection: selection: image|endswith: '\cmd.exe' commandline|contains|all: - '/q' - '/c' - 'chcp'
<li><a href="#">detection: selection: image|endswith: '\cmd.exe' commandline|contains|all: - 'http' # captures both http and https - '://' - '%appdata%'
<li><a href="#">detection: selection: image|endswith: '\cmd.exe' parentimage|endswith: '\7zfm.exe' filter_bat: commandline|contains: ' /c ' filter_null: commandline: null
<li><a href="#">detection: selection: image|endswith: '\cmd.exe' parentimage|endswith: '\elevation_service.exe' integritylevel: 'system'
<li><a href="#">detection: selection: image|endswith: \cmd.exe targetfilename|contains|all: - \users\ - \desktop\ targetfilename|endswith: .txt
<li><a href="#">detection: selection: image|endswith: '\cmd.exe' targetfilename|endswith: - '.vhd' - '.bac' - '.bak' - '.wbcat' - '.bkf' - '.set' - '.win' - '.dsk'
<li><a href="#">detection: selection: image|endswith: \colorcpl.exe valid_ext: targetfilename|endswith: - .icm - .gmmp - .cdmp - .camp
<li><a href="#">detection: selection: image|endswith: '\control.exe' parentimage|endswith: - '\winword.exe' - '\powerpnt.exe' - '\excel.exe' filter: commandline|endswith: - '\control.exe input.dll' - '\control.exe" input.dll'
<li><a href="#">detection: selection: image|endswith: '\control.exe' parentimage|endswith: '\workfolders.exe' filter: image: 'c:\windows\system32\control.exe'
<li><a href="#">detection: selection: image|endswith: '\crackmapexec.exe'
<li><a href="#">detection: selection: image|endswith: '\csc.exe' commandline|contains: - '\appdata\' - '\windows\temp\' filter: - parentimage|startswith: 'c:\program files' # - parentimage|endswith: - '\sdiagnhost.exe' # - '\w3wp.exe' # - '\choco.exe' # chocolatey - parentcommandline|contains: - '\programdata\microsoft\windows defender advanced threat protection'
<li><a href="#">detection: selection: image|endswith: '\csc.exe' parentimage|endswith: - '\wscript.exe' - '\cscript.exe' - '\mshta.exe'
<li><a href="#">detection: selection: image|endswith: \cscript.exe commandline|contains: '.vbs'
<li><a href="#">detection: selection: image|endswith: '\cscript.exe' commandline|contains|all: - '.vbs' - '/shell'
<li><a href="#">detection: selection: image|endswith: '\csi.exe' parentimage|endswith: '\powershell.exe' originalfilename: 'csi.exe'
<li><a href="#">detection: selection: image|endswith: '\dctask64.exe' filter: commandline|contains: 'desktopcentral_agent\agent'
<li><a href="#">detection: selection: image|endswith: '\devtoolslauncher.exe' commandline|contains: 'launchfordeploy'
<li><a href="#">detection: selection: image|endswith: '\diskshadow.exe' commandline|contains: - '/s' - '-s'
<li><a href="#">detection: selection: image|endswith: '\dism.exe' imageloaded|endswith: '\dismcore.dll' filter: imageloaded: 'c:\windows\system32\dism\dismcore.dll'
<li><a href="#">detection: selection: image|endswith: '\ditsnap.exe' selection2: commandline|contains: 'ditsnap.exe'
<li><a href="#">detection: selection: image|endswith: '\dllhost.exe' initiated: 'true' filter_ipv4: destinationip|startswith: - '10.' - '192.168.' - '172.16.' - '172.17.' - '172.18.' - '172.19.' - '172.20.' - '172.21.' - '172.22.' - '172.23.' - '172.24.' - '172.25.' - '172.26.' - '172.27.' - '172.28.' - '172.29.' - '172.30.' - '172.31.' - '169.254.' # link-local address - '127.' # loopback address filter_ipv6: destinationip|startswith: - '::1' # ipv6 loopback variant - '0:0:0:0:0:0:0:1' # ipv6 loopback variant - 'fe80:' # link-local address - 'fc' # private address range fc00::/7 - 'fd' # private address range fc00::/7
<li><a href="#">detection: selection: image|endswith: '\dllhost.exe' targetfilename|startswith: 'c:\windows\system32\' targetfilename|endswith: '.dll'
<li><a href="#">detection: selection: image|endswith: '\dnscmd.exe' commandline|contains|all: - '/config' - '/serverlevelplugindll'
<li><a href="#">detection: selection: image|endswith: '\dnx.exe'
<li><a href="#">detection: selection: image|endswith: '\dump64.exe' procdump_flags: commandline|contains: - ' -ma ' - 'accpeteula' filter: image|contains: '\installer\feedback\dump64.exe'
<li><a href="#">detection: selection: image|endswith: '\dumpminitool.exe' selection_original_name: originalname: 'dumpminitool.exe' selection_flags: commandline|contains|all: - ' --processid ' - ' --dumptype full'
<li><a href="#">detection: selection: image|endswith: '\dumpstack.log' selection_download: commandline|contains: ' -o dumpstack.log'
<li><a href="#">detection: selection: image|endswith: '\eqnedt32.exe'
<li><a href="#">detection: selection: image|endswith: '\excel.exe' initiated: 'true' destinationisipv6: 'false' filter: destinationip|startswith: - '10.' - '192.168.' - '172.16.' - '172.17.' - '172.18.' - '172.19.' - '172.20.' - '172.21.' - '172.22.' - '172.23.' - '172.24.' - '172.25.' - '172.26.' - '172.27.' - '172.28.' - '172.29.' - '172.30.' - '172.31.' - '127.0.0.1'
<li><a href="#">detection: selection: image|endswith: '\expand.exe' commandline|contains: - '.cab' - '/f:' - '-f:' - 'c:\programdata\' #suspicious paths to curb fps if any - 'c:\public\' - '\appdata\local\temp\' - '\appdata\roaming\temp\'
<li><a href="#">detection: selection: image|endswith: '\explorer.exe' commandline|contains: '/nouaccheck' filter_dc_logon: - parentcommandline: 'c:\windows\system32\svchost.exe -k netsvcs -p -s schedule' - parentimage: 'c:\windows\system32\svchost.exe' # coarse filter needed for id 4688 events
<li><a href="#">detection: selection: image|endswith: \explorer.exe parentimage|endswith: \cmd.exe commandline|contains: explorer.exe
<li><a href="#">detection: selection: image|endswith: \findstr.exe commandline|contains: ' 385201'
<li><a href="#">detection: selection: image|endswith: \findstr.exe commandline|contains|all: - cpassword - \sysvol\ - .xml
<li><a href="#">detection: selection: image|endswith: '\findstr.exe' commandline|endswith: '.lnk'
<li><a href="#">detection: selection: image|endswith: '\finger.exe'
<li><a href="#">detection: selection: image|endswith: '\fltmc.exe' commandline|contains|all: - 'unload' - 'sys'
<li><a href="#">detection: selection: image|endswith: '\format.com' commandline|contains: '/fs:' filter: commandline|contains: - '/fs:fat' - '/fs:exfat' - '/fs:ntfs' - '/fs:udf' - '/fs:refs'
<li><a href="#">detection: selection: image|endswith: '\fsutil.exe' commandline|contains|all: - 'behavior ' - 'set ' - 'symlinkevaluation'
<li><a href="#">detection: selection: image|endswith: '\fxssvc.exe' imageloaded|endswith: ualapi.dll filter: imageloaded|startswith: c:\windows\winsxs\
<li><a href="#">detection: selection: image|endswith: '\gpresult.exe' commandline|contains: - '/z' - '/v'
<li><a href="#">detection: selection: image|endswith: '\gup.exe' filter: image|endswith: - '\users\\*\appdata\local\notepad++\updater\gup.exe' - '\users\\*\appdata\roaming\notepad++\updater\gup.exe' - '\program files\notepad++\updater\gup.exe' - '\program files (x86)\notepad++\updater\gup.exe'
<li><a href="#">detection: selection: image|endswith: '\hh.exe' commandline|contains: '.chm'
<li><a href="#">detection: selection: image|endswith: \hostname.exe
<li><a href="#">detection: selection: image|endswith: \installutil.exe image|contains: microsoft.net\framework commandline|contains|all: - '/logfile= ' - '/logtoconsole=false'
<li><a href="#">detection: selection: image|endswith: '\jsc.exe' commandline|contains: '.js'
<li><a href="#">detection: selection: image|endswith: '\lsass.exe' signed: 'false'
<li><a href="#">detection: selection: image|endswith: '\microsoft.workflow.compiler.exe' selection_t1218: originalfilename: 'microsoft.workflow.compiler.exe' commandline|contains: '.xml'
<li><a href="#">detection: selection: image|endswith: '\msbuild.exe' filter: destinationport: - '80' - '443' initiated: 'true'
<li><a href="#">detection: selection: image|endswith: '\msexchangemailboxreplication.exe' targetfilename|endswith: - '.aspx' - '.asp'
<li><a href="#">detection: selection: image|endswith: '\mshta.exe' commandline|contains: 'javascript'
<li><a href="#">detection: selection: image|endswith: '\msiexec.exe' commandline|contains: ' /y' filter_apple: commandline|contains: - '\msiexec.exe" /y "c:\program files\bonjour\mdnsnsp.dll' - '\msiexec.exe" /y "c:\program files (x86)\bonjour\mdnsnsp.dll' - '\msiexec.exe" /y "c:\program files (x86)\apple software update\scriptingobjectmodel.dll' - '\msiexec.exe" /y "c:\program files (x86)\apple software update\softwareupdateadmin.dll' - '\msiexec.exe" /y "c:\windows\ccm\' - '\msiexec.exe" /y c:\windows\ccm\' #also need non-quoted execution
<li><a href="#">detection: selection: image|endswith: '\msiexec.exe' commandline|contains|all: - ' /i' - ' /q'
<li><a href="#">detection: selection: image|endswith: '\msiexec.exe' commandline|contains|all: - ' /z ' - '.dll'
<li><a href="#">detection: selection: image|endswith: '\msiexec.exe' filter: image|startswith: - 'c:\windows\system32\' - 'c:\windows\syswow64\' - 'c:\windows\winsxs\'
<li><a href="#">detection: selection: image|endswith: '\msiexec.exe' targetfilename|startswith: 'c:\program files (x86)\microsoft\edge\application' targetfilename|endswith: '\elevation_service.exe'
<li><a href="#">detection: selection: image|endswith: '\mstsc.exe' targetfilename|contains: '\microsoft\windows\start menu\programs\startup\'
<li><a href="#">detection: selection: image|endswith: '\netsh.exe' commandline|contains|all: - 'add' - 'helper'
<li><a href="#">detection: selection: image|endswith: '\netsh.exe' commandline|contains|all: - advfirewall - firewall - set - rule - 'group=' - new - 'enable=yes'
<li><a href="#">detection: selection: image|endswith: '\netsh.exe' commandline|contains|all: - 'i' - ' p' - '=3389' - ' c'
<li><a href="#">detection: selection: image|endswith: '\netsh.exe' commandline|contains|all: - 'wlan' - ' s' - ' p' - ' k' - '=clear'
<li><a href="#">detection: selection: image|endswith: '\notepad.exe' filter: destinationport: '9100'
<li><a href="#">detection: selection: image|endswith: '\ntdsutil.exe'
<li><a href="#">detection: selection: image|endswith: '\openwith.exe' commandline|contains: '/c'
<li><a href="#">detection: selection: image|endswith: '\outlook.exe' targetfilename|contains: '\appdata\local\microsoft\forms\'
<li><a href="#">detection: selection: image|endswith: \pcalua.exe commandline|contains: ' -a' # no space after the flag because it accepts anything as long as there a "-a"
<li><a href="#">detection: selection: image|endswith: '\pcwrun.exe' commandline|contains: '../'
<li><a href="#">detection: selection: image|endswith: '\ping.exe' commandline|contains: '0x'
<li><a href="#">detection: selection: image|endswith: \powershell.exe commandline|contains: - ' -e ' - ' -en ' - ' -enc ' - ' -enco' - ' -ec ' filter: commandline|contains: ' -encoding '
<li><a href="#">detection: selection: image|endswith: '\powershell.exe' commandline|contains: - ' -windowstyle h ' - ' -windowstyl h' - ' -windowsty h' - ' -windowst h' - ' -windows h' - ' -windo h' - ' -wind h' - ' -win h' - ' -wi h' - ' -win h ' - ' -win hi ' - ' -win hid ' - ' -win hidd ' - ' -win hidde ' - ' -nopr ' - ' -nopro ' - ' -noprof ' - ' -noprofi ' - ' -noprofil ' - ' -nonin ' - ' -nonint ' - ' -noninte ' - ' -noninter ' - ' -nonintera ' - ' -noninterac ' - ' -noninteract ' - ' -noninteracti ' - ' -noninteractiv ' - ' -ec ' - ' -encodedcomman ' - ' -encodedcomma ' - ' -encodedcomm ' - ' -encodedcom ' - ' -encodedco ' - ' -encodedc ' - ' -encoded ' - ' -encode ' - ' -encod ' - ' -enco ' - ' -en ' - ' -executionpolic ' - ' -executionpoli ' - ' -executionpol ' - ' -executionpo ' - ' -executionp ' - ' -execution bypass' - ' -executio bypass' - ' -executi bypass' - ' -execut bypass' - ' -execu bypass' - ' -exec bypass' - ' -exe bypass' - ' -ex bypass' - ' -ep bypass' - ' /windowstyle h ' - ' /windowstyl h' - ' /windowsty h' - ' /windowst h' - ' /windows h' - ' /windo h' - ' /wind h' - ' /win h' - ' /wi h' - ' /win h ' - ' /win hi ' - ' /win hid ' - ' /win hidd ' - ' /win hidde ' - ' /nopr ' - ' /nopro ' - ' /noprof ' - ' /noprofi ' - ' /noprofil ' - ' /nonin ' - ' /nonint ' - ' /noninte ' - ' /noninter ' - ' /nonintera ' - ' /noninterac ' - ' /noninteract ' - ' /noninteracti ' - ' /noninteractiv ' - ' /ec ' - ' /encodedcomman ' - ' /encodedcomma ' - ' /encodedcomm ' - ' /encodedcom ' - ' /encodedco ' - ' /encodedc ' - ' /encoded ' - ' /encode ' - ' /encod ' - ' /enco ' - ' /en ' - ' /executionpolic ' - ' /executionpoli ' - ' /executionpol ' - ' /executionpo ' - ' /executionp ' - ' /execution bypass' - ' /executio bypass' - ' /executi bypass' - ' /execut bypass' - ' /execu bypass' - ' /exec bypass' - ' /exe bypass' - ' /ex bypass' - ' /ep bypass'
<li><a href="#">detection: selection: image|endswith: '\powershell.exe' commandline|contains: - '-disablebehaviormonitoring $true' - '-disableruntimemonitoring $true' selection_tamper_cmd_stop: commandline|contains|all: - sc - stop - windefend selection_tamper_cmd_disabled: commandline|contains|all: - sc - config - windefend - 'start=disabled'
<li><a href="#">detection: selection: image|endswith: '\powershell.exe' commandline|contains: - '-f c:\users\public' - '-f "c:\users\public' - '-f %public%'
<li><a href="#">detection: selection: image|endswith: '\powershell.exe' commandline|contains: - 'hctac' - 'kearb' - 'dnammoc' - 'ekovn' - 'elifd' - 'rahc' - 'etirw' - 'golon' - 'tninon' - 'eddih' - 'tpircs' - 'ssecorp' - 'llehsrewop' - 'esnopser' - 'daolnwod' - 'tneilcbew' - 'tneilc' - 'ptth' - 'elifotevas' - '46esab' - 'htappmetteg' - 'tcejbo' - 'maerts' - 'hcaerof' - 'ekovni' - 'retupmoc' filter_1: commandline|contains: '-encodedcommand'
<li><a href="#">detection: selection: image|endswith: '\powershell.exe' commandline|contains: 'new-object system.net.sockets.tcpclient'
<li><a href="#">detection: selection: image|endswith: '\powershell.exe' commandline|contains: 'start-bitstransfer'
<li><a href="#">detection: selection: image|endswith: '\powershell.exe' commandline|contains|all: - 'new-object' - 'net.webclient).' - 'download' commandline|contains: - 'string(' - 'file('
<li><a href="#">detection: selection: image|endswith: '\powershell.exe' encoded: commandline|contains: - 'tgblafqalgb3aeuaqg' - '4azqbuac4adwbfaeia' - 'oaguavaauahcarqbca' - 'bgbfahqalgb3aguayg' - '4arqb0ac4adwblagia' - 'uaeuadaauahcazqbia' - 'tgbfahqalgb3aguayg' - 'oaeuadaauahcazqbia' - 'bgblafqalgb3aguayg' - '4azqbuac4adwblagia' - 'uaguavaauahcazqbia' - 'tgblafqalgb3aguayg' - 'oaguavaauahcazqbia' - 'bgbfafqalgb3aguayg' - '4arqbuac4adwblagia' - 'uaeuavaauahcazqbia' - 'bgblahqalgbxaguayg' - '4azqb0ac4avwblagia' - 'uaguadaauafcazqbia' - 'bgbfahqalgbxaguayg' - '4arqb0ac4avwblagia' - 'uaeuadaauafcazqbia' - 'tgbfahqalgbxaguayg' - 'oaeuadaauafcazqbia' - 'bgblafqalgbxaguayg' - '4azqbuac4avwblagia' - 'uaguavaauafcazqbia' - 'tgblafqalgbxaguayg' - 'oaguavaauafcazqbia' - 'bgbfafqalgbxaguayg' - '4arqbuac4avwblagia' - 'uaeuavaauafcazqbia' - 'bgblahqalgb3aeuayg' - '4azqb0ac4adwbfagia' - 'uaguadaauahcarqbia' - 'tgblahqalgb3aeuayg' - 'oaguadaauahcarqbia' - 'bgbfahqalgb3aeuayg' - '4arqb0ac4adwbfagia' - 'uaeuadaauahcarqbia' - 'tgbfahqalgb3aeuayg' - 'oaeuadaauahcarqbia' - 'bgblafqalgb3aeuayg' - '4azqbuac4adwbfagia' - 'uaguavaauahcarqbia' - 'tgblafqalgb3aeuayg' - 'oaguavaauahcarqbia' - 'bgbfafqalgb3aeuayg' - '4arqbuac4adwbfagia' - 'uaeuavaauahcarqbia' - 'tgbfafqalgb3aeuayg' - 'oaeuavaauahcarqbia' - 'bgblahqalgbxaeuayg' - '4azqb0ac4avwbfagia' - 'uaguadaauafcarqbia' - 'tgblahqalgbxaeuayg' - 'oaguadaauafcarqbia' - 'bgbfahqalgbxaeuayg' - '4arqb0ac4avwbfagia' - 'uaeuadaauafcarqbia' - 'tgbfahqalgbxaeuayg' - 'oaeuadaauafcarqbia' - 'bgblafqalgbxaeuayg' - '4azqbuac4avwbfagia' - 'uaguavaauafcarqbia' - 'tgblafqalgbxaeuayg' - 'oaguavaauafcarqbia' - 'bgbfafqalgbxaeuayg' - '4arqbuac4avwbfagia' - 'uaeuavaauafcarqbia' - 'tgbfafqalgbxaeuayg' - 'oaeuavaauafcarqbia' - 'bgblahqalgb3aguaqg' - '4azqb0ac4adwblaeia' - 'uaguadaauahcazqbca' - 'tgblahqalgb3aguaqg' - 'oaguadaauahcazqbca' - 'bgbfahqalgb3aguaqg' - '4arqb0ac4adwblaeia' - 'uaeuadaauahcazqbca' - 'tgbfahqalgb3aguaqg' - 'oaeuadaauahcazqbca' - 'bgblafqalgb3aguaqg' - '4azqbuac4adwblaeia' - 'uaguavaauahcazqbca' - 'tgblafqalgb3aguaqg' - 'oaguavaauahcazqbca' - 'bgbfafqalgb3aguaqg' - '4arqbuac4adwblaeia' - 'uaeuavaauahcazqbca' - 'tgbfafqalgb3aguaqg' - 'oaeuavaauahcazqbca' - 'bgblahqalgbxaguaqg' - '4azqb0ac4avwblaeia' - 'uaguadaauafcazqbca' - 'tgblahqalgbxaguaqg' - 'oaguadaauafcazqbca' - 'bgbfahqalgbxaguaqg' - '4arqb0ac4avwblaeia' - 'uaeuadaauafcazqbca' - 'tgbfahqalgbxaguaqg' - 'oaeuadaauafcazqbca' - 'bgblafqalgbxaguaqg' - '4azqbuac4avwblaeia' - 'uaguavaauafcazqbca' - 'tgblafqalgbxaguaqg' - 'oaguavaauafcazqbca' - 'bgbfafqalgbxaguaqg' - '4arqbuac4avwblaeia' - 'uaeuavaauafcazqbca' - 'tgbfafqalgbxaguaqg' - 'oaeuavaauafcazqbca' - 'bgblahqalgb3aeuaqg' - '4azqb0ac4adwbfaeia' - 'uaguadaauahcarqbca' - 'tgblahqalgb3aeuaqg' - 'oaguadaauahcarqbca' - 'bgbfahqalgb3aeuaqg' - '4arqb0ac4adwbfaeia' - 'uaeuadaauahcarqbca' - 'tgbfahqalgb3aeuaqg' - 'oaeuadaauahcarqbca' - 'bgblafqalgb3aeuaqg' - 'uaguavaauahcarqbca' - 'bgbfafqalgb3aeuaqg' - '4arqbuac4adwbfaeia' - 'uaeuavaauahcarqbca' - 'tgbfafqalgb3aeuaqg' - 'oaeuavaauahcarqbca' - 'tgblahqalgbxaeuaqg' - '4azqb0ac4avwbfaeia' - 'oaguadaauafcarqbca' - 'bgbfahqalgbxaeuaqg' - '4arqb0ac4avwbfaeia' - 'uaeuadaauafcarqbca' - 'tgbfahqalgbxaeuaqg' - 'oaeuadaauafcarqbca' - 'bgblafqalgbxaeuaqg' - '4azqbuac4avwbfaeia' - 'uaguavaauafcarqbca' - 'tgblafqalgbxaeuaqg' - 'oaguavaauafcarqbca' - 'bgbfafqalgbxaeuaqg' - '4arqbuac4avwbfaeia' - 'uaeuavaauafcarqbca'
<li><a href="#">detection: selection: image|endswith: '\powershell.exe' filter: parentimage|endswith: - '\explorer.exe' - '\compattelrunner.exe'
<li><a href="#">detection: selection: image|endswith: '\powershell.exe' initiated: 'true' destinationisipv6: 'false' filter: destinationip|startswith: - '10.' - '192.168.' - '172.16.' - '172.17.' - '172.18.' - '172.19.' - '172.20.' - '172.21.' - '172.22.' - '172.23.' - '172.24.' - '172.25.' - '172.26.' - '172.27.' - '172.28.' - '172.29.' - '172.30.' - '172.31.' - '127.0.0.1' user|contains: # covers many language settings - 'authori' - 'autori'
<li><a href="#">detection: selection: image|endswith: '\powershell.exe' parentimage|endswith: '\excel.exe' commandline|contains: 'dataexchange.dll'
<li><a href="#">detection: selection: image|endswith: '\powershell.exe' targetfilename|contains: '\start menu\programs\startup\' targetfilename|endswith: '.lnk'
<li><a href="#">detection: selection: image|endswith: '\powershell.exe' targetfilename|endswith: '.bat'
<li><a href="#">detection: selection: image|endswith: '\printbrm.exe' commandline|contains|all: - ' -f' - '.zip'
<li><a href="#">detection: selection: image|endswith: '\protocolhandler.exe' commandline|contains|all: - '"ms-word' - '.docx"'
<li><a href="#">detection: selection: image|endswith: '\psexec.exe' commandline|contains: 'accepteula'
<li><a href="#">detection: selection: image|endswith: '\psexesvc.exe' user|contains: # covers many language settings - 'authori' - 'autori'
<li><a href="#">detection: selection: image|endswith: '\psr.exe' commandline|contains: '/start'
<li><a href="#">detection: selection: image|endswith: \python.exe commandline|contains: adidnsdump
<li><a href="#">detection: selection: image|endswith: '\rar.exe' commandline|contains: ' a '
<li><a href="#">detection: selection: image|endswith: '\reg.exe' # example: reg query "hkey_local_machine\software\microsoft\internet explorer" /v svcversion commandline|contains|all: - 'query' - '\software\' - '/v' - 'svcversion'
<li><a href="#">detection: selection: image|endswith: \reg.exe commandline|contains: - 'hklm\software\microsoft\windows defender\exclusions\paths\' - 'hklm\software\microsoft\microsoft antimalware\exclusions\paths' commandline|contains|all: - 'add ' - '/t ' - 'reg_dword ' - '/v ' - '/d ' - '0'
<li><a href="#">detection: selection: image|endswith: \reg.exe commandline|contains: - 'software\microsoft\windows defender\' - 'software\policies\microsoft\windows defender\' commandline|contains|all: - ' add ' - ' /d 0' selection_target: commandline|contains: - 'real-time protection' - 'tamperprotection'
<li><a href="#">detection: selection: image|endswith: \reg.exe commandline|contains: 'system\currentcontrolset\control\lsa' commandline|contains|all: - ' add ' - ' /d 0' - ' /v runasppl ' selection_target: commandline|contains: - 'real-time protection' - 'tamperprotection'
<li><a href="#">detection: selection: image|endswith: \reg.exe commandline|contains|all: - 'add ' - 'system\currentcontrolset\services\' - ' imagepath ' selection_value: commandline|contains: - ' /d ' - ' -d '
<li><a href="#">detection: selection: image|endswith: \reg.exe commandline|contains|all: - 'software\microsoft\cryptography' - '/v ' - 'machineguid'
<li><a href="#">detection: selection: image|endswith: '\regedit.exe'
<li><a href="#">detection: selection: image|endswith: '\regedit.exe' commandline|contains: - ' /i ' - ' /s ' - '.reg' filter: commandline|contains: - ' /e ' - ' /a ' - ' /c ' filter_2: commandline|re: ':[^ \\\\]' # to avoid intersection with ads rule
<li><a href="#">detection: selection: image|endswith: '\regedit.exe' commandline|contains: - ' /i ' - '.reg' selection_2: commandline|re: ':[^ \\\\]' filter: commandline|contains: - ' /e ' - ' /a ' - ' /c '
<li><a href="#">detection: selection: image|endswith: '\regedit.exe' commandline|contains: ' /e ' filter_1: # filters to avoid intersection with critical keys rule commandline|contains: - 'hklm' - 'hkey_local_machine' filter_2: commandline|endswith: - '\system' - '\sam' - '\security'
<li><a href="#">detection: selection: image|endswith: '\regedit.exe' commandline|contains: ' /e ' selection_2: commandline|contains: - 'hklm' - 'hkey_local_machine' selection_3: commandline|endswith: - '\system' - '\sam' - '\security'
<li><a href="#">detection: selection: image|endswith: '\regedit.exe' parentimage|endswith: - '\trustedinstaller.exe' - '\processhacker.exe'
<li><a href="#">detection: selection: image|endswith: '\register-cimprovider.exe' commandline|contains|all: - '-path' - 'dll'
<li><a href="#">detection: selection: image|endswith: '\regsvr32.exe'
<li><a href="#">detection: selection: image|endswith: '\regsvr32.exe' commandline|contains: ' /i:' filter: commandline|contains: ' /n '
<li><a href="#">detection: selection: image|endswith: '\regsvr32.exe' commandline|endswith: '.jpg' # can add other
<li><a href="#">detection: selection: image|endswith: '\regsvr32.exe' filter: commandline|contains: - '.dll' - '.ocx' - '.cpl' - '.ax' - '.bav' - '.ppl' filter_null1_for_4688: commandline: null filter_null2_for_4688: commandline: ''
<li><a href="#">detection: selection: image|endswith: '\replace.exe' argument: commandline|contains: - '/a' - '-a'
<li><a href="#">detection: selection: image|endswith: '\rundll32.exe' commandline|contains: - ',#' - ', #' - '.dll #' # sysmon removes , in its log - '.ocx #' # hermeticwizard filter: commandline|contains|all: - 'edgehtml.dll' - '#141'
<li><a href="#">detection: selection: image|endswith: \rundll32.exe commandline|contains: - '-sta ' - 'â€“localserver ' commandline|contains|all: - '{' - '}'
<li><a href="#">detection: selection: image|endswith: '\rundll32.exe' commandline|contains: - 'zxfunction' - 'remotediskxxxxx'
<li><a href="#">detection: selection: image|endswith: '\rundll32.exe' commandline|contains: 'installscreensaver'
<li><a href="#">detection: selection: image|endswith: '\rundll32.exe' commandline|contains|all: - 'c:\windows\system32\davclnt.dll,davsetcookie' - 'http' commandline|contains: - 'spoolss' - 'srvsvc' - '/print/pipe/'
<li><a href="#">detection: selection: image|endswith: '\rundll32.exe' commandline|contains|all: - 'keymgr' - 'krshowkeymgr'
<li><a href="#">detection: selection: image|endswith: '\rundll32.exe' commandline|contains|all: - 'pcwutl' - 'launchapplication'
<li><a href="#">detection: selection: image|endswith: '\rundll32.exe' commandline|contains|all: - 'shell32.dll' - 'control_rundll' commandline|contains: - '%appdata%' - '%localappdata%' - '%temp%' - '\appdata\' - '\temp\' - '\users\public\'
<li><a href="#">detection: selection: image|endswith: '\rundll32.exe' commandline|endswith: - ',rundll' - ',control_rundll' # - ',#1' too generic - function load by ordinal is not emotet specific filter_legitimate_dll: commandline|endswith: - '.dll,control_rundll' - '.dll",control_rundll' - '.dll'',control_rundll' filter_ide: parentimage|endswith: '\tracker.exe' #when visual studio compile nodejs program, it might use msbuild to create tracker.exe and then, the tracker.exe fork rundll32.exe
<li><a href="#">detection: selection: image|endswith: '\rundll32.exe' filter: - currentdirectory|contains: 'c:\' - currentdirectory: '' filter_null: currentdirectory: null
<li><a href="#">detection: selection: image|endswith: '\rundll32.exe' filter_empty: commandline: null filter: - commandline|contains: '.dll' - commandline: '' filter_iexplorer: parentimage|endswith: ':\program files\internet explorer\iexplore.exe' commandline|contains: '.cpl' filter_msiexec_syswow64: parentimage|endswith: ':\windows\syswow64\msiexec.exe' commandline|startswith: 'c:\windows\syswow64\msiexec.exe -embedding' filter_msiexec_system32: parentimage|endswith: ':\windows\system32\msiexec.exe' commandline|startswith: 'c:\windows\system32\msiexec.exe -embedding' filter_splunk_ufw: parentimage|endswith: ':\windows\system32\cmd.exe' parentcommandline|contains: ' c:\program files\splunkuniversalforwarder\'
<li><a href="#">detection: selection: image|endswith: '\rundll32.exe' initiated: 'true' filter: - destinationip|startswith: - '10.' - '192.168.' - '172.16.' - '172.17.' - '172.18.' - '172.19.' - '172.20.' - '172.21.' - '172.22.' - '172.23.' - '172.24.' - '172.25.' - '172.26.' - '172.27.' - '172.28.' - '172.29.' - '172.30.' - '172.31.' - '127.' - '20.' # microsoft range, caused some fps - commandline|contains: - 'pcasvc.dll,pcapatchsdbtask' filter_update_processes: parentimage: 'c:\windows\system32\svchost.exe' remoteaddress|endswith: ':443'
<li><a href="#">detection: selection: image|endswith: '\rundll32.exe' parentimage|endswith: '\explorer.exe' filter: commandline|contains: '\shell32.dll,openas_rundll'
<li><a href="#">detection: selection: image|endswith: '\runonce.exe' parentimage|endswith: '\rundll32.exe' parentcommandline|contains|all: - 'setupapi.dll' - 'installhinfsection'
<li><a href="#">detection: selection: image|endswith: '\sc.exe' commandline|contains|all: - 'sdset' - 'd;;' sids: commandline|contains: - ';;;iu' - ';;;su' - ';;;ba' - ';;;sy' - ';;;wd'
<li><a href="#">detection: selection: image|endswith: '\schtasks.exe' commandline|contains: ' /create ' filter: user|contains: # covers many language settings - 'authori' - 'autori'
<li><a href="#">detection: selection: image|endswith: '\schtasks.exe' commandline|contains: - '/delete' - '/change' commandline|contains|all: - '/tn' - '\microsoft\windows\defrag\scheduleddefrag'
<li><a href="#">detection: selection: image|endswith: '\schtasks.exe' commandline|contains: '/create ' parentimage|contains: - '\appdata\local\' - '\appdata\roaming\' - '\temporary internet' - '\users\public\' filter: commandline|contains: - 'update_task.xml' - 'unattended.ini'
<li><a href="#">detection: selection: image|endswith: '\schtasks.exe' commandline|contains|all: - ' /create ' - ' /sc once ' - '\temp\'
<li><a href="#">detection: selection: image|endswith: '\schtasks.exe' commandline|contains|all: - '/create' - '/ru "nt aut' - '/tr' - 'c:\users\' - '\appdata\local\'
<li><a href="#">detection: selection: image|endswith: '\scrcons.exe'
<li><a href="#">detection: selection: image|endswith: '\scrcons.exe' imageloaded|endswith: - '\vbscript.dll' - '\wbemdisp.dll' - '\wshom.ocx' - '\scrrun.dll'
<li><a href="#">detection: selection: image|endswith: '\sdbinst.exe' commandline|contains: '.sdb' filter: commandline|contains: 'iisexpressshim.sdb' # normal behaviour for iis express (e.g. )
<li><a href="#">detection: selection: image|endswith: \shutdown.exe commandline|contains: - '/r ' - '/s '
<li><a href="#">detection: selection: image|endswith: '\soundrecorder.exe' commandline|contains: '/file'
<li><a href="#">detection: selection: image|endswith: '\splwow64.exe' commandline|endswith: 'splwow64.exe'
<li><a href="#">detection: selection: image|endswith: '\spoolsv.exe' imageloaded|contains: - '\windows\system32\spool\drivers\x64\3\' - '\windows\system32\spool\drivers\x64\4\' imageloaded|endswith: '.dll'
<li><a href="#">detection: selection: image|endswith: '\spoolsv.exe' targetfilename|contains: 'c:\windows\system32\spool\drivers\x64\3\'
<li><a href="#">detection: selection: image|endswith: '\sqldumper.exe' commandline|contains: - '0x0110' - '0x01100:40'
<li><a href="#">detection: selection: image|endswith: '\svchost.exe' filter: parentimage|endswith: - '\services.exe' - '\msmpeng.exe' - '\mrt.exe' - '\rpcnet.exe' - '\ngen.exe' - '\tiworker.exe' filter_null1: parentimage: null filter_null2: parentimage: '' filter_emptysysmon: parentimage: '-'
<li><a href="#">detection: selection: image|endswith: '\svchost.exe' imageloaded|endswith: - '\tsmsisrv.dll' - '\tsvipsrv.dll' - '\wlbsctrl.dll' filter: imageloaded|startswith: 'c:\windows\winsxs\'
<li><a href="#">detection: selection: image|endswith: '\svchost.exe' imageloaded|endswith: '\clfsw32.dll'
<li><a href="#">detection: selection: image|endswith: '\svchost.exe' initiated: 'true' sourceport: 3389 selection2: - destinationip|startswith: - '127.' - destinationip: - '::1'
<li><a href="#">detection: selection: image|endswith: '\svchost.exe' initiated: 'true' sourceport: 3389 targetport: - 80 - 443
<li><a href="#">detection: selection: image|endswith: '\svchost.exe' targetfilename|contains: '\personalization\lockscreenimage\' filter1: targetfilename|contains: 'c:\windows\' filter2: targetfilename|contains: - '.jpg' - '.jpeg' - '.png'
<li><a href="#">detection: selection: image|endswith: '\syncappvpublishingserver.exe' commandline|contains: '"n; '
<li><a href="#">detection: selection: image|endswith: '\sysprep.exe' commandline|contains: '\appdata\'
<li><a href="#">detection: selection: image|endswith: \systeminfo.exe
<li><a href="#">detection: selection: image|endswith: '\takeown.exe' commandline|contains|all: - '/f ' - '/r'
<li><a href="#">detection: selection: image|endswith: '\tapinstall.exe'
<li><a href="#">detection: selection: image|endswith: '\vboxdrvinst.exe' commandline|contains|all: - 'driver' - 'executeinf'
<li><a href="#">detection: selection: image|endswith: '\wermgr.exe' parentimage|endswith: '\rundll32.exe' parentcommandline|contains: 'dllregisterserver'
<li><a href="#">detection: selection: image|endswith: '\windows\system32\lsass.exe' parentimage|endswith: '\windows\system32\lsass.exe'
<li><a href="#">detection: selection: image|endswith: '\wlrmdr.exe' commandline|contains|all: - '-s ' - '-f ' - '-t ' - '-m ' - '-a ' - '-u ' filter: parentimage: 'c:\windows\system32\winlogon.exe'
<li><a href="#">detection: selection: image|endswith: '\wmic.exe' imageloaded|endswith: - '\jscript.dll' - '\vbscript.dll'
<li><a href="#">detection: selection: image|endswith: '\wmiprvse.exe' imageloaded|endswith: '\wbem\wbemcomn.dll'
<li><a href="#">detection: selection: image|endswith: '\wsreset.exe' integritylevel: - 'high' - 'system'
<li><a href="#">detection: selection: image|endswith: '\xwizard.exe' commandline|re: '[a-fa-f0-9]{8}-[a-fa-f0-9]{4}-[a-fa-f0-9]{4}-[a-fa-f0-9]{4}-[a-fa-f0-9]{12}'
<li><a href="#">detection: selection: image|endswith: '\xwizard.exe' filter: image|startswith: 'c:\windows\system32\'
<li><a href="#">detection: selection: image|endswith: 'atbroker.exe' commandline|contains: 'start' filter: commandline|contains: - animations - audiodescription - caretbrowsing - caretwidth - colorfiltering - cursorscheme - filterkeys - focusborderheight - focusborderwidth - highcontrast - keyboardcues - keyboardpref - magnifierpane - messageduration - minimumhitradius - mousekeys - narrator - osk - overlappedcontent - showsounds - soundsentry - stickykeys - togglekeys - windowarranging - windowtracking - windowtrackingtimeout - windowtrackingzorder
<li><a href="#">detection: selection: image|endswith: 'crontab' commandline|contains: '/tmp/'
<li><a href="#">detection: selection: image|endswith: 'msdtc.exe' imageloaded: 'c:\windows\oci.dll'
<li><a href="#">detection: selection: image|endswith: 'notepad' imageloaded|endswith: - 'samlib' - 'winscard'
<li><a href="#">detection: selection: image|endswith: rasdial.exe
<li><a href="#">detection: selection: image|endswith: 'sdclt.exe' integritylevel: 'high'
<li><a href="#">detection: selection: image|endswith: 'umworkerprocess.exe' filter: targetfilename|endswith: - 'cachecleanup.bin' - '.txt' - '.log' - '.cfg' - 'cleanup.bin'
<li><a href="#">detection: selection: image|endswith: updata.exe targetfilename: 'c:\windows\oci.dll'
<li><a href="#">detection: selection: image|startswith: c:\program files\windowsapps\microsoft.desktopappinstaller_ image|endswith: \appinstaller.exe
<li><a href="#">detection: selection: imageloaded|contains: - '\windivert.sys' - '\windivert64.sys'
<li><a href="#">detection: selection: imageloaded|contains: - 'fgexec' - 'dumpsvc' - 'cachedump' - 'mimidrv' - 'gsecdump' - 'servpw' - 'pwdump'
<li><a href="#">detection: selection: imageloaded|contains: - 'powershell' - 'pwsh'
<li><a href="#">detection: selection: imageloaded|contains: \appdata\local\temp\ba9ea7344a4a5f591d6e5dc32a13494b\
<li><a href="#">detection: selection: imageloaded|contains: '\temp\'
<li><a href="#">detection: selection: imageloaded|endswith: - '\system.management.automation.dll' - '\system.management.automation.ni.dll' filter: - image: 'c:\windows\system32\dsac.exe' - image|endswith: - '\powershell.exe' - '\powershell_ise.exe' - '\windows\system32\sdiagnhost.exe' - '\mscorsvw.exe' # c:\windows\microsoft.net\framework64\v4.0.30319\mscorsw.exe for instance - '\windows\system32\remotefxvgpudisablement.exe' # on win10 - '\sqlps.exe' - '\wsmprovhost.exe' - '\winrshost.exe' - '\syncappvpublishingserver.exe' - '\runscripthelper.exe' - '\servermanager.exe' - '\microsoft sql server management studio *\common*\ide\ssms.exe' - '\ide\devenv.exe' - '\servicehub.vsdetouredhost.exe' - '\servicehub.settingshost.exe' - '\servicehub.host.clr.x86.exe' - '\citrix\configsync\configsyncrun.exe' - image|startswith: - 'c:\program files (x86)\microsoft visual studio\' - 'c:\program files\microsoft visual studio\' filter_nextron: image|startswith: 'c:\windows\temp\asgard2-agent\' image|endswith: - '\thor64.exe' - '\thor.exe' # user: 'nt authority\system' # if set, matches all powershell processes not launched by system
<li><a href="#">detection: selection: imageloaded|endswith: - '\ttdrecord.dll' - '\ttdwriter.dll' - '\ttdloader.dll'
<li><a href="#">detection: selection: imageloaded|endswith: - '\wmiclnt.dll' - '\wmiaprpl.dll' - '\wmiprov.dll' - '\wmiutils.dll' - '\wbemcomn.dll' - '\wbemprox.dll' - '\wminet_utils.dll' - '\wbemsvc.dll' - '\fastprox.dll' filter: image|endswith: - '\wmiprvse.exe' - '\wmiapsrv.exe' - '\svchost.exe' - '\devicecensus.exe' - '\compattelrunner.exe' - '\sdiagnhost.exe' - '\sihclient.exe' - '\ngentask.exe' # c:\windows\microsoft.net\framework(64)\ngentask.exe - '\windows\system32\taskhostw.exe' # c:\windows\system32\taskhostw.exe - '\windows\system32\mousocoreworker.exe' # c:\windows\system32\mousocoreworker.exe on win10 20h04 at least - '\windows\system32\wbem\wmiadap.exe' # - 'c:\windows\sysmon64.exe' - 'c:\windows\sysmon.exe' - 'c:\windows\system32\wbem\unsecapp.exe' - '\logman.exe' - '\systeminfo.exe' - '\nvcontainer.exe' - 'c:\windows\system32\wbem\wmic.exe' - '\explorer.exe' - '\opera_autoupdate.exe' - '\msmpeng.exe' - '\thor64.exe' - '\thor.exe' filter_generic: # rule caused many false positives in different productive environments - using this filter to exclude all programs that run from folders that only the administrative groups should have access to image|startswith: - 'c:\program files\' - 'c:\program files (x86)\'
<li><a href="#">detection: selection: imageloaded|endswith: '\advapi32.dll' filter_common: image|startswith: - 'c:\windows\' - 'c:\program files (x86)\' - 'c:\program files\' filter_defender: image|startswith: 'c:\programdata\microsoft\windows defender\platform\' image|endswith: '\mpcmdrun.exe' filter_onedrive: image|startswith: 'c:\users\' image|contains: '\appdata\local\microsoft\onedrive\' image|endswith: 'filecoauth.exe'
<li><a href="#">detection: selection: imageloaded|endswith: '\system.drawing.ni.dll' filter: # the number of false positives was too high - we had to do this broader filter # based on the following paths that shouldn't be writable to an unprivileged user image|startswith: - 'c:\program files\' - 'c:\program files (x86)\' - 'c:\windows\system32\' - 'c:\windows\microsoft.net\' - 'c:\windows\immersivecontrolpanel\' filter2: image: - 'c:\users\\*\appdata\local\nhnotifsys\nahimic\nahimicnotifsys.exe' - 'c:\users\\*\githubdesktop\update.exe' - 'c:\windows\system32\nhnotifsys.exe'
<li><a href="#">detection: selection: imageloaded|endswith: '\vss_ps.dll' filter: image|endswith: - '\svchost.exe' - '\msiexec.exe' - '\vssvc.exe' - '\srtasks.exe' - '\tiworker.exe' - '\dllhost.exe' - '\searchindexer.exe' - '\dismhost.exe' - '\taskhostw.exe' - '\clussvc.exe' - '\thor64.exe' - '\thor.exe' - '\rundll32.exe' - '\inetsrv\iissetup.exe' - '\inetsrv\appcmd.exe' image|contains: 'c:\windows\'
<li><a href="#">detection: selection: initiated: 'true' destinationhostname|endswith: - '.github.com' - '.githubusercontent.com' image|startswith: 'c:\windows\'
<li><a href="#">detection: selection: initiated: 'true' destinationhostname|endswith: - 'api.dropboxapi.com' - 'content.dropboxapi.com' filter: image|contains: '\dropbox'
<li><a href="#">detection: selection: initiated: 'true' destinationhostname|endswith: - 'dl.dropboxusercontent.com' - '.pastebin.com' - '.githubusercontent.com' # includes both gists and github repositories - 'cdn.discordapp.com/attachments/' - 'mediafire.com' - 'mega.nz' - 'ddns.net' - '.paste.ee' - '.hastebin.com/raw/' - '.ghostbin.co/' - 'ufile.io' image|startswith: 'c:\windows\'
<li><a href="#">detection: selection: initiated: 'true' destinationhostname|endswith: 'api.mega.co.nz'
<li><a href="#">detection: selection: initiated: 'true' destinationport: - '4443' - '2448' - '8143' - '1777' - '1443' - '243' - '65535' - '13506' - '3360' - '200' - '198' - '49180' - '13507' - '6625' - '4444' - '4438' - '1904' - '13505' - '13504' - '12102' - '9631' - '5445' - '2443' - '777' - '13394' - '13145' - '12103' - '5552' - '3939' - '3675' - '666' - '473' - '5649' - '4455' - '4433' - '1817' - '100' - '65520' - '1960' - '1515' - '743' - '700' - '14154' - '14103' - '14102' - '12322' - '10101' - '7210' - '4040' - '9943' filter1: image|contains: '\program files' filter2: destinationip|startswith: - '10.' - '192.168.' - '172.16.' - '172.17.' - '172.18.' - '172.19.' - '172.20.' - '172.21.' - '172.22.' - '172.23.' - '172.24.' - '172.25.' - '172.26.' - '172.27.' - '172.28.' - '172.29.' - '172.30.' - '172.31.' - '127.'
<li><a href="#">detection: selection: initiated: 'true' image|contains: python
<li><a href="#">detection: selection: initiated: 'true' image|endswith: - '\regsvr32.exe' - '\rundll32.exe' - '\dllhost.exe' commandline|endswith: - '\regsvr32.exe' - '\rundll32.exe' - '\dllhost.exe' filter_no_cmdline: commandline: '' filter_null: # e.g. sysmon has no commandline field in network events with id 3 commandline: null
<li><a href="#">detection: selection: initiated: 'true' image|endswith: '\imewdbld.exe'
<li><a href="#">detection: selection: initiated: 'true' image|endswith: '\msiexec.exe'
<li><a href="#">detection: selection: integritylevel: - 'high' - 'system' image: 'c:\windows\system32\computerdefaults.exe' filter: parentimage|contains: - ':\windows\system32' - ':\program files'
<li><a href="#">detection: selection: integritylevel: - 'high' - 'system' parentimage|endswith: '\appdata\local\temp\pkgmgr.exe' commandline: '"c:\windows\system32\msconfig.exe" -5'
<li><a href="#">detection: selection: integritylevel: - 'high' - 'system' parentimage|endswith: '\appdata\local\temp\system32\winsat.exe' parentcommandline|contains: 'c:\windows \system32\winsat.exe'
<li><a href="#">detection: selection: integritylevel: - 'high' - 'system' parentimage|endswith: '\ieinstal.exe' image|contains: '\appdata\local\temp\' image|endswith: 'consent.exe'
<li><a href="#">detection: selection: integritylevel: 'medium' commandline|contains|all: - controlset - services commandline|contains: - \imagepath - \failurecommand - \servicedll
<li><a href="#">detection: selection: integritylevel: system user|contains: # covers many language settings - 'authori' - 'autori' selection_special: - image|endswith: - '\calc.exe' - '\wscript.exe' - '\cscript.exe' - '\hh.exe' - '\mshta.exe' - '\forfiles.exe' - '\ping.exe' - commandline|contains: # - 'sc stop ' # stops a system service # causes fps - ' -nop ' # often used in malicious powershell commands - ' -w hidden ' # often used in malicious powershell commands - ' -decode ' # used with certutil - ' /decode ' # used with certutil - ' /urlcache ' # used with certutil - ' -urlcache ' # used with certutil - ' -e* jab' # powershell encoded commands - ' -e* suvyi' # powershell encoded commands - ' -e* sqbfafga' # powershell encoded commands - ' -e* awv4i' # powershell encoded commands - ' -e* iab' # powershell encoded commands - ' -e* paa' # powershell encoded commands - ' -e* aqblahga' # powershell encoded commands - 'vssadmin delete shadows' # ransomware - 'reg save hklm' # save registry sam - syskey extraction - ' -ma ' # procdump - 'microsoft\windows\currentversion\run' # run key in command line - often in combination with reg add - '.downloadstring(' # powershell download command - '.downloadfile(' # powershell download command - ' /ticket:' # rubeus - 'dpapi::' #mimikatz - 'event::clear' #mimikatz - 'event::drop' #mimikatz - 'id::modify' #mimikatz - 'kerberos::' #mimikatz - 'lsadump::' #mimikatz - 'misc::' #mimikatz - 'privilege::' #mimikatz - 'rpc::' #mimikatz - 'sekurlsa::' #mimikatz - 'sid::' #mimikatz - 'token::' #mimikatz - 'vault::cred' #mimikatz - 'vault::list' #mimikatz - ' p::d ' # mimikatz - ';iex(' # powershell iex - 'minidump' # process dumping method apart from procdump - 'net user '
<li><a href="#">detection: selection: key: 'susp_activity'
<li><a href="#">detection: selection: loggedbyservice: 'authentication methods' category: 'usermanagement' operationname: 'user registered security info'
<li><a href="#">detection: selection: name: - '\mimidrv' - '\lsass' - '\windows\minidump\' - '\hiberfil' - '\sqldmpr' - '\sam' - '\ntds.dit' - '\security'
<li><a href="#">detection: selection: name|endswith: - '.pst' - '.ost' - '.msg' - '.nst' - '.oab' - '.edb' - '.nsf' - '.bak' - '.dmp' - '.kirbi' - '\groups.xml' - '.rdp'
<li><a href="#">detection: selection: operation: - 'rpcasyncinstallprinterdriverfrompackage' # "76f03f96-cdfd-44fc-a22c-64950a001209",0x3e - 'rpcasyncaddprintprocessor' # "76f03f96-cdfd-44fc-a22c-64950a001209",0x2c - 'rpcaddprintprocessor' # "12345678-1234-abcd-ef00-0123456789ab",0x0e - 'rpcaddprinterdriverex' # "12345678-1234-abcd-ef00-0123456789ab",0x59 - 'rpcaddprinterdriver' # "12345678-1234-abcd-ef00-0123456789ab",0x09 - 'rpcasyncaddprinterdriver' # "76f03f96-cdfd-44fc-a22c-64950a001209",0x27
<li><a href="#">detection: selection: operation: #- lsarenumeratetrusteddomains #potentially too many fps, removing. caused by netlogon #- samrenumeratedomainsinsamserver #potentially too many fps, removing. #method obtains a listing of all domains hosted by the server side of this protocol. this value is a cookie that the server can use to continue an enumeration on a subsequent call - lsarlookupnames3 #method translates a batch of security principal names to their sid form - lsarlookupsids3 #translates a batch of security principal sids to their name forms - samrgetgroupsforuser #obtains a listing of groups that a user is a member of - samrlookupidsindomain #method translates a set of rids into account names - samrlookupnamesindomain #method translates a set of account names into a set of rids - samrquerysecurityobject #method queries the access control on a server, domain, user, group, or alias object - samrqueryinformationgroup #obtains attributes from a group object timeframe: 30s
<li><a href="#">detection: selection: operation: 'add member to role.' workload: 'azureactivedirectory' modifiedproperties.newvalue|endswith: - 'admins' - 'administrator'
<li><a href="#">detection: selection: operation|startswith: - 'efs' - 'efs'
<li><a href="#">detection: selection: originalfilename: - '7z*.exe' - '*rar.exe' - '*command*line*rar*' commandline|contains: - ' -p' - ' -ta' - ' -tb' - ' -sdel' - ' -dw' - ' -hp' falsepositive: parentimage|startswith: 'c:\program'
<li><a href="#">detection: selection: originalfilename: - 'cmd.exe' - 'conhost.exe' - 'powershell.exe' - 'powershell_ise.exe' - 'psexec.exe' - 'psexec.c' # old versions of psexec (2016 seen) - 'cscript.exe' - 'wscript.exe' - 'mshta.exe' - 'regsvr32.exe' - 'wmic.exe' - 'certutil.exe' - 'rundll32.exe' - 'cmstp.exe' - 'msiexec.exe' - '7z.exe' - 'winrar.exe' - 'wevtutil.exe' - 'net.exe' - 'net1.exe' - 'netsh.exe' filter: image|endswith: - '\cmd.exe' - '\conhost.exe' - '\powershell.exe' - '\powershell_ise.exe' - '\psexec.exe' - '\psexec64.exe' - '\cscript.exe' - '\wscript.exe' - '\mshta.exe' - '\regsvr32.exe' - '\wmic.exe' - '\certutil.exe' - '\rundll32.exe' - '\cmstp.exe' - '\msiexec.exe' - '\7z.exe' - '\winrar.exe' - '\wevtutil.exe' - '\net.exe' - '\net1.exe' - '\netsh.exe'
<li><a href="#">detection: selection: originalfilename: - 'powershell.exe' - 'powershell_ise.exe' - 'psexec.exe' - 'psexec.c' # old versions of psexec (2016 seen) - 'cscript.exe' - 'wscript.exe' - 'mshta.exe' - 'regsvr32.exe' - 'wmic.exe' - 'certutil.exe' - 'rundll32.exe' - 'cmstp.exe' - 'msiexec.exe' filter: image|endswith: - '\powershell.exe' - '\powershell_ise.exe' - '\psexec.exe' - '\psexec64.exe' - '\cscript.exe' - '\wscript.exe' - '\mshta.exe' - '\regsvr32.exe' - '\wmic.exe' - '\certutil.exe' - '\rundll32.exe' - '\cmstp.exe' - '\msiexec.exe'
<li><a href="#">detection: selection: originalfilename: browsercore.exe filter_realbrowsercore: image|endswith: '\browsercore.exe'
<li><a href="#">detection: selection: originalfilename: clip.exe
<li><a href="#">detection: selection: originalfilename: mpcmdrun.exe commandline|contains|all: - ' -removedefinitions' - ' -all'
<li><a href="#">detection: selection: originalfilename: 'msdt.exe' filter_realmsdt: image|endswith: '\msdt.exe'
<li><a href="#">detection: selection: originalfilename: nmap.exe
<li><a href="#">detection: selection: originalfilename: 'plink' filter: image|endswith: '\plink.exe'
<li><a href="#">detection: selection: originalfilename: rdrleakdiag.exe commandline|contains: fullmemdmp
<li><a href="#">detection: selection: originalfilename: 'rundll32.exe' filter: image|endswith: '\rundll32.exe'
<li><a href="#">detection: selection: originalfilename: sdelete.exe filter: commandline|contains: - ' -h' - ' -c' - ' -z' - ' /?'
<li><a href="#">detection: selection: originalfilename: 'whoami.exe' filter: image|endswith: '\whoami.exe'
<li><a href="#">detection: selection: pam_message: authentication failure pam_user: '*' pam_rhost: '*' timeframe: 24h
<li><a href="#">detection: selection: parentcommandline: 'bash -i' anomaly1: commandline|contains: - '-c import ' - 'base64' - 'pty.spawn' anomaly2: image|endswith: - 'whoami' - 'iptables' - '/ncat' - '/nc' - '/netcat'
<li><a href="#">detection: selection: parentcommandline|contains: 'conhost' commandline|contains: '/../../'
<li><a href="#">detection: selection: parentcommandline|contains|all: - '\cmd.exe' - '/c' - 'c:\windows\setup\scripts\' parentcommandline|endswith: - 'setupcomplete.cmd' - 'partnersetupcomplete.cmd' filter: image|startswith: - 'c:\windows\system32\' - 'c:\windows\syswow64\' - 'c:\windows\winsxs\' - 'c:\windows\setup\'
<li><a href="#">detection: selection: parentcommandline|contains|all: - '\svchost.exe' - 'termsvcs' filter: image|endswith: - '\rdpclip.exe' - ':\windows\system32\csrss.exe' - ':\windows\system32\wininit.exe'
<li><a href="#">detection: selection: parentcommandline|contains|all: - 'cmd' - '/c' commandline|contains: '/../../' falsepositive_1: commandline|contains: '\tasktop\keycloak\bin\/../../jre\bin\java'
<li><a href="#">detection: selection: parentcommandline|startswith: 'c:\windows\system32\svchost.exe -k rpcss'
<li><a href="#">detection: selection: parentimage: c:\windows\explorer.exe image: c:\windows\system32\cmd.exe commandline|contains|all: - 'powershell' - '.lnk'
<li><a href="#">detection: selection: parentimage: 'c:\windows\hh.exe' image|endswith: - '\cmd.exe' - '\powershell.exe' - '\wscript.exe' - '\cscript.exe' - '\regsvr32.exe' - '\wmic.exe' - '\rundll32.exe'
<li><a href="#">detection: selection: parentimage|contains|all: - 'c:\users\' - '\appdata\local\temp\' - '\dismhost.exe' integritylevel: - 'high' - 'system'
<li><a href="#">detection: selection: parentimage|endswith: - '\mshta.exe' - '\powershell.exe' # - '*\cmd.exe' # too many false positives - '\rundll32.exe' - '\cscript.exe' - '\wscript.exe' - '\wmiprvse.exe' image|endswith: - '\schtasks.exe' - '\nslookup.exe' - '\certutil.exe' - '\bitsadmin.exe' - '\mshta.exe' falsepositives_1: currentdirectory|contains: '\ccmcache\' falsepositives_2: parentcommandline|contains: # fp - amazon workspaces - '\program files\amazon\workspacesconfig\scripts\setup-scheduledtask.ps1' - '\program files\amazon\workspacesconfig\scripts\set-selfhealing.ps1' - '\program files\amazon\workspacesconfig\scripts\check-workspacehealth.ps1' - '\nessus_' # tenable/nessus va scanner falsepositives_3: commandline|contains: '\nessus_' # tenable/nessus va scanner
<li><a href="#">detection: selection: parentimage|endswith: - '\notepad.exe' - '\minesweeper.exe' - '\winver.exe' - '\bitsadmin.exe' selection_special: parentimage|endswith: - '\csrss.exe' - '\certutil.exe' - '\schtasks.exe' - '\eventvwr.exe' - '\calc.exe' filter_special: image|endswith: - '\werfault.exe' - '\wermgr.exe' - '\conhost.exe' # csrss.exe, certutil.exe - '\mmc.exe' # eventvwr.exe - '\win32calc.exe' # calc.exe filter_null: image: null
<li><a href="#">detection: selection: parentimage|endswith: - '\pcalua.exe' - '\forfiles.exe'
<li><a href="#">detection: selection: parentimage|endswith: - '\winlogon.exe' - '\services.exe' - '\lsass.exe' - '\csrss.exe' - '\smss.exe' - '\wininit.exe' - '\spoolsv.exe' - '\searchindexer.exe' image|endswith: - '\powershell.exe' - '\cmd.exe' user|contains: # covers many language settings - 'authori' - 'autori' filter: commandline|contains|all: - ' route ' - ' add '
<li><a href="#">detection: selection: parentimage|endswith: - '\winrar.exe' - '\7zfm.exe' - '\peazip.exe' image|endswith: - '\isoburn.exe' - '\poweriso.exe' - '\imgburn.exe'
<li><a href="#">detection: selection: parentimage|endswith: - '\winword.exe' - '\excel.exe' - '\powerpnt.exe' - '\msaccess.exe' - '\mspub.exe' - '\eqnedt32.exe' - '\visio.exe' image|contains: - '\windows\system32\' - '\windows\syswow64\' commandline: - '../../../..' - '..\..\..\..' - '..//..//..//..'
<li><a href="#">detection: selection: parentimage|endswith: - '\winword.exe' - '\excel.exe' - '\powerpnt.exe' - '\mspub.exe' - '\visio.exe' - '\msaccess.exe' - '\eqnedt32.exe' # - '\outlook.exe' too many fps image|startswith: 'c:\users\' image|endswith: '.exe' filter: image|endswith: '\teams.exe'
<li><a href="#">detection: selection: parentimage|endswith: - '\winword.exe' - '\excel.exe' - '\powerpnt.exe' - '\mspub.exe' - '\visio.exe' - '\msaccess.exe' - '\eqnedt32.exe' image|endswith: - '\cmd.exe' - '\powershell.exe' - '\wscript.exe' - '\cscript.exe' - '\sh.exe' - '\bash.exe' - '\scrcons.exe' - '\schtasks.exe' - '\regsvr32.exe' - '\hh.exe' - '\wmic.exe' # - '\mshta.exe' - '\rundll32.exe' - '\msiexec.exe' - '\forfiles.exe' - '\scriptrunner.exe' - '\mftrace.exe' - '\appvlp.exe' - '\svchost.exe' # - '\msbuild.exe' #
<li><a href="#">detection: selection: parentimage|endswith: - '\wscript.exe' - '\cscript.exe' image|endswith: '\powershell.exe' falsepositive: currentdirectory|contains: '\health service state\'
<li><a href="#">detection: selection: parentimage|endswith: '/java' commandline|contains: - '/bin/sh' - 'bash' - 'dash' - 'ksh' - 'zsh' - 'csh' - 'fish' - 'curl' - 'wget' - 'python'
<li><a href="#">detection: selection: parentimage|endswith: '\cmd.exe' image|endswith: '\nltest.exe' commandline|contains: '/domain_trusts /all_trusts'
<li><a href="#">detection: selection: parentimage|endswith: '\cmd.exe' parentcommandline|contains: ' /c ' image|endswith: '\chcp.com' commandline|endswith: - 'chcp' - 'chcp ' - 'chcp '
<li><a href="#">detection: selection: parentimage|endswith: '\conhost.exe' filter: provider_name: 'systemtraceprovider-process' # fps with aurora
<li><a href="#">detection: selection: parentimage|endswith: '\consent.exe' image|endswith: '\iexplore.exe' commandline|contains: ' http' rights1: integritylevel: 'system' # for sysmon users rights2: user|contains: # covers many language settings - 'authori' - 'autori'
<li><a href="#">detection: selection: parentimage|endswith: '\consent.exe' image|endswith: '\werfault.exe' integritylevel: - 'high' - 'system'
<li><a href="#">detection: selection: parentimage|endswith: '\dllhost.exe' integritylevel: - 'high' - 'system' parentcommandline|contains: - ' /processid:{3e5fc7f9-9a51-4367-9063-a120244fbec7}' - ' /processid:{3e000d72-a845-4cd9-bd83-80c07c3b881f}' - ' /processid:{bd54c901-076b-434e-b6c7-17c531f4ab41}' - ' /processid:{d2e7041b-2927-42fb-8e9f-7ce93b6dc937}' - ' /processid:{e9495b87-d950-4ab5-87a5-ff6d70bf3e90}'
<li><a href="#">detection: selection: parentimage|endswith: '\dllhost.exe' parentcommandline|contains: ' /processid:{12c21ea7-2eb8-4b55-9249-ac243da8c666}' integritylevel: - 'high' - 'system'
<li><a href="#">detection: selection: parentimage|endswith: '\edgetransport.exe' filter: image: 'c:\windows\system32\conhost.exe'
<li><a href="#">detection: selection: parentimage|endswith: '\eqnedt32.exe'
<li><a href="#">detection: selection: parentimage|endswith: '\fodhelper.exe'
<li><a href="#">detection: selection: parentimage|endswith: '\gup.exe' image|endswith: '\explorer.exe' filter: image|endswith: '\explorer.exe' commandline|contains: '\notepad++\notepad++.exe'
<li><a href="#">detection: selection: parentimage|endswith: '\hwp.exe' image|endswith: '\gbb.exe'
<li><a href="#">detection: selection: parentimage|endswith: '\java.exe' image|endswith: - '\sh.exe' - '\bash.exe' - '\powershell.exe' - '\schtasks.exe' - '\certutil.exe' - '\whoami.exe' - '\bitsadmin.exe' - '\wscript.exe' - '\cscript.exe' - '\scrcons.exe' - '\regsvr32.exe' - '\hh.exe' - '\wmic.exe' # - '\mshta.exe' - '\rundll32.exe' - '\forfiles.exe' - '\scriptrunner.exe' - '\mftrace.exe' - '\appvlp.exe' - '\curl.exe'
<li><a href="#">detection: selection: parentimage|endswith: '\java.exe' image|endswith: '\cmd.exe' filter: parentimage|contains: 'build' # excluding ci build agents commandline|contains: 'build' # excluding ci build agents
<li><a href="#">detection: selection: parentimage|endswith: '\keytool.exe' image|endswith: - '\cmd.exe' - '\sh.exe' - '\bash.exe' - '\powershell.exe' - '\schtasks.exe' - '\certutil.exe' - '\whoami.exe' - '\bitsadmin.exe' - '\wscript.exe' - '\cscript.exe' - '\scrcons.exe' - '\regsvr32.exe' - '\hh.exe' - '\wmic.exe' - '\mshta.exe' - '\rundll32.exe' - '\forfiles.exe' - '\scriptrunner.exe' - '\mftrace.exe' - '\appvlp.exe'
<li><a href="#">detection: selection: parentimage|endswith: '\mmc.exe' selection2: - image|endswith: - '\cmd.exe' - '\powershell.exe' - '\wscript.exe' - '\cscript.exe' - '\sh.exe' - '\bash.exe' - '\reg.exe' - '\regsvr32.exe' - image|contains: - '\bitsadmin'
<li><a href="#">detection: selection: parentimage|endswith: '\mshta.exe' selection2: - image|endswith: - '\cmd.exe' - '\powershell.exe' - '\wscript.exe' - '\cscript.exe' - '\sh.exe' - '\bash.exe' - '\reg.exe' - '\regsvr32.exe' - image|contains: - '\bitsadmin'
<li><a href="#">detection: selection: parentimage|endswith: '\msra.exe' parentcommandline|endswith: 'msra.exe' image|endswith: - '\arp.exe' - '\cmd.exe' - '\net.exe' - '\netstat.exe' - '\nslookup.exe' - '\route.exe' - '\schtasks.exe' - '\whoami.exe'
<li><a href="#">detection: selection: parentimage|endswith: '\net.exe' image|endswith: '\net1.exe' commandline|contains|all: - 'share' - '/delete'
<li><a href="#">detection: selection: parentimage|endswith: '\outlook.exe' image|endswith: - '\cmd.exe' - '\powershell.exe' - '\wscript.exe' - '\cscript.exe' - '\sh.exe' - '\bash.exe' - '\scrcons.exe' - '\schtasks.exe' - '\regsvr32.exe' - '\hh.exe' - '\wmic.exe' # - '\mshta.exe' # - '\rundll32.exe' # see comment below - '\msiexec.exe' - '\forfiles.exe' - '\scriptrunner.exe' - '\mftrace.exe' - '\appvlp.exe' - '\svchost.exe' # - '\msbuild.exe' # - '\msdt.exe' # cve-2022-30190 # several fps with rundll32.exe - we started excluding specific use cases and # ended commenting out all rundll32.exe sub processes #filter_outlook_photoviewer: # # parentimage|endswith: '\outlook.exe' # image|endswith: '\rundll32.exe' # commandline|contains: '\photoviewer.dll' #filter_outlook_printattachments: # # parentimage|endswith: '\outlook.exe' # image|endswith: '\rundll32.exe' # commandline|contains|all: # - 'shell32.dll,control_rundll' # - '\system32\spool\drivers\'
<li><a href="#">detection: selection: parentimage|endswith: '\pcwrun.exe'
<li><a href="#">detection: selection: parentimage|endswith: '\pkgmgr.exe' image|endswith: '\dism.exe' integritylevel: - 'high' - 'system'
<li><a href="#">detection: selection: parentimage|endswith: '\powershell.exe' image|endswith: - '\sh.exe' - '\bash.exe' - '\schtasks.exe' - '\certutil.exe' - '\bitsadmin.exe' - '\wscript.exe' - '\cscript.exe' - '\scrcons.exe' - '\regsvr32.exe' - '\hh.exe' - '\wmic.exe' - '\mshta.exe' - '\rundll32.exe' - '\forfiles.exe' - '\scriptrunner.exe'
<li><a href="#">detection: selection: parentimage|endswith: '\powershell.exe' image|endswith: '\nslookup.exe' commandline|endswith: '\nslookup.exe'
<li><a href="#">detection: selection: parentimage|endswith: '\powershell.exe' image|endswith: '\powershell.exe' commandline|contains|all: - 'get-content' - '-stream'
<li><a href="#">detection: selection: parentimage|endswith: '\razerinstaller.exe' integritylevel: 'system' filter: image|startswith: 'c:\windows\installer\razer\installer\'
<li><a href="#">detection: selection: parentimage|endswith: '\regsvr32.exe' image|endswith: '\explorer.exe'
<li><a href="#">detection: selection: parentimage|endswith: '\rundll32.exe' image|endswith: '\explorer.exe' filter: parentcommandline|contains: '\shell32.dll,control_rundll'
<li><a href="#">detection: selection: parentimage|endswith: '\scrcons.exe' image|endswith: - '\svchost.exe' - '\dllhost.exe' - '\powershell.exe' - '\wscript.exe' - '\cscript.exe' - '\schtasks.exe' - '\regsvr32.exe' - '\mshta.exe' - '\rundll32.exe' - '\msiexec.exe' - '\msbuild.exe'
<li><a href="#">detection: selection: parentimage|endswith: '\sdclt.exe'
<li><a href="#">detection: selection: parentimage|endswith: '\sdiagnhost.exe' image|endswith: - '\powershell.exe' - '\cmd.exe' - '\mshta.exe' - '\cscript.exe' - '\wscript.exe' - '\taskkill.exe'
<li><a href="#">detection: selection: parentimage|endswith: '\serv-u.exe' image|endswith: - '\cmd.exe' - '\powershell.exe' - '\wscript.exe' - '\cscript.exe' - '\sh.exe' - '\bash.exe' - '\schtasks.exe' - '\regsvr32.exe' - '\wmic.exe' # - '\mshta.exe' - '\rundll32.exe' - '\msiexec.exe' - '\forfiles.exe' - '\scriptrunner.exe'
<li><a href="#">detection: selection: parentimage|endswith: '\sllauncher.exe' image|endswith: '\svchost.exe'
<li><a href="#">detection: selection: parentimage|endswith: '\sqlservr.exe' image|endswith: - '\cmd.exe' - '\sh.exe' - '\bash.exe' - '\powershell.exe' - '\bitsadmin.exe' filter_datev: parentimage|startswith: 'c:\program files\microsoft sql server\' parentimage|endswith: 'datev_dbengine\mssql\binn\sqlservr.exe' image: 'c:\windows\system32\cmd.exe' commandline|startswith: '"c:\windows\system32\cmd.exe" '
<li><a href="#">detection: selection: parentimage|endswith: '\stordiag.exe' image|endswith: - '\schtasks.exe' - '\systeminfo.exe' - '\fltmc.exe' filter: parentimage|startswith: # as first is "copy c:\windows\system32\stordiag.exe to a folder" - 'c:\windows\system32\' - 'c:\windows\syswow64\'
<li><a href="#">detection: selection: parentimage|endswith: '\svchost.exe' image|endswith: '\mmc.exe' commandline|contains: '-embedding'
<li><a href="#">detection: selection: parentimage|endswith: '\svchost.exe' image|endswith: '\mshta.exe'
<li><a href="#">detection: selection: parentimage|endswith: '\system32\control.exe' image|endswith: '\rundll32.exe ' filter: commandline|contains: 'shell32.dll'
<li><a href="#">detection: selection: parentimage|endswith: '\system32\dns.exe' filter: image|endswith: - '\system32\werfault.exe' - '\system32\conhost.exe' - '\system32\dnscmd.exe'
<li><a href="#">detection: selection: parentimage|endswith: '\taskmgr.exe' filter: image|endswith: - '\resmon.exe' - '\mmc.exe' - '\taskmgr.exe'
<li><a href="#">detection: selection: parentimage|endswith: '\tttracer.exe'
<li><a href="#">detection: selection: parentimage|endswith: '\userinit.exe' filter1: commandline|contains: '\netlogon\' filter2: - image|endswith: '\explorer.exe' - imagefilename: 'explorer.exe'
<li><a href="#">detection: selection: parentimage|endswith: '\vbc.exe' image|endswith: '\cvtres.exe'
<li><a href="#">detection: selection: parentimage|endswith: '\vsjitdebugger.exe' reduction1: image|endswith: '\vsimmersiveactivatehelper*.exe' reduction2: image|endswith: '\devenv.exe'
<li><a href="#">detection: selection: parentimage|endswith: '\winword.exe' image|contains: '\fltldr.exe'
<li><a href="#">detection: selection: parentimage|endswith: '\winword.exe' image|endswith: '\csc.exe'
<li><a href="#">detection: selection: parentimage|endswith: '\winword.exe' image|endswith: '\microscmgmt.exe'
<li><a href="#">detection: selection: parentimage|endswith: '\wmiprvse.exe' filter: - logonid: - '0x3e7' # luid 999 for system - 'null' # too many false positives - user|contains: # covers many language settings - 'authori' - 'autori' - image|endswith: - '\wmiprvse.exe' - '\werfault.exe' filter_null: # some backends need the null value in a separate expression logonid: null
<li><a href="#">detection: selection: parentimage|endswith: '\wsmprovhost.exe' image|endswith: - '\cmd.exe' - '\sh.exe' - '\bash.exe' - '\powershell.exe' - '\wsl.exe' - '\schtasks.exe' - '\certutil.exe' - '\whoami.exe' - '\bitsadmin.exe'
<li><a href="#">detection: selection: parentimage|endswith: '\wsreset.exe'
<li><a href="#">detection: selection: parentimage|endswith: '\wsreset.exe' filter: - image|endswith: '\conhost.exe' - originalfilename: 'conhost.exe'
<li><a href="#">detection: selection: parentimage|endswith: 'desktopcentral_server\jre\bin\java.exe' image|endswith: - '\cmd.exe' - '\powershell.exe' - '\bitsadmin.exe'
<li><a href="#">detection: selection: parentimage|endswith: 'screenconnect.clientservice.exe' image|endswith: - '\cmd.exe' - '\powershell.exe'
<li><a href="#">detection: selection: parentimage|endswith: 'umworkerprocess.exe' filter: image|endswith: - 'wermgr.exe' - 'werfault.exe'
<li><a href="#">detection: selection: parentimage|endswith: 'updata.exe' commandline|contains|all: - 'config' - 'msdtc' - 'start' - 'auto'
<li><a href="#">detection: selection: parentimage|startswith: 'c:\users\public\' commandline|contains: - 'powershell' - 'cmd.exe /c ' - 'cmd /c ' - 'wscript.exe' - 'cscript.exe' - 'bitsadmin' - 'certutil' - 'mshta.exe'
<li><a href="#">detection: selection: parentuser: - 'nt authority\network service' - 'nt authority\local service' - 'autorite nt\' # french language settings user|contains: # covers many language settings - 'authori' - 'autori' user|endswith: # system - '\system' - '\ð¡ð˜ð¡ð¢ð•ðœð' integritylevel: 'system' rundllexception: image|endswith: '\rundll32.exe' commandline|contains: 'davsetcookie'
<li><a href="#">detection: selection: path: \\\*\ipc$ name: atsvc #accesses: '*writedata*'
<li><a href="#">detection: selection: path|contains|all: - '\' - 'admin$' name|contains: 'system32\' name|endswith: '.tmp'
<li><a href="#">detection: selection: path|endswith: ipc$ name: spoolss
<li><a href="#">detection: selection: payload|contains|all: - 'get-addbaccount' - 'bootkey ' - 'databasepath '
<li><a href="#">detection: selection: pipename: - '\atctl' # - '\userpipe' # ruag apt case - '\iehelper' # ruag apt case - '\sdlrpc' # project cobra - '\comnap' # # - '\rpc' # may cause too many false positives :
<li><a href="#">detection: selection: pipename: - '\isapi_http' # uroburos malware - '\isapi_dg' # uroburos malware - '\isapi_dg2' # uroburos malware - '\sdlrpc' # cobra trojan - '\ahexec' # sofacy group malware - '\winsession' # wild neutron apt malware - '\lsassw' # wild neutron apt malware - '\46a676ab7f179e511e30dd2dc41bd388' # project sauron - '\9f81f59bc58452127884ce513865ed20' # project sauron - '\e710f28d59aa529d6792ca6ff0ca1b34' # project sauron - '\rpchlp_3' # project sauron - '\namepipe_morewindows' # cloud hopper - redleaves - '\pcheap_reuse' # pipe used by equation group malware - '\gruntsvc' # covenant default # - '\status_*' # cs default - '\583da945-62af-10e8-4902-a8f205c72b2e' # solarwinds sunburst malware - '\bizkaz' # snatch ransomware - '\svcctl' #crackmapexec smbexec default - '\posh*' #poshc2 default - '\jaccdpqnvbrrxlaf' #poshc2 default - '\csexecsvc' #csexec default - '\6e7645c4-32c5-4fe3-aabf-e94c2f4370e7' # liquidsnake - '\adschemerpc' # turla hyperstack - '\anonymouspipe' # hidden cobra hoplight - '\bc367' # pacifier - '\bc31a7' # pacifier - '\testpipe' # emissary panda hyperbro - '\dce_3d' #qbot
<li><a href="#">detection: selection: pipename: '\microsoft##wid\tsql\query' filter: image|endswith: - '\microsoft.identityserver.servicehost.exe' - '\microsoft.identity.health.adfs.pshsurrogate.exe' - '\azureadconnect.exe' - '\microsoft.tri.sensor.exe' - '\wsmprovhost.exe' - '\mmc.exe' - '\sqlservr.exe' - '\tssdis.exe'
<li><a href="#">detection: selection: pipename: '\psexesvc'
<li><a href="#">detection: selection: pipename|contains: - '\lsadump' - '\cachedump' - '\wceservicepipe'
<li><a href="#">detection: selection: pipename|contains: - '\pipe\' - '\pipe\srvsvc' # more specific version (use only this one of the other causes too many false positives) filter: pipename|contains: '\ctxshare'
<li><a href="#">detection: selection: pipename|startswith: - 'psexec' - 'paexec' - 'remcom' - 'csexec'
<li><a href="#">detection: selection: pipename|startswith: '\pshost'
<li><a href="#">detection: selection: pipename|startswith: '\pshost' filter1: image|endswith: - '\powershell.exe' - '\powershell_ise.exe' - '\windows\system32\sdiagnhost.exe' - '\windows\system32\wsmprovhost.exe' - '\windows\system32\dsac.exe' - '\windows\system32\wbem\wmiprvse.exe' - '\forefrontactivedirectoryconnector.exe' - 'c:\windows\system32\inetsrv\w3wp.exe' # this is sad :,( but it triggers fps on exchange servers filter2: image: null filter3: # microsoft sql server\130\tools\ image|contains|all: - ':\program files' - '\microsoft sql server\' image|endswith: '\tools\binn\sqlps.exe' filter4: image|startswith: - 'c:\program files\citrix\' - 'c:\program files\microsoft\exchange server\' filter5: image: 'c:\windows\system32\servermanager.exe'
<li><a href="#">detection: selection: product: - 'sysinternals debugview' - 'sysinternals debugview' filter: originalfilename: 'dbgview.exe' image|endswith: '\dbgview.exe'
<li><a href="#">detection: selection: properties.message: - delete application - hard delete application
<li><a href="#">detection: selection: properties.message: - delete device - delete device configuration - update device - update device configuration
<li><a href="#">detection: selection: properties.message: - device no longer compliant - device no longer managed
<li><a href="#">detection: selection: properties.message: - microsoft.containerregistry/registries/write - microsoft.containerregistry/registries/delete
<li><a href="#">detection: selection: properties.message: - microsoft.keyvault/vaults/keys/update/action - microsoft.keyvault/vaults/keys/create - microsoft.keyvault/vaults/keys/create/action - microsoft.keyvault/vaults/keys/import/action - microsoft.keyvault/vaults/keys/recover/action - microsoft.keyvault/vaults/keys/restore/action - microsoft.keyvault/vaults/keys/delete - microsoft.keyvault/vaults/keys/backup/action - microsoft.keyvault/vaults/keys/purge/action
<li><a href="#">detection: selection: properties.message: - microsoft.keyvault/vaults/secrets/write - microsoft.keyvault/vaults/secrets/delete - microsoft.keyvault/vaults/secrets/backup/action - microsoft.keyvault/vaults/secrets/purge/action - microsoft.keyvault/vaults/secrets/update/action - microsoft.keyvault/vaults/secrets/recover/action - microsoft.keyvault/vaults/secrets/restore/action - microsoft.keyvault/vaults/secrets/setsecret/action
<li><a href="#">detection: selection: properties.message: - microsoft.keyvault/vaults/write - microsoft.keyvault/vaults/delete - microsoft.keyvault/vaults/deploy/action - microsoft.keyvault/vaults/accesspolicies/write
<li><a href="#">detection: selection: properties.message: - microsoft.kubernetes/connectedclusters/configmaps/write - microsoft.kubernetes/connectedclusters/configmaps/delete - microsoft.kubernetes/connectedclusters/secrets/write - microsoft.kubernetes/connectedclusters/secrets/delete
<li><a href="#">detection: selection: properties.message: - microsoft.kubernetes/connectedclusters/networking.k8s.io/networkpolicies/write - microsoft.kubernetes/connectedclusters/networking.k8s.io/networkpolicies/delete - microsoft.kubernetes/connectedclusters/extensions/networkpolicies/write - microsoft.kubernetes/connectedclusters/extensions/networkpolicies/delete
<li><a href="#">detection: selection: properties.message: - microsoft.kubernetes/connectedclusters/rbac.authorization.k8s.io/clusterrolebindings/write - microsoft.kubernetes/connectedclusters/rbac.authorization.k8s.io/clusterrolebindings/delete - microsoft.kubernetes/connectedclusters/rbac.authorization.k8s.io/rolebindings/write - microsoft.kubernetes/connectedclusters/rbac.authorization.k8s.io/rolebindings/delete
<li><a href="#">detection: selection: properties.message: - microsoft.kubernetes/connectedclusters/rbac.authorization.k8s.io/roles/write - microsoft.kubernetes/connectedclusters/rbac.authorization.k8s.io/roles/delete - microsoft.kubernetes/connectedclusters/rbac.authorization.k8s.io/roles/bind/action - microsoft.kubernetes/connectedclusters/rbac.authorization.k8s.io/roles/escalate/action - microsoft.kubernetes/connectedclusters/rbac.authorization.k8s.io/clusterroles/write - microsoft.kubernetes/connectedclusters/rbac.authorization.k8s.io/clusterroles/delete - microsoft.kubernetes/connectedclusters/rbac.authorization.k8s.io/clusterroles/bind/action - microsoft.kubernetes/connectedclusters/rbac.authorization.k8s.io/clusterroles/escalate/action
<li><a href="#">detection: selection: properties.message: - microsoft.kubernetes/connectedclusters/serviceaccounts/write - microsoft.kubernetes/connectedclusters/serviceaccounts/delete - microsoft.kubernetes/connectedclusters/serviceaccounts/impersonate/action
<li><a href="#">detection: selection: properties.message: - microsoft.kubernetes/connectedclusters/write - microsoft.kubernetes/connectedclusters/delete
<li><a href="#">detection: selection: properties.message: - microsoft.network/applicationgateways/write - microsoft.network/applicationgateways/delete
<li><a href="#">detection: selection: properties.message: - microsoft.network/applicationsecuritygroups/write - microsoft.network/applicationsecuritygroups/delete
<li><a href="#">detection: selection: properties.message: - microsoft.network/azurefirewalls/applicationrulecollections/write - microsoft.network/azurefirewalls/applicationrulecollections/delete - microsoft.network/azurefirewalls/natrulecollections/write - microsoft.network/azurefirewalls/natrulecollections/delete - microsoft.network/azurefirewalls/networkrulecollections/write - microsoft.network/azurefirewalls/networkrulecollections/delete
<li><a href="#">detection: selection: properties.message: - microsoft.network/azurefirewalls/write - microsoft.network/azurefirewalls/delete
<li><a href="#">detection: selection: properties.message: - microsoft.network/firewallpolicies/rulecollectiongroups/write - microsoft.network/firewallpolicies/rulecollectiongroups/delete - microsoft.network/firewallpolicies/rulegroups/write - microsoft.network/firewallpolicies/rulegroups/delete
<li><a href="#">detection: selection: properties.message: - microsoft.network/firewallpolicies/write - microsoft.network/firewallpolicies/join/action - microsoft.network/firewallpolicies/certificates/action - microsoft.network/firewallpolicies/delete
<li><a href="#">detection: selection: properties.message: - microsoft.network/networkinterfaces/tapconfigurations/write - microsoft.network/networkinterfaces/tapconfigurations/delete - microsoft.network/networkinterfaces/write - microsoft.network/networkinterfaces/join/action - microsoft.network/networkinterfaces/delete - microsoft.network/networkvirtualappliances/delete - microsoft.network/networkvirtualappliances/write - microsoft.network/virtualhubs/delete - microsoft.network/virtualhubs/write - microsoft.network/virtualrouters/write - microsoft.network/virtualrouters/delete
<li><a href="#">detection: selection: properties.message: - microsoft.network/networksecuritygroups/write - microsoft.network/networksecuritygroups/delete - microsoft.network/networksecuritygroups/securityrules/write - microsoft.network/networksecuritygroups/securityrules/delete - microsoft.network/networksecuritygroups/join/action - microsoft.network/networksecuritygroups/providers/microsoft.insights/diagnosticsettings/write
<li><a href="#">detection: selection: properties.message: - microsoft.network/p2svpngateways/write - microsoft.network/p2svpngateways/delete - microsoft.network/p2svpngateways/reset/action - microsoft.network/p2svpngateways/generatevpnprofile/action - microsoft.network/p2svpngateways/disconnectp2svpnconnections/action - microsoft.network/p2svpngateways/providers/microsoft.insights/diagnosticsettings/write
<li><a href="#">detection: selection: properties.message: - microsoft.network/vpngateways/vpnconnections/write - microsoft.network/vpngateways/vpnconnections/delete
<li><a href="#">detection: selection: properties.message: - remove owner from service principal - remove owner from application
<li><a href="#">detection: selection: properties.message: - update application - update service principal
<li><a href="#">detection: selection: properties.message: - update application-certificates and secrets management - update service principal/update application
<li><a href="#">detection: selection: properties.message: add owner to application
<li><a href="#">detection: selection: properties.message: 'add service principal'
<li><a href="#">detection: selection: properties.message: device code
<li><a href="#">detection: selection: properties.message: microsoft.portal/consoles/write
<li><a href="#">detection: selection: properties.message: microsoft.security/alertssuppressionrules/write
<li><a href="#">detection: selection: properties.message: remove service principal
<li><a href="#">detection: selection: properties.message: ropc
<li><a href="#">detection: selection: properties.message: 'update application - certificates and secrets management'
<li><a href="#">detection: selection: properties.message: update application sucess- property name appaddress
<li><a href="#">detection: selection: properties.message|startswith: - microsoft.network/virtualnetworkgateways/ - microsoft.network/virtualnetworks/ properties.message|endswith: - /write - /delete
<li><a href="#">detection: selection: properties.message|startswith: microsoft.network/dnszones properties.message|endswith: - /write - /delete
<li><a href="#">detection: selection: provider_name: "lsasrv" eventid: 6038
<li><a href="#">detection: selection: provider_name: 'application popup' eventid: 26 caption: 'sysmon64.exe - application error'
<li><a href="#">detection: selection: provider_name: 'microsoft-windows-audit-cve'
<li><a href="#">detection: selection: provider_name: microsoft-windows-kernel-general eventid: 16 keywords: - '\appdata\local\temp\sam-' - '.dmp'
<li><a href="#">detection: selection: provider_name: microsoft-windows-ntfs eventid: 98 devicename|contains: harddiskvolumeshadowcopy
<li><a href="#">detection: selection: provider_name: microsoft-windows-security-auditing auditsourcename: vssaudit eventid: - 4904 - 4905
<li><a href="#">detection: selection: provider_name: microsoft-windows-security-auditing eventid: 4673 service: 'lsaregisterlogonprocess()' keywords: '0x8010000000000000' #failure
<li><a href="#">detection: selection: provider_name: 'microsoft-windows-security-auditing' eventid: 4697 servicefilename|contains|all: - 'cmd' - '&&' - 'clipboard]::'
<li><a href="#">detection: selection: provider_name: microsoft-windows-security-auditing eventid: 4720
<li><a href="#">detection: selection: provider_name: microsoft-windows-security-auditing eventid: 4732 selection_group1: targetusername|startswith: 'administr' selection_group2: targetsid: 's-1-5-32-544' filter: subjectusername|endswith: '$'
<li><a href="#">detection: selection: provider_name: microsoft-windows-security-auditing eventid: 5145 relativetargetname|contains: - '\mimidrv' - '\lsass' - '\windows\minidump\' - '\hiberfil' - '\sqldmpr' - '\sam' - '\ntds.dit' - '\security'
<li><a href="#">detection: selection: provider_name: microsoft-windows-security-auditing eventid: 5145 relativetargetname|endswith: '\wbem\wbemcomn.dll' filter: subjectusername|endswith: '$'
<li><a href="#">detection: selection: provider_name: microsoft-windows-windowsupdateclient eventid: - 16 # unable to connect: windows is unable to connect to the automatic updates service and therefore cannot download and install updates according to the set schedule - 20 # installation failure: windows failed to install the following update with error - 24 # uninstallation failure: windows failed to uninstall the following update with error - 213 # revert failure: windows failed to revert the following update with error - 217 # commit failure: windows failed to commit the following update with error
<li><a href="#">detection: selection: provider_name: 'msiinstaller' eventid: - 11724 - 1034
<li><a href="#">detection: selection: provider_name: netlogon # active directory: netlogon etw guid {f33959b4-dbec-11d2-895b-00c04f79ab69} eventid: 5829
<li><a href="#">detection: selection: provider_name: ntfs eventid: 55 origin: 'file system driver' description|contains|all: - 'contains a corrupted file record' - 'the name of the file is "\"'
<li><a href="#">detection: selection: provider_name: 'service control manager' eventid: 7045 imagepath|contains: - 'fgexec' - 'dumpsvc' - 'cachedump' - 'mimidrv' - 'gsecdump' - 'servpw' - 'pwdump'
<li><a href="#">detection: selection: provider_name: 'service control manager' eventid: 7045 imagepath|contains: - 'powershell' - 'pwsh'
<li><a href="#">detection: selection: provider_name: 'service control manager' eventid: 7045 imagepath|contains: '&&'
<li><a href="#">detection: selection: provider_name: 'service control manager' eventid: 7045 imagepath|contains: '(clipboard|i'
<li><a href="#">detection: selection: provider_name: 'service control manager' eventid: 7045 imagepath|contains: 'tap0901'
<li><a href="#">detection: selection: provider_name: 'service control manager' eventid: 7045 imagepath|contains|all: - '&&' - 'rundll32' - 'shell32.dll' - 'shellexec_rundll' imagepath|contains: - 'value' - 'invoke' - 'comspec' - 'iex'
<li><a href="#">detection: selection: provider_name: 'service control manager' eventid: 7045 imagepath|contains|all: - 'cmd' - 'clip' - 'clipboard]::'
<li><a href="#">detection: selection: provider_name: 'service control manager' eventid: 7045 imagepath|contains|all: - 'mshta' - 'vbscript:createobject'
<li><a href="#">detection: selection: provider_name: 'service control manager' eventid: 7045 imagepath|contains|all: - 'new-object' - 'text.encoding]::ascii' - 'readtoend' imagepath|contains: - ':system.io.compression.deflatestream' - 'system.io.streamreader'
<li><a href="#">detection: selection: provider_name: 'service control manager' eventid: 7045 imagepath|contains|all: - 'rundll32.exe' - 'shell32.dll' - 'shellexec_rundll' - 'powershell'
<li><a href="#">detection: selection: provider_name: 'service control manager' eventid: 7045 imagepath|re: '(?i).*&&set.*(\{\d\}){2,}\\\"\s+?\-f.*&&.*cmd.*\/c' # fps with |\/r
<li><a href="#">detection: selection: provider_name: 'service control manager' eventid: 7045 imagepath|re: '(?i).*(set).*&&\s?set.*(environment|invoke).*&&.*"'
<li><a href="#">detection: selection: provider_name: 'service control manager' eventid: 7045 imagepath|re: '.*cmd.{0,5}(?:\/c|\/r)(?:\s|)\"set\s[a-za-z]{3,6}.*(?:\{\d\}){1,}\\\"\s+?\-f(?:.*\)){1,}.*\"'
<li><a href="#">detection: selection: provider_name: 'service control manager' eventid: 7045 imagepath|re: '.*cmd.{0,5}(?:\/c|\/r).+powershell.+(?:\$\{?input\}?|noexit).+\"'
<li><a href="#">detection: selection: provider_name: 'service control manager' eventid: 7045 servicename: - 'srservice' - 'ipvpn' - 'hkmsvc'
<li><a href="#">detection: selection: provider_name: 'service control manager' eventid: 7045 servicename: 'btobto' imagepath|endswith: '\execute.bat'
<li><a href="#">detection: selection: provider_name: 'service control manager' eventid: 7045 servicename: ntssrv imagepath|endswith: ' localservice'
<li><a href="#">detection: selection: provider_name: 'service control manager' eventid: 7045 servicename: 'werfaultsvc'
<li><a href="#">detection: selection: provider_name: 'service control manager' eventid: 7045 servicename: zznetsvc
<li><a href="#">detection: selection: provider_name: 'service control manager' eventid: 7045 servicename|startswith: 'processhacker' accountname: 'localsystem'
<li><a href="#">detection: selection: provider_name: 'service control manager' eventid: 7045 suspicious1: - imagepath|re: '^[cc]:\\[pp]rogram[dd]ata\\.{1,9}\.exe' - imagepath|re: '^[cc]:\\.{1,9}\.exe'
<li><a href="#">detection: selection: provider_name: 'service control manager' eventid: 7045 suspicious1: imagepath|contains: - ' -w hidden ' - ' -nop ' - ' -sta ' - '\users\public\' - '\windows\temp\' - '\perflogs\' - '\\\\.\\pipe' - '\admin$\' - '.downloadstring(' # powershell download command - '.downloadfile(' # powershell download command suspicious2a: imagepath|contains: ' -e' suspicious2b: imagepath|contains: - ' jab' # powershell encoded commands - ' suvyi' # powershell encoded commands - ' sqbfafga' # powershell encoded commands - ' awv4i' # powershell encoded commands - ' iab' # powershell encoded commands - ' paa' # powershell encoded commands - ' aqblahga' # powershell encoded commands filter_thor_remote: imagepath|startswith: 'c:\windows\temp\thor10-remote\thor64.exe'
<li><a href="#">detection: selection: provider_name: 'service control manager' eventid: 7045 suspicious1: imagepath|contains: ' /c ' suspicious2: imagepath|contains: - 'powershell' - 'wscript' - 'cscript' - 'mshta' - 'rundll32'
<li><a href="#">detection: selection: provider_name: 'service control manager' eventid: 7045 suspicious1: imagepath|contains: - '\appdata\' - '\\\\127.0.0.1' - '\\\\localhost'
<li><a href="#">detection: selection: provider_name: 'service control manager' eventid: 7045 timeframe: 7d
<li><a href="#">detection: selection: providername: wsman filter: hostapplication|contains: powershell
<li><a href="#">detection: selection: query: - 'ifferfsodp9ifjaposdfjhgosurijfaewrwergwea.testing' - 'ifferfsodp9ifjaposdfjhgosurijfaewrwergwea.test' - 'ifferfsodp9ifjaposdfjhgosurijfaewrwergwea.com' - 'ayylmaotjhsstasdfasdfasdfasdfasdfasdfasdf.com' - 'iuqssfsodp9ifjaposdfjhgosurijfaewrwergwea.com'
<li><a href="#">detection: selection: query: - 'tor2web.org' - 'tor2web.com' - 'torlink.co' - 'onion.to' - 'onion.ink' - 'onion.cab' - 'onion.nu' - 'onion.link' - 'onion.it' - 'onion.city' - 'onion.direct' - 'onion.top' - 'onion.casa' - 'onion.plus' - 'onion.rip' - 'onion.dog' - 'tor2web.fi' - 'tor2web.blutmagie.de' - 'onion.sh' - 'onion.lu' - 'onion.pet' - 't2w.pw' - 'tor2web.ae.org' - 'tor2web.io' - 'tor2web.xyz' - 'onion.lt' - 's1.tor-gateways.de' - 's2.tor-gateways.de' - 's3.tor-gateways.de' - 's4.tor-gateways.de' - 's5.tor-gateways.de' - 'hiddenservice.net'
<li><a href="#">detection: selection: query: 'api.telegram.org' # telegram bot api request
<li><a href="#">detection: selection: query|contains: - '.interact.sh' - '.oast.pro' - '.oast.live' - '.oast.site' - '.oast.online' - '.oast.fun' - '.oast.me' - '.burpcollaborator.net' - '.oastify.com' - '.canarytokens.com' - '.requestbin.net' - '.dnslog.cn'
<li><a href="#">detection: selection: query|contains: - 'pool.minexmr.com' - 'fr.minexmr.com' - 'de.minexmr.com' - 'sg.minexmr.com' - 'ca.minexmr.com' - 'us-west.minexmr.com' - 'pool.supportxmr.com' - 'mine.c3pool.com' - 'xmr-eu1.nanopool.org' - 'xmr-eu2.nanopool.org' - 'xmr-us-east1.nanopool.org' - 'xmr-us-west1.nanopool.org' - 'xmr-asia1.nanopool.org' - 'xmr-jp1.nanopool.org' - 'xmr-au1.nanopool.org' - 'xmr.2miners.com' - 'xmr.hashcity.org' - 'xmr.f2pool.com' - 'xmrpool.eu' - 'pool.hashvault.pro'
<li><a href="#">detection: selection: query|contains: '==.'
<li><a href="#">detection: selection: query|contains|all: - 'seed' - '.nkn.org'
<li><a href="#">detection: selection: query|endswith: - 'monerohash.com' - 'do-dear.com' - 'xmrminerpro.com' - 'secumine.net' - 'xmrpool.com' - 'minexmr.org' - 'hashanywhere.com' - 'xmrget.com' - 'mininglottery.eu' - 'minergate.com' - 'moriaxmr.com' - 'multipooler.com' - 'moneropools.com' - 'xmrpool.eu' - 'coolmining.club' - 'supportxmr.com' - 'minexmr.com' - 'hashvault.pro' - 'xmrpool.net' - 'crypto-pool.fr' - 'xmr.pt' - 'miner.rocks' - 'walpool.com' - 'herominers.com' - 'gntl.co.uk' - 'semipool.com' - 'coinfoundry.org' - 'cryptoknight.cc' - 'fairhash.org' - 'baikalmine.com' - 'tubepool.xyz' - 'fairpool.xyz' - 'asiapool.io' - 'coinpoolit.webhop.me' - 'nanopool.org' - 'moneropool.com' - 'miner.center' - 'prohash.net' - 'poolto.be' - 'cryptoescrow.eu' - 'monerominers.net' - 'cryptonotepool.org' - 'extrmepool.org' - 'webcoin.me' - 'kippo.eu' - 'hashinvest.ws' - 'monero.farm' - 'linux-repository-updates.com' - '1gh.com' - 'dwarfpool.com' - 'hash-to-coins.com' - 'pool-proxy.com' - 'hashfor.cash' - 'fairpool.cloud' - 'litecoinpool.org' - 'mineshaft.ml' - 'abcxyz.stream' - 'moneropool.ru' - 'cryptonotepool.org.uk' - 'extremepool.org' - 'extremehash.com' - 'hashinvest.net' - 'unipool.pro' - 'crypto-pools.org' - 'monero.net' - 'backup-pool.com' - 'mooo.com' # dynamic dns, may want to exclude - 'freeyy.me' - 'cryptonight.net' - 'shscrypto.net' exclude_answers: answers: - '127.0.0.1' - '0.0.0.0' exclude_rejected: rejected: 'true'
<li><a href="#">detection: selection: queryname|contains: '.onion'
<li><a href="#">detection: selection: queryname|contains: servicebus.windows.net image|contains: hybridconnectionmanager
<li><a href="#">detection: selection: queryname|contains: ufile.io
<li><a href="#">detection: selection: queryname|contains: userstorage.mega.co.nz
<li><a href="#">detection: selection: queryname|endswith: '.ammyy.com'
<li><a href="#">detection: selection: queryname|endswith: '.getgo.com'
<li><a href="#">detection: selection: queryname|endswith: '.logmein.com'
<li><a href="#">detection: selection: r-dns: 'api.telegram.org' # often used by bots filter: c-useragent|contains: # used for this list - 'telegram' - 'bot'
<li><a href="#">detection: selection: record_type: 'null' timeframe: 1m
<li><a href="#">detection: selection: record_type: 'txt' answer|contains: - 'iex' - 'invoke-expression' - 'cmd.exe'
<li><a href="#">detection: selection: record_type: 'txt' timeframe: 1m
<li><a href="#">detection: selection: request_type: 'tgs' cipher: 'rc4-hmac' computer_acct: service|startswith: '$'
<li><a href="#">detection: selection: resourcedisplayname: 'device registration service' conditionalaccessstatus: 'success' filter_mfa: authenticationrequirement: 'multifactorauthentication'
<li><a href="#">detection: selection: resulttype: 50057 resultdescription: failure
<li><a href="#">detection: selection: resulttype: 50057 resultdescription: 'user account is disabled. the account has been disabled by an administrator.'
<li><a href="#">detection: selection: resulttype: 50074 resultdescription|contains: 'strong auth required' selection1: resulttype: 500121 resultdescription|contains: 'authentication failed during strong authentication request'
<li><a href="#">detection: selection: resulttype: 50126 resultdescription: invalid username or password or invalid on-premises username or password. filter_computer: targetusername|endswith: '$'
<li><a href="#">detection: selection: resulttype: 53003 resultdescription: blocked by conditional access
<li><a href="#">detection: selection: scriptblocktext|contains: - '[system.environment]::username' - '$env:username' - '[system.security.principal.windowsidentity]::getcurrent()'
<li><a href="#">detection: selection: scriptblocktext|contains: - add-constraineddelegationbackdoor - set-dcshadowpermissions - dns_txt_pwnage - execute-ontime - http-backdoor - set-remotepsremoting - set-remotewmi - invoke-amsibypass - out-chm - out-hta - out-scf - out-sct - out-shortcut - out-webquery - out-word - enable-duplication - remove-update - download-execute-ps - download_execute - execute-command-mssql - execute-dnstxt-code - out-rundllcommand - copy-vss - firebuster - firelistener - get-information - get-passhints - get-wlan-keys - get-web-credentials - invoke-credentialsphish - invoke-mimikatzwdigestdowngrade - invoke-ssidexfil - invoke-sessiongopher - keylogger - invoke-interceptor - create-multiplesessions - invoke-networkrelay - run-exeonremote - invoke-prasadhak - invoke-bruteforce - password-list - invoke-jsratregsvr - invoke-jsratrundll - invoke-poshrathttps - invoke-powershellicmp - invoke-powershelludp - invoke-psgcat - invoke-psgcatagent - remove-poshrat - add-persistance - exetotext - invoke-decode - invoke-encode - parse_keys - remove-persistence - stringtobase64 - texttoexe - powerpreter - nishang - datatoencode - loggedkeys - out-dnstxt # - jitter # prone to fps - exfiloption - dumpcerts - dumpcreds - shellcode32 - shellcode64 - notallnamespaces - exfill - fakedc
<li><a href="#">detection: selection: scriptblocktext|contains: - 'adjusttokenprivileges' - 'image_nt_optional_hdr64_magic' - 'microsoft.win32.unsafenativemethods' - 'readprocessmemory.invoke' - 'se_privilege_enabled' - 'lsa_unicode_string' - 'minidumpwritedump' - 'page_execute_read' - 'security_delegation' - 'token_adjust_privileges' - 'token_all_access' - 'token_assign_primary' - 'token_duplicate' - 'token_elevation' - 'token_impersonate' - 'token_information_class' - 'token_privileges' - 'token_query' - 'metasploit' - 'mimikatz'
<li><a href="#">detection: selection: scriptblocktext|contains: - 'cl_invocation.ps1' - 'syncinvoke'
<li><a href="#">detection: selection: scriptblocktext|contains: - 'cl_mutexverifiers.ps1' - 'runaftercancelprocess'
<li><a href="#">detection: selection: scriptblocktext|contains: - 'disable-localuser' - 'enable-localuser' - 'get-localuser' - 'set-localuser' - 'new-localuser' - 'rename-localuser' - 'remove-localuser'
<li><a href="#">detection: selection: scriptblocktext|contains: - export-powerviewcsv - get-ipaddress - resolve-ipaddress - convert-nametosid - convertto-sid - convert-adname - convertfrom-uacvalue - add-remoteconnection - remove-remoteconnection - invoke-userimpersonation - invoke-reverttoself - request-spnticket - get-domainspnticket - invoke-kerberoast - get-pathacl - get-dnszone - get-domaindnszone - get-dnsrecord - get-domaindnsrecord - get-netdomain - get-domain - get-netdomaincontroller - get-domaincontroller - get-netforest - get-forest - get-netforestdomain - get-forestdomain - get-netforestcatalog - get-forestglobalcatalog - find-domainobjectpropertyoutlier - get-netuser - get-domainuser - new-domainuser - set-domainuserpassword - get-userevent - get-domainuserevent - get-netcomputer - get-domaincomputer - get-adobject - get-domainobject - set-adobject - set-domainobject - get-objectacl - get-domainobjectacl - add-objectacl - add-domainobjectacl - invoke-aclscanner - find-interestingdomainacl - get-netou - get-domainou - get-netsite - get-domainsite - get-netsubnet - get-domainsubnet - get-domainsid - get-netgroup - get-domaingroup - new-domaingroup - find-managedsecuritygroups - get-domainmanagedsecuritygroup - get-netgroupmember - get-domaingroupmember - add-domaingroupmember - get-netfileserver - get-domainfileserver - get-dfsshare - get-domaindfsshare - get-netgpo - get-domaingpo - get-netgpogroup - get-domaingpolocalgroup - find-gpolocation - get-domaingpouserlocalgroupmapping - find-gpocomputeradmin - get-domaingpocomputerlocalgroupmapping - get-domainpolicy - get-netlocalgroup - get-netlocalgroupmember - get-netshare - get-netloggedon - get-netsession - get-loggedonlocal - get-regloggedon - get-netrdpsession - invoke-checklocaladminaccess - test-adminaccess - get-sitename - get-netcomputersitename - get-proxy - get-wmiregproxy - get-lastloggedon - get-wmireglastloggedon - get-cachedrdpconnection - get-wmiregcachedrdpconnection - get-registrymounteddrive - get-wmiregmounteddrive - get-netprocess - get-wmiprocess - find-interestingfile - invoke-userhunter - find-domainuserlocation - invoke-processhunter - find-domainprocess - invoke-eventhunter - find-domainuserevent - invoke-sharefinder - find-domainshare - invoke-filefinder - find-interestingdomainsharefile - find-localadminaccess - invoke-enumeratelocaladmin - find-domainlocalgroupmember - get-netdomaintrust - get-domaintrust - get-netforesttrust - get-foresttrust - find-foreignuser - get-domainforeignuser - find-foreigngroup - get-domainforeigngroupmember - invoke-mapdomaintrust - get-domaintrustmapping
<li><a href="#">detection: selection: scriptblocktext|contains: - 'function get-adrexcelcomob' - 'adrecon-report.xlsx' #default
<li><a href="#">detection: selection: scriptblocktext|contains: - 'get-inbox.ps1' - 'microsoft.office.interop.outlook' - 'microsoft.office.interop.outlook.oldefaultfolders' - '-comobject outlook.application'
<li><a href="#">detection: selection: scriptblocktext|contains: - get-wmiobject - gwmi
<li><a href="#">detection: selection: scriptblocktext|contains: - invoke-smbautobrute - invoke-gpolinks - out-minidump - invoke-potato
<li><a href="#">detection: selection: scriptblocktext|contains: - 'invoke-webrequest' - 'iwr ' - 'wget ' - 'curl ' - 'net.webclient' - 'start-bitstransfer'
<li><a href="#">detection: selection: scriptblocktext|contains: - ls - get-childitem - gci recurse: scriptblocktext|contains: '-recurse'
<li><a href="#">detection: selection: scriptblocktext|contains: - new-vm - set-vmfirmware - start-vm
<li><a href="#">detection: selection: scriptblocktext|contains: - 'remove-smbshare' - 'remove-fileshare'
<li><a href="#">detection: selection: scriptblocktext|contains: - 'system.directoryservices.protocols.ldapdirectoryidentifier' - 'system.net.networkcredential' - 'system.directoryservices.protocols.ldapconnection'
<li><a href="#">detection: selection: scriptblocktext|contains: - 'system.reflection.assembly.load($' - '[system.reflection.assembly]::load($' - '[reflection.assembly]::load($' - 'system.reflection.assemblyname' - 'reflection.emit.assemblybuilderaccess' - 'runtime.interopservices.dllimportattribute' - 'suspendthread' - 'rundll32' # - 'frombase64' - 'invoke-wmimethod' - ''
<li><a href="#">detection: selection: scriptblocktext|contains: - 'waitforsingleobject' - 'queueuserapc' - 'rtlcreateuserthread' - 'openprocess' - 'virtualalloc' - 'virtualfree' - 'writeprocessmemory' - 'createuserthread' - 'closehandle' - 'getdelegateforfunctionpointer' - 'createthread' - 'memcpy' - 'loadlibrary' - 'getmodulehandle' - 'getprocaddress' - 'virtualprotect' - 'freelibrary' - 'readprocessmemory' - 'createremotethread' - 'adjusttokenprivileges' # - 'writebyte' # fp with .net system.io.filestream - 'writeint32' - 'openthreadtoken' - 'ptrtostring' - 'freehglobal' - 'zerofreeglobalallocunicode' - 'openprocesstoken' - 'gettokeninformation' - 'setthreadtoken' - 'impersonateloggedonuser' - 'reverttoself' - 'getlogonsessiondata' - 'createprocesswithtoken' - 'duplicatetokenex' - 'openwindowstation' - 'opendesktop' - 'minidumpwritedump' - 'addsecuritypackage' - 'enumeratesecuritypackages' - 'getprocesshandle' - 'dangerousgethandle' - 'kernel32' - 'advapi32' - 'msvcrt' - 'ntdll' # - 'user32' # fp with chocolatey - 'secur32' falsepositive1: scriptblocktext|startswith: '# copyright 2016 amazon.com, inc. or its affiliates.' # aws scripts leverage createfile and closehandle may filter out these 2 items
<li><a href="#">detection: selection: scriptblocktext|contains: - 'wmimplant' - ' change_user ' - ' gen_cli ' - ' command_exec ' - ' disable_wdigest ' - ' disable_winrm ' - ' enable_wdigest ' - ' enable_winrm ' - ' registry_mod ' - ' remote_posh ' - ' sched_job ' - ' service_mod ' - ' process_kill ' # - ' process_start ' - ' active_users ' - ' basic_info ' # - ' drive_list ' # - ' installed_programs ' - ' power_off ' - ' vacant_system ' - ' logon_events '
<li><a href="#">detection: selection: scriptblocktext|contains: '.copyfromscreen'
<li><a href="#">detection: selection: scriptblocktext|contains: 'aaaayinlm' selection2: scriptblocktext|contains: - 'oicaaaayinlm' - 'oijaaaayinlm'
<li><a href="#">detection: selection: scriptblocktext|contains: 'currentversion\winlogon' selection2: scriptblocktext|contains: - 'set-itemproperty' - 'new-item'
<li><a href="#">detection: selection: scriptblocktext|contains: 'export-pfxcertificate'
<li><a href="#">detection: selection: scriptblocktext|contains: get-addefaultdomainpasswordpolicy
<li><a href="#">detection: selection: scriptblocktext|contains: get-gpo
<li><a href="#">detection: selection: scriptblocktext|contains: get-process
<li><a href="#">detection: selection: scriptblocktext|contains: 'get-process lsass'
<li><a href="#">detection: selection: scriptblocktext|contains: get-smbshare
<li><a href="#">detection: selection: scriptblocktext|contains: invoke-azurehound
<li><a href="#">detection: selection: scriptblocktext|contains: invoke-nightmare
<li><a href="#">detection: selection: scriptblocktext|contains: 'new-localuser'
<li><a href="#">detection: selection: scriptblocktext|contains: 'promptforcredential'
<li><a href="#">detection: selection: scriptblocktext|contains: 'ps attack!!!'
<li><a href="#">detection: selection: scriptblocktext|contains: 'start-dnscat2'
<li><a href="#">detection: selection: scriptblocktext|contains: 'syncappvpublishingserver.exe'
<li><a href="#">detection: selection: scriptblocktext|contains: system.directoryservices.accountmanagement
<li><a href="#">detection: selection: scriptblocktext|contains: system.identitymodel.tokens.kerberosrequestorsecuritytoken
<li><a href="#">detection: selection: scriptblocktext|contains: win32_pnpentity
<li><a href="#">detection: selection: scriptblocktext|contains|all: - '$env:cor_enable_profiling' - '$env:cor_profiler' - '$env:cor_profiler_path'
<li><a href="#">detection: selection: scriptblocktext|contains|all: - '::gettypefromclsid(' - '.shellexecute('
<li><a href="#">detection: selection: scriptblocktext|contains|all: - 'add-content' - '$profile' - '-value' scriptblocktext|contains: - 'start-process' - '""' #cleanup action
<li><a href="#">detection: selection: scriptblocktext|contains|all: - 'cl_invocation.ps1' - 'syncinvoke'
<li><a href="#">detection: selection: scriptblocktext|contains|all: - 'cl_mutexverifiers.ps1' - 'runaftercancelprocess'
<li><a href="#">detection: selection: scriptblocktext|contains|all: - 'copy-item ' - '-destination ' - '\windows\system32'
<li><a href="#">detection: selection: scriptblocktext|contains|all: - foreach - get-childitem - '-path ' - '-erroraction ' - silentlycontinue - 'out-file ' - '-append'
<li><a href="#">detection: selection: scriptblocktext|contains|all: - 'get-acl' - 'registry::hklm\system\currentcontrolset\services\'
<li><a href="#">detection: selection: scriptblocktext|contains|all: - 'get-adcomputer ' - '-filter'
<li><a href="#">detection: selection: scriptblocktext|contains|all: - 'get-adgroup ' - '-filter'
<li><a href="#">detection: selection: scriptblocktext|contains|all: - get-adreplaccount - '-all ' - '-server '
<li><a href="#">detection: selection: scriptblocktext|contains|all: - 'get-childitem' - ' -recurse ' - ' -path ' - ' -filter bookmarks' - ' -erroraction silentlycontinue' - ' -force'
<li><a href="#">detection: selection: scriptblocktext|contains|all: - 'get-storagediagnosticinfo' - '-includelivedump'
<li><a href="#">detection: selection: scriptblocktext|contains|all: - 'get-wmiobject' - 'win32_shadowcopy' - '.delete()'
<li><a href="#">detection: selection: scriptblocktext|contains|all: - 'invoke-cimmethod ' - '-classname ' - 'win32_product ' - '-methodname ' - '.msi'
<li><a href="#">detection: selection: scriptblocktext|contains|all: - 'invoke-troubleshootingpack' - 'c:\windows\diagnostics\system\pcw' - '-answerfile' - '-unattended'
<li><a href="#">detection: selection: scriptblocktext|contains|all: - invoke-webrequest - '-useragent '
<li><a href="#">detection: selection: scriptblocktext|contains|all: - ls - ' -r' - 'select-string ' - '-pattern '
<li><a href="#">detection: selection: scriptblocktext|contains|all: - 'mount-diskimage ' - '-imagepath '
<li><a href="#">detection: selection: scriptblocktext|contains|all: - 'mount-diskimage ' - '-imagepath ' - get-volume - '.driveletter' - 'invoke-item ' - '):\'
<li><a href="#">detection: selection: scriptblocktext|contains|all: - 'new-object ' - '-comobject ' - '.application' - '.registerxll'
<li><a href="#">detection: selection: scriptblocktext|contains|all: - 'new-object ' - 'system.directoryservices.directorysearcher' - '.propertiestoload.add' - '.findall()' - 'properties.name'
<li><a href="#">detection: selection: scriptblocktext|contains|all: - 'new-object' - '-comobject' - 'msxml2.' - 'xmlhttp'
<li><a href="#">detection: selection: scriptblocktext|contains|all: - new-object - io.filestream - '\\\\.\\'
<li><a href="#">detection: selection: scriptblocktext|contains|all: - 'new-object' - 'system.net.networkinformation.ping' - '.send('
<li><a href="#">detection: selection: scriptblocktext|contains|all: - 'new-psdrive' - '-psprovider ' - 'filesystem' - '-root ' - '\\' - '$'
<li><a href="#">detection: selection: scriptblocktext|contains|all: - new-pssession - '-computername '
<li><a href="#">detection: selection: scriptblocktext|contains|all: - 'powershell' - 'windowstyle' - 'hidden'
<li><a href="#">detection: selection: scriptblocktext|contains|all: - '-recurse' - '|' - 'compress-archive'
<li><a href="#">detection: selection: scriptblocktext|contains|all: - 'remove-adgroupmember' - '-identity ' - '-members '
<li><a href="#">detection: selection: scriptblocktext|contains|all: - remove-item - '-path ' filter_reg: scriptblocktext|contains: - 'hkcu:\' - 'hklm:\'
<li><a href="#">detection: selection: scriptblocktext|contains|all: - set-netfirewallprofile - -profile - -enabled - 'false'
<li><a href="#">detection: selection: scriptblocktext|contains|all: - start-process - '-passthru ' - '-filepath '
<li><a href="#">detection: selection: scriptblocktext|contains|all: - system.net.security.sslstream - net.security.remotecertificatevalidationcallback - '.authenticateasclient'
<li><a href="#">detection: selection: scriptblocktext|contains|all: - test-netconnection - '-computername ' - '-port ' filter: scriptblocktext|contains: - ' 443 ' - ' 80 '
<li><a href="#">detection: selection: scriptblocktext|contains|all: - 'unblock-file ' - '-path '
<li><a href="#">detection: selection: scriptblocktext|contains|all: - 'win32_quickfixengineering' - 'hotfixid'
<li><a href="#">detection: selection: scriptblocktext|contains|all: - win32_shadowcopy - ').create(' - clientaccessible
<li><a href="#">detection: selection: scriptblocktext|contains|all: # example: get-itemproperty hklm:\software\microsoft\windows\currentversion\uninstall\* | select-object displayname, displayversion, publisher, installdate | format-table -autosize - 'get-itemproperty' - '\software\' - 'select-object' - 'format-table'
<li><a href="#">detection: selection: sc-status: - 400 - 401 - 403 - 500 timeframe: 10m
<li><a href="#">detection: selection: sha1: - '53a44c2396d15c3a03723fa5e5db54cafd527635' - '9c5e496921e3bc882dc40694f1dcc3746a75db19' - 'aeb573accfd95758550cf30bf04f389a92922844' - '79ef78a797403a4ed1a616c68e07fff868a8650a' - '4f6f38b4cec35e895d91c052b1f5a83d665c2196' - '1e8c2cac2e4ce7cbd33c3858eb2e24531cb8a84d' - 'e841a63e47361a572db9a7334af459ddca11347a' - 'c28f606df28a9bc8df75a4d5e5837fc5522dd34d' - '2e94b305d6812a9f96e6781c888e48c7fb157b6b' - 'dd44133716b8a241957b912fa6a02efde3ce3025' - '8793bf166cb89eb55f0593404e4e933ab605e803' - 'a39b57032dbb2335499a51e13470a7cd5d86b138' - '41cc2b15c662bc001c0eb92f6cc222934f0beeea' - 'd209430d6af54792371174e70e27dd11d3def7a7' - '1c6452026c56efd2c94cea7e0f671eb55515edb0' - 'c6b41d3afdcdcaf9f442bbe772f5da871801fd5a' - '4923d460e22fbbf165bbbaba168e5a46b8157d9f' - 'f201504bd96e81d0d350c3a8332593ee1c9e09de' - 'ddd2db1127632a2a52943a2fe516a2e7d05d70d2'
<li><a href="#">detection: selection: signature|contains: - 'dumpcreds' - 'mimikatz' - 'pwcrack' - 'htool/wce' - 'pswtool' - 'pwdump' - 'securitytool' - 'pshlspy' - 'rubeus' - 'kekeo' - 'lsassdump' - 'outflank' - 'dumplsass'
<li><a href="#">detection: selection: signature|contains: - 'metetool' - 'mpreter' - 'meterpreter' - 'metasploit' - 'powersploit' - 'cobaltstrike' - 'swrort' - 'rozena' - 'backdoor.cobalt' - 'cobaltstr' - 'cobeacon' - 'cometer' - 'razy' - 'iisexchgspawncmd' - 'exploit.script.cve'
<li><a href="#">detection: selection: signature|contains: - 'ransom' - 'filecoder'
<li><a href="#">detection: selection: sourceimage|contains: ':\windows\syswow64\' grantedaccess: '0x1fffff' calltrace|startswith: 'unknown(0000000000000000)|unknown(0000000000000000)|'
<li><a href="#">detection: selection: sourceimage|endswith: - '\bash.exe' - '\cvtres.exe' - '\defrag.exe' - '\dnx.exe' - '\esentutl.exe' - '\excel.exe' - '\expand.exe' - '\explorer.exe' - '\find.exe' - '\findstr.exe' - '\forfiles.exe' - '\git.exe' - '\gpupdate.exe' - '\hh.exe' - '\iexplore.exe' - '\installutil.exe' - '\lync.exe' - '\makecab.exe' - '\mdnsresponder.exe' - '\monitoringhost.exe' - '\msbuild.exe' - '\mshta.exe' - '\msiexec.exe' - '\mspaint.exe' - '\outlook.exe' - '\ping.exe' - '\powerpnt.exe' - '\powershell.exe' - '\provtool.exe' - '\python.exe' - '\regsvr32.exe' - '\robocopy.exe' - '\runonce.exe' - '\sapcimc.exe' - '\schtasks.exe' - '\smartscreen.exe' - '\spoolsv.exe' # - '\taskhost.exe' # disabled due to false positives - '\tstheme.exe' - '\userinit.exe' - '\vssadmin.exe' - '\vssvc.exe' - '\w3wp.exe' - '\winlogon.exe' - '\winscp.exe' - '\wmic.exe' - '\word.exe' - '\wscript.exe' filter1: sourceimage|contains: 'visual studio' filter2: sourceimage: 'c:\windows\system32\winlogon.exe' targetimage: - 'c:\windows\system32\services.exe' # happens on windows 7 - 'c:\windows\system32\wininit.exe' # happens on windows 7 - 'c:\windows\system32\csrss.exe' # multiple os filter3: sourceimage: 'c:\windows\system32\provtool.exe' targetparentprocessid: 0 filter4: sourceimage|endswith: '\git.exe' targetimage|endswith: - '\bin\git.exe' - 'c:\windows\system32\conhost.exe'
<li><a href="#">detection: selection: sourceimage|endswith: - '\system32\cscript.exe' - '\system32\wscript.exe' - '\system32\mshta.exe' - '\winword.exe' - '\excel.exe' targetimage|contains: '\syswow64\' startmodule: null
<li><a href="#">detection: selection: sourceimage|endswith: '\powershell.exe'
<li><a href="#">detection: selection: sourceimage|endswith: '\powershell.exe' targetimage|endswith: '\rundll32.exe'
<li><a href="#">detection: selection: sourceimage|endswith: '\ttdinject.exe'
<li><a href="#">detection: selection: sourceimage|endswith: '\werfault.exe' targetimage|endswith: '\lsass.exe' grantedaccess: '0x1fffff'
<li><a href="#">detection: selection: sourceimage|endswith: '\winword.exe' calltrace|contains|all: - ':\windows\microsoft.net\framework64\v2.' - 'unknown'
<li><a href="#">detection: selection: startaddress|endswith: - '0b80' - '0c7c' - '0c88'
<li><a href="#">detection: selection: startmodule|endswith: '\kernel32.dll' startfunction: 'loadlibrarya'
<li><a href="#">detection: selection: status_code: 200 uri: /wsman method: post auth_header: client_header_names|contains: 'authorization' too_small_http_client_body: request_body_len: 0 #winrm_ports: # id.resp_p: # - 5985 # - 5986 # - 1270
<li><a href="#">detection: selection: targetfilename: - 'c:\windows\system32\config\systemprofile\appdata\roaming\microsoft\windows\powershell\psreadline\consolehost_history.txt' - 'c:\windows\system32\config\systemprofile\appdata\\local\microsoft\windows\powershell\startupprofiledata-interactive'
<li><a href="#">detection: selection: targetfilename: 'c:\windows\system32\drivers\moriyastreamwatchmen.sys'
<li><a href="#">detection: selection: targetfilename: c:\windows\temp\dumpert.dmp
<li><a href="#">detection: selection: targetfilename|contains: - '\appdata\roaming\anydesk\user.conf' - '\appdata\roaming\anydesk\system.conf' targetfilename|endswith: '.temp'
<li><a href="#">detection: selection: targetfilename|contains: - 'c:\windows\system32\physmem.sys' - 'c:\windows\system32\ime\imejp\imjpueact.dll' - 'c:\windows\system32\ime\imetc\imtcprot.dll' - 'c:\windows\system32\ime\shared\imecpmeid.dll' - 'c:\windows\system32\config\spp\servicestate\recovery\pac.dat' - 'c:\windows\system32\config\cy-gb\setup\skb\inputmethod\tuptask.dat' - 'c:\windows\system32\config\config\startwus.dat' - 'c:\windows\system32\ime\shared\wimbootconfigurations.ini' - 'c:\windows\system32\ime\imejp\wimbootconfigurations.ini' - 'c:\windows\system32\ime\imetc\wimbootconfigurations.ini'
<li><a href="#">detection: selection: targetfilename|contains: - gthread-3.6.dll - sigcmm-2.4.dll - \windows\temp\tmp.bat
<li><a href="#">detection: selection: targetfilename|contains: '\appdata\local\microsoft\event viewer\recentviews' filter: image|startswith: - 'c:\windows\system32\' - 'c:\windows\syswow64\'
<li><a href="#">detection: selection: targetfilename|contains: '\appdata\local\temp\advanced ip scanner 2'
<li><a href="#">detection: selection: targetfilename|contains: \appdata\local\temp\ba9ea7344a4a5f591d6e5dc32a13494b\
<li><a href="#">detection: selection: targetfilename|contains: '\appdata\local\temp\logmeininc\gotoassist remote support expert\'
<li><a href="#">detection: selection: targetfilename|contains: '\appdata\roaming\microsoft\word\startup\' filter_ext: targetfilename|endswith: - '.docx' # word document - '.docm' # word macro-enabled document; same as docx, but may contain macros and scripts - '.dotx' # word template - '.dotm' # word macro-enabled template; same as dotx, but may contain macros and scripts - '.docb' # word binary document introduced in microsoft office 2007 - '.pdf' # pdf documents - '.wll' # word add-in - '.wwl' # word add-in
<li><a href="#">detection: selection: targetfilename|contains: '\bin\screenconnect.' #pattern to dll and jar file
<li><a href="#">detection: selection: targetfilename|contains: '\local\microsoft\windows\schcache\' targetfilename|endswith: '.sch' filter_eq: image: - 'c:\windows\system32\svchost.exe' - 'c:\windows\system32\dllhost.exe' - 'c:\windows\system32\mmc.exe' - 'c:\windows\system32\windowspowershell\v1.0\powershell.exe' - 'c:\windows\ccm\ccmexec.exe' - 'c:\program files\cylance\desktop\cylancesvc.exe' - 'c:\windows\system32\wbem\wmiprvse.exe' filter_begins: image|startswith: 'c:\windows\ccmsetup\autoupgrade\ccmsetup' # c:\windows\ccmsetup\autoupgrade\ccmsetup.tmc00002.40.exe filter_domain_controller: image: - 'c:\windows\system32\efsui.exe' - 'c:\windows\system32\dsac.exe'
<li><a href="#">detection: selection: targetfilename|contains: '\notepad++\plugins\' targetfilename|endswith: '.dll' filter_gup: image|endswith: '\notepad++\updater\gup.exe' filter_install: # this filter is for sigma dataset you could remove it or change when using the rule in your own env image|startswith: 'c:\users\' image|contains: '\appdata\local\temp\' image|endswith: '\target.exe'
<li><a href="#">detection: selection: targetfilename|contains: '\policies\{31b2f340-016d-11d2-945f-00c04fb984f9}\' targetfilename|endswith: - '.dll' - '.exe'
<li><a href="#">detection: selection: targetfilename|contains: '\windows\system32\tasks' image|contains: - '\appdata\' - 'c:\perflogs' - '\windows\system32\config\systemprofile'
<li><a href="#">detection: selection: targetfilename|contains: 'c:\windows\system32\spool\drivers\x64\3\old\1\123'
<li><a href="#">detection: selection: targetfilename|contains: 'ds7002.lnk'
<li><a href="#">detection: selection: targetfilename|contains: 'lsass' targetfilename|endswith: 'dmp'
<li><a href="#">detection: selection: targetfilename|contains: 'programdata\microsoft\windows\start menu\programs\startup'
<li><a href="#">detection: selection: targetfilename|contains|all: - ':\users\' - '\.config\rclone\'
<li><a href="#">detection: selection: targetfilename|contains|all: - '\\127.0.0' - '\admin$\'
<li><a href="#">detection: selection: targetfilename|contains|all: - '\appdata\local\microsoft\clr' - '\usagelogs\' targetfilename|contains: - 'mshta' - 'cscript' - 'wscript' - 'regsvr32' - 'wmic' - 'rundll32' - 'svchost'
<li><a href="#">detection: selection: targetfilename|endswith: - '.aaa' - '.zzz'
<li><a href="#">detection: selection: targetfilename|endswith: - '.iso.lnk' - '.img.lnk' - '.vhd.lnk' - '.vhdx.lnk' targetfilename|contains: '\microsoft\windows\recent\'
<li><a href="#">detection: selection: targetfilename|endswith: - '\appdata\local\microsoft\cache134.dat' - '\appdata\local\microsoft\explorersync.db'
<li><a href="#">detection: selection: targetfilename|endswith: - '\nppspy.txt' - '\nppspy.dll'
<li><a href="#">detection: selection: targetfilename|endswith: - '\svchost.exe' - '\rundll32.exe' - '\services.exe' - '\powershell.exe' - '\regsvr32.exe' - '\spoolsv.exe' - '\lsass.exe' - '\smss.exe' - '\csrss.exe' - '\conhost.exe' - '\wininit.exe' - '\lsm.exe' - '\winlogon.exe' - '\explorer.exe' - '\taskhost.exe' - '\taskmgr.exe' - '\taskmgr.exe' - '\sihost.exe' - '\runtimebroker.exe' - '\runtimebroker.exe' - '\smartscreen.exe' - '\dllhost.exe' - '\audiodg.exe' - '\wlanext.exe' filter1: targetfilename|startswith: - 'c:\windows\system32\' - 'c:\windows\system32\' - 'c:\windows\syswow64\' - 'c:\windows\syswow64\' - 'c:\windows\winsxs\' - 'c:\windows\winsxs\' - '\systemroot\system32\' image|endswith: - '\windows\system32\dism.exe' - '\tiworker.exe' filter2: targetfilename|startswith: 'c:\$windows.~bt\' image: 'c:\$windows.~bt\sources\setuphost.exe' filter3: targetfilename|endswith: '\runtimebroker.exe' image: 'c:\windows\system32\wbengine.exe'
<li><a href="#">detection: selection: targetfilename|endswith: - '\werfault.exe' - '\wer.dll' filter_whitelist: targetfilename|contains: - '\system32\' - '\syswow64\' - '\winsxs\'
<li><a href="#">detection: selection: targetfilename|endswith: '.cmdline'
<li><a href="#">detection: selection: targetfilename|endswith: '.diagcab'
<li><a href="#">detection: selection: targetfilename|endswith: '.kirbi'
<li><a href="#">detection: selection: targetfilename|endswith: '.pfx'
<li><a href="#">detection: selection: targetfilename|endswith: '.scr' filter: image|endswith: - '\kindle.exe' - '\bin\ccsvchst.exe' # symantec endpoint protection
<li><a href="#">detection: selection: targetfilename|endswith: '.scr' filter: targetfilename|startswith: - 'c:\windows\system32\' - 'c:\windows\system32\' - 'c:\windows\syswow64\' - 'c:\windows\syswow64\' - 'c:\windows\winsxs\' - 'c:\windows\winsxs\'
<li><a href="#">detection: selection: targetfilename|endswith: '.sdb' targetfilename|contains: '\windows\apppatch\custom\'
<li><a href="#">detection: selection: targetfilename|endswith: '/etc/doas.conf'
<li><a href="#">detection: selection: targetfilename|endswith: '\desktop.ini' filter: image|startswith: - 'c:\windows\' - 'c:\program files\' - 'c:\program files (x86)\'
<li><a href="#">detection: selection: targetfilename|endswith: '\manageengine\supportcenterplus\bin\msiexec.exe'
<li><a href="#">detection: selection: targetfilename|endswith: '\microsoft\outlook\vbaproject.otm'
<li><a href="#">detection: selection: targetfilename|endswith: '\ntds.dit' image|endswith: - '\powershell.exe' - '\cmd.exe'
<li><a href="#">detection: selection: targetfilename|endswith: '\psexesvc.exe'
<li><a href="#">detection: selection: targetfilename|endswith: \teamviewer_desktop.exe
<li><a href="#">detection: selection: targetfilename|endswith: '\temp\debug.bin'
<li><a href="#">detection: selection: targetfilename|endswith: '\unattend.xml'
<li><a href="#">detection: selection: targetfilename|endswith: 'local\microsoft\windowsapps\get-variable.exe'
<li><a href="#">detection: selection: targetfilename|endswith: 'mimilsa.log'
<li><a href="#">detection: selection: targetfilename|endswith: 'windowspowershell\modules\webadministration\webadministration.psm1' filter: user|contains: # covers many language settings - 'authori' - 'autori'
<li><a href="#">detection: selection: targetfilename|startswith: 'c:\users\' targetfilename|endswith: - '\appdata\local\temp\system32\winsat.exe' - '\appdata\local\temp\system32\winmm.dll'
<li><a href="#">detection: selection: targetfilename|startswith: 'c:\users\' targetfilename|endswith: '\appdata\local\temp\api-ms-win-core-kernel32-legacy-l1.dll'
<li><a href="#">detection: selection: targetfilename|startswith: 'c:\users\' targetfilename|endswith: '\appdata\local\temp\pe386.dll'
<li><a href="#">detection: selection: targetfilename|startswith: 'c:\users\' targetfilename|endswith: '\appdata\local\temp\pkgmgr.exe'
<li><a href="#">detection: selection: targetfilename|startswith: 'c:\windows\prefetch\' targetfilename|endswith: '.pf' exception: image: 'c:\windows\system32\svchost.exe' user|contains: # covers many language settings - 'authori' - 'autori'
<li><a href="#">detection: selection: targetfilename|startswith: 'c:\windows\system32\consent.exe.@' targetfilename|endswith: '\comctl32.dll'
<li><a href="#">detection: selection: targetimage|endswith: - '\mspaint.exe' - '\calc.exe' - '\notepad.exe' - '\sethc.exe' - '\write.exe' - '\wordpad.exe'
<li><a href="#">detection: selection: targetimage|endswith: '\keepass.exe'
<li><a href="#">detection: selection: targetimage|endswith: '\lsass.exe' # theoretically, can be any benign process holding handle to lsass grantedaccess: '0x1440' # only process_dup_handle, process_query_limited_information, process_query_information call_trace: # c:\windows\system32\ntdll.dll+9d234\|unknown(00000000001c119b) calltrace|startswith: 'c:\windows\system32\ntdll.dll+' calltrace|contains: '|unknown(' calltrace|endswith: ')'
<li><a href="#">detection: selection: targetimage|endswith: '\lsass.exe' calltrace|contains|all: - 'c:\\windows\\system32\\ntdll.dll+' - '|c:\\windows\\system32\\kernelbase.dll+' - '_ctypes.pyd+' - 'python27.dll+' grantedaccess: '0x1fffff'
<li><a href="#">detection: selection: targetimage|endswith: '\lsass.exe' calltrace|contains|all: - 'c:\windows\system32\ntdll.dll+' - 'c:\windows\system32\kernelbase.dll+' - 'libffi-7.dll' - '_ctypes.pyd+' - 'python3*.dll+' # pypy requires python>=3.6 grantedaccess: '0x1fffff'
<li><a href="#">detection: selection: targetimage|endswith: '\lsass.exe' grantedaccess|contains: #- '0x1fffff' # too many false positives #- '0x01000' # too many false positives #- '0x1010' # too many false positives - '0x1038' # - '0x40' # too many false positives #- '0x1400' # too many false positives # - '0x1410' # too many false positives - '0x1438' - '0x143a' calltrace|contains: - 'dbghelp.dll' - 'dbgcore.dll' - 'ntdll.dll' filter_thor: calltrace|contains|all: - '|c:\windows\temp\asgard2-agent\' - '\thor\thor64.exe+' - '|unknown(' grantedaccess: '0x103800'
<li><a href="#">detection: selection: targetimage|endswith: '\lsass.exe' grantedaccess|endswith: - '10' - '30' - '50' - '70' - '90' - 'b0' - 'd0' - 'f0' - '18' - '38' - '58' - '78' - '98' - 'b8' - 'd8' - 'f8' - '1a' - '3a' - '5a' - '7a' - '9a' - 'ba' - 'da' - 'fa' - '0x14c2' # - 'ff' sourceimage|contains: - '\temp\' - '\users\public\' - '\perflogs\' - '\appdata\' - '\temporary' filter1: sourceimage|contains|all: - 'c:\users\' - '\appdata\local\' sourceimage|endswith: - '\microsoft vs code\code.exe' - '\software_reporter_tool.exe' - '\dropboxupdate.exe' - '\mbaminstallerservice.exe' - '\webexmta.exe' grantedaccess: '0x410' filter2: sourceimage|startswith: 'c:\windows\temp\' sourceimage|endswith: '.tmp\dropboxupdate.exe' grantedaccess: '0x410' filter_nextron: sourceimage|startswith: 'c:\windows\temp\asgard2-agent\' sourceimage|endswith: - '\thor64.exe' - '\thor.exe' grantedaccess: - '0x1fffff' - '0x1010'
<li><a href="#">detection: selection: targetimage|endswith: '\lsass.exe' grantedaccess|endswith: # - '10' # covered in rule 678dfc63-fefb-47a5-a04c-26bcf8cc9f65 - '30' - '50' - '70' - '90' - 'b0' - 'd0' - 'f0' - '18' - '38' - '58' - '78' - '98' - 'b8' - 'd8' - 'f8' - '1a' - '3a' - '5a' - '7a' - '9a' - 'ba' - 'da' - 'fa' - '0x14c2' # # absolute paths to programs that cause false positives filter_absolute: sourceimage: - 'c:\windows\system32\taskmgr.exe' - 'c:\program files\malwarebytes\anti-malware\mbamservice.exe' - 'c:\programdata\malwarebytes\mbamservice\ctlrupdate\mbupdatr.exe' - 'c:\windows\system32\taskhostw.exe' - 'c:\users\\*\appdata\local\programs\microsoft vs code\code.exe' - 'c:\program files\windows defender\msmpeng.exe' - 'c:\windows\syswow64\msiexec.exe' - 'c:\windows\system32\msiexec.exe' - 'c:\windows\system32\lsass.exe' - 'c:\windows\system32\perfmon.exe' - 'c:\windows\system32\mrt.exe' - 'c:\program files\cisco\cisco anyconnect secure mobility client\vpnagent.exe' - 'c:\program files (x86)\cisco\cisco anyconnect secure mobility client\vpnagent.exe' # windows defender filter1: sourceimage|startswith: 'c:\programdata\microsoft\windows defender\' sourceimage|endswith: '\msmpeng.exe' # vmware tools filter2: sourceimage|startswith: 'c:\programdata\vmware\vmware tools\' sourceimage|endswith: '\vmtoolsd.exe' # antivirus and edr agents filter3: sourceimage|startswith: - 'c:\program files\' - 'c:\program files (x86)\' sourceimage|contains: 'antivirus' filter_mrt: sourceimage: 'c:\windows\system32\mrt.exe' grantedaccess: '0x1418' filter_mcafee: sourceimage: 'c:\program files\common files\mcafee\mmsshost\mmsshost.exe' filter_nextron: sourceimage|startswith: 'c:\windows\temp\asgard2-agent\' sourceimage|endswith: - '\thor64.exe' - '\thor.exe' grantedaccess: '0x1fffff' filter_windefend2: calltrace|contains|all: - '|c:\programdata\microsoft\windows defender\definition updates\{' - '}\mpengine.dll+' grantedaccess: '0x1418'
<li><a href="#">detection: selection: targetimage|endswith: '\lsass.exe' grantedaccess|endswith: '10' # absolute paths to programs that cause false positives filter1: sourceimage: - 'c:\windows\system32\taskmgr.exe' - 'c:\program files\malwarebytes\anti-malware\mbamservice.exe' - 'c:\programdata\malwarebytes\mbamservice\ctlrupdate\mbupdatr.exe' - 'c:\windows\system32\taskhostw.exe' - 'c:\users\\*\appdata\local\programs\microsoft vs code\code.exe' - 'c:\program files\windows defender\msmpeng.exe' - 'c:\windows\syswow64\msiexec.exe' - 'c:\windows\system32\msiexec.exe' - 'c:\windows\system32\lsass.exe' - 'c:\windows\system32\perfmon.exe' # windows defender filter2: sourceimage|startswith: 'c:\programdata\microsoft\windows defender\' sourceimage|endswith: '\msmpeng.exe' # microsoft gaming services filter3: sourceimage|startswith: 'c:\program files\windowsapps\' sourceimage|endswith: '\gamingservices.exe' # process explorer filter4: sourceimage|endswith: - '\procexp64.exe' - '\procexp.exe' # vmware tools filter5: sourceimage|startswith: 'c:\programdata\vmware\vmware tools\' sourceimage|endswith: '\vmtoolsd.exe' # antivirus and edr agents filter6: sourceimage|startswith: - 'c:\program files\' - 'c:\program files (x86)\' sourceimage|contains: 'antivirus' filter7: sourceimage: 'c:\windows\system32\wbem\wmiprvse.exe' filter8: sourceimage: 'c:\windows\syswow64\wbem\wmiprvse.exe' filter_mcafee: sourceimage: 'c:\program files\common files\mcafee\mmsshost\mmsshost.exe' filter_nextron: sourceimage|startswith: 'c:\windows\temp\asgard2-agent\' sourceimage|endswith: - '\thor64.exe' - '\thor.exe' # generic filter for 0x1410 filter (caused by so many programs like dropbox updates etc.) filter_generic: sourceimage|startswith: - 'c:\program files\' - 'c:\program files (x86)\' - 'c:\windows\system32\' filter_localappdata: sourceimage|contains|all: - 'c:\users\' - '\appdata\local\' sourceimage|endswith: - '\microsoft vs code\code.exe' - '\software_reporter_tool.exe' - '\dropboxupdate.exe' - '\mbaminstallerservice.exe'
<li><a href="#">detection: selection: targetimage|endswith: '\lsass.exe' grantedaccess|startswith: - '0x40' # - '0x1000' # minimum access requirements to query basic info from service # - '0x1400' - '0x100000' - '0x1410' # car.2019-04-004 # - '0x1010' # car.2019-04-004 - '0x1438' # car.2019-04-004 - '0x143a' # car.2019-04-004 - '0x1418' # car.2019-04-004 - '0x1f0fff' - '0x1f1fff' - '0x1f2fff' - '0x1f3fff' filter1: sourceimage: - 'c:\windows\system32\taskmgr.exe' - 'c:\windows\system32\perfmon.exe' filter2: sourceimage|startswith: 'c:\programdata\microsoft\windows defender\' sourceimage|endswith: '\msmpeng.exe' filter2b: sourceimage: 'c:\windows\system32\svchost.exe' calltrace|contains|all: - '|c:\programdata\microsoft\windows defender\definition updates\{' - '}\mpengine.dll+' grantedaccess: '0x1418' filter3: sourceimage|startswith: 'c:\program files\windowsapps\' sourceimage|endswith: '\gamingservices.exe' grantedaccess: - '0x1410' - '0x410' filter4: sourceimage|endswith: - '\procexp64.exe' - '\procexp.exe' - 'c:\windows\system32\taskhostw.exe' - '\mbaminstallerservice.exe' grantedaccess: - '0x1410' - '0x410' - '0x40' filter5: sourceimage|startswith: 'c:\programdata\vmware\vmware tools\' sourceimage|endswith: '\vmtoolsd.exe' filter6: sourceimage: 'c:\windows\system32\svchost.exe' grantedaccess: '0x100000' filter7: sourceimage: - 'c:\windows\system32\wbem\wmiprvse.exe' - 'c:\windows\syswow64\msiexec.exe' - 'c:\windows\system32\msiexec.exe' grantedaccess: - '0x1410' - '0x410' filter8: sourceimage|endswith: - '\thor.exe' - '\thor64.exe' - '\aurora-agent.exe' - '\aurora-agent-64.exe' grantedaccess: - '0x40' - '0x1010' filter9: sourceimage|endswith: '\explorer.exe' grantedaccess: '0x401' filter10: sourceimage: - 'c:\windows\system32\wininit.exe' - 'c:\windows\system32\lsass.exe' grantedaccess: '0x1000000' filter11: sourceimage: 'c:\windows\system32\mrt.exe' # windows malicious software removal tool grantedaccess: - '0x1410' - '0x1418' filter_handle: grantedaccess: '0x40' sourceimage|endswith: - '\handle.exe' - '\handle64.exe' filter_generic: sourceimage|startswith: - 'c:\program files\' - 'c:\program files (x86)\' grantedaccess: - '0x1410' - '0x410' filter_edge: # version in path 96.0.1054.43 sourceimage|startswith: c:\program files (x86)\microsoft\edge\application\ sourceimage|endswith: \installer\setup.exe # old - too broad filter # sourceimage|endswith: # easy to bypass. need to implement supportive rule to detect bypass attempts # - '\wmiprvse.exe' # - '\taskmgr.exe' # - '\procexp64.exe' # - '\procexp.exe' # - '\lsm.exe' # - '\msmpeng.exe' # - '\csrss.exe' # - '\wininit.exe' # - '\vmtoolsd.exe'
<li><a href="#">detection: selection: targetimage|endswith: '\lsass.exe' sourceimage: 'c:\windows\system32\rundll32.exe' calltrace|contains: 'comsvcs.dll'
<li><a href="#">detection: selection: targetimage|endswith: '\lsass.exe' sourceimage: 'c:\windows\system32\wsmprovhost.exe' filter: grantedaccess: '0x80000000'
<li><a href="#">detection: selection: targetimage|endswith: '\lsass.exe' sourceimage|contains: 'dump' grantedaccess|endswith: - '10' - '30' - '50' - '70' - '90' - 'b0' - 'd0' - 'f0' - '18' - '38' - '58' - '78' - '98' - 'b8' - 'd8' - 'f8' - '1a' - '3a' - '5a' - '7a' - '9a' - 'ba' - 'da' - 'fa' - '0x14c2' # - 'ff'
<li><a href="#">detection: selection: targetimage|endswith: '\lsass.exe' sourceimage|endswith: - '\trolleyexpress.exe' # citrix - '\processdump.exe' # cisco jabber - '\dump64.exe' # visual studio grantedaccess|endswith: - '10' - '30' - '50' - '70' - '90' - 'b0' - 'd0' - 'f0' - '18' - '38' - '58' - '78' - '98' - 'b8' - 'd8' - 'f8' - '1a' - '3a' - '5a' - '7a' - '9a' - 'ba' - 'da' - 'fa' - '0x14c2' # - 'ff'
<li><a href="#">detection: selection: targetimage|endswith: '\lsass.exe' sourceimage|endswith: '\svchost.exe' grantedaccess: '0x14c0' calltrace|contains: 'seclogon.dll'
<li><a href="#">detection: selection: targetimage|endswith: '\lsass.exe' startmodule: ''
<li><a href="#">detection: selection: targetimage|endswith: '\verclsid.exe' grantedaccess: '0x1fffff' combination1: calltrace|contains|all: - '|unknown(' - 'vbe7.dll' combination2: sourceimage|contains: '\microsoft office\' calltrace|contains: '|unknown'
<li><a href="#">detection: selection: targetimage|endswith: '\windows\system32\svchost.exe' grantedaccess: '0x1f3fff' calltrace|contains: 'unknown'
<li><a href="#">detection: selection: targetobject: 'hkcu\software\microsoft\windows\currentversion\run\ntkd'
<li><a href="#">detection: selection: targetobject|contains: - '\control\print\environments\windows x64\drivers\version-3\qms 810\' - '\control\print\environments\windows x64\drivers\version-3\mimikatz' selection_alt: targetobject|contains|all: - 'legitprinter' - '\control\print\environments\windows' selection_print: targetobject|contains: - '\control\print\environments' - '\currentversion\print\printers' selection_kiwi: targetobject|contains: - 'gentil kiwi' - 'mimikatz printer' - 'kiwi legit printer'
<li><a href="#">detection: selection: targetobject|contains: - '\currentcontrolset\services\ntds\directoryserviceextpt' - '\currentcontrolset\services\ntds\lsadbextpt' filter_domain_controller: image: 'c:\windows\system32\lsass.exe' details: - '%%systemroot%%\system32\ntdsa.dll' - '%%systemroot%%\system32\lsadb.dll'
<li><a href="#">detection: selection: targetobject|contains: '\cmmgr32.exe'
<li><a href="#">detection: selection: targetobject|contains: '\system\currentcontrolset\services\null\instance'
<li><a href="#">detection: selection: targetobject|contains: 'classes\.' details: 'exefile' eventtype: setvalue
<li><a href="#">detection: selection: targetobject|contains: hklm\software\microsoft\htmlhelp\data
<li><a href="#">detection: selection: targetobject|contains: 'microsoft\windows nt\currentversion\silentprocessexit\lsass.exe'
<li><a href="#">detection: selection: targetobject|contains: services\wceservice\start
<li><a href="#">detection: selection: targetobject|contains: 'shell\open\command\' details|contains|all: - 'powershell' - '-command' eventtype: setvalue
<li><a href="#">detection: selection: targetobject|contains: 'system\currentcontrolset\control\crashcontrol' details: 'dword (0x00000000)'
<li><a href="#">detection: selection: targetobject|contains: 'system\currentcontrolset\services\vss' image|endswith: 'esentutl.exe' # limit esentutl as in references, too many fp to filter filter: targetobject|contains: 'system\currentcontrolset\services\vss\start'
<li><a href="#">detection: selection: targetobject|contains: 'trustrecords'
<li><a href="#">detection: selection: targetobject|contains|all: - '\software\microsoft\office\' - '\outlook\security\' eventtype: setvalue
<li><a href="#">detection: selection: targetobject|contains|all: - 'system\' - 'controlset' - '\control\lsa' targetobject|endswith: - '\lmcompatibilitylevel' - '\ntlmminclientsec' - '\restrictsendingntlmtraffic'
<li><a href="#">detection: selection: targetobject|endswith: - clsid\{cf4cc405-e2c5-4ddd-b3ce-5e7582d8c9fa}\inprocserver32\(default) - clsid\{7c857801-7381-11cf-884d-00aa004b2e24}\inprocserver32\(default) filter: details|endswith: - system32\wbem\wmiutils.dll - system32\wbem\wbemsvc.dll
<li><a href="#">detection: selection: targetobject|endswith: '\appx82a6gwre4fdg3bt635tn5ctqjf8msdd2\shell\open\command'
<li><a href="#">detection: selection: targetobject|endswith: '\control panel\desktop\scrnsave.exe' # hkey_current_user\control panel\desktop\scrnsave.exe filter: image|endswith: - '\rundll32.exe' - '\explorer.exe'
<li><a href="#">detection: selection: targetobject|endswith: '\environment\windir' details|contains: '&rem' eventtype: setvalue
<li><a href="#">detection: selection: targetobject|endswith: '\iscredguardenabled'
<li><a href="#">detection: selection: targetobject|endswith: '\services\dns\parameters\serverlevelplugindll'
<li><a href="#">detection: selection: targetobject|endswith: '\software\microsoft\windows nt\currentversion\winlogon\notify\logon' details|endswith: '.dll' eventtype: setvalue
<li><a href="#">detection: selection: targetobject|endswith: 'software\microsoft\windows\currentversion\run\backup mgr'
<li><a href="#">detection: selection: targetobject|startswith: - 'hklm\software\microsoft\windows nt\currentversion\appcompatflags\installedsdb\' - 'hklm\software\microsoft\windows nt\currentversion\appcompatflags\custom\' eventtype: setvalue filter: details: ''
<li><a href="#">detection: selection: targetobject|startswith: 'hkcu\' targetobject|endswith: '\mscfile\shell\open\command'
<li><a href="#">detection: selection: targetobject|startswith: 'hklm\sam\sam\domains\account\users\names\' targetobject|endswith: '$' image|endswith: '\lsass.exe'
<li><a href="#">detection: selection: targetobject|startswith: 'hklm\software\microsoft\active setup\installed components' targetobject|endswith: '\stubpath' filter_chrome: details|startswith: '"c:\program files\google\chrome\application\' details|endswith: '\installer\chrmstp.exe" --configure-user-settings --verbose-logging --system-level' filter_edge: details|startswith: - '"c:\program files (x86)\microsoft\edge\application\' - '"c:\program files\microsoft\edge\application\' details|endswith: '\installer\setup.exe" --configure-user-settings --verbose-logging --system-level --msedge --channel=stable'
<li><a href="#">detection: selection: targetobject|startswith: 'hklm\system\currentcontrolset\control\print\monitors\' details|endswith: '.dll' eventtype: setvalue filter_cutepdf: image: 'c:\windows\system32\spoolsv.exe' targetobject|contains: '\system\currentcontrolset\control\print\monitors\cutepdf writer monitor v4.0\driver' details: 'cpwmon64_v40.dll' user|contains: # covers many language settings - 'authori' - 'autori'
<li><a href="#">detection: selection: type: 'execve' a0: - 'users' - 'w' - 'who'
<li><a href="#">detection: selection: type: 'execve' a0: '/usr/bin/sudoedit' cmd1: a1: '-s' cmd2: a2: '-s' cmd3: a3: '-s' cmd4: a4: '-s' cmd5: a1: '\' cmd6: a2: '\' cmd7: a3: '\' cmd8: a4: '\'
<li><a href="#">detection: selection: type: execve a0: arecord a1: '-vv' a2: '-fdat'
<li><a href="#">detection: selection: type: 'execve' a0: 'cp' a1: '-i' a2: '/bin/sh' a3|endswith: '/crond'
<li><a href="#">detection: selection: type: execve a0: getcap a1: '-r' a2: '/'
<li><a href="#">detection: selection: type: execve a0: steghide a1: embed a2: - '-cf' - '-ef' a4: - '-cf' - '-ef'
<li><a href="#">detection: selection: type: execve a0: steghide a1: extract a2: '-sf' a3|endswith: - '.jpg' - '.png'
<li><a href="#">detection: selection: type: execve a0: wget a1|startswith: '--post-file='
<li><a href="#">detection: selection: type: execve a0: xclip a1: - '-selection' - '-sel' a2: - clipboard - clip a3: '-o'
<li><a href="#">detection: selection: type: execve a0: xclip a1: - '-selection' - '-sel' a2: - clipboard - clip a3: '-t' a4|startswith: 'image/' a5: '-o'
<li><a href="#">detection: selection: type: 'execve' a0|contains: - 'chmod' - 'chown'
<li><a href="#">detection: selection: type: 'execve' a0|contains: 'chattr' a1|contains: '-i'
<li><a href="#">detection: selection: type: 'execve' a0|contains: 'dd' a1|contains: - 'if=/dev/null' - 'if=/dev/zero'
<li><a href="#">detection: selection: type: 'execve' a0|contains: 'systemctl' a1|contains: - 'daemon-reload' - 'start'
<li><a href="#">detection: selection: type: image is replaced filters: image|contains: - ':\program files\' - ':\program files (x86)' image|endswith: - '\chrome.exe' - '\opera.exe' - '\firefox.exe' - '\microsoftedge.exe'
<li><a href="#">detection: selection: type: path name: - /etc/audit/* - /etc/libaudit.conf - /etc/audisp/*
<li><a href="#">detection: selection: type: path name: - /etc/lsb-release - /etc/redhat-release - /etc/issue selection2: type: execve a0: - uname - uptime
<li><a href="#">detection: selection: type: 'path' name: - /etc/syslog.conf - /etc/rsyslog.conf - /etc/syslog-ng/syslog-ng.conf
<li><a href="#">detection: selection: type: 'path' name: - '/root/.bashrc' - '/root/.bash_profile' - '/root/.profile' - '/home/*/.bashrc' - '/home/*/.bash_profile' - '/home/*/.profile' - '/etc/profile' - '/etc/shells' - '/etc/bashrc' - '/etc/csh.cshrc' - '/etc/csh.login'
<li><a href="#">detection: selection: type: 'path' name: - '/sys/class/dmi/id/bios_version' - '/sys/class/dmi/id/product_name' - '/sys/class/dmi/id/chassis_vendor' - '/proc/scsi/scsi' - '/proc/ide/hd0/model' - '/proc/version' - '/etc/*version' - '/etc/*release' - '/etc/issue'
<li><a href="#">detection: selection: type: 'path' name: '/etc/ld.so.preload'
<li><a href="#">detection: selection: type: 'service_stop' unit: - 'firewalld' - 'iptables' - 'ufw'
<li><a href="#">detection: selection: type: 'syscall' comm: insmod exe: /usr/bin/kmod
<li><a href="#">detection: selection: type: 'syscall' comm: 'split'
<li><a href="#">detection: selection: type: 'syscall' exe: '/usr/bin/sudoedit'
<li><a href="#">detection: selection: type: 'syscall' exe|endswith: - '/telnet' - '/nmap' - '/netcat' - '/nc' key: 'network_connect_4'
<li><a href="#">detection: selection: type: 'syscall' exe|endswith: '/useradd'
<li><a href="#">detection: selection: type: 'syscall' exe|startswith: # temporary folder - '/tmp/' # web server - '/var/www/' # standard - '/home/*/public_html/' # per-user - '/usr/local/apache2/' # classical apache - '/usr/local/httpd/' # old suse linux 6.* apache - '/var/apache/' # solaris apache - '/srv/www/' # suse linux 9.* - '/home/httpd/html/' # redhat 6 or older apache - '/srv/http/' # archlinux standard - '/usr/share/nginx/html/' # archlinux nginx # data dirs of typically exploited services (incomplete list) - '/var/lib/pgsql/data/' - '/usr/local/mysql/data/' - '/var/lib/mysql/' - '/var/vsftpd/' - '/etc/bind/' - '/var/named/'
<li><a href="#">detection: selection: type: 'syscall' syscall: 'execve' key: 'detect_execve_www'
<li><a href="#">detection: selection: type: 'syscall' syscall: 'execve' uid: '0' cwd: '/var/opt/microsoft/scx/tmp' comm: 'sh'
<li><a href="#">detection: selection: user: root logonid: '0' currentdirectory: '/var/opt/microsoft/scx/tmp' commandline|contains: '/bin/sh'
<li><a href="#">detection: selection: user: root logonid: '0' currentdirectory: '/var/opt/microsoft/scx/tmp' commandline|contains: '/etc/opt/microsoft/scx/conf/tmpdir/scx'
<li><a href="#">detection: selection: user_agent|contains: 'webdav' method: 'put' filter: id.resp_h: - 192.168.0.0/16 - 172.16.0.0/12 - 10.0.0.0/8
<li><a href="#">detection: selection: user|contains: # covers many language settings - 'authori' - 'autori' image|endswith: '\taskmgr.exe'
<li><a href="#">detection: selection: user|contains: # covers many language settings - 'authori' - 'autori' image|endswith: '\tscon.exe'
<li><a href="#">detection: selection: useridentity.type: assumedrole useridentity.sessioncontext.sessionissuer.type: role
<li><a href="#">detection: selection_1: - image|endswith: '\whoami.exe' - image|endswith: '\wmic.exe' commandline|contains|all: - 'useraccount' - 'get' - image|endswith: - '\quser.exe' - '\qwinsta.exe' - image|endswith: '\cmdkey.exe' commandline|contains: ' /l' - image|endswith: '\cmd.exe' commandline|contains|all: - ' /c' - 'dir ' - '\users\' filter_1: commandline|contains: ' rmdir ' # don't match on 'dir' "c:\windows\system32\cmd.exe" /q /c rmdir /s /q "c:\users\xx\appdata\local\microsoft\onedrive\19.232.1124.0005" selection_2: image|endswith: - '\net.exe' - '\net1.exe' commandline|contains: 'user' filter_2: commandline|contains: - '/domain' # local account discovery only - '/add' # discovery only - '/delete' # discovery only - '/active' # discovery only - '/expires' # discovery only - '/passwordreq' # discovery only - '/scriptpath' # discovery only - '/times' # discovery only - '/workstations' # discovery only
<li><a href="#">detection: selection_1: commandline|contains: - dumpcreds - invoke-mimikatz module_names: commandline|contains: - rpc - token - crypto - dpapi - sekurlsa - kerberos - lsadump - privilege - process - vault mimikatz_separator: commandline|contains: '::' function_names: # to cover functions from modules that are not in module_names (likely too generic) commandline|contains: - 'aadcookie' #misc module - 'detours' #misc module - 'memssp' #misc module - 'mflt' #misc module - 'ncroutemon' #misc module - 'ngcsign' #misc module - 'printnightmare' #misc module - 'skeleton' #misc module - 'preshutdown' #service module - 'mstsc' #ts module - 'multirdp' #ts module filter_1: commandline|contains: 'function convert-guidtocompressedguid'
<li><a href="#">detection: selection_1: commandline|contains: - 'echo' - 'copy' - 'type' - 'file createnew' - 'cacls' selection_2: commandline|contains: 'c:\windows\fonts\' selection_3: commandline|contains: - '.sh' - '.exe' - '.dll' - '.bin' - '.bat' - '.cmd' - '.js' - '.msh' - '.reg' - '.scr' - '.ps' - '.vb' - '.jar' - '.pl' - '.inf' - '.cpl' - '.hta' - '.msi' - '.vbs'
<li><a href="#">detection: selection_1: commandline|contains: - 'vboxrt.dll,rtr3init' - 'vboxc.dll' - 'vboxdrv.sys' selection_2: commandline|contains: - 'startvm' - 'controlvm'
<li><a href="#">detection: selection_1: commandline|contains: '\\\\\?\\globalroot\\device\\harddiskvolumeshadowcopy' selection_2: commandline|contains: - '\\ntds.dit' - '\\system' - '\\security' - 'c:\\tmp\\log'
<li><a href="#">detection: selection_1: commandline|contains: 'appvlp.exe' selection_2: commandline|contains: - 'cmd.exe' - 'powershell.exe' selection_3: commandline|contains: - '.sh' - '.exe' - '.dll' - '.bin' - '.bat' - '.cmd' - '.js' - '.msh' - '.reg' - '.scr' - '.ps' - '.vb' - '.jar' - '.pl' - '.inf'
<li><a href="#">detection: selection_1: commandline|contains|all: - '\harddiskvolumeshadowcopy' - 'ystem32\config\sam' selection_2: commandline|contains: - 'copy-item' - 'cp $_.' - 'cpi $_.' - 'copy $_.' - '.file]::copy('
<li><a href="#">detection: selection_1: commandline|contains|all: - 'bitsadmin' - '/setnotifycmdline' commandline|contains: - '%comspec%' - 'cmd.exe' - 'regsvr32.exe' selection_2: commandline|contains|all: - 'bitsadmin' - '/addfile' commandline|contains: - 'http:' - 'https:' - 'ftp:' - 'ftps:'
<li><a href="#">detection: selection_1: commandline|contains|all: - netsh - firewall - set - opmode - 'mode=disable' selection_2: commandline|contains|all: - netsh - advfirewall - set - state - 'off'
<li><a href="#">detection: selection_1: commandline|contains|all: - 'reg' - 'add' - 'hkcu\software\classes\ms-settings\shell\open\command' - '/ve ' - '/d' selection_2: commandline|contains|all: - 'reg' - 'add' - 'hkcu\software\classes\ms-settings\shell\open\command' - '/v' - 'delegateexecute' selection_3: commandline|contains|all: - 'reg' - 'delete' - 'hkcu\software\classes\ms-settings'
<li><a href="#">detection: selection_1: eventid: 4656 objectname|endswith: '\lsass.exe' accessmask|contains: - '0x40' - '0x1400' # - '0x1000' # minimum access requirements to query basic info from service - '0x100000' - '0x1410' # car.2019-04-004 - '0x1010' # car.2019-04-004 - '0x1438' # car.2019-04-004 - '0x143a' # car.2019-04-004 - '0x1418' # car.2019-04-004 - '0x1f0fff' - '0x1f1fff' - '0x1f2fff' - '0x1f3fff' selection_2: eventid: 4663 objectname|endswith: '\lsass.exe' accesslist|contains: - '4484' - '4416' filter1: processname|endswith: - '\wmiprvse.exe' - '\taskmgr.exe' - '\procexp64.exe' - '\procexp.exe' - '\lsm.exe' - '\csrss.exe' - '\wininit.exe' - '\vmtoolsd.exe' - '\minionhost.exe' # cyberreason - '\vstskmgr.exe' # mcafee enterprise - '\thor.exe' # thor - '\thor64.exe' # thor - '\microsoftedgeupdate.exe' - '\gamingservices.exe' - '\svchost.exe' - '\msmpeng.exe' # defender - '\mrt.exe' # ms malware removal tool - 'rtkauduservice64' # processname|startswith: - c:\windows\system32\ - c:\windows\syswow64\ - c:\windows\sysnative\ - c:\program files\ - c:\windows\temp\asgard2-agent\ - c:\programdata\microsoft\windows defender\platform\ filter2: processname|startswith: 'c:\program files' # too many false positives with legitimate av and edr solutions filter3: processname: 'c:\windows\ccm\ccmexec.exe'
<li><a href="#">detection: selection_1: eventid: 5145 relativetargetname|contains: '\winreg' filter: ipaddress: '%admins_workstations%'
<li><a href="#">detection: selection_1: eventtype: setvalue targetobject: - 'hklm\system\currentcontrolset\services\naldrv\imagepath' - 'hklm\system\currentcontrolset\services\procexp152\imagepath' selection_2: image|endswith: - '\procexp64.exe' - '\procexp.exe' - '\procmon64.exe' - '\procmon.exe' selection_3: details|contains: '\windows\system32\drivers\procexp152.sys'
<li><a href="#">detection: selection_1: eventtype: setvalue targetobject|contains: - '\software\microsoft\office\' - '\outlook\webview\' targetobject|endswith: '\url' selection_2: targetobject|contains: - '\calendar\' - '\inbox\'
<li><a href="#">detection: selection_1: eventtype: setvalue targetobject|startswith: 'hklm\system\currentcontrolset\services\' targetobject|endswith: '\start' image|contains: - '\appdata\local\' - '\appdata\roaming\' details: - 'dword (0x00000000)' # boot - 'dword (0x00000001)' # system - 'dword (0x00000002)' # automatic # 3 - manual , 4 - disabled selection_2: eventtype: setvalue targetobject|startswith: 'hklm\system\currentcontrolset\services\' targetobject|endswith: '\imagepath' details|contains: - '\appdata\local\' - '\appdata\roaming\' filter: - image|contains: - '\appdata\roaming\zoom' - '\appdata\local\zoom' - details|contains: - '\appdata\roaming\zoom' - '\appdata\local\zoom'
<li><a href="#">detection: selection_1: eventtype: setvalue targetobject|startswith: 'hklm\system\currentcontrolset\services\' targetobject|endswith: '\start' image|contains: - '\users\public\' - '\perflogs\' - '\admin$\' details: - 'dword (0x00000000)' # boot - 'dword (0x00000001)' # system - 'dword (0x00000002)' # automatic # 3 - manual , 4 - disabled selection_2: eventtype: setvalue targetobject|startswith: 'hklm\system\currentcontrolset\services\' targetobject|endswith: '\imagepath' details|contains: - '\users\public\' - '\perflogs\' - '\admin$\'
<li><a href="#">detection: selection_1: eventtype: setvalue targetobject|startswith: 'hklm\system\currentcontrolset\services\' targetobject|endswith: '\start' image|contains: '\temp\' details: - 'dword (0x00000000)' # boot - 'dword (0x00000001)' # system - 'dword (0x00000002)' # automatic # 3 - manual , 4 - disabled selection_2: eventtype: setvalue targetobject|startswith: 'hklm\system\currentcontrolset\services\' targetobject|endswith: '\imagepath' details|contains: '\temp\'
<li><a href="#">detection: selection_1: image|endswith: - '/nc' - '/netcat' selection_2: image|endswith: - '/nmap' - '/telnet' filter: commandline|contains: 'l'
<li><a href="#">detection: selection_1: image|endswith: '/arp' commandline|contains: '-a' selection_2: image|endswith: '/ping' commandline|contains: - ' 10.' #10.0.0.0/8 - ' 192.168.' #192.168.0.0/16 - ' 172.16.' #172.16.0.0/12 - ' 172.17.' - ' 172.18.' - ' 172.19.' - ' 172.20.' - ' 172.21.' - ' 172.22.' - ' 172.23.' - ' 172.24.' - ' 172.25.' - ' 172.26.' - ' 172.27.' - ' 172.28.' - ' 172.29.' - ' 172.30.' - ' 172.31.' - ' 127.' #127.0.0.0/8 - ' 169.254.' #169.254.0.0/16
<li><a href="#">detection: selection_1: image|endswith: '/dscacheutil' commandline|contains|all: - '-q' - 'group' selection_2: image|endswith: '/cat' commandline|contains: '/etc/group' selection_3: image|endswith: '/dscl' commandline|contains|all: - '-list' - '/groups'
<li><a href="#">detection: selection_1: image|endswith: '/dscl' commandline|contains|all: - 'list' - '/users' selection_2: image|endswith: '/dscacheutil' commandline|contains|all: - '-q' - 'user' selection_3: commandline|contains: '''x:0:''' selection_4: image|endswith: '/cat' commandline|contains: - '/etc/passwd' - '/etc/sudoers' selection_5: image|endswith: '/id' selection_6: image|endswith: '/lsof' commandline|contains: '-u'
<li><a href="#">detection: selection_1: image|endswith: '/groups' selection_2: image|endswith: '/cat' commandline|contains: '/etc/group'
<li><a href="#">detection: selection_1: image|endswith: '/lastlog' selection_2: commandline|contains: '''x:0:''' selection_3: image|endswith: '/cat' commandline|contains: - '/etc/passwd' - '/etc/sudoers' selection_4: image|endswith: '/id' selection_5: image|endswith: '/lsof' commandline|contains: '-u'
<li><a href="#">detection: selection_1: image|endswith: '\odbcconf.exe' commandline|contains: - '-f' - 'regsvr' selection_2: parentimage|endswith: '\odbcconf.exe' image|endswith: '\rundll32.exe'
<li><a href="#">detection: selection_1: image|endswith: '\reg.exe' commandline|contains: - 'query' - 'save' - 'export' selection_2: commandline|contains: - 'currentversion\windows' - 'currentversion\runservicesonce' - 'currentversion\runservices' - 'winlogon\' - 'currentversion\shellserviceobjectdelayload' - 'currentversion\runonce' - 'currentversion\runonceex' - 'currentversion\run' - 'currentversion\policies\explorer\run' - 'currentcontrolset\services'
<li><a href="#">detection: selection_1: image|endswith: '\reg.exe' commandline|contains: - 'save' - 'export' - 'ë¢ave' - 'eë£port' selection_2: commandline|contains: - 'hklm' - 'hkëªm' - 'hkey_local_machine' - 'hkey_ëªocal_machine' - 'hkey_locaëª_machine' - 'hkey_ëªocaëª_machine' selection_3: commandline|endswith: - '\system' - '\sam' - '\security' - '\ë¢ystem' - '\syë¢tem' - '\ë¢yë¢tem' - '\ë¢am' - '\ë¢ecurity'
<li><a href="#">detection: selection_1: image|endswith: '\reg.exe' commandline|contains: 'add' # to avoid intersection with discovery tactic rules selection_2: commandline|contains: # need to improve this list, there are plenty of asep reg keys - '\software\microsoft\windows\currentversion\run' - '\software\microsoft\windows\currentversion\runonce' - '\software\microsoft\windows\currentversion\runonceex' - '\software\microsoft\windows\currentversion\runservices' - '\software\microsoft\windows\currentversion\runservicesonce' - '\software\microsoft\windows nt\currentversion\winlogon\userinit' - '\software\microsoft\windows nt\currentversion\winlogon\shell' - '\software\microsoft\windows nt\currentversion\windows' - '\software\microsoft\windows\currentversion\explorer\user shell folders' - '\system\currentcontrolset\control\safeboot\alternateshell'
<li><a href="#">detection: selection_1: image|endswith: '\sc.exe' commandline|contains|all: - 'config' - 'binpath' selection_2: commandline|contains: - 'powershell' - 'cmd'
<li><a href="#">detection: selection_1: image|endswith: '\sqlps.exe' selection_2: parentimage|endswith: '\sqlps.exe' selection_3: originalfilename: '\sqlps.exe' filter: parentimage|endswith: '\sqlagent.exe'
<li><a href="#">detection: selection_1: image|endswith: '\sqltoolsps.exe' selection_2: parentimage|endswith: '\sqltoolsps.exe' selection_3: originalfilename: '\sqltoolsps.exe' filter: parentimage|endswith: '\smss.exe'
<li><a href="#">detection: selection_1: parentimage|endswith: '\services.exe' selection_2: # meterpreter getsystem technique 1: cmd.exe /c echo 559891bb017 > \\.\pipe\5e120a - commandline|contains|all: - 'cmd' - '/c' - 'echo' - '\pipe\' # cobaltstrike getsystem technique 1: %comspec% /c echo 559891bb017 > \\.\pipe\5e120a - commandline|contains|all: - '%comspec%' - '/c' - 'echo' - '\pipe\' # cobaltstrike getsystem technique 1b (expanded env var): %comspec% /c echo 559891bb017 > \\.\pipe\5e120a - commandline|contains|all: - 'cmd.exe' - '/c' - 'echo' - '\pipe\' # meterpreter getsystem technique 2: rundll32.exe c:\users\test\appdata\local\temp\tmexsn.dll,a /p:tmexsn - commandline|contains|all: - 'rundll32' - '.dll,a' - '/p:' filter1: commandline|contains: 'mpcmdrun'
<li><a href="#">detection: selection_1: provider_name: microsoft-windows-kerberos-key-distribution-center # active directory eventid: - 35 - 36 - 37 - 38 selection_2: provider_name: microsoft-windows-directory-services-sam # active directory eventid: - 16990 - 16991
<li><a href="#">detection: selection_1: provider_name: microsoft-windows-security-auditing eventid: 4673 privilegelist: 'seloaddriverprivilege' service: '-' filter: processname|endswith: - '\windows\system32\dism.exe' - '\windows\system32\rundll32.exe' - '\windows\system32\fltmc.exe' - '\windows\helppane.exe' - '\windows\system32\mmc.exe' - '\windows\system32\svchost.exe' - '\windows\system32\wimserv.exe' - '\procexp64.exe' - '\procexp.exe' - '\procmon64.exe' - '\procmon.exe' - '\google\chrome\application\chrome.exe'
<li><a href="#">detection: selection_1: scriptblocktext|contains|all: - 'get-itemproperty' - 'registry::' - 'hkey_current_user\control panel\desktop\' - 'wallpaper' selection_2: scriptblocktext|contains: systemparametersinfo(20,0,*,3)
<li><a href="#">detection: selection_1: scriptblocktext|contains|all: - 'get-process' - '.description' - '-like' selection_2: scriptblocktext|contains: - '"*virus*"' - '"*carbonblack*"' - '"*defender*"' - '"*cylance*"'
<li><a href="#">detection: selection_1: targetfilename|contains: '/etc/emond.d/rules/' targetfilename|endswith: '.plist' selection_2: targetfilename|contains: '/private/var/db/emondclients/'
<li><a href="#">detection: selection_1: targetfilename|contains: '/library/startupitems/' selection_2: targetfilename|endswith: '.plist'
<li><a href="#">detection: selection_1: targetfilename|contains: '\appdata\local\temp\' targetfilename|endswith: 'procexp152.sys' selection_2: image|contains: - '\procexp64.exe' - '\procexp.exe' - '\procmon64.exe' - '\procmon.exe'
<li><a href="#">detection: selection_1: targetobject|contains|all: - '\software\microsoft\windows\currentversion\capabilityaccessmanager\consentstore\' - '\nonpackaged' selection_2: targetobject|contains: - microphone - webcam selection_3: targetobject|contains: - ':#windows#temp#' - ':#$recycle.bin#' - ':#temp#' - ':#users#public#' - ':#users#default#' - ':#users#desktop#'
<li><a href="#">detection: selection_1a_payload: payload|contains: - 'del' - 'remove-item' - 'rm' selection_1b_payload: payload|contains: '(get-psreadlineoption).historysavepath' selection_payload_2: payload|contains|all: - 'set-psreadlineoption' - 'â€“historysavestyle' # not sure if the homoglyph â€“/- is intended, just checking for both - 'savenothing' selection_payload_3: payload|contains|all: - 'set-psreadlineoption' - '-historysavestyle' - 'savenothing'
<li><a href="#">detection: selection_2: targetfilename|contains: '\inetpub\wwwroot\' selection_3: targetfilename|contains: - '.asp' - '.ashx' - '.ph' selection_4: targetfilename|contains: - '\www\' - '\htdocs\' - '\html\' selection_5: targetfilename|contains: '.ph' selection_6: - targetfilename|endswith: '.jsp' - targetfilename|contains|all: - '\cgi-bin\' - '.pl' false_positive1: # false positives when unpacking some executables in $temp targetfilename|contains: - '\appdata\local\temp\' - '\windows\temp\' false_positive2: image: 'system' # fp : backup/restore from drivers
<li><a href="#">detection: selection_4103: contextinfo|contains|all: - 'compress-archive ' - ' -path ' - ' -destinationpath ' - '$env:temp\'
<li><a href="#">detection: selection_4103: payload|contains: - '$doit' - 'harmj0y' - 'mattifestation' - '_rastamouse' - 'tifkin_' - '0xdeadbeef'
<li><a href="#">detection: selection_4103: payload|contains: 'expand-archive'
<li><a href="#">detection: selection_4103: payload|contains: 'get-clipboard'
<li><a href="#">detection: selection_4103: payload|contains|all: - '&&' - 'rundll32' - 'shell32.dll' - 'shellexec_rundll' payload|contains: - 'value' - 'invoke' - 'comspec' - 'iex'
<li><a href="#">detection: selection_4103: payload|contains|all: - 'new-object' - 'text.encoding]::ascii' payload|contains: - 'system.io.compression.deflatestream' - 'system.io.streamreader' payload|endswith: 'readtoend'
<li><a href="#">detection: selection_4103: payload|contains|all: - 'rundll32.exe' - 'shell32.dll' - 'shellexec_rundll' - 'powershell'
<li><a href="#">detection: selection_4103: payload|contains|all: - 'set' - '&&' - 'mshta' - 'vbscript:createobject' - '.run' - '(window.close)'
<li><a href="#">detection: selection_4103: payload|re: '(?i).*&&set.*(\{\d\}){2,}\\\"\s+?\-f.*&&.*cmd.*\/c' # fps with |\/r
<li><a href="#">detection: selection_4103: payload|re: '(?i).*(set).*&&\s?set.*(environment|invoke).*&&.*"'
<li><a href="#">detection: selection_4103: payload|re: '(?i).*?echo.*clip.*&&.*(clipboard|i`?n`?v`?o`?k`?e`?).*'
<li><a href="#">detection: selection_4103: payload|re: '.*cmd.{0,5}(?:\/c|\/r)(?:\s|)\"set\s[a-za-z]{3,6}.*(?:\{\d\}){1,}\\\"\s+?\-f(?:.*\)){1,}.*\"'
<li><a href="#">detection: selection_4103: payload|re: '.*cmd.{0,5}(?:\/c|\/r).+clip(?:\.exe)?.{0,4}&&.+clipboard]::\(\s\\\"\{\d\}.+\-f.+\"'
<li><a href="#">detection: selection_4103: payload|re: '.*cmd.{0,5}(?:\/c|\/r).+powershell.+(?:\$\{?input\}?|noexit).+\"'
<li><a href="#">detection: selection_4104: scriptblocktext|contains|all: - '&&' - 'rundll32' - 'shell32.dll' - 'shellexec_rundll' scriptblocktext|contains: - 'value' - 'invoke' - 'comspec' - 'iex'
<li><a href="#">detection: selection_4104: scriptblocktext|contains|all: - 'compress-archive ' - ' -path ' - ' -destinationpath ' - '$env:temp\'
<li><a href="#">detection: selection_4104: scriptblocktext|contains|all: - 'new-object' - 'text.encoding]::ascii' scriptblocktext|contains: - 'system.io.compression.deflatestream' - 'system.io.streamreader' scriptblocktext|endswith: 'readtoend'
<li><a href="#">detection: selection_4104: scriptblocktext|contains|all: - 'rundll32.exe' - 'shell32.dll' - 'shellexec_rundll' - 'powershell'
<li><a href="#">detection: selection_4104: scriptblocktext|contains|all: - 'set' - '&&' - 'mshta' - 'vbscript:createobject' - '.run' - '(window.close)'
<li><a href="#">detection: selection_4104: scriptblocktext|re: '(?i).*&&set.*(\{\d\}){2,}\\\"\s+?\-f.*&&.*cmd.*\/c' # fps with |\/r
<li><a href="#">detection: selection_4104: scriptblocktext|re: '(?i).*(set).*&&\s?set.*(environment|invoke).*&&.*"'
<li><a href="#">detection: selection_4104: scriptblocktext|re: '(?i).*?echo.*clip.*&&.*(clipboard|i`?n`?v`?o`?k`?e`?).*'
<li><a href="#">detection: selection_4104: scriptblocktext|re: '.*cmd.{0,5}(?:\/c|\/r)(?:\s|)\"set\s[a-za-z]{3,6}.*(?:\{\d\}){1,}\\\"\s+?\-f(?:.*\)){1,}.*\"'
<li><a href="#">detection: selection_4104: scriptblocktext|re: '.*cmd.{0,5}(?:\/c|\/r).+clip(?:\.exe)?.{0,4}&&.+clipboard]::\(\s\\\"\{\d\}.+\-f.+\"'
<li><a href="#">detection: selection_4104: scriptblocktext|re: '.*cmd.{0,5}(?:\/c|\/r).+powershell.+(?:\$\{?input\}?|noexit).+\"'
<li><a href="#">detection: selection_517: eventid: 517 provider_name: security selection_1102: eventid: 1102 provider_name: microsoft-windows-eventlog
<li><a href="#">detection: selection_7z: commandline|contains: - '7z.exe' - '7za.exe' selection_password: commandline|contains: ' -p' selection_action: commandline|contains: - ' a ' - ' u '
<li><a href="#">detection: selection_action: commandline|contains: - 'stop-service ' - 'remove-service ' selection_product: commandline|contains: - ' mcafeedlpagentservice' - ' trend micro deep security manager' - ' tmbmserver' # feel free to add more service name
<li><a href="#">detection: selection_action: scriptblocktext|contains: - 'get-service ' - 'get-childitem ' - 'get-process ' selection_redirect: scriptblocktext|contains: '> $env:temp\'
<li><a href="#">detection: selection_action: scriptblocktext|contains: - get-wmiobject - gwmi selection_module: scriptblocktext|contains: - msacpi_thermalzonetemperature - win32_computersystem
<li><a href="#">detection: selection_auditpol_binary: image|endswith: '\auditpol.exe' selection_auditpol_command: commandline|contains: - 'disable' # disables a specific audit policy - 'clear' # delete or clears audit policy - 'remove' # removes an audit policy - 'restore' # restores an audit policy
<li><a href="#">detection: selection_auto: c-uri|contains: '/autodiscover.json' selection_uri: c-uri|contains: - '/powershell' - '/mapi/nspi' - '/ews' - 'x-rps-cat' selection: sc-status: 401 selection_poc: c-uri|contains: # since we don't know how it will appear in the log files, we'll just use all versions - 'autodiscover.json?@' - 'autodiscover.json%3f@' - '%3f@foo.com' - 'email=autodiscover/autodiscover.json' - 'json?@foo.com'
<li><a href="#">detection: selection_auto: c-uri|contains: '/autodiscover.json' selection_uri: c-uri|contains: - '/powershell' - '/mapi/nspi' - '/ews' - 'x-rps-cat' selection_success: sc-status: - 200 - 301
<li><a href="#">detection: selection_base: c-uri|contains: - '/tmui/' - '/hsqldb' selection_traversal: c-uri|contains: - '..;/' - '.jsp/..'
<li><a href="#">detection: selection_base: eventid: 4704 selection_keywords: privilegelist|contains: 'seenabledelegationprivilege'
<li><a href="#">detection: selection_base: eventservice: admin.googleapis.com eventname: - enforce_strong_authentication - allow_strong_authentication selection_eventvalue: new_value: 'false'
<li><a href="#">detection: selection_basic: image|endswith: \attrib.exe commandline|contains: ' +s' selection_paths: commandline|contains: - ' %' # custom environment variable - '\users\public\' - '\appdata\local\' - '\programdata\' - '\downloads\' - '\windows\temp\' selection_ext: commandline|contains: - '.bat' - '.ps1' - '.vbe' - '.vbs' - '.exe' filter: commandline|contains|all: - '\windows\temp\' - '.exe'
<li><a href="#">detection: selection_basic: scriptblocktext|contains: 'get-keystrokes' selection_high: # want to run in background and keyboard scriptblocktext|contains|all: - 'get-procaddress user32.dll getasynckeystate' - 'get-procaddress user32.dll getforegroundwindow'
<li><a href="#">detection: selection_binary: - image|endswith: '\mpiexec.exe' - imphash: 'd8b52ef6aaa3a81501bdfff9dbb96217' - hashes|contains: 'imphash=d8b52ef6aaa3a81501bdfff9dbb96217' selection_flags: commandline|contains: - ' /n 1 ' - ' -n 1 '
<li><a href="#">detection: selection_cab: image|endswith: '\winword.exe' targetfilename|endswith: '.cab' targetfilename|contains: '\windows\inetcache' selection_inf: image|endswith: '\winword.exe' targetfilename|contains|all: - '\appdata\local\temp\' - '.inf' filter_legit: targetfilename|startswith: 'c:\users\' targetfilename|contains: 'appdata\local\temp' targetfilename|endswith: '\content.inf'
<li><a href="#">detection: selection_call: image|endswith: '\rundll32.exe' parentimage|endswith: '\cmd.exe' commandline|contains: 'user32.dll,' selection_function: commandline|contains: 'lockworkstation'
<li><a href="#">detection: selection_cammute: image|endswith: '\cammute.exe' filter_cammute: image|contains: - '\lenovo\communication utility\' - '\lenovo\communications utility\' selection_chrome_frame: image|endswith: '\chrome_frame_helper.exe' filter_chrome_frame: image|contains: '\google\chrome\application\' selection_devemu: image|endswith: '\dvcemumanager.exe' filter_devemu: image|contains: '\microsoft device emulator\' selection_gadget: image|endswith: '\gadget.exe' filter_gadget: image|contains: '\windows media player\' selection_hcc: image|endswith: '\hcc.exe' filter_hcc: image|contains: '\html help workshop\' selection_hkcmd: image|endswith: '\hkcmd.exe' filter_hkcmd: image|contains: - '\system32\' - '\sysnative\' - '\syswow64\' selection_mc: image|endswith: '\mc.exe' filter_mc: image|contains: - '\microsoft visual studio' - '\microsoft sdk' - '\windows kit' selection_msmpeng: image|endswith: '\msmpeng.exe' filter_msmpeng: image|contains: - '\microsoft security client\' - '\windows defender\' - '\antimalware\' selection_msseces: image|endswith: '\msseces.exe' filter_msseces: image|contains: - '\microsoft security center\' - '\microsoft security client\' - '\microsoft security essentials\' selection_oinfo: image|endswith: '\oinfop11.exe' filter_oinfo: image|contains: '\common files\microsoft shared\' selection_oleview: image|endswith: '\oleview.exe' filter_oleview: image|contains: - '\microsoft visual studio' - '\microsoft sdk' - '\windows kit' - '\windows resource kit\' selection_rc: image|endswith: '\rc.exe' filter_rc: image|contains: - '\microsoft visual studio' - '\microsoft sdk' - '\windows kit' - '\windows resource kit\' - '\microsoft.net\'
<li><a href="#">detection: selection_clear_1: commandline|contains|all: - 'cl' - '/trace' selection_clear_2: commandline|contains|all: - 'clear-log' - '/trace' selection_disable_1: commandline|contains|all: - 'sl' - '/e:false' selection_disable_2: commandline|contains|all: - 'set-log' - '/e:false' selection_disable_3: #etw provider removal from a trace session commandline|contains|all: - 'logman' - 'update' - 'trace' - '--p' - '-ets' selection_pwsh_remove: #autologger provider removal commandline|contains: 'remove-etwtraceprovider' selection_pwsh_set: #provider â€œenableâ€ property modification commandline|contains|all: - 'set-etwtraceprovider' - '0x11'
<li><a href="#">detection: selection_cli: commandline|contains: - '/in:' - '/out:' - '/uri:' selection_img: - image|endswith: '\datasvcutil.exe' - originalfilename: 'datasvcutil.exe'
<li><a href="#">detection: selection_cli: commandline|contains|all: - '/updatedeploymentprovider' - '/runhandlercomserver' - '.dll' selection_img: - image|endswith: '\wuauclt.exe' - originalfilename: 'wuauclt.exe' filter: commandline|contains: - ' /classid ' - ' wuaueng.dll '
<li><a href="#">detection: selection_cli: commandline|contains|all: - 'wmic' - 'product where ' - 'call uninstall' - '/nointeractive' commandline|contains: - ' name=' - 'caption like ' selection_product: commandline|contains: - 'antivirus' - 'avg ' - 'crowdstrike sensor' - 'dlp endpoint' - 'endpoint detection' - 'endpoint protection' - 'endpoint security' - 'endpoint sensor' - 'eset file security' - 'malwarebytes' - 'mcafee agent' - 'microsoft security client' - 'threat protection' - 'virusscan' - 'webroot secureanywhere' - 'windows defender' - 'carbonblack' - 'carbon black' - 'cb defense sensor 64-bit' - 'dell threat defense' - 'cylance ' - 'logrhythm system monitor service'
<li><a href="#">detection: selection_cli: image|endswith: '\msdt.exe' commandline|contains: '\windows\diagnostics\index\pcwdiagnostic.xml' selection_answer: commandline|contains: - ' -af ' - ' /af ' filter: parentimage|endswith: '\pcwrun.exe'
<li><a href="#">detection: selection_cmd: commandline|contains: 'invoke-athremotefxvgpudisablementcommand ' selection_opt: commandline|contains: - '-modulename ' - '-modulepath ' - '-scriptblock ' - '-remotefxvgpudisablementfilepath'
<li><a href="#">detection: selection_cmd: contextinfo|contains: 'invoke-athremotefxvgpudisablementcommand ' selection_opt: contextinfo|contains: - '-modulename ' - '-modulepath ' - '-scriptblock ' - '-remotefxvgpudisablementfilepath'
<li><a href="#">detection: selection_cmd: hostapplication|contains: 'invoke-athremotefxvgpudisablementcommand ' selection_opt: hostapplication|contains: - '-modulename ' - '-modulepath ' - '-scriptblock ' - '-remotefxvgpudisablementfilepath'
<li><a href="#">detection: selection_cmd: scriptblocktext|contains|all: - copy-item - '-destination' selection_path: scriptblocktext|contains: - '\opera software\opera stable\login data' - '\mozilla\firefox\profiles' - '\microsoft\edge\user data\default' - '\google\chrome\user data\default\login data' - '\google\chrome\user data\default\login data for account'
<li><a href="#">detection: selection_cmd: scriptblocktext|contains|all: - vaultcmd - '/listcreds:' selection_option: scriptblocktext|contains: - 'windows credentials' - 'web credentials'
<li><a href="#">detection: selection_cmd_to_system: # escalation to local_system commandline|endswith: ' -s cmd.exe' selection_supporting_flags: commandline|contains: - 'psexec' - 'paexec' - 'accepteula' - 'cmd /c '
<li><a href="#">detection: selection_cmd1: commandline|contains|all: - 'cmd.exe /c ' - ' -p 0x' selection_cmd2: commandline|contains: - 'c:\programdata\' - 'c:\recycler\' selection_rundll1: commandline|contains|all: - 'rundll32.exe ' - 'c:\programdata\' selection_rundll2: commandline|contains: - '.bin,' - '.tmp,' - '.dat,' - '.io,' - '.ini,' - '.db,'
<li><a href="#">detection: selection_cmdlet: - 'oabvirtualdirectory' - ' -externalurl ' selection_params: - 'eval(request' - '<script' - '"unsafe"};' - 'function page_load()'
<li><a href="#">detection: selection_cmdlet: - scriptblocktext|contains: invoke-dnsexfiltrator - scriptblocktext|contains|all: - ' -i ' - ' -d ' - ' -p ' - ' -doh ' - ' -t '
<li><a href="#">detection: selection_cmdlet: scriptblocktext|contains: - 'invoke-webrequest' - 'iwr ' selection_method: scriptblocktext|contains: '-method ' selection_verb: - ' put ' - ' post '
<li><a href="#">detection: selection_cmdlet: scriptblocktext|contains: - 'new-scheduledtaskaction' - 'new-scheduledtasktrigger' - 'new-scheduledtaskprincipal' - 'new-scheduledtasksettingsset' - 'new-scheduledtask' - 'register-scheduledtask' selection_cimmethod: scriptblocktext|contains|all: - 'invoke-cimmethod' - '-classname' - 'ps_scheduledtask' - '-namespace' - 'root\microsoft\windows\taskscheduler'
<li><a href="#">detection: selection_cmdlet: scriptblocktext|contains: 'enable-psremoting '
<li><a href="#">detection: selection_cmdlet: scriptblocktext|contains: send-mailmessage
<li><a href="#">detection: selection_cmdlet: scriptblocktext|contains|all: - 'invoke-command ' - ' -computername '
<li><a href="#">detection: selection_cmdline: commandline|contains|all: - 'hklm\system\currentcontrolset\control\lsa' - 'scecli\0*' - 'reg add'
<li><a href="#">detection: selection_cmdline_1: commandline|contains|all: - 'sc ' - 'config ' - 'binpath=' selection_cmdline_2: commandline|contains|all: - 'sc ' - 'failure' - 'command=' selection_cmdline_3: commandline|contains|all: - 'reg ' - 'add ' - 'failurecommand' commandline|contains: - '.sh' - '.exe' - '.dll' - '.bin$' - '.bat' - '.cmd' - '.js' - '.msh$' - '.reg$' - '.scr' - '.ps' - '.vb' - '.jar' - '.pl' selection_cmdline_4: commandline|contains|all: - 'reg ' - 'add ' - 'imagepath' commandline|contains: - '.sh' - '.exe' - '.dll' - '.bin$' - '.bat' - '.cmd' - '.js' - '.msh$' - '.reg$' - '.scr' - '.ps' - '.vb' - '.jar' - '.pl'
<li><a href="#">detection: selection_combined_1: image|endswith: '\powershell.exe' commandline|contains: -' | iex;' -' | iex ' -' | iex}' -' | iex;' -' | iex ;' -' | iex -error' -' | iex (new' -' | iex (new' -');iex ' selection_combined_2: commandline|contains: - '::frombase64string' - '.getstring([system.convert]::' selection_standalone: commandline|contains: -')|iex;$' -')|iex;$' -');iex($' -');iex $' -' | iex | '
<li><a href="#">detection: selection_compspec: scriptblocktext|contains|all: - 'start-process' - '-filepath "$env:comspec" ' - '-argumentlist ' - '>'
<li><a href="#">detection: selection_comsvcs: commandline|contains: - 'comsvcs.dll' - 'rundll32' - '.dmp' selection_function: commandline|contains: - '#24' - '#+24' - 'minidump' selection_full: commandline|contains: ' full' unique_selection: commandline|contains: '#-4294967272' #
<li><a href="#">detection: selection_content: scriptblocktext|contains: - set-content - add-content selection_stream: scriptblocktext|contains: '-stream'
<li><a href="#">detection: selection_convert_b64: contextinfo|contains|all: - '-nop' - ' -w ' - 'hidden' - ' -c ' - '[convert]::frombase64string' selection_iex: contextinfo|contains|all: - ' -w ' - 'hidden' - '-noni' - '-nop' - ' -c ' - 'iex' - 'new-object' selection_enc: contextinfo|contains|all: - ' -w ' - 'hidden' - '-ep' - 'bypass' - '-enc' selection_reg: contextinfo|contains|all: - 'powershell' - 'reg' - 'add' - 'hkcu\software\microsoft\windows\currentversion\run' selection_webclient: contextinfo|contains|all: - 'bypass' - '-noprofile' - '-windowstyle' - 'hidden' - 'new-object' - 'system.net.webclient' - '.download' selection_iex_webclient: contextinfo|contains|all: - 'iex' - 'new-object' - 'net.webclient' - '.download' filter_chocolatey: contextinfo|contains: - "(new-object system.net.webclient).downloadstring('" - 'write-chocolateywarning'
<li><a href="#">detection: selection_create: image|endswith: '\schtasks.exe' commandline|contains: ' /create ' selection_command: commandline|contains: - 'powershell' - 'cmd /c ' - 'cmd.exe /c ' selection1_all_folders: commandline|contains: - 'c:\programdata\' - '%programdata%'
<li><a href="#">detection: selection_curl: - image|endswith: '\curl.exe' - product: 'the curl executable' selection_opt: commandline|contains: - ' -a ' - ' --user-agent '
<li><a href="#">detection: selection_curl: - image|endswith: '\curl.exe' - product: 'the curl executable' selection_susp_flags: commandline|contains: - ' start ' - '&call ' - '& call '
<li><a href="#">detection: selection_curl: - image|endswith: '\curl.exe' - product: 'the curl executable' selection_susp_locations: commandline|contains: - '\appdata\' - '\users\public\' - '\temp' - '%appdata%' - '%temp%' - '%public%' - '\desktop' selection_susp_extensions: commandline|endswith: - '.jpg' - '.jpeg' - '.png' - '.gif' - '.tmp' - '.temp' - '.txt' selection_susp_remote_name: commandline|contains: - ' -o' # alias for --remote-name - '--remote-name'
<li><a href="#">detection: selection_cutil: commandline|endswith: '/i:%appdata%\logs.txt scrobj.dll' image|endswith: '\cutil.exe' selection_regsvr32: commandline|endswith: '/i:%appdata%\logs.txt scrobj.dll' description: 'microsoft(c) registerserver'
<li><a href="#">detection: selection_destination: - destination|contains|all: - 'new-object' - 'net.webclient' - '.downloadstring' - destination|contains|all: - 'new-object' - 'net.webclient' - '.downloadfile' - destination|contains: - ' iex(' - 'wscript.shell' - ' -nop ' - ' -noprofile ' - ' -decode ' - ' -enc ' - destination|contains: - 'wscript.shell' - 'system.security.cryptography.frombase64transform'
<li><a href="#">detection: selection_destination: destination|base64offset|contains: - 'writeprocessmemory' - 'this program cannot be run in dos mode' - 'this program must be run under win32'
<li><a href="#">detection: selection_dismhost: image|endswith: '\dismhost.exe' parentcommandline|contains|all: - '/online' - '/disable-feature' - '/featurename:' - '/remove' #/norestart #/quiet selection_dism: image|endswith: '\dism.exe' commandline|contains|all: - '/online' - '/disable-feature' - '/featurename:' - '/remove' #/norestart #/quiet
<li><a href="#">detection: selection_dll: imageloaded|endswith: microsoftaccounttokenprovider.dll filter_legit: - image|endswith: - '\backgroundtaskhost.exe' - '\devenv.exe' - '\iexplore.exe' - '\microsoftedge.exe' - '\microsoft\edge\application\msedge.exe' - '\appdata\local\microsoft\onedrive\onedrive.exe' - '\msedgewebview2.exe' - '\onedrive.exe' - image|startswith: - 'c:\program files (x86)\microsoft\edgewebview\application\'
<li><a href="#">detection: selection_domains: eventtype: setvalue targetobject|contains: \software\microsoft\windows\currentversion\internet settings filter_dword: details|startswith: dword filter_office: details: - 'cookie:' - 'visited:' - '(empty)' filter_path: targetobject|contains: - '\cache' - '\zonemap' - '\wpaddecision' filter_binary: details: 'binary data'
<li><a href="#">detection: selection_domains: eventtype: setvalue targetobject|contains: \software\microsoft\windows\currentversion\internet settings\zonemap\domains\ filter: details: - dword (0x00000000) # my computer - dword (0x00000001) # local intranet zone - '(empty)'
<li><a href="#">detection: selection_download: - image|endswith: - '\curl.exe' - '\wget.exe' - commandline|contains: - 'start-bitstransfer' - '.downloadfile(' - '.downloadstring(' selection_domains: commandline|contains: - '' - ''
<li><a href="#">detection: selection_edge: eventtype: setvalue targetobject|endswith: '\software\policies\microsoft\edge\builtindnsclientenabled' details: dword (0x00000001) selection_chrome: eventtype: setvalue targetobject|endswith: '\software\google\chrome\dnsoverhttpsmode' details: 'secure' selection_firefox: eventtype: setvalue targetobject|endswith: '\software\policies\mozilla\firefox\dnsoverhttps\enabled' details: dword (0x00000001)
<li><a href="#">detection: selection_encoded: commandline|base64offset|contains: - 'add-mppreference ' - 'set-mppreference ' - 'add-mppreference ' - 'set-mppreference ' commandline|contains: # utf16-le - 'qqbkagqalqbnahaauabyaguazgblahiazqbuagmazqaga' - 'eazabkac0atqbwafaacgblagyazqbyaguabgbjaguaia' - 'bagqazaatae0acabqahiazqbmaguacgblag4aywblacaa' - 'uwblahqalqbnahaauabyaguazgblahiazqbuagmazqaga' - 'mazqb0ac0atqbwafaacgblagyazqbyaguabgbjaguaia' - 'taguadaatae0acabqahiazqbmaguacgblag4aywblacaa' - 'yqbkagqalqbtahaacabyaguazgblahiazqbuagmazqaga' - 'eazabkac0abqbwahaacgblagyazqbyaguabgbjaguaia' - 'hagqazaatag0acabwahiazqbmaguacgblag4aywblacaa' - 'cwblahqalqbtahaacabyaguazgblahiazqbuagmazqaga' - 'mazqb0ac0abqbwahaacgblagyazqbyaguabgbjaguaia' - 'zaguadaatag0acabwahiazqbmaguacgblag4aywblacaa'
<li><a href="#">detection: selection_encoded: contextinfo|contains: - ' -enc ' - ' -encodedcommand ' selection_hidden: contextinfo|contains: - ' -w hidden ' - ' -window hidden ' - ' -windowstyle hidden ' selection_noninteractive: contextinfo|contains: - ' -noni ' - ' -noninteractive '
<li><a href="#">detection: selection_encoded: scriptblocktext|contains: - ' -enc ' - ' -encodedcommand ' selection_hidden: scriptblocktext|contains: - ' -w hidden ' - ' -window hidden ' - ' -windowstyle hidden ' selection_noninteractive: scriptblocktext|contains: - ' -noni ' - ' -noninteractive '
<li><a href="#">detection: selection_endpoint: c-uri|contains: - '+cscot+/translation-table' - '+cscot+/oem-customization' selection_path_select: c-uri|contains: - '&textdomain=/' - '&textdomain=%' - '&name=/' - '&name=%' select_status_code: sc-status: 200
<li><a href="#">detection: selection_error: description|contains: - 'failed to open service configuration with error' - 'failed to connect to the driver to update configuration' filter_generic_english: description|contains|all: - 'failed to open service configuration with error' - 'last error: the media is write protected.' filter_by_errorcode: description|contains: - 'failed to open service configuration with error 19' - 'failed to open service configuration with error 93'
<li><a href="#">detection: selection_eventname: eventname: list* timeframe: 10m
<li><a href="#">detection: selection_exe: commandline|contains: - 'dir ' - 'findstr ' selection_ext: commandline|contains: - '.key' - '.pgp' - '.gpg' - '.ppk' - '.p12' - '.pem' - '.pfx' - '.cer' - '.p7b' - '.asc'
<li><a href="#">detection: selection_exe: image|endswith: - '\accesschk.exe' - '\accesschk64.exe' - '\accessenum.exe' - '\adexplorer.exe' - '\adexplorer64.exe' - '\adinsight.exe' - '\adinsight64.exe' - '\adrestore.exe' - '\adrestore64.exe' - '\autologon.exe' - '\autologon64.exe' - '\autoruns.exe' - '\autoruns64.exe' - '\autorunsc.exe' - '\autorunsc64.exe' - '\bginfo.exe' - '\bginfo64.exe' - '\cacheset.exe' - '\cacheset64.exe' - '\clockres.exe' - '\clockres64.exe' - '\contig.exe' - '\contig64.exe' - '\coreinfo.exe' - '\coreinfo64.exe' - '\cpustres.exe' - '\cpustres64.exe' - '\ctrl2cap.exe' - '\dbgview.exe' - '\dbgview64.exe' - '\desktops.exe' - '\desktops64.exe' - '\disk2vhd.exe' - '\disk2vhd64.exe' - '\diskext.exe' - '\diskext64.exe' - '\diskmon.exe' - '\diskmon64.exe' - '\diskview.exe' - '\diskview64.exe' - '\du.exe' - '\du64.exe' - '\efsdump.exe' - '\findlinks.exe' - '\findlinks64.exe' - '\handle.exe' - '\handle64.exe' - '\hex2dec.exe' - '\hex2dec64.exe' - '\junction.exe' - '\junction64.exe' - '\ldmdump.exe' - '\listdlls.exe' - '\listdlls64.exe' - '\livekd.exe' - '\livekd64.exe' - '\loadord.exe' - '\loadord64.exe' - '\loadordc.exe' - '\loadordc64.exe' - '\logonsessions.exe' - '\logonsessions64.exe' - '\movefile.exe' - '\movefile64.exe' - '\notmyfault.exe' - '\notmyfault64.exe' - '\notmyfaultc.exe' - '\notmyfaultc64.exe' - '\ntfsinfo.exe' - '\ntfsinfo64.exe' - '\pendmoves.exe' - '\pendmoves64.exe' - '\pipelist.exe' - '\pipelist64.exe' - '\portmon.exe' - '\procdump.exe' - '\procdump64.exe' - '\procexp.exe' - '\procexp64.exe' - '\procmon.exe' - '\procmon64.exe' - '\psexec.exe' - '\psexec64.exe' - '\psfile.exe' - '\psfile64.exe' - '\psgetsid.exe' - '\psgetsid64.exe' - '\psinfo.exe' - '\psinfo64.exe' - '\pskill.exe' - '\pskill64.exe' - '\pslist.exe' - '\pslist64.exe' - '\psloggedon.exe' - '\psloggedon64.exe' - '\psloglist.exe' - '\psloglist64.exe' - '\pspasswd.exe' - '\pspasswd64.exe' - '\psping.exe' - '\psping64.exe' - '\psservice.exe' - '\psservice64.exe' - '\psshutdown.exe' - '\psshutdown64.exe' - '\pssuspend.exe' - '\pssuspend64.exe' - '\rammap.exe' - '\rdcman.exe' - '\regdelnull.exe' - '\regdelnull64.exe' - '\regjump.exe' - '\ru.exe' - '\ru64.exe' - '\sdelete.exe' - '\sdelete64.exe' - '\shareenum.exe' - '\shareenum64.exe' - '\shellrunas.exe' - '\sigcheck.exe' - '\sigcheck64.exe' - '\streams.exe' - '\streams64.exe' - '\strings.exe' - '\strings64.exe' - '\sync.exe' - '\sync64.exe' - '\sysmon.exe' - '\sysmon64.exe' - '\tcpvcon.exe' - '\tcpvcon64.exe' - '\tcpview.exe' - '\tcpview64.exe' - '\testlimit.exe' - '\testlimit64.exe' - '\vmmap.exe' - '\vmmap64.exe' - '\volumeid.exe' - '\volumeid64.exe' - '\whois.exe' - '\whois64.exe' - '\winobj.exe' - '\winobj64.exe' - '\zoomit.exe' - '\zoomit64.exe' filter_valid: company: - 'sysinternals - www.sysinternals.com' - 'sysinternals' filter_empty: company: null
<li><a href="#">detection: selection_ext: commandline|contains: - '.doc' - '.docx' - '.xls' - '.xlsx' - '.ppt' - '.pptx' - '.rtf' - '.pdf' - '.txt' selection_dir: commandline|contains|all: - 'dir ' - ' /b ' - ' /s ' selection_findstr: originalfilename: findstr.exe commandline|contains: - ' /e ' - ' /si '
<li><a href="#">detection: selection_ext: scriptblocktext|contains: - '.doc' - '.docx' - '.xls' - '.xlsx' - '.ppt' - '.pptx' - '.rtf' - '.pdf' - '.txt' selection_cmd: scriptblocktext|contains|all: - 'get-childitem' - ' -recurse ' - ' -include '
<li><a href="#">detection: selection_ext: targetfilename|endswith: - .docm - .dotm - .xlsm - .xltm - .potm - .pptm - .pptx selection_cmd: - image|endswith: - \cmd.exe - \powershell.exe - parentimage|endswith: - \cmd.exe - \powershell.exe
<li><a href="#">detection: selection_file: targetfilename|endswith: - '\all.cab' # - '.ntds.cleartext' #
<li><a href="#">detection: selection_file: targetfilename|endswith: '\ntds.dit' selection_process: - parentimage|endswith: - '\powershell.exe' - '\wscript.exe' - '\cscript.exe' - '\w3wp.exe' - '\php-cgi.exe' - '\nginx.exe' - '\httpd.exe' - parentimage|contains: - '\apache' - '\tomcat' - '\appdata\' - '\temp\' - '\public\' - '\perflogs\' - image|contains: - '\appdata\' - '\temp\' - '\public\' - '\perflogs\'
<li><a href="#">detection: selection_findstr: - commandline|contains: findstr - image|endswith: 'findstr.exe' - originalfilename: 'findstr.exe' selection_cli_download_1: commandline|contains: - /v - -v selection_cli_download_2: commandline|contains: - /l - -l selection_cli_creds_1: commandline|contains: - /s - -s selection_cli_creds_2: commandline|contains: - /i - -i
<li><a href="#">detection: selection_flags: commandline|contains|all: - ' /s' - ' /u' selection_ip: commandline|contains: - ' /i:' - ' /i:' - ' /i:' - ' /i:' - ' /i:' - ' /i:' - ' /i:' - ' /i:' - ' /i:'
<li><a href="#">detection: selection_flags_1: # escalation to local_system commandline|endswith: - ' -s cmd.exe' - ' -s -i cmd.exe' selection_flags_2: commandline|contains|all: # accepting eula in commandline - often used in automated attacks - 'accepteula' - ' -u ' - ' -p ' - ' \\' filter: commandline|contains: - 'paexec' - 'psexec'
<li><a href="#">detection: selection_general: parentimage|endswith: - '/httpd' - '/lighttpd' - '/nginx' - '/apache2' - '/node' - '/caddy' selection_tomcat: parentcommandline|contains|all: - '/bin/java' - 'tomcat' selection_websphere: # ? just guessing parentcommandline|contains|all: - '/bin/java' - 'websphere' selection_sub_processes: image|endswith: - '/whoami' - '/ifconfig' - '/usr/bin/ip' - '/bin/uname'
<li><a href="#">detection: selection_hidefileext: eventtype: setvalue targetobject|endswith: \software\microsoft\windows\currentversion\explorer\advanced\hidefileext details: dword (0x00000001) selection_hidden: eventtype: setvalue targetobject|endswith: \software\microsoft\windows\currentversion\explorer\advanced\hidden details: dword (0x00000002)
<li><a href="#">detection: selection_id: eventid: 4697 selection: # meterpreter getsystem technique 1: cmd.exe /c echo 559891bb017 > \\.\pipe\5e120a - servicefilename|contains|all: - 'cmd' - '/c' - 'echo' - '\pipe\' # cobaltstrike getsystem technique 1: %comspec% /c echo 559891bb017 > \\.\pipe\5e120a - servicefilename|contains|all: - '%comspec%' - '/c' - 'echo' - '\pipe\' # cobaltstrike getsystem technique 1b (expanded %comspec%): %comspec% /c echo 559891bb017 > \\.\pipe\5e120a - servicefilename|contains|all: - 'cmd.exe' - '/c' - 'echo' - '\pipe\' # meterpreter getsystem technique 2: rundll32.exe c:\users\test\appdata\local\temp\tmexsn.dll,a /p:tmexsn - servicefilename|contains|all: - 'rundll32' - '.dll,a' - '/p:'
<li><a href="#">detection: selection_id: provider_name: 'service control manager' eventid: 7045 selection: # meterpreter getsystem technique 1: cmd.exe /c echo 559891bb017 > \\.\pipe\5e120a - imagepath|contains|all: - 'cmd' - '/c' - 'echo' - '\pipe\' # cobaltstrike getsystem technique 1: %comspec% /c echo 559891bb017 > \\.\pipe\5e120a - imagepath|contains|all: - '%comspec%' - '/c' - 'echo' - '\pipe\' # cobaltstrike getsystem technique 1b (expanded %comspec%): %comspec% /c echo 559891bb017 > \\.\pipe\5e120a - imagepath|contains|all: - 'cmd.exe' - '/c' - 'echo' - '\pipe\' # meterpreter getsystem technique 2: rundll32.exe c:\users\test\appdata\local\temp\tmexsn.dll,a /p:tmexsn - imagepath|contains|all: - 'rundll32' - '.dll,a' - '/p:' - imagepath|startswith: '\\\\127.0.0.1\\admin$\' #
<li><a href="#">detection: selection_id: provider_name: 'service control manager' eventid: 7045 selection1: imagepath|contains|all: - 'admin$' - '.exe' selection2: imagepath|contains|all: - '%comspec%' - 'start' - 'powershell' selection3: imagepath|contains: 'powershell -nop -w hidden -encodedcommand' selection4: imagepath|base64offset|contains: "iex (new-object net.webclient).downloadstring(':"
<li><a href="#">detection: selection_iex: - scriptblocktext|re: '\$pshome\[\s*\d{1,3}\s*\]\s*\+\s*\$pshome\[' - scriptblocktext|re: '\$shellid\[\s*\d{1,3}\s*\]\s*\+\s*\$shellid\[' - scriptblocktext|re: '\$env:public\[\s*\d{1,3}\s*\]\s*\+\s*\$env:public\[' - scriptblocktext|re: '\$env:comspec\[(\s*\d{1,3}\s*,){2}' - scriptblocktext|re: '\\\\*mdr\\\\*\w\s*\)\.name' - scriptblocktext|re: '\$verbosepreference\.tostring\('
<li><a href="#">detection: selection_image: - image|contains: '\cve-202' - image|endswith: - '\poc.exe' - '\artifact.exe' - '\artifact64.exe' - '\artifact_protected.exe' - '\artifact32.exe' - '\artifact32big.exe' - 'obfuscated.exe' - 'obfusc.exe' - '\meterpreter' selection_commandline: commandline|contains: - 'inject.ps1' - 'invoke-cve' - 'pupy.ps1' - 'payload.ps1' - 'beacon.ps1' - 'powerview.ps1' - 'bypass.ps1' - 'obfuscated.ps1' - 'obfusc.ps1' - 'obfus.ps1' - 'obfs.ps1' - 'evil.ps1' - 'minidogz.ps1' - '_enc.ps1' - '\shell.ps1' - '\rshell.ps1' - 'revshell.ps1' - '\av.ps1' - '\av_test.ps1' - 'adrecon.ps1' - 'mimikatz.ps1' - '\powerup_' - 'powerup.ps1' - '\temp\a.ps1' - '\temp\p.ps1' - '\temp\1.ps1' - 'hound.ps1' - 'encode.ps1' - 'powercat.ps1'
<li><a href="#">detection: selection_image: image|contains: - '/python2.' # python image is always of the form ../python3.10; ../python is just a symlink - '/python3.' selection_cli1: commandline|contains|all: - 'import pty' - '.spawn(' selection_cli2: commandline|contains: 'from pty import spawn'
<li><a href="#">detection: selection_image: image|endswith: - '\powershell.exe' - '\mshta.exe' - '\wscript.exe' - '\cscript.exe' - '\cmd.exe' selection_flags: commandline|contains: - ' -w hidden ' - ' -ep bypass ' - '/e:vbscript ' - '/e:javascript ' selection_original: originalfilename: - 'powershell.exe' - 'mshta.exe' - 'wscript.exe' - 'cscript.exe' - 'cmd.exe' folders: image|contains: - '\windows\temp' - '\temporary internet' - '\appdata\local\temp' - '\appdata\roaming\temp' - 'c:\users\public\' - 'c:\perflogs\'
<li><a href="#">detection: selection_image: image|endswith: - '\tree.com' - '\wmic.exe' - '\doskey.exe' - '\sc.exe' selection_redirect: parentcommandline|contains: ' > %temp%\'
<li><a href="#">detection: selection_image: image|endswith: - 'python.exe' # no \ bc of e.g. ipython.exe - 'python3.exe' - 'python2.exe' selection_cli1: commandline|contains|all: - 'import pty' - '.spawn(' selection_cli2: commandline|contains: 'from pty import spawn'
<li><a href="#">detection: selection_image: image|endswith: '\setspn.exe' selection_desc: description|contains|all: - 'query or reset the computer' - 'spn attribute' cmd: commandline|contains: '-q'
<li><a href="#">detection: selection_image: imageloaded|contains: '\dbutil_2_3.sys' selection_hash: hashes|contains: - '0296e2ce999e67c76352613a718e11516fe1b0efc3ffdb8918fc999dd76a73a5' - 'c948ae14761095e4d76b55d9de86412258be7afd' - 'c996d7971c49252c582171d9380360f2' - 'ddbf5ecca5c8086afde1fb4f551e9e6400e94f4428fe7fb5559da5cffa654cc1' - '10b30bdee43b3a2ec4aa63375577ade650269d25' - 'd2fd132ab7bbc6bbb87a84f026fa0244'
<li><a href="#">detection: selection_image1: - parentimage|endswith: - '\mshta.exe' - '\rundll32.exe' - '\regsvr32.exe' - '\services.exe' - '\winword.exe' - '\wmiprvse.exe' - '\powerpnt.exe' - '\excel.exe' - '\msaccess.exe' - '\mspub.exe' - '\visio.exe' - '\outlook.exe' - '\amigo.exe' - '\chrome.exe' - '\firefox.exe' - '\iexplore.exe' - '\microsoftedgecp.exe' - '\microsoftedge.exe' - '\browser.exe' - '\vivaldi.exe' - '\safari.exe' - '\sqlagent.exe' - '\sqlserver.exe' - '\sqlservr.exe' - '\w3wp.exe' - '\httpd.exe' - '\nginx.exe' - '\php-cgi.exe' - '\jbosssvc.exe' - 'microsoftedgesh.exe' - parentimage|contains: 'tomcat' selection_powershell: - image|endswith: '\powershell.exe' - commandline|contains: - 'powershell' - 'pwsh' - description: 'windows powershell' - product: 'powershell core 6'
<li><a href="#">detection: selection_img: - image|endswith: - '\nsudo.exe' - '\nsudolc.exe' - '\nsudolg.exe' - originalfilename: - 'nsudo.exe' - 'nsudolc.exe' - 'nsudolg.exe' selection_cli: commandline|contains: # covers single/double dash "-"/"--" + ":" - '-u:s ' # system - '-u:t ' # trusted installer - '-u:e ' # elevated - '-p:e ' # enable all privileges - '-m:s ' # system integrity - '-m:h ' # high integrity # covers single/double dash "-"/"--" + "=" - '-u=s ' - '-u=t ' - '-u=e ' - '-p=e ' - '-m=s ' - '-m=h '
<li><a href="#">detection: selection_img: - image|endswith: '\acccheckconsole.exe' - originalfilename: 'acccheckconsole.exe' selection_cli: commandline|contains|all: - ' -window ' - '.dll'
<li><a href="#">detection: selection_img: - image|endswith: '\adplus.exe' - originalfilename: 'adplus.exe' selection_cli: commandline|contains: # dump process memory - ' -hang ' - ' -pn ' - ' -pmn ' - ' -p ' - ' -po ' # using a config file - ' -c ' # execute commands inline - ' -sc '
<li><a href="#">detection: selection_img: - image|endswith: '\cdb.exe' - originalfilename: 'cdb.exe' selection_cli: commandline|contains: - ' -c ' # using a debugger script - ' -cf '
<li><a href="#">detection: selection_img: - image|endswith: '\certoc.exe' - originalfilename: 'certoc.exe' selection_cli: commandline|contains: '-getcacaps'
<li><a href="#">detection: selection_img: - image|endswith: '\certoc.exe' - originalfilename: 'certoc.exe' selection_cli: commandline|contains|all: - '-loaddll' - '.dll'
<li><a href="#">detection: selection_img: - image|endswith: '\certreq.exe' - originalfilename: 'certreq.exe' selection_cli: commandline|contains|all: - ' -post ' - ' -config ' - ' http' - ' c:\windows\win.ini '
<li><a href="#">detection: selection_img: - image|endswith: '\cmdkey.exe' - originalfilename: 'cmdkey.exe' selection_cli: commandline|contains: - ' /l' - ' -l'
<li><a href="#">detection: selection_img: - image|endswith: '\cmdl32.exe' - originalfilename: cmdl32.exe selection_cli: commandline|contains|all: - '/vpn ' - '/lan '
<li><a href="#">detection: selection_img: - image|endswith: '\cmstp.exe' - originalfilename: 'cmstp.exe' selection_cli: commandline|contains: - '/s' - '/au' - '/ni'
<li><a href="#">detection: selection_img: - image|endswith: '\cscript.exe' - originalfilename: 'cscript.exe' selection_cli: commandline|contains|all: - 'winrm' - 'invoke create wmicimv2/win32_' - '-r:http'
<li><a href="#">detection: selection_img: - image|endswith: '\curl.exe' - product: 'the curl executable' selection_cli: commandline|contains: - ' -f ' - ' --form ' - ' -t ' - ' --upload-file ' - ' -d ' - ' --data '
<li><a href="#">detection: selection_img: - image|endswith: '\dsacls.exe' - originalfilename: "dsacls.exe" selection_cli: commandline|contains|all: - '/user:' - '/passwd:'
<li><a href="#">detection: selection_img: - image|endswith: '\dsacls.exe' - originalfilename: "dsacls.exe" selection_flag: commandline|contains: ' /g ' selection_permissions: commandline|contains: # add more permissions as you see fit in yout env - 'gr' - 'ge' - 'gw' - 'ga' - 'wp' - 'wd'
<li><a href="#">detection: selection_img: - image|endswith: '\dxcap.exe' - originalfilename: 'dxcap.exe' selection_cli: commandline|contains: ' -c ' # the ".exe" is not required to run the binary
<li><a href="#">detection: selection_img: - image|endswith: '\esentutl.exe' - originalfilename: 'esentutl.exe' selection_cli: commandline|contains|all: - '/r ' - '\windows\webcache'
<li><a href="#">detection: selection_img: - image|endswith: \forfiles.exe - originalfilename: forfiles.exe selection_cli_p: commandline|contains: - ' /p ' - ' -p ' selection_cli_m: commandline|contains: - ' /m ' - ' -m ' selection_cli_c: commandline|contains: - ' /c ' - ' -c '
<li><a href="#">detection: selection_img: - image|endswith: '\gpscript.exe' - originalfilename: 'gpscript.exe' selection_cli: commandline|contains: - ' /logon' - ' /startup'
<li><a href="#">detection: selection_img: - image|endswith: '\gup.exe' - originalfilename: 'gup.exe' selection_cli: commandline|contains|all: - ' -unzipto ' - 'http' filter: parentimage|endswith: '\notepad++.exe'
<li><a href="#">detection: selection_img: - image|endswith: '\mftrace.exe' - originalfilename: 'mftrace.exe' selection_cli: # this assumes that when someone use mftrace to launch an ".exe" he will add a space and the binary launched will end with ".exe" commandline|contains: '.exe ' commandline|endswith: '.exe' parent: parentimage|endswith: '\mftrace.exe'
<li><a href="#">detection: selection_img: - image|endswith: '\msdt.exe' - originalfilename: 'msdt.exe' selection_cmd: commandline|contains: - ' /cab ' - ' -cab '
<li><a href="#">detection: selection_img: - image|endswith: '\msdt.exe' - originalfilename: 'msdt.exe' selection_cmd: commandline|contains|all: - '/cab' - '.diagcab'
<li><a href="#">detection: selection_img: - image|endswith: '\msdt.exe' - originalfilename: 'msdt.exe' selection_cmd_inline: commandline|contains: 'it_browseforfile=' selection_cmd_answerfile: commandline|contains: ' pcwdiagnostic' selection_cmd_answerfile_param: commandline|contains: - ' /af ' - ' -af '
<li><a href="#">detection: selection_img: - image|endswith: '\presentationhost.exe' - originalfilename: 'presentationhost.exe' selection_cli: commandline|contains: '.xbap' filter: commandline|contains: # filter out legitimate locations if you find them - 'c:\windows\' - 'c:\program files'
<li><a href="#">detection: selection_img: - image|endswith: '\rasautou.exe' - originalfilename: 'rasdlui.exe' selection_cli: commandline|contains|all: - ' -d ' - ' -p '
<li><a href="#">detection: selection_img: - image|endswith: '\rundll32.exe' - originalfilename: 'rundll32.exe' selection_cli: commandline|contains: 'c:\windows\system32\davclnt.dll,davsetcookie'
<li><a href="#">detection: selection_img: - image|endswith: '\scriptrunner.exe' - originalfilename: 'scriptrunner.exe' selection_cli: commandline|contains: ' -appvscript '
<li><a href="#">detection: selection_img: - image|endswith: '\taskkill.exe' - originalfilename: 'taskkill.exe' selection_cli: commandline|contains|all: - ' /f' - ' /im '
<li><a href="#">detection: selection_img: - image|endswith: '\vaultcmd.exe' - originalfilename: 'vaultcmd.exe' selection_cli: commandline|contains: '/listcreds:'
<li><a href="#">detection: selection_img: - image|endswith: '\vsiisexelauncher.exe' - originalfilename: 'vsiisexelauncher.exe' selection_cli: commandline|contains: - ' -p ' - ' -a '
<li><a href="#">detection: selection_img: - image|endswith: '\whoami.exe' - originalfilename: 'whoami.exe' selection_cli: commandline|contains: '/priv'
<li><a href="#">detection: selection_img: - image|endswith: '\winword.exe' - originalfilename: 'winword.exe' selection_cli_http: commandline|contains: - 'http://' - 'https://' selection_cli_dll: commandline|contains: - '/l ' - '.dll'
<li><a href="#">detection: selection_img: - image|endswith: '\wmic.exe' - originalfilename: 'wmic.exe' selection_cli: commandline|contains: ' group'
<li><a href="#">detection: selection_img: - image|endswith: \wmic.exe - originalfilename: 'wmic.exe' selection_cli: commandline|contains: - process - qfe filter: commandline|contains|all: #rule id 526be59f-a573-4eea-b5f7-f0973207634d for `wmic process call create #{process_to_execute}` - call - create
<li><a href="#">detection: selection_img: - image|endswith: \wmic.exe - originalfilename: 'wmic.exe' selection_cli: commandline|contains: call uninstall
<li><a href="#">detection: selection_img: - image|endswith: \wmic.exe - originalfilename: 'wmic.exe' selection_cli: commandline|contains|all: - '/node:' - process - call - create
<li><a href="#">detection: selection_img: - image|endswith: \wmic.exe - originalfilename: 'wmic.exe' selection_cli: commandline|contains|all: - '/node:' - service
<li><a href="#">detection: selection_img: - image|endswith: '\wsl.exe' - originalfilename: 'wsl.exe' selection_cli: commandline|contains: - ' -e ' - ' --exec ' - ' --system ' - ' /mnt/c' # path to mounted "c:\" partition (indication of running windows binaries via wsl)
<li><a href="#">detection: selection_img: - image|endswith: '\wuauclt.exe' - originalfilename: 'wuauclt.exe' selection_cli: commandline|endswith: '\wuauclt.exe'
<li><a href="#">detection: selection_img: - originalfilename: - 'sc.exe' - 'net.exe' - 'net1.exe' - image|endswith: - '\sc.exe' - '\net.exe' - '\net1.exe' selection_cli: commandline|contains: 'stop' filter: commandline: 'sc stop kscwebconsolemessagequeue' # kaspersky security center web console double space between sc and stop user|contains: # covers many language settings - 'authori' - 'autori'
<li><a href="#">detection: selection_img: - originalfilename: 'psloglist.exe' - image|endswith: - '\psloglist.exe' - '\psloglist64.exe' selection_flgs: commandline|contains|all: - 'security' - 'accepteula' commandline|contains: - ' -d' - ' /d' - ' -x' - ' /x' - ' -s' - ' /s'
<li><a href="#">detection: selection_img: - originalfilename: 'wmic.exe' - image|endswith: '\wmic.exe' selection_cli: commandline|contains|all: - ' qfe ' - ' get ' - 'caption,description,hotfixid,installedon'
<li><a href="#">detection: selection_img: - originalfilename: 'wmic.exe' - image|endswith: '\wmic.exe' selection_cli: commandline|contains|all: - ' service ' - ' call ' commandline|contains: - 'stopservice' - 'startservice'
<li><a href="#">detection: selection_img: - originalfilename: 'wmic.exe' - image|endswith: '\wmic.exe' selection_cli: commandline|contains|all: - ' service ' - ' get ' commandline|contains: - name - displayname - pathname - startmode
<li><a href="#">detection: selection_img: - product|endswith: 'accesschk' - description|contains: 'reports effective permissions' - image|endswith: '\accesschk.exe' selection_cli: commandline|contains: # these are the most common flags used with this tool. you could add other combinations if needed - 'uwcqv ' - 'kwsu ' - 'qwsu ' - 'uwdqs '
<li><a href="#">detection: selection_img: image|endswith: '\msdt.exe' selection_load: imageloaded|endswith: '\sdiageng.dll'
<li><a href="#">detection: selection_img: image|endswith: '\schtasks.exe' originalfilename: 'schtasks.exe' selection_cli: commandline|contains|all: - '/change' - '/tn' - '/ru' - '/rp'
<li><a href="#">detection: selection_img: image|endswith: '\squirrel.exe' selection_cli: commandline|contains: - ' --download ' - ' --update ' - ' --updaterollback=' selection_http: commandline|contains: 'http'
<li><a href="#">detection: selection_ioc: - scriptblocktext|contains|all: - 'new-ciminstance ' - '-namespace root/subscription ' - '-classname __eventfilter ' - '-property ' #is a variable name - scriptblocktext|contains|all: - 'new-ciminstance ' - '-namespace root/subscription ' - '-classname commandlineeventconsumer ' - '-property ' #is a variable name
<li><a href="#">detection: selection_ioc: scriptblocktext|contains: - '.creationtime =' - '.lastwritetime =' - '.lastaccesstime =' - '[io.file]::setcreationtime' - '[io.file]::setlastaccesstime' - '[io.file]::setlastwritetime'
<li><a href="#">detection: selection_ioc1: targetobject: 'hkcu\software\classes\clsid\{e08a0f4b-1f65-4d4d-9a09-bd4625b9c5a1}\model' selection_ioc2: targetobject|startswith: - hkcu\software\app\ - hklm\software\app\ targetobject|contains: - appxbf13d4ea2945444d8b13e2121cb6b663\ - appx70162486c7554f7f80f481985d67586d\ - appx37cc7fdccd644b4f85f4b22d5a3f105a\ targetobject|endswith: - application - defaulticon selection_hkcu: targetobject|startswith: 'hkcu\' targetobject|contains: # hkcu\software\classes\appxc52346ec40fb4061ad96be0e6cb7d16a\ - 'classes\appxc52346ec40fb4061ad96be0e6cb7d16a\' # hkcu\software\classes\appx3bbba44c6cae4d9695755183472171e2\ - 'classes\appx3bbba44c6cae4d9695755183472171e2\' # hkcu\software\classes\clsid\{e3517e26-8e93-458d-a6df-8030bc80528b}\ - 'classes\clsid\{e3517e26-8e93-458d-a6df-8030bc80528b}\' - 'classes\clsid\{e08a0f4b-1f65-4d4d-9a09-bd4625b9c5a1}\model'
<li><a href="#">detection: selection_iptables_1: image|endswith: '/service' commandline|contains|all: - 'iptables' - 'stop' selection_iptables_2: image|endswith: '/service' commandline|contains|all: - 'ip6tables' - 'stop' selection_iptables_3: image|endswith: '/chkconfig' commandline|contains|all: - 'iptables' - 'stop' selection_iptables_4: image|endswith: '/chkconfig' commandline|contains|all: - 'ip6tables' - 'stop' selection_firewall_1: image|endswith: '/systemctl' commandline|contains|all: - 'firewalld' - 'stop' selection_firewall_2: image|endswith: '/systemctl' commandline|contains|all: - 'firewalld' - 'disable' selection_carbonblack_1: image|endswith: '/service' commandline|contains|all: - 'cbdaemon' - 'stop' selection_carbonblack_2: image|endswith: '/chkconfig' commandline|contains|all: - 'cbdaemon' - 'off' selection_carbonblack_3: image|endswith: '/systemctl' commandline|contains|all: - 'cbdaemon' - 'stop' selection_carbonblack_4: image|endswith: '/systemctl' commandline|contains|all: - 'cbdaemon' - 'disable' selection_selinux: image|endswith: '/setenforce' commandline|contains: '0' selection_crowdstrike_1: image|endswith: '/systemctl' commandline|contains|all: - 'stop' - 'falcon-sensor' selection_crowdstrike_2: image|endswith: '/systemctl' commandline|contains|all: - 'disable' - 'falcon-sensor'
<li><a href="#">detection: selection_keywords: - '* -u#*'
<li><a href="#">detection: selection_kiddie: scriptblocktext|contains: - 'get-passwordvaultcredentials' - 'get-credmancreds' selection_rename_password: scriptblocktext|contains|all: - 'new-object' - 'windows.security.credentials.passwordvault' selection_rename_credman: scriptblocktext|contains|all: - 'new-object' - 'microsoft.csharp.csharpcodeprovider' - '[system.runtime.interopservices.runtimeenvironment]::getruntimedirectory())' - 'collections.arraylist' - 'system.codedom.compiler.compilerparameters'
<li><a href="#">detection: selection_lolbas: - commandline|contains: extrac32.exe - image|endswith: '\extrac32.exe' - originalfilename: 'extrac32.exe' selection_archive: ommandline|contains: '.cab' selection_options: commandline|contains: - /c - /y - ' \\'
<li><a href="#">detection: selection_loop: commandline|contains: - 'for ' - 'foreach ' selection_tools: commandline|contains: - 'nslookup' - 'ping'
<li><a href="#">detection: selection_lsass_dump1: commandline|contains|all: - 'cmd.exe /c ' - 'tasklist /fi ' - 'imagename eq lsass.exe' user|contains: # covers many language settings - 'authori' - 'autori' selection_lsass_dump2: commandline|contains|all: - 'do rundll32.exe c:\windows\system32\comsvcs.dll, minidump' - '\windows\temp\' - ' full' - '%%b' selection_procdump: commandline|contains|all: - 'tasklist /v /fo csv' - 'findstr /i "lsass"'
<li><a href="#">detection: selection_lsass_dump1: targetfilename|startswith: 'c:\windows\temp\' image: 'c:\windows\system32\rundll32.exe' user|contains: # covers many language settings - 'authori' - 'autori' targetfilename|endswith: - '.rtf' - '.otf' - '.odt' - '.txt' - '.doc' - '.pdf' - '.dll' - '.docx' - '.wpd' - '.icns' - '.db' - '.ini' - '.tex' - '.sys' - '.csv' - '.fon' - '.tar' - '.ttf' - '.xml' - '.cfg' - '.cpl' - '.jpg' - '.drv' - '.cur' - '.tmp' # list is incomplete selection_procdump: targetfilename: 'c:\windows\temp\procdump.exe' user|contains: # covers many language settings - 'authori' - 'autori'
<li><a href="#">detection: selection_malleable_profiles: - pipename|startswith: - '\mojo.5688.8052.183894939787088877' - '\mojo.5688.8052.35780273329370473' - '\mypipe-f' - '\mypipe-h' - '\ntsvcs' - '\scerpc' - '\win_svc' - '\spoolss' - '\msrpc_' - '\win\msrpc_' - '\wkssvc' - '\f53f' - '\windows.update.manager' - '\searchtextharvester' - '\dsernamepipe' - '\pgmessagepipe' - '\msftewds' - '\f4c3' - '\fullduplex_' - '\rpc_' - pipename: - '\demoagent_11' - '\demoagent_22' selection_malleable_profile_catalogchangelistener: pipename|startswith: '\winsock2\catalogchangelistener-' pipename|endswith: '-0,' filter: pipename: - '\wkssvc' - '\spoolss' - '\scerpc' - '\ntsvcs' - '\searchtextharvester' - '\pgmessagepipe' - '\msftewds'
<li><a href="#">detection: selection_mobsync: image|endswith: '\mobsync.exe' filter: destinationip|startswith: - '10.' - '192.168.' - '172.16.' - '172.17.' - '172.18.' - '172.19.' - '172.20.' - '172.21.' - '172.22.' - '172.23.' - '172.24.' - '172.25.' - '172.26.' - '172.27.' - '172.28.' - '172.29.' - '172.30.' - '172.31.' destinationisipv6: 'false'
<li><a href="#">detection: selection_mobsync: image|endswith: '\mobsync.exe' filter_created_file: targetfilename|endswith: - '.dll' - '.exe'
<li><a href="#">detection: selection_msse: pipename|contains|all: - '\msse-' - '-server' selection_postex: pipename|startswith: '\postex_' selection_postex_ssh: pipename|startswith: '\postex_ssh_' selection_status: pipename|startswith: '\status_' selection_msagent: pipename|startswith: '\msagent_'
<li><a href="#">detection: selection_mstsc: image|endswith: \ruby.exe commandline|contains|all: - '-i ' - '-u ' - '-p '
<li><a href="#">detection: selection_mstsc_img: - image|endswith: \mstsc.exe - originalfilename: 'mstsc.exe' selection_mstsc_cli: commandline|contains: ' /v:' selection_cmdkey_img: - image|endswith: \cmdkey.exe - originalfilename: 'cmdkey.exe' selection_cmdkey_cli: commandline|contains|all: - ' /g' - ' /u' - ' /p'
<li><a href="#">detection: selection_name: image|endswith: '\krbrelay.exe' selection_original_name: # in case the file has been renamed after compilation originalfilename: 'krbrelay.exe' selection_flags1: commandline|contains|all: - ' -spn ' - ' -clsid ' - ' -rbcd ' selection_flags2: commandline|contains|all: - 'shadowcred' - 'clsid' - 'spn' selection_flags3: commandline|contains|all: - 'spn ' - 'session ' - 'clsid '
<li><a href="#">detection: selection_name: image|endswith: '\krbrelayup.exe' selection_original_name: # in case the file has been renamed after compilation originalfilename: 'krbrelayup.exe' selection_flags1: commandline|contains|all: - ' relay ' - ' -domain ' - ' -computername ' selection_flags2: commandline|contains|all: - ' krbscm ' - ' -sc ' selection_flags3: commandline|contains|all: - ' spawn ' - ' -d ' - ' -cn ' - ' -cp '
<li><a href="#">detection: selection_nltest: image|endswith: '\nltest.exe' selection_recon1: commandline|contains|all: - '/server' - '/query' selection_recon2: commandline|contains: - '/dclist:' - '/parentdomain' - '/domain_trusts' - '/trusted_domains' - '/user'
<li><a href="#">detection: selection_nltest_v1: image|endswith: '\nltest.exe' commandline|contains: - 'domain_trusts' - 'all_trusts' - '/trusted_domains' - '/dclist' selection_dsquery_v1: image|endswith: '\dsquery.exe' commandline|contains: 'trusteddomain' selection_dsquery_v2: image|endswith: '\dsquery.exe' commandline|contains|all: - '-filter' - 'trusteddomain'
<li><a href="#">detection: selection_nslookup: commandline|contains|all: - 'nslookup' - '_ldap._tcp.dc._msdcs.'
<li><a href="#">detection: selection_obj: hostapplication|contains|all: - 'get-wmiobject' - ' win32_shadowcopy' selection_del: hostapplication|contains: - 'delete()' - 'remove-wmiobject'
<li><a href="#">detection: selection_one: - image|contains: wuauclt - originalfilename: wuauclt.exe selection_two: commandline|contains|all: - 'updatedeploymentprovider' - '.dll' - 'runhandlercomserver' filter: commandline|contains: - ' /updatedeploymentprovider updatedeploymentprovider.dll ' - ' wuaueng.dll '
<li><a href="#">detection: selection_one: eventid: 11 image: system targetfilename|endswith: '\internet explorer\iertutil.dll' selection_two: eventid: 7 image|endswith: '\internet explorer\iexplore.exe' imageloaded|endswith: '\internet explorer\iertutil.dll'
<li><a href="#">detection: selection_one: image|endswith: '\wmic.exe' commandline|contains|all: - wmic - format - http selection_wmic_imphash: - imphash: - 1b1a3f43bf37b5bfe60751f2ee2f326e - 37777a96245a3c74eb217308f3546f4c - 9d87c9d67ce724033c0b40cc4ca1b206 - hashes|contains: # sysmon field hashes contains all types - imphash=1b1a3f43bf37b5bfe60751f2ee2f326e - imphash=37777a96245a3c74eb217308f3546f4c - imphash=9d87c9d67ce724033c0b40cc4ca1b206 selection_flags: commandline|contains|all: - 'format:' - 'http'
<li><a href="#">detection: selection_operation_name: properties.message: microsoft.kubernetes/connectedclusters/events.k8s.io/events/delete
<li><a href="#">detection: selection_operation_name: properties.message: microsoft.kubernetes/connectedclusters/pods/delete
<li><a href="#">detection: selection_options_disabling_preference: scriptblocktext|contains: 'set-mppreference' selection_options_disabling_function: scriptblocktext|contains: - 'disablerealtimemonitoring 1' - 'disablebehaviormonitoring 1' - 'disablescriptscanning 1' - 'disablearchivescanning 1' - 'disableblockatfirstseen 1' - 'disableioavprotection 1' - 'disableintrusionpreventionsystem 1' - 'disableremovabledrivescanning 1' - 'disablescanningmappednetworkdrivesforfullscan 1' - 'disablescanningnetworkfiles 1' - 'disablerealtimemonitoring $true' - 'disablebehaviormonitoring $true' - 'disablescriptscanning $true' - 'disablearchivescanning $true' - 'disableblockatfirstseen $true' - 'disableioavprotection $true' - 'disableintrusionpreventionsystem $true' - 'disableremovabledrivescanning $true' - 'disablescanningmappednetworkdrivesforfullscan $true' - 'disablescanningnetworkfiles $true' selection_default_actions_allow: scriptblocktext|contains|all: - 'set-mppreference' - allow scriptblocktext|contains: - lowthreatdefaultaction - moderatethreatdefaultaction - highthreatdefaultaction
<li><a href="#">detection: selection_org: originalfilename: 'nircmd.exe' combo_exec: commandline|contains: - ' exec ' - ' exec2 ' combo_exec_params: commandline|contains: - ' show ' - ' hide ' selection_cmd: commandline|contains: - ' execmd ' - '.exe script ' - '.exe shexec ' - ' runinteractive '
<li><a href="#">detection: selection_other: # *** wmiexec.py # parent is wmiprvse.exe # examples: # cmd.exe /q /c whoami 1> \\127.0.0.1\admin$\__1567439113.54 2>&1 # cmd.exe /q /c cd 1> \\127.0.0.1\admin$\__1567439113.54 2>&1 # *** dcomexec.py -object mmc20 # parent is mmc.exe # example: # "c:\windows\system32\cmd.exe" /q /c cd 1> \\127.0.0.1\admin$\__1567442499.05 2>&1 # *** dcomexec.py -object shellbrowserwindow # runs %systemroot%\system32\rundll32.exe shell32.dll,shcreatelocalserverrundll {c08afd90-f2a1-11d1-8455-00a0c91f3880} but parent command is explorer.exe # example: # "c:\windows\system32\cmd.exe" /q /c cd \ 1> \\127.0.0.1\admin$\__1567520103.71 2>&1 # *** smbexec.py # parent is services.exe # example: # c:\windows\system32\cmd.exe /q /c echo tasklist ^> \\127.0.0.1\c$\__output 2^>^&1 > c:\windows\temp\execute.bat & c:\windows\system32\cmd.exe /q /c c:\windows\temp\execute.bat & del c:\windows\temp\execute.bat parentimage|endswith: - '\wmiprvse.exe' # wmiexec - '\mmc.exe' # dcomexec mmc - '\explorer.exe' # dcomexec shellbrowserwindow - '\services.exe' # smbexec commandline|contains|all: - 'cmd.exe' - '/q' - '/c' - '\\\\127.0.0.1\' - '&1' selection_atexec: parentcommandline|contains: - 'svchost.exe -k netsvcs' # atexec on win10 (parent is "c:\windows\system32\svchost.exe -k netsvcs") - 'taskeng.exe' # atexec on win7 (parent is "taskeng.exe {afa79333-694c-4bee-910e-e57d9a3518f6} s-1-5-18:nt authority\system:service:") # cmd.exe /c tasklist /m > c:\windows\temp\bajryqtl.tmp 2>&1 commandline|contains|all: - 'cmd.exe' - '/c' - 'windows\temp\' - '&1'
<li><a href="#">detection: selection_parent: parentimage|endswith: - '\powershell.exe' - '\cmd.exe' - '\mshta.exe' - '\cscript.exe' - '\wscript.exe' - '\wsl.exe' - '\rundll32.exe' - '\regsvr32.exe' # office apps are covered by other rules selection_msdt: - image|endswith: '\msdt.exe' - originalfilename: 'msdt.exe'
<li><a href="#">detection: selection_parent: parentimage|endswith: '\vmtoolsd.exe' selection_img: - image|endswith: - '\cmd.exe' - '\powershell.exe' - '\rundll32.exe' - '\regsvr32.exe' - '\wscript.exe' - '\cscript.exe' - originalfilename: - 'cmd.exe' - 'powershell.exe' - 'rundll32.exe' - 'regsvr32.exe' - 'wscript.exe' - 'cscript.exe' filter: commandline|contains: - '\vmware\vmware tools\poweron-vm-default.bat' - '\vmware\vmware tools\poweroff-vm-default.bat' - '\vmware\vmware tools\resume-vm-default.bat' - '\vmware\vmware tools\suspend-vm-default.bat'
<li><a href="#">detection: selection_parent: parentimage|endswith: '\wmiprvse.exe' selection_img: - image|endswith: '\powershell.exe' - originalfilename: 'powershell.exe' filter_null1: commandline: 'null' filter_null2: # some backends need the null value in a separate expression commandline: null
<li><a href="#">detection: selection_parent: parentimage|endswith: '\wmiprvse.exe' selection_mshta: - image|endswith: '\mshta.exe' - originalfilename: 'mshta.exe'
<li><a href="#">detection: selection_password: commandline|contains: ' -hp' selection_other: commandline|contains: - ' -m' - ' a '
<li><a href="#">detection: selection_payload: - payload|re: '\$pshome\[\s*\d{1,3}\s*\]\s*\+\s*\$pshome\[' - payload|re: '\$shellid\[\s*\d{1,3}\s*\]\s*\+\s*\$shellid\[' - payload|re: '\$env:public\[\s*\d{1,3}\s*\]\s*\+\s*\$env:public\[' - payload|re: '\$env:comspec\[(\s*\d{1,3}\s*,){2}' - payload|re: '\\\\*mdr\\\\*\w\s*\)\.name' - payload|re: '\$verbosepreference\.tostring\(' - payload|re: '\string\]\s*\$verbosepreference'
<li><a href="#">detection: selection_pe: image|contains: - 'petitpotam' - 'rottenpotato' - 'hotpotato' - 'juicypotato' - '\just_dce_' - 'juicy potato' - '\temp\rot.exe' - '\potato.exe' - '\spoolsample.exe' - '\responder.exe' - '\smbrelayx' - '\ntlmrelayx' selection_script: commandline|contains: - 'invoke-tater' - ' smbrelay' - ' ntlmrelay' - 'cme smb ' - ' /ntlm:ntlmhash ' - 'invoke-petitpotam' filter_hotpotatoes: # known goodware image|contains: - 'hotpotatoes6' - 'hotpotatoes 6' - 'hotpotatoes7' - 'hotpotatoes 7' - 'hotpotatoes help' - 'hotpotatoes tutorial'
<li><a href="#">detection: selection_plain: image|endswith: '\dtrace.exe' commandline|contains: 'lkd(0)' selection_obfuscated: commandline|contains|all: - 'syscall:::return' - 'lkd('
<li><a href="#">detection: selection_powershell: - commandline|contains: - 'powershell' - 'pwsh' - description: 'windows powershell' - product: 'powershell core 6' selection_length: commandline|re: '.{1000,}'
<li><a href="#">detection: selection_proc: parentimage|endswith: '\explorer.exe' commandline|contains: 'c:\windows\temp\meg.exe' selection_orig: originalfilename: 'meg.exe' filter: image|endswith: '\meg.exe'
<li><a href="#">detection: selection_process: parentimage|endswith: '\winlogon.exe' image|endswith: '\cmd.exe' commandline|contains: - 'sethc.exe' - 'utilman.exe' - 'osk.exe' - 'magnify.exe' - 'narrator.exe' - 'displayswitch.exe'
<li><a href="#">detection: selection_process: targetimage|endswith: '\svchost.exe' selection_memory: grantedaccess: '0x143a' filter_trusted_process_access: sourceimage|endswith: - '*\services.exe' - '*\msiexec.exe'
<li><a href="#">detection: selection_process0: commandline|contains: '\service.exe' commandline|endswith: - 'i' - 'u' selection_process1: - commandline|endswith: '\microsoft\taskbar\autoit3.exe' - commandline|startswith: 'c:\wsc.exe' selection_process2: image|contains: '\windows\temp\db\' image|endswith: '.exe' selection_process3: commandline|contains|all: - '\nslookup.exe' - '-q=txt' parentimage|contains: '\autoit'
<li><a href="#">detection: selection_pwsh_remove: #autologger provider removal scriptblocktext|contains: 'remove-etwtraceprovider ' selection_pwsh_set: #provider â€œenableâ€ property modification scriptblocktext|contains|all: - 'set-etwtraceprovider ' - '0x11'
<li><a href="#">detection: selection_recon: image|endswith: - '\tasklist.exe' - '\qwinsta.exe' - '\ipconfig.exe' - '\hostname.exe' commandline|contains: '>>' commandline|endswith: 'temps.dat' selection_persistence: commandline|contains: '/c reg add "hkcu\software\microsoft\windows\currentversion\run" /v "winnetworksecurity" /t reg_sz /d'
<li><a href="#">detection: selection_reg: commandline|contains: ' save ' selection_key: commandline|contains: - hklm\sam - hklm\system - hklm\security
<li><a href="#">detection: selection_reg: eventtype: setvalue targetobject|contains: - '\services\termservice\parameters\servicedll' - '\control\terminal server\fsinglesessionperuser' - '\control\terminal server\fdenytsconnections' - '\policies\microsoft\windows nt\terminal services\shadow' - '\control\terminal server\winstations\rdp-tcp\initialprogram'
<li><a href="#">detection: selection_reg: image|endswith: '\reg.exe' commandline|contains: - 'hkey_current_user\control panel\desktop' - 'hkcu\control panel\desktop' selection_option_1: # /force active screensaveactive commandline|contains|all: - '/v screensaveactive' - '/t reg_sz' - '/d 1' - '/f' selection_option_2: # /force set screensavetimeout commandline|contains|all: - '/v screensavetimeout' - '/t reg_sz' - '/d ' - '/f' selection_option_3: # /force set screensaverissecure commandline|contains|all: - '/v screensaverissecure' - '/t reg_sz' - '/d 0' - '/f' selection_option_4: # /force set a .scr commandline|contains|all: - '/v scrnsave.exe' - '/t reg_sz' - '/d ' - '.scr' - '/f'
<li><a href="#">detection: selection_reg_add: commandline|contains|all: - 'reg' - 'add' selection_reg_start: commandline|contains|all: - ' /d 4' - ' /v start' selection_start_services: commandline|contains: - '\sense' - '\windefend' - '\msmpsvc' - '\nissrv' - '\wdboot' - '\wdnisdrv' - '\wdnissvc' - '\wscsvc' - '\securityhealthservice' - '\wuauserv' - '\usosvc' - '\wdfilter' - '\appidsvc' selection_reg_disable_defender: commandline|contains|all: - ' /d 1' - 'windows defender' selection_reg_disable_defender_values: commandline|contains: - 'disableioavprotection' - 'disableonaccessprotection' - 'disableroutinelytakingaction' - 'disablescanonrealtimeenable' - 'disableblockatfirstseen' - 'disablebehaviormonitoring' - 'disableenhancednotifications' - 'disableantispyware' - 'disableantispywarerealtimeprotection' - 'disableconfig' - 'disableprivacymode' - 'signaturedisableupdateonstartupwithoutengine' - 'disablearchivescanning' - 'disableintrusionpreventionsystem' - 'disablescriptscanning'
<li><a href="#">detection: selection_reg1: targetobject|contains: '\software\microsoft\windows nt\currentversion' selection_reg2: - targetobject|contains|all: - '\image file execution options\' - '\globalflag' - targetobject|contains|all: - 'silentprocessexit\' - '\reportingmode' - targetobject|contains|all: - 'silentprocessexit\' - '\monitorprocess'
<li><a href="#">detection: selection_reg1: targetobject|endswith: - 'software\microsoft\windows\currentversion\ume' - 'software\microsoft\windows\currentversion\ut'
<li><a href="#">detection: selection_registry: eventtype: setvalue targetobject: 'hkcu\software\microsoft\office\16.0\outlook\security\level' details|contains: '0x00000001'
<li><a href="#">detection: selection_registry: targetobject: - 'hkcu\software\microsoft\office test\special\perf' - 'hklm\software\microsoft\office test\special\perf'
<li><a href="#">detection: selection_registry: targetobject: - 'hklm\system\currentcontrolset\control\lsa\security packages' - 'hklm\system\currentcontrolset\control\lsa\osconfig\security packages' exclusion_images: - image: c:\windows\system32\msiexec.exe - image: c:\windows\syswow64\msiexec.exe
<li><a href="#">detection: selection_registry: targetobject: 'hklm\system\currentcontrolset\services\portproxy\v4tov4\tcp'
<li><a href="#">detection: selection_registry: targetobject|endswith: - '\software\microsoft\windows nt\currentversion\image file execution options\sethc.exe\debugger' - '\software\microsoft\windows nt\currentversion\image file execution options\utilman.exe\debugger' - '\software\microsoft\windows nt\currentversion\image file execution options\osk.exe\debugger' - '\software\microsoft\windows nt\currentversion\image file execution options\magnify.exe\debugger' - '\software\microsoft\windows nt\currentversion\image file execution options\narrator.exe\debugger' - '\software\microsoft\windows nt\currentversion\image file execution options\displayswitch.exe\debugger'
<li><a href="#">detection: selection_run: commandline|contains|all: - rundll32 - 'mshtml,runhtmlapplication' selection_script: commandline|contains: - 'javascript:' - 'vbscript:'
<li><a href="#">detection: selection_schtasks: image|endswith: '\schtasks.exe' commandline|contains: '/create ' selection_pattern1: commandline|contains: - '/sc minute ' - '/ru system ' selection_pattern2: commandline|contains: - 'cmd.exe /c ' - 'cmd /c' selection_rare: commandline|contains: - ' bypass ' - '.downloadstring' - '.downloadfile' - 'frombase64string' - ' -w hidden ' - ' iex' - ' -enc ' - ' -decode ' - '/c start /min ' # - ' curl ' # selection_anomaly: - commandline|contains|all: - '/xml c:\users\' - '\appdata\local\' - commandline|contains|all: - 'wscript.exe' - '\appdata\'
<li><a href="#">detection: selection_service: eventid: 4698 taskname: - 'sc scheduled scan' - 'updatmachine'
<li><a href="#">detection: selection_service: provider_name: 'service control manager' eventid: 7045 servicename: - 'sc scheduled scan' - 'updatmachine'
<li><a href="#">detection: selection_set_1: eventtype: setvalue targetobject|endswith: - 'software\microsoft\windows\currentversion\policies\explorer\hideclock' - 'software\microsoft\windows\currentversion\policies\explorer\hidescahealth' - 'software\microsoft\windows\currentversion\policies\explorer\hidescanetwork' - 'software\microsoft\windows\currentversion\policies\explorer\hidescapower' - 'software\microsoft\windows\currentversion\policies\explorer\hidescavolume' details: 'dword (0x00000001)' selection_set_0: eventtype: setvalue targetobject|endswith: - 'software\microsoft\windows\currentversion\explorer\advanced\showinfotip' - 'software\microsoft\windows\currentversion\explorer\advanced\showcompcolor' details: 'dword (0x00000000)'
<li><a href="#">detection: selection_set_1: eventtype: setvalue targetobject|endswith: - 'software\microsoft\windows\currentversion\policies\explorer\nologoff' - 'software\microsoft\windows\currentversion\policies\explorer\nodesktop' - 'software\microsoft\windows\currentversion\policies\explorer\norun' - 'software\microsoft\windows\currentversion\policies\explorer\nofind' - 'software\microsoft\windows\currentversion\policies\explorer\nocontrolpanel' - 'software\microsoft\windows\currentversion\policies\explorer\nofilemenu' - 'software\microsoft\windows\currentversion\policies\explorer\noclose' - 'software\microsoft\windows\currentversion\policies\explorer\nosettaskbar' - 'software\microsoft\windows\currentversion\policies\explorer\nopropertiesmydocuments' - 'software\microsoft\windows\currentversion\policies\explorer\notraycontextmenu' details: 'dword (0x00000001)'
<li><a href="#">detection: selection_set_1: eventtype: setvalue targetobject|endswith: - 'software\microsoft\windows\currentversion\policies\system\disableregistrytools' - 'software\policies\microsoft\windows\system\disablecmd' - 'software\microsoft\windows\currentversion\policies\system\disabletaskmgr' - 'software\policies\microsoft\windows\explorer\disablenotificationcenter' - 'software\microsoft\windows\currentversion\policies\system\disablechangepassword' - 'software\microsoft\windows\currentversion\policies\system\disablelockworkstation' - 'software\microsoft\windows\currentversion\policies\explorer\startmenulogoff' details: 'dword (0x00000001)' selection_set_0: eventtype: setvalue targetobject|endswith: - 'software\microsoft\windows\currentversion\policies\system\shutdownwithoutlogon' - 'software\microsoft\windows\currentversion\pushnotifications\toastenabled' - '\system\currentcontrolset\control\storage\write protection' - '\system\currentcontrolset\control\storagedevicepolicies\writeprotect' details: 'dword (0x00000000)'
<li><a href="#">detection: selection_shells: image|endswith: - '\cmd.exe' - '\powershell.exe' - '\wscript.exe' - '\cscript.exe' - '\sh.exe' - '\bash.exe' - '\msbuild.exe' # - '\certutil.exe' targetfilename|contains: - 'c:\users\public' - 'c:\perflogs' selection_program: image|endswith: - '\schtasks.exe' - '\wmic.exe' # - '\mshta.exe' # - '\rundll32.exe' - '\forfiles.exe' - '\scriptrunner.exe' - '\certutil.exe' targetfilename|contains: - 'c:\users\public' - 'c:\perflogs' - '\appdata\' - 'c:\windows\temp'
<li><a href="#">detection: selection_source: eventsource: cloudtrail.amazonaws.com eventname: - stoplogging - updatetrail - deletetrail
<li><a href="#">detection: selection_source: eventsource: config.amazonaws.com eventname: - deletedeliverychannel - stopconfigurationrecorder
<li><a href="#">detection: selection_source: eventsource: ec2.amazonaws.com eventname: modifysnapshotattribute
<li><a href="#">detection: selection_source: eventsource: ec2.amazonaws.com requestparameters.attribute: userdata eventname: describeinstanceattribute timeframe: 30m
<li><a href="#">detection: selection_source: eventsource: ec2.amazonaws.com requestparameters.attribute: 'userdata' eventname: modifyinstanceattribute
<li><a href="#">detection: selection_source: eventsource: guardduty.amazonaws.com eventname: createipset
<li><a href="#">detection: selection_source: eventsource: iam.amazonaws.com eventname: createaccesskey filter: useridentity.arn|contains: responseelements.accesskey.username
<li><a href="#">detection: selection_source: eventsource: iam.amazonaws.com eventname: updateloginprofile filter: useridentity.arn|contains: requestparameters.username
<li><a href="#">detection: selection_source: eventsource: rds.amazonaws.com responseelements.pendingmodifiedvalues.masteruserpassword: '*' eventname: modifydbinstance
<li><a href="#">detection: selection_source: eventsource: rds.amazonaws.com responseelements.publiclyaccessible: 'true' eventname: restoredbinstancefromdbsnapshot
<li><a href="#">detection: selection_spacing_modifiers: commandline|contains: # spacing modifier letters that get auto-replaced - 'ë£' # 0x02e3 - 'ëª' # 0x02ea - 'ë¢' # 0x02e2 selection_unicode_slashes: # forward slash alternatives commandline|contains: - 'âˆ•' # 0x22ff - 'â„' # 0x206f selection_unicode_hyphens: # hyphen alternatives commandline|contains: - 'â€•' # 0x2015 - 'â€”' # 0x2014
<li><a href="#">detection: selection_special: commandline|contains: ' -m pe_inject ' selection_execute: commandline|contains|all: - ' --local-auth' - ' -u ' - ' -x ' selection_hash: commandline|contains|all: - ' --local-auth' - ' -u ' - ' -p ' - " -h 'nthash'" selection_module_mssql: commandline|contains|all: - ' mssql ' - ' -u ' - ' -p ' - ' -m ' - ' -d ' selection_module_smb1: commandline|contains|all: - ' smb ' - ' -u ' - ' -h ' - ' -m ' - ' -o ' selection_module_smb2: commandline|contains|all: - ' smb ' - ' -u ' - ' -p ' - ' --local-auth' part_localauth_1: commandline|contains|all: - ' --local-auth' - ' -u ' - ' -p ' part_localauth_2: commandline|contains|all: - ' 10.' - ' 192.168.' - '/24 '
<li><a href="#">detection: selection_sql: - product: sqlite - image|endswith: '\sqlite.exe' selection_firefox: commandline|contains: 'cookies.sqlite'
<li><a href="#">detection: selection_start: scriptblocktext|contains: start-process selection_batch: scriptblocktext|contains: - '.cmd' - '.bat'
<li><a href="#">detection: selection_stop: state: stopped selection_conf: - 'sysmon config state changed'
<li><a href="#">detection: selection_stream: commandline|contains: 'txt:' selection_tools_type: commandline|contains|all: - 'type ' - ' > ' selection_tools_makecab: commandline|contains|all: - 'makecab ' - '.cab' selection_tools_reg: commandline|contains|all: - 'reg ' - ' export ' selection_tools_regedit: commandline|contains|all: - 'regedit ' - ' /e ' selection_tools_esentutl: commandline|contains|all: - 'esentutl ' - ' /y ' - ' /d ' - ' /o '
<li><a href="#">detection: selection_teamviewer: targetfilename|endswith: '.log' targetfilename|contains: '\teamviewer_' filter: image: c:\windows\system32\svchost.exe
<li><a href="#">detection: selection_time: image|endswith: - '\net.exe' - '\net1.exe' commandline|contains: 'time' selection_w32tm: image|endswith: '\w32tm.exe' commandline|contains: 'tz'
<li><a href="#">detection: selection_tool: # - image|endswith: - '\ntdsdump.exe' - '\ntdsdumpex.exe' - commandline|contains|all: # ntdsdumpex.exe -d ntds.dit -o hash.txt -s system.hiv - 'ntds.dit' - 'system.hiv' - commandline|contains: 'ntdsgrab.ps1' selection_oneliner_1: # powershell "ntdsutil.exe 'ac i ntds' 'ifm' 'create full c:\temp' q q" commandline|contains|all: - 'ac i ntds' - 'create full' selection_onliner_2: # cmd.exe /c copy z:\windows\ntds\ntds.dit c:\exfil\ntds.dit commandline|contains|all: - '/c copy ' - '\windows\ntds\ntds.dit' selection_powershell: commandline|contains|all: - 'powershell' - 'ntds.dit' set1_selection_ntds_dit: commandline|contains: 'ntds.dit' set1_selection_image_folder: - parentimage|contains: - '\apache' - '\tomcat' - '\appdata\' - '\temp\' - '\public\' - '\perflogs\' - image|contains: - '\apache' - '\tomcat' - '\appdata\' - '\temp\' - '\public\' - '\perflogs\'
<li><a href="#">detection: selection_tools: commandline|contains: - 'sqlcmd ' - 'sqlcmd.exe' selection_svr: commandline|contains: ' -s localhost ' selection_query: commandline|contains: - 'sys.sysprocesses' - 'master.dbo.sysdatabases' - 'backup database'
<li><a href="#">detection: selection_tools: commandline|contains: 'logman ' selection_action: commandline|contains: - 'stop ' - 'delete ' selection_service: commandline|contains: eventlog-system
<li><a href="#">detection: selection_tools: image|endswith: '\sqlcmd.exe' selection_query: commandline|contains|all: - 'select' - 'top' - '[veeambackup].[dbo].[credentials]'
<li><a href="#">detection: selection_traversal: c-uri|contains: '/../../../../../../../' sc-status: 200 selection_plugins: c-uri|contains: - '/public/plugins/live' - '/public/plugins/icon' - '/public/plugins/loki' - '/public/plugins/text' - '/public/plugins/logs' - '/public/plugins/news' - '/public/plugins/stat' - '/public/plugins/mssql' - '/public/plugins/mixed' - '/public/plugins/mysql' - '/public/plugins/tempo' - '/public/plugins/graph' - '/public/plugins/gauge' - '/public/plugins/table' - '/public/plugins/debug' - '/public/plugins/zipkin' - '/public/plugins/jaeger' - '/public/plugins/geomap' - '/public/plugins/canvas' - '/public/plugins/grafana' - '/public/plugins/welcome' - '/public/plugins/xychart' - '/public/plugins/heatmap' - '/public/plugins/postgres' - '/public/plugins/testdata' - '/public/plugins/opentsdb' - '/public/plugins/influxdb' - '/public/plugins/barchart' - '/public/plugins/annolist' - '/public/plugins/bargauge' - '/public/plugins/graphite' - '/public/plugins/dashlist' - '/public/plugins/piechart' - '/public/plugins/dashboard' - '/public/plugins/nodegraph' - '/public/plugins/alertlist' - '/public/plugins/histogram' - '/public/plugins/table-old' - '/public/plugins/pluginlist' - '/public/plugins/timeseries' - '/public/plugins/cloudwatch' - '/public/plugins/prometheus' - '/public/plugins/stackdriver' - '/public/plugins/alertgroups' - '/public/plugins/alertmanager' - '/public/plugins/elasticsearch' - '/public/plugins/gettingstarted' - '/public/plugins/state-timeline' - '/public/plugins/status-history' - '/public/plugins/grafana-clock-panel' - '/public/plugins/grafana-simple-json-datasource' - '/public/plugins/grafana-azure-monitor-datasource'
<li><a href="#">detection: selection_user: user: - '#-*' - '#*4294967295'
<li><a href="#">detection: selection_user: user|contains: # covers many language settings - 'authori' - 'autori' selection_img: - originalfilename: 'whoami.exe' - image|endswith: '\whoami.exe'
<li><a href="#">detection: selection_user: user|contains: 'trustedinstaller' selection_img: - originalfilename: 'whoami.exe' - image|endswith: '\whoami.exe'
<li><a href="#">detection: selection_usertype: useridentity.type: root selection_eventtype: eventtype: awsserviceevent
<li><a href="#">detection: selection_webdav: - c-useragent|contains: 'webdav' - c-uri|contains: 'webdav' selection_executable: - resp_mime_types|contains: 'dosexec' - c-uri|endswith: '.exe'
<li><a href="#">detection: selection_webserver_image: parentimage|endswith: - '\w3wp.exe' - '\php-cgi.exe' - '\nginx.exe' - '\httpd.exe' - '\caddy.exe' - '\ws_tomcatservice.exe' - '\tomcat.exe' - '\umworkerprocess.exe' # selection_webserver_characteristics_tomcat1: parentimage|endswith: - '\java.exe' - '\javaw.exe' parentimage|contains: - '-tomcat-' - '\tomcat' selection_webserver_characteristics_tomcat2: parentimage|endswith: - '\java.exe' - '\javaw.exe' parentcommandline|contains: - 'catalina.jar' - 'catalina_home' - 'catalina.home' anomaly_children: image|endswith: - '\cmd.exe' - '\sh.exe' - '\bash.exe' - '\powershell.exe' - '\bitsadmin.exe'
<li><a href="#">detection: selection_webserver_image: parentimage|endswith: - '\w3wp.exe' - '\php-cgi.exe' - '\nginx.exe' - '\httpd.exe' - '\caddy.exe' - '\ws_tomcatservice.exe' selection_webserver_characteristics_tomcat1: parentimage|endswith: - '\java.exe' - '\javaw.exe' parentimage|contains: - '-tomcat-' - '\tomcat' selection_webserver_characteristics_tomcat2: parentimage|endswith: - '\java.exe' - '\javaw.exe' commandline|contains: - 'catalina.jar' - 'catalina_home' recon: commandline|contains: - 'perl --help' - 'python --help' - 'wget --help' - 'perl -h'
<li><a href="#">detection: selection_webserver_image: parentimage|endswith: - '\w3wp.exe' - '\php-cgi.exe' - '\nginx.exe' - '\httpd.exe' - '\caddy.exe' - '\ws_tomcatservice.exe' selection_webserver_characteristics_tomcat1: parentimage|endswith: - '\java.exe' - '\javaw.exe' parentimage|contains: - '-tomcat-' - '\tomcat' selection_webserver_characteristics_tomcat2: parentimage|endswith: - '\java.exe' - '\javaw.exe' commandline|contains: - 'catalina.jar' - 'catalina_home' susp_net_utility: originalfilename: - 'net.exe' - 'net1.exe' commandline|contains: - ' user ' - ' use ' - ' group ' susp_ping_utility: originalfilename: 'ping.exe' commandline|contains: ' -n ' susp_change_dir: commandline|contains: - '&cd&echo' # china chopper web shell - 'cd /d ' # susp_wmic_utility: originalfilename: 'wmic.exe' commandline|contains: ' /node:' susp_misc_discovery_binaries: - image|endswith: - '\whoami.exe' - '\systeminfo.exe' - '\quser.exe' - '\ipconfig.exe' - '\pathping.exe' - '\tracert.exe' - '\netstat.exe' - '\schtasks.exe' - '\vssadmin.exe' - '\wevtutil.exe' - '\tasklist.exe' - originalfilename: - 'whoami.exe' - 'sysinfo.exe' - 'quser.exe' - 'ipconfig.exe' - 'pathping.exe' - 'tracert.exe' - 'netstat.exe' - 'schtasks.exe' - 'vssadmin.exe' - 'wevtutil.exe' - 'tasklist.exe' susp_misc_discovery_commands: commandline|contains: - ' test-netconnection ' - 'dir \' # remote dir: dir \<redacted ip #3>\c$:\windows\temp\*.exe
<li><a href="#">detection: selection_wevtutil_binary: image|endswith: '\wevtutil.exe' selection_wevtutil_command: commandline|contains: - 'clear-log' # clears specified log - ' cl ' # short version of 'clear-log' - 'set-log' # modifies config of specified log. could be uset to set it to a tiny size - ' sl ' # short version of 'set-log' selection_other_ps: image|endswith: '\powershell.exe' commandline|contains: - 'clear-eventlog' - 'remove-eventlog' - 'limit-eventlog' selection_other_wmic: image|endswith: '\wmic.exe' commandline|contains: ' cleareventlog '
<li><a href="#">detection: selection_winzip: commandline|contains: - 'winzip.exe' - 'winzip64.exe' selection_password: commandline|contains: '-s"' selection_other: commandline|contains: - ' -min ' - ' -a '
<li><a href="#">detection: selection_wlldropped: targetfilename|contains: \microsoft\word\startup\ targetfilename|endswith: .wll selection_xlldropped: targetfilename|contains: \microsoft\excel\startup\ targetfilename|endswith: .xll selection_generic: targetfilename|contains: \microsoft\addins\ targetfilename|endswith: - .xlam - .xla
<li><a href="#">detection: selection_word: eventtype: setvalue targetobject|endswith: \word\security\allowdde details: - dword (0x00000001) - dword (0x00000002) selection_excel: eventtype: setvalue targetobject|endswith: - \excel\security\disableddeserverlaunch - \excel\security\disableddeserverlookup details: dword (0x00000000)
<li><a href="#">detection: selection_word: targetfilename|endswith: - .dot - .dotm - .doc - .docm - .docx - .rtf targetfilename|contains: '\microsoft\word\startup' selection_excel: targetfilename|endswith: - .xlt - .xltm - .xls - .xlsm - .xlsx targetfilename|contains: '\microsoft\excel\startup' filter_office: image|endswith: - \winword.exe - \excel.exe
<li><a href="#">detection: selection_xml: scriptblocktext|contains|all: - new-object - system.xml.xmldocument - .load selection_exec: - iex - invoke-expression
<li><a href="#">detection: selection1: - '*chown root*' selection2: - '* chmod u+s*' selection3: - '* chmod g+s*'
<li><a href="#">detection: selection1: - 'bash -c /bin/bash' selection2: - '&/dev/tcp/'
<li><a href="#">detection: selection1: - commandline|contains: - 'temp\wtask.exe /create' - '%windir:~-3,1%%public:~-9,1%' - '/tn "security script ' - '%windir:~-1,1%' - commandline|contains|all: - '/e:vbscript' - 'c:\users\' - '.txt' - '/f' selection2: image|endswith: 'temp\winwsh.exe'
<li><a href="#">detection: selection1: - commandline|contains: 'mpcmdrun.exe' - description: 'microsoft malware protection command line utility' selection2: commandline|contains|all: - 'downloadfile' - 'url'
<li><a href="#">detection: selection1: - commandline|endswith: 'eprod.ldf' - commandline|contains: - '\ldifde.exe -f -n ' - '\7za.exe a 1.7z ' - '\aaaa\procdump64.exe' - '\aaaa\netsess.exe' - '\aaaa\7za.exe' - 'copy .\1.7z \' - 'copy \\client\c$\aaaa\' selection2: image: c:\users\public\7za.exe
<li><a href="#">detection: selection1: - 'echo "*" > * && chmod +x *' selection2: - 'mv * "* "'
<li><a href="#">detection: selection1: - image|endswith: - '\tasksche.exe' - '\mssecsvc.exe' - '\taskdl.exe' - '\taskhsvc.exe' - '\taskse.exe' - '\111.exe' - '\lhdfrgui.exe' # - '\diskpart.exe' # cannot be used in a rule of level critical - '\linuxnew.exe' - '\wannacry.exe' - image|contains: 'wanadecryptor' selection2: - commandline|contains|all: - 'icacls' - '/grant' - 'everyone:f' - '/t' - '/c' - '/q' - commandline|contains|all: - 'bcdedit' - '/set' - '{default}' - 'recoveryenabled' - 'no' - commandline|contains|all: - 'wbadmin' - 'delete' - 'catalog' - '-quiet' - commandline|contains: '@please_read_me@.txt'
<li><a href="#">detection: selection1: - imphash: - a53a02b997935fd8eedcb5f7abab9b9f - e96a73c7bf33a464c510ede582318bf2 - hashes|contains: # sysmon field hashes contains all types - imphash=a53a02b997935fd8eedcb5f7abab9b9f - imphash=e96a73c7bf33a464c510ede582318bf2 selection2: commandline|endswith: '.exe -s' parentimage|endswith: '\services.exe' filter: image|endswith: '\clussvc.exe'
<li><a href="#">detection: selection1: # ke3chang and tidepool both modify the ieharden registry key, as well as the following list of keys. # setting these registry keys is unique to the ke3chang and tidepool malware families. # hkcu\software\microsoft\internet explorer\main\check_associations # hkcu\software\microsoft\internet explorer\main\disablefirstruncustomize # hkcu\software\microsoft\windows\currentversion\internet settings\zonemap\ieharden commandline|contains: - '-property dword -name disablefirstruncustomize -value 2 -force' - '-property string -name check_associations -value' - '-property dword -name ieharden -value 0 -force'
<li><a href="#">detection: selection1: # locked via api event_type_id: 532 selection2: # locked via api event_type_id: 553 selection3: # suspended via api event_type_id: 551
<li><a href="#">detection: selection1: calltrace|contains|all: - 'c:\windows\system32\ntdll.dll+' - '|c:\windows\system32\kernelbase.dll+' - '|unknown(' - ')' selection2: calltrace|contains|all: - 'unknown(' - ')|unknown(' calltrace|endswith: ')' selection3: calltrace|contains: 'unknown' grantedaccess: - '0x1f0fff' - '0x1f1fff' - '0x143a' - '0x1410' - '0x1010' - '0x1f2fff' - '0x1f3fff' - '0x1fffff' filter: - sourceimage|endswith: - '\windows\system32\sdiagnhost.exe' - '\procexp64.exe' - '\procexp.exe' - '\microsoft vs code\code.exe' - '\aurora-agent-64.exe' - '\aurora-agent.exe' - '\git\usr\bin\sh.exe' - '\ide\devenv.exe' - '\githubdesktop\update.exe' - '\runtimebroker.exe' - '\backgroundtaskhost.exe' - '\githubdesktop.exe' - sourceimage|startswith: - 'c:\program files (x86)\' - 'c:\program files\' - 'c:\windows\microsoft.net\framework\\*\ngentask.exe' - 'c:\program files (x86)\microsoft visual studio\' - 'c:\program files\microsoft visual studio\' - 'c:\windows\microsoft.net\framework' - 'c:\windows\system32\driverstore\' - 'c:\windows\system32\windowspowershell\' - sourceimage: - 'c:\users\\*\appdata\local\programs\microsoft vs code\code.exe' - 'c:\windows\system32\taskhostw.exe' - 'c:\windows\system32\ctfmon.exe' - 'c:\windows\system32\nhnotifsys.exe' - 'c:\windows\immersivecontrolpanel\systemsettings.exe' - 'c:\windows\explorer.exe' - targetimage: 'c:\windows\system32\runtimebroker.exe' - targetimage|endswith: '\microsoft vs code\code.exe' - calltrace|contains: '|c:\windows\system32\rpcrt4.dll+' # attempt to save the rule with a broader filter filter_set_1: sourceimage: 'c:\windows\explorer.exe' targetimage: - 'c:\windows\system32\backgroundtaskhost.exe' - 'c:\windows\explorer.exe' filter_msmpeng: sourceimage|startswith: 'c:\programdata\microsoft\windows defender\platform\' sourceimage|endswith: '\msmpeng.exe' filter_eclipse: sourceimage|endswith: '\eclipse.exe' calltrace|contains: - '\jre\bin\java.dll' - '|c:\windows\system32\windows.storage.dll+' - '\configuration\org.eclipse.osgi\' filter_openwith: sourceimage: 'c:\windows\system32\openwith.exe' targetimage: 'c:\windows\explorer.exe'
<li><a href="#">detection: selection1: commandline|contains: - ' tcp 139' - ' tcp 445' - ' tcp 3389' - ' tcp 5985' - ' tcp 5986' selection2: commandline|contains|all: - ' start ' - '--all' - '--config' - '.yml' selection3: image|endswith: 'ngrok.exe' commandline|contains: - ' tcp ' - ' http ' - ' authtoken '
<li><a href="#">detection: selection1: commandline|contains: ' /lockscreenurl:' selection1_filter: commandline|contains: - '.jpg' - '.jpeg' - '.png' selection_reg: commandline|contains|all: - 'reg delete' - '\personalizationcsp'
<li><a href="#">detection: selection1: commandline|contains: - '=[char][byte](''0x''+' - ' -work worker0 -path ' selection2: parentcommandline|contains: 'dllhost.exe /processid:{3e5fc7f9-9a51-4367-9063-a120244fbec7}' image|contains: '\appdata\local\temp\'
<li><a href="#">detection: selection1: commandline|contains: - 'add-mppreference ' - 'set-mppreference ' selection2: commandline|contains: - ' -exclusionpath ' - ' -exclusionextension ' - ' -exclusionprocess ' - ' -exclusionipaddress '
<li><a href="#">detection: selection1: commandline|contains: - 'add-mppreference ' - 'set-mppreference ' selection2: commandline|contains: - 'disablerealtimemonitoring ' - 'disableioavprotection ' - 'disablebehaviormonitoring ' - 'disableblockatfirstseen ' selection3: commandline|contains: - '$true' - ' 1 ' encoded_command: commandline|base64offset|contains: - 'disablerealtimemonitoring ' - 'disableioavprotection ' - 'disablebehaviormonitoring ' - 'disableblockatfirstseen ' - 'disablerealtimemonitoring ' - 'disableioavprotection ' - 'disablebehaviormonitoring ' - 'disableblockatfirstseen ' commandline|contains: - 'rabpahmayqbiagwazqbsaguayqbsahqaaqbtaguatqbvag4aaqb0ag8acgbpag4azwaga' - 'qaaqbzageaygbsaguaugblageabab0agkabqblae0abwbuagkadabvahiaaqbuagcaia' - 'eagkacwbhagiabablafiazqbhagwadabpag0azqbnag8abgbpahqabwbyagkabgbnacaa' - 'rabpahmayqbiagwazqbjae8aqqbwafaacgbvahqazqbjahqaaqbvag4aia' - 'qaaqbzageaygbsaguasqbpaeeavgbqahiabwb0aguaywb0agkabwbuacaa' - 'eagkacwbhagiabablaekatwbbafyauabyag8adablagmadabpag8abgaga' - 'rabpahmayqbiagwazqbcaguaaabhahyaaqbvahiatqbvag4aaqb0ag8acgbpag4azwaga' - 'qaaqbzageaygbsaguaqgblaggayqb2agkabwbyae0abwbuagkadabvahiaaqbuagcaia' - 'eagkacwbhagiabablaeiazqboageadgbpag8acgbnag8abgbpahqabwbyagkabgbnacaa' - 'rabpahmayqbiagwazqbcagwabwbjagsaqqb0aeyaaqbyahmadabtaguazqbuacaa' - 'qaaqbzageaygbsaguaqgbsag8aywbraeeadabgagkacgbzahqauwblaguabgaga' - 'eagkacwbhagiabablaeiababvagmaawbbahqargbpahiacwb0afmazqblag4aia' - 'zabpahmayqbiagwazqbyaguayqbsahqaaqbtaguabqbvag4aaqb0ag8acgbpag4azwaga' - 'qaaqbzageaygbsaguacgblageabab0agkabqblag0abwbuagkadabvahiaaqbuagcaia' - 'kagkacwbhagiabablahiazqbhagwadabpag0azqbtag8abgbpahqabwbyagkabgbnacaa' - 'zabpahmayqbiagwazqbpag8ayqb2ahaacgbvahqazqbjahqaaqbvag4aia' - 'qaaqbzageaygbsaguaaqbvageadgbwahiabwb0aguaywb0agkabwbuacaa' - 'kagkacwbhagiabablagkabwbhahyacabyag8adablagmadabpag8abgaga' - 'zabpahmayqbiagwazqbiaguaaabhahyaaqbvahiabqbvag4aaqb0ag8acgbpag4azwaga' - 'qaaqbzageaygbsaguaygblaggayqb2agkabwbyag0abwbuagkadabvahiaaqbuagcaia' - 'kagkacwbhagiabablagiazqboageadgbpag8acgbtag8abgbpahqabwbyagkabgbnacaa' - 'zabpahmayqbiagwazqbiagwabwbjagsayqb0agyaaqbyahmadabzaguazqbuacaa' - 'qaaqbzageaygbsaguaygbsag8aywbrageadabmagkacgbzahqacwblaguabgaga' - 'kagkacwbhagiabablagiababvagmaawbhahqazgbpahiacwb0ahmazqblag4aia'
<li><a href="#">detection: selection1: commandline|contains: - 'c:\windows\cert.exe' - 'del /q /f c:\kworking\agent.crt' - 'kaseya vsa agent hot-fix' - '\appdata\local\temp\msmpeng.exe' - 'rmdir /s /q %systemdrive%\inetpub\logs' - 'del /s /q /f %systemdrive%\\*.log' - 'c:\kworking1\agent.exe' - 'c:\kworking1\agent.crt' selection2: image: - 'c:\windows\msmpeng.exe' - 'c:\windows\cert.exe' - 'c:\kworking\agent.exe' - 'c:\kworking1\agent.exe' selection3: commandline|contains|all: - 'del /s /q /f' - 'webpages\errors\weberrorlog.txt'
<li><a href="#">detection: selection1: commandline|contains: - 'copy procdump' - 'move procdump' selection2: commandline|contains|all: - 'copy ' - '.dmp ' commandline|contains: - '2.dmp' - 'lsass' - 'out.dmp' selection3: commandline|contains: - 'copy lsass.exe_' # procdump default pattern e.g. lsass.exe_220111_085234.dmp - 'move lsass.exe_' # procdump default pattern e.g. lsass.exe_220111_085234.dmp
<li><a href="#">detection: selection1: commandline|contains: - 'dll,mystart' - 'dll mystart' selection2a: commandline|endswith: ' mystart' selection2b: commandline|contains: 'rundll32.exe'
<li><a href="#">detection: selection1: commandline|contains: - 'echo ' - 'copy ' - 'type ' - 'file createnew' selection2: commandline|contains: - ' c:\windows\system32\tasks\' - ' c:\windows\syswow64\tasks\'
<li><a href="#">detection: selection1: commandline|contains: ' -ma ' selection2: commandline|contains: ' lsass' selection3: commandline|contains|all: - ' -ma ' - ' ls'
<li><a href="#">detection: selection1: commandline|contains: - 'powershell.exe' - '\powershell' selection2: commandline|contains|all: - '/c ' - '\appdata\' commandline|contains: - 'local\' - 'roaming\'
<li><a href="#">detection: selection1: commandline|contains: - 'reg.exe save hklm\sam %temp%\~reg_sam.save' - '1q2w3e4r@#$@#$@#$' - ' -hp1q2w3e4 ' - '.dat data03 10000 -p ' selection2: commandline|contains|all: - 'process call create' - ' > %temp%\~' selection3: commandline|contains|all: - 'netstat -aon | find ' - ' > %temp%\~' # network share discovery selection4: commandline|contains: '.255 10 c:\programdata\'
<li><a href="#">detection: selection1: commandline|contains: - 'tracert -h 10 yahoo.com' - '.wsqmcons))|iex;' - 'fr`omba`se6`4str`ing' selection2: commandline|contains|all: - 'net use ' - '@aol.co.uk'
<li><a href="#">detection: selection1: commandline|contains: - xyz123456.exe - purplesharp selection2: originalfilename: 'purplesharp.exe'
<li><a href="#">detection: selection1: commandline|contains: '\calc.exe ' selection2: image|endswith: '\calc.exe' filter2: image|contains: '\windows\sys'
<li><a href="#">detection: selection1: commandline|contains: '\cmd.exe /c whoami' parentimage|startswith: 'c:\temp' selection2: commandline|contains: 'conhost.exe 0xffffffff -forcev1' parentcommandline|contains: - '/c whoami' - 'cmd.exe /c echo' - ' > \\\\.\\pipe' selection3: commandline|contains: - 'cmd.exe /c echo' - '> \\\\.\\pipe' - '\whoami.exe' parentimage|endswith: '\dllhost.exe' selection4: image|endswith: '\cmd.exe' parentimage|endswith: '\runonce.exe' parentcommandline|endswith: '\runonce.exe'
<li><a href="#">detection: selection1: commandline|contains: '\currentversion\image file execution options\' selection2: commandline|contains: - 'sethc.exe' - 'utilman.exe' - 'osk.exe' - 'magnify.exe' - 'narrator.exe' - 'displayswitch.exe' - 'atbroker.exe'
<li><a href="#">detection: selection1: commandline|contains: '7z.exe a -v500m -mx9 -r0 -p' selection2: parentcommandline|contains|all: - 'wscript.exe' - '.vbs' commandline|contains|all: - 'rundll32.exe' - 'c:\windows' - '.dll,tk_' selection3: parentimage|endswith: '\rundll32.exe' parentcommandline|contains: 'c:\windows' commandline|contains: 'cmd.exe /c ' selection4: commandline|contains|all: - 'rundll32 c:\windows\' - '.dll ' specific1: parentimage|endswith: '\rundll32.exe' image|endswith: '\dllhost.exe' filter1: commandline: - ' ' - ''
<li><a href="#">detection: selection1: commandline|contains: 'aaaayinlm' selection2: commandline|contains: - 'oicaaaayinlm' - 'oijaaaayinlm'
<li><a href="#">detection: selection1: commandline|contains: 'add-printerport -name' selection2: commandline|contains: - '.exe' - '.dll' - '.bat' selection3: commandline|contains: 'generic / text only'
<li><a href="#">detection: selection1: commandline|contains: 'microsoft.nodejstools.pressanykey.exe normal ' selection2: commandline|contains: '.exe normal ' commandline|endswith: '.exe' filter: image|contains: '\microsoft\nodejstools\nodejstools'
<li><a href="#">detection: selection1: commandline|contains: 'rundll32.exe' selection2: commandline|contains: - '.sys,' - '.sys '
<li><a href="#">detection: selection1: commandline|contains: 'setup0.exe -p' selection2a: commandline|contains: 'setup.exe' selection2b: commandline|endswith: - '-x:0' - '-x:1' - '-x:2'
<li><a href="#">detection: selection1: commandline|contains: 'system.management.automation.amsiutils' selection2: commandline|contains: 'amsiinitfailed'
<li><a href="#">detection: selection1: commandline|contains: 'whoami' selection2: commandline|contains: - './client/common/' - '.\client\common\' selection3: commandline|contains: 'c:\windows\temp\serv-u.bat'
<li><a href="#">detection: selection1: commandline|contains|all: - ' -name ieharden ' - ' -value 0 ' selection2: commandline|contains|all: - ' -name depoff ' - ' -value 1 ' selection3: commandline|contains|all: - ' -name disablefirstruncustomize ' - ' -value 2 '
<li><a href="#">detection: selection1: commandline|contains|all: - 'attrib' - ' +h ' - ' +s ' - ' +r ' - '.aspx' selection2: commandline|contains|all: - 'schtasks' - 'vsperfmon' selection3: commandline|contains|all: - 'vssadmin list shadows' - 'temp\__output' selection4: commandline|contains: '%temp%\execute.bat' selection5: image|endswith: 'users\public\opera\opera_browser.exe' selection6: image|endswith: 'opera_browser.exe' parentimage|endswith: - '\services.exe' - '\svchost.exe' selection7: image|contains: '\programdata\vsperfmon\' selection8: commandline|contains|all: - ' -t7z ' - 'c:\programdata\pst' - '\it.zip' selection9: image|endswith: '\makecab.exe' commandline|contains: - 'microsoft\exchange server\' - 'inetpub\wwwroot' selection10: commandline|contains: - '\temp\xx.bat' - 'windows\wwansvcdcs' - 'windows\temp\cw.exe' selection11: commandline|contains|all: - '\comsvcs.dll' - 'minidump' - '\inetpub\wwwroot' selection12: commandline|contains|all: - 'dsquery' - ' -uco ' - '\inetpub\wwwroot'
<li><a href="#">detection: selection1: commandline|contains|all: - 'bitsadmin' - '/transfer' - 'csidl_appdata' selection2: commandline|contains: 'csidl_system_drive' selection3: commandline|contains: - '\msf.ps1' - '8989 -e cmd.exe' - 'system.data.sqlclient.sqldataadapter($cmd); [void]$da.fill' - '-nop -w hidden -c $k=new-object' - '[net.credentialcache]::defaultcredentials;iex ' - ' -nop -w hidden -c $m=new-object net.webclient;$m' - '-noninteractive -executionpolicy bypass whoami' - '-noninteractive -executionpolicy bypass netstat -a' - 'l3nlcnzlcj1' # base64 encoded '/server=' selection4: image|endswith: - '\adobe\adobe.exe' - '\oracle\local.exe' - '\revshell.exe' - 'infopagesbackup\ncat.exe' - 'csidl_system\cmd.exe' - '\programdata\oracle\java.exe' - 'csidl_common_appdata\comms\comms.exe' - '\programdata\vmware\vmware.exe'
<li><a href="#">detection: selection1: commandline|contains|all: - 'invoke-wmimethod win32_process -name create -argumentlist' - 'rundll32 c:\windows' selection2: commandline|contains|all: - 'wmic /node:' - 'process call create "rundll32 c:\windows'
<li><a href="#">detection: selection1: commandline|contains|all: - 'lsass' - '.dmp' selection2: image|endswith: '\werfault.exe' selection3: image|contains: '\procdump' image|endswith: '.exe' commandline|contains: 'lsass'
<li><a href="#">detection: selection1: commandline|contains|all: - 'mshta' - '.zip' selection2: parentimage: 'c:\windows\system32\wbem\wmiprvse.exe' image: 'c:\windows\system32\mshta.exe' selection3: parentimage|contains: ':\users\public\' image: 'c:\windows\system32\rundll32.exe'
<li><a href="#">detection: selection1: commandline|contains|all: - netsh - firewall add portopening - tcp 3389 selection2: commandline|contains|all: - netsh - advfirewall firewall add rule - action=allow - protocol=tcp - localport=3389
<li><a href="#">detection: selection1: commandline|contains|all: - 'rundll32' - 'javascript' - '..\..\mshtml,runhtmlapplication' selection2: commandline|contains: ';document.write();getobject("script'
<li><a href="#">detection: selection1: commandline|contains|all: - 'rundll32.exe' - '%appdata%\' selection2: - commandline|contains: '.dat",' - commandline|endswith: - '.dll",#1' - '.dll #1' - '.dll" #1'
<li><a href="#">detection: selection1: commandline|contains|all: - 'taskkill ' - 'raccinesettings.exe' selection2: commandline|contains|all: - 'reg.exe' - 'delete' - 'raccine tray' selection3: commandline|contains|all: - 'schtasks' - '/delete' - 'raccine rules updater'
<li><a href="#">detection: selection1: commandline|contains|all: - '-u ' - '-p ' selection2: commandline|contains: - '^user^' - '^pass^'
<li><a href="#">detection: selection1: commandline|endswith: ' ' selection2: imagename|endswith: ' '
<li><a href="#">detection: selection1: commandline|endswith: '.cpl' filter: commandline|contains: - '\system32\' - '%system%' fp1_igfx: commandline|contains|all: - 'regsvr32 ' - ' /s ' - 'igfxcpl.cpl' selection2: image|endswith: '\reg.exe' commandline|contains: 'add' selection3: commandline|contains: 'currentversion\control panel\cpls'
<li><a href="#">detection: selection1: commandline|startswith: '"c:\windows\system32\wusa.exe" /quiet c:\users\' commandline|endswith: '\appdata\local\temp\update.msu' integritylevel: - 'high' - 'system' selection2: parentcommandline: '"c:\windows\system32\dism.exe" /online /quiet /norestart /add-package /packagepath:"c:\windows\system32\pe386" /ignorecheck' integritylevel: - 'high' - 'system' commandline|contains|all: - 'c:\users\' - '\appdata\local\temp\' - '\dismhost.exe {' image|endswith: '\dismhost.exe'
<li><a href="#">detection: selection1: company: securityxploded selection2: image|endswith: 'passworddump.exe' selection3: originalfilename|endswith: 'passworddump.exe'
<li><a href="#">detection: selection1: cs-method: 'get' c-uri|contains: - '/ecp/' - '/owa/' selection2: c-uri|contains: '__viewstate='
<li><a href="#">detection: selection1: cs-method: 'post' c-uri|contains: '/owa/auth/current/themes/resources/' selection2: cs-method: 'post' c-uri|contains: '/owa/auth/current/' c-useragent: - 'duckduckbot/1.0;+(+)' - 'facebookexternalhit/1.1+(+)' - 'mozilla/5.0+(compatible;+baiduspider/2.0;++)' - 'mozilla/5.0+(compatible;+bingbot/2.0;++)' - 'mozilla/5.0+(compatible;+googlebot/2.1;++' - 'mozilla/5.0+(compatible;+konqueror/3.5;+linux)+khtml/3.5.5+(like+gecko)+(exabot-thumbnails)' - 'mozilla/5.0+(compatible;+yahoo!+slurp;+)' - 'mozilla/5.0+(compatible;+yandexbot/3.0;++)' - 'mozilla/5.0+(x11;+linux+x86_64)+applewebkit/537.36+(khtml,+like+gecko)+chrome/51.0.2704.103+safari/537.36' selection3: c-uri|contains: '/ecp/' cs-method: 'post' c-useragent: - 'exchangeservicesclient/0.0.0.0' - 'python-requests/2.19.1' - 'python-requests/2.25.1' selection4: c-uri|contains: - '/aspnet_client/' - '/owa/' cs-method: 'post' c-useragent: - 'antsword/v2.1' - 'googlebot/2.1+(+)' - 'mozilla/5.0+(compatible;+baiduspider/2.0;++)' selection5: c-uri|contains: - '/owa/auth/current/' - '/ecp/default.flt' - '/ecp/main.css' cs-method: 'post' selection6: cs-method: 'post' c-uri|contains|all: - '/ecp/' - '.js'
<li><a href="#">detection: selection1: cs-method: 'post' c-uri|contains|all: - '/ecp/' - '/ruleseditor/inboxrules.svc/newobject' sc-status: 500 selection2: c-uri|contains|all: - 'securitytoken=' - '/ecp/' sc-status: 500
<li><a href="#">detection: selection1: cs-user-agent|contains: - '${jndi:ldap:/' - '${jndi:rmi:/' - '${jndi:ldaps:/' - '${jndi:dns:/' - '/$%7bjndi:' - '%24%7bjndi:' - '$%7bjndi:' - '%2524%257bjndi' - '%2f%252524%25257bjndi%3a' - '${jndi:${lower:' - '${::-j}${' - '${jndi:nis' - '${jndi:nds' - '${jndi:corba' - '${jndi:iiop' - 'reference class name: foo' - '${${env:barfoo:-j}' - '${::-l}${::-d}${::-a}${::-p}' - '${base64:jhtqbmrp' - '${${env:env_name:-j}ndi${env:env_name:-:}$' - '${${lower:j}ndi:' - '${${upper:j}ndi:' - '${${::-j}${::-n}${::-d}${::-i}:' selection2: user-agent|contains: - '${jndi:ldap:/' - '${jndi:rmi:/' - '${jndi:ldaps:/' - '${jndi:dns:/' - '/$%7bjndi:' - '%24%7bjndi:' - '$%7bjndi:' - '%2524%257bjndi' - '%2f%252524%25257bjndi%3a' - '${jndi:${lower:' - '${::-j}${' - '${jndi:nis' - '${jndi:nds' - '${jndi:corba' - '${jndi:iiop' - 'reference class name: foo' - '${${env:barfoo:-j}' - '${::-l}${::-d}${::-a}${::-p}' - '${base64:jhtqbmrp' - '${${env:env_name:-j}ndi${env:env_name:-:}$' - '${${lower:j}ndi:' - '${${upper:j}ndi:' - '${${::-j}${::-n}${::-d}${::-i}:' selection3: cs-uri|contains: - '${jndi:ldap:/' - '${jndi:rmi:/' - '${jndi:ldaps:/' - '${jndi:dns:/' - '/$%7bjndi:' - '%24%7bjndi:' - '$%7bjndi:' - '%2524%257bjndi' - '%2f%252524%25257bjndi%3a' - '${jndi:${lower:' - '${::-j}${' - '${jndi:nis' - '${jndi:nds' - '${jndi:corba' - '${jndi:iiop' - 'reference class name: foo' - '${${env:barfoo:-j}' - '${::-l}${::-d}${::-a}${::-p}' - '${base64:jhtqbmrp' - '${${env:env_name:-j}ndi${env:env_name:-:}$' - '${${lower:j}ndi:' - '${${upper:j}ndi:' - '${${::-j}${::-n}${::-d}${::-i}:' selection4: cs-referer|contains: - '${jndi:ldap:/' - '${jndi:rmi:/' - '${jndi:ldaps:/' - '${jndi:dns:/' - '/$%7bjndi:' - '%24%7bjndi:' - '$%7bjndi:' - '%2524%257bjndi' - '%2f%252524%25257bjndi%3a' - '${jndi:${lower:' - '${::-j}${' - '${jndi:nis' - '${jndi:nds' - '${jndi:corba' - '${jndi:iiop' - 'reference class name: foo' - '${${env:barfoo:-j}' - '${::-l}${::-d}${::-a}${::-p}' - '${base64:jhtqbmrp' - '${${env:env_name:-j}ndi${env:env_name:-:}$' - '${${lower:j}ndi:' - '${${upper:j}ndi:' - '${${::-j}${::-n}${::-d}${::-i}:'
<li><a href="#">detection: selection1: c-uri|contains: - '/dana-na/auth/' - '/dana-ws/' - '/dana-cached/' selection2: c-uri|contains: - '?id=' - '?token=' - 'secid_canceltoken.cgi' - 'cgi::param' - 'meeting' - 'smb' - 'namedusers' - 'metric'
<li><a href="#">detection: selection1: c-uri|contains: '/rapi/filedownload?filter=path:%2f' selection2: c-uri|contains|all: - '/pcidss/report' - 'type=all_signatures' - 'sig_name=_default_signature_'
<li><a href="#">detection: selection1: c-uri|contains|all: - '?dwn=' - '&fn=' - '.html?' selection2: c-uri|contains|all: - '&dwn=' - '?fn=' - '.html?'
<li><a href="#">detection: selection1: c-uri|contains|all: - 'logoimagehandler.ashx' - 'clazz' selection2: c-uri|contains: 'logoimagehandler.ashx' sc-status: 500
<li><a href="#">detection: selection1: c-useragent: - 'mozilla/4.0 (compatible; msie 6.0;windows nt 5.1)' - 'mozilla/4.0 (compatible; msie 7.0; windows nt 6.1; wow64; trident/4.0; slcc2; .net clr 3.0.30729; .net4.0c; .net4.0e )' - 'mozilla/5.0 (windows; u; msie 7.0; windows nt 5.2) java/1.5.0_08' selection2: c-useragent|endswith: '; manm; manm)'
<li><a href="#">detection: selection1: c-useragent: 'mozilla/5.0 (windows nt 6.1; wow64; trident/7.0; rv:11.0) like gecko' cs-method: 'get' c-uri: '/s/ref=nb_sb_noss_1/167-3294888-0262949/field-keywords=books' cs-host: 'www.amazon.com' cs-cookie|endswith: '=csm-hit=s-24ku11bb82rzsygj3bdk|1419899012996' selection2: c-useragent: 'mozilla/5.0 (windows nt 6.1; wow64; trident/7.0; rv:11.0) like gecko' cs-method: 'post' c-uri: '/n4215/adj/amzn.us.sr.aps' cs-host: 'www.amazon.com'
<li><a href="#">detection: selection1: c-useragent|startswith: - 'user-agent' # user-agent: user-agent: - 'mozilla/3.0 ' - 'mozilla/2.0 ' - 'mozilla/1.0 ' - 'mozilla ' # missing slash - ' mozilla/' # leading space - 'mozila/' # single 'l' - 'mozilla/4.0 (compatible; msie 6.0; ms web services client protocol' # selection2: c-useragent|contains: - ' (compatible;msie ' # typical typo - missing space - '.0;windows nt ' # typical typo - missing space - 'loader' # selection3: c-useragent: - '_' - 'certutil url agent' # - 'mozilla/5.0 (windows nt 10.0; win64; x64; rv:60.0)' # cobaltstrike beacon - 'mozilla/5.0 (windows nt 6.3; wow64; rv:28.0) gecko/20100101 firefox/28.0' # used by apt28 malware - 'https' # falsepositives: c-useragent: 'mozilla/3.0 * acrobat *' # acrobat with linked content
<li><a href="#">detection: selection1: description: '\?' fileversion: '\?' selection2: description: '\?' product: '\?' selection3: description: '\?' company: '\?' folder: image|contains: '\downloads\'
<li><a href="#">detection: selection1: description: java update scheduler selection2: description: java(tm) update scheduler filter: image|endswith: '\jusched.exe'
<li><a href="#">detection: selection1: description: 'paexec application' selection2: originalfilename: 'paexec.exe' filter: image|endswith: - '\paexec.exe' - '\paexec.exe'
<li><a href="#">detection: selection1: dst_port: - 8080 - 21 - 80 - 23 - 50000 - 1521 - 27017 - 3306 - 1433 - 11211 - 15672 - 5900 - 5901 - 5902 - 5903 - 5904 selection2: action: - forward - accept - 2
<li><a href="#">detection: selection1: engineversion|startswith: - '2.' - '4.' - '5.' hostversion|startswith: '3.'
<li><a href="#">detection: selection1: eventid: - 4625 - 4624 logontype: 3 authenticationpackagename: 'ntlm' workstationname|re: '^[a-za-z0-9]{16}$' selection2: processname: eventid: 4776 workstation|re: '^[a-za-z0-9]{16}$'
<li><a href="#">detection: selection1: eventid: - 4765 - 4766 selection2: eventid: 4738 selection3: sidhistory: - '-' - '%%1793' filter_null: sidhistory:
<li><a href="#">detection: selection1: eventid: - 529 - 4625 targetusername: '*' workstationname: '*'
<li><a href="#">detection: selection1: eventid: 4 provider_name: 'msexchange control panel' level: error selection2: - '&__viewstate='
<li><a href="#">detection: selection1: eventid: 4625 logontype: 2 filter: processname: '-' timeframe: 24h
<li><a href="#">detection: selection1: eventid: 4625 logontype: 3 filter: ipaddress: '-' timeframe: 24h
<li><a href="#">detection: selection1: eventid: 4648 timeframe: 24h
<li><a href="#">detection: selection1: eventid: 4657 objectname|contains: - 'winevt\publishers\{5770385f-c22a-43e0-bf4c-06f5698ffbd9}' - 'winevt\channels\microsoft-windows-sysmon/operational' objectvaluename: 'enabled' newvalue: '0' selection2: eventid: 4663 objectname|contains: - 'winevt\publishers\{5770385f-c22a-43e0-bf4c-06f5698ffbd9}' - 'winevt\channels\microsoft-windows-sysmon/operational' accessmask: 0x10000
<li><a href="#">detection: selection1: eventid: 4738 filter_null: - allowedtodelegateto: '-' - allowedtodelegateto: selection_5136_1: eventid: 5136 attributeldapdisplayname: 'msds-allowedtodelegateto' selection_5136_2: eventid: 5136 objectclass: 'user' attributeldapdisplayname: 'serviceprincipalname' selection_5136_3: eventid: 5136 attributeldapdisplayname: 'msds-allowedtoactonbehalfofotheridentity'
<li><a href="#">detection: selection1: eventid: 4742 serviceprincipalnames|contains: 'gc/' selection2: eventid: 5136 attributeldapdisplayname: serviceprincipalname attributevalue|startswith: 'gc/'
<li><a href="#">detection: selection1: eventid: 4776 status: '*0xc0000064' # the username you typed does not exist. bad username. filter: targetusername: '*$' timeframe: 24h
<li><a href="#">detection: selection1: eventid: 4776 status: '*0xc000006a' #account logon with misspelled or bad password. filter: targetusername: '*$' timeframe: 24h
<li><a href="#">detection: selection1: eventid: 4776 workstation: 'ruler' selection2: eventid: - 4624 - 4625 workstationname: 'ruler'
<li><a href="#">detection: selection1: eventid: 4898 templatecontent|contains: 'ct_flag_enrollee_supplies_subject' selection2: eventid: 4899 newtemplatecontent|contains: 'ct_flag_enrollee_supplies_subject'
<li><a href="#">detection: selection1: eventid: 5007 newvalue|contains: '\microsoft\windows defender\exclusions'
<li><a href="#">detection: selection1: eventid: 5145 sharename: \\\*\ipc$ false_positives: relativetargetname: - 'atsvc' - 'samr' - 'lsarpc' - 'lsass' - 'winreg' - 'netlogon' - 'srvsvc' - 'protected_storage' - 'wkssvc' - 'browser' - 'netdfs' - 'svcctl' - 'spoolss' - 'ntsvcs' - 'lsm_api_service' - 'hydralspipe' - 'termsrv_api_service' - 'msftewds' - 'sql\query'
<li><a href="#">detection: selection1: eventid: 5145 sharename: \\\*\ipc$ relativetargetname|contains: - 'remcom_stdint' - 'remcom_stdoutt' - 'remcom_stderrt'
<li><a href="#">detection: selection1: eventid: 5145 sharename: \\\*\ipc$ relativetargetname|endswith: - '-stdin' - '-stdout' - '-stderr' filter: relativetargetname|startswith: 'psexesvc'
<li><a href="#">detection: selection1: eventsource: glue.amazonaws.com eventname: createdevendpoint selection2: eventsource: glue.amazonaws.com eventname: deletedevendpoint selection3: eventsource: glue.amazonaws.com eventname: updatedevendpoint
<li><a href="#">detection: selection1: eventsource: lambda.amazonaws.com eventname: createfunction selection2: eventsource: lambda.amazonaws.com eventname: invoke
<li><a href="#">detection: selection1: eventsource: sts.amazonaws.com eventname: assumerolewithsaml selection2: eventsource: iam.amazonaws.com eventname: updatesamlprovider
<li><a href="#">detection: selection1: eventtype: deletevalue targetobject|contains: '\microsoft\terminal server client\default\mru' selection2: eventtype: deletekey targetobject|contains: '\microsoft\terminal server client\servers\'
<li><a href="#">detection: selection1: eventtype: deletevalue targetobject|endswith: '\appxypsaf9f1qserqevf0sws76dx4k9a5206\shell\open\command\delegateexecute' selection2: targetobject|endswith: '\appxypsaf9f1qserqevf0sws76dx4k9a5206\shell\open\command\(default)' #add the payload in the (default)
<li><a href="#">detection: selection1: eventtype: setvalue targetobject|contains: - 'software\microsoft\office\' - '\outlook\today\' selectionstamp: targetobject|endswith: stamp details: dword (0x00000001) selectionuserdefined: targetobject|endswith: userdefinedurl filter_office: image|startswith: - 'c:\program files\common files\microsoft shared\clicktorun\' - 'c:\program files\common files\microsoft shared\clicktorun\updates\' image|endswith: '\officeclicktorun.exe'
<li><a href="#">detection: selection1: eventtype: setvalue targetobject|contains: 'hklm\system\currentcontrolset\services' selection2: details|contains|all: - 'admin$' - '.exe' selection3: details|contains|all: - '%comspec%' - 'start' - 'powershell'
<li><a href="#">detection: selection1: eventtype: setvalue targetobject|endswith: 'classes\ms-settings\shell\open\command\symboliclinkvalue' details|contains: '\software\classes\{' selection2: targetobject|endswith: 'classes\ms-settings\shell\open\command\delegateexecute' selection3: eventtype: setvalue targetobject|endswith: - 'classes\ms-settings\shell\open\command\(default)' - 'classes\exefile\shell\open\command\(default)' filter_sel3: details: '(empty)'
<li><a href="#">detection: selection1: eventtype: setvalue targetobject|endswith: software\classes\exefile\shell\runas\command\isolatedcommand selection2: eventtype: setvalue targetobject|endswith: software\classes\folder\shell\open\command\symboliclinkvalue details|contains: '-1???\software\classes\'
<li><a href="#">detection: selection1: gcp.audit.method_name|startswith: admissionregistration.k8s.io.v*.mutatingwebhookconfigurations. gcp.audit.method_name|endswith: - create - patch - replace selection2: gcp.audit.method_name|startswith: admissionregistration.k8s.io.v*.validatingwebhookconfigurations. gcp.audit.method_name|endswith: - create - patch - replace
<li><a href="#">detection: selection1: image: - '/bin/dd' - '/usr/bin/dd' selection2: commandline|contains: 'of=' selection3: commandline|contains: - 'if=/dev/zero' - 'if=/dev/null'
<li><a href="#">detection: selection1: image: - '/usr/sbin/netstat' - '/sbin/ifconfig' - '/usr/sbin/ipconfig' - '/usr/libexec/applicationfirewall/socketfilterfw' - '/usr/sbin/networksetup' - '/usr/sbin/arp' selection2: image: '/usr/bin/defaults' commandline|contains|all: - 'read' - '/library/preferences/com.apple.alf'
<li><a href="#">detection: selection1: image: '/usr/bin/security' commandline|contains: - 'find-certificate' - ' export ' selection2: commandline|contains: - ' dump-keychain ' - ' login-keychain '
<li><a href="#">detection: selection1: image: '/usr/sbin/firmwarepasswd' commandline|contains: - 'setpasswd' - 'full' - 'delete' - 'check'
<li><a href="#">detection: selection1: image: '/usr/sbin/osascript' selection2: commandline|contains|all: - '-e' - 'display' - 'dialog' - 'answer' selection3: commandline|contains: - 'admin' - 'administrator' - 'authenticate' - 'authentication' - 'credentials' - 'pass' - 'password' - 'unlock'
<li><a href="#">detection: selection1: image: 'c:\program files\windows media player\osk.exe' integritylevel: - 'high' - 'system' selection2: image: 'c:\windows\system32\cmd.exe' parentcommandline: '"c:\windows\system32\mmc.exe" "c:\windows\system32\eventvwr.msc" /s' integritylevel: - 'high' - 'system'
<li><a href="#">detection: selection1: image: c:\windows\system32\net.exe selection2: commandline|contains|all: - 'net' - ' use ' - ':*\\' - '/user:* *' filter: commandline|endswith: ' '
<li><a href="#">detection: selection1: image: 'c:\windows\syswow64\cmd.exe' commandline|contains: '\windows\caches\navshext.dll ' selection2: commandline|endswith: '\appdata\roaming\micros~1\windows\caches\navshext.dll,setting'
<li><a href="#">detection: selection1: image|contains: - '\bloodhound.exe' - '\sharphound.exe' selection2: commandline|contains: - ' -collectionmethod all ' - '.exe -c all -d ' - 'invoke-bloodhound' - 'get-bloodhounddata' selection3: commandline|contains|all: - ' -jsonfolder ' - ' -zipfilename ' selection4: commandline|contains|all: - ' dconly ' - ' --nosavecache '
<li><a href="#">detection: selection1: image|contains: '\advanced_ip_scanner' selection2: commandline|contains|all: - '/portable' - '/lng'
<li><a href="#">detection: selection1: image|contains: '\advanced_port_scanner' selection2: commandline|contains|all: - '/portable' - '/lng'
<li><a href="#">detection: selection1: image|contains: '\createminidump.exe' selection2: - imphash: '4a07f944a83e8a7c2525efa35dd30e2f' - hashes|contains: 'imphash=4a07f944a83e8a7c2525efa35dd30e2f'
<li><a href="#">detection: selection1: image|contains: '\windows\' commandline|contains: - '\..\windows\' - '\..\system32\' - '\..\..\' selection2: commandline|contains: '.exe\..\' filter: commandline|contains: '\google\drive\googledrivesync.exe\..\'
<li><a href="#">detection: selection1: image|contains: 'windows\system32\physmem.sys' selection2: image|contains: - 'windows\system32\ime\shared\wimbootconfigurations.ini' - 'windows\system32\ime\imejp\wimbootconfigurations.ini' - 'windows\system32\ime\imetc\wimbootconfigurations.ini' selection3: image|contains: - 'windows\system32\filepath2' - 'windows\system32\ime' registry_command: commandline|contains: 'reg add' registry_key: commandline|contains: - 'hkey_local_machine\software\classes\clsid\{7c857801-7381-11cf-884d-00aa004b2e24}\inprocserver32' - 'hkey_local_machine\software\classes\clsid\{cf4cc405-e2c5-4ddd-b3ce-5e7582d8c9fa}\inprocserver32'
<li><a href="#">detection: selection1: image|contains: 'xclip' selection2: commandline|contains: - '-selection' - '-sel' selection3: commandline|contains: - 'clipboard' - 'clip' selection4: commandline|contains: '-o'
<li><a href="#">detection: selection1: image|endswith: - '/firewall-cmd' - '/ufw' - '/iptables' - '/netstat' - '/ss' - '/ip' - '/ifconfig' - '/systemd-resolve' - '/route' selection2: commandline|contains: '/etc/resolv.conf'
<li><a href="#">detection: selection1: image|endswith: - '\net.exe' - '\net1.exe' commandline|contains: 'stop' selection2: commandline|contains: - 'samss' - 'audioendpointbuilder' - 'unistoresvc_?????'
<li><a href="#">detection: selection1: image|endswith: - '\procdump.exe' - '\procdump64.exe' selection2: commandline|contains|all: - ' -ma ' - '.exe'
<li><a href="#">detection: selection1: image|endswith: - '\robocopy.exe' - '\xcopy.exe' selection2: image|endswith: '\cmd.exe' commandline|contains: 'copy' selection3: image|contains: '\powershell' commandline|contains: - 'copy-item' - 'copy' - 'cpi ' - ' cp ' selection4: commandline|contains|all: - '\\\\' - '$'
<li><a href="#">detection: selection1: image|endswith: - '\wscript.exe' - '\cscript.exe' commandline|contains: - 'c:\users\' - 'c:\programdata\' selection2: commandline|contains: - '.jse' - '.vbe' - '.js' - '.vba' - '.vbs' falsepositive: parentimage|contains: '\winzip'
<li><a href="#">detection: selection1: image|endswith: '/grep' commandline|contains: 'password' selection2: commandline|contains: 'lazagne'
<li><a href="#">detection: selection1: image|endswith: '/rm' selection2: commandline|contains: '/var/log' selection3: commandline|contains|all: - '/users/' - '/library/logs/'
<li><a href="#">detection: selection1: image|endswith: '/touch' selection2: commandline|contains: - '-t' - '-acmr' - '-d' - '-r'
<li><a href="#">detection: selection1: image|endswith: '/truncate' commandline|contains: '-s' selection2: image|endswith: '/dd' commandline|contains: 'if=' filter: commandline|contains: 'of='
<li><a href="#">detection: selection1: image|endswith: \bcdedit.exe commandline|contains: set selection2: - commandline|contains|all: - bootstatuspolicy - ignoreallfailures - commandline|contains|all: - recoveryenabled - 'no'
<li><a href="#">detection: selection1: image|endswith: '\bitsadmin.exe' susp_flag_1: commandline|contains: ' /transfer ' susp_flag_2: commandline|contains: - ' /create ' - ' /addfile ' http_flag: commandline|contains: 'http' selection2: commandline|contains: 'copy bitsadmin.exe'
<li><a href="#">detection: selection1: image|endswith: '\certutil.exe' # example: certutil -addstore -f -user root certificatefilename.der commandline|contains|all: - '-addstore' - 'root' selection2: image|endswith: '\certmgr.exe' # example: certmgr.exe /add certificatefilename.cer /s /r localmachine root /all commandline|contains|all: - '/add' - 'root'
<li><a href="#">detection: selection1: image|endswith: '\createdump.exe' commandline|contains|all: - ' -u ' - ' -f ' selection2: commandline|contains|all: - ' -u -f ' - '.dmp '
<li><a href="#">detection: selection1: image|endswith: '\cscript.exe' commandline|contains: '-register' selection2: commandline|contains: - '\windows kits\10\bin\10.0.22000.0\x64' - '\windows kits\10\bin\10.0.19041.0\x64' - '\windows kits\10\bin\10.0.17763.0\x64'
<li><a href="#">detection: selection1: image|endswith: '\mshta.exe' commandline|contains: - 'vbscript' - '.jpg' - '.png' - '.lnk' # - '.chm' # could be prone to false positives - '.xls' - '.doc' - '.zip' - '.dll' - '.exe'
<li><a href="#">detection: selection1: image|endswith: '\netsh.exe' commandline|contains|all: - 'firewall' - 'add' - 'allowedprogram' selection2: image|endswith: '\netsh.exe' commandline|contains|all: - 'advfirewall' - 'firewall' - 'add' - 'rule' - 'action=allow' - 'program=' susp_image: - commandline|contains: - '%temp%' - ':\recycler\' - 'c:\$recycle.bin\' - ':\systemvolumeinformation\' - 'c:\windows\temp\' - 'c:\temp\' - 'c:\users\public\' - 'c:\users\default\' - 'c:\users\desktop\' - '\downloads\' - '\temporary internet files\content.outlook\' - '\local settings\temporary internet files\' - commandline|startswith: - 'c:\windows\tasks\' - 'c:\windows\debug\' - 'c:\windows\fonts\' - 'c:\windows\help\' - 'c:\windows\drivers\' - 'c:\windows\addins\' - 'c:\windows\cursors\' - 'c:\windows\system32\tasks\' - '%public%\'
<li><a href="#">detection: selection1: image|endswith: '\netsh.exe' commandline|contains|all: - 'interface' - 'portproxy' - 'add' - 'v4tov4' selection2: image|endswith: '\netsh.exe' commandline|contains|all: - 'connectp' - 'listena' - 'c='
<li><a href="#">detection: selection1: image|endswith: '\netsh.exe' selection2: commandline|contains|all: - 'firewall' - 'add' filter_dropbox: commandline|contains: - '\netsh.exe advfirewall firewall add rule name=dropbox dir=in action=allow "program=c:\program files (x86)\dropbox\client\dropbox.exe" enable=yes profile=any' - '\netsh.exe advfirewall firewall add rule name=dropbox dir=in action=allow "program=c:\program files\dropbox\client\dropbox.exe" enable=yes profile=any'
<li><a href="#">detection: selection1: image|endswith: '\policydefinitions\postgresql.exe' selection2: - commandline|contains: - 'csidl_system_drive\temp\sys.tmp' - ' 1> \\127.0.0.1\admin$\__16' - commandline|contains|all: - 'powershell -c ' - '\comsvcs.dll minidump ' - '\winupd.log full'
<li><a href="#">detection: selection1: image|endswith: '\powershell.exe' commandline|contains|all: - 'char' - 'join' selection2: image|endswith: '\powershell.exe' commandline|contains: - 'toint' - 'todecimal' - 'tobyte' - 'touint' - 'tosingle' - 'tosbyte' selection3: image|endswith: '\powershell.exe' commandline|contains: - 'tochar' - 'tostring' - 'string' selection4: image|endswith: '\powershell.exe' commandline|contains|all: - 'split' - 'join' selection5: image|endswith: '\powershell.exe' commandline|contains|all: - 'foreach' - 'xor' selection6: image|endswith: '\powershell.exe' commandline|contains: 'convertto-securestring'
<li><a href="#">detection: selection1: image|endswith: '\powershell.exe' commandline|re: '.*\+.*\+.*\+.*\+.*\+.*\+.*\+.*\+.*\+.*\+.*\+.*\+.*\+.*\+.*' selection2: image|endswith: '\powershell.exe' commandline|re: '.*\{.*\{.*\{.*\{.*\{.*\{.*\{.*\{.*\{.*\{.*' selection3: image|endswith: '\powershell.exe' commandline|re: '.*\{' selection4: image|endswith: '\powershell.exe' commandline|re: '.*\^.*\^.*\^.*\^.*\^.*' selection5: image|endswith: '\powershell.exe' commandline|re: '.*`.*`.*`.*`.*`.*' filter_amazonssm: parentimage: c:\program files\amazon\ssm\ssm-document-worker.exe filter_windef_atp: commandline|contains: - 'new eventsource("microsoft.windows.sense.client.management"' - 'public static extern bool installelamcertificateinfo(safefilehandle handle);'
<li><a href="#">detection: selection1: image|endswith: \print.exe commandline|startswith: print selection2: commandline|contains: /d exe
<li><a href="#">detection: selection1: image|endswith: '\rdrleakdiag.exe' commandline|contains: '/fullmemdmp' selection2: commandline|contains|all: - '/fullmemdmp' - ' /o ' - ' /p '
<li><a href="#">detection: selection1: image|endswith: '\reg.exe' commandline|contains|all: - ' add ' - '\system\currentcontrolset\control\terminal server' - 'reg_dword' - ' /f' selection2: commandline|contains|all: - 'licensing core' - 'enableconcurrentsessions' selection3: commandline|contains: - 'winstations\rdp-tcp' - 'maxinstancecount' - 'fenablewinstation' - 'tsuserenabled' - 'tsenabled' - 'tsappcompat' - 'idlewinstationpoolcount' - 'tsadvertise' - 'allowtsconnections' - 'fsinglesessionperuser'
<li><a href="#">detection: selection1: image|endswith: '\regsvr32.exe' commandline|contains: '\temp\' selection2: image|endswith: '\regsvr32.exe' parentimage|endswith: '\powershell.exe' selection3: image|endswith: '\regsvr32.exe' parentimage|endswith: '\cmd.exe' selection4a: image|endswith: '\regsvr32.exe' commandline|contains|all: - '/i:' - 'http' commandline|endswith: 'scrobj.dll' selection4b: image|endswith: '\regsvr32.exe' commandline|contains|all: - '/i:' - 'ftp' commandline|endswith: 'scrobj.dll' selection5: image|endswith: '\wscript.exe' parentimage|endswith: '\regsvr32.exe' selection6: image|endswith: '\excel.exe' commandline|contains: '..\..\..\windows\system32\regsvr32.exe ' selection7: parentimage|endswith: '\mshta.exe' image|endswith: '\regsvr32.exe' selection8: image|endswith: '\regsvr32.exe' commandline|contains: - '\appdata\local' - 'c:\users\public' selection9: # suspicious extensions image|endswith: '\regsvr32.exe' commandline|endswith: - '.jpg' - '.jpeg' - '.png' - '.gif' - '.bin' - '.tmp' - '.temp' - '.txt' filter: commandline|contains: '\appdata\local\microsoft\teams'
<li><a href="#">detection: selection1: image|endswith: '\rundll32.exe' commandline|endswith: ',dll_u' selection2: commandline|contains: ' -export dll_u '
<li><a href="#">detection: selection1: image|endswith: '\rundll32.exe' selection2: description|contains: 'windows-hostprozess (rundll32)' selection3: commandline|contains: - 'default.getstring' - 'frombase64string'
<li><a href="#">detection: selection1: image|endswith: '\schtasks.exe' commandline|contains|all: - '/create' - '/sc' - 'frombase64string' - 'get-itemproperty' selection2: commandline|contains: - 'hkcu:' - 'hklm:' - 'registry::' - 'hkey_'
<li><a href="#">detection: selection1: image|endswith: '\sepremovaltoolnative_x64.exe' selection2: image|endswith: '\catclean.exe' commandline|contains: '--uninstall' selection3: image|endswith: '\netinstaller.exe' commandline|contains: '-r' selection4: image|endswith: '\wfpunins.exe' commandline|contains|all: - '/uninstall' - '/enterprise'
<li><a href="#">detection: selection1: image|endswith: '\svchost.exe' commandline|contains|all: - 'c:\users\' - '\desktop\' selection2: parentimage|endswith: '\svchost.exe' selection3: image|endswith: '\whoami.exe' commandline|contains: 'all' selection4: image|endswith: - '\net.exe' - '\net1.exe' commandline|contains: 'view'
<li><a href="#">detection: selection1: image|endswith: '\te.exe' selection2: parentimage|endswith: '\te.exe' selection3: originalfilename: '\te.exe'
<li><a href="#">detection: selection1: image|endswith: '\update.exe' # check if folder name matches executed binary \\(?p<first>[^\\]*)\\update.*start.{2}(?p<second>\1)\.exe (example: ) commandline|contains: '.exe' selection2: commandline|contains: - '--processstart' - '--processstartandwait' - '--createshortcut' filter1: commandline|contains|all: - 'c:\users\' - '\appdata\local\discord\update.exe' - ' --processstart discord.exe'
<li><a href="#">detection: selection1: image|endswith: '\werfault.exe' commandline|endswith: '\werfault.exe' selection2: image|endswith: '\rundll32.exe' commandline|endswith: '\rundll32.exe' selection3: image|endswith: '\regsvcs.exe' commandline|endswith: '\regsvcs.exe' selection4: image|endswith: '\regasm.exe' commandline|endswith: '\regasm.exe' selection5: image|endswith: '\regsvr32.exe' commandline|endswith: '\regsvr32.exe'
<li><a href="#">detection: selection1: image|endswith: '\xcopy.exe' commandline|contains|all: - '/s' - '/e' - '/c' - '/q' - '/h' - '\\' selection2: image|endswith: '\adexplorer.exe' commandline|contains|all: - '-snapshot' - '""' - 'c:\users\'
<li><a href="#">detection: selection1: image|endswith: 'bpftrace' commandline|contains: '--unsafe'
<li><a href="#">detection: selection1: image|startswith: 'c:\users\public\' commandline|contains: ' -single ' selection2: commandline|contains: - 'del c:\windows\system32\taskmgr.exe' - ';set-service -startuptype disabled $' - 'powershell -command "$x =[system.text.encoding]::unicode.getstring([system.convert]::frombase64string(' - ' do start wordpad.exe /p '
<li><a href="#">detection: selection1: originalfilename: 'procdump' selection2: commandline|contains|all: - ' -ma ' - ' -accepteula ' selection3: commandline|contains|all: - ' -ma ' - '.dmp' filter: image|endswith: - '\procdump.exe' - '\procdump64.exe'
<li><a href="#">detection: selection1: parentimage|contains: - 'c:\windows\temp' - '\hpqhvind.exe' image|startswith: 'c:\programdata\drm' selection2: parentimage|startswith: 'c:\programdata\drm' image|endswith: '\wmplayer.exe' selection3: parentimage|endswith: '\test.exe' image|endswith: '\wmplayer.exe' selection4: image: 'c:\programdata\drm\clr\clr.exe' selection5: parentimage|startswith: 'c:\programdata\drm\windows' image|endswith: '\searchfilterhost.exe'
<li><a href="#">detection: selection1: parentimage|endswith: '\powershell.exe' image|endswith: '\schtasks.exe' commandline|contains|all: - '/create' - '/sc' selection2: commandline|contains: - 'onlogon' - 'daily' - 'onidle' - 'updater' commandline|contains|all: - '/tn' - 'updater' - '/tr' - 'powershell'
<li><a href="#">detection: selection1: parentimage|endswith: '\winrar.exe' image|endswith: '\wscript.exe' selection2: commandline|contains: ' /c ping.exe -n 6 127.0.0.1 & type ' selection3: commandline|contains|all: - 'regsvr32.exe' - 'c:\programdata' - '.tmp'
<li><a href="#">detection: selection1: path: \\\*\ipc$ selection2: path: \\\*\ipc$ name: - 'atsvc' - 'samr' - 'lsarpc' - 'winreg' - 'netlogon' - 'srvsvc' - 'protected_storage' - 'wkssvc' - 'browser' - 'netdfs' - 'svcctl' - 'spoolss' - 'ntsvcs' - 'lsm_api_service' - 'hydralspipe' - 'termsrv_api_service' - 'msftewds'
<li><a href="#">detection: selection1: path|contains|all: - '\\' - '\ipc$' name|endswith: - '-stdin' - '-stdout' - '-stderr' selection2: name|contains|all: - '\\' - '\ipc$' path|startswith: 'psexesvc'
<li><a href="#">detection: selection1: product|contains: 'paexec' selection2: - imphash: - 11d40a7b7876288f919ab819cc2d9802 - 6444f8a34e99b8f7d9647de66aabe516 - dfd6aa3f7b2b1035b76b718f1ddc689f - 1a6cca4d5460b1710a12dea39e4a592c - hashes|contains: - imphash=11d40a7b7876288f919ab819cc2d9802 - imphash=6444f8a34e99b8f7d9647de66aabe516 - imphash=dfd6aa3f7b2b1035b76b718f1ddc689f - imphash=1a6cca4d5460b1710a12dea39e4a592c filter1: image|contains: 'paexec'
<li><a href="#">detection: selection1: properties.message: microsoft.authorization/elevateaccess/action
<li><a href="#">detection: selection1: properties.message|startswith: microsoft.kubernetes/connectedclusters/admissionregistration.k8s.io properties.message|endswith: - /mutatingwebhookconfigurations/write - /validatingwebhookconfigurations/write selection2: properties.message|startswith: microsoft.containerservice/managedclusters/admissionregistration.k8s.io properties.message|endswith: - /mutatingwebhookconfigurations/write - /validatingwebhookconfigurations/write
<li><a href="#">detection: selection1: properties.message|startswith: microsoft.kubernetes/connectedclusters/batch properties.message|endswith: - /cronjobs/write - /jobs/write selection2: properties.message|startswith: microsoft.containerservice/managedclusters/batch properties.message|endswith: - /cronjobs/write - /jobs/write
<li><a href="#">detection: selection1: provider_name: 'application error' eventid: 1000 selection2: provider_name: 'windows error reporting' eventid: 1001 keywords: - 'msmpeng.exe' - 'mpengine.dll'
<li><a href="#">detection: selection1: query|startswith: - 'aaa.stage.' - 'post.1' selection2: query|contains: '.stage.123456.'
<li><a href="#">detection: selection1: queryname|startswith: - 'aaa.stage.' - 'post.1' selection2: queryname|contains: '.stage.123456.'
<li><a href="#">detection: selection1: resulttype: 50097 resultdescription: 'device authentication is required' selection2: resulttype: 50155 resultdescription: 'deviceauthenticationfailed' selection3: resulttype: 50158 resultdescription: 'externalsecuritychallenge - external security challenge was not satisfied'
<li><a href="#">detection: selection1: scriptblocktext|contains: clear-history selection2a: scriptblocktext|contains: - remove-item - rm selection2b: scriptblocktext|contains: - consolehost_history.txt - (get-psreadlineoption).historysavepath
<li><a href="#">detection: selection1: scriptblocktext|contains|all: - 'move-item' - 'cert:\localmachine\root' selection2: scriptblocktext|contains|all: - 'import-certificate' - 'cert:\localmachine\root'
<li><a href="#">detection: selection1: targetfilename|endswith: - '\lsass.dmp' - '\lsass.zip' - '\lsass.rar' - '\temp\dumpert.dmp' - '\andrew.dmp' - '\coredump.dmp' selection2: targetfilename|contains: - '\lsass_2' # default format of procdump v9.0 is lsass_yymmdd_hhmmss.dmp - '\lsassdump' - '\lsassdmp' selection3: targetfilename|contains|all: - '\lsass' - '.dmp' selection4: targetfilename|contains: 'sqldmpr' targetfilename|endswith: '.mdmp' selection5: targetfilename|startswith: 'nanodump' targetfilename|endswith: '.dmp'
<li><a href="#">detection: selection1: targetfilename|endswith: - '\teamviewer\remoteprinting\tvprint.db' - '\teamviewer\tvnetwork.log' selection2: targetfilename|contains|all: - '\teamviewer' - '_logfile.log'
<li><a href="#">detection: selection1: targetfilename|startswith: - '/etc/cron.d/' - '/etc/cron.daily/' - '/etc/cron.hourly/' - '/etc/cron.monthly/' - '/etc/cron.weekly/' - '/var/spool/cron/crontabs/' selection2: targetfilename|contains: - '/etc/cron.allow' - '/etc/cron.deny' - '/etc/crontab'
<li><a href="#">detection: selection1: targetfilename|startswith: 'c:\users\' targetfilename|endswith: '\appdata\local\temp\osksupport.dll' selection2: image: 'c:\windows\system32\dllhost.exe' targetfilename: 'c:\program files\windows media player\osk.exe'
<li><a href="#">detection: selection1: targetobject|contains: '\services\hybridconnectionmanager' selection2: eventtype: setvalue details|contains: 'microsoft.hybridconnectionmanager.listener.exe'
<li><a href="#">detection: selection1: type: 'execve' a0: 'tcpdump' a1: '-c' a3|contains: '-i' selection2: type: 'execve' a0: 'tshark' a1: '-c' a3: '-i'
<li><a href="#">detection: selection1: type: 'execve' a0: 'zip' selection2: type: 'execve' a0: 'gzip' a1: '-f' selection3: type: 'execve' a0: 'tar' a1|contains: '-c'
<li><a href="#">detection: selection1_create: image|endswith: '\schtasks.exe' commandline|contains: ' /create ' selection1_all_folders: commandline|contains: - '%appdata%' - '\appdata\local\' - '\appdata\roaming\' - '%public%' - '\users\public' - 'c:\windows\temp' - 'c:\perflogs' selection2_parent: parentcommandline|endswith: '\svchost.exe -k netsvcs -p -s schedule' selection2_some_folders: commandline|contains: - '%public%' - '\users\public' - 'c:\windows\temp' - 'c:\perflogs' filter_mixed: - commandline|contains: 'update_task.xml' - parentcommandline|contains: 'unattended.ini'
<li><a href="#">detection: selection1_img: - image|endswith: - '\powershell.exe' - '\wmic.exe' - '\vssadmin.exe' - '\diskshadow.exe' - originalfilename: - 'powershell.exe' - 'wmic.exe' - 'vssadmin.exe' - 'diskshadow.exe' selection1_cli: commandline|contains|all: - shadow # will match "delete shadows" and "shadowcopy delete" and "shadowstorage" - delete selection2_img: - image|endswith: '\wbadmin.exe' - originalfilename: 'wbadmin.exe' selection2_cli: commandline|contains|all: - delete - catalog - quiet # will match -quiet or /quiet selection3_img: - image|endswith: '\vssadmin.exe' - originalfilename: 'vssadmin.exe' selection3_cli: commandline|contains|all: - resize - shadowstorage - unbounded
<li><a href="#">detection: selection10: eventid: 4898 templatecontent|contains: - '1.3.6.1.5.5.7.3.2' - '1.3.6.1.5.2.3.4' - '1.3.6.1.4.1.311.20.2.2' - '2.5.29.37.0' selection11: templatecontent|contains: 'ct_flag_enrollee_supplies_subject' selection20: eventid: 4899 newtemplatecontent|contains: - '1.3.6.1.5.5.7.3.2' - '1.3.6.1.5.2.3.4' - '1.3.6.1.4.1.311.20.2.2' - '2.5.29.37.0' selection21: newtemplatecontent|contains: 'ct_flag_enrollee_supplies_subject'
<li><a href="#">detection: selection1a: commandline|contains|all: - 'rundll32' - 'apphelp.dll' selection1b: commandline|contains: - 'shimflushcache' - '#250' selection2a: commandline|contains|all: - 'rundll32' - 'kernel32.dll' selection2b: commandline|contains: - 'baseflushappcompatcache' - '#46'
<li><a href="#">detection: selection1a: scriptblocktext|contains: - 'del' - 'remove-item' - 'rm' selection1b: scriptblocktext|contains: '(get-psreadlineoption).historysavepath' selection_2: scriptblocktext|contains|all: - 'set-psreadlineoption' - 'â€“historysavestyle' # not sure if the homoglyph â€“/- is intended, just checking for both - 'savenothing' selection_3: scriptblocktext|contains|all: - 'set-psreadlineoption' - '-historysavestyle' - 'savenothing'
<li><a href="#">detection: selection2: #eventid: 13 eventtype: setvalue targetobject|contains: '\microsoft\windows defender\exclusions'
<li><a href="#">detection: selection2: eventid: 4776 targetusername: '*' workstation: '*' timeframe: 24h
<li><a href="#">detection: selector: image: 'c:\windows\system32\rundll32.exe' dllload1: imageloaded|endswith: '\vaultcli.dll' dllload2: imageloaded|endswith: '\wlanapi.dll' exclusion: imageloaded: - 'ntdsapi.dll' - 'netapi32.dll' - 'imm32.dll' - 'samlib.dll' - 'combase.dll' - 'srvcli.dll' - 'shcore.dll' - 'ntasn1.dll' - 'cryptdll.dll' - 'logoncli.dll' timeframe: 30s
<li><a href="#">detection: service: provider_name: 'service control manager' eventid: - 7045 - 7036 selection: - servicename|contains: - 'wceservice' - 'wce service' - 'winexesvc' - 'dumpsvc' - 'pwdump' - 'gsecdump' - 'cachedump' - imagepath|contains: - 'bypass' #
<li><a href="#">detection: service_installation: provider_name: 'service control manager' eventid: 7045 servicename: 'psexesvc' imagepath|endswith: '\psexesvc.exe' service_execution: eventid: 7036 servicename: 'psexesvc'
<li><a href="#">detection: session_manager_base: eventtype: setvalue targetobject|contains: '\system\currentcontrolset\control\session manager' session_manager: targetobject|contains: - '\setupexecute' - '\s0initialcommand' - '\knowndlls' - '\execute' - '\bootexecute' - '\appcertdlls' filter: details: '(empty)'
<li><a href="#">detection: set: commandline|contains|all: - 'reg' - 'add' - 'hklm\software\policies\microsoft\fve' - '/v' - '/f' key: commandline|contains: - 'enablebdewithnotpm' - 'useadvancedstartup' - 'usetpm' - 'usetpmkey' - 'usetpmkeypin' - 'recoverykeymessagesource' - 'usetpmpin' - 'recoverykeymessage'
<li><a href="#">detection: sharpview: originalfilename: sharpview.exe sharpview_methods: commandline|contains: - get-domaingpouserlocalgroupmapping - find-gpolocation - get-domaingpocomputerlocalgroupmapping - find-gpocomputeradmin - get-domainobjectacl - get-objectacl - add-domainobjectacl - add-objectacl - remove-domainobjectacl - get-regloggedon - get-loggedonlocal - get-netrdpsession - test-adminaccess - invoke-checklocaladminaccess - get-wmiprocess - get-netprocess - get-wmiregproxy - get-proxy - get-wmireglastloggedon - get-lastloggedon - get-wmiregcachedrdpconnection - get-cachedrdpconnection - get-wmiregmounteddrive - get-registrymounteddrive - find-interestingdomainacl - invoke-aclscanner - get-netshare - get-netloggedon - get-netlocalgroup - get-netlocalgroupmember - get-netsession - get-pathacl - convertfrom-uacvalue - get-principalcontext - new-domaingroup - new-domainuser - add-domaingroupmember - set-domainuserpassword - invoke-kerberoast - export-powerviewcsv - find-localadminaccess - find-domainlocalgroupmember - find-domainshare - find-domainuserevent - find-domainprocess - find-domainuserlocation - find-interestingfile - find-interestingdomainsharefile - find-domainobjectpropertyoutlier - testmethod - get-domain - get-netdomain - get-domaincomputer - get-netcomputer - get-domaincontroller - get-netdomaincontroller - get-domainfileserver - get-netfileserver - convert-adname - get-domainobject - get-adobject - get-domainuser - get-netuser - get-domaingroup - get-netgroup - get-domaindfsshare - get-dfsshare - get-domaindnsrecord - get-dnsrecord - get-domaindnszone - get-dnszone - get-domainforeigngroupmember - find-foreigngroup - get-domainforeignuser - find-foreignuser - convertfrom-sid - convert-sidtoname - get-domaingroupmember - get-netgroupmember - get-domainmanagedsecuritygroup - find-managedsecuritygroups - get-domainou - get-netou - get-domainsid - get-forest - get-netforest - get-foresttrust - get-netforesttrust - get-domaintrust - get-netdomaintrust - get-forestdomain - get-netforestdomain - get-domainsite - get-netsite - get-domainsubnet - get-netsubnet - get-domaintrustmapping - invoke-mapdomaintrust - get-forestglobalcatalog - get-netforestcatalog - get-domainuserevent - get-userevent - get-domainguidmap - get-guidmap - resolve-ipaddress - get-ipaddress - convertto-sid - invoke-userimpersonation - invoke-reverttoself - get-domainspnticket - request-spnticket - get-netcomputersitename - get-sitename - get-domaingpo - get-netgpo - set-domainobject - set-adobject - add-remoteconnection - remove-remoteconnection - get-inicontent - get-gpttmpl - get-groupsxml - get-domainpolicydata - get-domainpolicy - get-domaingpolocalgroup - get-netgpogroup
<li><a href="#">detection: signedprocess: imageloaded|endswith: - '\dbghelp.dll' - '\dbgcore.dll' image|endswith: - '\msbuild.exe' - '\cmd.exe' # - '\svchost.exe' triggered by installing common software - '\rundll32.exe' # - '\powershell.exe' triggered by installing common software - '\word.exe' - '\excel.exe' - '\powerpnt.exe' - '\outlook.exe' - '\monitoringhost.exe' - '\wmic.exe' # - '\msiexec.exe' an installer installing a program using one of those dll will raise an alert - '\bash.exe' - '\wscript.exe' - '\cscript.exe' - '\mshta.exe' # - '\regsvr32.exe' triggered by installing common software - '\schtasks.exe' - '\dnx.exe' - '\regsvcs.exe' - '\sc.exe' - '\scriptrunner.exe' unsignedprocess: imageloaded|endswith: - '\dbghelp.dll' - '\dbgcore.dll' signed: 'false' filter1: - image|contains: 'visual studio' - commandline|contains: - '-k localsystemnetworkrestricted' - '-k unistacksvcgroup -s wpnuserservice' filter2: # not available in sysmon, but in aurora commandline: - 'c:\windows\winsxs\*\tiworker.exe -embedding' - 'c:\windows\system32\svchost.exe -k netsvcs -p -s wuauserv' - 'c:\windows\system32\svchost.exe -k wersvcgroup'
<li><a href="#">detection: spoolsv: parentimage|endswith: \spoolsv.exe integritylevel: system suspicious_unrestricted: image|endswith: - \gpupdate.exe - \whoami.exe - \nltest.exe - \taskkill.exe - \wmic.exe - \taskmgr.exe - \sc.exe - \findstr.exe - \curl.exe - \wget.exe - \certutil.exe - \bitsadmin.exe - \accesschk.exe - \wevtutil.exe - \bcdedit.exe - \fsutil.exe - \cipher.exe - \schtasks.exe - \write.exe - \wuauclt.exe suspicious_net: image|endswith: \net.exe suspicious_net_filter: commandline|contains: start suspicious_cmd: image|endswith: \cmd.exe suspicious_cmd_filter: commandline|contains: - .spl - route add - program files suspicious_netsh: image|endswith: \netsh.exe suspicious_netsh_filter: commandline|contains: - 'add portopening' - 'rule name' suspicious_powershell: image|endswith: \powershell.exe suspicious_powershell_filter: commandline|contains: .spl suspicious_rundll32: image|endswith: \rundll32.exe commandline|endswith: rundll32.exe
<li><a href="#">detection: susp_del_exe: commandline|contains|all: - 'del *.exe' - '/f ' - '/q ' susp_del_dll: commandline|contains|all: - 'del *.dll' - 'c:\programdata\'
<li><a href="#">detection: system_control_base: eventtype: setvalue targetobject|contains: '\system\currentcontrolset\control' system_control: targetobject|contains: - '\terminal server\winstations\rdp-tcp\initialprogram' - '\terminal server\wds\rdpwd\startupprograms' - '\securityproviders\securityproviders' - '\safeboot\alternateshell' - '\print\providers' - '\print\monitors' - '\networkprovider\order' - '\lsa\notification packages' - '\lsa\authentication packages' - '\bootverificationprogram\imagepath' filter_empty: details: '(empty)' filter_cutepdf: image: 'c:\windows\system32\spoolsv.exe' targetobject|contains: '\print\monitors\cutepdf writer monitor' details: - 'cpwmon64_v40.dll' - 'cutepdf writer'
<li><a href="#">detection: system_files: targetfilename|endswith: - 'wsmpty.xsl' - 'wsmtxt.xsl' in_system_folder: targetfilename|startswith: - 'c:\windows\system32\' - 'c:\windows\syswow64\'
<li><a href="#">detection: system_utility: image|startswith: - 'c:\windows\system32\' - 'c:\windows\syswow64\' parent_is_settingsynchost: parentcommandline|contains|all: - 'cmd.exe /c' - 'roamdiag.cmd' - '-outputpath'
<li><a href="#">detection: tamper_ps_action: hostapplication|contains: 'set-mppreference' tamper_ps_option: hostapplication|contains: - '-disablerealtimemonitoring 1' - '-disablebehaviormonitoring 1' - '-disablescriptscanning 1' - '-disableblockatfirstseen 1'
<li><a href="#">detection: tamper_registry: eventtype: setvalue targetobject: - 'hklm\software\policies\microsoft\windows defender\disableantispyware' - 'hklm\software\policies\microsoft\windows defender\disableantivirus' details: 'dword (0x00000001)' selection2: eventtype: setvalue targetobject: - 'hklm\system\currentcontrolset\services\windefend' - 'hklm\software\microsoft\windows defender' - 'hklm\software\policies\microsoft\windows defender' details: 'dword (0x00000001)'
<li><a href="#">detection: tamper_registry1: eventtype: setvalue targetobject: - 'hklm\software\policies\microsoft\windows defender\real-time protection\disablebehaviormonitoring' - 'hklm\software\policies\microsoft\windows defender\real-time protection\disableioavprotection' - 'hklm\software\policies\microsoft\windows defender\real-time protection\disableonaccessprotection' - 'hklm\software\policies\microsoft\windows defender\real-time protection\disablerealtimemonitoring' - 'hklm\software\policies\microsoft\windows defender\real-time protection\disablescanonrealtimeenable' - 'hklm\software\policies\microsoft\windows defender\spynet\disableblockatfirstseen' details: 'dword (0x00000001)' tamper_registry2: eventtype: setvalue targetobject: - 'hklm\software\policies\microsoft\windows defender\spynet\spynetreporting' - 'hklm\software\policies\microsoft\windows defender\spynet\submitsamplesconsent' details: 'dword (0x00000000)'
<li><a href="#">detection: target1: targetfilename|contains|all: - '\my documents\powershell\' - '\profile.ps1' target2: targetfilename|contains|all: - 'c:\windows\system32\windowspowershell\v1.0\' - '\profile.ps1'
<li><a href="#">detection: test_2: - payload|contains: get-adprincipalgroupmembership - contextinfo|contains: get-adprincipalgroupmembership test_7: - payload|contains|all: - get-aduser - '-f ' - '-pr ' - doesnotrequirepreauth - contextinfo|contains|all: - get-aduser - '-f ' - '-pr ' - doesnotrequirepreauth
<li><a href="#">detection: test_2: scriptblocktext|contains: get-adprincipalgroupmembership test_7: scriptblocktext|contains|all: - get-aduser - '-f ' - '-pr ' - doesnotrequirepreauth
<li><a href="#">detection: test_3: - payload|contains: - 'get-localgroup' - 'get-localgroupmember' - contextinfo|contains: - 'get-localgroup' - 'get-localgroupmember' test_6: - payload|contains|all: - 'get-wmiobject' - 'win32_group' - contextinfo|contains|all: - 'get-wmiobject' - 'win32_group'
<li><a href="#">detection: test_3: scriptblocktext|contains: - 'get-localgroup' - 'get-localgroupmember' test_6: scriptblocktext|contains|all: - 'get-wmiobject' - 'win32_group'
<li><a href="#">detection: to_dll: targetfilename|endswith: '.dll' filter_from_dll: - originalfilename|endswith: - '.dll' - '.tmp' # vscode fp - originalfilename|contains: - '.dll.' - '\squirreltemp\temp' filter_tiworker: image|startswith: 'c:\windows\winsxs\' image|endswith: '\tiworker.exe'
<li><a href="#">detection: tools: - 'scp ' - 'rsync ' - 'sftp ' filter: - '@' - ':'
<li><a href="#">detection: use_rpcping: image|endswith: '\rpcping.exe' remote_server: commandline|contains: - '-s' - '/s' ntlm_auth: - commandline|contains|all: - '-u' - 'ntlm' - commandline|contains|all: - '/u' - 'ntlm' - commandline|contains|all: - '-t' - 'ncacn_np' - commandline|contains|all: - '/t' - 'ncacn_np'
<li><a href="#">detection: wbadmin_exe: - image|endswith: \wbadmin.exe - commandline|contains: wbadmin wbadmin_cmd: commandline|contains|all: - 'delete ' - 'systemstatebackup ' - '-keepversions:0'
<li><a href="#">detection: webclient: contextinfo|contains: 'system.net.webclient' download: contextinfo|contains: - '.downloadfile(' - '.downloadstring('
<li><a href="#">detection: webclient: scriptblocktext|contains: 'system.net.webclient' download: scriptblocktext|contains: - '.downloadfile(' - '.downloadstring('
<li><a href="#">detection: where_exe: - image|endswith: '\where.exe' - originalfilename: 'where.exe' where_opt: commandline|contains: # firefox data - 'places.sqlite' - 'cookies.sqlite' - 'formhistory.sqlite' - 'logins.json' - 'key4.db' - 'key3.db' - 'sessionstore.jsonlz4' # chrome data - 'history' - 'bookmarks' - 'cookies' - 'login data'
<li><a href="#">detection: winsock_parameters_base: eventtype: setvalue targetobject|contains: '\system\currentcontrolset\services\winsock2\parameters' winsock_parameters: targetobject|contains: - '\protocol_catalog9\catalog_entries' - '\namespace_catalog5\catalog_entries' filter: - details: '(empty)' - image: 'c:\windows\system32\msiexec.exe' - image: 'c:\windows\syswow64\msiexec.exe'
<li><a href="#">detection: wmi_filter_to_consumer_binding: eventid: 5861 consumer_keywords: - 'activescripteventconsumer' - 'commandlineeventconsumer' - 'commandlinetemplate' # - 'binding eventfilter' # too many false positive with hp health driver wmi_filter_registration: eventid: 5859 filter_scmevent: provider: 'scm event provider' query: 'select * from msft_scmeventlogevent' user: 's-1-5-32-544' possiblecause: 'permanent'
<li><a href="#">detection: wow_classes_base: eventtype: setvalue targetobject|contains: '\software\wow6432node\classes' wow_classes: targetobject|contains: - '\folder\shellex\extshellfolderviews' - '\folder\shellex\dragdrophandlers' - '\folder\shellex\columnhandlers' - '\directory\shellex\dragdrophandlers' - '\directory\shellex\copyhookhandlers' - '\clsid\{ac757296-3522-4e11-9862-c17be5a1767e}\instance' - '\clsid\{abe3b9a4-257d-4b97-bd1a-294af496222e}\instance' - '\clsid\{7ed96837-96f0-4812-b211-f13c24117ed3}\instance' - '\clsid\{083863f1-70de-11d0-bd40-00a0c911ce86}\instance' - '\allfilesystemobjects\shellex\dragdrophandlers' - '\shellex\propertysheethandlers' - '\shellex\contextmenuhandlers' filter: details: '(empty)'
<li><a href="#">detection: wow_current_version_base: eventtype: setvalue targetobject|contains: '\software\wow6432node\microsoft\windows\currentversion' wow_current_version: targetobject|contains: - '\shellserviceobjectdelayload' - '\run\' - '\runonce\' - '\explorer\shellserviceobjects' - '\explorer\shelliconoverlayidentifiers' - '\explorer\shellexecutehooks' - '\explorer\sharedtaskscheduler' - '\explorer\browser helper objects' filter_empty: details: '(empty)' filter_edge: image|contains|all: - 'c:\program files (x86)\microsoft\edgeupdate\install\{' - '\setup.exe' filter_msoffice1: image: 'c:\program files\common files\microsoft shared\clicktorun\officeclicktorun.exe' targetobject|contains: '\office\clicktorun\registry\machine\software\wow6432node\' filter_msoffice2: image: - 'c:\program files\microsoft office\root\integration\integrator.exe' - 'c:\program files (x86)\microsoft office\root\integration\integrator.exe' targetobject|contains: '\explorer\browser helper objects\{31d09ba0-12f5-4cce-be8a-2923e76605da}\' filter_dropbox: - details|endswith: '-a251-47b7-93e1-cdd82e34af8b}' - details: 'grpconv -o' - details|contains|all: - 'c:\program files' - '\dropbox\client\dropbox.exe' - ' /systemstartup' filter_evernote: targetobject|endswith: '\explorer\browser helper objects\{92ef2ead-a7ce-4424-b0db-499cf856608e}\noexplorer' filter_dotnet: image|contains: '\windowsdesktop-runtime-' targetobject|endswith: - '\wow6432node\microsoft\windows\currentversion\runonce\{e2d1ae32-dd1d-4ad7-a298-10e42e7840fc}' - '\wow6432node\microsoft\windows\currentversion\runonce\{7037b699-7382-448c-89a7-4765961d2537}' details|startswith: - '"c:\programdata\package cache\{7037b699-7382-448c-89a7-4765961d2537}\windowsdesktop-runtime-' - '"c:\programdata\package cache\{e2d1ae32-dd1d-4ad7-a298-10e42e7840fc}\windowsdesktop-runtime-' details|endswith: '.exe" /burn.runonce' filter_office: image|startswith: - 'c:\program files\common files\microsoft shared\clicktorun\' - 'c:\program files\common files\microsoft shared\clicktorun\updates\' image|endswith: '\officeclicktorun.exe' filter_ms_win_desktop_runtime: details|startswith: '"c:\programdata\package cache\{d21a4f20-968a-4b0c-bf04-a38da5f06e41}\windowsdesktop-runtime-'
<li><a href="#">detection: wow_nt_current_version_base: eventtype: setvalue targetobject|contains: '\software\wow6432node\microsoft\windows nt\currentversion' wow_nt_current_version: targetobject|contains: - '\windows\appinit_dlls' - '\image file execution options' - '\drivers32' filter: details: - '(empty)' - '\registry\machine\software\microsoft\windows nt\currentversion\image file execution options'
<li><a href="#">detection: xwd: type: execve a0: xwd xwd_root_window: a1: '-root' a2: '-out' a3|endswith: '.xwd' xwd_no_root_window: a1: '-out' a2|endswith: '.xwd'
<li><a href="#">detection: z_flag_unset: z: '0' most_probable_valid_domain: query|contains: '.' exclude_tlds: query|endswith: - '.arpa' - '.local' - '.ultradns.net' - '.twtrdns.net' - '.azuredns-prd.info' - '.azure-dns.com' - '.azuredns-ff.info' - '.azuredns-ff.org' - '.azuregov-dns.org' exclude_query_types: qtype_name: - 'ns' - 'ns' - 'mx' - 'mx' exclude_responses: answers|endswith: '\\x00' exclude_netbios: id.resp_p: - '137' - '138' - '139'
<li><a href="#">events: $event.metadata.product_log_id = "5829"
<li><a href="#">events: $selection.metadata.product_event_type = "4720"
<li><a href="#">events: $selection.metadata.product_event_type = "5136"
<li><a href="#">events: ($dllload.metadata.product_event_type = "7" and re.regex($dllload.target.process.file.full_path, `.*\\mstsc\.exe`) and re.regex($dllload.target.process.file.full_path, `.*\\mstscax\.dll`))
<li><a href="#">events: ($port_53.target.port = "53" and not ((re.regex($port_53.src.application, `.*firefox/.*`) or re.regex($port_53.src.application, `.*chrome/.*`) or re.regex($port_53.src.application, `.*crisos/.*`) or re.regex($port_53.src.application, `.*opr/.*`) or re.regex($port_53.src.application, `.*safari/.*`) or re.regex($port_53.src.application, `.*trident/.*`))))
<li><a href="#">events: ($selection.metadata.event_type = "setvalue" and re.regex($selection.target.registry.registry_key, `.*currentcontrolset\\services\\iphlpsvc6\\imagepath`))
<li><a href="#">events: ($selection.metadata.event_type = "syscall" and (re.regex($selection.target.process.file.full_path, `/tmp/.*`) or re.regex($selection.target.process.file.full_path, `/var/www/.*`) or re.regex($selection.target.process.file.full_path, `/usr/local/apache2/.*`) or re.regex($selection.target.process.file.full_path, `/usr/local/httpd/.*`) or re.regex($selection.target.process.file.full_path, `/var/apache/.*`) or re.regex($selection.target.process.file.full_path, `/srv/www/.*`) or re.regex($selection.target.process.file.full_path, `/home/httpd/html/.*`) or re.regex($selection.target.process.file.full_path, `/var/lib/pgsql/data/.*`) or re.regex($selection.target.process.file.full_path, `/usr/local/mysql/data/.*`) or re.regex($selection.target.process.file.full_path, `/var/lib/mysql/.*`) or re.regex($selection.target.process.file.full_path, `/var/vsftpd/.*`) or re.regex($selection.target.process.file.full_path, `/etc/bind/.*`) or re.regex($selection.target.process.file.full_path, `/var/named/.*`) or re.regex($selection.target.process.file.full_path, `.*/public_html/.*`)))
<li><a href="#">events: ($selection.metadata.product_event_type = "1" and $selection.target.file.md5 = "76a64fd17cd1e7c59b8bde7aa9209854")
<li><a href="#">events: ($selection.metadata.product_event_type = "1" and $selection.target.process.command_line = "whoami")
<li><a href="#">events: ($selection.metadata.product_event_type = "1" and $selection.target.process.command_line = "winrm/config/listener" and re.regex($selection.target.process.file.full_path, `.*\\cscript\.exe`))
<li><a href="#">events: ($selection.metadata.product_event_type = "1" and $selection.target.process.file.full_path = "bcdedit.exe" and re.regex($selection.target.process.command_line, `.*off`))
<li><a href="#">events: ($selection.metadata.product_event_type = "1" and $selection.target.process.file.full_path = "net.exe" and re.regex($selection.target.process.command_line, `.*ipc$.*`))
<li><a href="#">events: ($selection.metadata.product_event_type = "1" and $selection.target.process.file.full_path = "powershell.exe" and (re.regex($selection.target.process.command_line, `.*downloadfile.*`) or re.regex($selection.target.process.command_line, `.*invoke-webrequest.*`) or re.regex($selection.target.process.command_line, `.*iwr`)))
<li><a href="#">events: ($selection.metadata.product_event_type = "1" and $selection.target.process.file.full_path = "schtask.exe")
<li><a href="#">events: ($selection.metadata.product_event_type = "1" and ($selection.metadata.description = "7.31" or $selection.metadata.description = "7.4" or $selection.metadata.description = "7.3" or $selection.metadata.description = "7.5") and $selection.metadata.product_name = "sap netweaver")
<li><a href="#">events: ($selection.metadata.product_event_type = "1" and ($selection.src.process.file.full_path = "excel.exe" or $selection.src.process.file.full_path = "msaccess.exe" or $selection.src.process.file.full_path = "outlook.exe" or $selection.src.process.file.full_path = "powerpnt.exe" or $selection.src.process.file.full_path = "winword.exe") and ($selection.target.process.file.full_path = "powershell.exe" or $selection.target.process.file.full_path = "cmd.exe"))
<li><a href="#">events: ($selection.metadata.product_event_type = "1" and ($selection.target.file.md5 = "00df326eee18617fae2fdd3684ac1546" or $selection.target.file.md5 = "1488cdc5c5c9c87b4e0dae27ba3511cb" or $selection.target.file.md5 = "4543daa6936dde54dda8782b89d5daf1" or $selection.target.file.md5 = "80b1f909d1217313c14ea6d4d0b003dc" or $selection.target.file.md5 = "81c153256efd9161f4d89fe5fd7015bc" or $selection.target.file.md5 = "c6b53fc46427527a0739e6b6443ef72d" or $selection.target.file.md5 = "9e273220eb71f849ea99b923cbc1fae3" or $selection.target.file.md5 = "43309710ab8f87dc5d9842a5bca85f80" or $selection.target.file.md5 = "a40faab2f3f546aeb29aaefcb0f751d8" or $selection.target.file.md5 = "617a128b44671ac88df0b7180d9d0135" or $selection.target.file.md5 = "ae5c8ad09954a56f348a3b72ed824363" or $selection.target.file.md5 = "da3e2eeffd78d8c5ef472b8a09e9d325" or $selection.target.file.md5 = "0de41aef336f40a07ed6984db61b52ab" or $selection.target.file.md5 = "e081a42d6e09a3fcf049a33b2ecf0412" or $selection.target.file.md5 = "361c9d44809f788b92023b762e363449" or $selection.target.file.md5 = "c46a631f0bc82d8c2d46e9d8634cc50242987fa7749cac097439298d1d0c1d6e" or $selection.target.file.md5 = "25bc108a683d25a77efcac89b45f0478d9ddd281a9a2fb1f55fc6992a93aa830" or $selection.target.file.md5 = "b957911d7d5865e91851ab402189ae86" or $selection.target.file.md5 = "0ab40f5c7d9151742ec29d53fb224ad8"))
<li><a href="#">events: ($selection.metadata.product_event_type = "1" and ($selection.target.file.md5 = "028ebdbebac7239b41a1f4ce8d2cc61b1e09983b" or $selection.target.file.md5 = "07e1af6d3f7b42d2e26df12a217debacedb8b1b9" or $selection.target.file.md5 = "09457acb28c754aa419ab6a7e8b1940201ef3ffe" or $selection.target.file.md5 = "0eee92ec2723ed9623f84082dad962778f4cf776" or $selection.target.file.md5 = "10128ab8770fbdecd81b8894208a760a3c266d78" or $selection.target.file.md5 = "131f99a2e18a358b60f09fd61ee312e74b02c07c" or $selection.target.file.md5 = "14f69c7bfaf1df16e755ccf754017089238b0e7b" or $selection.target.file.md5 = "1509f85de302be83a47d5afad9bee2542ba317fc" or $selection.target.file.md5 = "170cee6523b6620124f52201d943d7d9ca7b95e5" or $selection.target.file.md5 = "191159f855a0e580290871c945245e3597a5f25c" or $selection.target.file.md5 = "1f12c32a41d82e978de333cd4e93fdaa1396be94" or $selection.target.file.md5 = "22b17966b597568db46b94b253cd37cbcf561321" or $selection.target.file.md5 = "2c7332d8247376842bd1b1bd5298844307649c99" or $selection.target.file.md5 = "2e08ba5df30c0718c1733a7836b5f4d98d84905e" or $selection.target.file.md5 = "2edf808f8252a4cbcb92f47a0aedc1aaae79a777" or $selection.target.file.md5 = "360f54b33ac960ee29ca0557a28f6bb8417ef409" or $selection.target.file.md5 = "431fce6a47d0a48a57f699aa084c9ff175a9d15f" or $selection.target.file.md5 = "45438834fdc5c690da3bc1f60722be86b871280d" or $selection.target.file.md5 = "4a8a8188e3a7a137651b24780df37cb6f610cc19" or $selection.target.file.md5 = "4c1e4e136b7922f9e28d1b38e9760e28929e4f0b" or $selection.target.file.md5 = "5b6ea57ffc09593c3b65d903368ea5f7faa2eb68" or $selection.target.file.md5 = "61d366939fe36861b2fecb38a4dff6d86c925a00" or $selection.target.file.md5 = "6a72366d8ae09f72f0466fb59e8ed372f8b460d7" or $selection.target.file.md5 = "6feca622b0fb282064f7de42ba472a8ec908d0d6" or $selection.target.file.md5 = "70a772485c5ed330c6876fa901ba722cd44ca05e" or $selection.target.file.md5 = "70d97367a3dbd5d45482b6af8c78c58b64d3f3b3" or $selection.target.file.md5 = "7803fd9753930522705f2b6b4e73622887892c28" or $selection.target.file.md5 = "7b11a84b18dc4b5f1f2826e7925f0b2dc1b936ae" or $selection.target.file.md5 = "889fd0beb3197ddd6c88f5c40d6b8e4d74a892ce" or $selection.target.file.md5 = "9b6fbabfa2a77fa633f7a2eb352979d5c68cebc6" or $selection.target.file.md5 = "a451291f17489e3a59f440a1b693d691b053c531" or $selection.target.file.md5 = "a53d77e55a06cf131d670339bacec5ac0f0c6d66" or $selection.target.file.md5 = "a925d0afb5d4f5fac65543c993be4172f1dbf329" or $selection.target.file.md5 = "b5f81c804e47b76c74c38df03a5cbe8a4fe69a9a" or $selection.target.file.md5 = "b99de55043099e9506b304660b8e1374787ab195" or $selection.target.file.md5 = "c00c104fc3e9f5977d11c67ef0c8c671d4dfc412" or $selection.target.file.md5 = "ca0296fa9f48e83ea3f26988401b3f4c4e655f7a" or $selection.target.file.md5 = "d4c6540e789bd3839d65e7eda5cca8832493649e" or $selection.target.file.md5 = "d5ede1bbb9a12757e24be283afc8d746adc4a0d4" or $selection.target.file.md5 = "defbfd98c74beff839eeb189f0f6c385ad6ba19b" or $selection.target.file.md5 = "ecf152eb6417a069573f2c7d9a35b9cc31ec8f56" or $selection.target.file.md5 = "ee2d40825c77c8dfef67999f0c521919e6672a10" or $selection.target.file.md5 = "ef09ac6ba08a116f2c4080cbee8cef9523e21265" or $selection.target.file.md5 = "f414c49cf502d1b6cc46e08f3ac97d7846b30732"))
<li><a href="#">events: ($selection.metadata.product_event_type = "1" and ($selection.target.file.md5 = "049fc01447f15e02fff88a2b10f1518c8489e97b2c26006b4962ff5005e460dc" or $selection.target.file.md5 = "22f105dc2e2574ba3ea2ac4152391ce3bbaaa415a9660c251638281bbc5e8f33" or $selection.target.file.md5 = "2628242abba9b99baf26dadc071739fed2559bb7251d69ab81edc404d4bae602" or $selection.target.file.md5 = "27c5e2f35a5fb9272c3ed7c746927ce8c61b3ce02fed7551129dc2a32bf20773" or $selection.target.file.md5 = "27d4684511314ef9631e162e1bdc5170185689abf16f7f28ba5ae397ba601197" or $selection.target.file.md5 = "38d7d4f6a712bff4ab212848802f5f9c" or $selection.target.file.md5 = "5d33434111ee36d754155c1d236e65aa78eaa605587715a5931b1c1ed3a54745" or $selection.target.file.md5 = "5ea00496a4073982855f81e463a887d6a8ef263c87bb203161e2db3f50cfc8c0" or $selection.target.file.md5 = "65cd6ab10712cfeb82872d6d3648a99636c9e0fff5728a0fc34497142c952173" or $selection.target.file.md5 = "673bb55f781aaef382f4f9c9a748690d8b1045864151adaf67a4c0ab669e4700" or $selection.target.file.md5 = "6de21f2fd11d68b305b5e10d97b3f27e" or $selection.target.file.md5 = "7327ef046fe62a26e5571c36b5c2c417" or $selection.target.file.md5 = "785a7f6e1cd40b50ad788e5d7d3c8465" or $selection.target.file.md5 = "79c6ead6fa4f4addd7f2f019716dd6ca" or $selection.target.file.md5 = "7bb89b498beab4402d5cc8602c484a309ece50aa94c14f0a43f091f43b09f88f" or $selection.target.file.md5 = "7bc7d0fafd40438989c0445db8b3886868847da88979e35feebea9ff1b0655cb" or $selection.target.file.md5 = "842133ddc2d57fd0f78491b7ba39a34d" or $selection.target.file.md5 = "865cea806bc95acd56d215b2c3c3b892d9715495bdcf272b2bf2106326c13a30" or $selection.target.file.md5 = "876c2c8a45414c143e2fc5622d6cfe84050a45ae052ca9263beab280778ae380" or $selection.target.file.md5 = "8b532b41c25958f04495ca43d1f2a57f6d11fd3d6401f8d971e1299683828e52" or $selection.target.file.md5 = "91ebe2de7fcb922c794a891ff8987124" or $selection.target.file.md5 = "9a46a3ae2c3762964c5cbb63b62d7dee" or $selection.target.file.md5 = "a178196089fadecf8314e36fab17884f6894bdddd6e238652f99909a93db93a2" or $selection.target.file.md5 = "a3ae8a77a1f238e7b5ebd3dd3953912d9e5ae8fdf5cee6a536e7eba658ee2e1e" or $selection.target.file.md5 = "bb0a0a06f3bff97a1e7de8909d26c0ecb5161ea3882f587163d422042d9196a5" or $selection.target.file.md5 = "cc4a5ed98d8f4074ee700f5762ee0745f365605b90c62746990566413a7bf63e" or $selection.target.file.md5 = "dfc0ea5813e78492bc78d134d1d8372ca9d04ad563835d890614cd11b2555dd3" or $selection.target.file.md5 = "f1e23e2428f0f162c05bd259be133a1957438901a10041c128c3f63b72dd91d6" or $selection.target.file.md5 = "fd2c2cf66b166807470cbe2eafb3e0fab5947937f243fca87651d04bb6c9fd2d"))
<li><a href="#">events: ($selection.metadata.product_event_type = "1" and ($selection.target.file.md5 = "050eb7d20ee8ef1e1daee2f421e5bf648fb645df" or $selection.target.file.md5 = "069a919b3bc8070bb2d71d3e1ad9f7642d8ecf0f" or $selection.target.file.md5 = "0d265e0bda9df83815759abca64938ec0ff65733" or $selection.target.file.md5 = "0d7df910d0fb7b100f084bfb8dfa0a9f2371171a" or $selection.target.file.md5 = "2ff3f5da2960be95e50b751680f450896ad1ed67" or $selection.target.file.md5 = "3200ecc7503f184f72ab9da1dc3e1f8d43ddfd48" or $selection.target.file.md5 = "46d256ef277328e803d2b15ca7c188267059949d" or $selection.target.file.md5 = "524ee1b7269d02f725e55254a015200bb472463a" or $selection.target.file.md5 = "53a0efd3d448da8e32cfdda5848312d3cf802b06" or $selection.target.file.md5 = "6fc150a9cafa75813e7473c687935e7e4a5dce24" or $selection.target.file.md5 = "70559245303f99630a27cb47b328c20c9666f0bb" or $selection.target.file.md5 = "7d8044a5cbefe3b016f2132a5750c30bb647e599" or $selection.target.file.md5 = "8fd919d531a7a80615517e1ac13c2d0f050af20d" or $selection.target.file.md5 = "9d22421da9696b535c708178c72323f64d31fc80" or $selection.target.file.md5 = "bfd2dfa3d6af31df4b9cc2f6b31b239adf1ceca1" or $selection.target.file.md5 = "c08a6222b59a187f3cf27a7bae4cacfacc97ddee" or $selection.target.file.md5 = "c2f6a65e14605828880927b9ba3c386507bd8161" or $selection.target.file.md5 = "c562006d2fa53b15052a4b80c94b86355cca7427" or $selection.target.file.md5 = "cb43058d9ebb517832df7058641aedf6b303e736" or $selection.target.file.md5 = "cc8a9c28e884fda0e1b3f6ceab12805fea17d3c1" or $selection.target.file.md5 = "d3cc27ca772e30c6260c5a3b6309d27f08a295cd" or $selection.target.file.md5 = "e7a2de3776ba7d939711e620c7d6ab25946c9881" or $selection.target.file.md5 = "ee6efa7a6a85a1b2fa6351787a1612f060086320" or $selection.target.file.md5 = "ef0abb3a0cd1e65b33c0f109dd18f156fc0f0cde" or $selection.target.file.md5 = "f63be193c8a0fbb430f3b88cc8194d755bad9cd1"))
<li><a href="#">events: ($selection.metadata.product_event_type = "1" and ($selection.target.file.md5 = "0a4915b81d9a9acf4e19181deeebbe244430c16b" or $selection.target.file.md5 = "323160c88a254127d9adb2848ae044afff376a4d" or $selection.target.file.md5 = "395166835495b418773c9690227779d592f94f71" or $selection.target.file.md5 = "3ee410dd50fc64f39dff0c4ee8cc676f0f7d5a74" or $selection.target.file.md5 = "5b665152f6596d4412267f9c490878455ba235f9" or $selection.target.file.md5 = "5fe8558eb8a3c244be2da8be750221b9a9ee8539" or $selection.target.file.md5 = "61cb5e535f0ac90a1f904ec9937298f50e2b4974" or $selection.target.file.md5 = "6a1cd05f07b1024287cea400237e1ea9d2fe1678" or $selection.target.file.md5 = "7676aff05a3550e5bbff78cf4d10c9e094447d72" or $selection.target.file.md5 = "86165f464ec1912a43445d80559d65c165e2cf76" or $selection.target.file.md5 = "ab3cd05be6b0ba8567b84d10ede28abf87e115ac" or $selection.target.file.md5 = "bfd7158e1c2f6ba525e24f85ed8ccf8ef40fd370" or $selection.target.file.md5 = "cfebefc92dcdf1687fd0bc1b50457ebdea8672a2" or $selection.target.file.md5 = "d21b8514990b0ceac5eae687deaa60b447139b9d"))
<li><a href="#">events: ($selection.metadata.product_event_type = "1" and ($selection.target.file.md5 = "10ac312c8dd02e417dd24d53c99525c29d74dcbc84730351ad7a4e0a4b1a0eba" or $selection.target.file.md5 = "3a5ba44f140821849de2d82d5a137c3bb5a736130dddb86b296d94e6b421594c" or $selection.target.file.md5 = "4a740227eeb82c20286d9c112ef95f0c1380d0e90ffb39fc75c8456db4f60756" or $selection.target.file.md5 = "820ca1903a30516263d630c7c08f2b95f7b65dffceb21129c51c9e21cf9551c6" or $selection.target.file.md5 = "a9bc09a17d55fc790568ac864e3885434a43c33834551e027adb1896a463aafc" or $selection.target.file.md5 = "ab88f12f0a30b4601dc26dbae57646efb77d5c6382fb25522c529437e5428629" or $selection.target.file.md5 = "ca9ab48d293cc84092e8db8f0ca99cb155b30c61d32a1da7cd3687de454fe86c" or $selection.target.file.md5 = "d465637518024262c063f4a82d799a4e40ff3381014972f24ea18bc23c3b27ee" or $selection.target.file.md5 = "e03dc5f1447f243cf1f305c58d95000ef4e7dbcc5c4e91154daa5acd83fea9a8" or $selection.target.file.md5 = "f3e521996c85c0cdb2bfb3a0fd91eb03e25ba6feef2ba3a1da844f1b17278dd2" or $selection.target.file.md5 = "1f2cd2bc23556fb84a51467fedb89cbde7a5883f49e3cfd75a241a6f08a42d6d" or $selection.target.file.md5 = "9ddacbcd0700dc4b9babcd09ac1cebe23a0035099cb612e6c85ff4dffd087a26"))
<li><a href="#">events: ($selection.metadata.product_event_type = "1" and ($selection.target.file.md5 = "21921864d2f1ab2761c36031a2e1d2c00c9b304a" or $selection.target.file.md5 = "3c2d0615bef6f88fed6e308d4f45b6133080c74f" or $selection.target.file.md5 = "91e8346910e0e6783acfc4f2b9a745c81bd7573a"))
<li><a href="#">events: ($selection.metadata.product_event_type = "1" and ($selection.target.file.md5 = "2a5c9d4dae5e53b2962fbe2b7fa8798a127bc9a6" or $selection.target.file.md5 = "9b1586766af9885ef960f05f8606d1230b36ac15" or $selection.target.file.md5 = "a2f0d5af81d93752cff1cf1e8bb9e6caee6d1b5e" or $selection.target.file.md5 = "ce18467b33161e39c36fc6c5b52f68d49abcfc2a"))
<li><a href="#">events: ($selection.metadata.product_event_type = "1" and ($selection.target.file.md5 = "2fdc22d8926db1b04dc3d62ff6da72236cb1c052b23553b644c7f18ea8496d8a" or $selection.target.file.md5 = "6bfa353f905c0fc5ded87e7f35dc939e7b757ea3f2f8372f81f0ac40edadd619" or $selection.target.file.md5 = "3f5240c924074995651c4ccac15ddfd0070beff93625dcea9db118ab32bad61d" or $selection.target.file.md5 = "3cfd8919f095e048e0f24a41c2f132328f0d0efe19581b308d9d2d3ffad40c29" or $selection.target.file.md5 = "36baccd2a4fc4f683c839283123a75de61b01ce93205f4a34975263e9c66aaed" or $selection.target.file.md5 = "42d0990daba69fa5068a6910d0eac487f3d308ce7e28799a959dace8d84125d7" or $selection.target.file.md5 = "d214c89af1929af1171ac40999b14a4f6fbcfd13b88cade392853a2c61057122" or $selection.target.file.md5 = "c7ef89222d760fc915690e6394c61c84176e618f7c9508beca30aa9a0f1b1991" or $selection.target.file.md5 = "2c79954335b579309957c22b1b7976359fd067691626f8beb99779143edaa69" or $selection.target.file.md5 = "82d4b6676bbff17626aba1a65a9c6ec10ab036c101c8dc5e6e697693ec5a013f" or $selection.target.file.md5 = "5c46fb082a683144092793529a0d10b6"))
<li><a href="#">events: ($selection.metadata.product_event_type = "1" and ($selection.target.file.md5 = "3340013b0f00fe0c9e99411f722f8f3f0baf9ae4f40ac78796a6d4d694b46d7b" or $selection.target.file.md5 = "0c3ef20ede53efbe5eebca50171a589731a17037147102838bdb4a41c33f94e5" or $selection.target.file.md5 = "3340013b0f00fe0c9e99411f722f8f3f0baf9ae4f40ac78796a6d4d694b46d7b" or $selection.target.file.md5 = "0c3ef20ede53efbe5eebca50171a589731a17037147102838bdb4a41c33f94e5" or $selection.target.file.md5 = "52c47a529e4ddd0778dde84b7f54e1aea326d9f8eeb4ba4961a87835a3d29866" or $selection.target.file.md5 = "b0542a719c6b2fc575915e9e4c58920cf999ba5c3f5345617818a9dc14a378b4" or $selection.target.file.md5 = "dadd0ec8806d506137889d7f1595b3b5447c1ea30159432b1952fa9551ecfba5" or $selection.target.file.md5 = "c88eab30fa03c44b567bcb4e659a60ee0fe5d98664816c70e3b6e8d79169cbea" or $selection.target.file.md5 = "2264c2f2c2d5a0d6d62c33cadb848305a8fff81cdd79c4d7560021cfb304a121" or $selection.target.file.md5 = "3c68facf01aede7bcd8c2aea853324a2e6a0ec8b026d95c7f50a46d77334c2d2" or $selection.target.file.md5 = "a146f84a0179124d96a707f192f4c06c07690e745cffaef521fcda9633766a44" or $selection.target.file.md5 = "abc35bb943462312437f0c4275b012e8ec03899ab86d353143d92cbefedd7f9d" or $selection.target.file.md5 = "908f2dfed6c122b46e946fe8839feb9218cb095f180f86c43659448e2f709fc7" or $selection.target.file.md5 = "3491bc6df27858257db26b913da8c35c83a0e48cf80de701a45a30a30544706d"))
<li><a href="#">events: ($selection.metadata.product_event_type = "1" and ($selection.target.file.md5 = "4211e091dfb33523d675d273bdc109ddecf4ee1c1f5f29e8c82b9d0344dbb6a1" or $selection.target.file.md5 = "e8a765ec824881e1e78defd7c011da735f3e3b954aaf93a4282b6455a1b9afcc" or $selection.target.file.md5 = "702e5cc9462e464c8c29c832fe0d1ecd5cd7740cc2cbceecfd70e566da8194a1"))
<li><a href="#">events: ($selection.metadata.product_event_type = "1" and ($selection.target.file.md5 = "7768fd2812ceff05db8f969a7bed1de5615bfc5a" or $selection.target.file.md5 = "da70c54a8b9fd236793bb2ab3f8a50e6cd37e2df" or $selection.target.file.md5 = "a225d457c3396e647ffc710cd1edd4c74dc57152" or $selection.target.file.md5 = "a659a765536d2099ecbde988d6763028ff92752e" or $selection.target.file.md5 = "20954fe36388ae8b1174424c8e4996ea2689f747" or $selection.target.file.md5 = "e0d8829d2e76e9bb02e3b375981181ae02462c43" or $selection.target.file.md5 = "d697160aecf152a81a89a6b5a7d9e1b8b5e121724038c676157ac72f20364edc" or $selection.target.file.md5 = "cba5ab65a24be52214736bc1a5bc984953a9c15d0a3826d5b15e94036e5497df" or $selection.target.file.md5 = "25f0d1cbcc53d8cfd6d848e12895ce376fbbfaf279be591774b28f70852a4fd8" or $selection.target.file.md5 = "115fd8c619fa173622c7a1e84efdf6fed08a25d3ca3095404dcbd5ac3deb1f03" or $selection.target.file.md5 = "f27836430742c9e014e1b080d89c47e43db299c2e00d0c0801a2830b41b57bc1" or $selection.target.file.md5 = "5b5e80f63c04402d0b282e95e32155b2f86cf604a6837853ab467111d4ac15e2" or $selection.target.file.md5 = "dd7e69e14c88972ac173132b90b3f4bfb2d1faec15cca256a256dd3a12b6e75d" or $selection.target.file.md5 = "15a866c3c18046022a810aa97eaf2e20f942b8293b9cb6b4d5fb7746242c25b7" or $selection.target.file.md5 = "602d2901d55c2720f955503456ac2f68" or $selection.target.file.md5 = "47a026d93ae8e0cc292e8d7a71ddc89e" or $selection.target.file.md5 = "26b213343bac2b4c69a261a2f5c00e89" or $selection.target.file.md5 = "672f85ee2031c1ff6295b17058e30e07" or $selection.target.file.md5 = "e49728cee1fdbbb957f657361fba3c9f" or $selection.target.file.md5 = "02c46f30f4c68a442cf7e13bebe8d3f8" or $selection.target.file.md5 = "6bc5f53d4082f12dd83aca45bae81e64"))
<li><a href="#">events: ($selection.metadata.product_event_type = "1" and ($selection.target.file.md5 = "9206f08916ab6f9708d81a6cf2f916e2f606fd048a6b2355a39db97e258d0883" or $selection.target.file.md5 = "06c637ac62cab511c5c42e142855ba0447a1c8ac8ee4b0f1f8b00faa5310fe9f" or $selection.target.file.md5 = "609b0a416f9b16a6df9b967dc32cd739402af31566e019a8fb8abdf3cb573e30"))
<li><a href="#">events: ($selection.metadata.product_event_type = "1" and ($selection.target.file.md5 = "b4576437f4b06d438a03a9f8f0776cde" or $selection.target.file.md5 = "a0763d3332bb87595ed6303ab3cdb8fff7dd1e976ee161003a62316fea332941"))
<li><a href="#">events: ($selection.metadata.product_event_type = "1" and ($selection.target.file.md5 = "dea32433519c4628deeac802c0f1435a1b0d27d89f1ae5c1729ec7223f9eb04d" or $selection.target.file.md5 = "147d572d7f6664c8adf42ef92e4dbad06c5d21cc820a20163d814c77136cfbab" or $selection.target.file.md5 = "122b7906a359deb22bf777c602ac2619ca5ea156c4937dcdf96583210677db52" or $selection.target.file.md5 = "c5894d2afc946c064f8c2b58791fe64b48e26f0da5bdcc6ef9ba147f334f43f9" or $selection.target.file.md5 = "e61fbe58c28720ac4c0a1822d5da9a622a24f352d34e6c1cf5f704dbdd9b9b34" or $selection.target.file.md5 = "2b54329a13c4f79bea3886a21a7ba5fe19c4418596b774893fdef020e03ed07d" or $selection.target.file.md5 = "f128a63c107c3006ebf448d6ec743d11eb491ecb508e4ce63ba084f9792c25da" or $selection.target.file.md5 = "7357bdf70d042f246de1f830de783499d75e61388eed93d9ce74180ce06524d0" or $selection.target.file.md5 = "956a1231726503d840794af61fb6ac9bc326296597eff1c8da636f84e3c32874" or $selection.target.file.md5 = "8fa8cdb771d7c66406a7116e9c09ed18030afb1f94430c807782274f3847cb92" or $selection.target.file.md5 = "a3598d3301630ba64aa7663980296b59df243f5f17ed1b4fd56dcbcab599231c"))
<li><a href="#">events: ($selection.metadata.product_event_type = "1" and ($selection.target.process.command_line = "net group \"domain admins\" /domain" or $selection.target.process.command_line = "net localgroup administrators"))
<li><a href="#">events: ($selection.metadata.product_event_type = "1" and (($selection.target.process.command_line = "c:\\windows\\system32\\windowspowershell\\v1.0\\powershell.exe set-mppreference -disablebehaviormonitoring $true ; set-mppreference -mapsreporting 0 ; set-mppreference -exclusionprocess rundll32.exe ; set-mppreference -exclusionextension dll" or $selection.target.process.command_line = "c:\\windows\\system32\\netsh.exe advfirewall firewall add rule name=\"rundll32\" dir=out action=allow protocol=any program=\"c:\\windows\\system32\\rundll32.exe") or (($selection.target.process.file.full_path = "vssadmin.exe" or $selection.target.process.file.full_path = "sc.exe" or $selection.target.process.file.full_path = "net.exe" or $selection.target.process.file.full_path = "net1.exe" or $selection.target.process.file.full_path = "netsh.exe" or $selection.target.process.file.full_path = "cscript.exe" or $selection.target.process.file.full_path = "wscript.exe") and (re.regex($selection.target.process.command_line, `.*delete shadows /all /quiet.*`) or re.regex($selection.target.process.command_line, `.*resize shadowstorage.*`) or re.regex($selection.target.process.command_line, `.*stop netbackup bmr mtftp service /y.*`) or re.regex($selection.target.process.command_line, `.*\.jse.*`) or re.regex($selection.target.process.command_line, `.*\.js.*`) or re.regex($selection.target.process.command_line, `.*\.zip.*`) or re.regex($selection.target.process.command_line, `.*stop bmr boot service /y.*`) or re.regex($selection.target.process.command_line, `.*stop avpsus /y.*`) or re.regex($selection.target.process.command_line, `.*sc stop windefend/y.*`) or re.regex($selection.target.process.command_line, `.*sc config windefend start= disabled /y.*`) or re.regex($selection.target.process.command_line, `.*config sqltelemetry start= disabled.*`) or re.regex($selection.target.process.command_line, `.*config sqlwriter start= disabled.*`) or re.regex($selection.target.process.command_line, `.*config sstpsvc start= disabled.*`)))))
<li><a href="#">events: ($selection.metadata.product_event_type = "1" and (re.regex($selection.src.process.file.full_path, `.*\\winword\.exe`) or re.regex($selection.src.process.file.full_path, `.*\\excel\.exe`)) and re.regex($selection.target.process.file.full_path, `.*\\cmd\.exe`))
<li><a href="#">events: ($selection.metadata.product_event_type = "1" and (re.regex($selection.target.process.command_line, `.* asreproast .*`) or re.regex($selection.target.process.command_line, `.* dump /service:krbtgt .*`) or re.regex($selection.target.process.command_line, `.* kerberoast .*`) or re.regex($selection.target.process.command_line, `.* createnetonly /program:.*`) or re.regex($selection.target.process.command_line, `.* ptt /ticket:.*`) or re.regex($selection.target.process.command_line, `.* /impersonateuser:.*`) or re.regex($selection.target.process.command_line, `.* renew /ticket:.*`) or re.regex($selection.target.process.command_line, `.* asktgt /user:.*`) or re.regex($selection.target.process.command_line, `.* harvest /interval:.*`)))
<li><a href="#">events: ($selection.metadata.product_event_type = "1" and (re.regex($selection.target.process.file.full_path, `.*schtask\.exe`) or re.regex($selection.target.process.file.full_path, `.*schtasks\.exe`)) and re.regex($selection.target.process.command_line, `.*\\appdata.*`))
<li><a href="#">events: ($selection.metadata.product_event_type = "1" and (re.regex($selection.target.process.file.full_path, `.*wscript\.exe`) or re.regex($selection.target.process.file.full_path, `.*cscript\.exe`)) and (re.regex($selection.target.process.command_line, `.*\.jse.*`) or re.regex($selection.target.process.command_line, `.*\.vbe.*`) or re.regex($selection.target.process.command_line, `.*\.js.*`) or re.regex($selection.target.process.command_line, `.*\.vba.*`)))
<li><a href="#">events: ($selection.metadata.product_event_type = "1" and (re.regex($selection.target.process.file.full_path, `c:\\windows\\fonts.*`) or re.regex($selection.target.process.file.full_path, `.*\\htdocs.*`) or re.regex($selection.target.process.file.full_path, `c:\\windows\\media.*`) or re.regex($selection.target.process.file.full_path, `c:\\users\\public.*`) or re.regex($selection.target.process.file.full_path, `c:\\windows\\system32\\config\\systemprofile.*`) or re.regex($selection.target.process.file.full_path, `c:\\windows\\addins.*`) or re.regex($selection.target.process.file.full_path, `c:\\windows\\debug.*`) or re.regex($selection.target.process.file.full_path, `c:\\users\\networkservice.*`) or re.regex($selection.target.process.file.full_path, `c:\\users\\default.*`) or re.regex($selection.target.process.file.full_path, `c:\\windows\\help.*`) or re.regex($selection.target.process.file.full_path, `c:\\intel\\logs.*`) or re.regex($selection.target.process.file.full_path, `c:\\windows\\repair.*`) or re.regex($selection.target.process.file.full_path, `c:\\perflogs.*`) or re.regex($selection.target.process.file.full_path, `c:\\$recycle\.bin.*`) or re.regex($selection.target.process.file.full_path, `c:\\windows\\security.*`) or re.regex($selection.target.process.file.full_path, `.*\\wwwroot.*`)))
<li><a href="#">events: ($selection.metadata.product_event_type = "1" and re.regex($selection.src.process.file.full_path, `.*\\svchost\.exe`) and re.regex($selection.target.process.command_line, `.*/mshta\.exe`))
<li><a href="#">events: ($selection.metadata.product_event_type = "1" and re.regex($selection.target.process.file.full_path, `.*\\bitsadmin\.exe`) and (re.regex($selection.target.process.command_line, `.*/transfer`) or re.regex($selection.target.process.command_line, `.*/download`)))
<li><a href="#">events: ($selection.metadata.product_event_type = "1" and re.regex($selection.target.process.file.full_path, `.*\\csc\.exe.*`) and (re.regex($selection.src.process.file.full_path, `.*\\wscript\.exe`) or re.regex($selection.src.process.file.full_path, `.*\\cscript\.exe`) or re.regex($selection.src.process.file.full_path, `.*\\mshta\.exe`)))
<li><a href="#">events: ($selection.metadata.product_event_type = "1" and re.regex($selection.target.process.file.full_path, `.*\\cscript\.exe`) and re.regex($selection.target.process.command_line, `.*\.vbs /shell .*`))
<li><a href="#">events: ($selection.metadata.product_event_type = "1" and re.regex($selection.target.process.file.full_path, `.*\\netsh\.exe`) and re.regex($selection.target.process.command_line, `.*netsh firewall add allowedprogram \"c:\\users\\admin\\appdata\\local\\temp.*`) and re.regex($selection.target.process.command_line, `.*enable`))
<li><a href="#">events: ($selection.metadata.product_event_type = "1" and re.regex($selection.target.process.file.full_path, `.*\\psexec\.exe`))
<li><a href="#">events: ($selection.metadata.product_event_type = "1" and re.regex($selection.target.process.file.full_path, `.*\\recmd\.exe`))
<li><a href="#">events: ($selection.metadata.product_event_type = "1" and re.regex($selection.target.process.file.full_path, `.*powershell\.exe`) and $selection.src.process.file.full_path = "c:\\windows\\system32\\wscript.exe" and re.regex($selection.target.process.command_line, `\".*powershell\.exe\" iujby=\"tsgw\";iex \( [string][system\.text\.encoding]::ascii\.getstring\([system\.convert]::frombase64string\( \(\(new-object net\.webclient\)\.downloadstring.*`) and $selection.target.file.md5 = "sha1=6cbce4a295c163791b60fc23d285e6d84f28ee4c")
<li><a href="#">events: ($selection.metadata.product_event_type = "1" and re.regex($selection.target.process.file.full_path, `.*powershell\.exe`) and (re.regex($selection.target.process.command_line, `.*base64.*`) or re.regex($selection.target.process.command_line, `.*-enc.*`) or re.regex($selection.target.process.command_line, `.*-enco.*`) or re.regex($selection.target.process.command_line, `.*-encod.*`) or re.regex($selection.target.process.command_line, `.*-encode.*`) or re.regex($selection.target.process.command_line, `.*-encoded.*`) or re.regex($selection.target.process.command_line, `.*-ec.*`) or re.regex($selection.target.process.command_line, `.*-en.*`) or re.regex($selection.target.process.command_line, `.*-encodedc.*`) or re.regex($selection.target.process.command_line, `.*-encodedco.*`) or re.regex($selection.target.process.command_line, `.*-encodedcom.*`) or re.regex($selection.target.process.command_line, `.*-encodedcomm.*`) or re.regex($selection.target.process.command_line, `.*-encodedcomma.*`) or re.regex($selection.target.process.command_line, `.*-encodedcomman.*`) or re.regex($selection.target.process.command_line, `.*-encodedcommand.*`)))
<li><a href="#">events: ($selection.metadata.product_event_type = "10" and $selection.target.process.file.full_path = "c:\\windows\\system32\\lsass.exe" and $selection.src.process.file.full_path = "c:\\windows\\system32\\wsmprovhost.exe")
<li><a href="#">events: ($selection.metadata.product_event_type = "104" and $selection.src.application = "microsoft-windows-eventlog")
<li><a href="#">events: ($selection.metadata.product_event_type = "11" and ($selection.target.file.full_path = "c:\\programdata\\wget.vbs" or re.regex($selection.target.file.full_path, `.*\\sqlagentidc\.exe`) or $selection.target.file.full_path = "c:\\recycler\\wget.vbs" or $selection.target.file.full_path = "c:\\programdata\\emsda.vbs" or $selection.target.file.full_path = "c:\\recycler\\emsda.vbs" or re.regex($selection.target.file.full_path, `.*\\sqlagentswa\.exe`) or re.regex($selection.target.file.full_path, `.*\\sqliomdsd\.exe`) or re.regex($selection.target.file.full_path, `.*\\sqlsernsf\.exe`) or $selection.target.file.full_path = "c:\\program files (x86)\\microsoft sql server\\sqlserasi.exe" or $selection.target.file.full_path = "c:\\users\\mssql~1\\appdata\\local\\temp\\startas.bat" or $selection.target.file.full_path = "c:\\users\\mssqlserver\\appdata\\local\\temp\\startas.bat" or $selection.target.file.full_path = "c:\\windows\\temp\\startas.bat" or $selection.target.file.full_path = "c:\\windows\\serviceprofiles\\networkservice\\appdata\\local\\temp\\startas.bat" or $selection.target.file.full_path = "c:\\users\\mssqlserver\\appdata\\local\\temp\\startae.bat" or $selection.target.file.full_path = "c:\\windows\\temp\\startae.bat" or $selection.target.file.full_path = "c:\\windows\\serviceprofiles\\networkservice\\appdata\\local\\temp\\startae.bat"))
<li><a href="#">events: ($selection.metadata.product_event_type = "11" and (re.regex($selection.target.file.full_path, `.*\\appdata\\roaming\\oracle\\bin\\java.*\.exe`) or re.regex($selection.target.file.full_path, `.*\\retrive.*\.vbs`)))
<li><a href="#">events: ($selection.metadata.product_event_type = "11" and re.regex($selection.target.file.full_path, `.*\\appdata\\local\\temp\\sam-.*\.dmp.*`))
<li><a href="#">events: ($selection.metadata.product_event_type = "11" and re.regex($selection.target.file.full_path, `.*\\temp\\debug\.bin`))
<li><a href="#">events: ($selection.metadata.product_event_type = "11" and re.regex($selection.target.process.file.full_path, `.*eqnedt32\.exe`) and re.regex($selection.target.file.full_path, `.*\\appdata\\roaming\\microsoft\\word\\startup\\.*\.wll`))
<li><a href="#">events: ($selection.metadata.product_event_type = "1121" and re.regex($selection.target.file.full_path, `.*\\lsass\.exe`))
<li><a href="#">events: ($selection.metadata.product_event_type = "13" and (re.regex($selection.target.process.file.full_path, `.*\\downloads\\.*`) or re.regex($selection.target.process.file.full_path, `.*\\temporary internet files\\content\.outlook\\.*`) or re.regex($selection.target.process.file.full_path, `.*\\local settings\\temporary internet files\\.*`)) and re.regex($selection.target.registry.registry_key, `.*\\software\\microsoft\\windows\\currentversion\\run\\.*`))
<li><a href="#">events: ($selection.metadata.product_event_type = "13" and (re.regex($selection.target.registry.registry_key, `.*\\software\\microsoft\\windows\\currentversion\\run\\.*`) or re.regex($selection.target.registry.registry_key, `.*\\software\\microsoft\\windows\\currentversion\\runonce\\.*`)) and (re.regex($selection.metadata.description, `c:\\windows\\temp\\.*`) or re.regex($selection.metadata.description, `.*\\appdata\\.*`) or re.regex($selection.metadata.description, `c:\\$recycle\.bin\\.*`) or re.regex($selection.metadata.description, `c:\\temp\\.*`) or re.regex($selection.metadata.description, `c:\\users\\public\\.*`) or re.regex($selection.metadata.description, `c:\\users\\default\\.*`) or re.regex($selection.metadata.description, `c:\\users\\desktop\\.*`)))
<li><a href="#">events: ($selection.metadata.product_event_type = "13" and re.regex($selection.target.registry.registry_key, `.*\\microsoft\\windows\\currentversion\\policies\\explorer\\run`) and (re.regex($selection.metadata.description, `c:\\windows\\temp\\.*`) or re.regex($selection.metadata.description, `c:\\programdata\\.*`) or re.regex($selection.metadata.description, `.*\\appdata\\.*`) or re.regex($selection.metadata.description, `c:\\$recycle\.bin\\.*`) or re.regex($selection.metadata.description, `c:\\temp\\.*`) or re.regex($selection.metadata.description, `c:\\users\\public\\.*`) or re.regex($selection.metadata.description, `c:\\users\\default\\.*`)))
<li><a href="#">events: ($selection.metadata.product_event_type = "13" and re.regex($selection.target.registry.registry_key, `.*\\sam\\sam\\domains\\account\\users\\000001f5`))
<li><a href="#">events: ($selection.metadata.product_event_type = "13" and re.regex($selection.target.registry.registry_key, `.*\\software\\appdatalow\\software\\microsoft\\.*`))
<li><a href="#">events: ($selection.metadata.product_event_type = "13" and re.regex($selection.target.registry.registry_key, `.*system\\currentcontrolset\\services\\termservice\\parameters\\servicedll`))
<li><a href="#">events: ($selection.metadata.product_event_type = "13" and re.regex($selection.target.registry.registry_key, `hkey_users\\.*\\classes\\exefile\\shell\\runas\\command\\isolatedcommand`))
<li><a href="#">events: ($selection.metadata.product_event_type = "13" and re.regex($selection.target.registry.registry_key, `registry\\machine\\software\\microsoft\\windows\\currentversion\\run.*`) and re.regex($selection.metadata.description, `%appdata%\\roaming\\oracle\\bin\\.*`))
<li><a href="#">events: ($selection.metadata.product_event_type = "2" and re.regex($selection.target.process.file.full_path, `.*\\powershell\.exe`))
<li><a href="#">events: ($selection.metadata.product_event_type = "2003" or $selection.metadata.product_event_type = "2100" or $selection.metadata.product_event_type = "2102")
<li><a href="#">events: ($selection.metadata.product_event_type = "3" and ($selection.target.port = "587" or $selection.target.port = "465"))
<li><a href="#">events: ($selection.metadata.product_event_type = "3" and (re.regex($selection.target.hostname, `.*\.github\.com`) or re.regex($selection.target.hostname, `.*\.githubusercontent\.com`)) and re.regex($selection.target.process.file.full_path, `c:\\windows\\.*`))
<li><a href="#">events: ($selection.metadata.product_event_type = "3" and (re.regex($selection.target.hostname, `.*dl\.dropboxusercontent\.com`) or re.regex($selection.target.hostname, `.*\.pastebin\.com`)) and re.regex($selection.target.process.file.full_path, `c:\\windows\\.*`))
<li><a href="#">events: ($selection.metadata.product_event_type = "3" and (re.regex($selection.target.process.file.full_path, `.*\\$recycle\.bin`) or re.regex($selection.target.process.file.full_path, `.*\\users\\all users\\.*`) or re.regex($selection.target.process.file.full_path, `.*\\users\\default\\.*`) or re.regex($selection.target.process.file.full_path, `.*\\users\\public\\.*`) or re.regex($selection.target.process.file.full_path, `c:\\perflogs\\.*`) or re.regex($selection.target.process.file.full_path, `.*\\config\\systemprofile\\.*`) or re.regex($selection.target.process.file.full_path, `.*\\windows\\fonts\\.*`) or re.regex($selection.target.process.file.full_path, `.*\\windows\\ime\\.*`) or re.regex($selection.target.process.file.full_path, `.*\\windows\\addins\\.*`)))
<li><a href="#">events: ($selection.metadata.product_event_type = "4624" and $selection.extensions.auth.mechanism = "10" and $selection.src.application = "negotiate" and re.regex($selection.src.user.user_display_name, `admin-.*`))
<li><a href="#">events: ($selection.metadata.product_event_type = "4624" and $selection.extensions.auth.mechanism = "10" and ($selection.principal.ip = "::1" or $selection.principal.ip = "127.0.0.1"))
<li><a href="#">events: ($selection.metadata.product_event_type = "4624" and $selection.extensions.auth.mechanism = "3" and $selection.target.user.user_display_name = "anonymous_logon" and $selection.principal.hostname = "-" and $selection.principal.ip = "127.0.0.1")
<li><a href="#">events: ($selection.metadata.product_event_type = "4625" and $selection.src.user.user_display_name = "aaaaaaa")
<li><a href="#">events: ($selection.metadata.product_event_type = "4656" and $selection.target.process.file.full_path = "c:\\windows\\system32\\lsass.exe" and $selection.target.process.access_mask = "0x705" and $selection.src.user.user_display_name = "sam_domain")
<li><a href="#">events: ($selection.metadata.product_event_type = "4657" and (re.regex($selection.target.registry.registry_value_data, `.*software\\microsoft\\windows nt\\currentversion\\appcompatflags\\telemetrycontroller.*\\command.*`) or re.regex($selection.target.file.full_path, `.*software\\microsoft\\windows nt\\currentversion\\appcompatflags\\telemetrycontroller.*\\command.*`)))
<li><a href="#">events: ($selection.metadata.product_event_type = "4661" and ($selection.src.user.user_display_name = "sam_user" or $selection.src.user.user_display_name = "sam_group") and ((re.regex($selection.target.registry.registry_value_data, `.*-512`) or re.regex($selection.target.registry.registry_value_data, `.*-502`) or re.regex($selection.target.registry.registry_value_data, `.*-500`) or re.regex($selection.target.registry.registry_value_data, `.*-505`) or re.regex($selection.target.registry.registry_value_data, `.*-519`) or re.regex($selection.target.registry.registry_value_data, `.*-520`) or re.regex($selection.target.registry.registry_value_data, `.*-544`) or re.regex($selection.target.registry.registry_value_data, `.*-551`) or re.regex($selection.target.registry.registry_value_data, `.*-555`) or re.regex($selection.target.registry.registry_value_data, `.*admin.*`)) or (re.regex($selection.target.file.full_path, `.*-512`) or re.regex($selection.target.file.full_path, `.*-502`) or re.regex($selection.target.file.full_path, `.*-500`) or re.regex($selection.target.file.full_path, `.*-505`) or re.regex($selection.target.file.full_path, `.*-519`) or re.regex($selection.target.file.full_path, `.*-520`) or re.regex($selection.target.file.full_path, `.*-544`) or re.regex($selection.target.file.full_path, `.*-551`) or re.regex($selection.target.file.full_path, `.*-555`) or re.regex($selection.target.file.full_path, `.*admin.*`))))
<li><a href="#">events: ($selection.metadata.product_event_type = "4662" and (re.regex($selection.target.process.file.file_metadata.pe.import_hash, `.*replicating directory changes all.*`) or re.regex($selection.target.process.file.file_metadata.pe.import_hash, `.*1131f6ad-9c07-11d1-f79f-00c04fc2dcd2.*`)))
<li><a href="#">events: ($selection.metadata.product_event_type = "4688" and (re.regex($selection.target.process.command_line, `.* asreproast .*`) or re.regex($selection.target.process.command_line, `.* dump /service:krbtgt .*`) or re.regex($selection.target.process.command_line, `.* kerberoast .*`) or re.regex($selection.target.process.command_line, `.* createnetonly /program:.*`) or re.regex($selection.target.process.command_line, `.* ptt /ticket:.*`) or re.regex($selection.target.process.command_line, `.* /impersonateuser:.*`) or re.regex($selection.target.process.command_line, `.* renew /ticket:.*`) or re.regex($selection.target.process.command_line, `.* asktgt /user:.*`) or re.regex($selection.target.process.command_line, `.* harvest /interval:.*`)))
<li><a href="#">events: ($selection.metadata.product_event_type = "4688" and (re.regex($selection.target.process.file.full_path, `zoom-us-zoom_.*\.exe`) or re.regex($selection.target.process.file.full_path, `microsoft-teams_v.*mu.*d_.*\.exe`)))
<li><a href="#">events: ($selection.metadata.product_event_type = "4688" and re.regex($selection.target.process.command_line, `.*\\whoami\.exe`))
<li><a href="#">events: ($selection.metadata.product_event_type = "4722" and ($selection.src.user.user_display_name = "guest" or $selection.src.user.user_display_name = "guest"))
<li><a href="#">events: ($selection.metadata.product_event_type = "4728" or $selection.metadata.product_event_type = "4729" or $selection.metadata.product_event_type = "4730" or $selection.metadata.product_event_type = "633" or $selection.metadata.product_event_type = "632" or $selection.metadata.product_event_type = "634")
<li><a href="#">events: ($selection.metadata.product_event_type = "4742" and re.regex($selection.target.user.user_display_name, `.*$`) and (re.regex($selection.src.user.user_display_name, `.*anonymous.*`) or re.regex($selection.src.user.userid, `.*s-1-0.*`)))
<li><a href="#">events: ($selection.metadata.product_event_type = "5" and re.regex($selection.target.process.file.full_path, `.*\\psexec\.exe`))
<li><a href="#">events: ($selection.metadata.product_event_type = "5156" and (($selection.principal.port = "3389" and (re.regex($selection.target.ip, `127\..*`) or $selection.target.ip = "::1")) or ($selection.target.port = "3389" and (re.regex($selection.principal.ip, `127\..*`) or $selection.principal.ip = "::1"))))
<li><a href="#">events: ($selection.metadata.product_event_type = "517" or $selection.metadata.product_event_type = "1102" or $selection.metadata.product_event_type = "104")
<li><a href="#">events: ($selection.metadata.product_event_type = "524" and $selection.src.application = "microsoft-windows-backup")
<li><a href="#">events: ($selection.metadata.product_event_type = "6" and re.regex($selection.target.process.file.full_path, `.*\\temp\\.*`))
<li><a href="#">events: ($selection.metadata.product_event_type = "643" or $selection.metadata.product_event_type = "4739")
<li><a href="#">events: ($selection.metadata.product_event_type = "7" and $selection.target.process.file.full_path = "c:\\windows\\system32\\wbem\\wmiprvse.exe" and $selection.target.process.file.full_path = "wbemcons.dll")
<li><a href="#">events: ($selection.metadata.product_event_type = "7" and ($selection.target.file.md5 = "e832e3a58b542e15a169b1545ce82451ace19bd361fd81764383048528f9b540" or $selection.target.file.md5 = "1676de3980df1d78e14b172989916570"))
<li><a href="#">events: ($selection.metadata.product_event_type = "7" and (re.regex($selection.target.process.file.full_path, `.*\\system\.reflection\.dll`) or re.regex($selection.target.process.file.full_path, `.*\\system\.managment\.automation\.ni\.dll`) or re.regex($selection.target.process.file.full_path, `.*\\system\.managment\.automation\.dll`)))
<li><a href="#">events: ($selection.metadata.product_event_type = "7" and (re.regex($selection.target.process.file.full_path, `.*\\winword\.exe.*`) or re.regex($selection.target.process.file.full_path, `.*\\powerpnt\.exe.*`) or re.regex($selection.target.process.file.full_path, `.*\\excel\.exe.*`) or re.regex($selection.target.process.file.full_path, `.*\\outlook\.exe.*`)) and (re.regex($selection.target.process.file.full_path, `.*\\vbe7\.dll.*`) or re.regex($selection.target.process.file.full_path, `.*\\vbeui\.dll.*`) or re.regex($selection.target.process.file.full_path, `.*\\vbe7intl\.dll.*`)))
<li><a href="#">events: ($selection.metadata.product_event_type = "7" and (re.regex($selection.target.process.file.full_path, `.*system\.management\.automation\.dll.*`) or re.regex($selection.target.process.file.full_path, `.*system\.management\.automation\.ni\.dll.*`) or re.regex($selection.target.process.file.full_path, `.*system\.reflection\.dll.*`)))
<li><a href="#">events: ($selection.metadata.product_event_type = "7045" and (($selection.target.process.command_line = "wceservice" or $selection.target.process.command_line = "wce service") or re.regex($selection.target.process.command_line, `.*\\paexec.*`) or re.regex($selection.target.process.command_line, `winexesvc\.exe.*`) or re.regex($selection.target.process.command_line, `.*\\dumpsvc\.exe`) or $selection.target.process.command_line = "mssecsvc2.0" or re.regex($selection.target.process.command_line, `.* net user .*`) or (re.regex($selection.target.process.command_line, `pwdump.*`) or re.regex($selection.target.process.command_line, `gsecdump.*`) or re.regex($selection.target.process.command_line, `cachedump.*`))))
<li><a href="#">events: ($selection.metadata.product_event_type = "7045" and re.regex($selection.target.process.command_line, `%comspec% /b /c start /b /min powershell\.exe -nop -w hidden -noni -c.*`))
<li><a href="#">events: ($selection.metadata.product_event_type = "8" and $selection.target.process.file.full_path = "c:\\windows\\system32\\lsass.exe" and $selection.src.application = "")
<li><a href="#">events: ($selection.metadata.product_event_type = "8" and (re.regex($selection.src.process.file.full_path, `.*\\system32\\cscript\.exe`) or re.regex($selection.src.process.file.full_path, `.*\\system32\\wscript\.exe`) or re.regex($selection.src.process.file.full_path, `.*\\system32\\mshta\.exe`) or re.regex($selection.src.process.file.full_path, `.*\\winword\.exe`) or re.regex($selection.src.process.file.full_path, `.*\\excel\.exe`)) and re.regex($selection.target.process.file.full_path, `.*\\syswow64\\.*`) and $selection.src.application = "")
<li><a href="#">events: ($selection.metadata.product_event_type = "8" and re.regex($selection.src.process.file.full_path, `.*\\powershell\.exe`) and re.regex($selection.target.process.file.full_path, `.*\\rundll32\.exe`))
<li><a href="#">events: ($selection.metadata.product_event_type = "8" and re.regex($selection.target.process.file.file_metadata.pe.import_hash, `.*0b80`))
<li><a href="#">events: ($selection.network.http.method = "post" and re.regex($selection.target.url, `/plugins/drag-and-drop/upload\.action\?pageid.*&filename=^\(\?!\..*\\/\.\\/\.\)\.{0,200}$.*&size=.*&mimetype=.*atl_token=.*&name=^\(\?!\..*\\/\.\\/\.\)\.{0,200}$.*`))
<li><a href="#">events: ($selection.security_result.action = "allowed" and $selection.target.url = "")
<li><a href="#">events: ($selection.security_result.action = "allowed" and ($selection.target.url = "" or $selection.target.url = ""))
<li><a href="#">events: ($selection.security_result.action = "allowed" and ($selection.target.url = "[@]company.com" or $selection.target.url = "" or $selection.target.url = ""))
<li><a href="#">events: ($selection.src.application = "certutil url agent" or re.regex($selection.src.application, `microsoft-cryptoapi/.*`))
<li><a href="#">events: ($selection.src.application = "mozilla/5.0 (windows nt 6.1; wow64) applewebkit/537.36 (khtml, like gecko) chrome/36.0.1985.143 safari/537.36" and $selection.target.hostname = "api.dropbox.com")
<li><a href="#">events: ($selection.src.application = "mozilla/5.0 (windows nt 6.1; wow64; rv:53.0) gecko/20100101 chrome /53.0" or $selection.src.application = "mozilla/4.0 (compatible; msie 8.0; windows nt 5.1)" or $selection.src.application = "mozilla/4.0 (compatible; msie 7.0; windows nt 5.1; trident/4.0)" or $selection.src.application = "mozilla/4.0 (compatible; msie 6.0; windows nt 5.0; .net clr 1.1.4322)" or $selection.src.application = "httpbrowser/1.0" or re.regex($selection.src.application, `.*<|>.*`) or $selection.src.application = "nsis_inetc (mozilla)" or $selection.src.application = "wget/1.9+cvs-stable (red hat modified)" or $selection.src.application = "mozilla/4.0 (compatible; msie 8.0; windows nt 6.1; trident/4.0; .net clr 1.1.4322)" or re.regex($selection.src.application, `.*zeroup.*`) or re.regex($selection.src.application, `mozilla/5\.0 \(windows nt 5\.1 ; v\..*`) or re.regex($selection.src.application, `.* adlib/.*`) or re.regex($selection.src.application, `.* tiny`) or re.regex($selection.src.application, `.* bgroom .*`) or re.regex($selection.src.application, `.* changhuatong`) or re.regex($selection.src.application, `.* choltbagent`) or $selection.src.application = "mozilla/5.0 wininet" or $selection.src.application = "rookie/1.0" or $selection.src.application = "m" or $selection.src.application = "mozilla/4.0 (compatible; msie 8.0; windows nt 5.1; trident/4.0)" or $selection.src.application = "mozilla/4.0 (compatible;msie 7.0;windows nt 6.0)" or $selection.src.application = "backdoorbot" or $selection.src.application = "mozilla/5.0 (windows; u; windows nt 5.1; en-us; rv:1.9.2.3) gecko/20100401 firefox/3.6.1 (.net clr 3.5.30731)" or $selection.src.application = "opera/8.81 (windows nt 6.0; u; en)" or $selection.src.application = "mozilla/5.0 (windows; u; windows nt 5.1; en-us; rv:1.9.2.3) gecko/20100401 firefox/3.6.1 (.net clr 3.5.30729)" or $selection.src.application = "opera" or $selection.src.application = "mozilla/4.0 (compatible; msie 5.0; windows 98)" or $selection.src.application = "mozilla/4.0 (compatible; msie 5.01; windows nt 5.0)" or $selection.src.application = "msie" or re.regex($selection.src.application, `.*\(charon; inferno\)`) or $selection.src.application = "mozilla/4.0 (compatible; msie 8.0; windows nt 5.1; trident/5.0)" or $selection.src.application = "mozilla/4.0 (compatible; msie 6.1; windows nt)" or $selection.src.application = "mozilla/4.0(compatible; msie 6.0; windows nt 5.1)" or re.regex($selection.src.application, `.* pxyscand.*`) or re.regex($selection.src.application, `.* asd`) or re.regex($selection.src.application, `.* mdms`) or $selection.src.application = "sample" or $selection.src.application = "nocase" or $selection.src.application = "moxilla" or re.regex($selection.src.application, `win32 .*`) or re.regex($selection.src.application, `.*microsoft internet explorer.*`) or re.regex($selection.src.application, `agent .*`) or $selection.src.application = "autoit" or $selection.src.application = "iczeliondownload")
<li><a href="#">events: ($selection.src.application = "mozilla/5.0 (windows nt 6.1; wow64; trident/7.0; rv:11.0) like gecko" or $selection.src.application = "mozilla/6.0 (x11; linux x86_64; rv:24.0) gecko/20140205 firefox/27.0 iceweasel/25.3.0" or $selection.src.application = "mozilla/5.0 (windows nt 6.3; rv:36.0) gecko/20100101 firefox/36.0")
<li><a href="#">events: ($selection.src.application = "sjzj (compatible; msie 6.0; win32)" or $selection.src.application = "mozilla/5.0 (windows nt 6.; wow64; rv:20.0) gecko/20100101 firefox/20.0" or $selection.src.application = "user-agent: mozilla/4.0 (compatible; msie 8.0; windows nt 6.1; trident/4.0; slcc" or $selection.src.application = "mozilla/4.0 (compatible; msie 7.4; win32;32-bit)" or $selection.src.application = "webclient" or $selection.src.application = "mozilla/5.0 (windows; u; windows nt 5.1; zh-en; rv:1.7.12) gecko/200" or $selection.src.application = "mozilla/4.0 (compatible; msi 6.0;" or $selection.src.application = "mozilla/5.0 (windows nt 6.3; wow64; rv:28.0) gecko/20100101 firefox/28.0" or $selection.src.application = "mozilla/5.0 (windows nt 6.2; wow64; rv:20.0) gecko/20100101 firefox" or $selection.src.application = "mozilla/5.0 (windows nt 6.; wow64; rv:20.0) gecko/20100101 firefox/2" or $selection.src.application = "mozilla/4.0" or $selection.src.application = "netscape" or $selection.src.application = "mozilla/5.0 (windows; u; windows nt 5.1; zh-en; rv:1.7.12) gecko/20100719 firefox/1.0.7" or $selection.src.application = "mozilla/5.0 (windows; u; windows nt 5.1; en-us; rv:1.9.2.13) firefox/3.6.13 gtb7.1" or $selection.src.application = "mozilla/5.0 (compatible; msie 9.0; windows nt 6.1; wow64; trident/5.0)" or $selection.src.application = "mozilla/4.0 (compatible; msie 8.0; windows nt 6.1; wow64; trident/4.0; slcc2; .netclr 2.0.50727)" or $selection.src.application = "mozilla/4.0 (compatible; msie 8.0; windows nt 6.0; sv1)" or $selection.src.application = "mozilla/4.0 (compatible; msie 11.0; windows nt 6.1; sv1)" or $selection.src.application = "mozilla/4.0 (compatible; msie 8.0; win32)" or $selection.src.application = "mozilla v5.1 (windows nt 6.1; rv:6.0.1) gecko/20100101 firefox/6.0.1" or $selection.src.application = "mozilla/6.1 (compatible; msie 9.0; windows nt 5.3; trident/5.0)" or $selection.src.application = "mozilla/4.0 (compatible; msie 6.0; windows nt 5.1; sv1; .net clr 1.1.4322; .net clr 2.0.50727; .net clr 3.0.04506.30; .net clr 3.0.04506.648; infopath.1)" or $selection.src.application = "mozilla/5.0 (windows nt 6.1; wow64) winhttp/1.6.3.8 (winhttp/5.1) like gecko" or re.regex($selection.src.application, `mozilla v5\.1 .*`) or $selection.src.application = "msie 8.0" or $selection.src.application = "mozilla/4.0 (compatible; msie 7.0; windows nt 6.1; slcc2; .net clr 2.0.50727; .net clr 3.5.30729; .net clr 3.0.30729; media center pc 6.0; .net4.0c; .net4.0e; infopath.2)")
<li><a href="#">events: ($selection.src.process.file.full_path = "8cab6413fdc97e9cc90607b3a49175a7.exe" and (re.regex($selection.target.process.file.full_path, `.*regsvcs\.exe`) or $selection.target.process.file.full_path = "c:\\windows\\system32\\schtasks.exe") and re.regex($selection.target.process.command_line, `.*/create /tn \"updates\\zwqpnecnvowf\" /xml \"c:\\users\\admin\\appdata\\local\\temp\\tmp6ceb\.tmp\"`))
<li><a href="#">events: ($selection.src.process.file.full_path = "c:\\windows\\system32\\cmd.exe" and $selection.target.process.file.full_path = "c:\\windows\\system32\\reg.exe" and ($selection.target.process.command_line = "reg query hkcu /f password /t reg_sz /s" or $selection.target.process.command_line = "reg query hklm /f password /t reg_sz /s"))
<li><a href="#">events: ($selection.src.process.file.full_path = "c:\\windows\\system32\\cmd.exe" and $selection.target.process.file.full_path = "c:\\windows\\system32\\reg.exe" and (re.regex($selection.target.process.command_line, `.*hklm\\software\\microsoft\\windows nt\\currentversion\\windows\\loadappinit_dlls.*`) or re.regex($selection.target.process.command_line, `.*hkey_local_machine\\software\\wow6432node\\microsoft\\windows nt\\currentversion\\windows\\loadappinit_dlls.*`) or re.regex($selection.target.process.command_line, `.*hkey_local_machine\\software\\microsoft\\windows nt\\currentversion\\windowsappinit_dlls.*`) or re.regex($selection.target.process.command_line, `.*hkey_local_machine\\software\\wow6432node\\microsoft\\windows nt\\currentversion\\windows\\appinit_dlls.*`)))
<li><a href="#">events: ($selection.src.process.file.full_path = "c:\\windows\\system32\\cmd.exe" and $selection.target.process.file.full_path = "c:\\windows\\system32\\reg.exe" and (re.regex($selection.target.process.command_line, `reg add .*\\software\\classes\\clsid.*.*\.dll`) or re.regex($selection.target.process.command_line, `reg add .*\\software\\classes\\clsid.*.*\.exe`)))
<li><a href="#">events: ($selection.src.process.file.full_path = "c:\\windows\\system32\\cmd.exe" and $selection.target.process.file.full_path = "c:\\windows\\system32\\reg.exe" and re.regex($selection.target.process.command_line, `reg add .*\\control\\terminalserver\\winstations\\rdp-tcp.* /v portnumber /t reg_dword /d 443 /f`))
<li><a href="#">events: ($selection.target.hostname = "bb800.com" or $selection.target.hostname = "ad.bb800.com" or $selection.target.hostname = "down.bb800.com" or $selection.target.hostname = "ty1.bb800.com" or $selection.target.hostname = "iosnoico.bb800.com" or $selection.target.hostname = "qvod.bb800.com" or $selection.target.hostname = "qvios.od.bb800.com" or $selection.target.hostname = "dp.bb800.com" or $selection.target.hostname = "iosads.cdn.bb800.com")
<li><a href="#">events: ($selection.target.hostname = "myinvestgroup.com" or $selection.target.hostname = "netmediaresources.com" or $selection.target.hostname = "webviewres.net" or $selection.target.hostname = "adfs.senate.group" or $selection.target.hostname = "adfs-senate.email" or $selection.target.hostname = "adfs-senate.services" or $selection.target.hostname = "adfs.senate.qov.info" or $selection.target.hostname = "chmail.ir.udelivered.tk" or $selection.target.hostname = "webmail-ibsf.org" or $selection.target.hostname = "fil-luge.com" or $selection.target.hostname = "biathlovvorld.com" or $selection.target.hostname = "mail-ibu.eu" or $selection.target.hostname = "fisski.ca" or $selection.target.hostname = "iihf.eu" or $selection.target.hostname = "cdnverify.net" or $selection.target.hostname = "osce-press.com" or $selection.target.hostname = "electronicfrontierfoundation.org" or $selection.target.hostname = "baltichost.org" or $selection.target.hostname = "checkmalware.org" or $selection.target.hostname = "kavkazcentr.info" or $selection.target.hostname = "login-osce.org" or $selection.target.hostname = "malwarecheck.info" or $selection.target.hostname = "n0vinite.com" or $selection.target.hostname = "nato.nshq.in" or $selection.target.hostname = "natoexhibitionff14.com" or $selection.target.hostname = "novinitie.com" or $selection.target.hostname = "poczta.mon.q0v.pl" or $selection.target.hostname = "q0v.pl" or $selection.target.hostname = "qov.hu.com" or $selection.target.hostname = "rnil.am" or $selection.target.hostname = "scanmalware.info" or $selection.target.hostname = "smigroup-online.co.uk" or $selection.target.hostname = "standartnevvs.com" or $selection.target.hostname = "updatecenter.name" or $selection.target.hostname = "securitypractic.com" or $selection.target.hostname = "drivers-update.info" or $selection.target.hostname = "nato-press.com")
<li><a href="#">events: ($selection.target.hostname = "sysanalyticweb.com" or $selection.target.hostname = "elaxo.org" or $selection.target.hostname = "ikmtrust.com" or $selection.target.hostname = "lxwo.org")
<li><a href="#">events: ($selection.target.process.command_line = "c:\\windows\\psexesvc.exe" and ($selection.metadata.product_event_type = "4688" or $selection.metadata.product_event_type = "1"))
<li><a href="#">events: ($selection.target.process.command_line = "c:\\windows\\system32\\cmd.exe\" /c reg add \"hkey_current_user\\software\\microsoft\\windows\\currentversion\\run\"" or re.regex($selection.target.process.command_line, `/v \"svchos\" /t reg_sz /d \"c:\\users\\public.*\.exe\" /f`))
<li><a href="#">events: ($selection.target.process.command_line = "cmd.exe /c sc stop wuauserv" or $selection.target.process.command_line = "stop wuauserv")
<li><a href="#">events: ($selection.target.process.command_line = "ps.exe -accepteula" and ($selection.metadata.product_event_type = "4688" or $selection.metadata.product_event_type = "1"))
<li><a href="#">events: ($selection.target.process.command_line = "rasdial" and ($selection.metadata.product_event_type = "4688" or $selection.metadata.product_event_type = "1"))
<li><a href="#">events: ($selection.target.process.file.full_path = "c:\\windows\\system32\\curl.exe" and $selection.src.process.file.full_path = "c:\\windows\\system32\\cmd.exe" and (re.regex($selection.target.process.command_line, `.*curl ftp.*`) or re.regex($selection.target.process.command_line, `.*curl --socks5 torproxy.*`) or re.regex($selection.target.process.command_line, `.*curl -f .*\.exe.*`) or re.regex($selection.target.process.command_line, `.*curl --dns-ipv4-addr.*`) or re.regex($selection.target.process.command_line, `.*curl --dns-interface eth1.*`) or re.regex($selection.target.process.command_line, `.*curl --resolve.*`) or re.regex($selection.target.process.command_line, `.*curl --header \"x-application: botclient\".*`)))
<li><a href="#">events: ($selection.target.process.file.full_path = "c:\\windows\\system32\\rundll32.exe" and re.regex($selection.src.process.file.full_path, `c:\\windows\\system32\\cmd\.exe.*`) and re.regex($selection.target.process.command_line, `.*c:\\programdata\\zyghisczawv\.dll,dl^lregi^sterse^rver.*`))
<li><a href="#">events: ($selection.target.process.file.full_path = "c:\\windows\\system32\\wbem\\scrcons.exe" and $selection.src.process.file.full_path = "c:\\windows\\system32\\svchost.exe" and ($selection.metadata.product_event_type = "4688" or $selection.metadata.product_event_type = "1"))
<li><a href="#">events: ($selection.target.process.file.full_path = "schtasks.exe" and re.regex($selection.target.process.command_line, `.*/change.*/tn.*/ru.*/rp.*`) and ($selection.metadata.product_event_type = "4688" or $selection.metadata.product_event_type = "1"))
<li><a href="#">events: ($selection.target.registry.registry_value_data = "powershell injection attack" or $selection.target.registry.registry_value_data = "icmp powershell shell activity" or $selection.target.registry.registry_value_data = "powershell payload web delivery" or $selection.target.registry.registry_value_data = "malicious powershell script download" or $selection.target.registry.registry_value_data = "powershell empire activity" or $selection.target.registry.registry_value_data = "w97m.downloader powershell activity")
<li><a href="#">events: ($selection_hashes.metadata.product_event_type = "1" and ($selection_hashes.target.file.md5 = "fd898c5a4cd57c3e9cef41f6fd4f71a7" or $selection_hashes.target.file.md5 = "9dab3dd7b7e7f4980397da908fbc9ff7" or $selection_hashes.target.file.md5 = "3eb5f44492ce1147790450d950954a52"))
<li><a href="#">events: ($selection_one.network.http.method = "post" and re.regex($selection_one.target.url, `.*/cgi-bin/mainfunction\.cgi`) and $selection_one.network.http.response_code = "200" and re.regex($selection_one.target.url, `.*action=login&keypath='/bin/cat${ifs}/etc/passwd'&loginuser=a&loginpwd=a.*`))
<li><a href="#">events: ($selection_reg1.metadata.product_event_type = "13" and $selection_reg1.target.registry.registry_key = "hklm\\system\\currentcontrolset\\control\\lsa\\security packages" and $selection_reg1.metadata.event_type = "setvalue")
<li><a href="#">events: ($selection_reg1.metadata.product_event_type = "13" and (re.regex($selection_reg1.target.registry.registry_key, `.*\\software\\microsoft\\windows nt\\currentversion\\image file execution options.*\\globalflag`) or re.regex($selection_reg1.target.registry.registry_key, `.*\\software\\microsoft\\windows nt\\currentversion\\silentprocessexit.*\\reportingmode`) or re.regex($selection_reg1.target.registry.registry_key, `.*\\software\\microsoft\\windows nt\\currentversion\\silentprocessexit.*\\monitorprocess`)) and $selection_reg1.metadata.event_type = "setvalue")
<li><a href="#">events: ($selection_reg1.metadata.product_event_type = "13" and re.regex($selection_reg1.target.registry.registry_key, `.*\\system\\currentcontrolset\\services\\rasman\\thirdparty\\dllname`) and $selection_reg1.metadata.event_type = "setvalue" and re.regex($selection_reg1.metadata.description, `.*\.dll`))
<li><a href="#">events: ($selection0.metadata.product_event_type = "1" and $selection0.target.process.command_line = "/injectrunning" and $selection0.target.process.file.full_path = "mavinject.exe")
<li><a href="#">events: ($selection0.metadata.product_event_type = "1" and $selection0.target.process.command_line = "'frombase\\'+0x40+\\'string\\'")
<li><a href="#">events: ($selection0.metadata.product_event_type = "8" and re.regex($selection0.target.process.file.file_metadata.pe.import_hash, `.*0b80`))
<li><a href="#">events: ($selection0.target.process.command_line = "net config" or $selection0.target.process.command_line = "net use" or $selection0.target.process.command_line = "net sessions" or $selection0.target.process.command_line = "net file" or $selection0.target.process.command_line = "net1 config" or $selection0.target.process.command_line = "net1 use" or $selection0.target.process.command_line = "net1 sessions" or $selection0.target.process.command_line = "net1 file" or $selection0.target.process.command_line = "netstat" or $selection0.target.process.command_line = "get-nettcpconnection")
<li><a href="#">events: ($selection1.metadata.event_type = "setvalue" and (re.regex($selection1.target.registry.registry_key, `.*\\currentversion\\run\\windows debug tools.*`) or (re.regex($selection1.target.registry.registry_key, `.*\\currentversion\\svchost\\netsvcs.*`) or re.regex($selection1.target.registry.registry_key, `.*\\dncp\\parameters\\servicedll.*`))))
<li><a href="#">events: ($selection1.metadata.product_event_type = "1" and $selection1.target.process.file.full_path = "c:\\windows\\system32\\findstr.exe" and (re.regex($selection1.target.process.command_line, `c:\\windows\\system32\\findstr\.exe -si pass.*`) or re.regex($selection1.target.process.command_line, `c:\\windows\\system32\\findstr\.exe -si user.*`)) and $selection1.src.process.file.full_path = "c:\\windows\\system32\\windowspowershell\\v1.0\\powershell.exe")
<li><a href="#">events: ($selection1.metadata.product_event_type = "1" and $selection1.target.process.file.full_path = "c:\\windows\\system32\\mshta.exe" and (re.regex($selection1.target.process.command_line, `mshta\.exe \".*\\appdata\\roaming\\microsoft\\windows\\start menu\\programs\\startup\\info\.hta\" `) or $selection1.target.process.command_line = "mshta.exe \"c:\\programdata\\microsoft\\windows\\start menu\\programs\\startup\\info.hta\"") and $selection1.metadata.product_event_type = "11" and ($selection1.target.file.full_path = "c:\\programdata\\microsoft\\windows\\start menu\\programs\\startup\\info.hta" or $selection1.target.file.full_path = "c:\\programdata\\microsoft\\windows\\start menu\\programs\\startup\\1data_second.bin" or re.regex($selection1.target.file.full_path, `c:\\users.*\\appdata\\roaming\\microsoft\\windows\\start menu\\programs\\startup\\1data_second\.bin`) or re.regex($selection1.target.file.full_path, `c:\\users.*\\appdata\\roaming\\microsoft\\windows\\start menu\\programs\\startup\\info\.hta`)) and $selection1.metadata.product_event_type = "13" and re.regex($selection1.target.registry.registry_key, `.*\\software\\microsoft\\windows\\currentversion\\run\\1data_second\.bin`) and $selection1.target.registry.registry_value_data = "c:\\windows\\ssytem32\\1data_second.bin" and re.regex($selection1.target.registry.registry_key, `.*\\software\\microsoft\\windows\\currentversion\\run\\c:\\windows\\ssytem32\\info\.hta`) and $selection1.target.registry.registry_value_data = "mshta.exe \"c:\\windows\\system32\\info.hta\"" and re.regex($selection1.target.registry.registry_key, `.*\\software\\microsoft\\windows\\currentversion\\run\\c:\\users.*\\appdata\\roaming\\info\.hta`) and re.regex($selection1.target.registry.registry_value_data, `mashta\.exe \"c:\\users.*\\appdata\\roaming\\info\.hta\"`))
<li><a href="#">events: ($selection1.metadata.product_event_type = "1" and $selection1.target.process.file.full_path = "c:\\windows\\system32\\regsvr32.exe" and re.regex($selection1.target.process.command_line, `regsvr32\.exe /s /u /i:.* .*\.dll`) and $selection1.src.process.file.full_path = "c:\\windows\\system32\\cmd.exe")
<li><a href="#">events: ($selection1.metadata.product_event_type = "1" and $selection1.target.process.file.full_path = "c:\\windows\\syswow64\\windowspowershell\\v1.0\\powershell.exe" and ($selection1.target.process.command_line = " powershell " or $selection1.target.process.command_line = "executionpolicy" or $selection1.target.process.command_line = "encodedcommand jab" or $selection1.target.process.command_line = "jab"))
<li><a href="#">events: ($selection1.metadata.product_event_type = "1" and ($selection1.target.process.file.full_path = "c:\\windows\\system32\\net.exe" or $selection1.target.process.file.full_path = "c:\\windows\\system32\\query.exe") and ($selection1.target.process.command_line = "net user" or $selection1.target.process.command_line = "net user /domain" or $selection1.target.process.command_line = "dir c:\\users\\" or $selection1.target.process.command_line = "cmdkey.exe /list" or $selection1.target.process.command_line = "net localgroup \"users\"" or $selection1.target.process.command_line = "net localgroup" or $selection1.target.process.command_line = "get-localuser" or $selection1.target.process.command_line = "get-localgroupmembers -group users" or $selection1.target.process.command_line = "ls c:/users" or $selection1.target.process.command_line = "get-childitem c:\\users\\" or re.regex($selection1.target.process.command_line, `get-aduser -filter .*`) or $selection1.target.process.command_line = "get-localgroup" or $selection1.target.process.command_line = "query user") and ($selection1.src.process.file.full_path = "c:\\windows\\system32\\windowspowershell\\v1.0\\powershell.exe" or $selection1.src.process.file.full_path = "c:\\windows\\system32\\cmd.exe"))
<li><a href="#">events: ($selection1.metadata.product_event_type = "1" and (($selection1.target.file.md5 = "c0202cf6aeab8437c638533d14563d35" or $selection1.target.file.md5 = "d348f536e214a47655af387408b4fca5" or $selection1.target.file.md5 = "958c594909933d4c82e93c22850194aa" or $selection1.target.file.md5 = "86c314bc2dc37ba84f7364acd5108c2b" or $selection1.target.file.md5 = "29340643ca2e6677c19e1d3bf351d654" or $selection1.target.file.md5 = "cb0c1248d3899358a375888bb4e8f3fe" or $selection1.target.file.md5 = "1354ac0d5be0c8d03f4e3aba78d2223e" or $selection1.target.file.md5 = "5ac0f050f93f86e69026faea1fbb4450" or $selection1.target.file.md5 = "965884f19026913b2c57b8cd4a86455a61383de01dabb69c557f45bb848f6c26" or $selection1.target.file.md5 = "b8fcd4a3902064907fb19e0da3ca7aed72a7e6d1f94d971d1ee7a4d3af6a800d" or $selection1.target.file.md5 = "795db7bdad1befdd3ad942be79715f6b0c5083d859901b81657b590c9628790f") or re.regex($selection1.target.process.command_line, `.*reg add \"hkey_current_user\\software\\microsoft\\windows\\currentversion\\run\" /v \"svchos\" /t reg_sz /d \"c:\\users\\admin\\appdata\\local.*`)))
<li><a href="#">events: ($selection1.metadata.product_event_type = "1" and (((($selection1.target.process.file.full_path = "c:\\windows\\syswow64\\fondue.exe" or $selection1.target.process.file.full_path = "c:\\windows\\system32\\fondue.exe" or $selection1.target.process.file.full_path = "c:\\windows\\system32\\optionalfeatures.exe") and ($selection1.target.process.command_line = "c:\\windows\\system32\\fondue.exe /enable-feature:netfx3 /caller-name:mscoreei.dll" or $selection1.target.process.command_line = "c:\\windows\\sysnative\\fondue.exe /enable-feature:netfx3 /caller-name:mscoreei.dll" or $selection1.target.process.command_line = "c:\\windows\\system32\\optionalfeatures.exe /enable-feature:netfx3 /caller-name:mscoreei.dll")) or ($selection1.target.process.file.full_path = "c:\\windows\\system32\\rundll32.exe" and re.regex($selection1.target.process.command_line, `c:\\windows\\system32\\rundll32\.exe c:\\windows\\system32\\shell32\.dll,shcreatelocalserverrundll .* -embedding`))) or ($selection1.target.process.file.full_path = "c:\\windows\\syswow64\\schtasks.exe" and re.regex($selection1.target.process.command_line, `c:\\windows\\system32\\schtasks\.exe /create /tn updates\\&startupname& /xml .*\\appdata\\local\\temp.*\.tmp`))))
<li><a href="#">events: ($selection1.metadata.product_event_type = "1" and ((re.regex($selection1.target.process.file.full_path, `.*\\mshta\.exe`) and (re.regex($selection1.target.process.command_line, `.*javascript.*`) or re.regex($selection1.target.process.command_line, `.*vbscript.*`) or re.regex($selection1.target.process.command_line, `.*\.hta.*`) or re.regex($selection1.target.process.command_line, `.*http.*`))) or (re.regex($selection1.target.process.file.full_path, `.*\\schtasks\.exe`) and re.regex($selection1.target.process.command_line, `.*/tr mshta\.exe.*`))))
<li><a href="#">events: ($selection1.metadata.product_event_type = "1" and re.regex($selection1.src.process.file.full_path, `.*\\microsoft office.*`) and ($selection1.target.process.file.full_path = "c:\\windows\\syswow64\\cmd.exe" or $selection1.target.process.file.full_path = "c:\\windows\\system32\\cmd.exe" or re.regex($selection1.target.process.file.full_path, `.*\\powershell\.exe`) or re.regex($selection1.target.process.file.full_path, `.*\.exe`)))
<li><a href="#">events: ($selection1.metadata.product_event_type = "1" and re.regex($selection1.target.process.file.full_path, `.*\\\\bash\.exe`))
<li><a href="#">events: ($selection1.metadata.product_event_type = "11" and ($selection1.target.file.full_path = "c:\\programdata\\mia4354.tmp" or $selection1.target.file.full_path = "c:\\programdata\\mia4354.tmp\\junipersetupclientinstaller.msi" or $selection1.target.file.full_path = "c:\\programdata\\mia4354.tmp\\offline\\9a189dfe\\c7b7c186" or $selection1.target.file.full_path = "c:\\programdata\\mia4354.tmp\\offline\\9a189dfe" or $selection1.target.file.full_path = "c:\\programdata\\mia4354.tmp\\offline" or $selection1.target.file.full_path = "c:\\programdata\\mia4354.tmp\\offline\\9a189dfe\\c7b7c186\\main.vbs" or $selection1.target.file.full_path = "c:\\programdata\\mia4354.tmp\\offline\\6908b9f2\\6a98a6df" or $selection1.target.file.full_path = "c:\\programdata\\mia4354.tmp\\offline\\6908b9f2" or $selection1.target.file.full_path = "c:\\programdata\\mia4354.tmp\\offline\\6908b9f2\\6a98a6df\\junipersetupclientinstaller.exe" or $selection1.target.file.full_path = "c:\\programdata\\mia4354.tmp\\junipersetupclientinstaller.exe" or $selection1.target.file.full_path = "c:\\programdata\\mia4354.tmp\\offline\\mmsi.dll" or $selection1.target.file.full_path = "c:\\programdata\\mia4354.tmp\\offline\\mmsi.dll\\mmsiexec.dll" or $selection1.target.file.full_path = "c:\\programdata\\mia4354.tmp\\mia.lib" or $selection1.target.file.full_path = "c:\\programdata\\mia4354.tmp\\junipersetupclientinstaller.res" or $selection1.target.file.full_path = "appdata\\roaming\\microsoft temperary" or $selection1.target.file.full_path = "appdata\\roaming\\microsoft temperary\\adbmanager.exe" or $selection1.target.file.full_path = "appdata\\local\\temp\\acro" or $selection1.target.file.full_path = "appdata\\roaming\\microsoft temperary\\adbtray.exe" or $selection1.target.file.full_path = "appdata\\local\\temp\\acro\\users" or $selection1.target.file.full_path = "appdata\\local\\temp\\acro\\users\\in" or $selection1.target.file.full_path = "c:\\users\\public\\libraries\\~windows\\wintrust.hlm" or $selection1.target.file.full_path = "c:\\users\\public\\libraries\\~windows" or $selection1.target.file.full_path = "appdata\\local\\temp\\acro\\users\\config.txt" or $selection1.target.file.full_path = "appdata\\roaming\\microsoft\\windows\\start menu\\programs\\certificate.ico" or $selection1.target.file.full_path = "appdata\\roaming\\microsoft temperary\\certificate managment.lnk" or $selection1.target.file.full_path = ""))
<li><a href="#">events: ($selection1.metadata.product_event_type = "11" and (re.regex($selection1.target.file.full_path, `.*\.ryk`) or $selection1.target.file.full_path = "ryukreadme.html"))
<li><a href="#">events: ($selection1.metadata.product_event_type = "11" and (re.regex($selection1.target.file.full_path, `.*\\desktop\\dns\\client\\x64\\release\\client\.pdb.*`) or re.regex($selection1.target.file.full_path, `.*\\rdat\\client\\x64\\release\\client\.pdb.*`) or re.regex($selection1.target.file.full_path, `.*\\programdata\\nt\.dat.*`)))
<li><a href="#">events: ($selection1.metadata.product_event_type = "11" and (re.regex($selection1.target.file.full_path, `.*appdata\\roaming\\svchoster\.exe.*`) or re.regex($selection1.target.file.full_path, `.*\.cov19.*`)))
<li><a href="#">events: ($selection1.metadata.product_event_type = "11" and (re.regex($selection1.target.file.full_path, `.*dd45\.exe.*`) or re.regex($selection1.target.file.full_path, `.*bthcxn\.exe.*`) or re.regex($selection1.target.file.full_path, `.*v86\.exe_.*`)))
<li><a href="#">events: ($selection1.metadata.product_event_type = "11" and (re.regex($selection1.target.file.full_path, `.*ecmd\.exe.*`) or re.regex($selection1.target.file.full_path, `.*ecmd\.exe.*`) or re.regex($selection1.target.file.full_path, `.*ecmd\.exe\.lnk.*`) or re.regex($selection1.target.file.full_path, `.*cf\.ini.*`)))
<li><a href="#">events: ($selection1.metadata.product_event_type = "11" and (re.regex($selection1.target.file.full_path, `.*nsexec\.dll.*`) or re.regex($selection1.target.file.full_path, `.*nseebfb\.tmp.*`) or re.regex($selection1.target.file.full_path, `.*chksrv\.vbs.*`) or re.regex($selection1.target.file.full_path, `.*scscan\.xml.*`) or re.regex($selection1.target.file.full_path, `.*anydesk\.exe.*`)))
<li><a href="#">events: ($selection1.metadata.product_event_type = "11" and re.regex($selection1.target.file.full_path, `.*-readme\.txt`) and $selection1.metadata.product_event_type = "1" and $selection1.target.process.file.full_path = "c:\\windows\\system32\\cmd.exe" and re.regex($selection1.target.process.command_line, `/c vssadmin\.exe delete shadows /all /quiet & bcdedit /set .* recoveryenabled no & bcdedit /set .* bootstatuspolicy ignoreallfailures`))
<li><a href="#">events: ($selection1.metadata.product_event_type = "13" and (re.regex($selection1.target.registry.registry_key, `.*\\defaultobjectstore\\lrulist\\.*`) or re.regex($selection1.target.registry.registry_key, `.*\\defaultobjectstore\\lrulist\\00000000000002fc\\.*`) or re.regex($selection1.target.registry.registry_key, `.*\\defaultobjectstore\\objecttable\\e8\\.*`) or re.regex($selection1.target.registry.registry_key, `.*\\defaultobjectstore\\objecttable\\e9\\.*`) or re.regex($selection1.target.registry.registry_key, `.*\\currentversion\\networklist\\nla\\cache\\intranet\\.*`)))
<li><a href="#">events: ($selection1.metadata.product_event_type = "13" and (re.regex($selection1.target.registry.registry_key, `.*\\software\\microsoft\\windows\\currentversion\\run.*`) or re.regex($selection1.target.registry.registry_key, `.*\\software\\microsoft\\windows\\currentversion\\explorer\\user shell folders.*`)) and (re.regex($selection1.metadata.description, `.* rundll32 c:\\users.*\\appdata\\local\\temp\\cred\.dll, main.*`) or re.regex($selection1.metadata.description, `.* rundll32 c:\\users.*\\appdata\\local\\temp.*\.dll, main.*`) or re.regex($selection1.metadata.description, `.*c:\\programdata\\87e4c89e95.*`) or re.regex($selection1.metadata.description, `.*c:\\programdata\\87.*`)))
<li><a href="#">events: ($selection1.metadata.product_event_type = "13" and (re.regex($selection1.target.registry.registry_key, `.*system\\.*controlset.*\\control\\lsa\\lmcompatibilitylevel`) or re.regex($selection1.target.registry.registry_key, `.*system\\.*controlset.*\\control\\lsa\\ntlmminclientsec`) or re.regex($selection1.target.registry.registry_key, `.*system\\.*controlset.*\\control\\lsa\\restrictsendingntlmtraffic`)))
<li><a href="#">events: ($selection1.metadata.product_event_type = "3" and re.regex($selection1.target.process.file.full_path, `.*powershell\.exe`) and re.regex($selection1.principal.port, `.*`) and $selection1.target.port = "5985")
<li><a href="#">events: ($selection1.metadata.product_event_type = "4" or $selection1.metadata.product_event_type = "16")
<li><a href="#">events: ($selection1.network.http.method = "get" and (re.regex($selection1.target.url, `.*/ecp/.*`) or re.regex($selection1.target.url, `.*/owa/.*`)) and re.regex($selection1.target.url, `.*__viewstate=.*`))
<li><a href="#">events: ($selection1.target.process.file.full_path = "cmd.exe" and ($selection1.metadata.product_event_type = "4688" or $selection1.metadata.product_event_type = "1") and ((re.regex($selection1.target.process.command_line, `.* cmd /c mofcomp\.exe c:\\windows\\temp.*\.rar .*`) or re.regex($selection1.target.process.command_line, `.* cmd /c del c:\\windows\\temp.*\.rar .*`) or re.regex($selection1.target.process.command_line, `.* cmd /c mofcomp\.exe c:\\windows\\temp.*\..* .*`) or re.regex($selection1.target.process.command_line, `.* cmd /c del c:\\windows\\temp.*\..* .*`)) or (re.regex($selection1.target.process.command_line, `.* cmd /c mofcomp\.exe c:\\users.*\\appdata\\local\\temp.*\..* .*`) or re.regex($selection1.target.process.command_line, `.* cmd /c del c:\\users.*\\appdata\\local\\temp.*\..* .*`))))
<li><a href="#">events: ($selection1.target.process.file.full_path = "cmd.exe" and (re.regex($selection1.target.process.command_line, `cmd\.exe & /c cd c:/ & msiexec\.exe /i http.*://lcodigo\.com/apiw/config/uploads/tmp/.*\.msi /quiet`) or re.regex($selection1.target.process.command_line, `cmd\.exe & /c cd c:/ & msiexec\.exe /i http.*://.*\.com/api.*/config/uploads/tmp/.*\.msi /quiet`)) and ($selection1.metadata.product_event_type = "4688" or $selection1.metadata.product_event_type = "1"))
<li><a href="#">events: ($selection1.target.process.file.full_path = "ping.exe" and (re.regex($selection1.target.process.command_line, `.* for /l %i in \(1,1,254\) do ping -n 1 -w 100 192\.168\.1\.%i .*`) or re.regex($selection1.target.process.command_line, `.*for /l %i in \(1,1,254\) do ping -n 1 -w 100 .*\..*\..*\.%i.*`)) and ($selection1.metadata.product_event_type = "4688" or $selection1.metadata.product_event_type = "1"))
<li><a href="#">events: ($selection1.target.process.file.full_path = "reg.exe" and ($selection1.target.process.command_line = "reg query hklm /f password /t reg_sz /s" or $selection1.target.process.command_line = "reg query hkcu /f password /t reg_sz /s") and ($selection1.metadata.product_event_type = "4688" or $selection1.metadata.product_event_type = "1"))
<li><a href="#">events: ($selection1.target.process.file.full_path = "reg.exe" and ($selection1.target.process.command_line = "reg save hklm\\sam c:\\programdata\\sambkup.hiv" or $selection1.target.process.command_line = "reg save hklm\\system c:\\programdata\\filename.hiv") and ($selection1.metadata.product_event_type = "4688" or $selection1.metadata.product_event_type = "1"))
<li><a href="#">events: ($selection1.target.process.file.full_path = "wscript.exe" and re.regex($selection1.target.process.command_line, `wscript\.exe c:\\users.*\\appdata\\local\\temp\\temp1_chrome\.update\.b343b0\.zip\\chrome\.update\.c9a747\.js`) and ($selection1.metadata.product_event_type = "4688" or $selection1.metadata.product_event_type = "1"))
<li><a href="#">events: ($selection2.metadata.product_event_type = "4657" and (re.regex($selection2.target.registry.registry_value_data, `registry\\machine\\system\\.*controlset.*\\control\\lsa`) or re.regex($selection2.target.file.full_path, `registry\\machine\\system\\.*controlset.*\\control\\lsa`)) and ($selection2.target.registry.registry_value_name = "lmcompatibilitylevel" or $selection2.target.registry.registry_value_name = "ntlmminclientsec" or $selection2.target.registry.registry_value_name = "restrictsendingntlmtraffic"))
<li><a href="#">events: ($selection2.target.process.command_line = "cmd.exe /c wbadmin delete systemstatebackup -keepversions:0" and ($selection2.metadata.product_event_type = "4688" or $selection2.metadata.product_event_type = "1"))
<li><a href="#">events: ($selectionurl.target.url = "" or $selectionurl.target.url = "" or $selectionurl.target.url = "" or $selectionurl.target.url = "" or $selectionurl.target.url = "" or $selectionurl.target.url = "" or $selectionurl.target.url = "" or $selectionurl.target.url = "" or $selectionurl.target.url = "" or $selectionurl.target.url = "")
<li><a href="#">events: ($selectionurl.target.url = "" or $selectionurl.target.url = "" or re.regex($selectionurl.target.url, `\.105\.6\.230//servlet/.*`) or $selectionurl.target.url = "")
<li><a href="#">events: ($selector.metadata.product_event_type = "19" or $selector.metadata.product_event_type = "20" or $selector.metadata.product_event_type = "21")
<li><a href="#">events: ($service_installation.metadata.product_event_type = "7045" and $service_installation.target.process.command_line = "btobto" and re.regex($service_installation.target.process.command_line, `.*\\execute\.bat`))
<li><a href="#">events: ($sysmon_klistpurge.metadata.product_event_type = "1" and re.regex($sysmon_klistpurge.target.process.command_line, `klist.*purge`))
<li><a href="#">events: ($sysmon_remoterdpenable.metadata.product_event_type = "1" and re.regex($sysmon_remoterdpenable.target.process.file.full_path, `.*\\reg\.exe`) and $sysmon_remoterdpenable.target.process.command_line = "\"reg\" add \"hkey_local_machine\\system\\currentcontrolset\\control\\terminal server\" /v fdenytsconnections /t reg_dword /d 0 /f" and re.regex($sysmon_remoterdpenable.src.process.command_line, `.*\\psexesvc\.exe`))
<li><a href="#">events: (($methregistry.metadata.product_event_type = "13" and re.regex($methregistry.target.registry.registry_key, `hkey_users\\.*\\mscfile\\shell\\open\\command`)) or (($methregistry.metadata.product_event_type = "1" and re.regex($methregistry.src.process.file.full_path, `.*\\eventvwr\.exe`)) and not (re.regex($methregistry.target.process.file.full_path, `.*\\mmc\.exe`))))
<li><a href="#">events: (($netcat_shell.target.process.command_line = "netcat" or $netcat_shell.target.process.command_line = "nc") and (($netcat_shell.network.direction = "listening" or $netcat_shell.network.direction = "outbound" or $netcat_shell.network.direction = "outgoing") or ($netcat_shell.target.process.command_line = "-e" or $netcat_shell.target.process.command_line = "/bin/bash" or $netcat_shell.target.process.command_line = "/bin/sh" or $netcat_shell.target.process.command_line = "-nv")))
<li><a href="#">events: (($selection.metadata.description = "execute processes remotely" and $selection.metadata.product_name = "sysinternals psexec") and not ((re.regex($selection.target.process.file.full_path, `.*\\psexec\.exe`) or re.regex($selection.target.process.file.full_path, `.*\\psexec64\.exe`))))
<li><a href="#">events: (($selection.metadata.description = "windows powershell" and $selection.metadata.description = "microsoft corporation") and not (re.regex($selection.target.process.file.full_path, `.*\\powershell\.exe`)))
<li><a href="#">events: (($selection.metadata.description = "windows powershell" and ($selection.metadata.product_event_type = "4688" or $selection.metadata.product_event_type = "1")) and not (((re.regex($selection.target.process.file.full_path, `.*\\powershell\.exe`) or re.regex($selection.target.process.file.full_path, `.*\\powershell_ise\.exe`)) or $selection.metadata.description = "windows powershell ise")))
<li><a href="#">events: (($selection.metadata.product_event_type = "1" and $selection.src.process.file.full_path = "paymen45.exe" and $selection.target.process.file.full_path = "c:\\windows\\system32\\vssadmin.exe" and $selection.target.process.command_line = "vssadmin delete shadows /all /quiet") or ($selection.metadata.product_event_type = "11" and $selection.target.process.file.full_path = "paymen45.exe" and ($selection.target.file.full_path = "c:\\users\\admin\\appdata\\local\\virtualstore\\program files\\adobe\\acrobat reader dc\\esl eadme.txt" or $selection.target.file.full_path = "c:\\users\\admin\\desktop eadme.txt")) or ($selection.target.file.md5 = "4b12f4fdf07d06fb59b5619d01a293c51d32efd183d45a87459b47d5169cfe51" or $selection.target.file.md5 = "f9dc9848892b3c1ca620a7a69cce4ff5bbf03cdfd0ad12f348973ea76d4d125e"))
<li><a href="#">events: (($selection.metadata.product_event_type = "1" and $selection.target.process.file.full_path = "svchost.exe") and not ($selection.metadata.product_event_type = "1" and (re.regex($selection.target.process.command_line, `.*\\services\.exe`) or re.regex($selection.target.process.command_line, `.*\\msmpeng\.exe`))))
<li><a href="#">events: (($selection.metadata.product_event_type = "1" and ($selection.target.file.md5 = "9bc365a16c63f25dfddcbe11da042974" or $selection.target.file.md5 = "da93e6651c5ba3e3e96f4ae2dd763d94" or $selection.target.file.md5 = "6ccd8133f250d4babefbd66b898739b9" or $selection.target.file.md5 = "abe771f280cdea6e7eaf19a26b1a9488" or $selection.target.file.md5 = "b60da65b8d3627a89481efb23d59713a" or $selection.target.file.md5 = "b94bdb63f0703d32c20f4b2e5500dbbe" or $selection.target.file.md5 = "bb5e8733a940fedfb1ef6b0e0ec3635c" or $selection.target.file.md5 = "97ddc336d7d92b7db17d098ec2ee6092" or $selection.target.file.md5 = "1d0cf431e623b21aeae8f2b8414d2a73" or $selection.target.file.md5 = "0e7b32d23fbd6d62a593c234bafa2311" or $selection.target.file.md5 = "e2e102291d259f054625cc85318b7ef5" or $selection.target.file.md5 = "0c6ddc3a722b865cc2d1185e27cef9b8" or $selection.target.file.md5 = "54b06b05b6b92a8f2ff02fdf47baad0e" or $selection.target.file.md5 = "4247901eca6d87f5f3af7df8249ea825")) or ($selection.metadata.product_event_type = "13" and (re.regex($selection.target.registry.registry_key, `.*\\software\\policies\\microsoft\\windows\\powershell\\scriptblocklogging\\enablescriptblocklogging`) or re.regex($selection.target.registry.registry_key, `.*\\software\\policies\\microsoft\\windows\\powershell\\scriptblocklogging\\enablescriptblockinvocationlogging`)) and $selection.metadata.description = "0" and $selection.metadata.event_type = "setvalue"))
<li><a href="#">events: (($selection.metadata.product_event_type = "1" and ((re.regex($selection.target.process.file.full_path, `.*/powershell\.exe`) and re.regex($selection.target.process.command_line, `powershell -e .*[net\.servicepointmanager]::\\\"securityprotocol\\\" = .*split\\\"\([char]42\);.*downloadfile\\\".* {\([wmiclass]'win32_process'\)\.\\\"create\\\".*}}catch{}}.*`)) or (re.regex($selection.src.process.file.full_path, `c:\\users\\.*\\988\.exe`) and re.regex($selection.target.process.file.full_path, `c:\\users\\.*\\appdata\\local\\wmidx\\tsbyuv\.exe`)))) or ($selection.metadata.product_event_type = "13" and re.regex($selection.target.process.file.full_path, `.*\\tsbyuv\.exe`) and $selection.target.registry.registry_key = "hkey_current_user\\software\\microsoft\\windows\\currentversion\\run" and re.regex($selection.target.registry.registry_value_data, `\"c:\\users\\.*\\appdata\\local\\wmidx\\tsbyuv\.exe\\\"`)) or ($selection.target.file.md5 = "5d2c6110f2ea87a6b7fe9256affbac0eebdeee18081d59e05df4b4a17417492b" or $selection.target.file.md5 = "4fdff0ebd50d37a32eb5c3a1b2009cb9764e679d8ee95ca7551815b7e8406206" or $selection.target.file.md5 = "bb5602ea74258ccad36d28f6a5315d07fbeb442a02d0c91b39ca6ba0a0fe71a2" or $selection.target.file.md5 = "6d86e68c160b25d25765a4f1a2f8f1f032b2d5cb0d1f39d1d504eeaa69492de0" or $selection.target.file.md5 = "18fab1420a6a968e88909793b3d87af2e8e1e968bf7279d981276a2aa8aa678e" or $selection.target.file.md5 = "d5213404d4cc40494af138f8051b01ec3f1856b72de3e24f75aca8c024783e89"))
<li><a href="#">events: (($selection.metadata.product_event_type = "1" and (re.regex($selection.target.process.command_line, `icacls \"c:.*\" /grant everyone:f /t /c /q`) or $selection.target.process.command_line = "\"c:\\windows\\system32\\net.exe\" stop \"audioendpointbuilder\" /y" or $selection.target.process.command_line = "\"c:\\windows\\system32\\net.exe\" stop \"samss\" /y")) or ($selection.metadata.product_event_type = "11" and (re.regex($selection.target.file.full_path, `c:\\users.*\\pictures.*\.ryk`) or $selection.target.file.full_path = "c:\\users\\admin\\appdata\\roaming\\microsoft\\word\\startup\\ryukreadme.html")))
<li><a href="#">events: (($selection.metadata.product_event_type = "1" and re.regex($selection.src.process.file.full_path, `.*\\winword\.exe`) and re.regex($selection.target.process.file.full_path, `.*\\cmd\.exe`) and re.regex($selection.src.process.file.full_path, `.*\\cmd\.exe`) and re.regex($selection.target.process.file.full_path, `.*\\reg\.exe`) and $selection.target.process.command_line = "reg delete \"hkcu\\software\\microsoft\\office\\14.0\\word\\resiliency\" /f" and $selection.metadata.product_event_type = "11" and re.regex($selection.target.process.file.full_path, `.*\\winword\.exe`) and re.regex($selection.target.file.full_path, `.*\\appdata\\local\\temp\\20200323-sitrep-63-covid-19\.doc`) and $selection.metadata.product_event_type = "3" and $selection.target.process.file.full_path = "c:\\users\\admin\\appdata\\local\\svchost.exe") or (($selection.target.file.md5 = "2779863a173ff975148cb3156ee593cb5719a0ab238ea7c9e0b0ca3b5a4a9326" or $selection.target.file.md5 = "62d38f19e67013ce7b2a84cb17362c77e2f13134ee3f8743cbadde818483e617" or $selection.target.file.md5 = "fa84ee006b205f105df40dd2abcf238653f8cef0" or $selection.target.file.md5 = "994a67d5d6341173ad95bc6f5d795fd0") or $selection.target.ip = "31.170.167.123"))
<li><a href="#">events: (($selection.metadata.product_event_type = "1" and re.regex($selection.target.process.file.full_path, `.*\\acrord32\.exe`)) and not (re.regex($selection.target.process.file.full_path, `.*\\adobe\\acrobat reader dc\\reader\\acrord32\.exe`)))
<li><a href="#">events: (($selection.metadata.product_event_type = "1" or $selection.metadata.product_event_type = "4688") and $selection.target.process.command_line = "schtasks" and $selection.target.process.command_line = "/change" and $selection.target.process.command_line = "/tn" and $selection.target.process.command_line = "/ru" and $selection.target.process.command_line = "/rp")
<li><a href="#">events: (($selection.metadata.product_event_type = "3" and ($selection.target.port = "4443" or $selection.target.port = "2448" or $selection.target.port = "8143" or $selection.target.port = "1777" or $selection.target.port = "1443" or $selection.target.port = "243" or $selection.target.port = "65535" or $selection.target.port = "13506" or $selection.target.port = "3360" or $selection.target.port = "200" or $selection.target.port = "198" or $selection.target.port = "49180" or $selection.target.port = "13507" or $selection.target.port = "6625" or $selection.target.port = "4444" or $selection.target.port = "4438" or $selection.target.port = "1904" or $selection.target.port = "13505" or $selection.target.port = "13504" or $selection.target.port = "12102" or $selection.target.port = "9631" or $selection.target.port = "5445" or $selection.target.port = "2443" or $selection.target.port = "777" or $selection.target.port = "13394" or $selection.target.port = "13145" or $selection.target.port = "12103" or $selection.target.port = "5552" or $selection.target.port = "3939" or $selection.target.port = "3675" or $selection.target.port = "666" or $selection.target.port = "473" or $selection.target.port = "5649" or $selection.target.port = "4455" or $selection.target.port = "4433" or $selection.target.port = "1817" or $selection.target.port = "100" or $selection.target.port = "65520" or $selection.target.port = "1960" or $selection.target.port = "1515" or $selection.target.port = "743" or $selection.target.port = "700" or $selection.target.port = "14154" or $selection.target.port = "14103" or $selection.target.port = "14102" or $selection.target.port = "12322" or $selection.target.port = "10101" or $selection.target.port = "7210" or $selection.target.port = "4040" or $selection.target.port = "9943")) and not ((re.regex($selection.target.process.file.full_path, `.*\\program files.*`) or ((re.regex($selection.target.ip, `10\..*`) or re.regex($selection.target.ip, `192\.168\..*`) or re.regex($selection.target.ip, `172\.16\..*`) or re.regex($selection.target.ip, `172\.17\..*`) or re.regex($selection.target.ip, `172\.18\..*`) or re.regex($selection.target.ip, `172\.19\..*`) or re.regex($selection.target.ip, `172\.20\..*`) or re.regex($selection.target.ip, `172\.21\..*`) or re.regex($selection.target.ip, `172\.22\..*`) or re.regex($selection.target.ip, `172\.23\..*`) or re.regex($selection.target.ip, `172\.24\..*`) or re.regex($selection.target.ip, `172\.25\..*`) or re.regex($selection.target.ip, `172\.26\..*`) or re.regex($selection.target.ip, `172\.27\..*`) or re.regex($selection.target.ip, `172\.28\..*`) or re.regex($selection.target.ip, `172\.29\..*`) or re.regex($selection.target.ip, `172\.30\..*`) or re.regex($selection.target.ip, `172\.31\..*`) or re.regex($selection.target.ip, `127\..*`)) and $selection.target.ip = "false"))))
<li><a href="#">events: (($selection.metadata.product_event_type = "3" and re.regex($selection.target.process.file.full_path, `.*\\powershell\.exe`)) and not ((re.regex($selection.target.ip, `10\..*`) or re.regex($selection.target.ip, `192\.168\..*`) or re.regex($selection.target.ip, `172\..*`) or $selection.target.ip = "127.0.0.1") and $selection.target.ip = "false" and $selection.src.user.user_display_name = "nt authority\\system"))
<li><a href="#">events: (($selection.metadata.product_event_type = "3" and re.regex($selection.target.process.file.full_path, `.*\\rundll32\.exe`)) and not ((re.regex($selection.target.ip, `10\..*`) or re.regex($selection.target.ip, `192\.168\..*`) or re.regex($selection.target.ip, `172\..*`))))
<li><a href="#">events: (($selection.metadata.product_event_type = "4625" or $selection.metadata.product_event_type = "4776") and ($selection.security_result.description = "0xc0000072" or $selection.security_result.description = "0xc000006f" or $selection.security_result.description = "0xc0000070" or $selection.security_result.description = "0xc0000413" or $selection.security_result.description = "0xc000018c"))
<li><a href="#">events: (($selection.metadata.product_event_type = "4656" or $selection.metadata.product_event_type = "4663" or $selection.metadata.product_event_type = "4658") and ((re.regex($selection.target.registry.registry_value_data, `.*\.aaa`) or re.regex($selection.target.registry.registry_value_data, `.*\.zzz`)) or (re.regex($selection.target.file.full_path, `.*\.aaa`) or re.regex($selection.target.file.full_path, `.*\.zzz`))))
<li><a href="#">events: (($selection.metadata.product_event_type = "4662" and $selection.target.process.access_mask = "0x100" and (re.regex($selection.target.process.file.file_metadata.pe.import_hash, `.*1131f6aa-9c07-11d1-f79f-00c04fc2dcd2.*`) or re.regex($selection.target.process.file.file_metadata.pe.import_hash, `.*1131f6ad-9c07-11d1-f79f-00c04fc2dcd2.*`) or re.regex($selection.target.process.file.file_metadata.pe.import_hash, `.*89e95b76-444d-4c62-991a-0facbeda640c.*`))) and not (re.regex($selection.src.user.user_display_name, `.*$`)))
<li><a href="#">events: (($selection.metadata.product_event_type = "5140" and $selection.target.resource.name = "admin$") and not (re.regex($selection.src.user.user_display_name, `.*$`)))
<li><a href="#">events: (($selection.metadata.product_event_type = "56" or $selection.metadata.product_event_type = "50") and $selection.src.application = "termdd")
<li><a href="#">events: (($selection.metadata.product_event_type = "675" or $selection.metadata.product_event_type = "4768" or $selection.metadata.product_event_type = "4769" or $selection.metadata.product_event_type = "4771") and ($selection.security_result.description = "0x9" or $selection.security_result.description = "0xa" or $selection.security_result.description = "0xb" or $selection.security_result.description = "0xf" or $selection.security_result.description = "0x10" or $selection.security_result.description = "0x11" or $selection.security_result.description = "0x13" or $selection.security_result.description = "0x14" or $selection.security_result.description = "0x1a" or $selection.security_result.description = "0x1f" or $selection.security_result.description = "0x21" or $selection.security_result.description = "0x22" or $selection.security_result.description = "0x23" or $selection.security_result.description = "0x24" or $selection.security_result.description = "0x26" or $selection.security_result.description = "0x27" or $selection.security_result.description = "0x28" or $selection.security_result.description = "0x29" or $selection.security_result.description = "0x2c" or $selection.security_result.description = "0x2d" or $selection.security_result.description = "0x2e" or $selection.security_result.description = "0x2f" or $selection.security_result.description = "0x31" or $selection.security_result.description = "0x32" or $selection.security_result.description = "0x3e" or $selection.security_result.description = "0x3f" or $selection.security_result.description = "0x40" or $selection.security_result.description = "0x41" or $selection.security_result.description = "0x43" or $selection.security_result.description = "0x44"))
<li><a href="#">events: (($selection.metadata.product_event_type = "7" and re.regex($selection.target.process.file.full_path, `.*notepad\+\+\.exe`) and re.regex($selection.target.process.file.full_path, `.*dbghelp\.dll`)) and not (re.regex($selection.target.process.file.full_path, `.*windows\\system32.*`)))
<li><a href="#">events: (($selection.network.http.method = "get" and re.regex($selection.target.url, `.*\?manifest=wac`) and $selection.principal.hostname = "onedrive.live.com") and not (re.regex($selection.target.url, `http.*://onedrive\.live\.com/.*`)))
<li><a href="#">events: (($selection.network.http.method = "post" and $selection.network.http.response_code = "200" and (re.regex($selection.target.url, `.*/webshell/shell\.php`) or re.regex($selection.target.url, `.*/webshell/shell\.php\?ganteng`)) and ($selection.target.url = "passwrd=rabiitch&action=login&hide=&usrname=rabiitch" or $selection.target.url = "key=password&method=1&submit=submit")) or $selection.target.file.md5 = "5fdbf87b7f74327e9132b5edb5c217bdcf49fe275945d502ad675c1dd46e3db5")
<li><a href="#">events: (($selection.src.application = "mozilla/4.0 (compatible; msie 5.0; windows 98)" or $selection.src.application = "pony" or $selection.src.application = "zapoy") and re.regex($selection.target.url, `.*/gate/php`))
<li><a href="#">events: (($selection.src.application = "user-agent" or re.regex($selection.src.application, `.* \(compatible;msie .*`) or re.regex($selection.src.application, `.*\.0;windows nt .*`) or re.regex($selection.src.application, `mozilla/3\.0 .*`) or re.regex($selection.src.application, `mozilla/2\.0 .*`) or re.regex($selection.src.application, `mozilla/1\.0 .*`) or re.regex($selection.src.application, `mozilla .*`) or re.regex($selection.src.application, ` mozilla/.*`) or re.regex($selection.src.application, `mozila/.*`) or $selection.src.application = "_" or $selection.src.application = "certutil url agent" or $selection.src.application = "mozilla/5.0 (windows nt 10.0; win64; x64; rv:60.0)" or $selection.src.application = "mozilla/5.0 (windows nt 6.3; wow64; rv:28.0) gecko/20100101 firefox/28.0") and not (re.regex($selection.src.application, `mozilla/3\.0 .* acrobat .*`)))
<li><a href="#">events: (($selection.src.hostname = "gocgle-analytics.net" or $selection.src.hostname = "googlo-analytics.com" or $selection.src.hostname = "gocgletagmanager.com" or $selection.src.hostname = "googlc-analytics.com" or $selection.src.hostname = "gocgle-analytics.cm" or $selection.src.hostname = "gocgletagmanager.cm" or $selection.src.hostname = "gocgle-analytics.com" or $selection.src.hostname = "analytic.is" or $selection.src.hostname = "qdtf54y6eu7i87t.ga") or ($selection.target.ip = "5.188.9.61" or $selection.target.ip = "5.188.9.33" or $selection.target.ip = "5.188.9.40" or $selection.target.ip = "194.180.224.112"))
<li><a href="#">events: (($selection.target.file.full_path = "corona virus affected crew and vessel.xlsm" or $selection.target.file.full_path = "coronavirussafetymeasures_pdf.exe" or $selection.target.file.full_path = "coronavirussafetymeasures_xls.exe" or $selection.target.file.full_path = "list of corona virus victim.exe" or $selection.target.file.full_path = "poea health advisory re-2020 novel corona virus.pdf.exe" or $selection.target.file.full_path = "poea advisories re-2020 novel corona virus.2.pdf.exe") or ($selection.target.file.md5 = "ab533d6ca0c2be8860a0f7fbfc7820ffd595edc63e540ff4c5991808da6a257d" or $selection.target.file.md5 = "17161e0ab3907f637c2202a384de67fca49171c79b1b24db7c78a4680637e3d5" or $selection.target.file.md5 = "315e297ac510f3f2a60176f9c12fcf92681bbad758135767ba805cdea830b9ee" or $selection.target.file.md5 = "c9c0180eba2a712f1aba1303b90cbf12c1117451ce13b68715931abc437b10cd" or $selection.target.file.md5 = "29367502e16bf1e2b788705014d0142d8bcb7fcc6a47d56fb82d7e333454e923" or $selection.target.file.md5 = "3f40d4a0d0fe1eea58fa1c71308431b5c2ce6e381cacc7291e501f4eed57bfd2" or $selection.target.file.md5 = "3e6166a6961bc7c23d316ea9bca87d8287a4044865c3e73064054e805ef5ca1a" or $selection.target.file.md5 = "b78a3d21325d3db7470fbf1a6d254e23d349531fca4d7f458b33ca93c91e61cd" or $selection.target.file.md5 = "2b35aa9c70ef66197abfb9bc409952897f9f70818633ab43da85b3825b256307" or $selection.target.file.md5 = "0b3e7faa3ad28853bb2b2ef188b310a67663a96544076cd71c32ac088f9af74d" or $selection.target.file.md5 = "13c0165703482dd521e1c1185838a6a12ed5e980e7951a130444cf2feed1102e" or $selection.target.file.md5 = "fda64c0ac9be3d10c28035d12ac0f63d85bb0733e78fe634a51474c83d0a0df8" or $selection.target.file.md5 = "126569286f8a4caeeaba372c0bdba93a9b0639beaad9c250b8223f8ecc1e8040" or $selection.target.file.md5 = "b9e5849d3ad904d0a8532a886bd3630c4eec3a6faf0cc68658f5ee4a5e803be" or $selection.target.file.md5 = "6cc5e1e72411c4f4b2033ddafe61fdb567cb0e17ba7a3247acd60cbd4bc57bfb" or $selection.target.file.md5 = "7c12951672fb903f520136d191f3537bc74f832c5fc573909df4c7fa85c15105" or $selection.target.file.md5 = "dd6cf8e8a31f67101f974151333be2f0d674e170edd624ef9b850e3ee8698fa2"))
<li><a href="#">events: (($selection.target.file.md5 = "5ac0f050f93f86e69026faea1fbb4450" or $selection.target.file.md5 = "6cdcb9f86972efc4cfce4b06b6be053a" or $selection.target.file.md5 = "31bd0f224e7e74eee2847f43aae23974") and $selection.metadata.product_event_type = "1")
<li><a href="#">events: (($selection.target.file.md5 = "6834b1b94e49701d77ccb3c0895e1afd" and ($selection.metadata.product_event_type = "4688" or $selection.metadata.product_event_type = "1")) and not (re.regex($selection.target.process.file.full_path, `.*\\dctask64\.exe`)))
<li><a href="#">events: (($selection.target.process.command_line = "^h^t^t^p" or $selection.target.process.command_line = "h\"t\"t\"p") and ($selection.metadata.product_event_type = "4688" or $selection.metadata.product_event_type = "1"))
<li><a href="#">events: (($selection.target.process.command_line = "net group \"domain admins\" /domain" or $selection.target.process.command_line = "net localgroup administrators") and ($selection.metadata.product_event_type = "4688" or $selection.metadata.product_event_type = "1"))
<li><a href="#">events: (($selection.target.process.command_line = "tasklist.exe" or re.regex($selection.target.process.command_line, `get-process.*`)) and ($selection.metadata.product_event_type = "4688" or $selection.metadata.product_event_type = "1"))
<li><a href="#">events: (($selection.target.process.command_line = "vssadmin.exe delete shadows" or $selection.target.process.command_line = "vssadmin create shadow /for=c:" or re.regex($selection.target.process.command_line, `copy \\\\\?\\globalroot\\device\\.*\\windows\\ntds\\ntds\.dit`) or re.regex($selection.target.process.command_line, `copy \\\\\?\\globalroot\\device\\.*\\config\\sam`) or $selection.target.process.command_line = "vssadmin delete shadows /for=c:" or $selection.target.process.command_line = "reg save hklm\\system " or re.regex($selection.target.process.command_line, `esentutl\.exe /y /vss .*\\ntds\.dit.*`)) and ($selection.metadata.product_event_type = "4688" or $selection.metadata.product_event_type = "1"))
<li><a href="#">events: (($selection.target.process.command_line = "winrs -r" or $selection.target.process.command_line = "winrs /r") and ($selection.metadata.product_event_type = "4688" or $selection.metadata.product_event_type = "1"))
<li><a href="#">events: (($selection.target.process.file.full_path = "c:\\windows\\system32\\dllhost.exe" and re.regex($selection.src.process.file.full_path, `.*\\v\.exe`)) or re.regex($selection.src.hostname, `.*shehig\.com.*`))
<li><a href="#">events: (($selection.target.process.file.full_path = "cmd.exe" or $selection.target.process.file.full_path = "powershell.exe") and ($selection.target.process.command_line = "wmic os list full" or $selection.target.process.command_line = "wmic computersystem list full" or $selection.target.process.command_line = "wmic /namespace:\\\\root\\securitycenter2 path antivirusproduct" or $selection.target.process.command_line = "wmic path win32_pnpdevice" or $selection.target.process.command_line = "wmic qfe list brief" or re.regex($selection.target.process.command_line, `wmic datafile where \"path='\\\\users\\\\test\\\\documents\\\\'\" get .*`) or re.regex($selection.target.process.command_line, `wmic datafile where \"drive='c:' and name like '%password%'\" get .*`) or re.regex($selection.target.process.command_line, `wmic useraccount get .*`) or $selection.target.process.command_line = "wmic ntdomain get domaincontrolleraddress,domainname,roles /value" or re.regex($selection.target.process.command_line, `wmic /namespace:\\\\root\\directory\\ldap path ds_user where .*`) or $selection.target.process.command_line = "wmic /namespace:\\\\root\\directory\\ldap path ds_user get ds_samaccountname" or $selection.target.process.command_line = "wmic /namespace:\\\\root\\directory\\ldap path ds_group get ds_samaccountname" or $selection.target.process.command_line = "wmic /namespace:\\\\root\\directory\\ldap path ds_group where \"ds_samaccountname='domain admins'\" get ds_member /value" or re.regex($selection.target.process.command_line, `wmic path win32_groupuser where \(groupcomponent=\"win32_group\.name=\"domain admins\",domain .*\"\)`) or $selection.target.process.command_line = "wmic /namespace:\\\\root\\directory\\ldap path ds_computer get ds_samaccountname" or $selection.target.process.command_line = "wmic /namespace:\\\\root\\directory\\ldap path ds_computer get ds_dnshostname"))
<li><a href="#">events: (($selection.target.url = "a.vollar.ga" or $selection.target.url = "aa.vollar.ga" or $selection.target.url = "b.vollar.ga" or $selection.target.url = "c.vollar.ga" or $selection.target.url = "ca.vollar.gad.vollar.ga" or $selection.target.url = "da.vollar.ga" or $selection.target.url = "f.vollar.ga" or $selection.target.url = "h.vollar.ga" or $selection.target.url = "ja.vollar.ga" or $selection.target.url = "k.vollar.ga" or $selection.target.url = "m.vollar.ga" or $selection.target.url = "ma.vollar.ga" or $selection.target.url = "n.vollar.ga" or $selection.target.url = "na.vollar.ga" or $selection.target.url = "o.vollar.ga" or $selection.target.url = "oa.vollar.ga" or $selection.target.url = "ob.vollar.ga" or $selection.target.url = "s.vollar.ga" or $selection.target.url = "sa.vollar.ga" or $selection.target.url = "t.vollar.ga" or $selection.target.url = "ta.vollar.ga" or $selection.target.url = "v.vollar.ga" or $selection.target.url = "x.vollar.ga" or $selection.target.url = "xa.vollar.ga" or $selection.target.url = "z.vollar.ga") and ($selection.principal.ip = "183.131.3.196" or $selection.principal.ip = "192.37.90.118" or $selection.principal.ip = "39.109.116.162" or $selection.principal.ip = "154.221.26.108" or $selection.principal.ip = "103.53.211.94" or $selection.principal.ip = "185.172.66.203" or $selection.principal.ip = "51.105.249.223" or $selection.principal.ip = "154.211.14.66" or $selection.principal.ip = "154.221.19.221" or $selection.principal.ip = "145.239.23.7" or $selection.principal.ip = "180.97.220.5" or $selection.principal.ip = "207.180.202.208"))
<li><a href="#">events: (($selection.target.url = "exe" or $selection.target.url = "vbs" or $selection.target.url = "bat" or $selection.target.url = "rar" or $selection.target.url = "ps1" or $selection.target.url = "doc" or $selection.target.url = "docm" or $selection.target.url = "xls" or $selection.target.url = "xlsm" or $selection.target.url = "pptm" or $selection.target.url = "rtf" or $selection.target.url = "hta" or $selection.target.url = "dll" or $selection.target.url = "ws" or $selection.target.url = "wsf" or $selection.target.url = "sct" or $selection.target.url = "zip") and (re.regex($selection.target.hostname, `.*\.country`) or re.regex($selection.target.hostname, `.*\.stream`) or re.regex($selection.target.hostname, `.*\.gdn`) or re.regex($selection.target.hostname, `.*\.mom`) or re.regex($selection.target.hostname, `.*\.xin`) or re.regex($selection.target.hostname, `.*\.kim`) or re.regex($selection.target.hostname, `.*\.men`) or re.regex($selection.target.hostname, `.*\.loan`) or re.regex($selection.target.hostname, `.*\.download`) or re.regex($selection.target.hostname, `.*\.racing`) or re.regex($selection.target.hostname, `.*\.online`) or re.regex($selection.target.hostname, `.*\.science`) or re.regex($selection.target.hostname, `.*\.ren`) or re.regex($selection.target.hostname, `.*\.gb`) or re.regex($selection.target.hostname, `.*\.win`) or re.regex($selection.target.hostname, `.*\.top`) or re.regex($selection.target.hostname, `.*\.review`) or re.regex($selection.target.hostname, `.*\.vip`) or re.regex($selection.target.hostname, `.*\.party`) or re.regex($selection.target.hostname, `.*\.tech`) or re.regex($selection.target.hostname, `.*\.xyz`) or re.regex($selection.target.hostname, `.*\.date`) or re.regex($selection.target.hostname, `.*\.faith`) or re.regex($selection.target.hostname, `.*\.zip`) or re.regex($selection.target.hostname, `.*\.cricket`) or re.regex($selection.target.hostname, `.*\.space`) or re.regex($selection.target.hostname, `.*\.info`) or re.regex($selection.target.hostname, `.*\.vn`) or re.regex($selection.target.hostname, `.*\.cm`) or re.regex($selection.target.hostname, `.*\.am`) or re.regex($selection.target.hostname, `.*\.cc`) or re.regex($selection.target.hostname, `.*\.asia`) or re.regex($selection.target.hostname, `.*\.ws`) or re.regex($selection.target.hostname, `.*\.tk`) or re.regex($selection.target.hostname, `.*\.biz`) or re.regex($selection.target.hostname, `.*\.su`) or re.regex($selection.target.hostname, `.*\.st`) or re.regex($selection.target.hostname, `.*\.ro`) or re.regex($selection.target.hostname, `.*\.ge`) or re.regex($selection.target.hostname, `.*\.ms`) or re.regex($selection.target.hostname, `.*\.pk`) or re.regex($selection.target.hostname, `.*\.nu`) or re.regex($selection.target.hostname, `.*\.me`) or re.regex($selection.target.hostname, `.*\.ph`) or re.regex($selection.target.hostname, `.*\.to`) or re.regex($selection.target.hostname, `.*\.tt`) or re.regex($selection.target.hostname, `.*\.name`) or re.regex($selection.target.hostname, `.*\.tv`) or re.regex($selection.target.hostname, `.*\.kz`) or re.regex($selection.target.hostname, `.*\.tc`) or re.regex($selection.target.hostname, `.*\.mobi`) or re.regex($selection.target.hostname, `.*\.study`) or re.regex($selection.target.hostname, `.*\.click`) or re.regex($selection.target.hostname, `.*\.link`) or re.regex($selection.target.hostname, `.*\.trade`) or re.regex($selection.target.hostname, `.*\.accountant`) or re.regex($selection.target.hostname, `.*\.cf`) or re.regex($selection.target.hostname, `.*\.gq`) or re.regex($selection.target.hostname, `.*\.ml`) or re.regex($selection.target.hostname, `.*\.ga`)))
<li><a href="#">events: (($selection_dll.metadata.product_event_type = "7" and re.regex($selection_dll.target.process.file.full_path, `.*microsoftaccounttokenprovider\.dll`)) and not ((re.regex($selection_dll.target.process.file.full_path, `.*backgroundtaskhost\.exe`) or re.regex($selection_dll.target.process.file.full_path, `.*devenv\.exe`) or re.regex($selection_dll.target.process.file.full_path, `.*iexplore\.exe`) or re.regex($selection_dll.target.process.file.full_path, `.*microsoftedge\.exe`))))
<li><a href="#">events: (($selection_hashes.metadata.product_event_type = "1" and ($selection_hashes.target.file.md5 = "08bb17d8e839e7fc92426e813a696e73" or $selection_hashes.target.file.md5 = "0939363ff55d914e92635e5f693099fb28047602" or $selection_hashes.target.file.md5 = "3549cfa19e60aa9239f79d80e19279fa" or $selection_hashes.target.file.md5 = "382715f8e776a544bf70f843a52e3ff2" or $selection_hashes.target.file.md5 = "3d3d7962d16652002018640a3fa27d44" or $selection_hashes.target.file.md5 = "5d25465ec4d51c6b61947990fb148d0b1ee8a344069d5ac956ef4ea6a61af879" or $selection_hashes.target.file.md5 = "6c3daca3c522ab98a8ac12a45087297c" or $selection_hashes.target.file.md5 = "7efe8a7ad9c6a6146bddd5aef9ceba477ca6973203a41f4b7f823095a90cb10f" or $selection_hashes.target.file.md5 = "871fb8486e5ea3307ff7b65ddf46518a" or $selection_hashes.target.file.md5 = "8d9123cd2648020292b5c35edc9ae22e" or $selection_hashes.target.file.md5 = "a1260fd3e9221d1bc5b9ece6e7a5a98669c79e124453f2ac58625085759ed3bb" or $selection_hashes.target.file.md5 = "a3a1a43f0e631c10ab42e5404b61580e760e7d6f849ab8eb5848057a8c60cda2" or $selection_hashes.target.file.md5 = "b7f382ea7e6c9c8e737cb92551341e64")) or (re.regex($selection_hashes.target.process.command_line, `.*\.exe`) and $selection_hashes.target.process.command_line = "-s" and $selection_hashes.target.process.command_line = "-d" and $selection_hashes.target.process.command_line = "-p" and $selection_hashes.target.process.command_line = "-u" and $selection_hashes.target.process.command_line = "-pw"))
<li><a href="#">events: (($selection_process.metadata.product_event_type = "1" and re.regex($selection_process.src.process.file.full_path, `.*\\winlogon\.exe`) and (re.regex($selection_process.target.process.command_line, `.*\\cmd\.exe sethc\.exe .*`) or re.regex($selection_process.target.process.command_line, `.*\\cmd\.exe utilman\.exe .*`) or re.regex($selection_process.target.process.command_line, `.*\\cmd\.exe osk\.exe .*`) or re.regex($selection_process.target.process.command_line, `.*\\cmd\.exe magnify\.exe .*`) or re.regex($selection_process.target.process.command_line, `.*\\cmd\.exe narrator\.exe .*`) or re.regex($selection_process.target.process.command_line, `.*\\cmd\.exe displayswitch\.exe .*`))) or ($selection_process.metadata.product_event_type = "13" and (re.regex($selection_process.target.registry.registry_key, `.*\\software\\microsoft\\windows nt\\currentversion\\image file execution options\\sethc\.exe\\debugger`) or re.regex($selection_process.target.registry.registry_key, `.*\\software\\microsoft\\windows nt\\currentversion\\image file execution options\\utilman\.exe\\debugger`) or re.regex($selection_process.target.registry.registry_key, `.*\\software\\microsoft\\windows nt\\currentversion\\image file execution options\\osk\.exe\\debugger`) or re.regex($selection_process.target.registry.registry_key, `.*\\software\\microsoft\\windows nt\\currentversion\\image file execution options\\magnify\.exe\\debugger`) or re.regex($selection_process.target.registry.registry_key, `.*\\software\\microsoft\\windows nt\\currentversion\\image file execution options\\narrator\.exe\\debugger`) or re.regex($selection_process.target.registry.registry_key, `.*\\software\\microsoft\\windows nt\\currentversion\\image file execution options\\displayswitch\.exe\\debugger`)) and $selection_process.metadata.event_type = "setvalue"))
<li><a href="#">events: (($selection_urls_1.target.url = "com-managers-updateds-notifications-accounts.com" or $selection_urls_1.target.url = "com-updated-manager-notifications-accounts.info" or $selection_urls_1.target.url = "com-index-managers-updateds-notifications-accounts.com" or $selection_urls_1.target.url = "com-notice-index-managers-review-accounts.com" or $selection_urls_1.target.url = "appleid.com-notice-index-managers-review-accounts.com" or $selection_urls_1.target.url = "appleid.com-index-managers-updateds-notifications-accounts.com" or $selection_urls_1.target.url = "appleid.com-updated-manager-notifications-accounts.info" or $selection_urls_1.target.url = "appleid.com-manager-updateds-account-notifeds.com" or $selection_urls_1.target.url = "com-manager-updateds-account-notifeds.com" or $selection_urls_1.target.url = "appleid.com-managers-updateds-notifications-accounts.com" or $selection_urls_1.target.url = "appleid.com-index-managers-updateds-notifications-accounts.info" or $selection_urls_1.target.url = "com-index-managers-updateds-notifications-accounts.info") or ($selection_urls_1.target.url = "com-authenticationid-account-id-291175.com" or $selection_urls_1.target.url = "com-authentication-account-id-67800.com" or $selection_urls_1.target.url = "account-signinid.com-authentication-account-id-67800.com" or $selection_urls_1.target.url = "com-reviewid-account-authenticationid-11250.com" or $selection_urls_1.target.url = "com-authentication-account-id-67991.com" or $selection_urls_1.target.url = "accountid-signin.com-authenticationid-account-id-291175.com") or ($selection_urls_1.target.url = "reverify-id-apple.com" or $selection_urls_1.target.url = "re-verify-id-apple.com" or $selection_urls_1.target.url = "reverify-id-apple.com" or $selection_urls_1.target.url = "un-verify-id-apple.com" or $selection_urls_1.target.url = "unverify-id-apple.com" or $selection_urls_1.target.url = "re-verify-id-apple.com" or $selection_urls_1.target.url = "unverify-id-apple.com" or $selection_urls_1.target.url = "www.unverify-id-apple.com" or $selection_urls_1.target.url = "un-verify-id-apple.com" or $selection_urls_1.target.url = "wazze-design.com" or $selection_urls_1.target.url = "www.wazze-design.com" or $selection_urls_1.target.url = "www.re-verify-id-apple.com" or $selection_urls_1.target.url = "www.reverify-id-apple.com" or $selection_urls_1.target.url = "www.un-verify-id-apple.com" or $selection_urls_1.target.url = "ns1.stitis.com" or $selection_urls_1.target.url = "ns2.stitis.com" or $selection_urls_1.target.url = "disable-id-apple.com" or $selection_urls_1.target.url = "www.support-id-icloud.com" or $selection_urls_1.target.url = "apple.com-verif-id.app") or ($selection_urls_1.target.url = "pages-secure.com-verifications-account-webservices-appleid.com" or $selection_urls_1.target.url = "com-verifications-account-webservices-appleid.com" or $selection_urls_1.target.url = "com-verifications-account-webservices-appleid.com" or $selection_urls_1.target.url = "com-page-secure-webmail-supportcenter.com" or $selection_urls_1.target.url = "identification-account.com-page-secure-webmail-supportcenter.com" or $selection_urls_1.target.url = "www.com-page-secure-webmail-supportcenter.com" or $selection_urls_1.target.url = "com-page-secure-webmail-supportcenter.com"))
<li><a href="#">events: (($selection0.target.process.command_line = "net time" or $selection0.target.process.command_line = "net1 time" or $selection0.target.process.command_line = "get-date") or ($selection0.target.process.file.full_path = "net.exe" or $selection0.target.process.file.full_path = "net1.exe" or $selection0.target.process.file.full_path = "w32tm.exe"))
<li><a href="#">events: (($selection0.target.process.command_line = "wmic" or $selection0.target.process.command_line = "useraccount get /all" or $selection0.target.process.command_line = "whoami") or ($selection0.target.process.file.full_path = "whoami.exe" or $selection0.target.process.file.full_path = "qwinsta.exe" or $selection0.target.process.file.full_path = "quser.exe"))
<li><a href="#">events: (($selection1.metadata.product_event_type = "1" and $selection1.target.process.file.full_path = "c:\\windows\\hh.exe" and re.regex($selection1.target.process.command_line, `.*.*\.chm`)) or ($selection1.metadata.product_event_type = "13" and $selection1.target.process.file.full_path = "c:\\windows\\hh.exe"))
<li><a href="#">events: (($selection1.metadata.product_event_type = "1" and $selection1.target.process.file.full_path = "c:\\windows\\system32\\sc.exe" and re.regex($selection1.target.process.command_line, `sc config .* binppath= .*`) and $selection1.src.process.file.full_path = "c:\\windows\\system32\\cmd.exe") or ($selection1.metadata.product_event_type = "13" and $selection1.target.process.file.full_path = "c:\\windows\\system32\\services.exe" and re.regex($selection1.target.registry.registry_key, `hklm\\system\\currentcontrolset\\services.*\\imagepath`)))
<li><a href="#">events: (($selection1.metadata.product_event_type = "1" and ($selection1.target.file.md5 = "870319967dba4bd02c7a7f8be8ece84f" or $selection1.target.file.md5 = "c9b712f6c347edde22836fb43b927633" or $selection1.target.file.md5 = "75902cf93397d2e2d1797cd115f8347a") and (($selection1.metadata.product_event_type = "11" and (re.regex($selection1.target.file.full_path, `.*start\.png`) or re.regex($selection1.target.file.full_path, `.*run\.png`) or re.regex($selection1.target.file.full_path, `.*quit\.png`) or re.regex($selection1.target.file.full_path, `.*watch\.png`) or re.regex($selection1.target.file.full_path, `.*upgrade\.png`) or re.regex($selection1.target.file.full_path, `.*proxy\.png`) or re.regex($selection1.target.file.full_path, `.*packet\.png`) or re.regex($selection1.target.file.full_path, `.*curl\.png`) or re.regex($selection1.target.file.full_path, `.*util\.png`) or re.regex($selection1.target.file.full_path, `.*utils\.png`) or re.regex($selection1.target.file.full_path, `.*vm\.png`) or re.regex($selection1.target.file.full_path, `.*cc\.png`))) or ($selection1.metadata.product_event_type = "3" and ($selection1.target.ip = "198.204.231.250" or $selection1.target.ip = "104.238.151.101" or $selection1.target.ip = "43.224.225.220")))) or ($selection1.metadata.product_event_type = "11" and (re.regex($selection1.target.file.full_path, `.*start\.png`) or re.regex($selection1.target.file.full_path, `.*run\.png`) or re.regex($selection1.target.file.full_path, `.*quit\.png`) or re.regex($selection1.target.file.full_path, `.*watch\.png`) or re.regex($selection1.target.file.full_path, `.*upgrade\.png`) or re.regex($selection1.target.file.full_path, `.*proxy\.png`) or re.regex($selection1.target.file.full_path, `.*packet\.png`) or re.regex($selection1.target.file.full_path, `.*curl\.png`) or re.regex($selection1.target.file.full_path, `.*util\.png`) or re.regex($selection1.target.file.full_path, `.*utils\.png`) or re.regex($selection1.target.file.full_path, `.*vm\.png`) or re.regex($selection1.target.file.full_path, `.*cc\.png`))))
<li><a href="#">events: (($selection1.metadata.product_event_type = "1" and ($selection1.target.file.md5 = "e577944c48edfc65b6f59630b0b0ac625b997f26af3d4bdbe2f534be0fff6f34" or (re.regex($selection1.target.process.file.full_path, `.*\\cmd\.exe`) and re.regex($selection1.target.process.command_line, `.*/c c:\\users\\admin\\appdata\\local\\temp\\rad.*`)))) or ($selection1.metadata.product_event_type = "13" and (re.regex($selection1.target.registry.registry_key, `.*\\software\\system32\\configuration\\xi`) or re.regex($selection1.target.registry.registry_key, `.*\\software\\system32\\configuration\\xi`)) and $selection1.metadata.description = "906d0f2e2f604f839e04" and $selection1.metadata.event_type = "setvalue"))
<li><a href="#">events: (($selection1.metadata.product_event_type = "1" and ($selection1.target.process.file.full_path = "c:\\inventorywebserver.exe" or $selection1.target.process.file.full_path = "c:\\program files\\inventorywebserver.exe")) or ($selection1.metadata.product_event_type = "11" and ($selection1.target.file.full_path = "c:\\inventorywebserver.exe" or $selection1.target.file.full_path = "c:\\program files\\inventorywebserver.exe")))
<li><a href="#">events: (($selection1.metadata.product_event_type = "1" and (($selection1.target.process.command_line = "get /bobby" or $selection1.target.process.command_line = "post /bobby/panel") or ($selection1.target.file.md5 = "3c4be617fda78da05b38f4ee52121e99" or $selection1.target.file.md5 = "7fb5a88768d7ece242dbd4b30edeff0c" or $selection1.target.file.md5 = "14a4dffe0105a7def2a1eff32899a9ac" or $selection1.target.file.md5 = "e69245e9685cb204105e69c424f304cc" or $selection1.target.file.md5 = "75ccd03bb4934490a9f599a15381f43d" or $selection1.target.file.md5 = "68befe15006189ce8215371935f8e720" or $selection1.target.file.md5 = "05869152534b238d25051f7718fdb382" or $selection1.target.file.md5 = "3dfa31d85482009479feafd5af7e818a" or $selection1.target.file.md5 = "f9b5535bffd5c0525cb1e59bf79f06d925448b12f106fe1e972473fab4f082fa" or $selection1.target.file.md5 = "4bf2658e0f69865c977cabd24b8dccca38ffc09a17b3367e5f702d2993cf00f7" or $selection1.target.file.md5 = "ed5550d3047903d3e09363f90b6d49f519d1484af4e528fd95f1e5f3e5a008b2" or $selection1.target.file.md5 = "5b1b12f580dcc0219e88887cbe5af7f2" or $selection1.target.file.md5 = "51c86d4fe87f490e4da5e8035645e548" or $selection1.target.file.md5 = "c94d4d0a893a786d51e4acbb66c3cd29" or $selection1.target.file.md5 = "007b3818d95f328376d73f3714c49154" or $selection1.target.file.md5 = "d3e758016c147b5035e20d22e6888e6f" or $selection1.target.file.md5 = "09ef7c56d36365fd24d45660c3246a0a" or $selection1.target.file.md5 = "42844d8957c46dd47effec1c54273efc" or $selection1.target.file.md5 = "d4bbe7685e53f6b788f65268bea485c3" or $selection1.target.file.md5 = "b18f0ad651b48b3dec184b4f95bfcae3"))) or ($selection1.metadata.product_event_type = "11" and re.regex($selection1.target.registry.registry_key, `.*f63aaa`)))
<li><a href="#">events: (($selection1.metadata.product_event_type = "1" and ((((($selection1.target.process.file.full_path = "c:\\windows\\system32\\control.exe" and re.regex($selection1.target.process.command_line, `.*\.cpl`)) or ($selection1.target.process.file.full_path = "c:\\windows\\system32\\rundll32.exe" and re.regex($selection1.target.process.command_line, `c:\\windows\\system32\\rundll32\.exe shell32\.dll,control_rundll .*\.cpl`))) or ($selection1.target.process.file.full_path = "c:\\windows\\syswow64\\rundll32.exe" and re.regex($selection1.target.process.command_line, `c:\\windows\\syswow64\\rundll32\.exe c:\\windows\\syswow64\\shell32\.dll .*\.cpl`))) or ($selection1.src.process.file.full_path = "c:\\windows\\syswow64\\rundll32.exe" and re.regex($selection1.src.process.command_line, `c:\\windows\\syswow64\\rundll\.32\.exe .*\.cpl`))) or ($selection1.src.process.file.full_path = "c:\\windows\\system32\\rundll32.exe" and re.regex($selection1.src.process.command_line, `c:\\windows\\system32\\rundll32\.exe shell32\.dll,control_rundll .*\.cpl`)))) or ($selection1.metadata.product_event_type = "7" and $selection1.target.process.file.full_path = "c:\\window\\syswow64\\rundll32.exe" and re.regex($selection1.target.process.file.full_path, `.*\.cpl`)))
<li><a href="#">events: (($selection1.metadata.product_event_type = "1" and (((((($selection1.target.process.file.full_path = "hveffnueelan.exe" or $selection1.target.process.file.full_path = "mbxrpruhylan.exe") or ($selection1.target.process.file.full_path = "icacls.exe" and re.regex($selection1.target.process.command_line, `icacls c:.* /grant everyone:f /t /c /qã¾ã¾`))) or ($selection1.target.process.file.full_path = "cmd.exe" and ($selection1.target.process.command_line = "cmd.exe /c bcdedit /set {default} recoveryenabled no & bcdedit /set {default}" or $selection1.target.process.command_line = "cmd.exe /c wmic.exe shadowcopy delete" or $selection1.target.process.command_line = "cmd.exe /c vssadmin.exe delete shadows /all /quiet" or re.regex($selection1.target.process.command_line, `c:\\windows\\system32\\cmd\.exe /c reg add \"hkey_current_user\\software\\microsoft\\windows\\currentversion\\run /v ev /t reg_sz /d .* /f /reg:64`)))) or ($selection1.target.process.file.full_path = "bcdedit.exe" and ($selection1.target.process.command_line = "bcdedit /set {default}" or $selection1.target.process.command_line = "bcdedit /set {default} recoveryenabled no"))) or ($selection1.target.process.file.full_path = "net.exe" and $selection1.target.process.command_line = "c:\\windows\\system32\\net.exe stop samss /y")) or ($selection1.target.process.file.full_path = "reg.exe" and re.regex($selection1.target.process.command_line, `reg add hkey_current_user\\software\\microsoft\\windows\\currentversion\\run /v ev /t reg_sz /d .* /f /reg:64`)))) or ($selection1.metadata.product_event_type = "13" and re.regex($selection1.target.registry.registry_key, `registry\\user\\s-1-5-21-638615289-2068236702-2426684043-1000\\software\\microsoft\\windows\\currentversion\\run\\ev .*`) and re.regex($selection1.metadata.description, `.*`)))
<li><a href="#">events: (($selection1.metadata.product_event_type = "1" and ((re.regex($selection1.target.process.file.full_path, `.*cmd\.exe`) and ($selection1.target.process.command_line = "cmd.exe /c schtasks /creaet /sc minute /mo 30 /tr %localappdata%\\\\virtualstore\\\\certcheck.exe /tn verifiedpublishercertcheck /f" or re.regex($selection1.target.process.command_line, `cmd\.exe /c net use .*\\c$ .* /user:administrator & copy /y .*\\c$\\users\\public\\documents\\i\.js $documents\\j\.js & $documents\\j\.js`))) or ($selection1.target.process.command_line = "tasklist /v" or $selection1.target.process.command_line = "gpresult /z" or $selection1.target.process.command_line = "dir \\x22%programfiles%\\x5ckaspersky lab\\x22" or $selection1.target.process.command_line = "tracert www.google.com"))) or ($selection1.metadata.product_event_type = "11" and re.regex($selection1.target.file.full_path, `c:\\users.*\\appdata\\roaming\\microsofx5ct235\.dat`)))
<li><a href="#">events: (($selection1.metadata.product_event_type = "1" and re.regex($selection1.src.process.file.full_path, `.*\\\\signal\.exe`) and re.regex($selection1.target.process.command_line, `.*\\\\node_modules\\\\\.bin\\\\wmic\.exe`)) or ($selection1.metadata.product_event_type = "11" and re.regex($selection1.target.file.full_path, `.*\\\\node_modules\\\\\.bin\\\\wmic\.exe`)))
<li><a href="#">events: (($selection1.metadata.product_event_type = "1" and re.regex($selection1.target.process.file.full_path, `.*lsass\.exe`)) and not ($selection1.target.process.file.full_path = "c:\\windows\\system32\\lsass.exe"))
<li><a href="#">events: (($selection1.metadata.product_event_type = "11" and $selection1.target.file.full_path = "c:\\python27\\msvcr120.dll") or ($selection1.metadata.product_event_type = "7" and re.regex($selection1.target.process.file.full_path, `.*\\crashplanproserver\.exe`) and $selection1.target.process.file.full_path = "c:\\python27\\msvcr120.dll"))
<li><a href="#">events: (($selection1.metadata.product_event_type = "11" and ($selection1.target.file.full_path = "c:\\windows \\system32\\propsys.dll" or $selection1.target.file.full_path = "c:\\windows \\system32\\computerdefaults.exe" or re.regex($selection1.target.file.full_path, `c:\\users.*\\appdata\\roaming\\msocache.*\.xml`) or re.regex($selection1.target.file.full_path, `c:\\users.*\\appdata\\local\\temp\\tmpaddon_bak`) or re.regex($selection1.target.file.full_path, `.*schetasks\.exe`) or $selection1.target.file.full_path = "c:\\windows\\api.config")) or ($selection1.metadata.product_event_type = "1" and re.regex($selection1.target.process.file.full_path, `.*schetasks\.exe`) and re.regex($selection1.target.process.command_line, `schetasks\.exe /create /rl highest /tn .* /sc logon /tr c:\\$recycle\.bin.*.*\.lnk`)))
<li><a href="#">events: (($selection1.metadata.product_event_type = "11" and (re.regex($selection1.target.file.full_path, `.* .*\\microsoft\\windows\\drm.*`) or re.regex($selection1.target.file.full_path, `.* .*\\microsoft\\network\\downloader.*`) or re.regex($selection1.target.file.full_path, `.* c:\\users.*\\appdata\\roaming\\cloudapp.*\.exe .*`))) or ($selection1.metadata.product_event_type = "13" and re.regex($selection1.target.registry.registry_key, `.* .*\\system\\currentcontrolset\\services\\ssdpsrv.*`) and $selection1.metadata.event_type = "setvalue"))
<li><a href="#">events: (($selection1.metadata.product_event_type = "11" and (re.regex($selection1.target.file.full_path, `.*%temp%\\kkk1\.log`) or re.regex($selection1.target.file.full_path, `.*%temp%\\pp2\.log`) or re.regex($selection1.target.file.full_path, `.*%temp%\\333\.log`) or re.regex($selection1.target.file.full_path, `.*%temp%\\kk4\.log`) or re.regex($selection1.target.file.full_path, `.*%temp%\\kk5\.log`))) or ($selection1.metadata.product_event_type = "1" and $selection1.target.process.file.full_path = "c:\\windows\\system32\\windowspowershell\\v1.0\\powershell.exe" and $selection1.target.process.command_line = "powershell -nop -w hidden -ep bypass { \"iex (new-object net.webclient).downloadstring\""))
<li><a href="#">events: (($selection1.metadata.product_event_type = "11" and (re.regex($selection1.target.file.full_path, `c:\\users\\public\\librarires\\awsvideos.*`) or re.regex($selection1.target.file.full_path, `c:\\users \\public\\librarires\\awsvideos.*`) or re.regex($selection1.target.file.full_path, `c:\\users\\public\\libraries\\raptor.*`) or re.regex($selection1.target.file.full_path, `.*rakpat0.*`))) or ($selection1.metadata.product_event_type = "1" and ($selection1.target.process.command_line = "cmd /k shutdown -r -t 0 -f" or $selection1.target.process.command_line = "cmd /k shutdown -r -t 1 -f" or $selection1.target.process.command_line = "taskkill /f /im regsvr32.exe" or $selection1.target.process.command_line = "taskkill /f /im unins000.exe" or $selection1.target.process.command_line = "taskkill /f /im aswrundll.exe" or $selection1.target.process.command_line = "cmd /k del /q /s /f c:\\programdata\\sysdirb & exit" or $selection1.target.process.command_line = "cmd /k del /q /s /f c:\\programdata\\nulls & exit" or $selection1.target.process.command_line = "cmd /k del /q /s /f c:\\programdata\\xnull & exit" or $selection1.target.process.command_line = "cmd /k del /q /s /f c:\\programdata\\libs & exit" or $selection1.target.process.command_line = "cmd /k rd /s /q c:\\programdata\\sysdirb & exit" or $selection1.target.process.command_line = "cmd /k rd /s /q c:\\programdata\\nulls & exit" or $selection1.target.process.command_line = "cmd /k rd /s /q c:\\programdata\\xnull & exit" or $selection1.target.process.command_line = "cmd /k rd /s /q c:\\programdata\\libs & exit")))
<li><a href="#">events: (($selection1.metadata.product_event_type = "11" and re.regex($selection1.target.file.full_path, `.*pes1\.exe`)) or ($selection1.metadata.product_event_type = "1" and re.regex($selection1.target.process.file.full_path, `.*pes1\.exe`)))
<li><a href="#">events: (($selection1.metadata.product_event_type = "13" and $selection1.target.registry.registry_key = "hklm\\software\\microsoft\\systemcertificates\\authroot\\certificates\\dac9024f54d8f6df94935fb1732638ca6ad77c13" and $selection1.metadata.description = "blob") or ($selection1.metadata.product_event_type = "11" and (re.regex($selection1.target.file.full_path, `.*modules.*`) or re.regex($selection1.target.file.full_path, `.*client_id.*`) or re.regex($selection1.target.file.full_path, `.*group_tag.*`) or re.regex($selection1.target.file.full_path, `.*\\tasks\\bot.*`) or re.regex($selection1.target.file.full_path, `.*\\config\\systemprofile\\appdata\\roaming\\client_id`) or re.regex($selection1.target.file.full_path, `.*\\config\\systemprofile\\appdata\\roaming\\group_tag`) or re.regex($selection1.target.file.full_path, `.*\\tasks\\bot\.job`))))
<li><a href="#">events: (($selection1.metadata.product_event_type = "13" and ($selection1.target.registry.registry_key = "hklm\\software\\policies\\microsoft\\windows\\windowsupdate" or $selection1.target.registry.registry_key = "hklm\\software\\policies\\microsoft\\windows\\windowsupdate\\osupgrade" or $selection1.target.registry.registry_key = "hkcu\\software\\microsoft\\windows\\currentversion\\run" or $selection1.target.registry.registry_key = "hklm\\software\\policies\\microsoft\\windows\\windowsupdate" or $selection1.target.registry.registry_key = "hklm\\software\\policies\\microsoft\\windows\\windowsupdate\\osupgrade" or $selection1.target.registry.registry_key = "hkcu\\software\\xvyg" or $selection1.target.registry.registry_key = "hklm\\software\\wow6432node\\xvyg " or $selection1.target.registry.registry_key = "hkcr\\7b507" or $selection1.target.registry.registry_key = "hkcr\\7b507\\shell" or $selection1.target.registry.registry_key = "hkcr\\7b507\\shell\\open" or $selection1.target.registry.registry_key = "hkcr\\7b507\\shell\\open\\command" or $selection1.target.registry.registry_key = "hkcr\\.16a05d" or $selection1.target.registry.registry_key = "hkcr\\.16a05d" or $selection1.target.registry.registry_key = "hkcu\\software\\microsoft\\windows\\currentversion\\run" or $selection1.target.registry.registry_key = "hklm\\software\\microsoft\\systemcertificates\\authroot\\certificates\\dac9024f54d8f6df94935fb1732638ca6ad77c13" or $selection1.target.registry.registry_key = "hkcu\\software\\9ovfkl4" or $selection1.target.registry.registry_key = "hkcu\\software\\iuv2k1gdz" or $selection1.target.registry.registry_key = "hkcu\\software\\iuv2k1gdz" or $selection1.target.registry.registry_key = "hkcu\\software\\tyg6zx" or $selection1.target.registry.registry_key = "hkcu\\software\\5wgib69" or $selection1.target.registry.registry_key = "hkcu\\software\\0wn0hdcj1e" or $selection1.target.registry.registry_key = "hkcu\\software\\0wn0hdcj1e") and ($selection1.target.registry.registry_value_data = "curamv" or $selection1.target.registry.registry_value_data = "vuvy43rot" or $selection1.target.registry.registry_value_data = "vr6ktbo" or $selection1.target.registry.registry_value_data = "49ru6evnxc" or $selection1.target.registry.registry_value_data = "y4d5jxtm" or $selection1.target.registry.registry_value_data = "xsnk64x" or $selection1.target.registry.registry_value_data = "ixf25a" or $selection1.target.registry.registry_value_data = "dc1ixk9" or $selection1.target.registry.registry_value_data = "blob" or $selection1.target.registry.registry_value_data = "vrxzdhbyv" or $selection1.target.registry.registry_value_data = "ssishoff" or $selection1.target.registry.registry_value_data = "reservationsallowed" or $selection1.target.registry.registry_value_data = "disableosupgrade")) or ($selection1.metadata.product_event_type = "11" and (re.regex($selection1.target.file.full_path, `.*\\appdata\\local\\39b03.*`) or re.regex($selection1.target.file.full_path, `.*\\appdata\\local\\39b03\\6a5cc\.16a05d.*`) or re.regex($selection1.target.file.full_path, `.*\\appdata\\local\\39b03\\7cbdf\.bat`) or re.regex($selection1.target.file.full_path, `.*\\local settings\\application data\\2501\\1ffa\.41d68`) or re.regex($selection1.target.file.full_path, `.*\\local settings\\application data\\2501\\aae7\.bat`))))
<li><a href="#">events: (($selection1.metadata.product_event_type = "13" and ((($selection1.target.registry.registry_key = "hkcu\\software\\microsoft\\windows\\currentversion\\run" and ($selection1.metadata.description = "ntuser" or $selection1.metadata.description = "autoload")) or ($selection1.target.registry.registry_key = "hklm\\system\\controlset001\\services\\schedule" and $selection1.metadata.description = "imagepath")) or ($selection1.target.registry.registry_key = "hklm\\software\\wow6432node\\microsoft\\windows\\currentversion\\run" and ($selection1.metadata.description = "ntuser" or $selection1.metadata.description = "autoload")))) or ($selection1.metadata.product_event_type = "11" and ($selection1.target.file.full_path = "c:\\windows\\syswow64\\drivers\\spools.exe" or $selection1.target.file.full_path = "c:\\cftmon.exe")))
<li><a href="#">events: (($selection1.metadata.product_event_type = "13" and (re.regex($selection1.target.registry.registry_key, `.*\\system\\controlset001\\services\\windefend`) or re.regex($selection1.target.registry.registry_key, `.*software\\policies\\microsoft\\windows defender`)) and $selection1.metadata.event_type = "setvalue") or ($selection1.target.process.file.full_path = "powershell.exe" and re.regex($selection1.target.process.command_line, `.* .*/c powershell set-mppreference -disablerealtimemonitoring $true .*`)))
<li><a href="#">events: (($selection1.metadata.product_event_type = "13" and re.regex($selection1.target.registry.registry_key, `.*\\eulaaccepted`)) or ($selection1.metadata.product_event_type = "1" and re.regex($selection1.target.process.command_line, `.* -accepteula.*`)))
<li><a href="#">events: (($selection1.metadata.product_event_type = "13" and re.regex($selection1.target.registry.registry_key, `.*\\system\\currentcontrolset\\control\\wmi\\autologger\\autologger_name.*`) and $selection1.metadata.event_type = "setvalue") or ($selection1.metadata.product_event_type = "1" and re.regex($selection1.target.process.command_line, `.*\\system\\currentcontrolset\\control\\wmi\\autologger\\autologger_name.*`)))
<li><a href="#">events: (($selection1.metadata.product_event_type = "4624" and $selection1.extensions.auth.mechanism = "10") and not ((re.regex($selection1.principal.ip, `10\..*`) or re.regex($selection1.principal.ip, `192\.168\..*`) or re.regex($selection1.principal.ip, `172\.31.*`) or re.regex($selection1.principal.ip, `172\.30\..*`) or re.regex($selection1.principal.ip, `172\.29\..*`) or re.regex($selection1.principal.ip, `172\.28\..*`) or re.regex($selection1.principal.ip, `172\.27\..*`) or re.regex($selection1.principal.ip, `172\.26\..*`) or re.regex($selection1.principal.ip, `172\.25\..*`) or re.regex($selection1.principal.ip, `172\.24\..*`) or re.regex($selection1.principal.ip, `172\.23\..*`) or re.regex($selection1.principal.ip, `172\.21\..*`) or re.regex($selection1.principal.ip, `172\.20\..*`) or re.regex($selection1.principal.ip, `172\.19\..*`) or re.regex($selection1.principal.ip, `172\.18\..*`) or re.regex($selection1.principal.ip, `172\.17\..*`) or re.regex($selection1.principal.ip, `172\.16\..*`) or re.regex($selection1.principal.ip, `fd.*`) or re.regex($selection1.principal.ip, `fc.*`) or re.regex($selection1.principal.ip, `127\.0\.0\.1.*`) or re.regex($selection1.principal.ip, `::1.*`))))
<li><a href="#">events: (($selection1.metadata.product_event_type = "4688" or $selection1.metadata.product_event_type = "1") and (($selection1.target.process.file.full_path = "cmd.exe" and (re.regex($selection1.target.process.command_line, ` /c bitsadmin /transfer getitman /download /priority high http.*://.*\..*\..*\..*/jp\.exe %temp%.*\.exe&start %temp%.*\.exe,0,.*`) or re.regex($selection1.target.process.command_line, ` /c bitsadmin /transfer getitman /download /priority high https://.*\..*\..*\..*/.*\.exe %temp%.*\.exe&start %temp%.*\.exe,0,.*`))) or ($selection1.target.process.file.full_path = "bitsadmin.exe" and (re.regex($selection1.target.process.command_line, ` bitsadmin /transfer getitman /download /priority high http://.*\..*\..*\..*/jp\.exe %temp%.*\.exe&start %temp%.*\.exe,0,.*`) or re.regex($selection1.target.process.command_line, ` bitsadmin /transfer getitman /download /priority high https://.*\..*\..*\..*/.*\.exe %temp%.*\.exe&start %temp%.*\.exe,0,.*`)))))
<li><a href="#">events: (($selection1.metadata.product_event_type = "4688" or $selection1.metadata.product_event_type = "1") and (($selection1.target.process.file.full_path = "cmd.exe" and (re.regex($selection1.target.process.command_line, `.*/c certutil -decode c:\\programdata\\padre1\.txt c:\\programdata.*\\gup\.txt.*`) or re.regex($selection1.target.process.command_line, `.*/c certutil -decode c:\\programdata\\padre2\.txt c:\\programdata.*\\libcurl\.txt.*`) or re.regex($selection1.target.process.command_line, `.* /c certutil -decode c:\\programdata\\padre3\.txt c:\\programdata.*\\3f2e3ab9 .*`))) or ($selection1.target.process.file.full_path = "esentutl.exe" and (re.regex($selection1.target.process.command_line, `.* /y c:\\programdata.*\\gup\.txt /d c:\\programdata\\gup\.exe /o .*`) or re.regex($selection1.target.process.command_line, `.* /y c:\\programdata.*\\libcurl\.txt /d c:\\programdata\\libcurl\.dll /o .*`)))))
<li><a href="#">events: (($selection1.metadata.product_event_type = "4688" or $selection1.metadata.product_event_type = "1") and (($selection1.target.process.file.full_path = "cmd.exe" and (re.regex($selection1.target.process.command_line, `/c for %x in \(%temp%=%cd%\) do for /f \"delims==\" %i in \(dir %x.*-.*-1\.lnk /s /b\)do start mshta\.exe \"%i\"`) or re.regex($selection1.target.process.command_line, `/c dir \"c:\\users.*\\appdata\\local\\temp.*-.*-1\.lnk\" /s /b`))) or ($selection1.target.process.file.full_path = "schtasks.exe" and $selection1.target.process.command_line = "/f /create /tn tencentid /sc minute /mo 1 /tr c:\\users\\public\\music\\tencentsoso.exe")))
<li><a href="#">events: (($selection1.metadata.product_event_type = "4688" or $selection1.metadata.product_event_type = "1") and (($selection1.target.process.file.full_path = "cmd.exe" and (re.regex($selection1.target.process.command_line, `/c taskkill /im 5\.exe /f & erase c:\\users.*\\appdata\\local\\temp.*\\5\.exe & exit`) or re.regex($selection1.target.process.command_line, `/c taskkill /im .*\.exe /f & erase c:\\users.*\\appdata\\local\\temp.*.*\.exe & exit`))) or ($selection1.target.process.file.full_path = "icacls.exe" and re.regex($selection1.target.process.command_line, `icacls c:\\users.*\\appdata\\local.*\\deny .*s-1-1-0:\(ol\)\(cl\)\(de,dc\)`))))
<li><a href="#">events: (($selection1.metadata.product_event_type = "4688" or $selection1.metadata.product_event_type = "1") and (($selection1.target.process.file.full_path = "move.exe" and ($selection1.target.process.command_line = "move \"c:\\perflogs\\1.dat\" \"c:\\programdata\\microsoft\\sqcsvc\\sqcsvc6.ldx\"" or $selection1.target.process.command_line = "move \"c:\\perflogs\\1.dll\" \"c:\\windows\\system32\\sqcsvc.dll\"" or $selection1.target.process.command_line = "move \"c:\\perflogs\\1.dll.mui\" \"c:\\windows\\system32\\sqcsvc.dll.mui\"")) or ($selection1.target.process.file.full_path = "reg.exe" and ($selection1.target.process.command_line = "reg add \"hklm\\system\\controlset001\\services\\sqcsvc\\parameters\" /v servicedll /t reg_expand_sz /d \"%systemroot%\\system32\\sqcsvc.dll\"" or $selection1.target.process.command_line = "reg add \"hklm\\software\\microsoft\\windows nt\\currentversion\\svchost\" /v sqcsvc /t reg_ multi_sz /d sqcsvc"))))
<li><a href="#">events: (($selection1.metadata.product_event_type = "4688" or $selection1.metadata.product_event_type = "1") and ((($selection1.target.process.file.full_path = "cvtres.exe" and re.regex($selection1.target.process.command_line, `.*cvtres\.exe /nologo /readonly /machine:.* /out:c:\\users.*\\appdata\\local\\temp\\resf8f4\.tmp c:\\users.*\\appdata\\local\\temp\\h4bie4kg\\csc81e10858d57a44649763ee5728d5e87\.tmp.*`)) or ($selection1.target.process.file.full_path = "psexec.exe.exe" and re.regex($selection1.target.process.command_line, `psexec\.exe -s .* cmd /c for /f tokens=.* %1 in \('wevtutil\.exe el'\) do wevtutil\.exe cl %1`))) or ($selection1.target.process.file.full_path = "csc.exe" and re.regex($selection1.target.process.command_line, `csc\.exe /noconfig /fullpaths @c:\\users.*\\appdata\\local\\temp\\h4bie4kg\\h4bie4kg\.cmdline`))))
<li><a href="#">events: (($selection1.metadata.product_event_type = "4688" or $selection1.metadata.product_event_type = "1") and ((re.regex($selection1.target.process.command_line, `.*cmd.*`) and re.regex($selection1.target.process.command_line, `.*/k.*`) and re.regex($selection1.target.process.command_line, `.*/q.*`)) or (re.regex($selection1.target.process.command_line, `.*/q.*`) or re.regex($selection1.target.process.command_line, `.*/k.*`) or re.regex($selection1.target.process.command_line, `.*echo.*`) or re.regex($selection1.target.process.command_line, `.*%comspec%.*`))))
<li><a href="#">events: (($selection1.metadata.product_event_type = "4688" or $selection1.metadata.product_event_type = "1") and ((re.regex($selection1.target.process.command_line, `.*temp\\wtask\.exe /create.*`) or re.regex($selection1.target.process.command_line, `.*%windir:~-3,1%%public:~-9,1%.*`) or re.regex($selection1.target.process.command_line, `.*/e:vbscript .* c:\\users.*\.txt\" /f`) or re.regex($selection1.target.process.command_line, `.*/tn \"security script .*`) or re.regex($selection1.target.process.command_line, `.*%windir:~-1,1%.*`)) or re.regex($selection1.target.process.file.full_path, `.*temp\\winwsh\.exe`)))
<li><a href="#">events: (($selection1.metadata.product_event_type = "4688" or $selection1.metadata.product_event_type = "1") and ((re.regex($selection1.target.process.file.full_path, `.*\\tasksche\.exe`) or re.regex($selection1.target.process.file.full_path, `.*\\mssecsvc\.exe`) or re.regex($selection1.target.process.file.full_path, `.*\\taskdl\.exe`) or re.regex($selection1.target.process.file.full_path, `.*\\@wanadecryptor@.*`) or re.regex($selection1.target.process.file.full_path, `.*\\taskhsvc\.exe`) or re.regex($selection1.target.process.file.full_path, `.*\\taskse\.exe`) or re.regex($selection1.target.process.file.full_path, `.*\\111\.exe`) or re.regex($selection1.target.process.file.full_path, `.*\\lhdfrgui\.exe`) or re.regex($selection1.target.process.file.full_path, `.*\\diskpart\.exe`) or re.regex($selection1.target.process.file.full_path, `.*\\linuxnew\.exe`) or re.regex($selection1.target.process.file.full_path, `.*\\wannacry\.exe`)) or (re.regex($selection1.target.process.command_line, `.*vssadmin delete shadows.*`) or re.regex($selection1.target.process.command_line, `.*icacls .* /grant everyone:f /t /c /q.*`) or re.regex($selection1.target.process.command_line, `.*bcdedit /set {default} recoveryenabled no.*`) or re.regex($selection1.target.process.command_line, `.*wbadmin delete catalog -quiet.*`) or re.regex($selection1.target.process.command_line, `.*@please_read_me@\.txt.*`))))
<li><a href="#">events: (($selection1.metadata.product_event_type = "4688" or $selection1.metadata.product_event_type = "1") and ((re.regex($selection1.target.process.file.full_path, `.*\\tasksche\.exe`) or re.regex($selection1.target.process.file.full_path, `.*\\mssecsvc\.exe`) or re.regex($selection1.target.process.file.full_path, `.*\\taskdl\.exe`) or re.regex($selection1.target.process.file.full_path, `.*\\@wanadecryptor@.*`) or re.regex($selection1.target.process.file.full_path, `.*\\wanadecryptor.*`) or re.regex($selection1.target.process.file.full_path, `.*\\taskhsvc\.exe`) or re.regex($selection1.target.process.file.full_path, `.*\\taskse\.exe`) or re.regex($selection1.target.process.file.full_path, `.*\\111\.exe`) or re.regex($selection1.target.process.file.full_path, `.*\\lhdfrgui\.exe`) or re.regex($selection1.target.process.file.full_path, `.*\\diskpart\.exe`) or re.regex($selection1.target.process.file.full_path, `.*\\linuxnew\.exe`) or re.regex($selection1.target.process.file.full_path, `.*\\wannacry\.exe`)) or (re.regex($selection1.target.process.command_line, `.*icacls .* /grant everyone:f /t /c /q.*`) or re.regex($selection1.target.process.command_line, `.*bcdedit /set {default} recoveryenabled no.*`) or re.regex($selection1.target.process.command_line, `.*wbadmin delete catalog -quiet.*`) or re.regex($selection1.target.process.command_line, `.*@please_read_me@\.txt.*`))))
<li><a href="#">events: (($selection1.metadata.product_event_type = "4688" or $selection1.metadata.product_event_type = "1") and ((re.regex($selection1.target.process.file.full_path, `.*\\xcopy\.exe`) and re.regex($selection1.target.process.command_line, `.* /s /e /c /q /h \\.*`)) or (re.regex($selection1.target.process.file.full_path, `.*\\adexplorer\.exe`) and re.regex($selection1.target.process.command_line, `.* -snapshot \"\" c:\\users\\.*`))))
<li><a href="#">events: (($selection1.metadata.product_event_type = "4688" or $selection1.metadata.product_event_type = "1") and (re.regex($selection1.src.process.file.full_path, `.*\\wsl\.exe`) or (re.regex($selection1.target.process.file.full_path, `.*\\wsl\.exe`) and (re.regex($selection1.target.process.command_line, `.*--exec.*`) or re.regex($selection1.target.process.command_line, `.*-e.*`) or re.regex($selection1.target.process.command_line, `.*-u.*`)))))
<li><a href="#">events: (($selection1.metadata.product_event_type = "4688" or $selection1.metadata.product_event_type = "1") and (re.regex($selection1.target.process.command_line, `.*\\svchost\.exe c:\\users\\.*\\desktop\\.*`) or (re.regex($selection1.src.process.file.full_path, `.*\\svchost\.exe.*`) and (re.regex($selection1.target.process.command_line, `.*whoami\.exe /all`) or re.regex($selection1.target.process.command_line, `.*net\.exe view`)))))
<li><a href="#">events: (($selection1.metadata.product_event_type = "4688" or $selection1.metadata.product_event_type = "1") and (re.regex($selection1.target.process.file.full_path, `.*\\rundll32\.exe`) or re.regex($selection1.metadata.description, `.*windows-hostprozess \(rundll32\).*`)) and (re.regex($selection1.target.process.command_line, `.*default\.getstring.*`) or re.regex($selection1.target.process.command_line, `.*frombase64string.*`)))
<li><a href="#">events: (($selection1.metadata.product_event_type = "4765" or $selection1.metadata.product_event_type = "4766") or ($selection1.metadata.product_event_type = "4738" and not (($selection1.target.process.product_specific_process_id = "-" or $selection1.target.process.product_specific_process_id = "%%1793"))))
<li><a href="#">events: (($selection1.metadata.product_event_type = "4776" or $selection1.metadata.product_event_type = "4624" or $selection1.metadata.product_event_type = "4625") and $selection1.principal.hostname = "ruler")
<li><a href="#">events: (($selection1.metadata.product_event_type = "5145" and (re.regex($selection1.target.file.full_path, `.*-stdin.*`) or re.regex($selection1.target.file.full_path, `.*-stdout.*`) or re.regex($selection1.target.file.full_path, `.*-stderr.*`))) and not (re.regex($selection1.target.file.full_path, `.*psexecsvc.*`)))
<li><a href="#">events: (($selection1.metadata.product_event_type = "5145" and re.regex($selection1.target.resource.name, `.*\\ipc$`) and (re.regex($selection1.target.file.full_path, `.*-stdin`) or re.regex($selection1.target.file.full_path, `.*-stdout`) or re.regex($selection1.target.file.full_path, `.*-stderr`))) and not ($selection1.metadata.product_event_type = "5145" and re.regex($selection1.target.resource.name, `.*\\ipc$`) and re.regex($selection1.target.file.full_path, `psexesvc.*`)))
<li><a href="#">events: (($selection1.metadata.product_event_type = "7" and re.regex($selection1.target.process.file.full_path, `.*/avgsvc\.exe`) and $selection1.target.process.file.full_path = "c:\\windows\\system32\\wbem\\wbemcomn.dll") or ($selection1.metadata.product_event_type = "11" and ($selection1.target.file.full_path = "c:\\program files\\system32\\wbemcomn.dll" or $selection1.target.file.full_path = "c:\\windows\\system32\\wbem\\wbemcomn.dll")))
<li><a href="#">events: (($selection1.metadata.product_event_type = "7" and re.regex($selection1.target.process.file.full_path, `.*/qaadminagent\.exe`) and ($selection1.target.process.file.full_path = "c:\\python27\\atiadlxx.dll" or $selection1.target.process.file.full_path = "c:\\python27\\atiadlxy.dll" or $selection1.target.process.file.full_path = "c:\\python27\\nvapi.dll")) or ($selection1.metadata.product_event_type = "11" and ($selection1.target.file.full_path = "c:\\python27\\atiadlxx.dll" or $selection1.target.file.full_path = "c:\\python27\\atiadlxy.dll" or $selection1.target.file.full_path = "c:\\python27\\nvapi.dll")))
<li><a href="#">events: (($selection1.src.process.file.full_path = "c:\\windows\\system32\\cmd.exe" and (($selection1.target.process.file.full_path = "c:\\windows\\system32\\findstr.exe" and re.regex($selection1.target.process.command_line, `findstr\.exe \"tvndrgaaaa\" .*\\appdata\\local\\temp\\\\g4zokyumbb2gdn\.tmp`)) or (re.regex($selection1.target.process.file.full_path, `.*\\appdata\\local\\temp\\msoia\.exe`) and re.regex($selection1.target.process.command_line, `.*\\appdata\\local\\temp\\\\msoia\.exe -decode .*appdata\\local\\temp\\\\csi1r0uywdnvdu\.tmp .*\\appdata\\local\\temp\\\\oghpgudc03turv\.tmp`)))) or (re.regex($selection1.target.process.file.full_path, `.*\\office12\\wordcnvpxy\.exe`) and re.regex($selection1.src.process.file.full_path, `.*msostyle\.exe`)))
<li><a href="#">events: (($selection1.target.process.command_line = "net stop superbackupman" or $selection1.target.process.command_line = "vssadmin delete shadows /all /quiet" or $selection1.target.process.command_line = "sc start superbackupman" or $selection1.target.process.command_line = "bcdedit.exe /set {current} safeboot minimal" or $selection1.target.process.command_line = "shutdown /r /f /t 00") or ($selection1.metadata.product_event_type = "11" and (re.regex($selection1.target.file.full_path, `.*\.snatch.*`) or re.regex($selection1.target.file.full_path, `.*\.jimm.*`) or re.regex($selection1.target.file.full_path, `.*\.googl.*`) or re.regex($selection1.target.file.full_path, `.*\.dglnl.*`) or re.regex($selection1.target.file.full_path, `.*\.ohwqg.*`) or re.regex($selection1.target.file.full_path, `.*\.wvtr0.*`) or re.regex($selection1.target.file.full_path, `.*\.hceem.*`))))
<li><a href="#">events: (($selection1.target.process.file.full_path = "c:\\windows\\system32\\cmd.exe" and $selection1.src.process.file.full_path = "c:\\windows\\hh.exe" and re.regex($selection1.target.process.command_line, `.*for %i in \(.*\.chm\) do \(hh -decompile %temp% %~i\)&&cmd /c %temp%/~tmp6\.cab`)) or ($selection1.src.process.file.full_path = "c:\\windows\\system32\\cmd.exe" and $selection1.target.process.file.full_path = "c:\\windows\\hh.exe" and re.regex($selection1.target.process.command_line, `hh -decompile .*covid-19\.chm.*`)))
<li><a href="#">events: (($selection1.target.process.file.full_path = "c:\\windows\\system32\\cmstp.exe" and (($selection1.metadata.product_event_type = "1" and re.regex($selection1.target.process.command_line, `cmstp\.exe /s .*\.inf`)) or ($selection1.metadata.product_event_type = "13" and re.regex($selection1.target.registry.registry_key, `.*\\cmstp\.exe`)))) or ($selection1.metadata.product_event_type = "11" and $selection1.target.process.file.full_path = "c:\\windows\\ssytem32\\cmstp.exe"))
<li><a href="#">events: (($selection1.target.process.file.full_path = "c:\\windows\\system32\\regsvr32.exe" or $selection1.target.process.file.full_path = "c:\\windows\\system32\\cmd.exe" or re.regex($selection1.target.process.file.full_path, `.*powershell\.exe.*`)) and $selection1.src.process.file.full_path = "c:\\program files\\internet explorer\\iexplore.exe" and re.regex($selection1.target.process.command_line, `.*6ke4ua62j0vmgeq6ld84ri257o\.sct.*`))
<li><a href="#">events: (($selection1.target.process.file.full_path = "net.exe" and $selection1.target.process.command_line = "net config") or (($selection1.target.process.file.full_path = "ipconfig.exe" or $selection1.target.process.file.full_path = "netsh.exe" or $selection1.target.process.file.full_path = "arp.exe" or $selection1.target.process.file.full_path = "nbtstat.exe" or $selection1.target.process.file.full_path = "systeminfo.exe") and not ($selection1.metadata.product_event_type = "7")))
<li><a href="#">events: (($selection1.target.process.file.full_path = "wevtutil.exe" or $selection1.target.process.file.full_path = "fsutil.exe") and re.regex($selection1.target.process.command_line, `.* wevtutil cl setup & wevtutil cl system & wevtutil cl security & wevtutil cl application & fsutil usn deletejournal /d %.*% .*`) and ($selection1.metadata.product_event_type = "4688" or $selection1.metadata.product_event_type = "1"))
<li><a href="#">events: (($selection2.target.process.command_line = "cmd.exe\" /c wmic /node:localhost /namespace:\\\\root\\securitycenter2 path antivirusproduct get displayname /format:list" or $selection2.target.process.command_line = "schtasks.exe /create /f /tn \"sc scheduled scan\" /xml \"c:\\users\\admin\\appdata\\local\\microsoft\\taskbar\\scscan.xml" or $selection2.target.process.command_line = "ipconfig /flushdns" or re.regex($selection2.target.process.command_line, `cmd\.exe /c copy \"c:\\users\\admin\\appdata\\local\\temp.*\.doc\" \"c:\\users\\admin\\appdata\\roaming\\tmp\.doc`) or re.regex($selection2.target.process.command_line, `cmd\.exe /c schtasks /create /sc minute /mo 3 /tn \"inetlsecurityassistmanager\" /tr \"c:\\users\\admin\\appdata\\local\\temp.*\.exe\" /f`) or $selection2.target.process.command_line = "cmd.exe\" /c start /b schtasks /query /fo csv" or $selection2.target.process.command_line = "powershell.exe\" -exec bypass -file c:\\programdata\\office365dcomcheck.ps1") and ($selection2.metadata.product_event_type = "4688" or $selection2.metadata.product_event_type = "1"))
<li><a href="#">events: (($selection2.target.process.command_line = "rundll32.exe c:\\users\\admin\\appdata\\local\\temp\\cred.dll, main" or re.regex($selection2.target.process.command_line, `msiexec\.exe stop=1 /i http://.*\..*\..*\..*/dom.* /q ksw=%temp%`) or re.regex($selection2.target.process.command_line, `msiexec\.exe stop=1 /i https://.*\..*\..*\..*/dom.* /q ksw=%temp%`) or $selection2.target.process.command_line = "reg add \"hkcu\\software\\microsoft\\windows\\currentversion\\explorer\\user shell folders\" /f /v startup /t reg_sz /d c:\\programdata\\87e4c89e95" or re.regex($selection2.target.process.command_line, `reg add \"hkcu\\software\\microsoft\\windows\\currentversion\\explorer\\user shell folders\" /f /v startup /t reg_sz /d c:\\programdata\\87.*`)) and ($selection2.metadata.product_event_type = "4688" or $selection2.metadata.product_event_type = "1"))
<li><a href="#">events: (($selectionhash.metadata.product_event_type = "1" and ($selectionhash.target.file.md5 = "d7bc8e19721fdd0eea29de2b0f17504c7c2f62ad" or $selectionhash.target.file.md5 = "8fb0124def0e5a7a12495ede2a20a9c48a7929a6" or $selectionhash.target.file.md5 = "d14a360ffa7645693ee6e19bc2b64cf7707504c8" or $selectionhash.target.file.md5 = "777db69f7c22f6481fd2246a0fe444d410281270")) or ($selectionhash.metadata.product_event_type = "13" and re.regex($selectionhash.target.registry.registry_key, `.*\\software\\microsoft\\windows\\currentversion\\run\\audiomgr`)))
<li><a href="#">events: (($selectionsrc.principal.ip = "138.36.3.228" or $selectionsrc.principal.ip = "184.75.209.169" or $selectionsrc.principal.ip = "177.85.98.242") or ($selectionsrc.target.ip = "138.36.3.228" or $selectionsrc.target.ip = "184.75.209.169" or $selectionsrc.target.ip = "177.85.98.242") or ($selectionsrc.target.url = "" or $selectionsrc.target.url = "" or $selectionsrc.target.url = "") or (re.regex($selectionsrc.target.hostname, `.*office365update\.duckdns\.org.*`) or re.regex($selectionsrc.target.hostname, `.*systen32\.ddns\.net.*`)))
<li><a href="#">events: (($selectionsrc.principal.ip = "185.77.129.106" or $selectionsrc.principal.ip = "185.144.82.239" or $selectionsrc.principal.ip = "93.113.131.103" or $selectionsrc.principal.ip = "185.86.149.54" or $selectionsrc.principal.ip = "185.86.151.104" or $selectionsrc.principal.ip = "103.41.177.43" or $selectionsrc.principal.ip = "185.86.148.184" or $selectionsrc.principal.ip = "185.94.191.65" or $selectionsrc.principal.ip = "86.106.131.54" or $selectionsrc.principal.ip = "169.239.12.133" or $selectionsrc.principal.ip = "185.86.151.2") or ($selectionsrc.target.ip = "185.77.129.106" or $selectionsrc.target.ip = "185.144.82.239" or $selectionsrc.target.ip = "93.113.131.103" or $selectionsrc.target.ip = "185.86.149.54" or $selectionsrc.target.ip = "185.86.151.104" or $selectionsrc.target.ip = "103.41.177.43" or $selectionsrc.target.ip = "185.86.148.184" or $selectionsrc.target.ip = "185.94.191.65" or $selectionsrc.target.ip = "86.106.131.54" or $selectionsrc.target.ip = "169.239.12.133" or $selectionsrc.target.ip = "185.86.151.2") or (re.regex($selectionsrc.target.hostname, `.*secao\.org.*`) or re.regex($selectionsrc.target.hostname, `.*ikmtrust\.com.*`) or re.regex($selectionsrc.target.hostname, `.*sysanalyticweb\.com.*`) or re.regex($selectionsrc.target.hostname, `.*lxwo\.org.*`) or re.regex($selectionsrc.target.hostname, `.*jflynci\.com.*`) or re.regex($selectionsrc.target.hostname, `.*remotepx\.net.*`) or re.regex($selectionsrc.target.hostname, `.*rdsnets\.com.*`) or re.regex($selectionsrc.target.hostname, `.*rpcnetconnect\.com.*`) or re.regex($selectionsrc.target.hostname, `.*webstp\.com.*`) or re.regex($selectionsrc.target.hostname, `.*elaxo\.org.*`)))
<li><a href="#">events: (($selectionsrc.target.url = "chimachinenow.com" or $selectionsrc.target.url = "highlandfamily.org" or $selectionsrc.target.url = "intra.cfecgcaquitaine.com" or $selectionsrc.target.url = "motifahsap.com" or $selectionsrc.target.url = "sittalhaphedver.com" or $selectionsrc.target.url = "wassronledorhad.in" or $selectionsrc.target.url = "balzantruck.com" or $selectionsrc.target.url = "buyviagraoverthecounterusabb.net" or $selectionsrc.target.url = "fifa2018start.info" or $selectionsrc.target.url = "buyviagraoverthecounterusabb.net/documents/b123456789012.js" or $selectionsrc.target.url = "chimachinenow.com/kjdhc783" or $selectionsrc.target.url = "highlandfamily.org/kjdhc783" or $selectionsrc.target.url = "intra.cfecgcaquitaine.com/kjdhc783" or $selectionsrc.target.url = "motifahsap.com/kjdhc783" or $selectionsrc.target.url = "sittalhaphedver.com/p66/kjdhc783" or $selectionsrc.target.url = "wassronledorhad.in/q2/index.php" or $selectionsrc.target.url = "balzantruck.com/45rt.exe") or ($selectionsrc.principal.ip = "179.60.146.3" or $selectionsrc.principal.ip = "185.176.221.54" or $selectionsrc.principal.ip = "179.60.146.3" or $selectionsrc.principal.ip = "194.165.16.11") or ($selectionsrc.target.ip = "179.60.146.3" or $selectionsrc.target.ip = "185.176.221.54" or $selectionsrc.target.ip = "179.60.146.3" or $selectionsrc.target.ip = "194.165.16.11"))
<li><a href="#">events: (($service_installation.target.process.command_line = "psexesvc" and (($service_installation.metadata.product_event_type = "7045" and re.regex($service_installation.target.process.command_line, `.*\\psexesvc\.exe`)) or $service_installation.metadata.product_event_type = "7036")) or ($service_installation.metadata.product_event_type = "1" and re.regex($service_installation.target.process.file.full_path, `.*\\psexesvc\.exe`) and $service_installation.src.user.user_display_name = "nt authority\\system"))
<li><a href="#">events: ((($selection.metadata.product_event_type = "12" or $selection.metadata.product_event_type = "13") and re.regex($selection.target.registry.registry_key, `.*\\system\\currentcontrolset\\services\\physmem2profit\\.*`)) or ($selection.metadata.product_event_type = "6" and re.regex($selection.target.process.file.full_path, `.*att_winpmem_64\.sys`)) or ($selection.metadata.product_event_type = "6" and $selection.target.registry.registry_value_data = "binalyze llc"))
<li><a href="#">events: ((($selection.src.application = "ssh" or $selection.src.application = "sftp" or $selection.src.application = "ftp") and ($selection.target.ip = "172.16.0.0/16" or $selection.target.ip = "192.168.0.0/16" or $selection.target.ip = "10.0.0.0/8")) or ((($selection.target.port = "22" or $selection.target.port = "21") and ($selection.target.ip = "172.16.0.0/16" or $selection.target.ip = "192.168.0.0/16" or $selection.target.ip = "10.0.0.0/8")) and not (($selection.principal.ip = "allowed ip address list" or $selection.principal.ip = "172.16.0.0/16" or $selection.principal.ip = "192.168.0.0/16" or $selection.principal.ip = "10.0.0.0/8"))))
<li><a href="#">events: ((($selection.target.file.full_path = "cmd.exe" or $selection.target.file.full_path = "powershell.exe" or $selection.target.file.full_path = "powershell_ise.exe" or $selection.target.file.full_path = "psexec.exe" or $selection.target.file.full_path = "psexec.c" or $selection.target.file.full_path = "cscript.exe" or $selection.target.file.full_path = "wscript.exe" or $selection.target.file.full_path = "mshta.exe" or $selection.target.file.full_path = "regsvr32.exe" or $selection.target.file.full_path = "wmic.exe" or $selection.target.file.full_path = "certutil.exe" or $selection.target.file.full_path = "rundll32.exe" or $selection.target.file.full_path = "cmstp.exe" or $selection.target.file.full_path = "msiexec.exe" or $selection.target.file.full_path = "7z.exe" or $selection.target.file.full_path = "winrar.exe") and ($selection.metadata.product_event_type = "4688" or $selection.metadata.product_event_type = "1")) and not ((re.regex($selection.target.process.file.full_path, `.*\\cmd\.exe`) or re.regex($selection.target.process.file.full_path, `.*\\powershell\.exe`) or re.regex($selection.target.process.file.full_path, `.*\\powershell_ise\.exe`) or re.regex($selection.target.process.file.full_path, `.*\\psexec\.exe`) or re.regex($selection.target.process.file.full_path, `.*\\psexec64\.exe`) or re.regex($selection.target.process.file.full_path, `.*\\cscript\.exe`) or re.regex($selection.target.process.file.full_path, `.*\\wscript\.exe`) or re.regex($selection.target.process.file.full_path, `.*\\mshta\.exe`) or re.regex($selection.target.process.file.full_path, `.*\\regsvr32\.exe`) or re.regex($selection.target.process.file.full_path, `.*\\wmic\.exe`) or re.regex($selection.target.process.file.full_path, `.*\\certutil\.exe`) or re.regex($selection.target.process.file.full_path, `.*\\rundll32\.exe`) or re.regex($selection.target.process.file.full_path, `.*\\cmstp\.exe`) or re.regex($selection.target.process.file.full_path, `.*\\msiexec\.exe`) or re.regex($selection.target.process.file.full_path, `.*\\7z\.exe`) or re.regex($selection.target.process.file.full_path, `.*\\winrar\.exe`))))
<li><a href="#">events: ((($selection_uacs.metadata.product_event_type = "7" and re.regex($selection_uacs.target.process.file.full_path, `.*useraccountcontrolsettings\.exe`) and re.regex($selection_uacs.target.process.file.full_path, `.*cryptbase\.dll`)) and not (re.regex($selection_uacs.target.process.file.full_path, `.*windows\\system32.*`))) or (($selection_uacs.metadata.product_event_type = "7" and re.regex($selection_uacs.target.process.file.full_path, `.*winword\.exe`) and re.regex($selection_uacs.target.process.file.full_path, `.*oart\.dll`)) and not (re.regex($selection_uacs.target.process.file.full_path, `.*program files.*\\microsoft office\\root\\office16\\.*`))))
<li><a href="#">events: ((($selection1.metadata.product_event_type = "1" and $selection1.target.process.command_line = "c:\\windows\\syswow64\\werfault.exe -u -p 6184 -s 1124") or ($selection1.metadata.product_event_type = "11" and (re.regex($selection1.target.file.full_path, `.*\\appdata\\roaming\\microsyncs\\myhtc\.exe`) or re.regex($selection1.target.file.full_path, `.*\\appdata\\local\\temp\\install\.vbs`)))) or ($selection1.metadata.product_event_type = "13" and (re.regex($selection1.target.registry.registry_key, `.*\\software\\microsoft\\windows\\currentversion\\applicationassociationtoasts\\vbsfile_\.vbs`) or re.regex($selection1.target.registry.registry_key, `.*\\software\\microsoft\\windows\\currentversion\\explorer\\fileexts\\\.vbs\\openwithprogids\\vbsfile`) or re.regex($selection1.target.registry.registry_key, `.*\\local settings\\software\\microsoft\\windows\\shell\\muicache\\c:\\windows\\system32\\wscript\.exe\.applicationcompany`) or re.regex($selection1.target.registry.registry_key, `.*\\software\\microsoft\\windows\\shell\\muicache\\c:\\windows\\system32\\wscript\.exe\.friendlyappname`) or re.regex($selection1.target.registry.registry_key, `.*\\software\\microsoft\\windows\\currentversion\\internet settings\\zonemap\\autodetect`) or re.regex($selection1.target.registry.registry_key, `.*\\software\\microsoft\\windows\\currentversion\\internet settings\\zonemap\\uncasintranet`) or re.regex($selection1.target.registry.registry_key, `.*\\software\\microsoft\\windows\\currentversion\\internet settings\\zonemap\\intranetname`) or re.regex($selection1.target.registry.registry_key, `.*\\software\\microsoft\\windows\\currentversion\\internet settings\\zonemap\\proxybypass`))))
<li><a href="#">events: ((($selection1.metadata.product_event_type = "1" and ((($selection1.target.process.file.full_path = "c:\\\\windows\\\\system32\\\\windowspowershell\\\\v1.0\\\\powershell.exe " and $selection1.target.process.command_line = "powershell -windowstyle hidden ") or (re.regex($selection1.target.process.file.full_path, `.*csc\.exe`) and re.regex($selection1.target.process.command_line, `.*csc\.exe\" /noconfig /fullpaths @c:.*\.cmdline `) and $selection1.src.process.file.full_path = "c:\\\\windows\\\\system32\\\\windowspowershell\\\\v1.0\\\\powershell.exe ")) or (re.regex($selection1.target.process.file.full_path, `.*cvtres\.exe`) and re.regex($selection1.src.process.file.full_path, `.*csc\.exe`)))) or ($selection1.metadata.product_event_type = "3" and re.regex($selection1.target.process.file.full_path, `.*eqnedt32\.exe`) and $selection1.target.ip = "127.0.0.1")) or ($selection1.metadata.product_event_type = "11" and re.regex($selection1.target.process.file.full_path, `.*powershell\.exe`) and (re.regex($selection1.target.file.full_path, `.*\\appdata\\local\\temp.*\.tmp`) or re.regex($selection1.target.file.full_path, `.*\\appdata\\local\\temp.*\.out`) or re.regex($selection1.target.file.full_path, `.*\\appdata\\local\\temp.*\.err`) or re.regex($selection1.target.file.full_path, `.*\\appdata\\local\\temp.*\.dll`) or re.regex($selection1.target.file.full_path, `.*\\appdata\\roaming.*\.exe`))))
<li><a href="#">events: ((($selection1.metadata.product_event_type = "1" and re.regex($selection1.target.process.file.full_path, `.*\\schtasks\.exe`) and re.regex($selection1.target.process.command_line, `.* /create .*`)) or ($selection1.metadata.product_event_type = "12" and $selection1.target.process.file.full_path = "c:\\windows\\system32\\schtasks.exe")) or ($selection1.metadata.product_event_type = "13" and re.regex($selection1.target.registry.registry_key, `.*\\schedule\\taskcache\\tasks\\`)))
<li><a href="#">events: ((($selection1.metadata.product_event_type = "11" and ($selection1.target.file.full_path = "c:\\programdata\\mozilla\\updates\\mozilla-x86-ui.exe" or $selection1.target.file.full_path = "c:\\programdata\\mozilla\\updates\\system.web.helpers.dll")) or ($selection1.metadata.product_event_type = "13" and ($selection1.target.registry.registry_key = "hklm\\system\\currentcontrolset\\control\\windows\\environmentadditionalset" or re.regex($selection1.target.registry.registry_key, `hklm\\software\\mozilla\\input\\locales\\loc_3c01\\inputmethods\\1.*`) or $selection1.target.registry.registry_key = "hklm\\system\\currentcontrolset\\control\\windows\\environmentadditionalset"))) or ($selection1.metadata.product_event_type = "1" and $selection1.target.process.file.full_path = "fondue.exe"))
<li><a href="#">events: ((($selection1.metadata.product_event_type = "11" and re.regex($selection1.target.process.file.full_path, `.*\.powershell\.exe`) and re.regex($selection1.target.file.full_path, `.*\.zip`)) or ($selection1.metadata.product_event_type = "1" and re.regex($selection1.target.process.file.full_path, `.*rar\.exe`) and re.regex($selection1.target.process.command_line, `.*\.rar`))) or ($selection1.metadata.product_event_type = "11" and re.regex($selection1.target.process.file.full_path, `.*rar\.exe`) and re.regex($selection1.target.file.full_path, `.*\.rar`)))
<li><a href="#">events: ((($selection1.metadata.product_event_type = "13" and $selection1.target.registry.registry_key = "hkcu\\software\\microsoft\\windows\\currentversion\\run" and $selection1.metadata.description = "f5dbf765") or ($selection1.metadata.product_event_type = "11" and (re.regex($selection1.target.file.full_path, `c:\\users.*\\appdata\\roaming\\5145c9bd\\bin\.exe`) or re.regex($selection1.target.file.full_path, `.*\\appdata\\locallow\\f5dbf765`) or re.regex($selection1.target.file.full_path, `.*\\f5dbf765`) or re.regex($selection1.target.file.full_path, `.*\\f5dbf765\\bin\.exe`)))) or ($selection1.metadata.product_event_type = "1" and (re.regex($selection1.target.process.file.full_path, `.*\\appdata\\roaming\\5145c9bd\\bin\.exe`) or re.regex($selection1.target.process.file.full_path, `.*\\f5dbf765\\bin\.exe`))))
<li><a href="#">events: ((($selection1.metadata.product_event_type = "13" and $selection1.target.registry.registry_key = "hklm\\system\\controlset001\\services\\winmss" and ($selection1.metadata.description = "type" or $selection1.metadata.description = "start" or $selection1.metadata.description = "errorcontrol" or $selection1.metadata.description = "imagepath" or $selection1.metadata.description = "displayname" or $selection1.metadata.description = "wow64" or $selection1.metadata.description = "objectname" or $selection1.metadata.description = "description")) or ($selection1.metadata.product_event_type = "11" and (re.regex($selection1.target.file.full_path, `.*\\sfcapi`) or $selection1.target.file.full_path = "c:\\inf\\oem13.pnf" or $selection1.target.file.full_path = "c:\\inf\\oem13.inf" or $selection1.target.file.full_path = "c:\\lastgood\\system32\\drivers\\winyyy.sys (copy)" or $selection1.target.file.full_path = "c:\\temp\\old5.tmp" or $selection1.target.file.full_path = "c:\\inf\\infcache.0" or $selection1.target.file.full_path = "c:\\inf\\infcache.1 (copy)" or $selection1.target.file.full_path = "c:\\stin.bat" or $selection1.target.file.full_path = "c:\\windows\\system32\\drivers\\winyyy.sys (copy)" or $selection1.target.file.full_path = "c:\\windows\\system32\\drivers\\set3.tmp" or $selection1.target.file.full_path = "c:\\windows\\system32\\drivers\\set6.tmp" or $selection1.target.file.full_path = "c:\\winsys.exe" or $selection1.target.file.full_path = "c:\\winsys.inf" or $selection1.target.file.full_path = "c:\\winyyy.sys" or $selection1.target.file.full_path = "c:\\smss.bat" or $selection1.target.file.full_path = "c:\\lsass.exe" or $selection1.target.file.full_path = "c:\\winhost.exe" or $selection1.target.file.full_path = "c:\\syswow64\\smss.bat" or $selection1.target.file.full_path = "c:\\syswow64\\lsasys.exe" or $selection1.target.file.full_path = "c:\\syswow64\\winhost.exe" or $selection1.target.file.full_path = "c:\\windows\\system32\\smss.bat" or $selection1.target.file.full_path = "c:\\windows\\system32\\lsasys.exe" or $selection1.target.file.full_path = "c:\\windows\\system32\\winhost.exe"))) or ($selection1.metadata.product_event_type = "1" and ($selection1.target.process.file.full_path = "c:\\windows\\system32\\winhost.exe" or $selection1.target.process.file.full_path = "c:\\windows\\system32\\lsasys.exe" or $selection1.target.process.file.full_path = "c:\\syswow64\\winhost.exe" or $selection1.target.process.file.full_path = "c:\\syswow64\\lsasys.exe" or $selection1.target.process.file.full_path = "c:\\lsass.exe" or $selection1.target.process.file.full_path = "c:\\winsys.exe")))
<li><a href="#">events: ((($selection1.metadata.product_event_type = "13" and (($selection1.target.registry.registry_key = "hklm\\system\\controlset001\\services\\sharedaccess\\parameters\\firewallpolicy\\standardprofile\\authorizedapplications\\list" and $selection1.metadata.description = "c:\\windows\\m-5050402520507690204050\\winmgr.exe") or (($selection1.target.registry.registry_key = "hklm\\software\\wow6432node\\microsoft\\windows\\currentversion\\run" or $selection1.target.registry.registry_key = "hkcu\\software\\microsoft\\windows\\currentversion\\run") and $selection1.metadata.description = "microsoft windows manager"))) or ($selection1.metadata.product_event_type = "11" and (re.regex($selection1.target.file.full_path, `.*\\secret\.exe`) or re.regex($selection1.target.file.full_path, `.*\\documents\.exe`) or re.regex($selection1.target.file.full_path, `.*\\pictures\.exe`) or re.regex($selection1.target.file.full_path, `.*\\505050\.exe`) or re.regex($selection1.target.file.full_path, `.*\\movies\.exe`) or re.regex($selection1.target.file.full_path, `.*\\private\.exe`) or re.regex($selection1.target.file.full_path, `.*\\windrv\.exe`) or re.regex($selection1.target.file.full_path, `c:\\users.*\\appdata\\roaming\\winmgr\.txt`) or $selection1.target.file.full_path = "e:\\autorun.inf" or $selection1.target.file.full_path = "d:\\autorun.inf" or $selection1.target.file.full_path = "c:\\windows\\m-5050402520507690204050" or $selection1.target.file.full_path = "c:\\windows\\m-5050402520507690204050\\winmgr.exe"))) or ($selection1.metadata.product_event_type = "1" and ($selection1.target.process.file.full_path = "c:\\windows\\m-5050402520507690204050\\winmgr.exe" or re.regex($selection1.target.process.file.full_path, `.*\\secret\.exe`) or re.regex($selection1.target.process.file.full_path, `.*\\documents\.exe`) or re.regex($selection1.target.process.file.full_path, `.*\\pictures\.exe`) or re.regex($selection1.target.process.file.full_path, `.*\\505050\.exe`) or re.regex($selection1.target.process.file.full_path, `.*\\movies\.exe`) or re.regex($selection1.target.process.file.full_path, `.*\\private\.exe`) or re.regex($selection1.target.process.file.full_path, `.*\\windrv\.exe`))))
<li><a href="#">events: ((($selection1.metadata.product_event_type = "13" and (((($selection1.target.registry.registry_key = "hkcu\\software\\vb and vba program settings\\hcmi61124620925\\x60e5372900416" or $selection1.target.registry.registry_key = "hkcu\\software\\vb and vba program settings\\hcmi61124620925" or $selection1.target.registry.registry_key = "hkcu\\software\\vb and vba program settings" or $selection1.target.registry.registry_key = "hkcu\\software\\microsoft\\windows script host\\settings" or $selection1.target.registry.registry_key = "hklm\\software\\microsoft\\radar\\heapleakdetection\\settings\\leakdiagnosisattempted" or $selection1.target.registry.registry_key = "hklm\\" or $selection1.target.registry.registry_key = "hklm\\" or $selection1.target.registry.registry_key = "hklm\\" or $selection1.target.registry.registry_key = "hklm\\" or $selection1.target.registry.registry_key = "hklm\\" or $selection1.target.registry.registry_key = "hklm\\" or $selection1.target.registry.registry_key = "hklm\\" or $selection1.target.registry.registry_key = "hklm\\" or $selection1.target.registry.registry_key = "hklm\\" or $selection1.target.registry.registry_key = "hklm\\software\\microsoft\\radar\\heapleakdetection\\diagnosedapplications\\40413c204bb0867c9e93f83dc86d23cfcd420485519ffe9d27557585677d66d6.exe" or $selection1.target.registry.registry_key = "hklm\\" or $selection1.target.registry.registry_key = "hklm\\" or $selection1.target.registry.registry_key = "hklm\\" or $selection1.target.registry.registry_key = "hklm\\" or $selection1.target.registry.registry_key = "hklm\\") or ($selection1.target.registry.registry_key = "hkcu\\software\\microsoft\\windows\\currentversion\\run" and $selection1.metadata.description = "cghjjfygjhkjhgfghjt")) or ($selection1.target.registry.registry_key = "hklm\\software\\microsoft\\radar\\heapleakdetection\\diagnosedapplications\\40413c204bb0867c9e93f83dc86d23cfcd420485519ffe9d27557585677d66d6.exe" and $selection1.metadata.description = "lastdetectiontime")) or ($selection1.target.registry.registry_key = "hkcu\\software\\vb and vba program settings\\hcmi61124620925\\x60e5372900416" and $selection1.metadata.description = "bnvpl1584056334"))) or ($selection1.metadata.product_event_type = "11" and (re.regex($selection1.target.file.full_path, `.*\\d282e1\\1e80c5\.lck`) or re.regex($selection1.target.file.full_path, `.*\\d282e1`) or re.regex($selection1.target.file.full_path, `.*\\subfolder\\filename\.vbs`) or re.regex($selection1.target.file.full_path, `.*\\subfolder`) or re.regex($selection1.target.file.full_path, `.*\\subfolder\\filename\.exe`) or re.regex($selection1.target.file.full_path, `.*\\cghjjfygjhkjhgfghjt`) or re.regex($selection1.target.file.full_path, `.*\\cghjjfygjhkjhgfghjt\\cghjjfygjhkjhgfghjt\.exe`) or re.regex($selection1.target.file.full_path, `.*\\cghjjfygjhkjhgfghjt\\cghjjfygjhkjhgfghjt\.vbs`)))) or ($selection1.metadata.product_event_type = "1" and (re.regex($selection1.target.process.file.full_path, `.*\\filename\.exe`) or re.regex($selection1.target.process.file.full_path, `.*\\cghjjfygjhkjhgfghjt\\cghjjfygjhkjhgfghjt\.exe`))))
<li><a href="#">events: ((($selection1.target.process.file.full_path = "cmd.exe" or $selection1.target.process.file.full_path = "javaw.exe") and (re.regex($selection1.target.process.command_line, `.* cmd\.exe /c cscript\.exe c:\\users.*\\appdata\\local\\temp\\retrive5740188186602551395\.vbs .*`) or re.regex($selection1.target.process.command_line, `.* cmd\.exe /c cscript\.exe c:\\users.*\\appdata\\local\\temp.*\.vbs .*`) or re.regex($selection1.target.process.command_line, `.* c:\\program files\\java\\jre1\.8\.0_92\\bin\\javaw\.exe\" -jar c:\\users.*\\appdata\\roaming\\uyrysfn\.txt .*`) or re.regex($selection1.target.process.command_line, ` .*c:\\program files\\java\\jre1\.8\.0_92\\bin\\javaw\.exe -jar c:\\users.*\\appdata\\roaming.*\.txt.* `)) and ($selection1.metadata.product_event_type = "4688" or $selection1.metadata.product_event_type = "1")) or ($selection1.metadata.product_event_type = "13" and re.regex($selection1.target.registry.registry_key, `.* .*\\software\\microsoft\\windows\\currentversion\\run .* `) and re.regex($selection1.metadata.description, `.* c:\\users\\admin\\appdata\\roaming\\oracle\\bin\\javaw\.exe -jar c:\\users\\admin\\oracle corporations\\oracles java\.jar .*`)))
<li><a href="#">events: (((($exec_selection.metadata.product_event_type = "1" and re.regex($exec_selection.src.process.file.full_path, `.*\\userinit\.exe`)) and not (re.regex($exec_selection.target.process.file.full_path, `.*\\explorer\.exe`) and re.regex($exec_selection.target.process.command_line, `.*\\netlogon\.bat`))) or (($exec_selection.metadata.product_event_type = "11" or $exec_selection.metadata.product_event_type = "12" or $exec_selection.metadata.product_event_type = "13" or $exec_selection.metadata.product_event_type = "14") and re.regex($exec_selection.target.registry.registry_key, `.*userinitmprlogonscript.*`))) or ($exec_selection.metadata.product_event_type = "1" and re.regex($exec_selection.target.process.command_line, `.*userinitmprlogonscript.*`)))
<li><a href="#">events: (((($selection1.metadata.product_event_type = "11" and $selection1.target.file.full_path = "c:\\windows\\lsass.exe") or ($selection1.metadata.product_event_type = "13" and $selection1.target.registry.registry_key = "hklm\\software\\wow6432node\\microsoft\\windows\\currentversion\\run\\traybar" and $selection1.target.registry.registry_value_data = "c:\\windows\\lsass.exe")) or ($selection1.metadata.product_event_type = "11" and (re.regex($selection1.target.file.full_path, `c:\\users.*\\appdata\\local\\temp.*\\lsass\.exe`) or re.regex($selection1.target.file.full_path, `c:\\users.*\\appdata\\local\\temp\\lsass\.exe`)))) or ($selection1.metadata.product_event_type = "1" and ($selection1.target.process.file.full_path = "c:\\windows\\lsass.exe" or re.regex($selection1.target.process.file.full_path, `c:\\users.*\\appdata\\local\\temp\\lsass\.exe`) or re.regex($selection1.target.process.file.full_path, `c:\\users.*\\appdata\\local\\temp.*\\lsass\.exe`))))
<li><a href="#">events: (((((($selection1.metadata.product_event_type = "1" and (re.regex($selection1.target.process.file.full_path, `.*\\winlogon\.exe`) or re.regex($selection1.target.process.file.full_path, `.*\\wininit\.exe`) or re.regex($selection1.target.process.file.full_path, `.*\\csrss\.exe`))) and not (re.regex($selection1.src.process.file.full_path, `.*\\smss\.exe`))) or (($selection1.metadata.product_event_type = "1" and (re.regex($selection1.target.process.file.full_path, `.*\\tashost\.exe`) or re.regex($selection1.target.process.file.full_path, `.*\\svchost\.exe`))) and not (re.regex($selection1.src.process.file.full_path, `.*\\services\.exe`)))) or (($selection1.metadata.product_event_type = "1" and (re.regex($selection1.target.process.file.full_path, `.*\\lsass\.exe`) or re.regex($selection1.target.process.file.full_path, `.*\\lsm\.exe`) or re.regex($selection1.target.process.file.full_path, `.*\\services\.exe`) or re.regex($selection1.target.process.file.full_path, `.*\\lsaiso\.exe`))) and not (re.regex($selection1.src.process.file.full_path, `.*\\wininit\.exe`)))) or (($selection1.metadata.product_event_type = "1" and re.regex($selection1.target.process.file.full_path, `.*\\iexplore\.exe`)) and not (re.regex($selection1.src.process.file.full_path, `.*\\explorer\.exe`)))) or (($selection1.metadata.product_event_type = "1" and (re.regex($selection1.target.process.file.full_path, `.*\\runtimebroker\.exe`) or re.regex($selection1.target.process.file.full_path, `.*\\taskhostw\.exe`))) and not (re.regex($selection1.src.process.file.full_path, `.*\\svchost\.exe`))))
<li><a href="#">events: ((((((((((((($selectionsysmon3_emanueledelucia.target.url = "" or $selectionsysmon3_emanueledelucia.target.url = "beatguitar.com" or $selectionsysmon3_emanueledelucia.target.ip = "185.99.133.72") or ($selectionsysmon3_emanueledelucia.metadata.product_event_type = "1" and $selectionsysmon3_emanueledelucia.target.file.md5 = "549726b8bfb1919a343ac764d48fdc81")) or ($selectionsysmon3_emanueledelucia.metadata.product_event_type = "1" and $selectionsysmon3_emanueledelucia.target.file.md5 = "43d7ffd611932cf51d7150b176ecfc29")) or ($selectionsysmon3_emanueledelucia.metadata.product_event_type = "3" and $selectionsysmon3_emanueledelucia.target.ip = "185.99.133.72")) or ($selectionsysmon3_emanueledelucia.metadata.product_event_type = "13" and $selectionsysmon3_emanueledelucia.target.registry.registry_key = "software\\microsoft\\windows\\currentversion\\run\\uimgr")) or ($selectionsysmon3_emanueledelucia.metadata.product_event_type = "1" and $selectionsysmon3_emanueledelucia.target.file.md5 = "02c46f30f4c68a442cf7e13bebe8d3f8")) or ($selectionsysmon3_emanueledelucia.metadata.product_event_type = "1" and $selectionsysmon3_emanueledelucia.target.file.md5 = "1aedaa67e7613594c135177f2973e2c7")) or ($selectionsysmon3_emanueledelucia.metadata.product_event_type = "1" and $selectionsysmon3_emanueledelucia.target.file.md5 = "602d2901d55c2720f955503456ac2f68")) or ($selectionsysmon3_emanueledelucia.metadata.product_event_type = "1" and $selectionsysmon3_emanueledelucia.target.file.md5 = "602d2901d55c2720f955503456ac2f68")) or ($selectionsysmon3_emanueledelucia.metadata.product_event_type = "1" and ($selectionsysmon3_emanueledelucia.target.file.md5 = "3eaf97b9c6b44f0447f2bd1c7acb8c96" or $selectionsysmon3_emanueledelucia.target.file.md5 = "6bc5f53d4082f12dd83aca45bae81e64" or $selectionsysmon3_emanueledelucia.target.file.md5 = "333d2b9e99b36fb42f9e79a2833fad9c")) or $selectionsysmon3_emanueledelucia.target.ip = "89.37.226.123" or $selectionsysmon3_emanueledelucia.target.url = "/advance/portable_version/service.php") or ($selectionsysmon3_emanueledelucia.metadata.product_event_type = "1" and ($selectionsysmon3_emanueledelucia.target.file.md5 = "84352ccad3cfa152d98cf76b08623b92" or $selectionsysmon3_emanueledelucia.target.file.md5 = "fe0da70a592d25ddbfbd47b22f88542f" or $selectionsysmon3_emanueledelucia.target.file.md5 = "4384c701308a9d3aa92f49615ec74b2d" or $selectionsysmon3_emanueledelucia.target.file.md5 = "26b213343bac2b4c69a261a2f5c00e89" or $selectionsysmon3_emanueledelucia.target.file.md5 = "47a026d93ae8e0cc292e8d7a71ddc89e"))) or ($selectionsysmon3_emanueledelucia.metadata.product_event_type = "11" and ($selectionsysmon3_emanueledelucia.target.file.full_path = "c:\\users\\public\\dset.ini" or $selectionsysmon3_emanueledelucia.target.file.full_path = "c:\\users\\public\\boot.ini" or $selectionsysmon3_emanueledelucia.target.file.full_path = "c:\\users\\public\\kla.bin" or $selectionsysmon3_emanueledelucia.target.file.full_path = "c:\\users\\public\\officeexcp.bin" or $selectionsysmon3_emanueledelucia.target.file.full_path = "c:\\users\\public\\dset.ini"))) or ($selectionsysmon3_emanueledelucia.metadata.product_event_type = "1" and ($selectionsysmon3_emanueledelucia.target.file.md5 = "ea553c3de3fffbfa047e8e0eb2557b8b" or $selectionsysmon3_emanueledelucia.target.file.md5 = "8da56a4b1a5ff8e4643421a5fefb5dc4" or $selectionsysmon3_emanueledelucia.target.file.md5 = "a225d457c3396e647ffc710cd1edd4c74dc57152")))
<li><a href="#">events: (((((((((((((((($selectionmd5_dttcodexgigas.metadata.product_event_type = "1" and ($selectionmd5_dttcodexgigas.target.file.md5 = "1fe6af243760ca287f80eafbb98ba1b0" or $selectionmd5_dttcodexgigas.target.file.md5 = "7e67122d3a052e4755b02965e2e56a2e" or $selectionmd5_dttcodexgigas.target.file.md5 = "a13c864980159cd9bdc94074b2389dda" or $selectionmd5_dttcodexgigas.target.file.md5 = "f4cab3a393462a57639faa978a75d10a" or $selectionmd5_dttcodexgigas.target.file.md5 = "e57a401e8f0943b703d975692fcfc0e8")) or ($selectionmd5_dttcodexgigas.metadata.product_event_type = "3" and $selectionmd5_dttcodexgigas.target.ip = "185.217.92.119")) or ($selectionmd5_dttcodexgigas.metadata.product_event_type = "3" and $selectionmd5_dttcodexgigas.target.ip = "109.248.148.42") or $selectionmd5_dttcodexgigas.target.ip = "185.217.92.119" or $selectionmd5_dttcodexgigas.target.ip = "109.248.148.42" or $selectionmd5_dttcodexgigas.target.url = "" or $selectionmd5_dttcodexgigas.target.url = "" or $selectionmd5_dttcodexgigas.target.url = "" or $selectionmd5_dttcodexgigas.target.url = "/agr-enum/progress-inform/cube.php?res=") or ($selectionmd5_dttcodexgigas.metadata.product_event_type = "1" and $selectionmd5_dttcodexgigas.target.file.md5 = "445c84d3f3b26b4c254114db56849157")) or ($selectionmd5_dttcodexgigas.metadata.product_event_type = "13" and $selectionmd5_dttcodexgigas.target.registry.registry_key = "software\\microsoft\\windows\\currentversion\\run\\audiomgr")) or ($selectionmd5_dttcodexgigas.metadata.product_event_type = "13" and $selectionmd5_dttcodexgigas.target.registry.registry_key = "software\\microsoft\\windows\\currentversion\\run\\googleindexer")) or ($selectionmd5_dttcodexgigas.metadata.product_event_type = "1" and $selectionmd5_dttcodexgigas.target.file.md5 = "604b3e7d9b11afbdf525336cefc97f88a85dd3a2f0801277d5c7619d6bceb605")) or ($selectionmd5_dttcodexgigas.metadata.product_event_type = "1" and $selectionmd5_dttcodexgigas.target.file.md5 = "87bffb0370c9e14ed5d01d6cc0747cb30a544a71345ea68ef235320378f582ef")) or ($selectionmd5_dttcodexgigas.metadata.product_event_type = "1" and $selectionmd5_dttcodexgigas.target.file.md5 = "a6576282d17cca390e35306a423dcb5ac9276c28eaba63f74001757edc3688df")) or ($selectionmd5_dttcodexgigas.metadata.product_event_type = "1" and $selectionmd5_dttcodexgigas.target.file.md5 = "e7dd9678b0a1c4881e80230ac716b21a41757648d71c538417755521438576f6")) or ($selectionmd5_dttcodexgigas.metadata.product_event_type = "1" and $selectionmd5_dttcodexgigas.target.file.md5 = "05fd4393288a8217243baf9c1bed942b219620b18487bc81fc6ced1238304f93")) or ($selectionmd5_dttcodexgigas.metadata.product_event_type = "1" and $selectionmd5_dttcodexgigas.target.file.md5 = "a15a4e21fe3b06870d52f7383ef45e4ac0dde727b02b3d340f0ba6346b43add1")) or ($selectionmd5_dttcodexgigas.metadata.product_event_type = "1" and $selectionmd5_dttcodexgigas.target.file.md5 = "2b19497db8cb05cd3d22996efe5af8eac0f2ea51e80f606b7b8a79dfaa2f58e2")) or ($selectionmd5_dttcodexgigas.metadata.product_event_type = "1" and $selectionmd5_dttcodexgigas.target.file.md5 = "6d70a54702f4456699d1f1d6c1835619c75f8f340ae95a21743b67123e88677e")) or ($selectionmd5_dttcodexgigas.metadata.product_event_type = "1" and $selectionmd5_dttcodexgigas.target.file.md5 = "5223a45d8b08eb14e87a87edaa4b71593b4f9d2bdb6de1a5b6f3e77869eeca8a")) or ($selectionmd5_dttcodexgigas.metadata.product_event_type = "1" and $selectionmd5_dttcodexgigas.target.file.md5 = "6fdf33cc14672908bd7f25d3620417ee"))
<li><a href="#">events: ((((re.regex($selection1.target.process.file.full_path, `.*\\socks111atx\.exe`) and re.regex($selection1.src.process.file.full_path, `.*\\radd8d54\.tmp\.exe`)) or ($selection1.metadata.product_event_type = "1" and re.regex($selection1.target.process.file.full_path, `.*\\regsvr32\.exe`) and (re.regex($selection1.target.process.command_line, `.*\\d5f4\.tmp\.dll`) or re.regex($selection1.target.process.command_line, `.*\\cd2d\.tmp\.dll`)))) or (re.regex($selection1.target.process.command_line, `.*ping 127\.0\.0\.1 && del.*`) and re.regex($selection1.src.process.file.full_path, `.*\\radd8d54\.tmp\.exe`))) and (re.regex($selection1.target.process.file.full_path, `.*\\notepad\.exe`) and re.regex($selection1.target.process.command_line, `.*\\files encrypted\.txt`)))
<li><a href="#">events: (((re.regex($falsepositive.target.process.command_line, `.* -p.*`) or re.regex($falsepositive.target.process.command_line, `.* -ta.*`) or re.regex($falsepositive.target.process.command_line, `.* -tb.*`) or re.regex($falsepositive.target.process.command_line, `.* -sdel.*`) or re.regex($falsepositive.target.process.command_line, `.* -dw.*`) or re.regex($falsepositive.target.process.command_line, `.* -hp.*`)) and (re.regex($falsepositive.target.file.full_path, `7z.*\.exe`) or re.regex($falsepositive.target.file.full_path, `.*rar\.exe`) or re.regex($falsepositive.target.file.full_path, `.*command.*line.*rar.*`)) and ($falsepositive.metadata.product_event_type = "4688" or $falsepositive.metadata.product_event_type = "1")) and not (re.regex($falsepositive.src.process.file.full_path, `c:\\program.*`)))
<li><a href="#">events: (((re.regex($selection.src.process.file.full_path, `.*/zoominstaller\.exe `) or re.regex($selection.src.process.file.full_path, `.*/wscript\.exe`)) and re.regex($selection.target.process.file.full_path, `.*/cmd\.exe`) and re.regex($selection.target.process.command_line, `.*pyclient\.cmd.*`)) or (re.regex($selection.src.process.file.full_path, `.*/cmd\.exe`) and (re.regex($selection.target.process.file.full_path, `.*/tasklist\.exe`) or re.regex($selection.target.process.file.full_path, `.*/attrib\.exe`) or re.regex($selection.target.process.file.full_path, `.*/reg\.exe`)) and (re.regex($selection.target.process.command_line, `.*d3vil shadow.*`) or re.regex($selection.target.process.command_line, `.*botnet.*`) or re.regex($selection.target.process.command_line, `.*boot-startup\.vbs.*`))))
<li><a href="#">events: (((re.regex($selection.src.process.file.full_path, `.*\\mshta\.exe`) or re.regex($selection.src.process.file.full_path, `.*\\powershell\.exe`) or re.regex($selection.src.process.file.full_path, `.*\\rundll32\.exe`) or re.regex($selection.src.process.file.full_path, `.*\\cscript\.exe`) or re.regex($selection.src.process.file.full_path, `.*\\wscript\.exe`) or re.regex($selection.src.process.file.full_path, `.*\\wmiprvse\.exe`)) and (re.regex($selection.target.process.file.full_path, `.*\\schtasks\.exe`) or re.regex($selection.target.process.file.full_path, `.*\\nslookup\.exe`) or re.regex($selection.target.process.file.full_path, `.*\\certutil\.exe`) or re.regex($selection.target.process.file.full_path, `.*\\bitsadmin\.exe`) or re.regex($selection.target.process.file.full_path, `.*\\mshta\.exe`)) and ($selection.metadata.product_event_type = "4688" or $selection.metadata.product_event_type = "1")) and not (re.regex($selection.principal.file.full_path, `.*\\ccmcache\\.*`)))
<li><a href="#">events: (((re.regex($selection.src.process.file.full_path, `.*\\wscript\.exe`) or re.regex($selection.src.process.file.full_path, `.*\\cscript\.exe`)) and re.regex($selection.target.process.file.full_path, `.*\\powershell\.exe`) and ($selection.metadata.product_event_type = "4688" or $selection.metadata.product_event_type = "1")) and not (re.regex($selection.principal.file.full_path, `.*\\health service state\\.*`)))
<li><a href="#">events: (((re.regex($selection.target.process.command_line, `.* -e jab.*`) or re.regex($selection.target.process.command_line, `.* -e jab.*`) or re.regex($selection.target.process.command_line, `.* -e jab.*`) or re.regex($selection.target.process.command_line, `.* -e jab.*`) or re.regex($selection.target.process.command_line, `.* -e jab.*`) or re.regex($selection.target.process.command_line, `.* -e jab.*`) or re.regex($selection.target.process.command_line, `.* -enc jab.*`) or re.regex($selection.target.process.command_line, `.* -enco jab.*`) or re.regex($selection.target.process.command_line, `.* -encodedcommand jab.*`) or re.regex($selection.target.process.command_line, `.* ba^j e-`) or re.regex($selection.target.process.command_line, `.* -e suvyi.*`) or re.regex($selection.target.process.command_line, `.* -e awv4i.*`) or re.regex($selection.target.process.command_line, `.* -e sqbfafga.*`) or re.regex($selection.target.process.command_line, `.* -e aqblahga.*`) or re.regex($selection.target.process.command_line, `.* -enc suvyi.*`) or re.regex($selection.target.process.command_line, `.* -enc awv4i.*`) or re.regex($selection.target.process.command_line, `.* -enc sqbfafga.*`) or re.regex($selection.target.process.command_line, `.* -enc aqblahga.*`)) and ($selection.metadata.product_event_type = "4688" or $selection.metadata.product_event_type = "1")) and not (re.regex($selection.target.process.command_line, `.* -executionpolicy remotesigned .*`)))
<li><a href="#">events: (((re.regex($selection.target.process.command_line, `.*noconsolelogger.*`) or re.regex($selection.target.process.command_line, `.*noconlog.*`)) and ($selection.metadata.product_event_type = "4688" or $selection.metadata.product_event_type = "1")) and not ((re.regex($selection.target.process.command_line, `.*msbuild\.exe.*`) or re.regex($selection.target.process.file.full_path, `.*\\msbuild\.exe`) or (re.regex($selection.src.process.file.full_path, `.*\.0\\bin\\nact\.exe.*`) or re.regex($selection.src.process.file.full_path, `.*\\msbuild\\15\.0\\bin\\amd64\\tracker\.exe.*`) or re.regex($selection.src.process.file.full_path, `.*:\\program files\\dotnet\\dotnet\.exe.*`)))))
<li><a href="#">events: (((re.regex($selection.target.process.file.full_path, `.*\\powershell\.exe`) and (re.regex($selection.target.process.command_line, `get-childitem -recurse -include .*\.ppt`) or re.regex($selection.target.process.command_line, `get-childitem -recurse -include .*\.doc`) or re.regex($selection.target.process.command_line, `get-childitem -recurse -include .*\.xls`) or re.regex($selection.target.process.command_line, `get-childitem -recurse -include .*\.pptx`) or re.regex($selection.target.process.command_line, `get-childitem -recurse -include .*\.docx`) or re.regex($selection.target.process.command_line, `get-childitem -recurse -include .*\.xlsx`) or re.regex($selection.target.process.command_line, `get-childitem -recurse -include .*\.pdf`) or re.regex($selection.target.process.command_line, `get-childitem -recurse -include .*\.csv`) or re.regex($selection.target.process.command_line, `get-childitem -recurse -include .*\.mdb`) or re.regex($selection.target.process.command_line, `get-childitem -recurse -include .*\.pps`)) and ($selection.metadata.product_event_type = "4688" or $selection.metadata.product_event_type = "1")) or ((re.regex($selection.target.process.command_line, `.* findstr .*`) or re.regex($selection.target.process.command_line, `.* findtsr\.exe`)) and (re.regex($selection.target.process.command_line, `.*\.doc`) or re.regex($selection.target.process.command_line, `.*\.docx`) or re.regex($selection.target.process.command_line, `.*\.pdf`) or re.regex($selection.target.process.command_line, `.*\.xls`) or re.regex($selection.target.process.command_line, `.*\.xlsx`) or re.regex($selection.target.process.command_line, `.*\.csv`) or re.regex($selection.target.process.command_line, `.*\.mdb`) or re.regex($selection.target.process.command_line, `.*\.pps`) or re.regex($selection.target.process.command_line, `.*\.pptx`) or re.regex($selection.target.process.command_line, `.*\.ppt`)))) or (re.regex($selection.target.process.file.full_path, `.*\\findstr\.exe`) and (re.regex($selection.target.process.command_line, `.*\.doc`) or re.regex($selection.target.process.command_line, `.*\.docx`) or re.regex($selection.target.process.command_line, `.*\.xls`) or re.regex($selection.target.process.command_line, `.*\.xlsx`) or re.regex($selection.target.process.command_line, `.*\.ppt`) or re.regex($selection.target.process.command_line, `.*\.pptx`) or re.regex($selection.target.process.command_line, `.*\.pps`) or re.regex($selection.target.process.command_line, `.*\.mdb`) or re.regex($selection.target.process.command_line, `.*\.pdf`) or re.regex($selection.target.process.command_line, `.*\.csv`))))
<li><a href="#">events: (((re.regex($selection.target.process.file.full_path, `.*\\svchost\.exe`) or re.regex($selection.target.process.file.full_path, `.*\\rundll32\.exe`) or re.regex($selection.target.process.file.full_path, `.*\\services\.exe`) or re.regex($selection.target.process.file.full_path, `.*\\powershell\.exe`) or re.regex($selection.target.process.file.full_path, `.*\\regsvr32\.exe`) or re.regex($selection.target.process.file.full_path, `.*\\spoolsv\.exe`) or re.regex($selection.target.process.file.full_path, `.*\\lsass\.exe`) or re.regex($selection.target.process.file.full_path, `.*\\smss\.exe`) or re.regex($selection.target.process.file.full_path, `.*\\csrss\.exe`) or re.regex($selection.target.process.file.full_path, `.*\\conhost\.exe`)) and ($selection.metadata.product_event_type = "4688" or $selection.metadata.product_event_type = "1")) and not ((re.regex($selection.target.process.file.full_path, `.*\\system32\\.*`) or re.regex($selection.target.process.file.full_path, `.*\\syswow64\\.*`))))
<li><a href="#">events: (((re.regex($selection1.target.process.file.full_path, `.*\\cvtres\.exe`) and re.regex($selection1.src.process.file.full_path, `.*\\csc\.exe`)) or ($selection1.metadata.product_event_type = "1" and (re.regex($selection1.target.process.file.full_path, `.*\\csc\.exe`) or re.regex($selection1.target.process.file.full_path, `.*\\ayjwa1n0\.tmp`)) and re.regex($selection1.src.process.file.full_path, `.*\\powershell\.exe`))) or (re.regex($selection1.target.process.file.full_path, `.*\\cmd\.exe`) and re.regex($selection1.src.process.file.full_path, `.*\\ayjwa1n0\.tmp`)))
<li><a href="#">events: ((re.regex($logsource.target.process.command_line, `\..*\\\\[a-za-z0-9]{7}\\\.[ee][xx][ee]`) and re.regex($logsource.target.process.command_line, `\..*\\\\\..*[0-9]\..*\\\.[ee][xx][ee]`) and $logsource.metadata.product_event_type = "4697") and not (re.regex($logsource.target.process.command_line, `\..*64\\\.[ee][xx][ee]`)))
<li><a href="#">events: ((re.regex($logsource.target.process.command_line, `\..*\\\\[a-za-z0-9]{7}\\\.[ee][xx][ee]`) and re.regex($logsource.target.process.command_line, `\..*\\\\\..*[0-9]\..*\\\.[ee][xx][ee]`) and $logsource.metadata.product_event_type = "7045") and not (re.regex($logsource.target.process.command_line, `\..*64\\\.[ee][xx][ee]`)))
<li><a href="#">events: ((re.regex($rundll_image.target.process.file.full_path, `.*\\rundll32\.exe`) or $rundll_image.target.file.full_path = "rundll32.exe") and ((re.regex($rundll_image.target.process.command_line, `.*comsvcs.*minidump.*full.*`) or re.regex($rundll_image.target.process.command_line, `.*comsvcs.*minidumpw.*full.*`)) and ($rundll_image.metadata.product_event_type = "4688" or $rundll_image.metadata.product_event_type = "1")))
<li><a href="#">events: ((re.regex($selection.src.process.command_line, `.*\\svchost\.exe.*termsvcs`) and ($selection.metadata.product_event_type = "4688" or $selection.metadata.product_event_type = "1")) and not (re.regex($selection.target.process.file.full_path, `.*\\rdpclip\.exe`)))
<li><a href="#">events: ((re.regex($selection.src.process.file.full_path, `.*\\apache.*`) or re.regex($selection.src.process.file.full_path, `.*\\tomcat.*`) or re.regex($selection.src.process.file.full_path, `.*\\w3wp\.exe`) or re.regex($selection.src.process.file.full_path, `.*\\php-cgi\.exe`) or re.regex($selection.src.process.file.full_path, `.*\\nginx\.exe`) or re.regex($selection.src.process.file.full_path, `.*\\httpd\.exe`)) and (re.regex($selection.target.process.command_line, `.*whoami.*`) or re.regex($selection.target.process.command_line, `.*net user .*`) or re.regex($selection.target.process.command_line, `.*ping -n .*`) or re.regex($selection.target.process.command_line, `.*systeminfo`) or re.regex($selection.target.process.command_line, `.*&cd&echo.*`) or re.regex($selection.target.process.command_line, `.*cd /d.*`)) and ($selection.metadata.product_event_type = "4688" or $selection.metadata.product_event_type = "1"))
<li><a href="#">events: ((re.regex($selection.src.process.file.full_path, `.*\\solarwinds\.businesslayerhost\.exe`) and ($selection.metadata.product_event_type = "4688" or $selection.metadata.product_event_type = "1")) and not ((re.regex($selection.target.process.file.full_path, `.*\\solarwinds\\orion\\apm\\apmservicecontrol\.exe`) or re.regex($selection.target.process.file.full_path, `.*\\solarwinds\\orion\\exporttopdfcmd\.exe`) or re.regex($selection.target.process.file.full_path, `.*\\solarwinds\.credentials\\solarwinds\.credentials\.orion\.webapi\.exe`) or re.regex($selection.target.process.file.full_path, `.*\\solarwinds\\orion\\topology\\solarwinds\.orion\.topology\.calculator\.exe`) or re.regex($selection.target.process.file.full_path, `.*\\solarwinds\\orion\\database-maint\.exe`) or re.regex($selection.target.process.file.full_path, `.*\\solarwinds\.orion\.apipoller\.service\\solarwinds\.orion\.apipoller\.service\.exe`) or re.regex($selection.target.process.file.full_path, `.*\\windows\\syswow64\\werfault\.exe`))))
<li><a href="#">events: ((re.regex($selection.src.process.file.full_path, `.*\\w3wp\.exe`) or re.regex($selection.src.process.file.full_path, `.*\\httpd\.exe`) or re.regex($selection.src.process.file.full_path, `.*\\nginx\.exe`) or re.regex($selection.src.process.file.full_path, `.*\\php-cgi\.exe`)) and (re.regex($selection.target.process.file.full_path, `.*\\cmd\.exe`) or re.regex($selection.target.process.file.full_path, `.*\\sh\.exe`) or re.regex($selection.target.process.file.full_path, `.*\\bash\.exe`) or re.regex($selection.target.process.file.full_path, `.*\\powershell\.exe`)) and ($selection.metadata.product_event_type = "4688" or $selection.metadata.product_event_type = "1"))
<li><a href="#">events: ((re.regex($selection.src.process.file.full_path, `.*\\winword\.exe`) or re.regex($selection.src.process.file.full_path, `.*\\excel\.exe`) or re.regex($selection.src.process.file.full_path, `.*\\powerpnt\.exe`) or re.regex($selection.src.process.file.full_path, `.*\\mspub\.exe`) or re.regex($selection.src.process.file.full_path, `.*\\visio\.exe`) or re.regex($selection.src.process.file.full_path, `.*\\outlook\.exe`)) and (re.regex($selection.target.process.file.full_path, `.*\\cmd\.exe`) or re.regex($selection.target.process.file.full_path, `.*\\powershell\.exe`) or re.regex($selection.target.process.file.full_path, `.*\\wscript\.exe`) or re.regex($selection.target.process.file.full_path, `.*\\cscript\.exe`) or re.regex($selection.target.process.file.full_path, `.*\\sh\.exe`) or re.regex($selection.target.process.file.full_path, `.*\\bash\.exe`) or re.regex($selection.target.process.file.full_path, `.*\\scrcons\.exe`) or re.regex($selection.target.process.file.full_path, `.*\\schtasks\.exe`) or re.regex($selection.target.process.file.full_path, `.*\\regsvr32\.exe`) or re.regex($selection.target.process.file.full_path, `.*\\hh\.exe`) or re.regex($selection.target.process.file.full_path, `.*\\wmic\.exe`) or re.regex($selection.target.process.file.full_path, `.*\\mshta\.exe`) or re.regex($selection.target.process.file.full_path, `.*\\rundll32\.exe`) or re.regex($selection.target.process.file.full_path, `.*\\msiexec\.exe`) or re.regex($selection.target.process.file.full_path, `.*\\forfiles\.exe`) or re.regex($selection.target.process.file.full_path, `.*\\scriptrunner\.exe`) or re.regex($selection.target.process.file.full_path, `.*\\mftrace\.exe`) or re.regex($selection.target.process.file.full_path, `.*\\appvlp\.exe`) or re.regex($selection.target.process.file.full_path, `.*\\svchost\.exe`)) and ($selection.metadata.product_event_type = "4688" or $selection.metadata.product_event_type = "1"))
<li><a href="#">events: ((re.regex($selection.src.process.file.full_path, `.*\\winword\.exe`) or re.regex($selection.src.process.file.full_path, `.*\\excel\.exe`) or re.regex($selection.src.process.file.full_path, `.*\\powerpnt\.exe`) or re.regex($selection.src.process.file.full_path, `.*\\mspub\.exe`) or re.regex($selection.src.process.file.full_path, `.*\\visio\.exe`) or re.regex($selection.src.process.file.full_path, `.*\\outlook\.exe`)) and re.regex($selection.target.process.file.full_path, `c:\\users\\.*\.exe`) and ($selection.metadata.product_event_type = "4688" or $selection.metadata.product_event_type = "1"))
<li><a href="#">events: ((re.regex($selection.src.process.file.full_path, `.*\\wmiprvse\.exe`) and re.regex($selection.target.process.file.full_path, `.*\\powershell\.exe`) and ($selection.metadata.product_event_type = "4688" or $selection.metadata.product_event_type = "1")) and not (re.regex($selection.target.process.command_line, `.*&amp;.*`)))
<li><a href="#">events: ((re.regex($selection.target.process.command_line, `.* /c powershell.*\\appdata\\local\\.*`) or re.regex($selection.target.process.command_line, `.* /c powershell.*\\appdata\\roaming\\.*`)) and ($selection.metadata.product_event_type = "4688" or $selection.metadata.product_event_type = "1"))
<li><a href="#">events: ((re.regex($selection.target.process.command_line, `.* asreproast .*`) or re.regex($selection.target.process.command_line, `.* dump /service:krbtgt .*`) or re.regex($selection.target.process.command_line, `.* kerberoast .*`) or re.regex($selection.target.process.command_line, `.* createnetonly /program:.*`) or re.regex($selection.target.process.command_line, `.* ptt /ticket:.*`) or re.regex($selection.target.process.command_line, `.* /impersonateuser:.*`) or re.regex($selection.target.process.command_line, `.* renew /ticket:.*`) or re.regex($selection.target.process.command_line, `.* asktgt /user:.*`) or re.regex($selection.target.process.command_line, `.* harvest /interval:.*`)) and ($selection.metadata.product_event_type = "4688" or $selection.metadata.product_event_type = "1"))
<li><a href="#">events: ((re.regex($selection.target.process.command_line, `.* -decode .*`) or re.regex($selection.target.process.command_line, `.* /decode .*`) or re.regex($selection.target.process.command_line, `.* -decodehex .*`) or re.regex($selection.target.process.command_line, `.* /decodehex .*`) or re.regex($selection.target.process.command_line, `.* -urlcache .*`) or re.regex($selection.target.process.command_line, `.* /urlcache .*`) or re.regex($selection.target.process.command_line, `.* -verifyctl .*`) or re.regex($selection.target.process.command_line, `.* /verifyctl .*`) or re.regex($selection.target.process.command_line, `.* -encode .*`) or re.regex($selection.target.process.command_line, `.* /encode .*`) or re.regex($selection.target.process.command_line, `.*certutil.* -url.*`) or re.regex($selection.target.process.command_line, `.*certutil.* /url.*`) or re.regex($selection.target.process.command_line, `.*certutil.* -ping.*`) or re.regex($selection.target.process.command_line, `.*certutil.* /ping.*`)) and ($selection.metadata.product_event_type = "4688" or $selection.metadata.product_event_type = "1"))
<li><a href="#">events: ((re.regex($selection.target.process.command_line, `.* -e paa.*`) or re.regex($selection.target.process.command_line, `.* -en paa.*`) or re.regex($selection.target.process.command_line, `.* -enc paa.*`) or re.regex($selection.target.process.command_line, `.* -enco paa.*`) or re.regex($selection.target.process.command_line, `.* -encod paa.*`) or re.regex($selection.target.process.command_line, `.*jablag4adga6ahuacwblahiacabyag8azgbpagwazq.*`) or re.regex($selection.target.process.command_line, `.*qazqbuahyaogb1ahmazqbyahaacgbvagyaaqbsagua.*`) or re.regex($selection.target.process.command_line, `.*kaguabgb2adoadqbzaguacgbwahiabwbmagkababla.*`) or re.regex($selection.target.process.command_line, `.*igaoaccakganackaowaka.*`) or re.regex($selection.target.process.command_line, `.*iakaanacoajwapadsaja.*`) or re.regex($selection.target.process.command_line, `.*iacgajwaqaccakqa7acqa.*`)) and ($selection.metadata.product_event_type = "4688" or $selection.metadata.product_event_type = "1"))
<li><a href="#">events: ((re.regex($selection.target.process.command_line, `.* -nop -noni -w hidden -c $x=$\(\(gp hkcu:software\\\\microsoft\\\\windows update\)\.update\).*`) or re.regex($selection.target.process.command_line, `.* -nop -noni -c $x=$\(\(gp hkcu:software\\\\microsoft\\\\windows update\)\.update\);.*`)) and ($selection.metadata.product_event_type = "4688" or $selection.metadata.product_event_type = "1"))
<li><a href="#">events: ((re.regex($selection.target.process.command_line, `.* stop wuauserv`) or re.regex($selection.target.process.command_line, `.* stop windefend`) or re.regex($selection.target.process.command_line, `.* stop wscsvc`) or re.regex($selection.target.process.command_line, `.* stop mpssvc`) or re.regex($selection.target.process.command_line, `.* delete windefend`) or re.regex($selection.target.process.command_line, `.*software\\policies\\microsoft\\windows defender\\real-time protection\\disable.*`)) and ($selection.metadata.product_event_type = "4688" or $selection.metadata.product_event_type = "1"))
<li><a href="#">events: ((re.regex($selection.target.process.command_line, `.* wmic useraccount get /all.*`) or re.regex($selection.target.process.command_line, `.* wmic useraccount list.*`) or re.regex($selection.target.process.command_line, `.* wmic startup list brief.*`) or re.regex($selection.target.process.command_line, `.* wmic share list.*`) or re.regex($selection.target.process.command_line, `.* wmic service get.*`) or re.regex($selection.target.process.command_line, `.* wmic qfe get description,installedon /format:csv.*`)) and ($selection.metadata.product_event_type = "4688" or $selection.metadata.product_event_type = "1"))
<li><a href="#">events: ((re.regex($selection.target.process.command_line, `.*.*pdf\.exe`) or re.regex($selection.target.process.command_line, `.*.*pdf\.zip`) or re.regex($selection.target.process.command_line, `.*.*pdf\.7zp`) or re.regex($selection.target.process.command_line, `.*\\order.*\.jar`) or re.regex($selection.target.process.command_line, `.*\\payment.*\.jar`) or re.regex($selection.target.process.command_line, `.*\\shipping.*\.exe`) or re.regex($selection.target.process.command_line, `.*\\shipping.*\.jar`) or re.regex($selection.target.process.command_line, `.*\\purchase.*\.jar`) or re.regex($selection.target.process.command_line, `.*.*\.arj`) or re.regex($selection.target.process.command_line, `.*.*\.xz`) or re.regex($selection.target.process.command_line, `.*.*pdf\.gz`) or re.regex($selection.target.process.command_line, `.*\\quotation.*\.jar`) or re.regex($selection.target.process.command_line, `.*\\order.*\.zip`) or re.regex($selection.target.process.command_line, `.*.*xls\.zip`) or re.regex($selection.target.process.command_line, `.*\\swift.*\.jar`) or re.regex($selection.target.process.command_line, `.*\\invoice.*\.jar`) or re.regex($selection.target.process.command_line, `.*\\invoice.*\.exe`) or re.regex($selection.target.process.command_line, `.*\\shipping advice.*\.exe`) or re.regex($selection.target.process.command_line, `.*\\shipping advice.*\.jar`) or re.regex($selection.target.process.command_line, `.*\\airway bill.*\.exe`) or re.regex($selection.target.process.command_line, `.*\\airway bill.*\.jar`) or re.regex($selection.target.process.command_line, `.*\\dhl.*\.exe`) or re.regex($selection.target.process.command_line, `.*\\corona.*\.exe`) or re.regex($selection.target.process.command_line, `.*\\covid.*\.exe`) or re.regex($selection.target.process.command_line, `.*\\corona.*\.doc`) or re.regex($selection.target.process.command_line, `.*\\covid.*\.doc`) or re.regex($selection.target.process.command_line, `.*.*\.bat\.rar`) or re.regex($selection.target.process.command_line, `.*.*\.zip\.xxe`) or re.regex($selection.target.process.command_line, `.*.*\.xlsx\.swf`) or re.regex($selection.target.process.command_line, `.*\\po`) or re.regex($selection.target.process.command_line, `.*\\invoice`)) and ($selection.metadata.product_event_type = "4688" or $selection.metadata.product_event_type = "1"))
<li><a href="#">events: ((re.regex($selection.target.process.command_line, `.*\\appdata\\roaming\\oracle.*\\java.*\.exe .*`) or re.regex($selection.target.process.command_line, `.*cscript\.exe .*retrive.*\.vbs .*`)) and ($selection.metadata.product_event_type = "4688" or $selection.metadata.product_event_type = "1"))
<li><a href="#">events: ((re.regex($selection.target.process.command_line, `.*\\msdt\.exe.*`) or re.regex($selection.target.process.command_line, `.*\\installutil\.exe.*`) or re.regex($selection.target.process.command_line, `.*\\regsvcs\.exe.*`) or re.regex($selection.target.process.command_line, `.*\\regasm\.exe.*`) or re.regex($selection.target.process.command_line, `.*\\msbuild\.exe.*`) or re.regex($selection.target.process.command_line, `.*\\ieexec\.exe.*`)) and ($selection.metadata.product_event_type = "4688" or $selection.metadata.product_event_type = "1"))
<li><a href="#">events: ((re.regex($selection.target.process.command_line, `.*\\net\.exe stop \"samss\" .*`) or re.regex($selection.target.process.command_line, `.*\\net\.exe stop \"audioendpointbuilder\" .*`) or re.regex($selection.target.process.command_line, `.*\\net\.exe stop \"unistoresvc_\?\?\?\?\?\" .*`)) and ($selection.metadata.product_event_type = "4688" or $selection.metadata.product_event_type = "1"))
<li><a href="#">events: ((re.regex($selection.target.process.command_line, `.*\\rundll32\.exe.* url\.dll,.*openurl .*`) or re.regex($selection.target.process.command_line, `.*\\rundll32\.exe.* url\.dll,.*openurla .*`) or re.regex($selection.target.process.command_line, `.*\\rundll32\.exe.* url\.dll,.*fileprotocolhandler .*`) or re.regex($selection.target.process.command_line, `.*\\rundll32\.exe.* zipfldr\.dll,.*routethecall .*`) or re.regex($selection.target.process.command_line, `.*\\rundll32\.exe.* shell32\.dll,.*control_rundll .*`) or re.regex($selection.target.process.command_line, `.*\\rundll32\.exe javascript:.*`) or re.regex($selection.target.process.command_line, `.* url\.dll,.*openurl .*`) or re.regex($selection.target.process.command_line, `.* url\.dll,.*openurla .*`) or re.regex($selection.target.process.command_line, `.* url\.dll,.*fileprotocolhandler .*`) or re.regex($selection.target.process.command_line, `.* zipfldr\.dll,.*routethecall .*`) or re.regex($selection.target.process.command_line, `.* shell32\.dll,.*control_rundll .*`) or re.regex($selection.target.process.command_line, `.* javascript:.*`) or re.regex($selection.target.process.command_line, `.*\.registerxll.*`)) and ($selection.metadata.product_event_type = "4688" or $selection.metadata.product_event_type = "1"))
<li><a href="#">events: ((re.regex($selection.target.process.command_line, `.*ojpgcm9tqmfzzty0u3ryaw5n.*`) or re.regex($selection.target.process.command_line, `.*o6rnjvbujhc2u2nfn0cmluz.*`) or re.regex($selection.target.process.command_line, `.*6okzyb21cyxnlnjrtdhjpbm.*`)) and ($selection.metadata.product_event_type = "4688" or $selection.metadata.product_event_type = "1"))
<li><a href="#">events: ((re.regex($selection.target.process.command_line, `.*suvyichb.*`) or re.regex($selection.target.process.command_line, `.*lfwcaow.*`) or re.regex($selection.target.process.command_line, `.*jrvggkf.*`) or re.regex($selection.target.process.command_line, `.*awv4ichb.*`) or re.regex($selection.target.process.command_line, `.*llecaow.*`) or re.regex($selection.target.process.command_line, `.*pzxggkf.*`) or re.regex($selection.target.process.command_line, `.*awv4ichozx.*`) or re.regex($selection.target.process.command_line, `.*llecaotmv3.*`) or re.regex($selection.target.process.command_line, `.*pzxggke5ld.*`) or re.regex($selection.target.process.command_line, `.*suvyichozx.*`) or re.regex($selection.target.process.command_line, `.*lfwcaotmv3.*`) or re.regex($selection.target.process.command_line, `.*jrvggke5ld.*`)) and ($selection.metadata.product_event_type = "4688" or $selection.metadata.product_event_type = "1"))
<li><a href="#">events: ((re.regex($selection.target.process.command_line, `certutil -f -encode .*`) or re.regex($selection.target.process.command_line, `certutil\.exe -f -encode .*`) or re.regex($selection.target.process.command_line, `certutil -encode -f .*`) or re.regex($selection.target.process.command_line, `certutil\.exe -encode -f .*`)) and ($selection.metadata.product_event_type = "4688" or $selection.metadata.product_event_type = "1"))
<li><a href="#">events: ((re.regex($selection.target.process.file.full_path, `.*/ralord\.exe`) or re.regex($selection.target.process.file.full_path, `.*/lodron\.exe`) or re.regex($selection.target.process.file.full_path, `.*/019\.exe`) or re.regex($selection.target.process.file.full_path, `.*/016\.exe`)) and (re.regex($selection.src.process.file.full_path, `.*/setup_file\.exe`) or re.regex($selection.src.process.file.full_path, `.*/setup_installer\.exe`)))
<li><a href="#">events: ((re.regex($selection.target.process.file.full_path, `.*:\\recycler\\.*`) or re.regex($selection.target.process.file.full_path, `.*:\\systemvolumeinformation\\.*`) or re.regex($selection.target.process.file.full_path, `c:\\\\windows\\\\tasks\\.*`) or re.regex($selection.target.process.file.full_path, `c:\\\\windows\\\\debug\\.*`) or re.regex($selection.target.process.file.full_path, `c:\\\\windows\\\\fonts\\.*`) or re.regex($selection.target.process.file.full_path, `c:\\\\windows\\\\help\\.*`) or re.regex($selection.target.process.file.full_path, `c:\\\\windows\\\\drivers\\.*`) or re.regex($selection.target.process.file.full_path, `c:\\\\windows\\\\addins\\.*`) or re.regex($selection.target.process.file.full_path, `c:\\\\windows\\\\cursors\\.*`) or re.regex($selection.target.process.file.full_path, `c:\\\\windows\\\\system32\\tasks\\.*`)) and ($selection.metadata.product_event_type = "4688" or $selection.metadata.product_event_type = "1"))
<li><a href="#">events: ((re.regex($selection.target.process.file.full_path, `.*\.doc\.exe`) or re.regex($selection.target.process.file.full_path, `.*\.docx\.exe`) or re.regex($selection.target.process.file.full_path, `.*\.xls\.exe`) or re.regex($selection.target.process.file.full_path, `.*\.xlsx\.exe`) or re.regex($selection.target.process.file.full_path, `.*\.ppt\.exe`) or re.regex($selection.target.process.file.full_path, `.*\.pptx\.exe`) or re.regex($selection.target.process.file.full_path, `.*\.rtf\.exe`) or re.regex($selection.target.process.file.full_path, `.*\.pdf\.exe`) or re.regex($selection.target.process.file.full_path, `.*\.txt\.exe`) or re.regex($selection.target.process.file.full_path, `.* \.exe`) or re.regex($selection.target.process.file.full_path, `.*______\.exe`)) and ($selection.metadata.product_event_type = "4688" or $selection.metadata.product_event_type = "1"))
<li><a href="#">events: ((re.regex($selection.target.process.file.full_path, `.*\\$recycle\.bin`) or re.regex($selection.target.process.file.full_path, `.*\\users\\all users\\.*`) or re.regex($selection.target.process.file.full_path, `.*\\users\\default\\.*`) or re.regex($selection.target.process.file.full_path, `.*\\users\\public\\.*`) or re.regex($selection.target.process.file.full_path, `c:\\perflogs\\.*`) or re.regex($selection.target.process.file.full_path, `.*\\config\\systemprofile\\.*`) or re.regex($selection.target.process.file.full_path, `.*\\windows\\fonts\\.*`) or re.regex($selection.target.process.file.full_path, `.*\\windows\\ime\\.*`) or re.regex($selection.target.process.file.full_path, `.*\\windows\\addins\\.*`)) and ($selection.metadata.product_event_type = "4688" or $selection.metadata.product_event_type = "1"))
<li><a href="#">events: ((re.regex($selection.target.process.file.full_path, `.*\\$recycle\.bin`) or re.regex($selection.target.process.file.full_path, `.*\\users\\public\\.*`) or re.regex($selection.target.process.file.full_path, `c:\\perflogs\\.*`) or re.regex($selection.target.process.file.full_path, `.*\\windows\\fonts\\.*`) or re.regex($selection.target.process.file.full_path, `.*\\windows\\ime\\.*`) or re.regex($selection.target.process.file.full_path, `.*\\windows\\addins\\.*`) or re.regex($selection.target.process.file.full_path, `.*\\windows\\debug\\.*`)) and ($selection.metadata.product_event_type = "4688" or $selection.metadata.product_event_type = "1"))
<li><a href="#">events: ((re.regex($selection.target.process.file.full_path, `.*\\attrib\.exe`) and re.regex($selection.target.process.command_line, `.* \+h .*`) and ($selection.metadata.product_event_type = "4688" or $selection.metadata.product_event_type = "1")) and not ((re.regex($selection.target.process.command_line, `.*\\desktop\.ini .*`) or (re.regex($selection.src.process.file.full_path, `.*\\cmd\.exe`) and re.regex($selection.target.process.command_line, `\+r \+h \+s \+a \\.*\.cui`) and re.regex($selection.src.process.command_line, `c:\\windows\\system32\\.*\.bat`)))))
<li><a href="#">events: ((re.regex($selection.target.process.file.full_path, `.*\\cmd\.exe`) or re.regex($selection.target.process.file.full_path, `.*\\powershell\.exe`) or re.regex($selection.target.process.file.full_path, `.*\\pwsh\.exe`)) and re.regex($selection.src.process.file.full_path, `.*\\sqlservr\.exe`))
<li><a href="#">events: ((re.regex($selection.target.process.file.full_path, `.*\\gup\.exe`) and ($selection.metadata.product_event_type = "4688" or $selection.metadata.product_event_type = "1")) and not ((re.regex($selection.target.process.file.full_path, `c:\\users\\.*\\appdata\\local\\notepad\+\+\\updater\\gup\.exe`) or re.regex($selection.target.process.file.full_path, `c:\\users\\.*\\appdata\\roaming\\notepad\+\+\\updater\\gup\.exe`) or $selection.target.process.file.full_path = "c:\\program files\\notepad++\\updater\\gup.exe" or $selection.target.process.file.full_path = "c:\\program files (x86)\\notepad++\\updater\\gup.exe")))
<li><a href="#">events: ((re.regex($selection.target.process.file.full_path, `.*\\msiexec\.exe`) and ($selection.metadata.product_event_type = "4688" or $selection.metadata.product_event_type = "1")) and not ((re.regex($selection.target.process.file.full_path, `c:\\windows\\system32\\.*`) or re.regex($selection.target.process.file.full_path, `c:\\windows\\syswow64\\.*`) or re.regex($selection.target.process.file.full_path, `c:\\windows\\winsxs\\.*`))))
<li><a href="#">events: ((re.regex($selection.target.process.file.full_path, `.*\\net\.exe`) or re.regex($selection.target.process.file.full_path, `.*\\net1\.exe`)) and (re.regex($selection.target.process.command_line, `.* group.*`) or re.regex($selection.target.process.command_line, `.* localgroup.*`) or re.regex($selection.target.process.command_line, `.* user.*`) or re.regex($selection.target.process.command_line, `.* view.*`) or re.regex($selection.target.process.command_line, `.* share`) or re.regex($selection.target.process.command_line, `.* accounts.*`) or re.regex($selection.target.process.command_line, `.* use.*`) or re.regex($selection.target.process.command_line, `.* stop .*`)) and ($selection.metadata.product_event_type = "4688" or $selection.metadata.product_event_type = "1"))
<li><a href="#">events: ((re.regex($selection.target.process.file.full_path, `.*\\powershell\.exe`) or re.regex($selection.target.process.file.full_path, `.*\\cmd\.exe`)) and (re.regex($selection.target.process.command_line, `.*91,78,101,116.*`) or re.regex($selection.target.process.command_line, `.*91t78v101v116.*`) or re.regex($selection.target.process.command_line, `.*91,78@101@116.*`) or re.regex($selection.target.process.command_line, `.*91 ,78 ,101, 116 , 46 , 83.*`)))
<li><a href="#">events: ((re.regex($selection.target.process.file.full_path, `.*\\schtasks\.exe`) and re.regex($selection.target.process.command_line, `.* /create .*`) and ($selection.metadata.product_event_type = "4688" or $selection.metadata.product_event_type = "1")) and not ($selection.src.user.user_display_name = "nt authority\\system"))
<li><a href="#">events: ((re.regex($selection.target.process.file.full_path, `.*\\solarwinds\.businesslayerhost\.exe`) or re.regex($selection.target.process.file.full_path, `.*\\solarwindws\.businesslayerhostx64\.exe`)) and (re.regex($selection.target.file.full_path, `.*\.exe`) or re.regex($selection.target.file.full_path, `.*\.jpg`) or re.regex($selection.target.file.full_path, `.*\.ps1`) or re.regex($selection.target.file.full_path, `.*\.png`) or re.regex($selection.target.file.full_path, `.*\.dll`)))
<li><a href="#">events: ((re.regex($selection.target.process.file.full_path, `.*\\wscript\.exe`) and (re.regex($selection.target.process.command_line, `.* c:\\users\\.*\.vbs .*`) or re.regex($selection.target.process.command_line, `.* c:\\users\\admin\\appdata\\.*\.vbs .*`) or re.regex($selection.target.process.command_line, `.* c:\\users\\admin\\appdata\\onedrive\.vbs .*`)) and ($selection.metadata.product_event_type = "4688" or $selection.metadata.product_event_type = "1")) and not (re.regex($selection.src.process.file.full_path, `.*\\winrar.*`)))
<li><a href="#">events: ((re.regex($selection.target.process.file.full_path, `.*userinit\.exe.*`) or re.regex($selection.target.process.file.full_path, `.*colorcpl\.exe.*`)) and (re.regex($selection.src.process.file.full_path, `.*mshta\.exe.*`) or re.regex($selection.src.process.file.full_path, `.*cscript\.exe.*`) or re.regex($selection.src.process.file.full_path, `.*wscript\.exe.*`)) and ($selection.metadata.product_event_type = "4688" or $selection.metadata.product_event_type = "1"))
<li><a href="#">events: ((re.regex($selection.target.process.file.full_path, `c:\\perflogs\\.*`) or re.regex($selection.target.process.file.full_path, `c:\\$recycle\.bin\\.*`) or re.regex($selection.target.process.file.full_path, `c:\\intel\\logs\\.*`) or re.regex($selection.target.process.file.full_path, `c:\\users\\default\\.*`) or re.regex($selection.target.process.file.full_path, `c:\\users\\public\\.*`) or re.regex($selection.target.process.file.full_path, `c:\\users\\networkservice\\.*`) or re.regex($selection.target.process.file.full_path, `c:\\windows\\fonts\\.*`) or re.regex($selection.target.process.file.full_path, `c:\\windows\\debug\\.*`) or re.regex($selection.target.process.file.full_path, `c:\\windows\\media\\.*`) or re.regex($selection.target.process.file.full_path, `c:\\windows\\help\\.*`) or re.regex($selection.target.process.file.full_path, `c:\\windows\\addins\\.*`) or re.regex($selection.target.process.file.full_path, `c:\\windows\\repair\\.*`) or re.regex($selection.target.process.file.full_path, `c:\\windows\\security\\.*`) or re.regex($selection.target.process.file.full_path, `.*\\rsa\\machinekeys\\.*`) or re.regex($selection.target.process.file.full_path, `c:\\windows\\system32\\config\\systemprofile\\.*`)) and ($selection.metadata.product_event_type = "4688" or $selection.metadata.product_event_type = "1"))
<li><a href="#">events: ((re.regex($selection.target.url, `.*/install_flash_player\.exe`) or re.regex($selection.target.url, `.*/flash_install\.php.*`)) and not (re.regex($selection.target.url, `.*\.adobe\.com/.*`)))
<li><a href="#">events: ((re.regex($selection.target.url, `.*/swip/events.*`) or re.regex($selection.target.url, `.*/swip/systemdescription.*`) or re.regex($selection.target.url, `.*/swip/upload\.ashx.*`) or re.regex($selection.target.url, `.*/swip/upd.*`)) and not (re.regex($selection.target.hostname, `.*solarwinds\.com`)))
<li><a href="#">events: ((re.regex($selection.target.url, `.*/tmui/login\.jsp.*`) and (re.regex($selection.target.url, `.*\.\.;.*`) or re.regex($selection.target.url, `.*\.\./.*`))) or (re.regex($selection.target.url, `.*/tmui/login\.jsp.*`) and (re.regex($selection.target.url, `.*\?command=.*`) or re.regex($selection.target.url, `.*\+admin.*`) or re.regex($selection.target.url, `.*;id.*`) or re.regex($selection.target.url, `.*/nc.*`) or re.regex($selection.target.url, `.*/sh.*`) or re.regex($selection.target.url, `.*/bash.*`) or re.regex($selection.target.url, `.*/curl.*`) or re.regex($selection.target.url, `.*authproperties\.jsp.*`) or re.regex($selection.target.url, `.*gettabset\.jsp.*`) or re.regex($selection.target.url, `.*;/tmui/.*`) or re.regex($selection.target.url, `.*/passwd.*`) or re.regex($selection.target.url, `.*/shadow.*`))))
<li><a href="#">events: ((re.regex($selection_1.target.process.command_line, ` .*password.*`) or re.regex($selection_1.target.process.command_line, ` .*admin.*`) or re.regex($selection_1.target.process.command_line, ` .*passwd.*`) or re.regex($selection_1.target.process.command_line, ` .*pass.*`)) and re.regex($selection_1.target.process.file.full_path, `.*\\findstr\.exe`))
<li><a href="#">events: ((re.regex($selection_commandline.target.process.command_line, `%comspec:.*`) or re.regex($selection_commandline.target.process.command_line, `%comspec:.*`) or re.regex($selection_commandline.target.process.command_line, `.* %comspec:.*`) or re.regex($selection_commandline.target.process.command_line, `%comspec%.*`) or re.regex($selection_commandline.target.process.command_line, ` .*%comspec%.*`) or re.regex($selection_commandline.target.process.command_line, `%comspec%.*`) or re.regex($selection_commandline.target.process.command_line, `%comspec:.*`) or re.regex($selection_commandline.target.process.command_line, `%comspec:.*`) or re.regex($selection_commandline.target.process.command_line, `%co^m^s^p^ec^%.*`) or re.regex($selection_commandline.target.process.command_line, `.* %co^m^s^p^ec^%.*`)) or (re.regex($selection_commandline.target.process.command_line, `%co^m^s^p^ec^%.*`) or re.regex($selection_commandline.target.process.command_line, `%comspec:.*`) or re.regex($selection_commandline.target.process.command_line, `%comspec:.*`) or re.regex($selection_commandline.target.process.command_line, `%comspec%.*`)))
<li><a href="#">events: ((re.regex($selection_image.target.process.file.full_path, `.*\\setspn\.exe`) or re.regex($selection_image.metadata.description, `.*query or reset the computer.* spn attribute.*`)) and re.regex($selection_image.target.process.command_line, `.*-q.*`))
<li><a href="#">events: ((re.regex($selection_traversal.target.url, `.*\.\./.*`) or re.regex($selection_traversal.target.url, `.*/\.\..*`) or re.regex($selection_traversal.target.url, `.*=\.\.&.*`)) and re.regex($selection_traversal.target.url, `.*cscoe.*`))
<li><a href="#">events: ((re.regex($selection1.src.process.file.full_path, `.*services\.exe`) and re.regex($selection1.target.process.file.full_path, `.*cmd\.exe`) and re.regex($selection1.target.process.command_line, `.*/q /k echo.*`) and re.regex($selection1.target.process.command_line, `.*2>1.*`) and re.regex($selection1.target.process.command_line, `.*& del .*`) and ($selection1.metadata.product_event_type = "4688" or $selection1.metadata.product_event_type = "1")) and (re.regex($selection1.target.process.command_line, `.*setupapi\.dev\.log.*`) or re.regex($selection1.target.process.command_line, `.*install\.bat.*`)))
<li><a href="#">events: ((re.regex($selection1.target.process.command_line, `.*\\calc\.exe .*`) and ($selection1.metadata.product_event_type = "4688" or $selection1.metadata.product_event_type = "1")) or ((re.regex($selection1.target.process.file.full_path, `.*\\calc\.exe`) and ($selection1.metadata.product_event_type = "4688" or $selection1.metadata.product_event_type = "1")) and not (re.regex($selection1.target.process.file.full_path, `.*\\windows\\sys.*`))))
<li><a href="#">events: ((re.regex($selection1.target.process.file.full_path, `.*\\powershell`) and (re.regex($selection1.target.process.command_line, `powershell $vn=\( '104{100e121'\.split\('!x_aezug{%'\) |foreach-object{[char]\($_-bxor 0x21 \) }\) -join '';sal mum $vn;$bcmilrm=@\(.*`) or re.regex($selection1.target.process.command_line, `powershell '\(&'\+'\(g'\+'c'\+'###'\.replace\('###','m'\)\+' .*w-'\+'o.*\)'\+ 'ne'\+'t\.'\+'w'\+'eb'\+'c'\+'li'\+'ent\)'\+'\.d'\+'ow'\+'nl'\+'oad'\+'f'\+'il'\+'e\(''.*file\.vbs.*`))) or (re.regex($selection1.target.process.file.full_path, `.*\\regasm\.exe`) and re.regex($selection1.src.process.file.full_path, `.*\\installutil\.exe`)))
<li><a href="#">events: ((re.regex($selection1.target.registry.registry_key, `.*imagepath.*`) and re.regex($selection1.metadata.description, `.*%comspec%.*`) and re.regex($selection1.metadata.description, `.*/q.*`) and re.regex($selection1.metadata.description, `.*/k.*`) and re.regex($selection1.metadata.description, `.*echo.*`)) or ($selection1.metadata.event_type = "setvalue" and re.regex($selection1.target.registry.registry_key, `.*currentcontrolset\\services.*`) and (re.regex($selection1.target.registry.registry_key, `.*windows update control service.*`) or re.regex($selection1.target.registry.registry_key, `.*windows 10 defender.*`) or re.regex($selection1.target.registry.registry_key, `.*windows license key activation.*`) or re.regex($selection1.target.registry.registry_key, `.*office 365 proxy.*`) or re.regex($selection1.target.registry.registry_key, `.*microsoft security center.*`) or re.regex($selection1.target.registry.registry_key, `.*windows update.*`) or re.regex($selection1.target.registry.registry_key, `.*secure token messaging service.*`) or re.regex($selection1.target.registry.registry_key, `.*background action manager.*`) or re.regex($selection1.target.registry.registry_key, `.*onedrive sync center.*`))))
<li><a href="#">events: (re.regex($clientmailrules.target.process.command_line, `.*enableunsafeclientmailrules.*`) or (re.regex($clientmailrules.src.process.file.full_path, `.*\\outlook\.exe`) and re.regex($clientmailrules.target.process.command_line, `.*\\.*\.exe`)))
<li><a href="#">events: (re.regex($dns_parent_process.src.process.file.full_path, `.*\\system32\\dns\.exe`) and not ((re.regex($dns_parent_process.target.process.file.full_path, `.*werfault\.exe`) or re.regex($dns_parent_process.target.process.file.full_path, `.*conhost\.exe`))))
<li><a href="#">events: (re.regex($event.target.process.file.full_path, `anything.cpl`) or re.regex($event.target.process.file.full_path, `anything.dll`))
<li><a href="#">events: (re.regex($selection.network.dns.answers.data, `.*iex.*`) or re.regex($selection.network.dns.answers.data, `.*invoke-expression.*`) or re.regex($selection.network.dns.answers.data, `.*cmd\.exe.*`))
<li><a href="#">events: (re.regex($selection.network.dns.questions.name, `.*avsvmcloud\.com`) or re.regex($selection.network.dns.questions.name, `.*databasegalore\.com`) or re.regex($selection.network.dns.questions.name, `.*deftsecurity\.com`) or re.regex($selection.network.dns.questions.name, `.*freescanonline\.com`) or re.regex($selection.network.dns.questions.name, `.*panhardware\.com`) or re.regex($selection.network.dns.questions.name, `.*thedoccloud\.com`) or re.regex($selection.network.dns.questions.name, `.*incomeupdate\.com`) or re.regex($selection.network.dns.questions.name, `.*zupertech\.com`) or re.regex($selection.network.dns.questions.name, `.*digitalcollege\.org`) or re.regex($selection.network.dns.questions.name, `.*virtualdataserver\.com`))
<li><a href="#">events: (re.regex($selection.src.application, `.*\(hydra\).*`) or re.regex($selection.src.application, `.* arachni/.*`) or re.regex($selection.src.application, `.* bfac .*`) or re.regex($selection.src.application, `.* brutus .*`) or re.regex($selection.src.application, `.* cgichk .*`) or re.regex($selection.src.application, `.*core-project/1\.0.*`) or re.regex($selection.src.application, `.* crimscanner/.*`) or re.regex($selection.src.application, `.*datacha0s.*`) or re.regex($selection.src.application, `.*dirbuster.*`) or re.regex($selection.src.application, `.*domino hunter.*`) or re.regex($selection.src.application, `.*dotdotpwn.*`) or $selection.src.application = "fhscan core" or re.regex($selection.src.application, `.*floodgate.*`) or re.regex($selection.src.application, `.*get-minimal.*`) or re.regex($selection.src.application, `.*gootkit auto-rooter scanner.*`) or re.regex($selection.src.application, `.*grendel-scan.*`) or re.regex($selection.src.application, `.* inspath .*`) or re.regex($selection.src.application, `.*internet ninja.*`) or re.regex($selection.src.application, `.*jaascois.*`) or re.regex($selection.src.application, `.* zmeu .*`) or re.regex($selection.src.application, `.*masscan.*`) or re.regex($selection.src.application, `.* metis .*`) or re.regex($selection.src.application, `.*morfeus fucking scanner.*`) or re.regex($selection.src.application, `.*n-stealth.*`) or re.regex($selection.src.application, `.*nsauditor.*`) or re.regex($selection.src.application, `.*pmafind.*`) or re.regex($selection.src.application, `.*security scan.*`) or re.regex($selection.src.application, `.*springenwerk.*`) or re.regex($selection.src.application, `.*teh forest lobster.*`) or re.regex($selection.src.application, `.*toata dragostea.*`) or re.regex($selection.src.application, `.* vega/.*`) or re.regex($selection.src.application, `.*voideye.*`) or re.regex($selection.src.application, `.*webshag.*`) or re.regex($selection.src.application, `.*webvulnscan.*`) or re.regex($selection.src.application, `.* whcc/.*`) or re.regex($selection.src.application, `.* havij`) or re.regex($selection.src.application, `.*absinthe.*`) or re.regex($selection.src.application, `.*bsqlbf.*`) or re.regex($selection.src.application, `.*mysqloit.*`) or re.regex($selection.src.application, `.*pangolin.*`) or re.regex($selection.src.application, `.*sql power injector.*`) or re.regex($selection.src.application, `.*sqlmap.*`) or re.regex($selection.src.application, `.*sqlninja.*`) or re.regex($selection.src.application, `.*uil2pn.*`) or $selection.src.application = "ruler" or $selection.src.application = "mozilla/5.0 (windows; u; windows nt 5.1; pt-pt; rv:1.9.1.2) gecko/20090729 firefox/3.5.2 (.net clr 3.5.30729)")
<li><a href="#">events: (re.regex($selection.src.application, `docker/.*`) and $selection.network.http.method = "put")
<li><a href="#">events: (re.regex($selection.src.application, `internet explorer .*`) or $selection.src.application = "mozilla/4.0 (compatible; msie 6.0; windows nt 5.1; sv1; infopath.2)" or $selection.src.application = "mozilla/4.0 (compatible; metasploit rspec)" or $selection.src.application = "mozilla/4.0 (compatible; msie 6.1; windows nt)" or $selection.src.application = "mozilla/4.0 (compatible; msie 6.0; windows nt 5.1)" or $selection.src.application = "mozilla/4.0 (compatible; msie 7.0; windows nt 6.0)" or $selection.src.application = "mozilla/4.0 (compatible; msie 8.0; windows nt 6.0; trident/4.0)" or $selection.src.application = "mozilla/4.0 (compatible; msie 7.0; windows nt 6.0; trident/4.0; simbar={7db0f6de-8de7-4841-9084-28fa914b0f2e}; slcc1; .n" or $selection.src.application = "mozilla/5.0 (compatible; googlebot/2.1; +)" or $selection.src.application = "mozilla/5.0 (windows; u; windows nt 5.1; en-us) applewebkit/525.13 (khtml, like gecko) chrome/4.0.221.6 safari/525.13" or $selection.src.application = "mozilla/5.0 (compatible; msie 9.0; windows nt 6.1; wow64; trident/5.0; maau)" or $selection.src.application = "mozilla/5.0" or $selection.src.application = "mozilla/4.0 (compatible; spipe/1.0" or $selection.src.application = "mozilla/5.0 (windows nt 6.3; rv:39.0) gecko/20100101 firefox/35.0" or $selection.src.application = "sametime community agent" or $selection.src.application = "x-forwarded-for" or $selection.src.application = "dotdotpwn v2.1" or $selection.src.application = "sipdroid" or $selection.src.application = "mozilla/5.0 (windows nt 10.0; win32; x32; rv:60.0)" or re.regex($selection.src.application, `.*wordpress hash grabber.*`) or re.regex($selection.src.application, `.*exploit.*`))
<li><a href="#">events: (re.regex($selection.src.application, `xmrig .*`) or re.regex($selection.src.application, `ccminer.*`))
<li><a href="#">events: (re.regex($selection.src.process.file.full_path, `.*\\excel\.exe`) and re.regex($selection.target.process.file.full_path, `.*\\powershell\.exe`) and re.regex($selection.target.process.command_line, `.*-executionpolicy bypass -w hidden -command \(new-object system\.net\.webclient\)\.downloadfile\(.*gbud\.webd\.pl/cli/.*\.exe.*,$env:temp\+.*\.exe.*\);\(new-object -com shell\.application\)\.shellexecute\($env:temp\+.*\.exe.*\)`))
<li><a href="#">events: (re.regex($selection.src.process.file.full_path, `.*\\hwp\.exe`) and re.regex($selection.target.process.file.full_path, `.*\\gbb\.exe`) and ($selection.metadata.product_event_type = "4688" or $selection.metadata.product_event_type = "1"))
<li><a href="#">events: (re.regex($selection.src.process.file.full_path, `.*\\mmc\.exe`) and (re.regex($selection.target.process.file.full_path, `.*\\cmd\.exe`) or re.regex($selection.target.process.file.full_path, `.*\\powershell\.exe`) or re.regex($selection.target.process.file.full_path, `.*\\wscript\.exe`) or re.regex($selection.target.process.file.full_path, `.*\\cscript\.exe`) or re.regex($selection.target.process.file.full_path, `.*\\sh\.exe`) or re.regex($selection.target.process.file.full_path, `.*\\bash\.exe`) or re.regex($selection.target.process.file.full_path, `.*\\reg\.exe`) or re.regex($selection.target.process.file.full_path, `.*\\regsvr32\.exe`) or re.regex($selection.target.process.file.full_path, `.*\\bitsadmin.*`)) and ($selection.metadata.product_event_type = "4688" or $selection.metadata.product_event_type = "1"))
<li><a href="#">events: (re.regex($selection.src.process.file.full_path, `.*\\powershell\.exe`) and (re.regex($selection.target.process.command_line, `.*\\schtasks\.exe.*/create.*/ru.*system.*/sc.*onlogon.*`) or re.regex($selection.target.process.command_line, `.*\\schtasks\.exe.*/create.*/ru.*system.*/sc.*daily.*`) or re.regex($selection.target.process.command_line, `.*\\schtasks\.exe.*/create.*/ru.*system.*/sc.*onidle.*`) or re.regex($selection.target.process.command_line, `.*\\schtasks\.exe.*/create.*/ru.*system.*/sc.*hourly.*`)))
<li><a href="#">events: (re.regex($selection.src.process.file.full_path, `.*\\powershell\.exe`) and (re.regex($selection.target.process.command_line, `.*schtasks.*/create.*/sc .*onlogon.*/tn .*updater.*/tr .*powershell.*`) or re.regex($selection.target.process.command_line, `.*schtasks.*/create.*/sc .*daily.*/tn .*updater.*/tr .*powershell.*`) or re.regex($selection.target.process.command_line, `.*schtasks.*/create.*/sc .*onidle.*/tn .*updater.*/tr .*powershell.*`) or re.regex($selection.target.process.command_line, `.*schtasks.*/create.*/sc .*updater.*/tn .*updater.*/tr .*powershell.*`)) and ($selection.metadata.product_event_type = "4688" or $selection.metadata.product_event_type = "1"))
<li><a href="#">events: (re.regex($selection.src.process.file.full_path, `.*\\svchost\.exe`) and re.regex($selection.target.process.file.full_path, `.*\\mmc\.exe`) and re.regex($selection.target.process.command_line, `.*-embedding.*`) and ($selection.metadata.product_event_type = "4688" or $selection.metadata.product_event_type = "1"))
<li><a href="#">events: (re.regex($selection.src.process.file.full_path, `.*\\w3wp\.exe`) and re.regex($selection.target.process.file.full_path, `.*\\cmd\.exe`))
<li><a href="#">events: (re.regex($selection.src.process.file.full_path, `.*\\winword\.exe`) and re.regex($selection.target.process.file.full_path, `.*\\microscmgmt\.exe `) and ($selection.metadata.product_event_type = "4688" or $selection.metadata.product_event_type = "1"))
<li><a href="#">events: (re.regex($selection.src.process.file.full_path, `.*desktopcentral_server\\jre\\bin\\java\.exe`) and (re.regex($selection.target.process.file.full_path, `.*\\cmd\.exe`) or re.regex($selection.target.process.file.full_path, `.*\\powershell\.exe`) or re.regex($selection.target.process.file.full_path, `.*\\bitsadmin\.exe`)) and ($selection.metadata.product_event_type = "4688" or $selection.metadata.product_event_type = "1"))
<li><a href="#">events: (re.regex($selection.src.process.file.full_path, `.*winword\.exe`) and re.regex($selection.target.process.command_line, `.*&&.*`) and re.regex($selection.target.process.command_line, `.*%~dp0.*`) and re.regex($selection.target.process.command_line, `.*-inul.*`) and re.regex($selection.target.process.command_line, `.*rar.*`) and re.regex($selection.target.process.command_line, `.*-o\+.*`) and re.regex($selection.target.process.command_line, `.* e .*`) and re.regex($selection.target.process.command_line, `.*\.jpg.*`) and ($selection.metadata.product_event_type = "4688" or $selection.metadata.product_event_type = "1"))
<li><a href="#">events: (re.regex($selection.target.file.full_path, `c:\\windows\\temp\\.*`) or re.regex($selection.target.file.full_path, `c:\\temp\\.*`) or re.regex($selection.target.file.full_path, `.*\\\\client\\.*`) or re.regex($selection.target.file.full_path, `c:\\perflogs\\.*`) or re.regex($selection.target.file.full_path, `c:\\users\\public\\.*`) or re.regex($selection.target.file.full_path, `c:\\users\\default\\.*`) or re.regex($selection.target.file.full_path, `.*\.ps1`) or re.regex($selection.target.file.full_path, `.*\.vbs`) or re.regex($selection.target.file.full_path, `.*\.bat`) or re.regex($selection.target.file.full_path, `.*\.chm`) or re.regex($selection.target.file.full_path, `.*\.xml`) or re.regex($selection.target.file.full_path, `.*\.txt`) or re.regex($selection.target.file.full_path, `.*\.jsp`) or re.regex($selection.target.file.full_path, `.*\.jspx`) or re.regex($selection.target.file.full_path, `.*\.asp`) or re.regex($selection.target.file.full_path, `.*\.aspx`) or re.regex($selection.target.file.full_path, `.*\.php`) or re.regex($selection.target.file.full_path, `.*\.war`) or re.regex($selection.target.file.full_path, `.*\.hta`) or re.regex($selection.target.file.full_path, `.*\.lnk`) or re.regex($selection.target.file.full_path, `.*\.scf`) or re.regex($selection.target.file.full_path, `.*\.wsf`) or re.regex($selection.target.file.full_path, `.*\.wsh`))
<li><a href="#">events: (re.regex($selection.target.hostname, `.*avsvmcloud\.com`) or re.regex($selection.target.hostname, `.*databasegalore\.com`) or re.regex($selection.target.hostname, `.*deftsecurity\.com`) or re.regex($selection.target.hostname, `.*freescanonline\.com`) or re.regex($selection.target.hostname, `.*panhardware\.com`) or re.regex($selection.target.hostname, `.*thedoccloud\.com`) or re.regex($selection.target.hostname, `.*incomeupdate\.com`) or re.regex($selection.target.hostname, `.*zupertech\.com`) or re.regex($selection.target.hostname, `.*digitalcollege\.org`) or re.regex($selection.target.hostname, `.*virtualdataserver\.com`) or re.regex($selection.target.hostname, `.*lcomputers\.com`) or re.regex($selection.target.hostname, `.*webcodez\.com`))
<li><a href="#">events: (re.regex($selection.target.process.command_line, `.* /dest:rdp-tcp:.*`) and ($selection.metadata.product_event_type = "4688" or $selection.metadata.product_event_type = "1"))
<li><a href="#">events: (re.regex($selection.target.process.command_line, `.* /injectrunning .*`) and ($selection.metadata.product_event_type = "4688" or $selection.metadata.product_event_type = "1"))
<li><a href="#">events: (re.regex($selection.target.process.command_line, `.* -bxor.*`) and ($selection.metadata.product_event_type = "4688" or $selection.metadata.product_event_type = "1"))
<li><a href="#">events: (re.regex($selection.target.process.command_line, `.* msiexec.*://.*`) and ($selection.metadata.product_event_type = "4688" or $selection.metadata.product_event_type = "1"))
<li><a href="#">events: (re.regex($selection.target.process.command_line, `.*\.settingcontent-ms.*`) and not (re.regex($selection.target.file.full_path, `.*immersivecontrolpanel.*`)))
<li><a href="#">events: (re.regex($selection.target.process.command_line, `.*\\bcdedit\.exe`) and (re.regex($selection.target.process.command_line, `.*delete.*`) or re.regex($selection.target.process.command_line, `.*deletevalue.*`) or re.regex($selection.target.process.command_line, `.*import.*`)) and ($selection.metadata.product_event_type = "4688" or $selection.metadata.product_event_type = "1"))
<li><a href="#">events: (re.regex($selection.target.process.command_line, `.*\\ntdsutil.*`) and ($selection.metadata.product_event_type = "4688" or $selection.metadata.product_event_type = "1"))
<li><a href="#">events: (re.regex($selection.target.process.command_line, `.*\\sysvol\\.*\\policies\\.*`) and ($selection.metadata.product_event_type = "4688" or $selection.metadata.product_event_type = "1"))
<li><a href="#">events: (re.regex($selection.target.process.command_line, `.*attrib\.exe \+h.*`) or re.regex($selection.target.process.command_line, `.*attrib\.exe \+s.*`) or re.regex($selection.target.process.command_line, `.*attrib\.exe \+r.*`) or re.regex($selection.target.process.command_line, `.*attrib\.exe -h.*`) or re.regex($selection.target.process.command_line, `.*attrib\.exe -s.*`) or re.regex($selection.target.process.command_line, `.*attrib\.exe -r.*`))
<li><a href="#">events: (re.regex($selection.target.process.command_line, `.*cmd.*`) and ($selection.metadata.product_event_type = "4688" or $selection.metadata.product_event_type = "1") and (re.regex($selection.target.process.command_line, `.*/c.*`) or re.regex($selection.target.process.command_line, `.*ping 127\.0\.0\.1.*`) or re.regex($selection.target.process.command_line, `.*&.*`) or re.regex($selection.target.process.command_line, `.*del.*`) or re.regex($selection.target.process.command_line, `.*/f.*`) or re.regex($selection.target.process.command_line, `.*/q.*`)) and (re.regex($selection.target.process.command_line, `.*\\windows\\temp.*`) or re.regex($selection.target.process.command_line, `.*\\appdata\\roaming\\microsoft.*`)))
<li><a href="#">events: (re.regex($selection.target.process.command_line, `.*java\.exe %% 1936 0x199c .*java\.exe -ht listenip:8080 -hu username -hp password c&c:443 null sid -- 0x0`) and $selection.metadata.product_event_type = "1" and re.regex($selection.target.process.file.full_path, `.*java\.exe`))
<li><a href="#">events: (re.regex($selection.target.process.command_line, `.*-noni -ep bypass $.*`) and ($selection.metadata.product_event_type = "4688" or $selection.metadata.product_event_type = "1"))
<li><a href="#">events: (re.regex($selection.target.process.command_line, `.*powershell.*`) and re.regex($selection.target.process.command_line, `.*\.downloadfile.*`) and re.regex($selection.target.process.command_line, `.*system\.net\.webclient.*`) and ($selection.metadata.product_event_type = "4688" or $selection.metadata.product_event_type = "1"))
<li><a href="#">events: (re.regex($selection.target.process.command_line, `.*regsvr32.*`) and ($selection.metadata.product_event_type = "4688" or $selection.metadata.product_event_type = "1") and re.regex($selection.target.process.command_line, `.*/s.*`) and re.regex($selection.target.process.command_line, `.*/i.*`) and (re.regex($selection.target.process.command_line, `.*\.txt.*`) or re.regex($selection.target.process.command_line, `.*\.dll.*`)))
<li><a href="#">events: (re.regex($selection.target.process.command_line, `.*schtasks\.exe /create /sc minute /tn systemsoundsservices /tr \"regsvr32\.exe\".*`) or re.regex($selection.target.process.command_line, `.*/s /n /u /i:http:.*`))
<li><a href="#">events: (re.regex($selection.target.process.command_line, `.*tokencache\.dat.*`) and ($selection.metadata.product_event_type = "4688" or $selection.metadata.product_event_type = "1"))
<li><a href="#">events: (re.regex($selection.target.process.command_line, `.*wimfile.*`) and re.regex($selection.target.process.command_line, `.*mountdir.*`) and re.regex($selection.target.process.command_line, `.*logpath.*`) and re.regex($selection.target.process.command_line, `.*index.*`) and ($selection.metadata.product_event_type = "4688" or $selection.metadata.product_event_type = "1"))
<li><a href="#">events: (re.regex($selection.target.process.command_line, `ls hklm:\\software\\microsoft\\windows\\currentversion\\winevt\\channels | where-object \\{$_\.name -like \".*sysmon.*\"\\}`) or $selection.target.process.command_line = "ls hkcu:\\software\\sysinternals | select-object name" or $selection.target.process.command_line = "get-ciminstance win32_service -filter \"description = 'system monitor service'\"")
<li><a href="#">events: (re.regex($selection.target.process.command_line, `netsh i.* p.*=3389 c.*`) and ($selection.metadata.product_event_type = "4688" or $selection.metadata.product_event_type = "1"))
<li><a href="#">events: (re.regex($selection.target.process.file.full_path, `.* \\vbc\.exe.*`) and (re.regex($selection.target.process.command_line, `.* /stext.*`) or re.regex($selection.target.process.command_line, `.* /scomma.*`) or re.regex($selection.target.process.command_line, `.*\\appdata\\local\\temp\\holdermail\.txt.*`) or re.regex($selection.target.process.command_line, `.*\\appdata\\local\\temp\\holderwb\.txt.*`) or re.regex($selection.target.process.command_line, `.*\\roaming\\pidloc\.txt.*`) or re.regex($selection.target.process.command_line, `.*\\roaming\\pidloc\.txt.*`)) and ($selection.metadata.product_event_type = "4688" or $selection.metadata.product_event_type = "1"))
<li><a href="#">events: (re.regex($selection.target.process.file.full_path, `.*/nslookup\.exe`) and re.regex($selection.target.process.command_line, `.*nslookup -type=.*sig.*`))
<li><a href="#">events: (re.regex($selection.target.process.file.full_path, `.*\\bitsadmin\.exe`) and $selection.target.process.command_line = "/transfer" and ($selection.metadata.product_event_type = "4688" or $selection.metadata.product_event_type = "1"))
<li><a href="#">events: (re.regex($selection.target.process.file.full_path, `.*\\bitsadmin\.exe`) and re.regex($selection.target.process.command_line, `.*bitsadmin\.exe /transfer helpcenterupload /upload /priority.*`))
<li><a href="#">events: (re.regex($selection.target.process.file.full_path, `.*\\cmd\.exe`) and re.regex($selection.target.process.command_line, `.*/c bcdedit /set {default} bootstatuspolicy ignoreallfailures & bcdedit /set {default} recoveryenabled no & wbadmin delete catalog -quiet & wmic shadowcopy delete`))
<li><a href="#">events: (re.regex($selection.target.process.file.full_path, `.*\\cmd\.exe`) and re.regex($selection.target.process.command_line, `.*rd.*`) and re.regex($selection.target.process.command_line, `.*/s.*`) and re.regex($selection.target.process.command_line, `.*/q.*`) and re.regex($selection.target.process.command_line, `.*timeout.*`) and re.regex($selection.target.process.command_line, `.* del .*`) and re.regex($selection.target.process.command_line, `.*\.exe.*`) and ($selection.metadata.product_event_type = "4688" or $selection.metadata.product_event_type = "1"))
<li><a href="#">events: (re.regex($selection.target.process.file.full_path, `.*\\cmdkey\.exe`) and re.regex($selection.target.process.command_line, `.* /list .*`) and ($selection.metadata.product_event_type = "4688" or $selection.metadata.product_event_type = "1"))
<li><a href="#">events: (re.regex($selection.target.process.file.full_path, `.*\\cscript\.exe`) and re.regex($selection.target.process.command_line, `.*cscript manage-bde\.wsf.*`) and ($selection.metadata.product_event_type = "4688" or $selection.metadata.product_event_type = "1"))
<li><a href="#">events: (re.regex($selection.target.process.file.full_path, `.*\\microsoft\.workflow\.compiler\.exe`) and ($selection.metadata.product_event_type = "4688" or $selection.metadata.product_event_type = "1"))
<li><a href="#">events: (re.regex($selection.target.process.file.full_path, `.*\\powershell\.exe`) and ($selection.target.process.command_line = " -windowstyle h " or $selection.target.process.command_line = " -windowstyl h" or $selection.target.process.command_line = " -windowsty h" or $selection.target.process.command_line = " -windowst h" or $selection.target.process.command_line = " -windows h" or $selection.target.process.command_line = " -windo h" or $selection.target.process.command_line = " -wind h" or $selection.target.process.command_line = " -win h" or $selection.target.process.command_line = " -wi h" or $selection.target.process.command_line = " -win h " or $selection.target.process.command_line = " -win hi " or $selection.target.process.command_line = " -win hid " or $selection.target.process.command_line = " -win hidd " or $selection.target.process.command_line = " -win hidde " or $selection.target.process.command_line = " -nopr " or $selection.target.process.command_line = " -nopro " or $selection.target.process.command_line = " -noprof " or $selection.target.process.command_line = " -noprofi " or $selection.target.process.command_line = " -noprofil " or $selection.target.process.command_line = " -nonin " or $selection.target.process.command_line = " -nonint " or $selection.target.process.command_line = " -noninte " or $selection.target.process.command_line = " -noninter " or $selection.target.process.command_line = " -nonintera " or $selection.target.process.command_line = " -noninterac " or $selection.target.process.command_line = " -noninteract " or $selection.target.process.command_line = " -noninteracti " or $selection.target.process.command_line = " -noninteractiv " or $selection.target.process.command_line = " -ec " or $selection.target.process.command_line = " -encodedcomman " or $selection.target.process.command_line = " -encodedcomma " or $selection.target.process.command_line = " -encodedcomm " or $selection.target.process.command_line = " -encodedcom " or $selection.target.process.command_line = " -encodedco " or $selection.target.process.command_line = " -encodedc " or $selection.target.process.command_line = " -encoded " or $selection.target.process.command_line = " -encode " or $selection.target.process.command_line = " -encod " or $selection.target.process.command_line = " -enco " or $selection.target.process.command_line = " -en ") and ($selection.metadata.product_event_type = "4688" or $selection.metadata.product_event_type = "1"))
<li><a href="#">events: (re.regex($selection.target.process.file.full_path, `.*\\powershell\.exe`) and (re.regex($selection.target.process.command_line, `.*new-object system\.net\.webclient\)\.downloadstring\(.*`) or re.regex($selection.target.process.command_line, `.*new-object system\.net\.webclient\)\.downloadfile\(.*`) or re.regex($selection.target.process.command_line, `.*new-object net\.webclient\)\.downloadstring\(.*`) or re.regex($selection.target.process.command_line, `.*new-object net\.webclient\)\.downloadfile\(.*`)) and ($selection.metadata.product_event_type = "4688" or $selection.metadata.product_event_type = "1"))
<li><a href="#">events: (re.regex($selection.target.process.file.full_path, `.*\\sdbinst\.exe`) and ($selection.target.process.command_line = "-q" or $selection.target.process.command_line = "-p") and ($selection.metadata.product_event_type = "4688" or $selection.metadata.product_event_type = "1"))
<li><a href="#">events: (re.regex($selection.target.process.file.full_path, `.*\\services\.exe`) and not ($selection.src.process.file.full_path = "c:\\windows\\system32\\wininit.exe"))
<li><a href="#">events: (re.regex($selection.target.process.file.full_path, `.*\\temporary internet files\\content\.outlook\\.*`) and ($selection.metadata.product_event_type = "4688" or $selection.metadata.product_event_type = "1"))
<li><a href="#">events: (re.regex($selection.target.process.file.full_path, `.*\\wmic\.exe`) and (re.regex($selection.target.process.command_line, `.*/node:.*process call create .*`) or re.regex($selection.target.process.command_line, `.* path antivirusproduct get .*`) or re.regex($selection.target.process.command_line, `.* path firewallproduct get .*`) or re.regex($selection.target.process.command_line, `.* shadowcopy delete .*`)) and ($selection.metadata.product_event_type = "4688" or $selection.metadata.product_event_type = "1"))
<li><a href="#">events: (re.regex($selection.target.process.file.full_path, `.*dllhost\.exe`) and (re.regex($selection.target.process.command_line, `.*windows\\.*\\dllhost\.exe /processid:{3e5fc7f9-9a51-4367-9063-a120244fbec7}.*`) or re.regex($selection.target.process.command_line, `.*windows\\.*\\dllhost\.exe /processid:{d2e7041b-2927-42fb-8e9f-7ce93b6dc937}.*`)) and ($selection.metadata.product_event_type = "4688" or $selection.metadata.product_event_type = "1"))
<li><a href="#">events: (re.regex($selection.target.process.file.full_path, `.*libvlc\.dll.*`) and re.regex($selection.target.process.file.full_path, `.*videolan.*`))
<li><a href="#">events: (re.regex($selection.target.process.file.full_path, `.*vssadmin\.exe`) and re.regex($selection.src.process.file.full_path, `.*qesw\.exe`) and $selection.target.process.command_line = "vssadmin.exe delete shadows /all /quiet")
<li><a href="#">events: (re.regex($selection.target.registry.registry_value_data, `.*dumpcreds.*`) or re.regex($selection.target.registry.registry_value_data, `.*mimikatz.*`) or re.regex($selection.target.registry.registry_value_data, `.*pwcrack.*`) or $selection.target.registry.registry_value_data = "htool/wce" or re.regex($selection.target.registry.registry_value_data, `.*pswtool.*`) or re.regex($selection.target.registry.registry_value_data, `.*pwdump.*`))
<li><a href="#">events: (re.regex($selection.target.registry.registry_value_data, `.*metetool.*`) or re.regex($selection.target.registry.registry_value_data, `.*mpreter.*`) or re.regex($selection.target.registry.registry_value_data, `.*meterpreter.*`) or re.regex($selection.target.registry.registry_value_data, `.*metasploit.*`) or re.regex($selection.target.registry.registry_value_data, `.*powersploit.*`) or re.regex($selection.target.registry.registry_value_data, `.*cobaltsrike.*`) or re.regex($selection.target.registry.registry_value_data, `.*swrort.*`) or re.regex($selection.target.registry.registry_value_data, `.*rozena.*`) or re.regex($selection.target.registry.registry_value_data, `.*backdoor\.cobalt.*`))
<li><a href="#">events: (re.regex($selection.target.registry.registry_value_data, `php/backdoor.*`) or re.regex($selection.target.registry.registry_value_data, `jsp/backdoor.*`) or re.regex($selection.target.registry.registry_value_data, `asp/backdoor.*`) or re.regex($selection.target.registry.registry_value_data, `backdoor\.php.*`) or re.regex($selection.target.registry.registry_value_data, `backdoor\.jsp.*`) or re.regex($selection.target.registry.registry_value_data, `backdoor\.asp.*`) or re.regex($selection.target.registry.registry_value_data, `.*webshell.*`))
<li><a href="#">events: (re.regex($selection.target.url, `.*/\.\./vpns/.*`) or re.regex($selection.target.url, `.*/vpns/cfg/smb\.conf`) or re.regex($selection.target.url, `.*/vpns/portal/scripts/.*\.pl.*`))
<li><a href="#">events: (re.regex($selection.target.url, `.*/is-ready`) and (re.regex($selection.src.application, `.*|>plus<|.*`) or re.regex($selection.src.application, `.*|>underworld final<|.*`)))
<li><a href="#">events: (re.regex($selection.target.url, `.*/oscp/.*`) and $selection.principal.hostname = "ocsp.verisign.com")
<li><a href="#">events: (re.regex($selection.target.url, `aaa\.stage\..*`) or re.regex($selection.target.url, `post\.1.*`))
<li><a href="#">events: (re.regex($selection_cutil.target.process.command_line, `.*/i:%appdata%\\logs\.txt scrobj\.dll`) and (re.regex($selection_cutil.target.process.file.full_path, `.*\\cutil\.exe`) or $selection_cutil.metadata.description = "microsoft(c) registerserver"))
<li><a href="#">events: (re.regex($selection_image.target.process.file.full_path, `.*\\adpasshunt\.exe`) or (re.regex($selection_image.target.process.command_line, `.*dc.*`) and re.regex($selection_image.target.process.command_line, `.*domain.*`) and re.regex($selection_image.target.process.command_line, `.*action.*`) and ($selection_image.metadata.product_event_type = "4688" or $selection_image.metadata.product_event_type = "1") and (re.regex($selection_image.target.process.command_line, `.*gpp.*`) or re.regex($selection_image.target.process.command_line, `.*ad.*`))))
<li><a href="#">events: (re.regex($selection_image.target.process.file.full_path, `.*\\excavator\.exe`) or re.regex($selection_image.target.file.full_path, `.*\\excavator\.exe`))
<li><a href="#">events: (re.regex($selection_image.target.process.file.full_path, `.*\\hpcustpartui\.dll`) and not ((re.regex($selection_image.target.process.file.full_path, `.*program files\\hp\\.*`) or re.regex($selection_image.target.process.file.full_path, `.*program files \(x86\)\\hp\\.*`) or re.regex($selection_image.target.process.file.full_path, `.*progra~.*`) or re.regex($selection_image.target.process.file.full_path, `.*program files \(x86\)\\trend micro\\.*`) or re.regex($selection_image.target.process.file.full_path, `.*program files\\trend micro\\.*`))))
<li><a href="#">events: (re.regex($selection0.target.process.file.full_path, `.*:.*`) or re.regex($selection0.src.process.file.full_path, `.*:.*`))
<li><a href="#">events: (re.regex($selection0.target.process.file.full_path, `harddiskvolumeshadowcopy.*`) or re.regex($selection0.target.process.command_line, `harddiskvolumeshadowcopy.*`))
<li><a href="#">events: (re.regex($selection1.src.process.command_line, `.*\\dllhost\.exe`) and ($selection1.metadata.product_event_type = "4688" or $selection1.metadata.product_event_type = "1") and (re.regex($selection1.src.process.command_line, `.*{3e5fc7f9-9a51-4367-9063-a120244fbec7}`) or re.regex($selection1.src.process.command_line, `.*{3e000d72-a845-4cd9-bd83-80c07c3b881f}`)))
<li><a href="#">events: (re.regex($selection1.src.process.file.full_path, `.*\\mshta\.exe`) and ($selection1.target.process.file.full_path = "c:\\windows\\system32\\mshta.exe" or re.regex($selection1.target.process.file.full_path, `.*\\rekeywiz\.exe`)) and (re.regex($selection1.target.process.command_line, `.*966029e\.hta.*`) or re.regex($selection1.target.process.command_line, `.*rekeywiz\.exe.*`)))
<li><a href="#">events: (re.regex($selection1.src.process.file.full_path, `.*\\vshadow\.exe`) or re.regex($selection1.src.process.file.full_path, `.*\\diskshadow\.exe`) or (re.regex($selection1.target.process.command_line, `.*vshadow\.exe -nw -exec=.*`) or re.regex($selection1.target.process.command_line, `.*diskshadow\.exe /s \?:\\\\.*`)))
<li><a href="#">events: (re.regex($selection1.src.process.file.full_path, `.*\\winword\.exe`) and (re.regex($selection1.target.process.file.full_path, `.*\\cmd\.exe`) or re.regex($selection1.target.process.file.full_path, `.*\\powershell\.exe`)) and (re.regex($selection1.target.process.command_line, `.*/c copy .*.*\.docx .*\.rar && \"c:\\program files\\winrar\\winrar\.exe\" x -o\+ -ibck .*\.rar .*\.bat && start /b .*\.bat .*\.exe microsoft word`) or re.regex($selection1.target.process.command_line, `c:\\programs\\microsoft\\office\\msword\.exe\\\.\.\\\.\.\\\.\.\\\.\..*\\powershell\.exe copy .*.*\.docx .*\.rar; & .*\\winrar\.exe x -ibck .*\.rar .*\.exe;start-sleep 5;start .*\.exe msw`)))
<li><a href="#">events: (re.regex($selection1.src.process.file.full_path, `.*wmiprvse\.exe`) and re.regex($selection1.target.process.file.full_path, `.*cmd\.exe`) and re.regex($selection1.target.process.command_line, `.*cmd\.exe /q /k .*`) and re.regex($selection1.target.process.command_line, `.*\\\\\\\\127\.0\.0\.1\\admin$\\.*\.dat.*`) and ($selection1.metadata.product_event_type = "4688" or $selection1.metadata.product_event_type = "1"))
<li><a href="#">events: (re.regex($selection1.target.process.command_line, `.*aaaayinlm.*`) and ($selection1.metadata.product_event_type = "4688" or $selection1.metadata.product_event_type = "1") and (re.regex($selection1.target.process.command_line, `.*oicaaaayinlm.*`) or re.regex($selection1.target.process.command_line, `.*oijaaaayinlm.*`)))
<li><a href="#">events: (re.regex($selection1.target.process.command_line, `.*system\.management\.automation\.amsiutils.*`) and ($selection1.metadata.product_event_type = "4688" or $selection1.metadata.product_event_type = "1") and re.regex($selection1.target.process.command_line, `.*amsiinitfailed.*`))
<li><a href="#">events: (re.regex($selection1.target.process.file.full_path, `.*\\reg\.exe`) and re.regex($selection1.src.process.file.full_path, `.*\\cmd\.exe`) and (re.regex($selection1.target.process.command_line, `reg add \"hkey_current_user\\software\\microsoft\\windows\\currentversion\\run\" /v \"svchos\" /t reg_sz /d \".*\\bpwpc\.exe\" /f`) or re.regex($selection1.target.process.command_line, `reg add \"hkey_current_user\\software\\microsoft\\windows\\currentversion\\run\" /v \"svchos\" /t reg_sz /d \".*\\ylzhk\.exe\" /f`) or re.regex($selection1.target.process.command_line, `reg add \"hkey_current_user\\software\\microsoft\\windows\\currentversion\\run\" /v \"svchos\" /t reg_sz /d \".*\\rojwa\.exe\" /f`)) and ($selection1.target.process.command_line = "vssadmin delete shadows /all /quiet" or re.regex($selection1.target.process.command_line, `vssadmin resize shadowstorage.*.*`)))
<li><a href="#">events: (re.regex($selection1.target.process.file.full_path, `.*cmd\.exe`) and ($selection1.metadata.product_event_type = "4688" or $selection1.metadata.product_event_type = "1") and (re.regex($selection1.src.process.file.full_path, `.*rundll32\.exe`) or re.regex($selection1.src.process.file.full_path, `.*httpd\.exe`) or re.regex($selection1.src.process.file.full_path, `.*svchost\.exe`) or re.regex($selection1.src.process.file.full_path, `.*w3wp\.exe`)))
<li><a href="#">events: (re.regex($selection1.target.process.file.full_path, `.*wmic\.exe`) and (re.regex($selection1.target.process.command_line, `.* .* desktopmonitor get pnpdeviceid .*`) or re.regex($selection1.target.process.command_line, `.* .* sounddev get pnpdeviceid .*`) or re.regex($selection1.target.process.command_line, `.* .* bios get serialnumber .*`) or re.regex($selection1.target.process.command_line, `.* .* baseboard get serialnumber .*`) or re.regex($selection1.target.process.command_line, `.* .* diskdrive get pnpdeviceid .*`) or re.regex($selection1.target.process.command_line, `.* .* cpu get processorid .*`)) and ($selection1.metadata.product_event_type = "4688" or $selection1.metadata.product_event_type = "1"))
<li><a href="#">events: (re.regex($selection1.target.process.file.full_path, `c:\\windows\\microsoft\.net\\framework.*\\vbc\.exe`) and (($selection1.metadata.product_event_type = "11" and re.regex($selection1.target.file.full_path, `c:\\users.*\\appdata\\local\\temp.*\.tmp`)) or ($selection1.metadata.product_event_type = "1" and re.regex($selection1.target.process.command_line, `.* /stext \"\"c:\\users.*\\appdata\\local\\temp.*\.tmp`))))
<li><a href="#">events: (re.regex($selection3.target.file.full_path, `.*appdata\\.*\\fakerx86\.exe.*`) or re.regex($selection3.target.file.full_path, `.*appdata\\.*\\dbgeng\.dll.*`))
<li><a href="#">events: re.regex($selection.src.application, `.* windowspowershell/.*`)
<li><a href="#">events: re.regex($selection.src.application, `microsoft bits.*`)
<li><a href="#">events: re.regex($selection.src.application, `microsoft-webdav-miniredir/.*`)
<li><a href="#">events: re.regex($selection.target.process.command_line, `.*\\software\\microsoft\\windows\\currentversion\\policies\\attachments`)
<li><a href="#">events: re.regex($selection.target.process.command_line, `cmd\.exe /c \"start http.*`)
<li><a href="#">events: re.regex($selection.target.url, `.*/asp\.asp\?ui=.*`)
<li><a href="#">events: re.regex($selection.target.url, `.*/config/keystore/.*\.js.*`)
<li><a href="#">events: re.regex($selection.target.url, `.*/gate\.php`)
<li><a href="#">events: re.regex($selection.target.url, `.*/remote/fgt_lang\?lang=/\.\./\.\./\.\./\.\.//////////dev/cmdb/sslvpn_websession.*`)
<li><a href="#">events: re.regex($selection.target.url, `.*\?/dana/html5acc/guacamole/.*`)
<li><a href="#">events: re.regex($selection.target.url, `.*==\..*`)
<li><a href="#">events: re.regex($selection.target.url, `.*burpcollaborator.*`)
<li><a href="#">query = (event.code: "5136" and winlog.event_data.attributeldapdisplayname:("gpcmachineextensionnames" or "gpcuserextensionnames") and winlog.event_data.attributevalue:(*cab54552-deea-4691-817e-ed4a4d1afc72* and *aadced64-746c-4633-a97c-d61349046527*)) or (event.code: "5145" and winlog.event_data.sharename: "\\\\*\\sysvol" and winlog.event_data.relativetargetname: *scheduledtasks.xml and (message: writedata or winlog.event_data.accesslist: *%%4417*))"
<li><a href="#">query = (event.code:5136 and winlog.event_data.attributeldapdisplayname:(gpcmachineextensionnames or gpcuserextensionnames) and winlog.event_data.attributevalue:(*42b5faae-6536-11d2-ae5a-0000f87571e3* and (*40b66650-4972-11d1-a7ca-0000f87571e3* or *40b6664f-4972-11d1-a7ca-0000f87571e3*))) or (event.code:5145 and winlog.event_data.sharename:\\\\*\\sysvol and winlog.event_data.relativetargetname:(*\\scripts.ini or *\\psscripts.ini) and (message:writedata or winlog.event_data.accesslist:*%%4417*))
<li><a href="#">query = any where (event.category : ("library", "driver") or (event.category == "process" and event.action : "image loaded*")) and (dll.name : ("system.management.automation.ni.dll", "system.management.automation.dll") or file.name : ("system.management.automation.ni.dll", "system.management.automation.dll")) and not process.executable : ("c:\\windows\\system32\\remotefxvgpudisablement.exe", "c:\\windows\\system32\\sdiagnhost.exe") and not process.executable regex~c:\\program files(\(x86\))?\\*\.exe" and not process.name : ("altaro.subagent.exe", "appv_manage.exe", "azureadconnect.exe", "ccmexec.exe", "configsyncrun.exe", "choco.exe", "ctxappvservice.exe", "dvls.console.exe", "edgetransport.exe", "exsetup.exe", "forefrontactivedirectoryconnector.exe", "installutil.exe", "jenkinsondesktop.exe", "microsoft.enterprisemanagement.servicemanager.ui.console.exe", "mmc.exe", "mscorsvw.exe", "msexchangedelivery.exe", "msexchangefrontendtransport.exe", "msexchangehmworker.exe", "msexchangesubmission.exe", "msiexec.exe", "msiexec.exe", "noderunner.exe", "nservicebus.host.exe", "nservicebus.host32.exe", "nservicebus.hosting.azure.hostprocess.exe", "ouigui.wpf.exe", "powershell.exe", "powershell_ise.exe", "pwsh.exe", "sccmclictrwpf.exe", "scripteditor.exe", "scriptrunner.exe", "sdiagnhost.exe", "servermanager.exe", "setup100.exe", "servicehub.vsdetouredhost.exe", "spcaf.client.exe", "spcaf.settingseditor.exe", "sqlps.exe", "telemetryservice.exe", "umworkerprocess.exe", "w3wp.exe", "wsmprovhost.exe")"
<li><a href="#">query = any where (event.category : ("library", "driver") or (event.category == "process" and event.action : "image loaded*")) and process.name : ("winword.exe", "excel.exe", "powerpnt.exe", "mspub.exe", "msaccess.exe") and (dll.name : "wmiutils.dll" or file.name : "wmiutils.dll")"
<li><a href="#">query = any where (event.category == "file" and event.type in ("change", "creation") and file.path : ("/private/etc/hosts", "/etc/hosts", "?:\\windows\\system32\\drivers\\etc\\hosts")) or (event.category == "process" and event.type in ("start") and process.name in ("nano", "vim", "vi", "emacs", "echo", "sed") and process.args : ("/etc/hosts"))"
<li><a href="#">query = any where (event.category == "library" or (event.category == "process" and event.action : "image loaded*")) and ((dll.name : ("wlbsctrl.dll", "wbemcomn.dll", "wptsextensions.dll", "tsmsisrv.dll", "tsvipsrv.dll", "msfte.dll", "wow64log.dll", "windowscoredeviceinfo.dll", "ualapi.dll", "wlanhlp.dll", "phoneinfo.dll", "edgegdi.dll", "cdpsgshims.dll", "windowsperformancerecordercontrol.dll", "diagtrack_win.dll", "oci.dll", "tppcoipw32.dll", "tpgenlic.dll", "thinmon.dll", "fxsst.dll", "mstracer.dll") and (dll.code_signature.trusted == false or dll.code_signature.exists == false)) or (file.name : ("wlbsctrl.dll", "wbemcomn.dll", "wptsextensions.dll", "tsmsisrv.dll", "tsvipsrv.dll", "msfte.dll", "wow64log.dll", "windowscoredeviceinfo.dll", "ualapi.dll", "wlanhlp.dll", "phoneinfo.dll", "edgegdi.dll", "cdpsgshims.dll", "windowsperformancerecordercontrol.dll", "diagtrack_win.dll", "oci.dll", "tppcoipw32.dll", "tpgenlic.dll", "thinmon.dll", "fxsst.dll", "mstracer.dll") and not file.code_signature.status == "valid"))"
<li><a href="#">query = any where (event.category == "library" or (event.category == "process" and event.action : "image loaded*")) and (dll.name : "mstscax.dll" or file.name : "mstscax.dll") and process.executable : ("c:\\windows\\*", "c:\\users\\public\\*", "c:\\users\\default\\*", "c:\\intel\\*", "c:\\perflogs\\*", "c:\\programdata\\*", "\\device\\mup\\*", "\\\\*") and not process.executable : ("c:\\windows\\system32\\mstsc.exe", "c:\\windows\\syswow64\\mstsc.exe")"
<li><a href="#">query = any where (event.category == "library" or (event.category == "process" and event.action : "image loaded*")) and process.name : ("winword.exe", "excel.exe", "powerpnt.exe", "mspub.exe", "msaccess.exe") and (dll.name : "taskschd.dll" or file.name : "taskschd.dll")"
<li><a href="#">query = any where (event.category == "registry" and registry.path : "hklm\\software\\policies\\microsoft\\windows nt\\terminal services\\shadow") or (event.category == "process" and (process.name : ("rdpsauachelper.exe", "rdpsaproxy.exe") and process.parent.name : "svchost.exe") or (process.pe.original_file_name : "mstsc.exe" and process.args : "/shadow:*"))"
<li><a href="#">query = any where (event.code : "4697" and (winlog.event_data.servicefilename : ("*comspec*", "*\\172.0.0.1*", "*admin$*", "*powershell*", "*rundll32*", "*cmd.exe*", "*psexesvc*", "*echo*", "*remcomsvc*") or winlog.event_data.servicefilename regex~%systemroot%\\[a-z0-9]+\.exe")) or (event.code : "7045" and winlog.event_data.imagepath : ("*comspec*", "*\\172.0.0.1*", "*admin$*", "*powershell*", "*rundll32*", "*cmd.exe*", "*psexesvc*", "*echo*", "*remcomsvc*"))"
<li><a href="#">query = any where event.action == "directory service access" and event.code == "4662" and not winlog.event_data.subjectusersid : "s-1-5-18" and winlog.event_data.properties : ("*612cb747-c0e8-4f92-9221-fdd5f15b550d*", "*b8dfa744-31dc-4ef1-ac7c-84baf7ef9da7*", "*b3f93023-9239-4f7c-b99c-6745d87adbc2*", "*b7ff5a38-0818-42b0-8110-d3d154c97f24*") and not winlog.event_data.accessmask in ("0x0", "0x100")"
<li><a href="#">query = any where event.action == "directory service access" and event.code == "4662" and winlog.event_data.properties : ("*ds-replication-get-changes*", "*ds-replication-get-changes-all*", "*ds-replication-get-changes-in-filtered-set*", "*1131f6ad-9c07-11d1-f79f-00c04fc2dcd2*", "*1131f6aa-9c07-11d1-f79f-00c04fc2dcd2*", "*89e95b76-444d-4c62-991a-0facbeda640c*") and winlog.event_data.accessmask : "0x100" and not winlog.event_data.subjectusername : ("*$", "msol_*")"
<li><a href="#">query = any where event.action == "directory service changes" and event.code == "5136" and winlog.event_data.attributeldapdisplayname : "dsheuristics" and length(winlog.event_data.attributevalue) > 15 and winlog.event_data.attributevalue regex~ "[0-9]{15}([1-9a-f]).*"
<li><a href="#">query = any where event.action == "file system" and event.code == "4656" and winlog.event_data.objectname : ("?:\\windows\\system32\\lsass.exe", "\\device\\harddiskvolume?\\windows\\system32\\lsass.exe", "\\device\\harddiskvolume??\\windows\\system32\\lsass.exe") and (winlog.event_data.accessmask : ("0x1fffff" , "0x1010", "0x120089", "0x1f3fff") or winlog.event_data.accessmaskdescription : ("read_control", "read from process memory")) and not winlog.event_data.processname : ("?:\\program files\\*.exe", "?:\\program files (x86)\\*.exe", "?:\\windows\\system32\\wbem\\wmiprvse.exe", "?:\\windows\\system32\\dllhost.exe", "?:\\windows\\system32\\svchost.exe", "?:\\windows\\system32\\msiexec.exe", "?:\\programdata\\microsoft\\windows defender\\*.exe", "?:\\windows\\explorer.exe")"
<li><a href="#">query = any where event.provider: "microsoft-windows-security-auditing" and event.action : "token right adjusted events" and winlog.event_data.enabledprivilegelist : "sedebugprivilege" and not winlog.event_data.subjectusersid : ("s-1-5-18", "s-1-5-19", "s-1-5-20") and not winlog.event_data.processname : ("?:\\windows\\system32\\msiexec.exe", "?:\\windows\\syswow64\\msiexec.exe", "?:\\windows\\system32\\lsass.exe", "?:\\windows\\winsxs\\*", "?:\\program files\\*", "?:\\program files (x86)\\*", "?:\\windows\\system32\\mrt.exe", "?:\\windows\\system32\\cleanmgr.exe", "?:\\windows\\system32\\taskhostw.exe", "?:\\windows\\system32\\mmc.exe", "?:\\users\\*\\appdata\\local\\temp\\*-*\\dismhost.exe", "?:\\windows\\system32\\auditpol.exe", "?:\\windows\\system32\\wbem\\wmiprvse.exe", "?:\\windows\\syswow64\\wbem\\wmiprvse.exe")"
<li><a href="#">query = event.action: "authorization policy change" and event.code:4704 and winlog.event_data.privilegelist:"seenabledelegationprivilege"
<li><a href="#">query = event.action:"directory service changes" and event.code:"5136" and winlog.event_data.attributeldapdisplayname:"msds-keycredentiallink" and winlog.event_data.attributevalue :b\:828*"
<li><a href="#">query = event.action:"directory service changes" and event.code:"5136" and winlog.event_data.attributeldapdisplayname:"mspkiaccountcredentials" and winlog.event_data.operationtype:"%%14674" and not winlog.event_data.subjectusersid : "s-1-5-18"
<li><a href="#">query = event.action:"directory service changes" and event.code:5136 and winlog.event_data.objectclass:"user" and winlog.event_data.attributeldapdisplayname:"serviceprincipalname"
<li><a href="#">query = event.action:"directory service changes" and event.code:5136 and winlog.event_data.objectdn:cn=adminsdholder,cn=system*"
<li><a href="#">query = event.action:"modified-user-account" and event.code:"4738" and message:"'don't expire password' - enabled" and not user.id:"s-1-5-18"
<li><a href="#">query = event.action:"service-installed" and (winlog.event_data.clientprocessid:"0" or winlog.event_data.parentprocessid:"0")"
<li><a href="#">query = event.action:("audit-log-cleared" or "log clear")"
<li><a href="#">query = event.action:modified-user-account and event.code:4738 and winlog.event_data.allowedtodelegateto:*krbtgt*
<li><a href="#">query = event.agent_id_status:agent_id_mismatch
<li><a href="#">query = event.category : "driver" and event.action : "load"
<li><a href="#">query = event.category : file and event.action : modification and file.path : /users/*/library/preferences/com.apple.dock.plist and not process.name : (xpcproxy or cfprefsd or plutil or jamf or plistbuddy or installerremotepluginservice)
<li><a href="#">query = event.category : process and event.type : (start or process_started) and process.name : mount_apfs and process.args : (/system/volumes/data and noowners)
<li><a href="#">query = event.category : process and event.type : start and process.name : networksetup and process.args : (("-setwebproxy" or "-setsecurewebproxy" or "-setautoproxyurl") and not (bluetooth or off)) and not process.parent.executable : ("/library/privilegedhelpertools/com.80pct.freedomhelper" or "/applications/fiddler everywhere.app/contents/resources/app/out/webserver/fiddler.webui" or "/usr/libexec/xpcproxy")"
<li><a href="#">query = event.category:"file" and not event.type:"deletion" and file.name:"com.apple.loginwindow.plist" and process.name:(* and not (systemmigrationd or desktopserviceshelper or diskmanagementd or rsync or launchd or cfprefsd or xpcproxy or managedclient or mcxcompositor or backupd or "imazing profile editor"))"
<li><a href="#">query = event.category:"file" and not event.type:"deletion" and file.path:(/private/etc/periodic/* or /private/etc/defaults/periodic.conf or /private/etc/periodic.conf)"
<li><a href="#">query = event.category:"file" and not event.type:"deletion" and file.path:/users/*/.atom/init.coffee and not process.name:(atom or xpcproxy) and not user.name:root"
<li><a href="#">query = event.category:(network or network_traffic) and (tls.server.hash.md5:950098276a495286eb2a2556fbab6d83 or tls.server.hash.sha1:6ece5ece4192683d2d84e25b0ba7e04f9cb7eb7c or tls.server.hash.sha256:87f2085c32b6a2cc709b365f55873e207a9caa10bffecf2fd16d3cf9d94d390c)
<li><a href="#">query = event.category:(network or network_traffic) and destination.port:23 and network.direction:(inbound or ingress or outbound or egress) and not event.action:(flow_dropped or denied or deny or flow_terminated or timeout or reject or network_flow)
<li><a href="#">query = event.category:(network or network_traffic) and destination.port:53 and (event.dataset:zeek.dns or type:dns or event.type:connection) and network.bytes > 60000
<li><a href="#">query = event.category:(network or network_traffic) and network.protocol:http and (url.extension:(ps1 or rar) or url.path:(*.ps1 or *.rar)) and not destination.ip:(10.0.0.0/8 or 127.0.0.0/8 or 169.254.0.0/16 or 172.16.0.0/12 or 192.0.0.0/24 or 192.0.0.0/29 or 192.0.0.8/32 or 192.0.0.9/32 or 192.0.0.10/32 or 192.0.0.170/32 or 192.0.0.171/32 or 192.0.2.0/24 or 192.31.196.0/24 or 192.52.193.0/24 or 192.168.0.0/16 or 192.88.99.0/24 or 224.0.0.0/4 or 100.64.0.0/10 or 192.175.48.0/24 or 198.18.0.0/15 or 198.51.100.0/24 or 203.0.113.0/24 or 240.0.0.0/4 or "::1" or "fe80::/10" or "ff00::/8") and source.ip:(10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16)"
<li><a href="#">query = event.category:(network or network_traffic) and network.protocol:http and network.transport:tcp and url.full:/http:\/\/[0-9]{1,3}.[0-9]{1,3}.[0-9]{1,3}.[0-9]{1,3}\/cd/ and destination.port:(53 or 80 or 8080 or 443)
<li><a href="#">query = event.category:(network or network_traffic) and network.transport:tcp and (destination.port:(139 or 445) or event.dataset:zeek.smb) and source.ip:(10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16) and not destination.ip:(10.0.0.0/8 or 127.0.0.0/8 or 169.254.0.0/16 or 172.16.0.0/12 or 192.0.0.0/24 or 192.0.0.0/29 or 192.0.0.8/32 or 192.0.0.9/32 or 192.0.0.10/32 or 192.0.0.170/32 or 192.0.0.171/32 or 192.0.2.0/24 or 192.31.196.0/24 or 192.52.193.0/24 or 192.168.0.0/16 or 192.88.99.0/24 or 224.0.0.0/4 or 100.64.0.0/10 or 192.175.48.0/24 or 198.18.0.0/15 or 198.51.100.0/24 or 203.0.113.0/24 or 240.0.0.0/4 or "::1" or "fe80::/10" or "ff00::/8")"
<li><a href="#">query = event.category:(network or network_traffic) and network.transport:tcp and (destination.port:135 or event.dataset:zeek.dce_rpc) and not source.ip:(10.0.0.0/8 or 127.0.0.0/8 or 169.254.0.0/16 or 172.16.0.0/12 or 192.0.0.0/24 or 192.0.0.0/29 or 192.0.0.8/32 or 192.0.0.9/32 or 192.0.0.10/32 or 192.0.0.170/32 or 192.0.0.171/32 or 192.0.2.0/24 or 192.31.196.0/24 or 192.52.193.0/24 or 192.168.0.0/16 or 192.88.99.0/24 or 224.0.0.0/4 or 100.64.0.0/10 or 192.175.48.0/24 or 198.18.0.0/15 or 198.51.100.0/24 or 203.0.113.0/24 or 240.0.0.0/4 or "::1" or "fe80::/10" or "ff00::/8") and destination.ip:(10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16)"
<li><a href="#">query = event.category:(network or network_traffic) and network.transport:tcp and (destination.port:135 or event.dataset:zeek.dce_rpc) and source.ip:(10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16) and not destination.ip:(10.0.0.0/8 or 127.0.0.0/8 or 169.254.0.0/16 or 172.16.0.0/12 or 192.0.0.0/24 or 192.0.0.0/29 or 192.0.0.8/32 or 192.0.0.9/32 or 192.0.0.10/32 or 192.0.0.170/32 or 192.0.0.171/32 or 192.0.2.0/24 or 192.31.196.0/24 or 192.52.193.0/24 or 192.168.0.0/16 or 192.88.99.0/24 or 224.0.0.0/4 or 100.64.0.0/10 or 192.175.48.0/24 or 198.18.0.0/15 or 198.51.100.0/24 or 203.0.113.0/24 or 240.0.0.0/4 or "::1" or "fe80::/10" or "ff00::/8")"
<li><a href="#">query = event.category:(network or network_traffic) and network.transport:tcp and (destination.port:26 or (event.dataset:zeek.smtp and destination.port:26))
<li><a href="#">query = event.category:(network or network_traffic) and network.transport:tcp and (destination.port:3389 or event.dataset:zeek.rdp) and not source.ip:(10.0.0.0/8 or 127.0.0.0/8 or 169.254.0.0/16 or 172.16.0.0/12 or 192.0.0.0/24 or 192.0.0.0/29 or 192.0.0.8/32 or 192.0.0.9/32 or 192.0.0.10/32 or 192.0.0.170/32 or 192.0.0.171/32 or 192.0.2.0/24 or 192.31.196.0/24 or 192.52.193.0/24 or 192.168.0.0/16 or 192.88.99.0/24 or 224.0.0.0/4 or 100.64.0.0/10 or 192.175.48.0/24 or 198.18.0.0/15 or 198.51.100.0/24 or 203.0.113.0/24 or 240.0.0.0/4 or "::1" or "fe80::/10" or "ff00::/8") and destination.ip:(10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16)"
<li><a href="#">query = event.category:(network or network_traffic) and network.transport:tcp and destination.port >= 5800 and destination.port <= 5810 and not source.ip:(10.0.0.0/8 or 127.0.0.0/8 or 169.254.0.0/16 or 172.16.0.0/12 or 192.0.0.0/24 or 192.0.0.0/29 or 192.0.0.8/32 or 192.0.0.9/32 or 192.0.0.10/32 or 192.0.0.170/32 or 192.0.0.171/32 or 192.0.2.0/24 or 192.31.196.0/24 or 192.52.193.0/24 or 192.168.0.0/16 or 192.88.99.0/24 or 224.0.0.0/4 or 100.64.0.0/10 or 192.175.48.0/24 or 198.18.0.0/15 or 198.51.100.0/24 or 203.0.113.0/24 or 240.0.0.0/4 or "::1" or "fe80::/10" or "ff00::/8") and destination.ip:(10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16)"
<li><a href="#">query = event.category:(network or network_traffic) and network.transport:tcp and destination.port >= 5800 and destination.port <= 5810 and source.ip:(10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16) and not destination.ip:(10.0.0.0/8 or 127.0.0.0/8 or 169.254.0.0/16 or 172.16.0.0/12 or 192.0.0.0/24 or 192.0.0.0/29 or 192.0.0.8/32 or 192.0.0.9/32 or 192.0.0.10/32 or 192.0.0.170/32 or 192.0.0.171/32 or 192.0.2.0/24 or 192.31.196.0/24 or 192.52.193.0/24 or 192.168.0.0/16 or 192.88.99.0/24 or 224.0.0.0/4 or 100.64.0.0/10 or 192.175.48.0/24 or 198.18.0.0/15 or 198.51.100.0/24 or 203.0.113.0/24 or 240.0.0.0/4 or "::1" or "fe80::/10" or "ff00::/8")"
<li><a href="#">query = event.category:(network or network_traffic) and network.transport:udp and destination.port:4500
<li><a href="#">query = event.category:(network or network_traffic) and type:(tls or http) and network.transport:tcp and destination.domain:/[a-z]{3}.stage.[0-9]{8}\..*/
<li><a href="#">query = event.category:(network or network_traffic) and type:(tls or http) and network.transport:tcp and destination.domain:/[a-za-z]{4,5}\.(pw|us|club|info|site|top)/ and not destination.domain:zoom.us
<li><a href="#">query = event.category:file and event.action:modification and file.path:/users/*/library/calendars/*.calendar/events/*.ics and process.executable: (* and not (/system/library/* or /system/applications/calendar.app/contents/macos/* or /system/applications/mail.app/contents/macos/mail or /usr/libexec/xpcproxy or /sbin/launchd or /applications/*))
<li><a href="#">query = event.category:file and event.type:(change or creation) and file.name:("authorized_keys" or "authorized_keys2") and not process.executable: (/library/developer/commandlinetools/usr/bin/git or /usr/local/cellar/maven/*/libexec/bin/mvn or /library/java/javavirtualmachines/jdk*.jdk/contents/home/bin/java or /usr/bin/vim or /usr/local/cellar/coreutils/*/bin/gcat or /usr/bin/bsdtar or /usr/bin/nautilus or /usr/bin/scp or /usr/bin/touch or /var/lib/docker/* or /usr/bin/google_guest_agent)"
<li><a href="#">query = event.category:file and event.type:change and (file.name:pam_*.so or file.path:(/etc/pam.d/* or /private/etc/pam.d/*)) and process.executable: (* and not (/bin/yum or "/usr/sbin/pam-auth-update" or /usr/libexec/packagekitd or /usr/bin/dpkg or /usr/bin/vim or /usr/libexec/xpcproxy or /usr/bin/bsdtar or /usr/local/bin/brew or /usr/bin/rsync or /usr/bin/yum or /var/lib/docker/*/bin/yum or /var/lib/docker/*/bin/dpkg or ./merged/var/lib/docker/*/bin/dpkg or "/system/library/privateframeworks/packagekit.framework/versions/a/xpcservices/package_script_service.xpc/contents/macos/package_script_service")) and not file.path: (/tmp/snap.rootfs_*/pam_*.so or /tmp/newroot/lib/*/pam_*.so or /private/var/folders/*/t/com.apple.fileprovider.archiveservice/temporaryitems/*/lib/security/pam_*.so or /tmp/newroot/usr/lib64/security/pam_*.so)"
<li><a href="#">query = event.category:file and event.type:change and file.path:(/etc/sudoers* or /private/etc/sudoers*)
<li><a href="#">query = event.category:file and event.type:change and process.name:(* and not (sudo or vim or zsh or env or nano or bash or terminal or xpcproxy or login or cat or cp or launchctl or java)) and not process.executable:(/applications/* or /private/var/folders/* or /usr/local/*) and file.path:(/private/etc/rc.local or /etc/rc.local or /home/*/.profile or /home/*/.profile1 or /home/*/.bash_profile or /home/*/.bash_profile1 or /home/*/.bashrc or /users/*/.bash_profile or /users/*/.zshenv)
<li><a href="#">query = event.category:file and event.type:change and process.name:* and (file.path:(/usr/sbin/sshd or /usr/bin/ssh or /usr/bin/sftp or /usr/bin/scp) or file.name:libkeyutils.so) and not process.name:("dpkg" or "yum" or "dnf" or "dnf-automatic")"
<li><a href="#">query = event.category:file and not event.type:deletion and file.name:~$*.zip and host.os.type:macos
<li><a href="#">query = event.category:file and not event.type:deletion and file.path:(/library/security/securityagentplugins/* and not /library/security/securityagentplugins/teamviewerauthplugin.bundle/*) and not process.name:shove and process.code_signature.trusted:true
<li><a href="#">query = event.category:file and not event.type:deletion and file.path:/etc/ld.so.preload
<li><a href="#">query = event.category:file and not event.type:deletion and file.path:/library/directoryservices/plugins/*.dsplug
<li><a href="#">query = event.category:file and not event.type:deletion and file.path:/private/var/at/tabs/root and not process.executable:/usr/bin/crontab
<li><a href="#">query = event.category:network_traffic and network.protocol:http and status:ok and destination.port:9200 and network.direction:inbound and not http.response.headers.content-type:"image/x-icon" and not _exists_:http.request.headers.authorization"
<li><a href="#">query = event.category:process and (powershell.file.script_block_text : (getasynckeystate or ntusergetasynckeystate or getkeyboardstate or "get-keystrokes") or powershell.file.script_block_text : ((setwindowshooka or setwindowshookw or setwindowshookex or setwindowshookexa or ntusersetwindowshookex) and (getforegroundwindow or getwindowtexta or getwindowtextw or "wm_keyboard_ll"))) and not user.id : "s-1-5-18"
<li><a href="#">query = event.category:process and event.code:10 and winlog.event_data.targetimage:("c:\\windows\\system32\\lsass.exe" or "c:\\windows\\system32\\lsass.exe" or "c:\\windows\\system32\\lsass.exe")"
<li><a href="#">query = event.category:process and event.type:(start or process_started) and ((process.name:service and process.args:stop) or (process.name:chkconfig and process.args:off) or (process.name:systemctl and process.args:(disable or stop or kill))) and process.args:(syslog or rsyslog or "syslog-ng")"
<li><a href="#">query = event.category:process and event.type:(start or process_started) and process.args:("/private/var/db/systemkey" or "/var/db/systemkey")"
<li><a href="#">query = event.category:process and event.type:(start or process_started) and process.args:("/sys/class/dmi/id/bios_version" or "/sys/class/dmi/id/product_name" or "/sys/class/dmi/id/chassis_vendor" or "/proc/scsi/scsi" or "/proc/ide/hd0/model") and not user.name:root"
<li><a href="#">query = event.category:process and event.type:(start or process_started) and process.args:("-e" and const*require*child_process*)"
<li><a href="#">query = event.category:process and event.type:(start or process_started) and process.args:((rmmod and sudo) or (modprobe and sudo and ("--remove" or "-r")))"
<li><a href="#">query = event.category:process and event.type:(start or process_started) and process.args:(kmod and list and sudo or sudo and (depmod or lsmod or modinfo))
<li><a href="#">query = event.category:process and event.type:(start or process_started) and process.args:(spctl and "--master-disable")"
<li><a href="#">query = event.category:process and event.type:(start or process_started) and process.name:"security_authtrampoline" and process.parent.name:(osascript or com.apple.automator.runner or sh or bash or dash or zsh or python* or python or perl* or php* or ruby or pwsh)"
<li><a href="#">query = event.category:process and event.type:(start or process_started) and process.name:(base16 or base32 or base32plain or base32hex)
<li><a href="#">query = event.category:process and event.type:(start or process_started) and process.name:(bash or dash or ash or zsh or "python*" or "perl*" or "php*") and process.parent.name:("apache" or "nginx" or "www" or "apache2" or "httpd" or "www-data")"
<li><a href="#">query = event.category:process and event.type:(start or process_started) and process.name:(chmod or chown or chattr or chgrp) and process.working_directory:(/tmp or /var/tmp or /dev/shm) and not user.name:root
<li><a href="#">query = event.category:process and event.type:(start or process_started) and process.name:(dscl or dseditgroup) and process.args:(("/groups/admin" or admin) and ("-a" or "-append"))"
<li><a href="#">query = event.category:process and event.type:(start or process_started) and process.name:(hping or hping2 or hping3)
<li><a href="#">query = event.category:process and event.type:(start or process_started) and process.name:(iodine or iodined)
<li><a href="#">query = event.category:process and event.type:(start or process_started) and process.name:.* and process.parent.executable:/sbin/launchd
<li><a href="#">query = event.category:process and event.type:(start or process_started) and process.name:chmod and process.args:("+s" or "u+s" or /4[0-9]{3}/ or g+s or /2[0-9]{3}/) and not process.args: (/.*\/applications\/virtualbox.app\/.+/ or /\/usr\/local\/lib\/python.+/ or /\/var\/folders\/.+\/fp.*nstallhelper/ or /\/library\/filesystems\/.+/ or /\/usr\/lib\/virtualbox\/.+/ or /\/library\/application.*/ or "/run/postgresql" or "/var/crash" or "/var/run/postgresql" or /\/usr\/bin\/.+/ or /\/usr\/local\/share\/.+/ or /\/applications\/.+/ or /\/usr\/libexec\/.+/ or "/var/metrics" or /\/var\/lib\/dpkg\/.+/ or /\/run\/log\/journal\/.*/ or \/users\/*\/.minikube\/bin\/docker-machine-driver-hyperkit) and not process.parent.executable: (/\/var\/lib\/docker\/.+/ or "/system/library/privateframeworks/packagekit.framework/versions/a/xpcservices/package_script_service.xpc/contents/macos/package_script_service" or "/var/lib/dpkg/info/whoopsie.postinst")"
<li><a href="#">query = event.category:process and event.type:(start or process_started) and process.name:defaults and process.args:(write and "-bool" and (com.apple.softwareupdate or /library/preferences/com.apple.softwareupdate.plist) and not (true or true))"
<li><a href="#">query = event.category:process and event.type:(start or process_started) and process.name:dscl and process.args:(ishidden and create and (true or 1 or yes))
<li><a href="#">query = event.category:process and event.type:(start or process_started) and process.name:dsenableroot and not process.args:"-d"
<li><a href="#">query = event.category:process and event.type:(start or process_started) and process.name:espl and process.args:eyjkzwj1zyi6*
<li><a href="#">query = event.category:process and event.type:(start or process_started) and process.name:kcc and process.args:copy_cred_cache
<li><a href="#">query = event.category:process and event.type:(start or process_started) and process.name:kextunload and process.args:("/system/library/extensions/endpointsecurity.kext" or "endpointsecurity.kext")"
<li><a href="#">query = event.category:process and event.type:(start or process_started) and process.name:nping
<li><a href="#">query = event.category:process and event.type:(start or process_started) and process.name:perl and process.args:("exec \"/bin/sh\";" or "exec \"/bin/dash\";" or "exec \"/bin/bash\";")"
<li><a href="#">query = event.category:process and event.type:(start or process_started) and process.name:python* and process.args:("import pty; pty.spawn(\"/bin/sh\")" or "import pty; pty.spawn(\"/bin/dash\")" or "import pty; pty.spawn(\"/bin/bash\")")"
<li><a href="#">query = event.category:process and event.type:(start or process_started) and process.name:security and process.args:"add-trusted-cert" and not process.parent.executable:("/library/bitdefender/avp/product/bin/bdcoreissues" or "/applications/bitdefender/securitynetworkinstallerapp.app/contents/macos/securitynetworkinstallerapp")"
<li><a href="#">query = event.category:process and event.type:(start or process_started) and process.name:setenforce and process.args:0
<li><a href="#">query = event.category:process and event.type:(start or process_started) and process.name:shred and process.args:("-u" or "--remove" or "-z" or "--zero")"
<li><a href="#">query = event.category:process and event.type:(start or process_started) and process.name:systemsetup and process.args:("-setremotelogin" and on) and not process.parent.executable : /usr/local/jamf/bin/jamf"
<li><a href="#">query = event.category:process and event.type:(start or process_started) and process.parent.name:com.adobe.armdc.smjobblesshelper and user.name:root and not process.executable: (/library/privilegedhelpertools/com.adobe.armdc.smjobblesshelper or /usr/bin/codesign or /private/var/folders/zz/*/t/download/armdchammer or /usr/sbin/pkgutil or /usr/bin/shasum or /usr/bin/perl* or /usr/sbin/spctl or /usr/sbin/installer or /usr/bin/csrutil)
<li><a href="#">query = event.category:process and event.type:start and process.args:("-action" and ("-kerberoast" or askhash or asktgs or asktgt or s4u or ("-ticket" and ptt) or (dump and (tickets or keytab))))"
<li><a href="#">query = event.category:process and event.type:start and process.args:(echo and *nopasswd*all*)
<li><a href="#">query = event.category:process and event.type:start and process.name:"pkill" and process.args:"-f"
<li><a href="#">query = event.category:process and event.type:start and process.name:"sshd-keygen-wrapper" and process.parent.name:launchd"
<li><a href="#">query = event.category:process and event.type:start and process.name:(defaults or mkpassdb) and process.args:(shadowhashdata or "-dump")"
<li><a href="#">query = event.category:process and event.type:start and process.name:(net.exe or sc.exe or taskkill.exe) and process.args:(stop or pause or delete or "/pid" or "/im" or "/t" or "/f" or "/t" or "/f" or "/im" or "/pid")"
<li><a href="#">query = event.category:process and event.type:start and process.name:(sudo or sudoedit) and process.args:(*\\ and ("-i" or "-s"))"
<li><a href="#">query = event.category:process and event.type:start and process.name:(zip or tar or gzip or hdiutil or 7z) and process.args: (/root/.ssh/id_rsa or /root/.ssh/id_rsa.pub or /root/.ssh/id_ed25519 or /root/.ssh/id_ed25519.pub or /root/.ssh/authorized_keys or /root/.ssh/authorized_keys2 or /root/.ssh/known_hosts or /root/.bash_history or /etc/hosts or /home/*/.ssh/id_rsa or /home/*/.ssh/id_rsa.pub or /home/*/.ssh/id_ed25519 or /home/*/.ssh/id_ed25519.pub or /home/*/.ssh/authorized_keys or /home/*/.ssh/authorized_keys2 or /home/*/.ssh/known_hosts or /home/*/.bash_history or /root/.aws/credentials or /root/.aws/config or /home/*/.aws/credentials or /home/*/.aws/config or /root/.docker/config.json or /home/*/.docker/config.json or /etc/group or /etc/passwd or /etc/shadow or /etc/gshadow)
<li><a href="#">query = event.category:process and event.type:start and process.name:defaults and process.args: (com.apple.safari and write and not (universalsearchenabled or suppresssearchsuggestions or webkittabtolinkspreferencekey or showfullurlinsmartsearchfield or com.apple.safari.contentpagegroupidentifier.webkit2tabstolinks))
<li><a href="#">query = event.category:process and event.type:start and process.name:launchctl and process.args:(setenv and not (java*_home or runtime_java_home or dbus_launchd_session_bus_socket or ant_home or lg_webos_tv_sdk_home or webos_cli_tv or eden_env)) and not process.parent.executable:("/applications/nomachine.app/contents/frameworks/bin/nxserver.bin" or "/usr/local/bin/kr" or "/applications/nomachine.app/contents/frameworks/bin/nxserver.bin" or "/applications/intellij idea ce.app/contents/jbr/contents/home/lib/jspawnhelper") and not process.args : "*.vmoptions"
<li><a href="#">query = event.category:process and powershell.file.script_block_text : "new-mailboxexportrequest"
<li><a href="#">query = event.category:process and powershell.file.script_block_text : ("[system.reflection.assembly]::load" or "[reflection.assembly]::load") and not user.id : "s-1-5-18"
<li><a href="#">query = event.category:process and powershell.file.script_block_text : ("get-microphoneaudio" or (waveingetnumdevs and mcisendstringa)) and not user.id : "s-1-5-18"
<li><a href="#">query = event.category:process and powershell.file.script_block_text : (("system.io.compression.deflatestream" or "system.io.compression.gzipstream" or "io.compression.deflatestream" or "io.compression.gzipstream") and frombase64string) and not user.id : "s-1-5-18"
<li><a href="#">query = event.category:process and powershell.file.script_block_text : ((virtualalloc or virtualallocex or virtualprotect or ldrloaddll or loadlibrary or loadlibrarya or loadlibraryex or getprocaddress or openprocess or openprocesstoken or adjusttokenprivileges) and (writeprocessmemory or createremotethread or ntcreatethreadex or createthread or queueuserapc or suspendthread or resumethread or getdelegateforfunctionpointer)) and not user.id : "s-1-5-18"
<li><a href="#">query = event.category:process and powershell.file.script_block_text : (copyfromscreen and ("system.drawing.bitmap" or "drawing.bitmap")) and not user.id : "s-1-5-18"
<li><a href="#">query = event.category:process and powershell.file.script_block_text : (kerberosrequestorsecuritytoken) and not user.id : "s-1-5-18"
<li><a href="#">query = event.category:process and powershell.file.script_block_text : (tvqqaamaaaaeaaaa) and not user.id : "s-1-5-18"
<li><a href="#">query = event.category:process and powershell.file.script_block_text:("invoke-sharefinder" or "invoke-sharefinderthreaded" or ("shi1_netname" and "shi1_remark") or ("netshareenum" and "netapibufferfree")) and not user.id : "s-1-5-18"
<li><a href="#">query = event.category:process and powershell.file.script_block_text:("invoke-tokenmanipulation" or "impersonatenamedpipeclient" or "ntimpersonatethread" or ("startupinfoex" and "updateprocthreadattribute") or ("adjusttokenprivileges" and "sedebugprivilege") or (("duplicatetoken" or "duplicatetokenex") and ("setthreadtoken" or "impersonateloggedonuser" or "createprocesswithtokenw" or "createprocessasuserw" or "createprocessasusera"))) and not user.id : "s-1-5-18"
<li><a href="#">query = event.category:process and powershell.file.script_block_text:("new-inmemorymodule" or "add-win32type" or psenum or definedynamicassembly or definedynamicmodule or "reflection.typeattributes" or "reflection.emit.opcodes" or "reflection.emit.customattributebuilder" or "runtime.interopservices.dllimportattribute") and not user.id : "s-1-5-18"
<li><a href="#">query = event.category:process and powershell.file.script_block_text:((dumpcreds and dumpcerts) or "sekurlsa::logonpasswords" or ("crypto::certificates" and "cert_system_store_local_machine"))"
<li><a href="#">query = event.category:process and powershell.file.script_block_text:(minidumpwritedump or minidumpwithfullmemory or pmudetirwpmudinim) and not user.id : "s-1-5-18"
<li><a href="#">query = event.code: "5136" and winlog.event_data.attributeldapdisplayname:"gpcmachineextensionnames" and winlog.event_data.attributevalue:(*827d319e-6eac-11d2-a4ea-00c04f79f83a* and *803e14a0-b4fb-11d0-a0d0-00a0c90f574b*)"
<li><a href="#">query = event.code:4738 and message:"'don't require preauth' - enabled"
<li><a href="#">query = event.dataset : "kubernetes.audit_logs" and kubernetes.audit.annotations.authorization_k8s_io/decision:"allow" and (kubernetes.audit.user.username:("system:anonymous" or "system:unauthenticated") or not kubernetes.audit.user.username:*) and not kubernetes.audit.objectref.resource:("healthz" or "livez" or "readyz")"
<li><a href="#">query = event.dataset : "kubernetes.audit_logs" and kubernetes.audit.annotations.authorization_k8s_io/decision:"allow" and kubernetes.audit.objectref.resource:"pods" and kubernetes.audit.verb:("create" or "update" or "patch") and kubernetes.audit.requestobject.spec.hostipc:true and not kubernetes.audit.requestobject.spec.containers.image: ("docker.elastic.co/beats/elastic-agent:8.4.0")"
<li><a href="#">query = event.dataset : "kubernetes.audit_logs" and kubernetes.audit.annotations.authorization_k8s_io/decision:"allow" and kubernetes.audit.objectref.resource:"pods" and kubernetes.audit.verb:("create" or "update" or "patch") and kubernetes.audit.requestobject.spec.hostnetwork:true and not kubernetes.audit.requestobject.spec.containers.image: ("docker.elastic.co/beats/elastic-agent:8.4.0")"
<li><a href="#">query = event.dataset : "kubernetes.audit_logs" and kubernetes.audit.annotations.authorization_k8s_io/decision:"allow" and kubernetes.audit.objectref.resource:"pods" and kubernetes.audit.verb:("create" or "update" or "patch") and kubernetes.audit.requestobject.spec.hostpid:true and not kubernetes.audit.requestobject.spec.containers.image: ("docker.elastic.co/beats/elastic-agent:8.4.0")"
<li><a href="#">query = event.dataset : "kubernetes.audit_logs" and kubernetes.audit.annotations.authorization_k8s_io/decision:"allow" and kubernetes.audit.objectref.resource:"pods" and kubernetes.audit.verb:("create" or "update" or "patch") and kubernetes.audit.requestobject.spec.volumes.hostpath.path: ("/" or "/proc" or "/root" or "/var" or "/var/run" or "/var/run/docker.sock" or "/var/run/crio/crio.sock" or "/var/run/cri-dockerd.sock" or "/var/lib/kubelet" or "/var/lib/kubelet/pki" or "/var/lib/docker/overlay2" or "/etc" or "/etc/kubernetes" or "/etc/kubernetes/manifests" or "/etc/kubernetes/pki" or "/home/admin") and not kubernetes.audit.requestobject.spec.containers.image: ("docker.elastic.co/beats/elastic-agent:8.4.0")"
<li><a href="#">query = event.dataset : "kubernetes.audit_logs" and kubernetes.audit.annotations.authorization_k8s_io/decision:"allow" and kubernetes.audit.objectref.resource:"services" and kubernetes.audit.verb:("create" or "update" or "patch") and kubernetes.audit.requestobject.spec.type:"nodeport"
<li><a href="#">query = event.dataset : "kubernetes.audit_logs" and kubernetes.audit.annotations.authorization_k8s_io/decision:"allow" and kubernetes.audit.objectref.resource:pods and kubernetes.audit.verb:create and kubernetes.audit.requestobject.spec.containers.securitycontext.privileged:true and not kubernetes.audit.requestobject.spec.containers.image: ("docker.elastic.co/beats/elastic-agent:8.4.0")"
<li><a href="#">query = event.dataset : "kubernetes.audit_logs" and kubernetes.audit.annotations.authorization_k8s_io/decision:"allow" and kubernetes.audit.verb : "create" and kubernetes.audit.objectref.resource : "pods" and kubernetes.audit.objectref.namespace : "kube-system" and kubernetes.audit.requestobject.spec.serviceaccountname:*controller"
<li><a href="#">query = event.dataset : "kubernetes.audit_logs" and kubernetes.audit.annotations.authorization_k8s_io/decision:"allow" and kubernetes.audit.verb:"create" and kubernetes.audit.objectref.resource:"pods" and kubernetes.audit.objectref.subresource:"exec"
<li><a href="#">query = event.dataset : "kubernetes.audit_logs" and kubernetes.audit.annotations.authorization_k8s_io/decision:"allow" and kubernetes.audit.verb:"create" and kubernetes.audit.objectref.resource:("selfsubjectaccessreviews" or "selfsubjectrulesreviews") and (kubernetes.audit.user.username:(system\:serviceaccount\:* or system\:node\:*) or kubernetes.audit.impersonateduser.username:(system\:serviceaccount\:* or system\:node\:*))"
<li><a href="#">query = event.dataset: "kubernetes.audit_logs" and kubernetes.audit.user.username: system\:serviceaccount\:* and kubernetes.audit.annotations.authorization_k8s_io/decision: "forbid"
<li><a href="#">query = event.dataset: kubernetes.audit_logs and kubernetes.audit.annotations.authorization_k8s_io/decision:"allow" and kubernetes.audit.verb: create and kubernetes.audit.objectref.resource: pods and kubernetes.audit.requestobject.spec.containers.securitycontext.capabilities.add: ("bpf" or "dac_read_search" or "net_admin" or "sys_admin" or "sys_boot" or "sys_module" or "sys_ptrace" or "sys_rawio" or "syslog") and not kubernetes.audit.requestobject.spec.containers.image : ("docker.elastic.co/beats/elastic-agent:8.4.0" or "rancher/klipper-lb:v0.3.5" or)"
<li><a href="#">query = event.dataset:"google_workspace.admin" and event.action:"2sv_disable"
<li><a href="#">query = event.dataset:"google_workspace.admin" and event.action:"change_application_setting" and event.category:(iam or configuration) and google_workspace.admin.new_value:"disabled" and google_workspace.admin.setting.name:bitlocker*"
<li><a href="#">query = event.dataset:"google_workspace.admin" and event.action:"change_application_setting" and event.category:(iam or configuration) and google_workspace.event.type:"application_settings" and google_workspace.admin.application.name:"google workspace marketplace" and google_workspace.admin.setting.name:"apps access setting allowlist access" and google_workspace.admin.new_value:"allow_all"
<li><a href="#">query = event.dataset:"google_workspace.admin" and event.action:"change_group_setting" and event.category:"iam" and ((google_workspace.admin.setting.name:"allow_external_members" and google_workspace.admin.new_value:"true") or (google_workspace.admin.setting.name:"who_can_join" and not (google_workspace.admin.new_value:"invited_can_join" or google_workspace.admin.new_value:"can_request_to_join")))"
<li><a href="#">query = event.dataset:"google_workspace.admin" and event.action:"create_data_transfer_request" and event.category:"iam" and google_workspace.admin.application.name:drive*"
<li><a href="#">query = event.dataset:"google_workspace.admin" and event.action:("create_gmail_setting" or "change_gmail_setting") and google_workspace.event.type:"email_settings" and google_workspace.admin.setting.name:("email_route" or "message_security_rule")"
<li><a href="#">query = event.dataset:"google_workspace.admin" and event.category:"iam" and event.action:"assign_role" and google_workspace.event.type:"delegated_admin_settings" and google_workspace.admin.role.name : *_admin_role"
<li><a href="#">query = event.dataset:"google_workspace.admin" and event.category:"iam" and event.type:"change" and event.action:"change_application_setting" and google_workspace.admin.application.name:"google workspace marketplace" and google_workspace.admin.old_value: *allowed*false* and google_workspace.admin.new_value: *allowed*true*"
<li><a href="#">query = event.dataset:"google_workspace.admin" and event.type:change and event.category:iam and google_workspace.event.type:"user_settings" and event.action:"move_user_to_org_unit"
<li><a href="#">query = event.dataset:(azure.activitylogs or azure.auditlogs or o365.audit) and (azure.activitylogs.operation_name:"consent to application" or azure.auditlogs.operation_name:"consent to application" or o365.audit.operation:"consent to application.") and event.outcome:(success or success)"
<li><a href="#">query = event.dataset:(azure.activitylogs or azure.auditlogs) and event.action:"update conditional access policy" and event.outcome:(success or success)"
<li><a href="#">query = event.dataset:aws.cloudtrail and event.action:deletewebacl and event.outcome:success
<li><a href="#">query = event.dataset:aws.cloudtrail and event.provider:(iam.amazonaws.com or sts.amazonaws.com) and event.action:(assumerolewithsaml or updatesamlprovider) and event.outcome:success
<li><a href="#">query = event.dataset:aws.cloudtrail and event.provider:(waf.amazonaws.com or waf-regional.amazonaws.com or wafv2.amazonaws.com) and event.action:(deleterule or deleterulegroup) and event.outcome:success
<li><a href="#">query = event.dataset:aws.cloudtrail and event.provider:cloudtrail.amazonaws.com and event.action:(createroute or createroutetable) and event.outcome:success
<li><a href="#">query = event.dataset:aws.cloudtrail and event.provider:cloudtrail.amazonaws.com and event.action:(replaceroute or replaceroutetableassociation or deleteroutetable or deleteroute or disassociateroutetable) and event.outcome:success
<li><a href="#">query = event.dataset:aws.cloudtrail and event.provider:cloudtrail.amazonaws.com and event.action:createtrail and event.outcome:success
<li><a href="#">query = event.dataset:aws.cloudtrail and event.provider:cloudtrail.amazonaws.com and event.action:deletetrail and event.outcome:success
<li><a href="#">query = event.dataset:aws.cloudtrail and event.provider:cloudtrail.amazonaws.com and event.action:stoplogging and event.outcome:success
<li><a href="#">query = event.dataset:aws.cloudtrail and event.provider:cloudtrail.amazonaws.com and event.action:updatetrail and event.outcome:success
<li><a href="#">query = event.dataset:aws.cloudtrail and event.provider:config.amazonaws.com and event.action:(deleteconfigrule or deleteorganizationconfigrule or deleteconfigurationaggregator or deleteconfigurationrecorder or deleteconformancepack or deleteorganizationconformancepack or deletedeliverychannel or deleteremediationconfiguration or deleteretentionconfiguration)
<li><a href="#">query = event.dataset:aws.cloudtrail and event.provider:config.amazonaws.com and event.action:stopconfigurationrecorder and event.outcome:success
<li><a href="#">query = event.dataset:aws.cloudtrail and event.provider:ec2.amazonaws.com and event.action:(authorizesecuritygroupegress or createsecuritygroup or modifyinstanceattribute or modifysecuritygrouprules or revokesecuritygroupegress or revokesecuritygroupingress) and event.outcome:success
<li><a href="#">query = event.dataset:aws.cloudtrail and event.provider:ec2.amazonaws.com and event.action:(createnetworkacl or createnetworkaclentry) and event.outcome:success
<li><a href="#">query = event.dataset:aws.cloudtrail and event.provider:ec2.amazonaws.com and event.action:(createtrafficmirrorfilter or createtrafficmirrorfilterrule or createtrafficmirrorsession or createtrafficmirrortarget) and event.outcome:success
<li><a href="#">query = event.dataset:aws.cloudtrail and event.provider:ec2.amazonaws.com and event.action:(deletenetworkacl or deletenetworkaclentry) and event.outcome:success
<li><a href="#">query = event.dataset:aws.cloudtrail and event.provider:ec2.amazonaws.com and event.action:createinstanceexporttask and event.outcome:failure
<li><a href="#">query = event.dataset:aws.cloudtrail and event.provider:ec2.amazonaws.com and event.action:deleteflowlogs and event.outcome:success
<li><a href="#">query = event.dataset:aws.cloudtrail and event.provider:ec2.amazonaws.com and event.action:disableebsencryptionbydefault and event.outcome:success
<li><a href="#">query = event.dataset:aws.cloudtrail and event.provider:ec2.amazonaws.com and event.action:modifysnapshotattribute
<li><a href="#">query = event.dataset:aws.cloudtrail and event.provider:elasticache.amazonaws.com and event.action:"create cache security group" and event.outcome:success"
<li><a href="#">query = event.dataset:aws.cloudtrail and event.provider:elasticache.amazonaws.com and event.action:("delete cache security group" or "authorize cache security group ingress" or "revoke cache security group ingress" or "authorizecachesecuritygroupegress" or "revokecachesecuritygroupegress") and event.outcome:success"
<li><a href="#">query = event.dataset:aws.cloudtrail and event.provider:elasticfilesystem.amazonaws.com and event.action:(deletemounttarget or deletefilesystem) and event.outcome:success
<li><a href="#">query = event.dataset:aws.cloudtrail and event.provider:eventbridge.amazonaws.com and event.action:(deleterule or disablerule) and event.outcome:success
<li><a href="#">query = event.dataset:aws.cloudtrail and event.provider:guardduty.amazonaws.com and event.action:deletedetector and event.outcome:success
<li><a href="#">query = event.dataset:aws.cloudtrail and event.provider:iam.amazonaws.com and event.action:(deactivatemfadevice or deletevirtualmfadevice) and event.outcome:success
<li><a href="#">query = event.dataset:aws.cloudtrail and event.provider:iam.amazonaws.com and event.action:addusertogroup and event.outcome:success
<li><a href="#">query = event.dataset:aws.cloudtrail and event.provider:iam.amazonaws.com and event.action:creategroup and event.outcome:success
<li><a href="#">query = event.dataset:aws.cloudtrail and event.provider:iam.amazonaws.com and event.action:deletegroup and event.outcome:success
<li><a href="#">query = event.dataset:aws.cloudtrail and event.provider:iam.amazonaws.com and event.action:updateassumerolepolicy and aws.cloudtrail.error_code:malformedpolicydocumentexception and event.outcome:failure
<li><a href="#">query = event.dataset:aws.cloudtrail and event.provider:iam.amazonaws.com and event.action:updateassumerolepolicy and event.outcome:success
<li><a href="#">query = event.dataset:aws.cloudtrail and event.provider:kms.amazonaws.com and event.action:("disablekey" or "schedulekeydeletion") and event.outcome:success"
<li><a href="#">query = event.dataset:aws.cloudtrail and event.provider:logs.amazonaws.com and event.action:deleteloggroup and event.outcome:success
<li><a href="#">query = event.dataset:aws.cloudtrail and event.provider:logs.amazonaws.com and event.action:deletelogstream and event.outcome:success
<li><a href="#">query = event.dataset:aws.cloudtrail and event.provider:monitoring.amazonaws.com and event.action:deletealarms and event.outcome:success
<li><a href="#">query = event.dataset:aws.cloudtrail and event.provider:rds.amazonaws.com and event.action:(createdbcluster or createglobalcluster) and event.outcome:success
<li><a href="#">query = event.dataset:aws.cloudtrail and event.provider:rds.amazonaws.com and event.action:(deletedbcluster or deleteglobalcluster or deletedbinstance) and event.outcome:success
<li><a href="#">query = event.dataset:aws.cloudtrail and event.provider:rds.amazonaws.com and event.action:(stopdbcluster or stopdbinstance) and event.outcome:success
<li><a href="#">query = event.dataset:aws.cloudtrail and event.provider:rds.amazonaws.com and event.action:createdbinstance and event.outcome:success
<li><a href="#">query = event.dataset:aws.cloudtrail and event.provider:rds.amazonaws.com and event.action:createdbsecuritygroup and event.outcome:success
<li><a href="#">query = event.dataset:aws.cloudtrail and event.provider:rds.amazonaws.com and event.action:deletedbsecuritygroup and event.outcome:success
<li><a href="#">query = event.dataset:aws.cloudtrail and event.provider:rds.amazonaws.com and event.action:restoredbinstancefromdbsnapshot and event.outcome:success
<li><a href="#">query = event.dataset:aws.cloudtrail and event.provider:rds.amazonaws.com and event.action:startexporttask and event.outcome:success
<li><a href="#">query = event.dataset:aws.cloudtrail and event.provider:redshift.amazonaws.com and event.action:createcluster and event.outcome:success
<li><a href="#">query = event.dataset:aws.cloudtrail and event.provider:route53.amazonaws.com and event.action:associatevpcwithhostedzone and event.outcome:success
<li><a href="#">query = event.dataset:aws.cloudtrail and event.provider:route53.amazonaws.com and event.action:disabledomaintransferlock and event.outcome:success
<li><a href="#">query = event.dataset:aws.cloudtrail and event.provider:route53.amazonaws.com and event.action:transferdomaintoanotherawsaccount and event.outcome:success
<li><a href="#">query = event.dataset:aws.cloudtrail and event.provider:s3.amazonaws.com and event.action:(deletebucketpolicy or deletebucketreplication or deletebucketcors or deletebucketencryption or deletebucketlifecycle) and event.outcome:success
<li><a href="#">query = event.dataset:aws.cloudtrail and event.provider:secretsmanager.amazonaws.com and event.action:getsecretvalue
<li><a href="#">query = event.dataset:aws.cloudtrail and event.provider:signin.amazonaws.com and event.action:consolelogin and aws.cloudtrail.user_identity.type:root and aws.cloudtrail.console_login.additional_eventdata.mfa_used:false and event.outcome:success
<li><a href="#">query = event.dataset:aws.cloudtrail and event.provider:signin.amazonaws.com and event.action:consolelogin and aws.cloudtrail.user_identity.type:root and event.outcome:failure
<li><a href="#">query = event.dataset:aws.cloudtrail and event.provider:signin.amazonaws.com and event.action:consolelogin and aws.cloudtrail.user_identity.type:root and event.outcome:success
<li><a href="#">query = event.dataset:aws.cloudtrail and event.provider:signin.amazonaws.com and event.action:passwordrecoveryrequested and event.outcome:success
<li><a href="#">query = event.dataset:aws.cloudtrail and event.provider:ssm.amazonaws.com and event.action:sendcommand and event.outcome:success
<li><a href="#">query = event.dataset:aws.cloudtrail and event.provider:sts.amazonaws.com and event.action:assumedrole and aws.cloudtrail.user_identity.session_context.session_issuer.type:role and event.outcome:success
<li><a href="#">query = event.dataset:aws.cloudtrail and event.provider:sts.amazonaws.com and event.action:getsessiontoken and aws.cloudtrail.user_identity.type:iamuser and event.outcome:success
<li><a href="#">query = event.dataset:azure.activitylogs and azure.activitylogs.operation_name: ("microsoft.kubernetes/connectedclusters/rbac.authorization.k8s.io/rolebindings/write" or "microsoft.kubernetes/connectedclusters/rbac.authorization.k8s.io/clusterrolebindings/write") and event.outcome:(success or success)"
<li><a href="#">query = event.dataset:azure.activitylogs and azure.activitylogs.operation_name: ("microsoft.network/*/startpacketcapture/action" or "microsoft.network/*/vpnconnections/startpacketcapture/action" or "microsoft.network/*/packetcaptures/write") and event.outcome:(success or success)"
<li><a href="#">query = event.dataset:azure.activitylogs and azure.activitylogs.operation_name:"microsoft.automation/automationaccounts/runbooks/delete" and event.outcome:(success or success)"
<li><a href="#">query = event.dataset:azure.activitylogs and azure.activitylogs.operation_name:"microsoft.automation/automationaccounts/write" and event.outcome:(success or success)"
<li><a href="#">query = event.dataset:azure.activitylogs and azure.activitylogs.operation_name:"microsoft.compute/virtualmachines/runcommand/action" and event.outcome:(success or success)"
<li><a href="#">query = event.dataset:azure.activitylogs and azure.activitylogs.operation_name:"microsoft.eventhub/namespaces/authorizationrules/write" and event.outcome:(success or success)"
<li><a href="#">query = event.dataset:azure.activitylogs and azure.activitylogs.operation_name:"microsoft.eventhub/namespaces/eventhubs/delete" and event.outcome:(success or success)"
<li><a href="#">query = event.dataset:azure.activitylogs and azure.activitylogs.operation_name:"microsoft.insights/diagnosticsettings/delete" and event.outcome:(success or success)"
<li><a href="#">query = event.dataset:azure.activitylogs and azure.activitylogs.operation_name:"microsoft.keyvault/vaults/write" and event.outcome:(success or success)"
<li><a href="#">query = event.dataset:azure.activitylogs and azure.activitylogs.operation_name:"microsoft.kubernetes/connectedclusters/events.k8s.io/events/delete" and event.outcome:(success or success)"
<li><a href="#">query = event.dataset:azure.activitylogs and azure.activitylogs.operation_name:"microsoft.kubernetes/connectedclusters/pods/delete" and event.outcome:(success or success)"
<li><a href="#">query = event.dataset:azure.activitylogs and azure.activitylogs.operation_name:"microsoft.network/firewallpolicies/delete" and event.outcome:(success or success)"
<li><a href="#">query = event.dataset:azure.activitylogs and azure.activitylogs.operation_name:"microsoft.network/frontdoorwebapplicationfirewallpolicies/delete" and event.outcome:(success or success)"
<li><a href="#">query = event.dataset:azure.activitylogs and azure.activitylogs.operation_name:"microsoft.network/networkwatchers/delete" and event.outcome:(success or success)"
<li><a href="#">query = event.dataset:azure.activitylogs and azure.activitylogs.operation_name:"microsoft.resources/subscriptions/resourcegroups/delete" and event.outcome:(success or success)"
<li><a href="#">query = event.dataset:azure.activitylogs and azure.activitylogs.operation_name:"microsoft.security/alertssuppressionrules/write" and event.outcome: "success"
<li><a href="#">query = event.dataset:azure.activitylogs and azure.activitylogs.operation_name:"microsoft.storage/storageaccounts/blobservices/containers/write" and event.outcome:(success or success)"
<li><a href="#">query = event.dataset:azure.activitylogs and azure.activitylogs.operation_name:"microsoft.storage/storageaccounts/regeneratekey/action" and event.outcome:(success or success)"
<li><a href="#">query = event.dataset:azure.activitylogs and azure.activitylogs.operation_name:("microsoft.network/networkinterfaces/tapconfigurations/write" or "microsoft.network/networkinterfaces/tapconfigurations/delete" or "microsoft.network/networkinterfaces/write" or "microsoft.network/networkinterfaces/join/action" or "microsoft.network/networkinterfaces/delete" or "microsoft.network/networkvirtualappliances/delete" or "microsoft.network/networkvirtualappliances/write" or "microsoft.network/virtualhubs/delete" or "microsoft.network/virtualhubs/write" or "microsoft.network/virtualrouters/write" or "microsoft.network/virtualrouters/delete") and event.outcome:(success or success)"
<li><a href="#">query = event.dataset:azure.activitylogs and azure.activitylogs.operation_name:("microsoft.storage/storageaccounts/blobservices/containers/blobs/manageownership/action" or "microsoft.storage/storageaccounts/blobservices/containers/blobs/modifypermissions/action") and event.outcome:(success or success)"
<li><a href="#">query = event.dataset:azure.auditlogs and azure.auditlogs.operation_name:"add owner to application" and event.outcome:(success or success)"
<li><a href="#">query = event.dataset:azure.auditlogs and azure.auditlogs.operation_name:"add owner to service principal" and event.outcome:(success or success)"
<li><a href="#">query = event.dataset:azure.auditlogs and azure.auditlogs.operation_name:"add service principal credentials" and event.outcome:(success or success)"
<li><a href="#">query = event.dataset:azure.auditlogs and azure.auditlogs.operation_name:"add service principal" and event.outcome:(success or success)"
<li><a href="#">query = event.dataset:azure.auditlogs and azure.auditlogs.operation_name:"disable strong authentication" and event.outcome:(success or success)"
<li><a href="#">query = event.dataset:azure.auditlogs and azure.auditlogs.operation_name:"invite external user" and azure.auditlogs.properties.target_resources.*.display_name:guest and event.outcome:(success or success)"
<li><a href="#">query = event.dataset:azure.auditlogs and azure.auditlogs.operation_name:"update application - certificates and secrets management" and event.outcome:(success or success)"
<li><a href="#">query = event.dataset:azure.auditlogs and azure.auditlogs.operation_name:"update role setting in pim" and event.outcome:(success or success)"
<li><a href="#">query = event.dataset:azure.auditlogs and azure.auditlogs.properties.category:rolemanagement and azure.auditlogs.operation_name:"add member to role" and azure.auditlogs.properties.target_resources.0.modified_properties.1.new_value:"\"global administrator\"
<li><a href="#">query = event.dataset:azure.auditlogs and azure.auditlogs.properties.category:rolemanagement and azure.auditlogs.operation_name:("add eligible member to role in pim completed (permanent)" or "add member to role in pim completed (timebound)") and azure.auditlogs.properties.target_resources.*.display_name:"global administrator" and event.outcome:(success or success)"
<li><a href="#">query = event.dataset:azure.signinlogs and (azure.signinlogs.properties.risk_level_during_signin:high or azure.signinlogs.properties.risk_level_aggregated:high) and event.outcome:(success or success)
<li><a href="#">query = event.dataset:azure.signinlogs and azure.signinlogs.properties.app_display_name:"azure active directory powershell" and azure.signinlogs.properties.token_issuer_type:azuread and event.outcome:(success or success)"
<li><a href="#">query = event.dataset:azure.signinlogs and azure.signinlogs.properties.risk_state:("confirmedcompromised" or "atrisk") and event.outcome:(success or success)"
<li><a href="#">query = event.dataset:cyberarkpas.audit and event.code:(4 or 22 or 24 or 31 or 38 or 57 or 60 or 130 or 295 or 300 or 302 or 308 or 319 or 344 or 346 or 359 or 361 or 378 or 380 or 411) and not event.type:error
<li><a href="#">query = event.dataset:cyberarkpas.audit and event.type:error
<li><a href="#">query = event.dataset:gcp.audit and event.action:"storage.buckets.delete"
<li><a href="#">query = event.dataset:gcp.audit and event.action:"storage.buckets.update" and event.outcome:success"
<li><a href="#">query = event.dataset:gcp.audit and event.action:"storage.setiampermissions" and event.outcome:success"
<li><a href="#">query = event.dataset:gcp.audit and event.action:(*.compute.firewalls.delete or google.appengine.*.firewall.delete*rule)
<li><a href="#">query = event.dataset:gcp.audit and event.action:(*.compute.firewalls.insert or google.appengine.*.firewall.create*rule)
<li><a href="#">query = event.dataset:gcp.audit and event.action:(*.compute.firewalls.patch or google.appengine.*.firewall.update*rule)
<li><a href="#">query = event.dataset:gcp.audit and event.action:(v*.compute.routes.insert or "beta.compute.routes.insert")"
<li><a href="#">query = event.dataset:gcp.audit and event.action:google.iam.admin.v*.createrole and event.outcome:success
<li><a href="#">query = event.dataset:gcp.audit and event.action:google.iam.admin.v*.createserviceaccount and event.outcome:success
<li><a href="#">query = event.dataset:gcp.audit and event.action:google.iam.admin.v*.createserviceaccountkey and event.outcome:success
<li><a href="#">query = event.dataset:gcp.audit and event.action:google.iam.admin.v*.deleterole and event.outcome:success
<li><a href="#">query = event.dataset:gcp.audit and event.action:google.iam.admin.v*.deleteserviceaccount and event.outcome:success
<li><a href="#">query = event.dataset:gcp.audit and event.action:google.iam.admin.v*.deleteserviceaccountkey and event.outcome:success
<li><a href="#">query = event.dataset:gcp.audit and event.action:google.iam.admin.v*.disableserviceaccount and event.outcome:success
<li><a href="#">query = event.dataset:gcp.audit and event.action:google.logging.v*.configservicev*.deletebucket and event.outcome:success
<li><a href="#">query = event.dataset:gcp.audit and event.action:google.logging.v*.configservicev*.deletesink and event.outcome:success
<li><a href="#">query = event.dataset:gcp.audit and event.action:google.logging.v*.configservicev*.updatesink and event.outcome:success
<li><a href="#">query = event.dataset:gcp.audit and event.action:google.pubsub.v*.publisher.createtopic and event.outcome:success
<li><a href="#">query = event.dataset:gcp.audit and event.action:google.pubsub.v*.publisher.deletetopic and event.outcome:success
<li><a href="#">query = event.dataset:gcp.audit and event.action:google.pubsub.v*.subscriber.createsubscription and event.outcome:success
<li><a href="#">query = event.dataset:gcp.audit and event.action:google.pubsub.v*.subscriber.deletesubscription and event.outcome:success
<li><a href="#">query = event.dataset:gcp.audit and event.action:v*.compute.networks.delete and event.outcome:success
<li><a href="#">query = event.dataset:gcp.audit and event.action:v*.compute.routes.delete and event.outcome:success
<li><a href="#">query = event.dataset:google_workspace.admin and event.provider:admin and event.category:iam and event.action:(add_privilege or update_role)
<li><a href="#">query = event.dataset:google_workspace.admin and event.provider:admin and event.category:iam and event.action:(change_application_setting or create_application_setting) and google_workspace.admin.setting.name:("password management - enforce strong password" or "password management - password reset frequency" or "password management - enable password reuse" or "password management - enforce password policy at next login" or "password management - minimum password length" or "password management - maximum password length")"
<li><a href="#">query = event.dataset:google_workspace.admin and event.provider:admin and event.category:iam and event.action:(enforce_strong_authentication or allow_strong_authentication) and google_workspace.admin.new_value:false
<li><a href="#">query = event.dataset:google_workspace.admin and event.provider:admin and event.category:iam and event.action:add_application
<li><a href="#">query = event.dataset:google_workspace.admin and event.provider:admin and event.category:iam and event.action:add_trusted_domains
<li><a href="#">query = event.dataset:google_workspace.admin and event.provider:admin and event.category:iam and event.action:authorize_api_client_access
<li><a href="#">query = event.dataset:google_workspace.admin and event.provider:admin and event.category:iam and event.action:create_role
<li><a href="#">query = event.dataset:google_workspace.admin and event.provider:admin and event.category:iam and event.action:delete_role
<li><a href="#">query = event.dataset:google_workspace.admin and event.provider:admin and event.category:iam and event.action:enforce_strong_authentication and google_workspace.admin.new_value:false
<li><a href="#">query = event.dataset:o365.audit and event.code:"azureactivedirectory" and event.action:"add member to role." and o365.audit.modifiedproperties.role_displayname.newvalue:"global administrator"
<li><a href="#">query = event.dataset:o365.audit and event.provider:(azureactivedirectory or exchange) and event.category:authentication and event.action:(userloginfailed or passwordlogoninitialauthusingpassword) and not o365.audit.logonerror:(useraccountnotfound or entitlementgrantsnotfound or userstrongauthenrollmentrequired or userstrongauthclientauthnrequired or invalidreplyto)
<li><a href="#">query = event.dataset:o365.audit and event.provider:(exchange or azureactivedirectory) and event.category:authentication and event.action:("userloginfailed" or "passwordlogoninitialauthusingpassword")"
<li><a href="#">query = event.dataset:o365.audit and event.provider:(skypeforbusiness or microsoftteams) and event.category:web and event.action:"set-csteamsclientconfiguration" and o365.audit.parameters.allowguestuser:true and event.outcome:success"
<li><a href="#">query = event.dataset:o365.audit and event.provider:(skypeforbusiness or microsoftteams) and event.category:web and event.action:"set-cstenantfederationconfiguration" and o365.audit.parameters.allowfederatedusers:true and event.outcome:success"
<li><a href="#">query = event.dataset:o365.audit and event.provider:azureactivedirectory and event.category:authentication and o365.audit.logonerror:"ssoartifactinvalidorexpired"
<li><a href="#">query = event.dataset:o365.audit and event.provider:exchange and event.action:add-mailboxpermission and o365.audit.parameters.accessrights:(fullaccess or sendas or sendonbehalf) and event.outcome:success and not user.id : "nt authority\system (microsoft.exchange.servicehost)"
<li><a href="#">query = event.dataset:o365.audit and event.provider:exchange and event.action:set-mailboxauditbypassassociation and event.outcome:success
<li><a href="#">query = event.dataset:o365.audit and event.provider:exchange and event.category:web and event.action:"disable-safeattachmentrule" and event.outcome:success"
<li><a href="#">query = event.dataset:o365.audit and event.provider:exchange and event.category:web and event.action:"disable-safelinksrule" and event.outcome:success"
<li><a href="#">query = event.dataset:o365.audit and event.provider:exchange and event.category:web and event.action:"new-managementroleassignment" and event.outcome:success"
<li><a href="#">query = event.dataset:o365.audit and event.provider:exchange and event.category:web and event.action:"new-transportrule" and event.outcome:success"
<li><a href="#">query = event.dataset:o365.audit and event.provider:exchange and event.category:web and event.action:"remove-antiphishpolicy" and event.outcome:success"
<li><a href="#">query = event.dataset:o365.audit and event.provider:exchange and event.category:web and event.action:"remove-dlppolicy" and event.outcome:success"
<li><a href="#">query = event.dataset:o365.audit and event.provider:exchange and event.category:web and event.action:"remove-malwarefilterpolicy" and event.outcome:success"
<li><a href="#">query = event.dataset:o365.audit and event.provider:exchange and event.category:web and event.action:"set-dkimsigningconfig" and o365.audit.parameters.enabled:false and event.outcome:success"
<li><a href="#">query = event.dataset:o365.audit and event.provider:exchange and event.category:web and event.action:("new-inboxrule" or "set-inboxrule") and (o365.audit.parameters.forwardto:* or o365.audit.parameters.forwardasattachmentto:* or o365.audit.parameters.redirectto:*) and event.outcome:success"
<li><a href="#">query = event.dataset:o365.audit and event.provider:exchange and event.category:web and event.action:("remove-antiphishrule" or "disable-antiphishrule") and event.outcome:success"
<li><a href="#">query = event.dataset:o365.audit and event.provider:exchange and event.category:web and event.action:("remove-malwarefilterrule" or "disable-malwarefilterrule") and event.outcome:success"
<li><a href="#">query = event.dataset:o365.audit and event.provider:exchange and event.category:web and event.action:("remove-transportrule" or "disable-transportrule") and event.outcome:success"
<li><a href="#">query = event.dataset:o365.audit and event.provider:exchange and event.category:web and event.action:("set-accepteddomain" or "set-msoldomainfederationsettings" or "add-federateddomain" or "new-accepteddomain" or "remove-accepteddomain" or "remove-federateddomain") and event.outcome:success"
<li><a href="#">query = event.dataset:o365.audit and event.provider:microsoftteams and event.category:web and event.action:teamstenantsettingchanged and o365.audit.name:"allow sideloading and interaction of custom apps" and o365.audit.newvalue:true and event.outcome:success"
<li><a href="#">query = event.dataset:o365.audit and event.provider:onedrive and event.code:sharepointfileoperation and event.action:filemalwaredetected
<li><a href="#">query = event.dataset:o365.audit and event.provider:securitycompliancecenter and event.action:alerttriggered and rule.name:"email reported by user as malware or phish"
<li><a href="#">query = event.dataset:o365.audit and event.provider:securitycompliancecenter and event.category:web and event.action:"impossible travel activity" and event.outcome:success"
<li><a href="#">query = event.dataset:o365.audit and event.provider:securitycompliancecenter and event.category:web and event.action:"mass download by a single user" and event.outcome:success"
<li><a href="#">query = event.dataset:o365.audit and event.provider:securitycompliancecenter and event.category:web and event.action:"potential ransomware activity" and event.outcome:success"
<li><a href="#">query = event.dataset:o365.audit and event.provider:securitycompliancecenter and event.category:web and event.action:"unusual volume of file deletion" and event.outcome:success"
<li><a href="#">query = event.dataset:o365.audit and event.provider:securitycompliancecenter and event.category:web and event.action:"user restricted from sending email" and event.outcome:success"
<li><a href="#">query = event.dataset:o365.audit and event.provider:sharepoint and event.code:sharepointfileoperation and event.action:filemalwaredetected
<li><a href="#">query = event.dataset:okta.system and event.action:(application.integration.rate_limit_exceeded or system.org.rate_limit.warning or system.org.rate_limit.violation or core.concurrency.org.limit.violation)
<li><a href="#">query = event.dataset:okta.system and event.action:(application.policy.sign_on.update or application.policy.sign_on.rule.delete)
<li><a href="#">query = event.dataset:okta.system and event.action:(system.email.account_unlock.sent_message or system.email.password_reset.sent_message or system.sms.send_account_unlock_message or system.sms.send_password_reset_message or system.voice.send_account_unlock_call or system.voice.send_password_reset_call or user.account.unlock_token)
<li><a href="#">query = event.dataset:okta.system and event.action:(zone.update or network_zone.rule.disabled or zone.remove_blacklist)
<li><a href="#">query = event.dataset:okta.system and event.action:app.generic.unauth_app_access_attempt
<li><a href="#">query = event.dataset:okta.system and event.action:application.lifecycle.deactivate
<li><a href="#">query = event.dataset:okta.system and event.action:application.lifecycle.delete
<li><a href="#">query = event.dataset:okta.system and event.action:application.lifecycle.update
<li><a href="#">query = event.dataset:okta.system and event.action:group.privilege.grant
<li><a href="#">query = event.dataset:okta.system and event.action:policy.lifecycle.deactivate
<li><a href="#">query = event.dataset:okta.system and event.action:policy.lifecycle.delete
<li><a href="#">query = event.dataset:okta.system and event.action:policy.lifecycle.update
<li><a href="#">query = event.dataset:okta.system and event.action:policy.rule.deactivate
<li><a href="#">query = event.dataset:okta.system and event.action:policy.rule.delete
<li><a href="#">query = event.dataset:okta.system and event.action:policy.rule.update
<li><a href="#">query = event.dataset:okta.system and event.action:system.api_token.create
<li><a href="#">query = event.dataset:okta.system and event.action:system.api_token.revoke
<li><a href="#">query = event.dataset:okta.system and event.action:user.account.lock
<li><a href="#">query = event.dataset:okta.system and event.action:user.account.privilege.grant
<li><a href="#">query = event.dataset:okta.system and event.action:user.account.report_suspicious_activity_by_enduser
<li><a href="#">query = event.dataset:okta.system and event.action:user.mfa.attempt_bypass
<li><a href="#">query = event.dataset:okta.system and event.action:user.mfa.factor.deactivate
<li><a href="#">query = event.dataset:okta.system and event.action:user.mfa.factor.reset_all
<li><a href="#">query = event.dataset:okta.system and event.action:user.session.impersonation.initiate
<li><a href="#">query = event.dataset:okta.system and event.action:zone.deactivate
<li><a href="#">query = event.dataset:okta.system and event.action:zone.delete
<li><a href="#">query = event.dataset:okta.system and event.category:authentication and event.outcome:failure
<li><a href="#">query = event.kind:alert and event.module:endgame and endgame.metadata.type:detection and (event.action:cred_theft_event or endgame.event_subtype_full:cred_theft_event)
<li><a href="#">query = event.kind:alert and event.module:endgame and endgame.metadata.type:detection and (event.action:exploit_event or endgame.event_subtype_full:exploit_event)
<li><a href="#">query = event.kind:alert and event.module:endgame and endgame.metadata.type:detection and (event.action:kernel_shellcode_event or endgame.event_subtype_full:kernel_shellcode_event)
<li><a href="#">query = event.kind:alert and event.module:endgame and endgame.metadata.type:detection and (event.action:token_manipulation_event or endgame.event_subtype_full:token_manipulation_event)
<li><a href="#">query = event.kind:alert and event.module:endgame and endgame.metadata.type:detection and (event.action:token_protection_event or endgame.event_subtype_full:token_protection_event)
<li><a href="#">query = event.kind:alert and event.module:endgame and endgame.metadata.type:prevention and (event.action:cred_theft_event or endgame.event_subtype_full:cred_theft_event)
<li><a href="#">query = event.kind:alert and event.module:endgame and endgame.metadata.type:prevention and (event.action:exploit_event or endgame.event_subtype_full:exploit_event)
<li><a href="#">query = event.kind:alert and event.module:endgame and endgame.metadata.type:prevention and (event.action:kernel_shellcode_event or endgame.event_subtype_full:kernel_shellcode_event)
<li><a href="#">query = event.kind:alert and event.module:endgame and endgame.metadata.type:prevention and (event.action:token_manipulation_event or endgame.event_subtype_full:token_manipulation_event)
<li><a href="#">query = event.kind:alert and event.module:endgame and endgame.metadata.type:prevention and (event.action:token_protection_event or endgame.event_subtype_full:token_protection_event)
<li><a href="#">query = event.module : ("system" or "security") and (event.code : "4720" or event.action : "added-user-account")"
<li><a href="#">query = event.provider:"microsoft-windows-audit-cve" and message:"[cve-2020-0601]"
<li><a href="#">query = event.type:creation and event.module:zoom and event.dataset:zoom.webhook and event.action:meeting.created and not zoom.meeting.password:*
<li><a href="#">query = file where event.action : "creation" and file.extension == "so" and file.name : ".*.so"
<li><a href="#">query = file where event.action : "pipe created*" and file.name : "\\*\\pipe\\*"
<li><a href="#">query = file where event.action == "creation" and user.name == "root" and file.path : ("/etc/ld.so.conf.d/*", "/etc/cron.d/*", "/etc/sudoers.d/*", "/etc/rc.d/init.d/*", "/etc/systemd/system/*") and not process.executable : ("*/dpkg", "*/yum", "*/apt", "*/dnf", "*/systemd", "*/snapd", "*/dnf-automatic", "*/yum-cron", "*/elastic-agent", "*/dnfdaemon-system")"
<li><a href="#">query = file where event.type != "deletion" and file.extension : "spl" and file.path : "?:\\windows\\system32\\spool\\printers\\*" and not process.name : ("spoolsv.exe", "printfilterpipelinesvc.exe", "printisolationhost.exe", "splwow64.exe", "msiexec.exe", "poqexec.exe") and not user.id : "s-1-5-18" and not process.executable : ("?:\\windows\\system32\\mmc.exe", "\\device\\mup\\*.exe", "?:\\windows\\system32\\svchost.exe", "?:\\windows\\system32\\mmc.exe", "?:\\windows\\system32\\printui.exe", "?:\\windows\\system32\\mstsc.exe", "?:\\windows\\system32\\spool\\*.exe", "?:\\program files\\*.exe", "?:\\program files (x86)\\*.exe", "?:\\progra~1\\*.exe", "?:\\progra~2\\*.exe")"
<li><a href="#">query = file where event.type != "deletion" and file.extension : ("exe", "dll") and process.name : ("smss.exe", "autochk.exe", "csrss.exe", "wininit.exe", "services.exe", "lsass.exe", "winlogon.exe", "userinit.exe", "logonui.exe")"
<li><a href="#">query = file where event.type != "deletion" and file.extension : ("wll","xll","ppa","ppam","xla","xlam") and file.path : ("c:\\users\\*\\appdata\\roaming\\microsoft\\word\\startup\\*", "c:\\users\\*\\appdata\\roaming\\microsoft\\addins\\*", "c:\\users\\*\\appdata\\roaming\\microsoft\\excel\\xlstart\\*")"
<li><a href="#">query = file where event.type != "deletion" and file.extension in ("sh", "desktop") and file.path : ("/home/*/.config/autostart/*", "/root/.config/autostart/*", "/home/*/.kde/autostart/*", "/root/.kde/autostart/*", "/home/*/.kde4/autostart/*", "/root/.kde4/autostart/*", "/home/*/.kde/share/autostart/*", "/root/.kde/share/autostart/*", "/home/*/.kde4/share/autostart/*", "/root/.kde4/share/autostart/*", "/home/*/.local/share/autostart/*", "/root/.local/share/autostart/*", "/home/*/.config/autostart-scripts/*", "/root/.config/autostart-scripts/*", "/etc/xdg/autostart/*", "/usr/share/autostart/*") and not process.name in ("yum", "dpkg", "install", "dnf", "teams", "yum-cron", "dnf-automatic")"
<li><a href="#">query = file where event.type != "deletion" and file.name : ("ntds_capi_*.pfx", "ntds_capi_*.pvk")"
<li><a href="#">query = file where event.type != "deletion" and file.name: "com.apple.screensaver.*.plist" and file.path : ("/users/*/library/preferences/byhost/*", "/library/managed preferences/*", "/system/library/preferences/*") and (process.code_signature.trusted == false or process.code_signature.exists == false or process.name : ("curl", "mktemp", "tail", "funzip", "python*", "osascript", "perl")) and not process.executable : ("/usr/sbin/cfprefsd", "/usr/libexec/xpcproxy", "/system/library/coreservices/managedclient.app/contents/resources/mcxcompositor", "/system/library/coreservices/managedclient.app/contents/macos/managedclient")"
<li><a href="#">query = file where event.type != "deletion" and file.path : "?:\\windows\\tasks\\*" and file.extension : "job"
<li><a href="#">query = file where event.type != "deletion" and file.path : "c:\\users\\*\\appdata\\roaming\\microsoft\\outlook\\vbaproject.otm"
<li><a href="#">query = file where event.type != "deletion" and file.path : ("/private/etc/emond.d/rules/*.plist", "/etc/emon.d/rules/*.plist", "/private/var/db/emondclients/*")"
<li><a href="#">query = file where event.type != "deletion" and file.path : ("/system/library/launchagents/.*.plist", "/library/launchagents/.*.plist", "/users/*/library/launchagents/.*.plist", "/system/library/launchdaemons/.*.plist", "/library/launchdaemons/.*.plist")"
<li><a href="#">query = file where event.type != "deletion" and file.path : ("?:\\users\\*\\documents\\windowspowershell\\*", "?:\\users\\*\\documents\\powershell\\*", "?:\\windows\\system32\\windowspowershell\\*") and file.name : ("profile.ps1", "microsoft.powershell_profile.ps1")"
<li><a href="#">query = file where event.type != "deletion" and file.path : ("?:\\windows\\sysvol\\domain\\policies\\*\\machine\\preferences\\scheduledtasks\\scheduledtasks.xml", "?:\\windows\\sysvol\\domain\\policies\\*\\machine\\preferences\\services\\services.xml") and not process.name : "dfsrs.exe"
<li><a href="#">query = file where event.type != "deletion" and process.name != null and file.path : "/private/var/at/tabs/*" and not process.executable == "/usr/bin/crontab"
<li><a href="#">query = file where event.type != "deletion" and user.domain != "nt authority" and (file.path : "c:\\*\\programs\\startup\\*.lnk" and process.name : ("wscript.exe", "cscript.exe")) or file.path : ("c:\\*\\programs\\startup\\*.vbs", "c:\\*\\programs\\startup\\*.vbe", "c:\\*\\programs\\startup\\*.wsh", "c:\\*\\programs\\startup\\*.wsf", "c:\\*\\programs\\startup\\*.js")"
<li><a href="#">query = file where event.type != "deletion" and user.domain != "nt authority" and file.path : ("c:\\users\\*\\appdata\\roaming\\microsoft\\windows\\start menu\\programs\\startup\\*", "c:\\programdata\\microsoft\\windows\\start menu\\programs\\startup\\*") and process.name : ("cmd.exe", "powershell.exe", "wmic.exe", "mshta.exe", "pwsh.exe", "cscript.exe", "wscript.exe", "regsvr32.exe", "regasm.exe", "rundll32.exe", "eqnedt32.exe", "winword.exe", "excel.exe", "powerpnt.exe", "mspub.exe", "msaccess.exe", "iexplore.exe", "installutil.exe")"
<li><a href="#">query = file where event.type : "change" and process.name : "dllhost.exe" and file.name : ("wow64log.dll", "comctl32.dll", "dismcore.dll", "osksupport.dll", "duser.dll", "accessibility.ni.dll") and not file.path : ("c:\\windows\\softwaredistribution\\*", "c:\\windows\\winsxs\\*")"
<li><a href="#">query = file where event.type : "deletion" and not process.name : ("spoolsv.exe", "dllhost.exe", "explorer.exe") and file.path : "?:\\windows\\system32\\spool\\drivers\\x64\\3\\*.dll"
<li><a href="#">query = file where event.type == "change" and file.name : "*aaa.aaa"
<li><a href="#">query = file where event.type == "change" and process.executable : ("/usr/sbin/sshd", "/usr/bin/ssh") and ((file.name : (".*", "~*", "*~") and not file.name : (".cache", ".viminfo", ".bash_history")) or file.extension : ("in", "out", "ini", "h", "gz", "so", "sock", "sync", "0", "1", "2", "3", "4", "5", "6", "7", "8", "9") or file.path : ("/private/etc/*--", "/usr/share/*", "/usr/include/*", "/usr/local/include/*", "/private/tmp/*", "/private/var/tmp/*", "/usr/tmp/*", "/usr/share/man/*", "/usr/local/share/*", "/usr/lib/*.so.*", "/private/etc/ssh/.sshd_auth", "/usr/bin/ssd", "/private/var/opt/power", "/private/etc/ssh/ssh_known_hosts", "/private/var/html/lol", "/private/var/log/utmp", "/private/var/lib", "/var/run/sshd/sshd.pid", "/var/run/nscd/ns.pid", "/var/run/udev/ud.pid", "/var/run/udevd.pid"))"
<li><a href="#">query = file where event.type == "creation" and file.ext.header_bytes : "72656766*" and file.size >= 30000 and process.pid == 4 and user.id : ("s-1-5-21*", "s-1-12-1-*")"
<li><a href="#">query = file where event.type == "creation" and file.extension : "exe" and file.name regex~.*\.(vbs|vbe|bat|js|cmd|wsh|ps1|pdf|docx?|xlsx?|pptx?|txt|rtf|gif|jpg|png|bmp|hta|txt|img|iso)\.exe" and not (process.executable : ("?:\\windows\\system32\\msiexec.exe", "c:\\users\\*\\qgis_sccm\\files\\qgis-osgeo4w-*-setup-x86_64.exe") and file.path : "?:\\program files\\qgis *\\apps\\grass\\*.exe") and not process.executable : ("/bin/sh", "/usr/sbin/mailscanner", "/usr/bin/perl")"
<li><a href="#">query = file where event.type == "creation" and file.path : "c:\\*:*" and not file.path : "c:\\*:zone.identifier*" and not process.executable : ("?:\\windows\\system32\\svchost.exe", "?:\\windows\\system32\\inetsrv\\w3wp.exe", "?:\\windows\\explorer.exe", "?:\\windows\\system32\\sihost.exe", "?:\\windows\\system32\\pickerhost.exe", "?:\\windows\\system32\\searchprotocolhost.exe", "?:\\program files (x86)\\dropbox\\client\\dropbox.exe", "?:\\program files\\rivet networks\\smartbyte\\smartbytenetworkservice.exe", "?:\\program files (x86)\\microsoft\\edge\\application\\msedge.exe", "?:\\program files\\expressconnect\\expressconnectnetworkservice.exe", "?:\\program files (x86)\\google\\chrome\\application\\chrome.exe", "?:\\program files\\google\\chrome\\application\\chrome.exe", "?:\\program files\\mozilla firefox\\firefox.exe") and file.extension : ("pdf", "dll", "png", "exe", "dat", "com", "bat", "cmd", "sys", "vbs", "ps1", "hta", "txt", "vbe", "js", "wsh", "docx", "doc", "xlsx", "xls", "pptx", "ppt", "rtf", "gif", "jpg", "png", "bmp", "img", "iso")"
<li><a href="#">query = file where event.type == "creation" and file.path : ("?:\\program files (x86)\\adobe\\acrobat reader dc\\reader\\acrocef\\rdrcef.exe", "?:\\program files\\adobe\\acrobat reader dc\\reader\\acrocef\\rdrcef.exe") and not process.name : "msiexec.exe"
<li><a href="#">query = file where event.type == "creation" and process.name : "spoolsv.exe" and file.extension : "dll" and file.path : ("?:\\windows\\system32\\*", "?:\\windows\\syswow64\\*") and not file.path : ("?:\\windows\\syswow64\\printconfig.dll", "?:\\windows\\system32\\x5lrs.dll", "?:\\windows\\syswow64\\x5lrs.dll", "?:\\windows\\system32\\printconfig.dll")"
<li><a href="#">query = file where event.type == "creation" and process.name : "teamviewer.exe" and file.extension : ("exe", "dll", "scr", "com", "bat", "ps1", "vbs", "vbe", "js", "wsh", "hta")"
<li><a href="#">query = file where event.type == "creation" and process.name : ("umworkerprocess.exe", "umservice.exe") and file.extension : ("php", "jsp", "js", "aspx", "asmx", "asax", "cfm", "shtml") and (file.path : "?:\\inetpub\\wwwroot\\aspnet_client\\*" or (file.path : "?:\\*\\microsoft\\exchange server*\\frontend\\httpproxy\\owa\\auth\\*" and not (file.path : "?:\\*\\microsoft\\exchange server*\\frontend\\httpproxy\\owa\\auth\\version\\*" or file.name : ("errorfe.aspx", "expiredpassword.aspx", "frowny.aspx", "getidtoken.htm", "logoff.aspx", "logon.aspx", "outlookcn.aspx", "redirsuiteserviceproxy.aspx", "signout.aspx"))) or (file.path : "?:\\*\\microsoft\\exchange server*\\frontend\\httpproxy\\ecp\\auth\\*" and not file.name : "timeoutlogoff.aspx"))"
<li><a href="#">query = file where event.type == "creation" and user.id == "0" and file.path regex~/var/run/\w+\.(pid|lock|reboot)" and file.extension in ("pid","lock","reboot") and not file.name in ("auditd.pid", "python*", "apport.pid", "apport.lock", "kworker*", "gdm3.pid", "sshd.pid", "acpid.pid", "unattended-upgrades.lock", "unattended-upgrades.pid", "cmd.pid", "cron*.pid", "yum.pid", "netconfig.pid", "docker.pid", "atd.pid", "lfd.pid", "atop.pid", "nginx.pid", "dhclient.pid", "smtpd.pid", "stunnel.pid", "1_waagent.pid")"
<li><a href="#">query = file where event.type == "deletion" and ((file.extension : ("vbk", "vib", "vbm") and not process.executable : ("?:\\windows\\veeam\\backup\\*", "?:\\program files\\veeam\\backup and replication\\*", "?:\\program files (x86)\\veeam\\backup and replication\\*")) or (file.extension : "bkf" and not process.executable : ("?:\\program files\\veritas\\backup exec\\*", "?:\\program files (x86)\\veritas\\backup exec\\*")))"
<li><a href="#">query = file where event.type == "deletion" and file.path : ("/var/run/utmp", "/var/log/wtmp", "/var/log/btmp", "/var/log/lastlog", "/var/log/faillog", "/var/log/syslog", "/var/log/messages", "/var/log/secure", "/var/log/auth.log", "/var/log/boot.log", "/var/log/kern.log") and not process.name : ("gzip")"
<li><a href="#">query = file where event.type == "deletion" and file.path : ("c:\\inetpub\\logs\\logfiles\\*.log", "/var/log/apache*/access.log", "/etc/httpd/logs/access_log", "/var/log/httpd/access_log", "/var/www/*/logs/access.log")"
<li><a href="#">query = file where event.type in ("change", "creation") and file.extension : "py" and file.path : ("/users/*/library/application support/sublime text*/packages/*.py", "/applications/sublime text.app/contents/macos/sublime.py") and not process.executable : ("/applications/sublime text*.app/contents/*", "/usr/local/cellar/git/*/bin/git", "/library/developer/commandlinetools/usr/bin/git", "/usr/libexec/xpcproxy", "/system/library/privateframeworks/desktopservicespriv.framework/versions/a/resources/desktopserviceshelper")"
<li><a href="#">query = file where event.type in ("creation", "change") and (process.name : "mstsc.exe" or process.pid == 4) and file.path : ("?:\\users\\*\\appdata\\roaming\\microsoft\\windows\\start menu\\programs\\startup\\*", "?:\\programdata\\microsoft\\windows\\start menu\\programs\\startup\\*")"
<li><a href="#">query = file where file.extension : "dll" and file.path : "c:\\*\\*.exe.local\\*.dll"
<li><a href="#">query = file where file.name : "mimilsa.log" and process.name : "lsass.exe"
<li><a href="#">query = file where file.name : ("lsass*.dmp", "dumpert.dmp", "andrew.dmp", "sqldmpr*.mdmp", "coredump.dmp") and not (process.executable : ("?:\\program files\\microsoft sql server\\*\\shared\\sqldumper.exe", "?:\\windows\\system32\\dllhost.exe") and file.path : ("?:\\program files\\microsoft sql server\\*\\shared\\errordumps\\sqldmpr*.mdmp", "?:\\*\\reporting services\\logfiles\\sqldmpr*.mdmp")) and not (process.executable : "?:\\windows\\system32\\werfault.exe" and file.path : "?:\\windows\\system32\\config\\systemprofile\\appdata\\local\\crashdumps\\lsass.exe.*.dmp")"
<li><a href="#">query = file where file.path : "/*gconv_path*"
<li><a href="#">query = file where process.name : "dns.exe" and event.type in ("creation", "deletion", "change") and not file.name : "dns.log"
<li><a href="#">query = iam where event.action == "added-member-to-group" and group.name : ("admin*", "local administrators", "domain admins", "enterprise admins", "backup admins", "schema admins", "dnsadmins", "exchange organization administrators")"
<li><a href="#">query = iam where event.action == "renamed-user-account" and winlog.event_data.oldtargetusername : "*$" and not winlog.event_data.newtargetusername : "*$"
<li><a href="#">query = iam where event.action == "scheduled-task-created" and not user.name : "*$" and not winlog.event_data.taskname : ("\\onedrive standalone update task-s-1-5-21*", "\\onedrive standalone update task-s-1-12-1-*", "\\hewlett-packard\\hp web products detection", "\\hewlett-packard\\hpdevicecheck")"
<li><a href="#">query = iam where event.action == "scheduled-task-updated" and not user.name : "*$" and not winlog.event_data.taskname : ("\\user_feed_synchronization-*", "\\onedrive reporting task-s-1-5-21*", "\\onedrive reporting task-s-1-12-1-*", "\\hewlett-packard\\hp web products detection", "\\hewlett-packard\\hpdevicecheck")"
<li><a href="#">query = iam where event.action == "user-member-enumerated" and not winlog.event_data.subjectusername: ("*$", "local service", "network service") and not winlog.event_data.callerprocessname: ("-", "?:\\windows\\system32\\vssvc.exe", "?:\\windows\\system32\\searchindexer.exe", "?:\\windows\\system32\\compattelrunner.exe", "?:\\windows\\system32\\oobe\\msoobe.exe", "?:\\windows\\system32\\net1.exe", "?:\\windows\\system32\\svchost.exe", "?:\\windows\\system32\\netplwiz.exe", "?:\\windows\\system32\\msiexec.exe", "?:\\windows\\syswow64\\msiexec.exe", "?:\\windows\\system32\\cloudexperiencehostbroker.exe", "?:\\windows\\system32\\wbem\\wmiprvse.exe", "?:\\windows\\system32\\srtasks.exe", "?:\\windows\\system32\\lsass.exe", "?:\\windows\\system32\\diskshadow.exe", "?:\\windows\\system32\\dfsrs.exe", "?:\\program files\\*.exe", "?:\\program files (x86)\\*.exe", "?:\\windowsazure\\*\\waappagent.exe", "?:\\windows\\system32\\vssadmin.exe", "?:\\windows\\veeamvsssupport\\veeamguesthelper.exe", "?:\\windows\\system32\\dllhost.exe", "?:\\windows\\system32\\mmc.exe", "?:\\windows\\system32\\settingsynchost.exe", "?:\\windows\\immersivecontrolpanel\\systemsettings.exe", "?:\\windows\\system32\\systemsettingsadminflows.exe", "?:\\windows\\temp\\rubrik_vmware???\\snaptool.exe", "?:\\windows\\system32\\inetsrv\\w3wp.exe", "?:\\$windows.~bt\\sources\\*.exe", "?:\\windows\\system32\\wsmprovhost.exe", "?:\\windows\\system32\\spool\\drivers\\x64\\3\\x3jobt3?.exe", "?:\\windows\\system32\\mstsc.exe", "?:\\windows\\system32\\esentutl.exe", "?:\\windows\\system32\\recoverydrive.exe", "?:\\windows\\system32\\systempropertiescomputername.exe") and (group.name:("admin*","remotedesktopusers") or winlog.event_data.targetsid:("s-1-5-32-544","s-1-5-32-555"))"
<li><a href="#">query = library where process.executable : "?:\\windows\\system32\\lsass.exe" and not (dll.code_signature.subject_name : ("microsoft windows", "microsoft corporation", "microsoft windows publisher", "microsoft windows software compatibility publisher", "microsoft windows hardware compatibility publisher", "mcafee, inc.", "secmaker ab", "hid global corporation", "hid global", "apple inc.", "citrix systems, inc.", "dell inc", "hewlett-packard company", "symantec corporation", "national instruments corporation", "digitalpersona, inc.", "novell, inc.", "gemalto", "easyanticheat oy", "entrust datacard corporation", "auristor, inc.", "logmein, inc.", "vmware, inc.", "istituto poligrafico e zecca dello stato s.p.a.", "nubeva technologies ltd", "micro focus (us), inc.", "yubico ab", "gemalto sa", "secure endpoints, inc.", "sophos ltd", "morphisec information security 2014 ltd", "entrust, inc.", "nubeva technologies ltd", "micro focus (us), inc.", "f5 networks inc", "bit4id", "thales dis cpl usa, inc.", "micro focus international plc", "hypr corp", "intel(r) software development products", "pgp corporation", "parallels international gmbh", "frontrange solutions deutschland gmbh", "securelink, inc.", "tidexa ou", "amazon web services, inc.", "sentrybay limited", "audinate pty ltd", "cyberark software ltd.", "mcafeesysprep", "nvidia corporation pe sign v2016") and dll.code_signature.status : ("trusted", "errorexpired", "errorcode_endpoint*", "errorchaining")) and not dll.hash.sha256 : ("811a03a5d7c03802676d2613d741be690b3461022ea925eb6b2651a5be740a4c", "1181542d9cfd63fb00c76242567446513e6773ea37db6211545629ba2ecf26a1", "ed6e735aa6233ed262f50f67585949712f1622751035db256811b4088c214ce3", "26be2e4383728eebe191c0ab19706188f0e9592add2e0bf86b37442083ae5e12", "9367e78b84ef30cf38ab27776605f2645e52e3f6e93369c674972b668a444faa", "d46cc934765c5ecd53867070f540e8d6f7701e834831c51c2b0552aba871921b", "0f77a3826d7a5cd0533990be0269d951a88a5c277bc47cff94553330b715ec61", "4aca034d3d85a9e9127b5d7a10882c2ef4c3e0daa3329ae2ac1d0797398695fb", "86031e69914d9d33c34c2f4ac4ae523cef855254d411f88ac26684265c981d95")"
<li><a href="#">query = network where event.type == "protocol" and network.protocol == "http" and process.name : ("configurationwizard.exe", "netflowservice.exe", "netflowdatabasemaintenance.exe", "solarwinds.administration.exe", "solarwinds.businesslayerhost.exe", "solarwinds.businesslayerhostx64.exe", "solarwinds.collector.service.exe", "solarwindsdiagnostics.exe") and (((http.request.body.content : "*/swip/upload.ashx*" and http.request.body.content : ("post*", "put*")) or (http.request.body.content : ("*/swip/systemdescription*", "*/swip/events*") and http.request.body.content : ("get*", "head*"))) and not http.request.body.content : "*solarwinds.com*")"
<li><a href="#">query = network where event.type == "start" and network.direction : ("outgoing", "egress") and destination.port == 88 and source.port >= 49152 and process.pid != 4 and not process.executable : ("?:\\windows\\system32\\lsass.exe", "system", "?:\\windows\\system32\\svchost.exe", "?:\\program files\\puppet labs\\puppet\\puppet\\bin\\ruby.exe", "\\device\\harddiskvolume?\\windows\\system32\\lsass.exe", "?:\\program files\\rapid7\\nexpose\\nse\\.dllcache\\nseserv.exe", "?:\\program files (x86)\\gfi\\languard 12 agent\\lnsscomm.exe", "?:\\program files (x86)\\superscan\\scanner.exe", "?:\\program files (x86)\\nmap\\nmap.exe", "?:\\program files\\tenable\\nessus\\nessusd.exe", "\\device\\harddiskvolume?\\program files (x86)\\nmap\\nmap.exe", "?:\\program files\\docker\\docker\\resources\\vpnkit.exe", "?:\\program files\\docker\\docker\\resources\\com.docker.vpnkit.exe", "?:\\program files\\vmware\\vmware view\\server\\bin\\ws_tomcatservice.exe", "?:\\program files (x86)\\desktopcentral_agent\\bin\\dcpatchscan.exe", "\\device\\harddiskvolume?\\program files (x86)\\nmap oem\\nmap.exe", "?:\\program files (x86)\\nmap oem\\nmap.exe", "?:\\program files (x86)\\zscaler\\zsatunnel\\zsatunnel.exe", "?:\\program files\\jetbrains\\pycharm community edition*\\bin\\pycharm64.exe", "?:\\program files (x86)\\advanced port scanner\\advanced_port_scanner.exe", "?:\\program files (x86)\\nwps\\netscantools pro\\nstpro.exe", "?:\\program files\\blackberry\\uem\\proxy server\\bin\\prunsrv.exe", "?:\\program files (x86)\\microsoft silverlight\\sllauncher.exe", "?:\\windows\\system32\\microsoftedgecp.exe", "?:\\windows\\systemapps\\microsoft.microsoftedge_*\\microsoftedge.exe", "?:\\program files (x86)\\microsoft\\edgeupdate\\microsoftedgeupdate.exe", "?:\\program files\\google\\chrome\\application\\chrome.exe", "?:\\program files (x86)\\google\\chrome\\application\\chrome.exe", "?:\\program files (x86)\\microsoft\\edge\\application\\msedge.exe", "?:\\program files\\mozilla firefox\\firefox.exe", "?:\\program files\\internet explorer\\iexplore.exe", "?:\\program files (x86)\\internet explorer\\iexplore.exe") and destination.address != "127.0.0.1" and destination.address != "::1"
<li><a href="#">query = network where network.protocol == "dns" and dns.question.name : ("*letsencrypt.org", "*.sslforfree.com", "*.zerossl.com", "*.freessl.org") and process.executable : ("c:\\windows\\system32\\*.exe", "c:\\windows\\system\\*.exe", "c:\\windows\\syswow64\\*.exe", "c:\\windows\\microsoft.net\\framework*\\*.exe", "c:\\windows\\explorer.exe", "c:\\windows\\notepad.exe") and not process.name : ("svchost.exe", "microsoftedge*.exe", "msedge.exe")"
<li><a href="#">query = network where network.protocol == "dns" and process.name != null and user.id not in ("s-1-5-18", "s-1-5-19", "s-1-5-20") and dns.question.name : ("raw.githubusercontent.*", "*.pastebin.*", "*drive.google.*", "*docs.live.*", "*api.dropboxapi.*", "*dropboxusercontent.*", "*onedrive.*", "*4shared.*", "*.file.io", "*filebin.net", "*slack-files.com", "*ghostbin.*", "*ngrok.*", "*portmap.*", "*serveo.net", "*localtunnel.me", "*pagekite.me", "*localxpose.io", "*notabug.org", "rawcdn.githack.*", "paste.nrecom.net", "zerobin.net", "controlc.com", "requestbin.net", "cdn.discordapp.com", "discordapp.com", "discord.com", "script.google.com", "script.googleusercontent.com") and not process.executable : ("?:\\program files\\*.exe", "?:\\program files (x86)\\*.exe", "?:\\windows\\system32\\wwahost.exe", "?:\\windows\\system32\\smartscreen.exe", "?:\\windows\\system32\\microsoftedgecp.exe", "?:\\programdata\\microsoft\\windows defender\\platform\\*\\msmpeng.exe", "?:\\users\\*\\appdata\\local\\google\\chrome\\application\\chrome.exe", "?:\\users\\*\\appdata\\local\\programs\\fiddler\\fiddler.exe", "?:\\users\\*\\appdata\\local\\programs\\microsoft vs code\\code.exe", "?:\\users\\*\\appdata\\local\\microsoft\\onedrive\\onedrive.exe", "?:\\windows\\system32\\mobsync.exe", "?:\\windows\\syswow64\\mobsync.exe", "?:\\users\\*\\appdata\\local\\discord\\app-*\\discord.exe")"
<li><a href="#">query = network where network.protocol == "dns" and process.name != null and user.id not in ("s-1-5-19", "s-1-5-20") and event.action == "lookup_requested" and dns.question.name : ("*api.ipify.org", "*freegeoip.app", "*checkip.amazonaws.com", "*checkip.dyndns.org", "*freegeoip.app", "*icanhazip.com", "*ifconfig.*", "*ipecho.net", "*ipgeoapi.com", "*ipinfo.io", "*ip.anysrc.net", "*myexternalip.com", "*myipaddress.com", "*showipaddress.com", "*whatismyipaddress.com", "*wtfismyip.com", "*ipapi.co", "*ip-lookup.net", "*ipstack.com") and not process.executable : ("?:\\program files\\*.exe", "?:\\program files (x86)\\*.exe", "?:\\windows\\system32\\wwahost.exe", "?:\\windows\\system32\\smartscreen.exe", "?:\\windows\\system32\\microsoftedgecp.exe", "?:\\programdata\\microsoft\\windows defender\\platform\\*\\msmpeng.exe", "?:\\users\\*\\appdata\\local\\google\\chrome\\application\\chrome.exe", "?:\\users\\*\\appdata\\local\\programs\\fiddler\\fiddler.exe", "?:\\users\\*\\appdata\\local\\programs\\microsoft vs code\\code.exe", "?:\\users\\*\\appdata\\local\\microsoft\\onedrive\\onedrive.exe")"
<li><a href="#">query = process where (event.type == "start" and process.name : ("net.exe", "sc.exe", "wmic.exe","powershell.exe","taskkill.exe","pskill.exe","processhacker.exe") and process.args : ("stopservice","uninstall", "stop", "disabled","stop-process","terminate","suspend") and process.args : ("elasticendpoint", "elastic agent","elastic-agent","elastic-endpoint")) or (event.type == "end" and (process.name : ("systemctl", "service") and process.args : "elastic-agent" and process.args : "stop") or (process.name : "kextunload" and process.args : "com.apple.iokit.endpointsecurity" and event.action : "end"))"
<li><a href="#">query = process where event.action == "start" and (process.name : ("powershell.exe", "pwsh.exe", "powershell_ise.exe") or process.pe.original_file_name == "powershell.exe") and process.args : "*set-netfirewallprofile*" and (process.args : "*-enabled*" and process.args : "*false*") and (process.args : "*-all*" or process.args : ("*public*", "*domain*", "*private*"))"
<li><a href="#">query = process where event.action == "start" and process.parent.ext.real.pid > 0 and user.id : "s-1-5-18" and not process.executable : ("?:\\windows\\system32\\werfault.exe", "?:\\windows\\syswow64\\werfault.exe", "?:\\windows\\system32\\werfaultsecure.exe", "?:\\windows\\syswow64\\werfaultsecure.exe", "?:\\windows\\system32\\wermgr.exe", "?:\\windows\\syswow64\\wermgr.exe", "?:\\windows\\softwaredistribution\\download\\install\\securityhealthsetup.exe") and not process.parent.executable : "?:\\windows\\system32\\atbroker.exe" and not (process.code_signature.subject_name in ("philandro software gmbh", "freedom scientific inc.", "teamviewer germany gmbh", "projector.is, inc.", "teamviewer gmbh", "cisco webex llc", "dell inc") and process.code_signature.trusted == true)"
<li><a href="#">query = process where event.action == "start" and user.id : "s-1-5-18" and process.ext.effective_parent.executable : ("?:\\windows\\*.exe", "?:\\program files\\*.exe", "?:\\program files (x86)\\*.exe", "?:\\programdata\\*") and not (process.ext.effective_parent.executable : "?:\\windows\\system32\\utilman.exe" and process.parent.executable : "?:\\windows\\system32\\utilman.exe" and process.parent.args : "/debug") and not process.executable : ("?:\\windows\\system32\\werfault.exe", "?:\\windows\\syswow64\\werfault.exe", "?:\\windows\\system32\\werfaultsecure.exe", "?:\\windows\\syswow64\\werfaultsecure.exe", "?:\\windows\\system32\\wermgr.exe", "?:\\windows\\softwaredistribution\\download\\install\\securityhealthsetup.exe") and not process.parent.executable : ("?:\\windows\\system32\\atbroker.exe", "?:\\windows\\system32\\svchost.exe", "?:\\program files (x86)\\*.exe", "?:\\program files\\*.exe", "?:\\windows\\system32\\msiexec.exe", "c:\\windows\\system32\\driverstore\\*") and not (process.code_signature.trusted == true and process.code_signature.subject_name in ("philandro software gmbh", "freedom scientific inc.", "teamviewer germany gmbh", "projector.is, inc.", "teamviewer gmbh", "cisco webex llc", "dell inc"))"
<li><a href="#">query = process where event.code == "10" and length(winlog.event_data.calltrace) > 0 and not winlog.event_data.calltrace : ("?:\\windows\\system32\\ntdll.dll*", "?:\\windows\\syswow64\\ntdll.dll*", "?:\\windows\\system32\\wow64cpu.dll*", "?:\\windows\\system32\\wow64win.dll*", "?:\\windows\\system32\\win32u.dll*") and not winlog.event_data.targetimage : ("?:\\program files (x86)\\malwarebytes anti-exploit\\mbae-svc.exe", "?:\\program files\\cisco\\amp\\*\\sfc.exe", "?:\\program files (x86)\\microsoft\\edgewebview\\application\\*\\msedgewebview2.exe", "?:\\program files\\adobe\\acrobat dc\\acrobat\\*\\acrocef.exe") and not (process.executable : ("?:\\program files\\adobe\\acrobat dc\\acrobat\\acrobat.exe", "?:\\program files (x86)\\world of warcraft\\_classic_\\wowclassic.exe") and not winlog.event_data.targetimage : "?:\\windows\\system32\\lsass.exe")"
<li><a href="#">query = process where event.code == "10" and process.name : "lsass.exe" and winlog.event_data.grantedaccess == "0x40" and winlog.event_data.calltrace : "*unknown*"
<li><a href="#">query = process where event.code == "10" and winlog.event_data.targetimage : "?:\\windows\\system32\\lsass.exe" and winlog.event_data.calltrace : ("*dbghelp*", "*dbgcore*") and not process.executable : ("?:\\windows\\system32\\werfault.exe", "?:\\windows\\system32\\werfaultsecure.exe")"
<li><a href="#">query = process where event.code:"4688" and process.executable : "?:\\windows\\system32\\lsass.exe" and process.parent.executable : "?:\\windows\\system32\\lsass.exe"
<li><a href="#">query = process where event.type != "end" and process.executable : "/usr/sbin/tc" and process.args : "filter" and process.args : "add" and process.args : "bpf" and not process.parent.executable: "/usr/sbin/libvirtd"
<li><a href="#">query = process where event.type == "start" and (((process.name : "net.exe" or process.pe.original_file_name == "net.exe") or ((process.name : "net1.exe" or process.pe.original_file_name == "net1.exe") and not process.parent.name : "net.exe")) and process.args : ("group", "user", "localgroup") and process.args : ("admin", "domain admins", "remote desktop users", "enterprise admins", "organization management") and not process.args : "/add") or ((process.name : "wmic.exe" or process.pe.original_file_name == "wmic.exe") and process.args : ("group", "useraccount"))"
<li><a href="#">query = process where event.type == "start" and ((process.name : "nbtstat.exe" and process.args : ("-n", "-s")) or (process.name : "arp.exe" and process.args : "-a"))"
<li><a href="#">query = process where event.type == "start" and ((process.name : "net.exe" or process.pe.original_file_name == "net.exe") or ((process.name : "net1.exe" or process.pe.original_file_name == "net1.exe") and not process.parent.name : "net.exe")) and (process.args : "view" or (process.args : "time" and process.args : "\\\\*"))"
<li><a href="#">query = process where event.type == "start" and ((process.name : "net.exe" or process.pe.original_file_name == "net.exe") or ((process.name : "net1.exe" or process.pe.original_file_name == "net1.exe") and not process.parent.name : "net.exe")) and process.args : "use" and process.args : ("\\\\*\\*$*", "\\\\*@ssl\\*", "http*") and not process.args : "/d*"
<li><a href="#">query = process where event.type == "start" and ((process.name : "wevtutil.exe" or process.pe.original_file_name == "wevtutil.exe") and process.args : ("/e:false", "cl", "clear-log")) or (process.name : ("powershell.exe", "pwsh.exe", "powershell_ise.exe") and process.args : "clear-eventlog")"
<li><a href="#">query = process where event.type == "start" and ((process.name:"logman.exe" or process.pe.original_file_name == "logman.exe") and process.args : "eventlog-*" and process.args : ("stop", "delete")) or ((process.name : ("pwsh.exe", "powershell.exe", "powershell_ise.exe") or process.pe.original_file_name in ("pwsh.exe", "powershell.exe", "powershell_ise.exe")) and process.args : "set-service" and process.args: "eventlog" and process.args : "disabled") or ((process.name:"auditpol.exe" or process.pe.original_file_name == "auditpol.exe") and process.args : "/success:disable")"
<li><a href="#">query = process where event.type == "start" and ((process.name:"rar.exe" or process.code_signature.subject_name == "win.rar gmbh" or process.pe.original_file_name == "command line rar") and process.args == "a" and process.args : ("-hp*", "-p*", "-dw", "-tb", "-ta", "/hp*", "/p*", "/dw", "/tb", "/ta")) or (process.pe.original_file_name in ("7z.exe", "7za.exe") and process.args == "a" and process.args : ("-p*", "-sdel"))"
<li><a href="#">query = process where event.type == "start" and ((process.pe.original_file_name in ("cmd.exe", "powershell.exe", "xcopy.exe") and process.args : ("copy", "xcopy", "copy-item", "move", "cp", "mv")) or (process.pe.original_file_name : "esentutl.exe" and process.args : ("*/y*", "*/vss*", "*/d*"))) and process.args : ("*\\ntds.dit", "*\\config\\sam", "\\*\\globalroot\\device\\harddiskvolumeshadowcopy*\\*", "*/system32/config/sam*")"
<li><a href="#">query = process where event.type == "start" and (?process.ext.token.integrity_level_name : "system" or ?winlog.event_data.integritylevel : "system") and ((process.name : "elevation_service.exe" and not process.pe.original_file_name == "elevation_service.exe") or (process.parent.name : "elevation_service.exe" and process.name : ("rundll32.exe", "cmd.exe", "powershell.exe")))"
<li><a href="#">query = process where event.type == "start" and (?process.ext.token.integrity_level_name : "system" or ?winlog.event_data.integritylevel : "system") and (process.name : "whoami.exe" or (process.name : "net1.exe" and not process.parent.name : "net.exe"))"
<li><a href="#">query = process where event.type == "start" and (process.executable : "/usr/sbin/chkconfig" and process.args : "--add") or (process.args : "*chkconfig" and process.args : "--add")"
<li><a href="#">query = process where event.type == "start" and (process.name : "adfind.exe" or process.pe.original_file_name == "adfind.exe") and process.args : ("objectcategory=computer", "(objectcategory=computer)", "objectcategory=person", "(objectcategory=person)", "objectcategory=subnet", "(objectcategory=subnet)", "objectcategory=group", "(objectcategory=group)", "objectcategory=organizationalunit", "(objectcategory=organizationalunit)", "objectcategory=attributeschema", "(objectcategory=attributeschema)", "domainlist", "dcmodes", "adinfo", "dclist", "computers_pwnotreqd", "trustdmp")"
<li><a href="#">query = process where event.type == "start" and (process.name : "appcmd.exe" or process.pe.original_file_name == "appcmd.exe") and process.args : "/dontlog*:*true" and not process.parent.name : "iissetup.exe"
<li><a href="#">query = process where event.type == "start" and (process.name : "appcmd.exe" or process.pe.original_file_name == "appcmd.exe") and process.args : "/list" and process.args : "/text*password"
<li><a href="#">query = process where event.type == "start" and (process.name : "aspnet_regiis.exe" or process.pe.original_file_name == "aspnet_regiis.exe") and process.args : "connectionstrings" and process.args : "-pdf"
<li><a href="#">query = process where event.type == "start" and (process.name : "bcdedit.exe" or process.pe.original_file_name == "bcdedit.exe") and ((process.args : "/set" and process.args : "bootstatuspolicy" and process.args : "ignoreallfailures") or (process.args : "no" and process.args : "recoveryenabled"))"
<li><a href="#">query = process where event.type == "start" and (process.name : "certutil.exe" or process.pe.original_file_name == "certutil.exe") and process.args : ("?decode", "?encode", "?urlcache", "?verifyctl", "?encodehex", "?decodehex", "?exportpfx")"
<li><a href="#">query = process where event.type == "start" and (process.name : "desktopimgdownldr.exe" or process.pe.original_file_name == "desktopimgdownldr.exe") and process.args : "/lockscreenurl:http*"
<li><a href="#">query = process where event.type == "start" and (process.name : "fsutil.exe" or process.pe.original_file_name == "fsutil.exe") and process.args : "deletejournal" and process.args : "usn"
<li><a href="#">query = process where event.type == "start" and (process.name : "fsutil.exe" or process.pe.original_file_name == "fsutil.exe") and process.args : "fsinfo" and process.args : "drives"
<li><a href="#">query = process where event.type == "start" and (process.name : "mpcmdrun.exe" or process.pe.original_file_name == "mpcmdrun.exe") and process.args : "-downloadfile" and process.args : "-url" and process.args : "-path"
<li><a href="#">query = process where event.type == "start" and (process.name : "msbuild.exe" or process.pe.original_file_name == "msbuild.exe") and process.parent.name : ("cmd.exe", "powershell.exe", "pwsh.exe", "powershell_ise.exe", "cscript.exe", "wscript.exe", "mshta.exe")"
<li><a href="#">query = process where event.type == "start" and (process.name : "netsh.exe" or process.pe.original_file_name == "netsh.exe") and process.args : "wlan" and process.args : "key*clear"
<li><a href="#">query = process where event.type == "start" and (process.name : "netsh.exe" or process.pe.original_file_name == "netsh.exe") and process.args : ("localport=3389", "remotedesktop", "group=\"remote desktop\) and process.args : ("action=allow", "enable=yes", "enable")"
<li><a href="#">query = process where event.type == "start" and (process.name : "sc.exe" or process.pe.original_file_name == "sc.exe") and process.parent.name : ("cmd.exe", "wscript.exe", "rundll32.exe", "regsvr32.exe", "wmic.exe", "mshta.exe","powershell.exe", "pwsh.exe") and process.args:("config", "create", "start", "delete", "stop", "pause") and not user.id : "s-1-5-18"
<li><a href="#">query = process where event.type == "start" and (process.name : "vssadmin.exe" or process.pe.original_file_name == "vssadmin.exe") and process.args in ("delete", "resize") and process.args : "shadows*"
<li><a href="#">query = process where event.type == "start" and (process.name : "wbadmin.exe" or process.pe.original_file_name == "wbadmin.exe") and process.args : "catalog" and process.args : "delete"
<li><a href="#">query = process where event.type == "start" and (process.name : "wmic.exe" or process.pe.original_file_name == "wmic.exe") and process.args : "create" and process.args : ("activescripteventconsumer", "commandlineeventconsumer")"
<li><a href="#">query = process where event.type == "start" and (process.name : "wmic.exe" or process.pe.original_file_name == "wmic.exe") and process.args : "delete" and process.args : "shadowcopy"
<li><a href="#">query = process where event.type == "start" and (process.name : ("cscript.exe", "wscript.exe", "powershell.exe", "rundll32.exe", "cmd.exe", "mshta.exe", "regsvr32.exe") or process.pe.original_file_name in ("cscript.exe", "wscript.exe", "powershell.exe", "rundll32.exe", "cmd.exe", "mshta.exe", "regsvr32.exe")) and process.parent.name : "explorer.exe" and process.parent.args : "-embedding" and not process.parent.args: ("/factory,{5bd95610-9434-43c2-886c-57852cc8a120}", "/factory,{ceff45ee-c862-41de-aee2-a022c81eda92}")"
<li><a href="#">query = process where event.type == "start" and (process.name : ("powershell.exe", "pwsh.exe", "powershell_ise.exe") or process.pe.original_file_name == "powershell.exe") and (process.args : "*clear-history*" or (process.args : ("*remove-item*", "rm") and process.args : ("*consolehost_history.txt*", "*(get-psreadlineoption).historysavepath*")) or (process.args : "*set-psreadlineoption*" and process.args : "*savenothing*"))"
<li><a href="#">query = process where event.type == "start" and (process.name : ("powershell.exe", "pwsh.exe", "powershell_ise.exe") or process.pe.original_file_name in ("powershell.exe", "pwsh.dll", "powershell_ise.exe")) and process.args : "set-mppreference" and process.args : ("-disable*", "disabled", "neversend", "-exclusion*")"
<li><a href="#">query = process where event.type == "start" and (process.name : ("powershell.exe", "pwsh.exe", "powershell_ise.exe") or process.pe.original_file_name in ("powershell.exe", "pwsh.dll", "powershell_ise.exe")) and process.args : ("*add-mppreference*", "*set-mppreference*") and process.args : ("*-exclusion*")"
<li><a href="#">query = process where event.type == "start" and (process.name == "capsh" and process.args == "--") or (process.name in ("bash", "sh", "dash","ash") and (process.parent.name in ("byebug","git","ftp","strace")) or (process.parent.args in ("/bin/sh", "/bin/bash", "/bin/dash", "/bin/ash", "sh", "bash", "dash", "ash") and ((process.parent.name == "nice") or (process.parent.name == "cpulimit" and process.parent.args == "-f") or (process.parent.name == "find" and process.parent.args == "-exec" and process.parent.args == ";") or (process.parent.name == "flock" and process.parent.args == "-u" and process.parent.args == "/"))) or (process.args in ("/bin/sh", "/bin/bash", "/bin/dash", "/bin/ash", "sh", "bash", "dash", "ash") and (process.parent.name == "crash" and process.parent.args == "-h") or (process.name == "sensible-pager" and process.parent.name in ("apt", "apt-get") and process.parent.args == "changelog"))) or (process.name == "busybox" and process.args_count == 2 and process.args in ("/bin/sh", "/bin/bash", "/bin/dash", "/bin/ash", "sh", "bash", "dash", "ash"))or (process.name == "env" and process.args_count == 2 and process.args in ("/bin/sh", "/bin/bash", "/bin/dash", "/bin/ash", "sh", "bash", "dash", "ash")) or (process.parent.name in ("vi", "vim") and process.parent.args == "-c" and process.parent.args in (":!/bin/bash", ":!/bin/sh", ":!bash", ":!sh")) or (process.parent.name in ("c89","c99", "gcc") and process.parent.args in ("sh,-s", "bash,-s", "dash,-s", "ash,-s", "/bin/sh,-s", "/bin/bash,-s", "/bin/dash,-s", "/bin/ash,-s") and process.parent.args == "-wrapper") or (process.parent.name == "expect" and process.parent.args == "-c" and process.parent.args in ("spawn /bin/sh;interact", "spawn /bin/bash;interact", "spawn /bin/dash;interact", "spawn sh;interact", "spawn bash;interact", "spawn dash;interact")) or (process.parent.name == "mysql" and process.parent.args == "-e" and process.parent.args in ("\\!*sh", "\\!*bash", "\\!*dash", "\\!*/bin/sh", "\\!*/bin/bash", "\\!*/bin/dash")) or (process.parent.name == "ssh" and process.parent.args == "-o" and process.parent.args in ("proxycommand=;sh 0<&2 1>&2", "proxycommand=;bash 0<&2 1>&2", "proxycommand=;dash 0<&2 1>&2", "proxycommand=;/bin/sh 0<&2 1>&2", "proxycommand=;/bin/bash 0<&2 1>&2", "proxycommand=;/bin/dash 0<&2 1>&2")) or (process.parent.name in ("nawk", "mawk", "awk", "gawk") and process.parent.args : "begin {system(*)}")"
<li><a href="#">query = process where event.type == "start" and (process.name:"wmic.exe" or process.pe.original_file_name:"wmic.exe") and process.args:"/namespace:\\\\root\\securitycenter2" and process.args:"get"
<li><a href="#">query = process where event.type == "start" and (process.pe.original_file_name == "msdt.exe" or process.name : "msdt.exe") and (process.args : ("it_rebrowseforfile=*", "ms-msdt:/id", "ms-msdt:-id", "*frombase64*") or (process.args : "-af" and process.args : "/skip" and process.parent.name : ("explorer.exe", "cmd.exe", "powershell.exe", "cscript.exe", "wscript.exe", "mshta.exe", "rundll32.exe", "regsvr32.exe") and process.args : ("?:\\windows\\diagnostics\\index\\pcwdiagnostic.xml", "pcwdiagnostic.xml", "?:\\users\\public\\*", "?:\\windows\\temp\\*")) or (process.pe.original_file_name == "msdt.exe" and not process.name : "msdt.exe" and process.name != null) or (process.pe.original_file_name == "msdt.exe" and not process.executable : ("?:\\windows\\system32\\msdt.exe", "?:\\windows\\syswow64\\msdt.exe")))"
<li><a href="#">query = process where event.type == "start" and (process.pe.original_file_name == "msmpeng.exe" and not process.name : "msmpeng.exe") or (process.name : "msmpeng.exe" and not process.executable : ("?:\\programdata\\microsoft\\windows defender\\*.exe", "?:\\program files\\windows defender\\*.exe", "?:\\program files (x86)\\windows defender\\*.exe", "?:\\program files\\microsoft security client\\*.exe", "?:\\program files (x86)\\microsoft security client\\*.exe"))"
<li><a href="#">query = process where event.type == "start" and (process.pe.original_file_name == "procdump" and process.args : "-ma") or (process.name : "processdump.exe" and not process.parent.executable regex~c:\\program files(\(x86\))?\\cisco systems\\.*") or (process.pe.original_file_name == "writeminidump.exe" and not process.parent.executable regex~c:\\program files(\(x86\))?\\steam\\.*") or (process.pe.original_file_name == "rundll32.exe" and (process.args : "minidump*" or process.command_line : "*comsvcs.dll*#24*")) or (process.pe.original_file_name == "rdrleakdiag.exe" and process.args : "/fullmemdmp") or (process.pe.original_file_name == "sqldumper.exe" and process.args : "0x01100*") or (process.pe.original_file_name == "tttracer.exe" and process.args : "-dumpfull" and process.args : "-attach") or (process.pe.original_file_name == "ntdsutil.exe" and process.args : "create*full*") or (process.pe.original_file_name == "diskshadow.exe" and process.args : "/s")"
<li><a href="#">query = process where event.type == "start" and (process.pe.original_file_name == "wuauclt.exe" or process.name : "wuauclt.exe") and process.args : "/runhandlercomserver" and process.args : "/updatedeploymentprovider" and process.args : ("c:\\users\\*.dll", "c:\\programdata\\*.dll", "c:\\windows\\temp\\*.dll", "c:\\windows\\tasks\\*.dll")"
<li><a href="#">query = process where event.type == "start" and (process.pe.original_file_name:"vaultcmd.exe" or process.name:"vaultcmd.exe") and process.args:"/list*"
<li><a href="#">query = process where event.type == "start" and event.action == "exec" and process.executable: "/usr/bin/unshare" and not process.parent.executable: ("/usr/bin/udevadm", "*/lib/systemd/systemd-udevd", "/usr/bin/unshare") and not process.args : "/usr/bin/snap"
<li><a href="#">query = process where event.type == "start" and event.action == "exec" and user.name == "root" and (process.args : "/etc/shadow" or (process.working_directory: "/etc" and process.args: "shadow")) and not process.executable: ("/usr/bin/tar", "/bin/tar", "/usr/bin/gzip", "/bin/gzip", "/usr/bin/zip", "/bin/zip", "/usr/bin/stat", "/bin/stat", "/usr/bin/cmp", "/bin/cmp", "/usr/bin/sudo", "/bin/sudo", "/usr/bin/find", "/bin/find", "/usr/bin/ls", "/bin/ls", "/usr/bin/uniq", "/bin/uniq", "/usr/bin/unzip", "/bin/unzip") and not process.parent.executable: "/bin/dracut"
<li><a href="#">query = process where event.type == "start" and event.action == "exec" and user.name == "root" and process.executable : ("/dev/shm/*", "/run/shm/*", "/var/run/*", "/var/lock/*") and not process.executable : ("/var/run/docker/*")"
<li><a href="#">query = process where event.type == "start" and length(process.name) > 0 and length(process.name) == 5 and host.os.name == "windows" and length(process.pe.original_file_name) > 5"
<li><a href="#">query = process where event.type == "start" and process.args : "*:3389" and process.args : ("-l", "-p", "-r", "-pw", "-ssh")"
<li><a href="#">query = process where event.type == "start" and process.args : "/autoclean" and process.args : "/d" and not process.executable : ("c:\\windows\\system32\\cleanmgr.exe", "c:\\windows\\syswow64\\cleanmgr.exe", "c:\\windows\\system32\\taskhostw.exe")"
<li><a href="#">query = process where event.type == "start" and process.args : "?:\\*:*" and process.args_count == 1"
<li><a href="#">query = process where event.type == "start" and process.args : "-s" and process.args : "-d" and process.args : "rssocks"
<li><a href="#">query = process where event.type == "start" and process.args : ("c:\\windows \\system32\\*.exe", "c:\\windows \\syswow64\\*.exe")"
<li><a href="#">query = process where event.type == "start" and process.executable : "/usr/sbin/insmod" and process.args : "*.ko"
<li><a href="#">query = process where event.type == "start" and process.executable : "\\device\\mup\\tsclient\\*.exe"
<li><a href="#">query = process where event.type == "start" and process.executable : "c:\\*" and (process.working_directory : "?:\\" and not process.working_directory: "c:\\") and process.parent.name : "explorer.exe" and process.name : ("rundll32.exe", "mshta.exe", "powershell.exe", "pwsh.exe", "cmd.exe", "regsvr32.exe", "cscript.exe", "wscript.exe")"
<li><a href="#">query = process where event.type == "start" and process.executable : "c:\\*\\appdata\\*\\temp\\idc*.tmp\\*.exe" and process.parent.name : "ieinstal.exe" and process.parent.args : "-embedding"
<li><a href="#">query = process where event.type == "start" and process.executable : "c:\\*program*files*\\*.exe" and not process.executable : ("c:\\program files\\*.exe", "c:\\program files (x86)\\*.exe", "c:\\users\\*.exe", "c:\\programdata\\*.exe")"
<li><a href="#">query = process where event.type == "start" and process.executable : ("?:\\windows\\syswow64\\control.exe", "?:\\windows\\system32\\control.exe") and process.command_line : ("*.jpg*", "*.png*", "*.gif*", "*.bmp*", "*.jpeg*", "*.tiff*", "*.inf*", "*.cpl:*/*", "*../../..*", "*/appdata/local/*", "*:\\users\\public\\*", "*\\appdata\\local\\*")"
<li><a href="#">query = process where event.type == "start" and process.executable : ("c:\\perflogs\\*.exe","c:\\users\\public\\*.exe","c:\\windows\\tasks\\*.exe","c:\\intel\\*.exe","c:\\amd\\temp\\*.exe","c:\\windows\\appreadiness\\*.exe", "c:\\windows\\servicestate\\*.exe","c:\\windows\\security\\*.exe","c:\\windows\\identitycrl\\*.exe","c:\\windows\\branding\\*.exe","c:\\windows\\csc\\*.exe", "c:\\windows\\digitallocker\\*.exe","c:\\windows\\en-us\\*.exe","c:\\windows\\wlansvc\\*.exe","c:\\windows\\prefetch\\*.exe","c:\\windows\\fonts\\*.exe", "c:\\windows\\diagnostics\\*.exe","c:\\windows\\tapi\\*.exe","c:\\windows\\inf\\*.exe","c:\\windows\\system32\\speech\\*.exe","c:\\windows\\tracing\\*.exe", "c:\\windows\\ime\\*.exe","c:\\windows\\performance\\*.exe","c:\\windows\\intel\\*.exe","c:\\windows\\ms\\*.exe","c:\\windows\\dot3svc\\*.exe", "c:\\windows\\panther\\*.exe","c:\\windows\\remotepackages\\*.exe","c:\\windows\\ocr\\*.exe","c:\\windows\\appcompat\\*.exe","c:\\windows\\apppatch\\*.exe","c:\\windows\\addins\\*.exe", "c:\\windows\\setup\\*.exe","c:\\windows\\help\\*.exe","c:\\windows\\skb\\*.exe","c:\\windows\\vss\\*.exe","c:\\windows\\web\\*.exe","c:\\windows\\servicing\\*.exe","c:\\windows\\cbstemp\\*.exe", "c:\\windows\\logs\\*.exe","c:\\windows\\waas\\*.exe","c:\\windows\\shellexperiences\\*.exe","c:\\windows\\shellcomponents\\*.exe","c:\\windows\\pla\\*.exe", "c:\\windows\\migration\\*.exe","c:\\windows\\debug\\*.exe","c:\\windows\\cursors\\*.exe","c:\\windows\\containers\\*.exe","c:\\windows\\boot\\*.exe","c:\\windows\\bcastdvr\\*.exe", "c:\\windows\\assembly\\*.exe","c:\\windows\\textinput\\*.exe","c:\\windows\\security\\*.exe","c:\\windows\\schemas\\*.exe","c:\\windows\\schcache\\*.exe","c:\\windows\\resources\\*.exe", "c:\\windows\\rescache\\*.exe","c:\\windows\\provisioning\\*.exe","c:\\windows\\printdialog\\*.exe","c:\\windows\\policydefinitions\\*.exe","c:\\windows\\media\\*.exe", "c:\\windows\\globalization\\*.exe","c:\\windows\\l2schemas\\*.exe","c:\\windows\\livekernelreports\\*.exe","c:\\windows\\modemlogs\\*.exe","c:\\windows\\immersivecontrolpanel\\*.exe") and not process.name : ("speechuxwiz.exe","systemsettings.exe","trustedinstaller.exe","printdialog.exe","mpsigstub.exe","lms.exe","mpam-*.exe") and not process.executable : ("?:\\intel\\wireless\\wusetuplauncher.exe", "?:\\intel\\wireless\\setup.exe", "?:\\intel\\move mouse.exe", "?:\\windows\\panther\\diagtrackrunner.exe", "?:\\windows\\servicing\\gc64\\tzupd.exe", "?:\\users\\public\\res\\remotelite.exe", "?:\\users\\public\\ibm\\clientsolutions\\*.exe", "?:\\users\\public\\documents\\syspin.exe", "?:\\users\\public\\res\\filewatcher.exe")"
<li><a href="#">query = process where event.type == "start" and process.name : "attrib.exe" and process.args : "+h"
<li><a href="#">query = process where event.type == "start" and process.name : "clipup.exe" and not process.executable : "c:\\windows\\system32\\clipup.exe" and process.parent.name : "dllhost.exe" and process.parent.args : "/processid:{bd54c901-076b-434e-b6c7-17c531f4ab41}"
<li><a href="#">query = process where event.type == "start" and process.name : "cmd.exe" and process.args : "/c" and process.args : ("set", "dir")"
<li><a href="#">query = process where event.type == "start" and process.name : "cmd.exe" and process.parent.name : "sqlservr.exe" and not process.args : ("\\\\*", "diskfree", "rmdir", "mkdir", "dir", "del", "rename", "bcp", "*xmlnamespaces*", "?:\\mssql\\backup\\jobs\\sql_agent_backup_job.ps1", "k:\\mssql\\backup\\msdb", "k:\\mssql\\backup\\logins")"
<li><a href="#">query = process where event.type == "start" and process.name : "cmd.exe" and process.parent.name : ("lsass.exe", "csrss.exe", "epad.exe", "regsvr32.exe", "dllhost.exe", "logonui.exe", "wermgr.exe", "spoolsv.exe", "jucheck.exe", "jusched.exe", "ctfmon.exe", "taskhostw.exe", "googleupdate.exe", "sppsvc.exe", "sihost.exe", "slui.exe", "sihclient.exe", "searchindexer.exe", "searchprotocolhost.exe", "flashplayerupdateservice.exe", "werfault.exe", "wudfhost.exe", "unsecapp.exe", "wlanext.exe")"
<li><a href="#">query = process where event.type == "start" and process.name : "conhost.exe" and process.parent.name : ("lsass.exe", "services.exe", "smss.exe", "winlogon.exe", "explorer.exe", "dllhost.exe", "rundll32.exe", "regsvr32.exe", "userinit.exe", "wininit.exe", "spoolsv.exe", "ctfmon.exe") and not (process.parent.name : "rundll32.exe" and process.parent.args : ("?:\\windows\\installer\\msi*.tmp,zzzzinvokemanagedcustomactionoutofproc", "?:\\windows\\system32\\pcasvc.dll,pcapatchsdbtask", "?:\\windows\\system32\\davclnt.dll,davsetcookie"))"
<li><a href="#">query = process where event.type == "start" and process.name : "control.exe" and process.parent.name : "workfolders.exe" and not process.executable : ("?:\\windows\\system32\\control.exe", "?:\\windows\\syswow64\\control.exe")"
<li><a href="#">query = process where event.type == "start" and process.name : "fltmc.exe" and process.args : "unload"
<li><a href="#">query = process where event.type == "start" and process.name : "msbuild.exe" and process.parent.name : ("eqnedt32.exe", "excel.exe", "fltldr.exe", "msaccess.exe", "mspub.exe", "outlook.exe", "powerpnt.exe", "winword.exe")"
<li><a href="#">query = process where event.type == "start" and process.name : "msbuild.exe" and process.parent.name : ("explorer.exe", "wmiprvse.exe")"
<li><a href="#">query = process where event.type == "start" and process.name : "netsh.exe" and ((process.args : "disable" and process.args : "firewall" and process.args : "set") or (process.args : "advfirewall" and process.args : "off" and process.args : "state"))"
<li><a href="#">query = process where event.type == "start" and process.name : "netsh.exe" and process.args : ("firewall", "advfirewall") and process.args : "group=network discovery" and process.args : "enable=yes"
<li><a href="#">query = process where event.type == "start" and process.name : "rundll32.exe" and process.args : ("?:\\windows\\system32\\davclnt.dll,davsetcookie", "?:\\windows\\syswow64\\davclnt.dll,davsetcookie") and process.args : ("http*/print/pipe/*", "http*/pipe/spoolss", "http*/pipe/srvsvc")"
<li><a href="#">query = process where event.type == "start" and process.name : "sdbinst.exe" and not (process.args : "-m" and process.args : "-bg") and not process.args : "-mm"
<li><a href="#">query = process where event.type == "start" and process.name : "security" and process.args : "-wa" and process.args : ("find-generic-password", "find-internet-password") and process.args : ("chrome*", "chromium", "opera", "safari*", "brave", "microsoft edge", "edge", "firefox*") and not process.parent.executable : "/applications/keeper password manager.app/contents/frameworks/keeper password manager helper*/contents/macos/keeper password manager helper*"
<li><a href="#">query = process where event.type == "start" and process.name : "touch" and user.id != "0" and process.args : ("-r", "-t", "-a*","-m*") and not process.args : ("/usr/lib/go-*/bin/go", "/usr/lib/dracut/dracut-functions.sh", "/tmp/ksinstallaction.*/m/.patch/*")"
<li><a href="#">query = process where event.type == "start" and process.name : "whoami.exe" and (((user.domain : ("nt authority", "nt-autoritã„t", "autorite nt", "iis apppool") or user.id : ("s-1-5-18", "s-1-5-19", "s-1-5-20")) and not (process.parent.name : "cmd.exe" and process.parent.args : ("chcp 437>nul 2>&1 & c:\\windows\\system32\\whoami.exe /groups", "chcp 437>nul 2>&1 & %systemroot%\\system32\\whoami /user", "c:\\windows\\system32\\whoami.exe /groups", "*windows\\system32\\config\\systemprofile*")) and not (process.parent.executable : "c:\\windows\\system32\\inetsrv\\appcmd.exe" and process.parent.args : "list") and not process.parent.executable : ("c:\\program files\\microsoft monitoring agent\\agent\\monitoringhost.exe", "c:\\program files\\cohesity\\cohesity_windows_agent_service.exe")) or process.parent.name : ("wsmprovhost.exe", "w3wp.exe", "wmiprvse.exe", "rundll32.exe", "regsvr32.exe"))"
<li><a href="#">query = process where event.type == "start" and process.name : ("cmd.exe", "powershell.exe") and process.parent.name : "rundll32.exe" and process.parent.command_line != null and not process.parent.args : ("c:\\windows\\system32\\shell32.dll,runasnewuser_rundll", "c:\\windows\\*.tmp,zzzzinvokemanagedcustomactionoutofproc")"
<li><a href="#">query = process where event.type == "start" and process.name : ("cmd.exe", "powershell.exe", "robocopy.exe", "xcopy.exe") and process.args : ("copy*", "move*", "cp", "mv") and process.args : "*$*"
<li><a href="#">query = process where event.type == "start" and process.name : ("csc.exe", "vbc.exe") and process.parent.name : ("wscript.exe", "mshta.exe", "cscript.exe", "wmic.exe", "svchost.exe", "rundll32.exe", "cmstp.exe", "regsvr32.exe")"
<li><a href="#">query = process where event.type == "start" and process.name : ("esensor.exe", "elastic-endpoint.exe") and process.parent.executable != null and not process.parent.executable : ("c:\\program files\\elastic\\*", "c:\\windows\\system32\\services.exe", "c:\\windows\\system32\\werfault*.exe", "c:\\windows\\system32\\wermgr.exe")"
<li><a href="#">query = process where event.type == "start" and process.name : ("net.exe", "net1.exe") and not process.parent.name : "net.exe" and (process.args : "user" and process.args : ("/ad", "/add"))"
<li><a href="#">query = process where event.type == "start" and process.name : ("powershell.exe", "pwsh.exe", "powershell_ise.exe") and process.args : ("*get-wmiobject*", "*gwmi*", "*get-ciminstance*", "*gcim*") and process.args : ("*win32_shadowcopy*") and process.args : ("*.delete()*", "*remove-wmiobject*", "*rwmi*", "*remove-ciminstance*", "*rcim*")"
<li><a href="#">query = process where event.type == "start" and process.name : ("wscript.exe", "cscript.exe", "rundll32.exe", "regsvr32.exe", "cmstp.exe", "regasm.exe", "installutil.exe", "mshta.exe", "regsvcs.exe", "powershell.exe", "pwsh.exe", "cmd.exe") and process.args : ("c:\\perflogs\\*", "c:\\users\\public\\*", "c:\\windows\\tasks\\*", "c:\\intel\\*", "c:\\amd\\temp\\*", "c:\\windows\\appreadiness\\*", "c:\\windows\\servicestate\\*", "c:\\windows\\security\\*", "c:\\windows\\identitycrl\\*", "c:\\windows\\branding\\*", "c:\\windows\\csc\\*", "c:\\windows\\digitallocker\\*", "c:\\windows\\en-us\\*", "c:\\windows\\wlansvc\\*", "c:\\windows\\prefetch\\*", "c:\\windows\\fonts\\*", "c:\\windows\\diagnostics\\*", "c:\\windows\\tapi\\*", "c:\\windows\\inf\\*", "c:\\windows\\system32\\speech\\*", "c:\\windows\\tracing\\*", "c:\\windows\\ime\\*", "c:\\windows\\performance\\*", "c:\\windows\\intel\\*", "c:\\windows\\ms\\*", "c:\\windows\\dot3svc\\*", "c:\\windows\\panther\\*", "c:\\windows\\remotepackages\\*", "c:\\windows\\ocr\\*", "c:\\windows\\appcompat\\*", "c:\\windows\\apppatch\\*", "c:\\windows\\addins\\*", "c:\\windows\\setup\\*", "c:\\windows\\help\\*", "c:\\windows\\skb\\*", "c:\\windows\\vss\\*", "c:\\windows\\servicing\\*", "c:\\windows\\cbstemp\\*", "c:\\windows\\logs\\*", "c:\\windows\\waas\\*", "c:\\windows\\twain_32\\*", "c:\\windows\\shellexperiences\\*", "c:\\windows\\shellcomponents\\*", "c:\\windows\\pla\\*", "c:\\windows\\migration\\*", "c:\\windows\\debug\\*", "c:\\windows\\cursors\\*", "c:\\windows\\containers\\*", "c:\\windows\\boot\\*", "c:\\windows\\bcastdvr\\*", "c:\\windows\\textinput\\*", "c:\\windows\\security\\*", "c:\\windows\\schemas\\*", "c:\\windows\\schcache\\*", "c:\\windows\\resources\\*", "c:\\windows\\rescache\\*", "c:\\windows\\provisioning\\*", "c:\\windows\\printdialog\\*", "c:\\windows\\policydefinitions\\*", "c:\\windows\\media\\*", "c:\\windows\\globalization\\*", "c:\\windows\\l2schemas\\*", "c:\\windows\\livekernelreports\\*", "c:\\windows\\modemlogs\\*", "c:\\windows\\immersivecontrolpanel\\*", "c:\\$recycle.bin\\*") and not process.parent.executable : ("c:\\windows\\system32\\driverstore\\filerepository\\*\\igfxcuiservice*.exe", "c:\\windows\\system32\\spacedeskservice.exe", "c:\\program files\\dell\\supportassistagent\\sre\\sre.exe") and not (process.name : "rundll32.exe" and process.args : ("uxtheme.dll,#64", "printui.dll,printuientry", "?:\\windows\\system32\\firewallcontrolpanel.dll,shownotificationdialog", "?:\\windows\\system32\\speech\\speechux\\sapi.cpl", "?:\\windows\\system32\\shell32.dll,openas_rundll")) and not (process.name : "cscript.exe" and process.args : "?:\\windows\\system32\\calluxxprovider.vbs") and not (process.name : "cmd.exe" and process.args : "?:\\windows\\system32\\powercfg.exe" and process.args : "?:\\windows\\inf\\powerplan.log") and not (process.name : "regsvr32.exe" and process.args : "?:\\windows\\help\\oem\\scripts\\checkmui.dll") and not (process.name : "cmd.exe" and process.parent.executable : ("?:\\windows\\system32\\oobe\\windeploy.exe", "?:\\program files (x86)\\ossec-agent\\wazuh-agent.exe", "?:\\windows\\system32\\igfxcuiservice.exe", "?:\\windows\\temp\\ie*.tmp\\ie*-support\\ienrcore.exe"))"
<li><a href="#">query = process where event.type == "start" and process.name == "defaults" and process.args == "write" and process.args in ("loginhook", "logouthook") and not process.args : ("support/jamf/managementframeworkscripts/logouthook.sh", "support/jamf/managementframeworkscripts/loginhook.sh", "/library/application support/jamf/managementframeworkscripts/logouthook.sh", "/library/application support/jamf/managementframeworkscripts/loginhook.sh")"
<li><a href="#">query = process where event.type == "start" and process.name in ("grep", "egrep") and user.id != "0" and process.args : ("parallels*", "vmware*", "virtualbox*") and process.args : "manufacturer*" and not process.parent.executable in ("/applications/docker.app/contents/macos/docker", "/usr/libexec/kcare/virt-what")"
<li><a href="#">query = process where event.type == "start" and process.name: ("cmd.exe", "powershell.exe") and process.parent.name: ("configurationwizard*.exe", "netflowdatabasemaintenance*.exe", "netflowservice*.exe", "solarwinds.administration*.exe", "solarwinds.collector.service*.exe", "solarwindsdiagnostics*.exe")"
<li><a href="#">query = process where event.type == "start" and process.name: ("powershell.exe", "pwsh.exe", "powershell_ise.exe") and process.args : "set-casmailbox*activesyncalloweddeviceids*"
<li><a href="#">query = process where event.type == "start" and process.name: ("powershell.exe", "pwsh.exe", "powershell_ise.exe") and process.command_line : ("*mailboxexportrequest*", "*-mailbox*-contentfilter*")"
<li><a href="#">query = process where event.type == "start" and process.parent.executable : "c:\\windows\\system32\\svchost.exe" and process.parent.args : "usosvc" and not process.executable : ("?:\\programdata\\microsoft\\windows\\uus\\packages\\*\\amd64\\mousocoreworker.exe", "?:\\windows\\system32\\usoclient.exe", "?:\\windows\\system32\\musnotification.exe", "?:\\windows\\system32\\musnotificationux.exe", "?:\\windows\\system32\\musnotifyicon.exe", "?:\\windows\\system32\\werfault.exe", "?:\\windows\\system32\\wermgr.exe", "?:\\windows\\uus\\amd64\\mousocoreworker.exe", "?:\\windows\\system32\\mousocoreworker.exe", "?:\\windows\\uus\\amd64\\usocoreworker.exe", "?:\\windows\\system32\\usocoreworker.exe", "?:\\program files\\common files\\microsoft shared\\clicktorun\\officec2rclient.exe") and not process.name : ("mousocoreworker.exe", "officec2rclient.exe")"
<li><a href="#">query = process where event.type == "start" and process.parent.name != null and ((process.name:"autochk.exe" and not process.parent.name:"smss.exe") or (process.name:("fontdrvhost.exe", "dwm.exe") and not process.parent.name:("wininit.exe", "winlogon.exe")) or (process.name:("consent.exe", "runtimebroker.exe", "tiworker.exe") and not process.parent.name:"svchost.exe") or (process.name:"searchindexer.exe" and not process.parent.name:"services.exe") or (process.name:"searchprotocolhost.exe" and not process.parent.name:("searchindexer.exe", "dllhost.exe")) or (process.name:"dllhost.exe" and not process.parent.name:("services.exe", "svchost.exe")) or (process.name:"smss.exe" and not process.parent.name:("system", "smss.exe")) or (process.name:"csrss.exe" and not process.parent.name:("smss.exe", "svchost.exe")) or (process.name:"wininit.exe" and not process.parent.name:"smss.exe") or (process.name:"winlogon.exe" and not process.parent.name:"smss.exe") or (process.name:("lsass.exe", "lsaiso.exe") and not process.parent.name:"wininit.exe") or (process.name:"logonui.exe" and not process.parent.name:("wininit.exe", "winlogon.exe")) or (process.name:"services.exe" and not process.parent.name:"wininit.exe") or (process.name:"svchost.exe" and not process.parent.name:("msmpeng.exe", "services.exe")) or (process.name:"spoolsv.exe" and not process.parent.name:"services.exe") or (process.name:"taskhost.exe" and not process.parent.name:("services.exe", "svchost.exe")) or (process.name:"taskhostw.exe" and not process.parent.name:("services.exe", "svchost.exe")) or (process.name:"userinit.exe" and not process.parent.name:("dwm.exe", "winlogon.exe")) or (process.name:("wmiprvse.exe", "wsmprovhost.exe", "winrshost.exe") and not process.parent.name:"svchost.exe") or (process.parent.name:("searchprotocolhost.exe", "taskhost.exe", "csrss.exe") and not process.name:("werfault.exe", "wermgr.exe", "werfaultsecure.exe")) or (process.parent.name:"autochk.exe" and not process.name:("chkdsk.exe", "doskey.exe", "werfault.exe")) or (process.parent.name:"smss.exe" and not process.name:("autochk.exe", "smss.exe", "csrss.exe", "wininit.exe", "winlogon.exe", "setupcl.exe", "werfault.exe")) or (process.parent.name:"wermgr.exe" and not process.name:("werfaultsecure.exe", "wermgr.exe", "werfault.exe")) or (process.parent.name:"conhost.exe" and not process.name:("mscorsvw.exe", "wermgr.exe", "werfault.exe", "werfaultsecure.exe")))"
<li><a href="#">query = process where event.type == "start" and process.parent.name : "compattelrunner.exe" and process.args : "-cv*" and not process.name : ("conhost.exe", "devicecensus.exe", "compattelrunner.exe", "dismhost.exe", "rundll32.exe", "powershell.exe")"
<li><a href="#">query = process where event.type == "start" and process.parent.name : "dns.exe" and not process.name : "conhost.exe"
<li><a href="#">query = process where event.type == "start" and process.parent.name : "eventvwr.exe" and not process.executable : ("?:\\windows\\syswow64\\mmc.exe", "?:\\windows\\system32\\mmc.exe", "?:\\windows\\syswow64\\werfault.exe", "?:\\windows\\system32\\werfault.exe")"
<li><a href="#">query = process where event.type == "start" and process.parent.name : "hh.exe" and process.name : ("mshta.exe", "cmd.exe", "powershell.exe", "pwsh.exe", "powershell_ise.exe", "cscript.exe", "wscript.exe")"
<li><a href="#">query = process where event.type == "start" and process.parent.name : "msbuild.exe" and process.name : ("csc.exe", "iexplore.exe", "powershell.exe")"
<li><a href="#">query = process where event.type == "start" and process.parent.name : "services.exe" and process.name : ("cmd.exe", "powershell.exe", "pwsh.exe", "powershell_ise.exe") and not process.args : "nvdisplay.containerlocalsystem"
<li><a href="#">query = process where event.type == "start" and process.parent.name : "spoolsv.exe" and (?process.ext.token.integrity_level_name : "system" or ?winlog.event_data.integritylevel : "system") and not process.name : ("splwow64.exe", "pdfcreator.exe", "acrodist.exe", "spoolsv.exe", "msiexec.exe", "route.exe", "werfault.exe") and not process.command_line : "*\\windows\\system32\\spool\\drivers*" and not (process.name : "net.exe" and process.command_line : ("*stop*", "*start*")) and not (process.name : ("cmd.exe", "powershell.exe") and process.command_line : ("*.spl*", "*\\program files*", "*route add*")) and not (process.name : "netsh.exe" and process.command_line : ("*add portopening*", "*rule name*")) and not (process.name : "regsvr32.exe" and process.command_line : "*printconfig.dll*")"
<li><a href="#">query = process where event.type == "start" and process.parent.name : "svchost.exe" and process.name : "cmd.exe" and not process.args : ("??:\\program files\\npcap\\checkstatus.bat?", "?:\\program files\\npcap\\checkstatus.bat", "\\system32\\cleanmgr.exe", "?:\\windows\\system32\\silcollector.cmd", "\\system32\\apphostregistrationverifier.exe", "\\system32\\servermanagerlauncher.exe", "dir", "?:\\program files\\*", "?:\\program files (x86)\\*", "?:\\windows\\lsdeployment\\lspush.exe", "(x86)\\fmauditonsite\\watchdog.bat", "?:\\programdata\\chocolatey\\bin\\choco-upgrade-all.bat", "files\\npcap\\checkstatus.bat") and not (process.parent.args : "netsvcs" and process.args : ("?:\\*.bat", "?:\\*.cmd"))"
<li><a href="#">query = process where event.type == "start" and process.parent.name : "svchost.exe" and process.parent.args : "bits" and not process.executable : ("?:\\windows\\system32\\werfaultsecure.exe", "?:\\windows\\system32\\werfault.exe", "?:\\windows\\system32\\wermgr.exe", "?:\\windows\\system32\\directxdatabaseupdater.exe")"
<li><a href="#">query = process where event.type == "start" and process.parent.name : "svchost.exe" and process.parent.args : "schedule" and process.pe.original_file_name in ("cscript.exe", "wscript.exe", "powershell.exe", "cmd.exe", "mshta.exe", "rundll32.exe", "regsvr32.exe", "msbuild.exe", "installutil.exe", "regasm.exe", "regsvcs.exe", "msxsl.exe", "control.exe", "explorer.exe", "microsoft.workflow.compiler.exe", "msiexec.exe") and process.args : ("c:\\users\\*", "c:\\programdata\\*", "c:\\windows\\temp\\*", "c:\\windows\\tasks\\*", "c:\\perflogs\\*", "c:\\intel\\*", "c:\\windows\\debug\\*", "c:\\hp\\*") and not (process.name : "cmd.exe" and process.args : "?:\\*.bat" and process.working_directory : "?:\\windows\\system32\\") and not (process.name : "cscript.exe" and process.args : "?:\\windows\\system32\\calluxxprovider.vbs") and not (process.name : "powershell.exe" and process.args : ("-file", "-psconsolefile") and user.id : "s-1-5-18") and not (process.name : "msiexec.exe" and user.id : "s-1-5-18")"
<li><a href="#">query = process where event.type == "start" and process.parent.name : "svchost.exe" and process.parent.args : ("wdisystemhost","licensemanager", "storsvc","cdpsvc","cdbhsvc","bthavctpsvc","sstpsvc","wdiservicehost", "imgsvc","trkwks","wpnservice","ikeext","policyagent","cryptsvc", "netprofm","profsvc","staterepository","camsvc","lanmanworkstation", "nlasvc","eventlog","hidserv","displayenhancementservice","shellhwdetection", "apphostsvc","fhsvc","cscservice","pushtoinstall") and not process.name : ("werfault.exe","werfaultsecure.exe","wermgr.exe") and not (process.executable : "?:\\windows\\system32\\relpost.exe" and process.parent.args : "wdisystemhost") and not (process.name : "rundll32.exe" and process.args : "?:\\windows\\system32\\winethc.dll,forceproxydetectiononnextrun" and process.parent.args : "wdiservicehost") and not (process.executable : ("?:\\program files\\*", "?:\\program files (x86)\\*", "?:\\windows\\system32\\kodak\\kds_i4x50\\lib\\lexexe.exe") and process.parent.args : "imgsvc")"
<li><a href="#">query = process where event.type == "start" and process.parent.name : "w3wp.exe" and process.parent.args : "msexchange*apppool" and (process.name : ("cmd.exe", "powershell.exe", "pwsh.exe", "powershell_ise.exe") or process.pe.original_file_name in ("cmd.exe", "powershell.exe", "pwsh.dll", "powershell_ise.exe"))"
<li><a href="#">query = process where event.type == "start" and process.parent.name : "werfault.exe" and (process.parent.args : "-s" and process.parent.args : "-t" and process.parent.args : "-c") and not process.executable : ("?:\\windows\\syswow64\\initcrypt.exe", "?:\\program files (x86)\\heimdal\\heimdal.guard.exe")"
<li><a href="#">query = process where event.type == "start" and process.parent.name : "wmiprvse.exe" and process.name : "cmd.exe" and process.args : "\\\\127.0.0.1\\*" and process.args : ("2>&1", "1>")"
<li><a href="#">query = process where event.type == "start" and process.parent.name : "zoom.exe" and process.name : ("cmd.exe", "powershell.exe", "pwsh.exe", "powershell_ise.exe")"
<li><a href="#">query = process where event.type == "start" and process.parent.name : ("cscript.exe", "wscript.exe") and process.name : "powershell.exe"
<li><a href="#">query = process where event.type == "start" and process.parent.name : ("umservice.exe", "umworkerprocess.exe") and not process.executable : ("?:\\windows\\system32\\werfault.exe", "?:\\windows\\system32\\wermgr.exe", "?:\\program files\\microsoft\\exchange server\\v??\\bin\\umworkerprocess.exe", "d:\\exchange 2016\\bin\\umworkerprocess.exe", "e:\\exchangeserver\\bin\\umworkerprocess.exe")"
<li><a href="#">query = process where event.type == "start" and process.parent.name : ("utilman.exe", "winlogon.exe") and user.name == "system" and process.args : ("c:\\windows\\system32\\osk.exe", "c:\\windows\\system32\\magnify.exe", "c:\\windows\\system32\\narrator.exe", "c:\\windows\\system32\\sethc.exe", "utilman.exe", "atbroker.exe", "displayswitch.exe", "sethc.exe") and not process.pe.original_file_name in ("osk.exe", "sethc.exe", "utilman2.exe", "displayswitch.exe", "atbroker.exe", "screenmagnifier.exe", "sr.exe", "narrator.exe", "magnify.exe", "magnify.exe")"
<li><a href="#">query = process where event.type == "start" and process.parent.name : ("w3wp.exe", "httpd.exe", "nginx.exe", "php.exe", "php-cgi.exe", "tomcat.exe") and process.name : ("cmd.exe", "cscript.exe", "powershell.exe", "pwsh.exe", "powershell_ise.exe", "wmic.exe", "wscript.exe")"
<li><a href="#">query = process where event.type == "start" and process.parent.name == "dllhost.exe" and process.parent.args in ("/processid:{3e5fc7f9-9a51-4367-9063-a120244fbec7}", "/processid:{d2e7041b-2927-42fb-8e9f-7ce93b6dc937}") and process.pe.original_file_name != "werfault.exe"
<li><a href="#">query = process where event.type == "start" and process.parent.name == "mmc.exe" and process.parent.args == "wf.msc" and process.name != "werfault.exe"
<li><a href="#">query = process where event.type == "start" and process.parent.name == "screensaverengine"
<li><a href="#">query = process where event.type == "start" and process.parent.name: ("solarwinds.businesslayerhost.exe", "solarwinds.businesslayerhostx64.exe") and not process.name : ("apmservicecontrol*.exe", "exporttopdfcmd*.exe", "solarwinds.credentials.orion.webapi*.exe", "solarwinds.orion.topology.calculator*.exe", "database-maint.exe", "solarwinds.orion.apipoller.service.exe", "werfault.exe", "wermgr.exe", "solarwinds.businesslayerhost.exe", "solarwinds.businesslayerhostx64.exe") and not process.executable : ("?:\\windows\\syswow64\\arp.exe", "?:\\windows\\syswow64\\lodctr.exe", "?:\\windows\\syswow64\\unlodctr.exe")"
<li><a href="#">query = process where event.type == "start" and process.parent.pid == 4 and not process.executable : ("registry", "memcompression", "?:\\windows\\system32\\smss.exe")"
<li><a href="#">query = process where event.type == "start" and process.pe.original_file_name : "autoit*.exe" and not process.name : "autoit*.exe"
<li><a href="#">query = process where event.type == "start" and process.pe.original_file_name : "psexesvc.exe" and not process.name : "psexesvc.exe"
<li><a href="#">query = process where event.type == "start" and process.pe.original_file_name : "xwizard.exe" and ((process.args : "runwizard" and process.args : "{*}") or (process.executable != null and not process.executable : ("c:\\windows\\syswow64\\xwizard.exe", "c:\\windows\\system32\\xwizard.exe")))"
<li><a href="#">query = process where event.type == "start" and process.pe.original_file_name == "msbuild.exe" and not process.name : "msbuild.exe"
<li><a href="#">query = process where event.type == "start" and process.pe.original_file_name == "reg.exe" and process.args : ("save", "export") and process.args : ("hklm\\sam", "hklm\\security")"
<li><a href="#">query = process where event.type == "start" and process.pe.original_file_name in ("cmd.exe", "powershell.exe") and process.args : "echo" and process.args : ">" and process.args : "\\\\.\\pipe\\*"
<li><a href="#">query = process where event.type == "start" and process.pe.original_file_name in ("winword.exe", "explorer.exe", "w3wp.exe", "dism.exe") and not (process.name : ("winword.exe", "explorer.exe", "w3wp.exe", "dism.exe") or process.executable : ("?:\\windows\\explorer.exe", "?:\\program files\\microsoft office\\root\\office*\\winword.exe", "?:\\program files?(x86)\\microsoft office\\root\\office*\\winword.exe", "?:\\windows\\system32\\dism.exe", "?:\\windows\\syswow64\\dism.exe", "?:\\windows\\system32\\inetsrv\\w3wp.exe"))"
<li><a href="#">query = process where event.type == "start" and user.id == "0" and process.executable regex~/var/run/\w+\.(pid|lock|reboot)"
<li><a href="#">query = process where event.type == "start" and user.name == "root" and process.executable : "/usr/bin/chattr" and process.args : ("-*i*", "+*i*") and not process.parent.executable: "/lib/systemd/systemd"
<li><a href="#">query = process where event.type in ("start", "process_started") and (((process.args : ("rm", "echo") or (process.args : "ln" and process.args : "-sf" and process.args : "/dev/null") or (process.args : "truncate" and process.args : "-s0")) and process.args : (".bash_history", "/root/.bash_history", "/home/*/.bash_history","/users/.bash_history", "/users/*/.bash_history", ".zsh_history", "/root/.zsh_history", "/home/*/.zsh_history", "/users/.zsh_history", "/users/*/.zsh_history")) or (process.name : "history" and process.args : "-c") or (process.args : "export" and process.args : ("histfile=/dev/null", "histfilesize=0")) or (process.args : "unset" and process.args : "histfile") or (process.args : "set" and process.args : "history" and process.args : "+o"))"
<li><a href="#">query = process where event.type in ("start", "process_started") and ((process.name : "networksetup" and process.args : "-connectpppoeservice") or (process.name : "scutil" and process.args : "--nc" and process.args : "start") or (process.name : "osascript" and process.command_line : "osascript*set vpn to service*"))"
<li><a href="#">query = process where event.type in ("start", "process_started") and (process.name : "mount_smbfs" or (process.name : "open" and process.args : "smb://*") or (process.name : "mount" and process.args : "smbfs") or (process.name : "osascript" and process.command_line : "osascript*mount volume*smb://*")) and not process.parent.executable : "/applications/google drive.app/contents/macos/google drive"
<li><a href="#">query = process where event.type in ("start", "process_started") and (process.name : ("ldapsearch", "dsmemberutil") or (process.name : "dscl" and process.args : ("read", "-read", "list", "-list", "ls", "search", "-search") and process.args : ("/active directory/*", "/users*", "/groups*"))) and not process.parent.executable : ("/applications/nomad.app/contents/macos/nomad", "/applications/zoompresence.app/contents/macos/zoompresence", "/applications/sourcetree.app/contents/macos/sourcetree", "/library/application support/jamf/jamf.app/contents/macos/jamfdaemon.app/contents/macos/jamfdaemon", "/applications/jamf connect.app/contents/macos/jamf connect", "/usr/local/jamf/bin/jamf", "/library/application support/airwatch/hubd", "/opt/jc/bin/jumpcloud-agent", "/applications/eset endpoint antivirus.app/contents/macos/esets_daemon", "/applications/eset endpoint security.app/contents/macos/esets_daemon", "/library/privilegedhelpertools/com.fortinet.forticlient.uninstall_helper")"
<li><a href="#">query = process where event.type in ("start", "process_started") and process.args : "dump-keychain" and process.args : "-d"
<li><a href="#">query = process where event.type in ("start", "process_started") and process.args : ("/users/*/library/application support/google/chrome/default/login data", "/users/*/library/application support/google/chrome/default/cookies", "/users/*/library/application support/google/chrome/profile*/cookies", "/users/*/library/cookies*", "/users/*/library/application support/firefox/profiles/*.default/cookies.sqlite", "/users/*/library/application support/firefox/profiles/*.default/key*.db", "/users/*/library/application support/firefox/profiles/*.default/logins.json", "login data", "cookies.binarycookies", "key4.db", "key3.db", "logins.json", "cookies.sqlite")"
<li><a href="#">query = process where event.type in ("start", "process_started") and process.args : ("/users/*/library/keychains/*", "/library/keychains/*", "/network/library/keychains/*", "system.keychain", "login.keychain-db", "login.keychain") and not process.args : ("find-certificate", "add-trusted-cert", "set-keychain-settings", "delete-certificate", "/users/*/library/keychains/openvpn.keychain-db", "show-keychain-info", "lock-keychain", "set-key-partition-list", "import", "find-identity") and not process.parent.executable : ("/applications/openvpn connect/openvpn connect.app/contents/macos/openvpn connect", "/applications/microsoft defender.app/contents/macos/wdavdaemon_enterprise.app/contents/macos/wdavdaemon_enterprise", "/opt/jc/bin/jumpcloud-agent") and not process.executable : "/opt/jc/bin/jumpcloud-agent"
<li><a href="#">query = process where event.type in ("start", "process_started") and process.name : "osascript" and process.command_line : "osascript*display dialog*password*"
<li><a href="#">query = process where event.type in ("start", "process_started") and process.name : "osascript" and process.command_line : "osascript*login item*hidden:true*"
<li><a href="#">query = process where event.type in ("start", "process_started") and process.name : "osascript" and process.command_line : "osascript*with administrator privileges"
<li><a href="#">query = process where event.type in ("start", "process_started") and process.name : "pluginkit" and process.args : "-e" and process.args : "use" and process.args : "-i" and not process.args : ("com.google.googledrive.findersyncapiextension", "com.google.drivefs.findersync", "com.boxcryptor.osx.rednif", "com.adobe.accmac.accfindersync", "com.microsoft.onedrive.findersync", "com.insynchq.insync.insync-finder-integration", "com.box.desktop.findersyncext") and not process.parent.executable : ("/library/application support/idriveformac/idrivehelpertools/finderpluginapp.app/contents/macos/finderpluginapp")"
<li><a href="#">query = process where event.type in ("start", "process_started") and process.name : "python*" and process.args : "-c" and process.args : "*import*sys*"
<li><a href="#">query = process where event.type in ("start", "process_started") and process.name : "sqlite*" and process.args : "/*/application support/com.apple.tcc/tcc.db" and not process.parent.executable : "/library/bitdefender/avp/product/bin/*"
<li><a href="#">query = process where event.type in ("start", "process_started") and process.name : "xattr" and ((process.args : "com.apple.quarantine" and process.args : ("-d", "-w")) or (process.args : "-c") or (process.command_line : ("/bin/bash -c xattr -c *", "/bin/zsh -c xattr -c *", "/bin/sh -c xattr -c *"))) and not process.args_count > 12"
<li><a href="#">query = process where event.type in ("start", "process_started") and process.name in ("sh", "bash", "zsh", "dash", "zmodload") and process.args : ("*/dev/tcp/*", "*/dev/udp/*", "*zsh/net/tcp*", "*zsh/net/udp*") and not (process.parent.name : "timeout" and process.executable : "/var/lib/docker/overlay*") and not process.command_line : ("*/dev/tcp/sirh_db/*", "*/dev/tcp/remoteiot.com/*", "*dev/tcp/elk.stag.one/*", "*dev/tcp/kafka/*", "*/dev/tcp/$0/$1*", "*/dev/tcp/127.*", "*/dev/udp/127.*", "*/dev/tcp/localhost/*") and not process.parent.command_line : "runc init"
<li><a href="#">query = process where event.type in ("start", "process_started") and process.name:"scp" and process.args:"stricthostkeychecking=no" and process.command_line:("scp *localhost:/*", "scp *127.0.0.1:/*") and not process.args:"vagrant@*127.0.0.1*"
<li><a href="#">query = process where event.type in ("start", "process_started") and process.parent.name : "emond" and process.name : ("bash", "dash", "sh", "tcsh", "csh", "zsh", "ksh", "fish", "python", "python*", "perl*", "php*", "osascript", "pwsh", "curl", "wget", "cp", "mv", "touch", "echo", "base64", "launchctl")"
<li><a href="#">query = process where event.type in ("start", "process_started") and process.parent.name : "java" and process.name : ("sh", "bash", "dash", "ksh", "tcsh", "zsh", "curl", "wget")"
<li><a href="#">query = process where event.type in ("start", "process_started") and process.parent.name : ("google chrome", "google chrome helper*", "firefox", "opera", "safari", "com.apple.webkit.webcontent", "microsoft edge") and process.name : ("sh", "bash", "dash", "ksh", "tcsh", "zsh", "curl", "wget", "python*", "perl*", "php*", "osascript", "pwsh") and process.command_line != null and not process.command_line : "*/library/application support/microsoft/mau*/microsoft autoupdate.app/contents/macos/msupdate*" and not process.args : ("hw.model", "ioplatformexpertdevice", "/volumes/google chrome/google chrome.app/contents/frameworks/*/resources/install.sh", "--defaults-torrc", "*chrome.app", "framework.framework/versions/*/resources/keystone_promote_preflight.sh", "/users/*/library/application support/google/chrome/recovery/*/chromerecovery", "$display", "*gio_launched_desktop_file_pid=$$*", "/opt/homebrew/*", "/usr/local/*brew*")"
<li><a href="#">query = process where event.type in ("start", "process_started") and process.parent.name:("microsoft word", "microsoft powerpoint", "microsoft excel") and process.name: ("bash", "dash", "sh", "tcsh", "csh", "zsh", "ksh", "fish", "python*", "perl*", "php*", "osascript", "pwsh", "curl", "wget", "cp", "mv", "base64", "launchctl") and not process.args: ("productversion", "hw.model", "ioreg", "productname", "productuservisibleversion", "productbuildversion", "/library/application support/microsoft/merp*/microsoft error reporting.app/contents/macos/microsoft error reporting")"
<li><a href="#">query = process where event.type in ("start", "process_started") and process.working_directory in ("/tmp", "/var/tmp", "/dev/shm") and process.args regex~\.[a-z0-9_\-][a-z0-9_\-\.]{1,254}" and not process.name in ("ls", "find", "grep")"
<li><a href="#">query = process where event.type in ("start", "process_started", "info") and process.name in ("microsoft edge", "chrome.exe", "google chrome", "google-chrome-stable", "google-chrome-beta", "google-chrome", "msedge.exe") and process.args : ("--remote-debugging-port=*", "--remote-debugging-targets=*", "--remote-debugging-pipe=*") and process.args : "--user-data-dir=*" and not process.args:"--remote-debugging-port=0"
<li><a href="#">query = process where event.type in ("start","process_created") and process.pe.original_file_name in ("cmd.exe","powershell.exe") and process.args : ("*mklink*", "*symboliclink*") and process.command_line : ("*harddiskvolumeshadowcopy*")"
<li><a href="#">query = process where host.os.type:("linux","macos") and event.type == "start" and (process.executable regex~/[a-z0-9\s_\-\\./]+\s") and not process.name in ("ls", "find", "grep", "xkbcomp")"
<li><a href="#">query = process.name:msbuild.exe and event.action:"createremotethread detected (rule: createremotethread)"
<li><a href="#">query = registry where event.type : ("creation", "change") and registry.path : ("hklm\\system\\*controlset*\\control\\securityproviders\\wdigest\\uselogoncredential", "\\registry\\machine\\system\\*controlset*\\control\\securityproviders\\wdigest\\uselogoncredential") and registry.data.strings : ("1", "0x00000001") and not (process.executable : "?:\\windows\\system32\\svchost.exe" and user.id : "s-1-5-18")"
<li><a href="#">query = registry where event.type == "change" and registry.path : "hklm\\system\\*controlset*\\control\\lsa\\authentication packages" and not user.id : "s-1-5-18"
<li><a href="#">query = registry where event.type == "change" and registry.path : ("hklm\\software\\microsoft\\windows\\currentversion\\policies\\system\\enablelua", "hklm\\software\\microsoft\\windows\\currentversion\\policies\\system\\consentpromptbehavioradmin", "hklm\\software\\microsoft\\windows\\currentversion\\policies\\system\\promptonsecuredesktop") and registry.data.strings : ("0", "0x00000000")"
<li><a href="#">query = registry where event.type == "change" and registry.path : ("hklm\\software\\policies\\microsoft\\windows\\powershell\\scriptblocklogging\\enablescriptblocklogging", "\\registry\\machine\\software\\policies\\microsoft\\windows\\powershell\\scriptblocklogging\\enablescriptblocklogging") and registry.data.strings : ("0", "0x00000000")"
<li><a href="#">query = registry where event.type == "change" and registry.path : ("hku\\s-1-5-21-*\\software\\microsoft\\office\\*\\security\\accessvbom", "hku\\s-1-5-21-*\\software\\microsoft\\office\\*\\security\\vbawarnings", "hku\\s-1-12-1-*\\software\\microsoft\\office\\*\\security\\accessvbom", "hku\\s-1-12-1-*\\software\\microsoft\\office\\*\\security\\vbawarnings", "\\registry\\user\\s-1-5-21-*\\software\\microsoft\\office\\*\\security\\accessvbom", "\\registry\\user\\s-1-5-21-*\\software\\microsoft\\office\\*\\security\\vbawarnings", "\\registry\\user\\s-1-12-1-*\\software\\microsoft\\office\\*\\security\\accessvbom", "\\registry\\user\\s-1-12-1-*\\software\\microsoft\\office\\*\\security\\vbawarnings") and registry.data.strings : ("0x00000001", "1") and process.name : ("cscript.exe", "wscript.exe", "mshta.exe", "mshta.exe", "winword.exe", "excel.exe")"
<li><a href="#">query = registry where event.type in ("creation", "change") and ((registry.path: ("hklm\\software\\policies\\microsoft\\windows defender\\disableantispyware", "\\registry\\machine\\software\\policies\\microsoft\\windows defender\\disableantispyware") and registry.data.strings: ("1", "0x00000001")) or (registry.path: ("hklm\\system\\*controlset*\\services\\windefend\\start", "\\registry\\machine\\system\\*controlset*\\services\\windefend\\start") and registry.data.strings in ("3", "4", "0x00000003", "0x00000004"))) and not process.executable : ("?:\\windows\\system32\\services.exe", "?:\\windows\\system32\\svchost.exe", "?:\\program files (x86)\\trend micro\\security agent\\ntrmv.exe")"
<li><a href="#">query = registry where event.type in ("creation", "change") and (registry.path : "*\\software\\policies\\microsoft\\edge\\builtindnsclientenabled" and registry.data.strings : "1") or (registry.path : "*\\software\\google\\chrome\\dnsoverhttpsmode" and registry.data.strings : "secure") or (registry.path : "*\\software\\policies\\mozilla\\firefox\\dnsoverhttps" and registry.data.strings : "1")"
<li><a href="#">query = registry where event.type in ("creation", "change") and (registry.path : "hklm\\software\\policies\\microsoft\\windows defender\\puaprotection" and registry.data.strings : ("0", "0x00000000")) or (registry.path : "hklm\\software\\policies\\microsoft\\windows defender security center\\app and browser protection\\disallowexploitprotectionoverride" and registry.data.strings : ("0", "0x00000000")) or (registry.path : "hklm\\software\\policies\\microsoft\\windows defender\\disableantispyware" and registry.data.strings : ("1", "0x00000001")) or (registry.path : "hklm\\software\\policies\\microsoft\\windows defender\\features\\tamperprotection" and registry.data.strings : ("0", "0x00000000")) or (registry.path : "hklm\\software\\policies\\microsoft\\windows defender\\real-time protection\\disablerealtimemonitoring" and registry.data.strings : ("1", "0x00000001")) or (registry.path : "hklm\\software\\policies\\microsoft\\windows defender\\real-time protection\\disableintrusionpreventionsystem" and registry.data.strings : ("1", "0x00000001")) or (registry.path : "hklm\\software\\policies\\microsoft\\windows defender\\real-time protection\\disablescriptscanning" and registry.data.strings : ("1", "0x00000001")) or (registry.path : "hklm\\software\\policies\\microsoft\\windows defender\\windows defender exploit guard\\controlled folder access\\enablecontrolledfolderaccess" and registry.data.strings : ("0", "0x00000000")) or (registry.path : "hklm\\software\\policies\\microsoft\\windows defender\\real-time protection\\disableioavprotection" and registry.data.strings : ("1", "0x00000001")) or (registry.path : "hklm\\software\\policies\\microsoft\\windows defender\\reporting\\disableenhancednotifications" and registry.data.strings : ("1", "0x00000001")) or (registry.path : "hklm\\software\\policies\\microsoft\\windows defender\\spynet\\disableblockatfirstseen" and registry.data.strings : ("1", "0x00000001")) or (registry.path : "hklm\\software\\policies\\microsoft\\windows defender\\spynet\\spynetreporting" and registry.data.strings : ("0", "0x00000000")) or (registry.path : "hklm\\software\\policies\\microsoft\\windows defender\\spynet\\submitsamplesconsent" and registry.data.strings : ("0", "0x00000000")) or (registry.path : "hklm\\software\\policies\\microsoft\\windows defender\\real-time protection\\disablebehaviormonitoring" and registry.data.strings : ("1", "0x00000001"))"
<li><a href="#">query = registry where event.type in ("creation", "change") and registry.path : "hklm\\system\\*controlset*\\control\\terminal server\\fdenytsconnections" and registry.data.strings : ("0", "0x00000000") and not (process.name : "svchost.exe" and user.domain == "nt authority") and not process.executable : "c:\\windows\\system32\\systempropertiesremote.exe"
<li><a href="#">query = registry where event.type in ("creation", "change") and registry.path : "hklm\\system\\*controlset*\\services\\lanmanserver\\parameters\\nullsessionpipes" and length(registry.data.strings) > 0"
<li><a href="#">query = registry where event.type in ("creation", "change") and registry.path : ("hkey_users\\*\\software\\microsoft\\windows script\\settings\\amsienable", "hku\\*\\software\\microsoft\\windows script\\settings\\amsienable", "\\registry\\user\\*\\software\\microsoft\\windows script\\settings\\amsienable") and registry.data.strings: ("0", "0x00000000")"
<li><a href="#">query = registry where event.type in ("creation", "change") and registry.path : ("hklm\\software\\microsoft\\systemcertificates\\root\\certificates\\*\\blob", "hklm\\software\\microsoft\\systemcertificates\\authroot\\certificates\\*\\blob", "hklm\\software\\policies\\microsoft\\systemcertificates\\root\\certificates\\*\\blob", "hklm\\software\\policies\\microsoft\\systemcertificates\\authroot\\certificates\\*\\blob", "\\registry\\machine\\software\\microsoft\\systemcertificates\\root\\certificates\\*\\blob", "\\registry\\machine\\software\\microsoft\\systemcertificates\\authroot\\certificates\\*\\blob", "\\registry\\machine\\software\\policies\\microsoft\\systemcertificates\\root\\certificates\\*\\blob", "\\registry\\machine\\software\\policies\\microsoft\\systemcertificates\\authroot\\certificates\\*\\blob") and not process.executable : ("?:\\program files\\*.exe", "?:\\program files (x86)\\*.exe", "?:\\windows\\system32\\*.exe", "?:\\windows\\syswow64\\*.exe", "?:\\windows\\sysmon64.exe", "?:\\windows\\sysmon.exe", "?:\\programdata\\microsoft\\windows defender\\platform\\*\\msmpeng.exe", "?:\\windows\\winsxs\\*.exe", "?:\\windows\\uus\\amd64\\mousocoreworker.exe")"
<li><a href="#">query = registry where event.type in ("creation", "change") and registry.path : ("hklm\\system\\*controlset*\\control\\print\\monitors\\*", "hklm\\system\\*controlset*\\control\\print\\environments\\windows*\\print processors\\*") and registry.data.strings : "*.dll" and not user.id : "s-1-5-18"
<li><a href="#">query = registry where event.type:"change" and registry.path: ("*\\software\\microsoft\\cryptography\\oid\\encodingtype 0\\cryptsipdllputsigneddatamsg\\{*}\\dll", "*\\software\\wow6432node\\microsoft\\cryptography\\oid\\encodingtype 0\\cryptsipdllputsigneddatamsg\\{*}\\dll", "*\\software\\microsoft\\cryptography\\providers\\trust\\finalpolicy\\{*}\\$dll", "*\\software\\wow6432node\\microsoft\\cryptography\\providers\\trust\\finalpolicy\\{*}\\$dll") and registry.data.strings:"*.dll"
<li><a href="#">query = registry where event.type:"change" and registry.path:"hklm\\system\\*controlset*\\services\\w32time\\timeproviders\\*" and registry.data.strings:"*.dll"
<li><a href="#">query = registry where length(registry.data.strings) > 0 and registry.path : ("hklm\\software\\microsoft\\windows nt\\currentversion\\image file execution options\\*.exe\\debugger", "hklm\\software\\wow6432node\\microsoft\\windows nt\\currentversion\\image file execution options\\*\\debugger", "hklm\\software\\microsoft\\windows nt\\currentversion\\silentprocessexit\\*\\monitorprocess", "hklm\\software\\wow6432node\\microsoft\\windows nt\\currentversion\\silentprocessexit\\*\\monitorprocess") and not registry.data.strings regex~ ("c:\\program files(\(x86\))?\\thinkiosk\\thinkiosk\.exe",.*\\psappdeploytoolkit\\.*")"
<li><a href="#">query = registry where registry.data.strings != null and process.name : "wmiprvse.exe" and registry.path : ("hkey_users\\*\\software\\microsoft\\windows\\currentversion\\run\\*", "hklm\\software\\microsoft\\windows\\currentversion\\run\\*", "hklm\\software\\wow6432node\\microsoft\\windows\\currentversion\\run\\*", "hkey_users\\*\\software\\microsoft\\windows\\currentversion\\policies\\explorer\\run\\*", "hklm\\software\\microsoft\\windows\\currentversion\\policies\\explorer\\run\\*", "hklm\\software\\microsoft\\windows\\currentversion\\runonce\\*", "hklm\\software\\microsoft\\windows\\currentversion\\runonceex\\*", "hkey_users\\*\\software\\microsoft\\windows\\currentversion\\runonce\\*", "hkey_users\\*\\software\\microsoft\\windows\\currentversion\\runonceex\\*", "hklm\\system\\*controlset*\\services\\*\\servicedll", "hklm\\system\\*controlset*\\services\\*\\imagepath", "hkey_users\\*\\software\\microsoft\\windows nt\\currentversion\\winlogon\\shell\\*", "hkey_users\\*\\environment\\userinitmprlogonscript", "hkey_users\\*\\software\\microsoft\\windows nt\\currentversion\\windows\\load", "hkey_users\\*\\software\\microsoft\\windows nt\\currentversion\\winlogon\\shell", "hkey_users\\*\\software\\microsoft\\windows\\currentversion\\policies\\system\\shell", "hkey_users\\*\\software\\policies\\microsoft\\windows\\system\\scripts\\logoff\\script", "hkey_users\\*\\software\\policies\\microsoft\\windows\\system\\scripts\\logon\\script", "hkey_users\\*\\software\\policies\\microsoft\\windows\\system\\scripts\\shutdown\\script", "hkey_users\\*\\software\\policies\\microsoft\\windows\\system\\scripts\\startup\\script", "hkey_users\\*\\software\\microsoft\\ctf\\langbaraddin\\*\\filepath", "hkey_users\\*\\software\\microsoft\\internet explorer\\extensions\\*\\exec", "hkey_users\\*\\software\\microsoft\\internet explorer\\extensions\\*\\script", "hkey_users\\*\\software\\microsoft\\command processor\\autorun")"
<li><a href="#">query = registry where registry.data.strings != null and registry.path : ("hklm\\software\\microsoft\\windows\\currentversion\\run\\*", "hklm\\software\\microsoft\\windows\\currentversion\\runonce\\*", "hklm\\software\\microsoft\\windows\\currentversion\\runonceex\\*", "hklm\\software\\microsoft\\windows\\currentversion\\policies\\explorer\\run\\*", "hklm\\software\\microsoft\\windows nt\\currentversion\\winlogon\\shell\\*", "hkey_users\\*\\software\\microsoft\\windows\\currentversion\\run\\*", "hkey_users\\*\\software\\microsoft\\windows\\currentversion\\runonce\\*", "hkey_users\\*\\software\\microsoft\\windows\\currentversion\\runonceex\\*", "hkey_users\\*\\software\\microsoft\\windows\\currentversion\\policies\\explorer\\run\\*", "hkey_users\\*\\software\\microsoft\\windows nt\\currentversion\\winlogon\\shell\\*") and not registry.data.strings : "ctfmon.exe /n" and not (registry.value : "application restart #*" and process.name : "csrss.exe") and user.id not in ("s-1-5-18", "s-1-5-19", "s-1-5-20") and not registry.data.strings : ("?:\\program files\\*.exe", "?:\\program files (x86)\\*.exe") and not process.executable : ("?:\\windows\\system32\\msiexec.exe", "?:\\windows\\syswow64\\msiexec.exe") and not (process.name : "onedrivesetup.exe" and registry.value : ("delete cached standalone update binary", "delete cached update binary", "amd64", "uninstall *") and registry.data.strings : "?:\\windows\\system32\\cmd.exe /q /c * \"?:\\users\\*\\appdata\\local\\microsoft\\onedrive\\*\)"
<li><a href="#">query = registry where registry.data.strings != null and registry.path : ("hklm\\system\\*controlset*\\services\\*\\networkprovider\\providerpath", "\\registry\\machine\\system\\*controlset*\\services\\*\\networkprovider\\providerpath") and not (user.id : "s-1-5-18" and registry.data.strings in ("%systemroot%\\system32\\ntlanman.dll", "%systemroot%\\system32\\drprov.dll", "%systemroot%\\system32\\davclnt.dll"))"
<li><a href="#">query = registry where registry.data.strings : "tvqqaamaaaaeaaaa*"
<li><a href="#">query = registry where registry.path : "hklm\\sam\\sam\\domains\\account\\users\\names\\*$\\"
<li><a href="#">query = registry where registry.path : "hklm\\software\\microsoft\\windows\\windows error reporting\\localdumps\\dumptype" and registry.data.strings : ("2", "0x00000002") and not (process.executable : "?:\\windows\\system32\\svchost.exe" and user.id : ("s-1-5-18", "s-1-5-19", "s-1-5-20"))"
<li><a href="#">query = registry where registry.path : "hklm\\system\\*controlset*\\control\\session manager\\appcertdlls\\*"
<li><a href="#">query = registry where registry.path : "hklm\\system\\controlset*\\services\\*\\imagepath" and registry.data.strings : ("%comspec%*", "*\\.\\pipe\\*")"
<li><a href="#">query = registry where registry.path : ("hkey_users\\*\\environment\\windir", "hkey_users\\*\\environment\\systemroot") and not registry.data.strings : ("c:\\windows", "%systemroot%")"
<li><a href="#">query = registry where registry.path : ("hkey_users\\*\\software\\microsoft\\windows\\currentversion\\run\\", "hku\\*\\software\\microsoft\\windows\\currentversion\\run\\", "hklm\\software\\microsoft\\windows\\currentversion\\run\\", "hklm\\software\\wow6432node\\microsoft\\windows\\currentversion\\run\\", "hkey_users\\*\\software\\microsoft\\windows\\currentversion\\policies\\explorer\\run\\", "hku\\*\\software\\microsoft\\windows\\currentversion\\policies\\explorer\\run\\", "hklm\\software\\microsoft\\windows\\currentversion\\policies\\explorer\\run\\")"
<li><a href="#">query = registry where registry.path : ("hklm\\*\\localaccounttokenfilterpolicy", "\\registry\\machine\\*\\localaccounttokenfilterpolicy") and registry.data.strings : ("1", "0x00000001")"
<li><a href="#">query = registry where registry.path : ("hklm\\software\\microsoft\\windows nt\\currentversion\\schedule\\configuration\\enableat", "\\registry\\machine\\software\\microsoft\\windows nt\\currentversion\\schedule\\configuration\\enableat") and registry.data.strings : ("1", "0x00000001")"
<li><a href="#">query = registry where registry.path : ("hklm\\software\\microsoft\\windows nt\\currentversion\\windows\\appinit_dlls", "hklm\\software\\wow6432node\\microsoft\\windows nt\\currentversion\\windows\\appinit_dlls") and not process.executable : ("c:\\windows\\system32\\msiexec.exe", "c:\\windows\\syswow64\\msiexec.exe", "c:\\program files\\commvault\\contentstore*\\base\\cvd.exe", "c:\\program files (x86)\\commvault\\contentstore*\\base\\cvd.exe")"
<li><a href="#">query = registry where registry.path : ("hklm\\software\\microsoft\\windows\\currentversion\\explorer\\user shell folders\\common startup", "hklm\\software\\microsoft\\windows\\currentversion\\explorer\\shell folders\\common startup", "hkey_users\\*\\software\\microsoft\\windows\\currentversion\\explorer\\user shell folders\\startup", "hkey_users\\*\\software\\microsoft\\windows\\currentversion\\explorer\\shell folders\\startup") and registry.data.strings != null and not registry.data.strings : ("c:\\programdata\\microsoft\\windows\\start menu\\programs\\startup", "%programdata%\\microsoft\\windows\\start menu\\programs\\startup", "%userprofile%\\appdata\\roaming\\microsoft\\windows\\start menu\\programs\\startup", "c:\\users\\*\\appdata\\roaming\\microsoft\\windows\\start menu\\programs\\startup")"
<li><a href="#">query = registry where registry.path : ("hklm\\system\\*controlset*\\control\\lsa\\security packages*", "hklm\\system\\*controlset*\\control\\lsa\\osconfig\\security packages*") and not process.executable : ("c:\\windows\\system32\\msiexec.exe", "c:\\windows\\syswow64\\msiexec.exe")"
<li><a href="#">query = registry where registry.path : ("hklm\\system\\*controlset*\\services\\*\\start", "\\registry\\machine\\system\\*controlset*\\services\\*\\start") and registry.data.strings : ("4", "0x00000004") and process.name : ("solarwinds.businesslayerhost*.exe", "configurationwizard*.exe", "netflowdatabasemaintenance*.exe", "netflowservice*.exe", "solarwinds.administration*.exe", "solarwinds.collector.service*.exe", "solarwindsdiagnostics*.exe")"
<li><a href="#">query = registry where registry.path : ("hklm\\system\\*controlset*\\services\\portproxy\\v4tov4\\*", "\\registry\\machine\\system\\*controlset*\\services\\portproxy\\v4tov4\\*")"
<li><a href="#">query = registry where registry.path : ("hklm\\system\\controlset*\\services\\*\\servicedll", "hklm\\system\\controlset*\\services\\*\\imagepath") and not registry.data.strings : ("?:\\windows\\system32\\drivers\\*.sys", "\\systemroot\\system32\\drivers\\*.sys", "\\??\\?:\\windows\\system32\\drivers\\*.sys", "system32\\drivers\\usbstor") and not (process.name : "procexp??.exe" and registry.data.strings : "?:\\*\\procexp*.sys") and not process.executable : ("?:\\program files\\*.exe", "?:\\program files (x86)\\*.exe", "?:\\windows\\system32\\svchost.exe", "?:\\windows\\winsxs\\*\\tiworker.exe", "?:\\windows\\system32\\drvinst.exe", "?:\\windows\\system32\\services.exe", "?:\\windows\\system32\\msiexec.exe", "?:\\windows\\system32\\regsvr32.exe")"
<li><a href="#">query = registry where user.domain != "nt authority" and ((registry.path : "hk*\\inprocserver32\\" and registry.data.strings: ("scrobj.dll", "c:\\*\\scrobj.dll") and not registry.path : "*\\{06290bd*-48aa-11d2-8432-006008c3fbfc}\\*") or (registry.path : ("hkey_users\\*\\inprocserver32\\*", "hkey_users\\*\\localserver32\\*", "hkey_users\\*\\delegateexecute\\*", "hkey_users\\*\\treatas\\*", "hkey_users\\*\\scriptleturl\\*") and not (process.executable : "?:\\program files*\\veeam\\backup and replication\\console\\veeam.backup.shell.exe" and registry.path : "hkey_users\\s-1-*_classes\\clsid\\*\\localserver32\\")) or (registry.path : "hklm\\*\\inprocserver32\\*" and registry.data.strings : ("*\\users\\*", "*\\programdata\\*"))) and not process.name : ("onedrive.exe","onedrivesetup.exe","filesyncconfig.exe","teams.exe") and not (process.name: "regsvr32.exe" and registry.data.strings : "*microsoft.teams.*.dll")"
<li><a href="#">query = sequence by host.id with maxspan = 2s [network where process.name : "svchost.exe" and network.direction : ("incoming", "ingress") and source.ip != "127.0.0.1" and source.ip != "::1" and source.port >= 49152 and destination.port >= 49152 ] [process where event.type == "start" and process.parent.name : "wmiprvse.exe" and not process.args : ("c:\\windows\\temp\\nessus_*.txt", "c:\\windows\\temp\\nessus_*.tmp", "c:\\windows\\ccm\\systemtemp\\*", "c:\\windows\\ccmcache\\*", "c:\\ccm\\cache\\*") ]"
<li><a href="#">query = sequence by host.id with maxspan = 30s [any where (event.category == "library" or (event.category == "process" and event.action : "image loaded*")) and (dll.name : "taskschd.dll" or file.name : "taskschd.dll") and process.name : ("cscript.exe", "wscript.exe", "powershell.exe", "pwsh.exe", "powershell_ise.exe")] [registry where registry.path : "hklm\\software\\microsoft\\windows nt\\currentversion\\schedule\\taskcache\\tasks\\*\\actions"]"
<li><a href="#">query = sequence by host.id with maxspan = 30s [network where network.direction : ("incoming", "ingress") and destination.port in (5985, 5986) and network.protocol == "http" and source.ip != "127.0.0.1" and source.ip != "::1" ] [process where event.type == "start" and process.parent.name : "wsmprovhost.exe" and not process.name : "conhost.exe"]"
<li><a href="#">query = sequence by host.id with maxspan = 5s [any where (event.category == "library" or (event.category == "process" and event.action : "image loaded*")) and (dll.name : "wmiutils.dll" or file.name : "wmiutils.dll") and process.name : ("wscript.exe", "cscript.exe")] [process where event.type == "start" and process.parent.name : "wmiprvse.exe" and user.domain != "nt authority" and (process.pe.original_file_name : ("cscript.exe", "wscript.exe", "powershell.exe", "cmd.exe", "mshta.exe", "rundll32.exe", "regsvr32.exe", "msbuild.exe", "installutil.exe", "regasm.exe", "regsvcs.exe", "msxsl.exe", "control.exe", "explorer.exe", "microsoft.workflow.compiler.exe", "msiexec.exe") or process.executable : ("c:\\users\\*.exe", "c:\\programdata\\*.exe")) ]"
<li><a href="#">query = sequence by host.id with maxspan = 5s [process where event.type == "start" and process.executable : ("/usr/bin/mkfifo","/usr/bin/mknod") and process.args:("/tmp/*","$*")] [process where process.executable : ("/bin/sh","/bin/bash") and process.args:("-i") or (process.executable: ("/usr/bin/openssl") and process.args: ("-connect"))] [process where (process.name:("nc","ncat","netcat","netcat.openbsd","netcat.traditional") or (process.name: "openssl" and process.executable: "/usr/bin/openssl"))]"
<li><a href="#">query = sequence by host.id with maxspan=1m [file where event.type != "deletion" and file.path : ("/system/library/launchagents/*", "/library/launchagents/*", "/users/*/library/launchagents/*") ] [process where event.type in ("start", "process_started") and process.name == "launchctl" and process.args == "load"]"
<li><a href="#">query = sequence by host.id with maxspan=1m [file where event.type != "deletion" and file.path : ("/system/library/launchdaemons/*", "/library/launchdaemons/*")] [process where event.type in ("start", "process_started") and process.name == "launchctl" and process.args == "load"]"
<li><a href="#">query = sequence by host.id with maxspan=1m [network where event.action == "connection_attempted" and process.name : "java" and destination.port in (1389, 389, 1099, 53, 5353)] by process.pid [process where event.type == "start" and process.parent.name : "java" and process.name : ("sh", "bash", "dash", "ksh", "tcsh", "zsh", "curl", "perl*", "python*", "ruby*", "php*", "wget")] by process.parent.pid"
<li><a href="#">query = sequence by host.id with maxspan=1m [network where event.type == "start" and process.name : "mmc.exe" and source.port >= 49152 and destination.port >= 49152 and source.ip != "127.0.0.1" and source.ip != "::1" and network.direction : ("incoming", "ingress") and network.transport == "tcp" ] by process.entity_id [process where event.type == "start" and process.parent.name : "mmc.exe" ] by process.parent.entity_id"
<li><a href="#">query = sequence by host.id with maxspan=1m [network where event.type == "start" and process.name : "svchost.exe" and destination.port == 3389 and network.direction : ("incoming", "ingress") and network.transport == "tcp" and source.ip != "127.0.0.1" and source.ip != "::1" ] [registry where process.name : "explorer.exe" and registry.path : ("hkey_users\\*\\software\\microsoft\\windows\\currentversion\\explorer\\runmru\\*") and registry.data.strings : ("cmd.exe*", "powershell.exe*", "taskmgr*", "\\\\tsclient\\*.exe\\*") ] [process where event.type == "start" and (process.parent.name : ("cmd.exe", "powershell.exe", "taskmgr.exe") or process.args : ("\\\\tsclient\\*.exe")) and not process.name : "conhost.exe" ]"
<li><a href="#">query = sequence by host.id with maxspan=1m [process where event.code == "1" and process.parent.name : ("winword.exe", "excel.exe", "outlook.exe", "powerpnt.exe", "eqnedt32.exe", "fltldr.exe", "mspub.exe", "msaccess.exe","cscript.exe", "wscript.exe", "rundll32.exe", "regsvr32.exe", "mshta.exe", "wmic.exe", "cmstp.exe", "msxsl.exe") and not (process.parent.name : "excel.exe" and process.executable : "?:\\program files\\microsoft office\\root\\office*\\addins\\*.exe") and not (process.executable : "?:\\windows\\splwow64.exe" and process.args in ("8192", "12288") and process.parent.name : ("winword.exe", "excel.exe", "outlook.exe", "powerpnt.exe")) and not (process.parent.name : "rundll32.exe" and process.parent.args : ("?:\\windows\\installer\\msi*.tmp,zzzzinvokemanagedcustomactionoutofproc", "--no-sandbox")) and not (process.executable : ("?:\\program files (x86)\\microsoft\\edgewebview\\application\\*\\msedgewebview2.exe", "?:\\program files\\adobe\\acrobat dc\\acrobat\\acrobat.exe", "?:\\windows\\syswow64\\dwwin.exe") and process.parent.name : ("winword.exe", "excel.exe", "outlook.exe", "powerpnt.exe")) and not (process.parent.name : "regsvr32.exe" and process.parent.args : ("?:\\program files\\*", "?:\\program files (x86)\\*")) ] by process.parent.entity_id, process.entity_id [process where event.code == "10" and winlog.event_data.calltrace : "*unknown*"] by process.entity_id, winlog.event_data.targetprocessguid"
<li><a href="#">query = sequence by host.id with maxspan=30s [network where event.type == "start" and process.pid == 4 and destination.port == 445 and network.direction : ("incoming", "ingress") and network.transport == "tcp" and source.ip != "127.0.0.1" and source.ip != "::1" ] by process.entity_id [file where event.type in ("creation", "change") and process.pid == 4 and file.extension : ("exe", "dll", "bat", "cmd")] by process.entity_id"
<li><a href="#">query = sequence by host.id with maxspan=30s [network where process.pid == 4 and network.direction : ("incoming", "ingress") and destination.port in (5985, 5986) and network.protocol == "http" and source.ip != "127.0.0.1" and source.ip != "::1" ] [process where event.type == "start" and process.parent.name : "winrshost.exe" and not process.name : "conhost.exe"]"
<li><a href="#">query = sequence by host.id with maxspan=30s [process where event.type in ("start", "process_started") and process.name == "automator"] [network where process.name:"com.apple.automator.runner"]"
<li><a href="#">query = sequence by host.id with maxspan=30s [registry where registry.path : "hklm\\software\\microsoft\\windows nt\\currentversion\\print\\printers\\*\\spooldirectory" and registry.data.strings : "c:\\windows\\system32\\spool\\drivers\\x64\\4"] [registry where registry.path : "hklm\\software\\microsoft\\windows nt\\currentversion\\print\\printers\\*\\copyfiles\\payload\\module" and registry.data.strings : "c:\\windows\\system32\\spool\\drivers\\x64\\4\\*"]"
<li><a href="#">query = sequence by host.id with maxspan=5s [network where event.type == "start" and process.name : "explorer.exe" and network.direction : ("incoming", "ingress") and network.transport == "tcp" and source.port > 49151 and destination.port > 49151 and source.ip != "127.0.0.1" and source.ip != "::1" ] by process.entity_id [process where event.type == "start" and process.parent.name : "explorer.exe" ] by process.parent.entity_id"
<li><a href="#">query = sequence by host.id with maxspan=5s [process where event.type == "end" and process.code_signature.trusted != true and not process.executable : ("c:\\windows\\softwaredistribution\\*.exe", "c:\\windows\\winsxs\\*.exe") ] by process.executable [file where event.type == "deletion" and file.extension : ("exe", "scr", "com") and not process.executable : ("?:\\program files\\*.exe", "?:\\program files (x86)\\*.exe", "?:\\windows\\system32\\svchost.exe", "?:\\windows\\system32\\drvinst.exe") and not file.path : ("?:\\program files\\*.exe", "?:\\program files (x86)\\*.exe") ] by file.path"
<li><a href="#">query = sequence by host.id with maxspan=5s [process where event.type in ("start", "process_started", "info") and process.name == "com.apple.foundation.userscriptservice"] by process.pid [process where event.type in ("start", "process_started") and process.name in ("osascript", "python", "tcl", "node", "perl", "ruby", "php", "bash", "csh", "zsh", "sh") and not process.args : "/users/*/library/application support/iterm2/scripts/autolaunch/*.scpt" ] by process.parent.pid"
<li><a href="#">query = sequence by host.id with maxspan=5s [process where event.type in ("start", "process_started", "info") and process.name == "osascript"] by process.pid [process where event.type in ("start", "process_started") and process.name == "sh" and process.args == "-c"] by process.parent.pid"
<li><a href="#">query = sequence by host.id, process.entity_id [network where process.name : ("wscript.exe", "cscript.exe") and network.protocol != "dns" and network.direction : ("outgoing", "egress") and network.type == "ipv4" and destination.ip != "127.0.0.1" ] [file where event.type == "creation" and file.extension : ("exe", "dll")]"
<li><a href="#">query = sequence by host.id, process.entity_id with maxspan = 1m [network where process.name : "svchost.exe" and network.direction : ("incoming", "ingress") and source.port >= 49152 and destination.port >= 49152 and source.ip != "127.0.0.1" and source.ip != "::1" ] [registry where registry.path : "hklm\\software\\microsoft\\windows nt\\currentversion\\schedule\\taskcache\\tasks\\*\\actions"]"
<li><a href="#">query = sequence by host.id, process.entity_id with maxspan = 5s [any where (event.category == "library" or (event.category == "process" and event.action : "image loaded*")) and (dll.name : "taskschd.dll" or file.name : "taskschd.dll") and process.name : ("powershell.exe", "pwsh.exe", "powershell_ise.exe")] [network where process.name : ("powershell.exe", "pwsh.exe", "powershell_ise.exe") and destination.port == 135 and not destination.address in ("127.0.0.1", "::1")]"
<li><a href="#">query = sequence by host.id, process.entity_id with maxspan = 5s [process where event.type:"start" and process.name : ("wermgr.exe", "werfault.exe") and process.args_count == 1] [network where process.name : ("wermgr.exe", "werfault.exe") and network.protocol != "dns" and network.direction : ("outgoing", "egress") and destination.ip !="::1" and destination.ip !="127.0.0.1" ]"
<li><a href="#">query = sequence by host.id, process.entity_id with maxspan=1m [process where event.type == "start" and process.name : "dllhost.exe" and process.args_count == 1] [network where process.name : "dllhost.exe" and not cidrmatch(destination.ip, "10.0.0.0/8", "127.0.0.0/8", "169.254.0.0/16", "172.16.0.0/12", "192.0.0.0/24", "192.0.0.0/29", "192.0.0.8/32", "192.0.0.9/32", "192.0.0.10/32", "192.0.0.170/32", "192.0.0.171/32", "192.0.2.0/24", "192.31.196.0/24", "192.52.193.0/24", "192.168.0.0/16", "192.88.99.0/24", "224.0.0.0/4", "100.64.0.0/10", "192.175.48.0/24", "198.18.0.0/15", "198.51.100.0/24", "203.0.113.0/24", "240.0.0.0/4", "::1", "fe80::/10", "ff00::/8")]"
<li><a href="#">query = sequence by host.id, process.entity_id with maxspan=1m [process where event.type == "start" and process.name : "rundll32.exe" and process.args_count == 1] [network where process.name : "rundll32.exe" and not cidrmatch(destination.ip, "10.0.0.0/8", "127.0.0.0/8", "169.254.0.0/16", "172.16.0.0/12", "192.0.0.0/24", "192.0.0.0/29", "192.0.0.8/32", "192.0.0.9/32", "192.0.0.10/32", "192.0.0.170/32", "192.0.0.171/32", "192.0.2.0/24", "192.31.196.0/24", "192.52.193.0/24", "192.168.0.0/16", "192.88.99.0/24", "224.0.0.0/4", "100.64.0.0/10", "192.175.48.0/24","198.18.0.0/15", "198.51.100.0/24", "203.0.113.0/24", "240.0.0.0/4", "::1", "fe80::/10", "ff00::/8")]"
<li><a href="#">query = sequence by host.id, process.entity_id with maxspan=30s [network where process.name : ("powershell.exe", "pwsh.exe", "powershell_ise.exe") and network.protocol == "dns" and not dns.question.name : ("localhost", "*.microsoft.com", "*.azureedge.net", "*.powershellgallery.com", "*.windowsupdate.com", "metadata.google.internal") and not user.domain : "nt authority"] [file where process.name : "powershell.exe" and event.type == "creation" and file.extension : ("exe", "dll", "ps1", "bat") and not file.name : "__psscriptpolicy*.ps1"]"
<li><a href="#">query = sequence by host.id, process.entity_id with maxspan=30s [process where event.type == "start" and process.name == "osascript"] [network where event.type != "end" and process.name == "osascript" and destination.ip != "::1" and not cidrmatch(destination.ip, "10.0.0.0/8", "127.0.0.0/8", "169.254.0.0/16", "172.16.0.0/12", "192.0.0.0/24", "192.0.0.0/29", "192.0.0.8/32", "192.0.0.9/32", "192.0.0.10/32", "192.0.0.170/32", "192.0.0.171/32", "192.0.2.0/24", "192.31.196.0/24", "192.52.193.0/24", "192.168.0.0/16", "192.88.99.0/24", "224.0.0.0/4", "100.64.0.0/10", "192.175.48.0/24", "198.18.0.0/15", "198.51.100.0/24", "203.0.113.0/24", "240.0.0.0/4", "::1", "fe80::/10", "ff00::/8")]"
<li><a href="#">query = sequence by host.id, process.entity_id with maxspan=5s [process where event.type == "start" and process.code_signature.trusted == false and process.executable : ("c:\\users\\*.exe", "c:\\programdata\\*.exe", "c:\\windows\\temp\\*.exe", "c:\\windows\\tasks\\*.exe", "c:\\intel\\*.exe", "c:\\perflogs\\*.exe") ] [file where event.type != "deletion" and user.domain != "nt authority" and file.path : ("c:\\users\\*\\appdata\\roaming\\microsoft\\windows\\start menu\\programs\\startup\\*", "c:\\programdata\\microsoft\\windows\\start menu\\programs\\startup\\*") ]"
<li><a href="#">query = sequence by host.id, source.ip with maxspan=10s [authentication where event.action in ("ssh_login", "user_login") and event.outcome == "failure" and source.ip != null and source.ip != "0.0.0.0" and source.ip != "::" and user.name in ("*root*" , "*admin*")] with runs=3"
<li><a href="#">query = sequence by host.id, source.ip, user.name with maxspan=10s [authentication where event.action in ("ssh_login", "user_login") and event.outcome == "failure" and source.ip != null and source.ip != "0.0.0.0" and source.ip != "::" ] with runs=10"
<li><a href="#">query = sequence by host.id, source.ip, user.name with maxspan=3s [authentication where event.action in ("ssh_login", "user_login") and event.outcome == "failure" and source.ip != null and source.ip != "0.0.0.0" and source.ip != "::" ] with runs=2 [authentication where event.action in ("ssh_login", "user_login") and event.outcome == "success" and source.ip != null and source.ip != "0.0.0.0" and source.ip != "::" ]"
<li><a href="#">query = sequence by host.id, user.id with maxspan=30s [process where event.type == "start" and event.action == "exec" and process.parent.name : ("installer", "package_script_service") and process.name : ("bash", "sh", "zsh", "python", "osascript", "tclsh*")] [network where event.type == "start" and process.name : ("curl", "osascript", "wget", "python")]"
<li><a href="#">query = sequence by host.id, user.id with maxspan=3m [process where event.type == "start" and process.ext.token.integrity_level_name != "system" and (process.pe.original_file_name : ("winword.exe", "excel.exe", "outlook.exe", "powerpnt.exe", "eqnedt32.exe", "fltldr.exe", "mspub.exe", "msaccess.exe", "powershell.exe", "pwsh.exe", "cscript.exe", "wscript.exe", "rundll32.exe", "regsvr32.exe", "msbuild.exe", "mshta.exe", "wmic.exe", "cmstp.exe", "msxsl.exe") or (process.executable : ("?:\\users\\*.exe", "?:\\programdata\\*.exe", "?:\\windows\\temp\\*.exe", "?:\\windows\\tasks\\*") and (process.code_signature.exists == false or process.code_signature.status : "errorbaddigest")) or process.executable : "?:\\windows\\microsoft.net\\*.exe") and not process.executable : ("?:\\windows\\system32\\werfaultsecure.exe", "?:\\windows\\syswow64\\werfaultsecure.exe", "?:\\windows\\system32\\werfault.exe", "?:\\windows\\syswow64\\werfault.exe") ] by process.pid [process where event.type == "start" and process.parent.ext.real.pid > 0 and not (process.name : "msedge.exe" and process.parent.name : "sihost.exe") and not process.executable : ("?:\\windows\\system32\\werfaultsecure.exe", "?:\\windows\\syswow64\\werfaultsecure.exe", "?:\\windows\\system32\\werfault.exe", "?:\\windows\\syswow64\\werfault.exe") ] by process.parent.ext.real.pid"
<li><a href="#">query = sequence by host.id, user.name with maxspan = 5s [library where dll.name : "ieproxy.dll" and process.name : ("rundll32.exe", "regsvr32.exe")] [process where event.type == "start" and process.parent.name : "iexplore.exe" and process.parent.args : "-embedding"] [network where network.protocol == "dns" and process.name : "iexplore.exe" and not dns.question.name : ("*.microsoft.com", "*.digicert.com", "*.msocsp.com", "*.windowsupdate.com", "*.bing.com", "*.identrust.com", "*.sharepoint.com", "*.office365.com", "*.office.com") ]"
<li><a href="#">query = sequence by host.id, user.name with maxspan=1m [process where event.type == "start" and process.name : "userinit.exe" and process.parent.name : "winlogon.exe"] [process where event.type == "start" and process.name : "explorer.exe"] [process where event.type == "start" and process.parent.name : "explorer.exe" and process.pe.original_file_name in ("cscript.exe", "wscript.exe", "powershell.exe", "mshta.exe", "rundll32.exe", "regsvr32.exe", "regasm.exe", "msbuild.exe", "installutil.exe") and process.args : ("c:\\users\\*", "c:\\programdata\\*", "c:\\windows\\temp\\*", "c:\\windows\\tasks\\*", "c:\\perflogs\\*", "c:\\intel\\*") ]"
<li><a href="#">query = sequence by process.entity_id [process where (process.name : "expand.exe" or process.name : "extrac32.exe" or process.name : "ieexec.exe" or process.name : "makecab.exe") and event.type == "start"] [network where (process.name : "expand.exe" or process.name : "extrac32.exe" or process.name : "ieexec.exe" or process.name : "makecab.exe") and not cidrmatch(destination.ip, "10.0.0.0/8", "127.0.0.0/8", "169.254.0.0/16", "172.16.0.0/12", "192.0.0.0/24", "192.0.0.0/29", "192.0.0.8/32", "192.0.0.9/32", "192.0.0.10/32", "192.0.0.170/32", "192.0.0.171/32", "192.0.2.0/24", "192.31.196.0/24", "192.52.193.0/24", "192.168.0.0/16", "192.88.99.0/24", "224.0.0.0/4", "100.64.0.0/10", "192.175.48.0/24", "198.18.0.0/15", "198.51.100.0/24", "203.0.113.0/24", "240.0.0.0/4", "::1", "fe80::/10", "ff00::/8")]"
<li><a href="#">query = sequence by process.entity_id [process where (process.name : "microsoft.workflow.compiler.exe" or process.name : "bginfo.exe" or process.name : "cdb.exe" or process.name : "cmstp.exe" or process.name : "csi.exe" or process.name : "dnx.exe" or process.name : "fsi.exe" or process.name : "ieexec.exe" or process.name : "iexpress.exe" or process.name : "odbcconf.exe" or process.name : "rcsi.exe" or process.name : "xwizard.exe") and event.type == "start"] [network where (process.name : "microsoft.workflow.compiler.exe" or process.name : "bginfo.exe" or process.name : "cdb.exe" or process.name : "cmstp.exe" or process.name : "csi.exe" or process.name : "dnx.exe" or process.name : "fsi.exe" or process.name : "ieexec.exe" or process.name : "iexpress.exe" or process.name : "odbcconf.exe" or process.name : "rcsi.exe" or process.name : "xwizard.exe")]"
<li><a href="#">query = sequence by process.entity_id [process where event.type == "start" and (process.name : "msbuild.exe" or process.pe.original_file_name == "msbuild.exe")] [any where (event.category == "library" or (event.category == "process" and event.action : "image loaded*")) and (dll.name : ("vaultcli.dll", "samlib.dll") or file.name : ("vaultcli.dll", "samlib.dll"))]"
<li><a href="#">query = sequence by process.entity_id [process where event.type == "start" and host.os.name == "windows" and process.pid != 4 and not (process.executable : "d:\\enterprisecare\\tools\\jre.1\\bin\\java.exe" and process.args : "com.emeraldcube.prism.launcher.invoker") and not (process.executable : "c:\\docusnap 11\\tools\\nmap\\nmap.exe" and process.args : "smb-os-discovery.nse") and not process.executable : ("?:\\program files\\sentinelone\\sentinel agent *\\ranger\\sentinelranger.exe", "?:\\program files\\ivanti\\security controls\\st.enginehost.exe", "?:\\program files (x86)\\fortinet\\fsae\\collectoragent.exe", "?:\\program files (x86)\\nmap\\nmap.exe", "?:\\program files\\azure advanced threat protection sensor\\*\\microsoft.tri.sensor.exe", "?:\\program files\\cloudmatters\\auvik\\auvikservice-release-*\\auvikservice.exe", "?:\\program files\\uptime software\\uptime\\uptimedatacollector.exe", "?:\\program files\\cloudmatters\\auvik\\auvikagentservice.exe", "?:\\program files\\rumble\\rumble-agent-*.exe")] [network where destination.port == 445 and process.pid != 4 and not cidrmatch(destination.ip, "127.0.0.1", "::1")]"
<li><a href="#">query = sequence by process.entity_id [process where event.type == "start" and process.name : "installutil.exe"] [network where process.name : "installutil.exe" and network.direction : ("outgoing", "egress")]"
<li><a href="#">query = sequence by process.entity_id [process where event.type == "start" and process.name : "msbuild.exe"] [network where process.name : "msbuild.exe" and not (destination.ip == "127.0.0.1" and source.ip == "127.0.0.1")]"
<li><a href="#">query = sequence by process.entity_id [process where event.type == "start" and process.name : "msxsl.exe"] [network where process.name : "msxsl.exe" and network.direction : ("outgoing", "egress")]"
<li><a href="#">query = sequence by process.entity_id [process where event.type == "start" and process.name : ("regsvr32.exe", "regasm.exe", "regsvcs.exe") and not ((?process.ext.token.integrity_level_name : "system" or ?winlog.event_data.integritylevel : "system") and (process.parent.name : "msiexec.exe" or process.parent.executable : ("c:\\program files (x86)\\*.exe", "c:\\program files\\*.exe"))) ] [network where process.name : ("regsvr32.exe", "regasm.exe", "regsvcs.exe") and not cidrmatch(destination.ip, "10.0.0.0/8", "127.0.0.0/8", "169.254.0.0/16", "172.16.0.0/12", "192.0.0.0/24", "192.0.0.0/29", "192.0.0.8/32", "192.0.0.9/32", "192.0.0.10/32", "192.0.0.170/32", "192.0.0.171/32", "192.0.2.0/24", "192.31.196.0/24", "192.52.193.0/24", "192.168.0.0/16", "192.88.99.0/24", "224.0.0.0/4", "100.64.0.0/10", "192.175.48.0/24","198.18.0.0/15", "198.51.100.0/24", "203.0.113.0/24", "240.0.0.0/4", "::1", "fe80::/10", "ff00::/8") and network.protocol != "dns"]"
<li><a href="#">query = sequence by process.entity_id [process where process.name : "certutil.exe" and event.type == "start"] [network where process.name : "certutil.exe" and not cidrmatch(destination.ip, "10.0.0.0/8", "127.0.0.0/8", "169.254.0.0/16", "172.16.0.0/12", "192.0.0.0/24", "192.0.0.0/29", "192.0.0.8/32", "192.0.0.9/32", "192.0.0.10/32", "192.0.0.170/32", "192.0.0.171/32", "192.0.2.0/24", "192.31.196.0/24", "192.52.193.0/24", "192.168.0.0/16", "192.88.99.0/24", "224.0.0.0/4", "100.64.0.0/10", "192.175.48.0/24", "198.18.0.0/15", "198.51.100.0/24", "203.0.113.0/24", "240.0.0.0/4", "::1", "fe80::/10", "ff00::/8")]"
<li><a href="#">query = sequence by process.entity_id [process where process.name : "cmd.exe" and event.type == "start"] [network where process.name : "cmd.exe" and not cidrmatch(destination.ip, "10.0.0.0/8", "127.0.0.0/8", "169.254.0.0/16", "172.16.0.0/12", "192.0.0.0/24", "192.0.0.0/29", "192.0.0.8/32", "192.0.0.9/32", "192.0.0.10/32", "192.0.0.170/32", "192.0.0.171/32", "192.0.2.0/24", "192.31.196.0/24", "192.52.193.0/24", "192.168.0.0/16", "192.88.99.0/24", "224.0.0.0/4", "100.64.0.0/10", "192.175.48.0/24", "198.18.0.0/15", "198.51.100.0/24", "203.0.113.0/24", "240.0.0.0/4", "::1", "fe80::/10", "ff00::/8")]"
<li><a href="#">query = sequence by process.entity_id [process where process.name : "hh.exe" and event.type == "start"] [network where process.name : "hh.exe" and not cidrmatch(destination.ip, "10.0.0.0/8", "127.0.0.0/8", "169.254.0.0/16", "172.16.0.0/12", "192.0.0.0/24", "192.0.0.0/29", "192.0.0.8/32", "192.0.0.9/32", "192.0.0.10/32", "192.0.0.170/32", "192.0.0.171/32", "192.0.2.0/24", "192.31.196.0/24", "192.52.193.0/24", "192.168.0.0/16", "192.88.99.0/24", "224.0.0.0/4", "100.64.0.0/10", "192.175.48.0/24","198.18.0.0/15", "198.51.100.0/24", "203.0.113.0/24", "240.0.0.0/4", "::1", "fe80::/10", "ff00::/8")]"
<li><a href="#">query = sequence by process.entity_id [process where process.name : "msbuild.exe" and event.type == "start"] [network where process.name : "msbuild.exe" and not cidrmatch(destination.ip, "127.0.0.1", "::1")]"
<li><a href="#">query = sequence by process.entity_id [process where process.name : "msxsl.exe" and event.type == "start"] [network where process.name : "msxsl.exe" and not cidrmatch(destination.ip, "10.0.0.0/8", "127.0.0.0/8", "169.254.0.0/16", "172.16.0.0/12", "192.0.0.0/24", "192.0.0.0/29", "192.0.0.8/32", "192.0.0.9/32", "192.0.0.10/32", "192.0.0.170/32", "192.0.0.171/32", "192.0.2.0/24", "192.31.196.0/24", "192.52.193.0/24", "192.168.0.0/16", "192.88.99.0/24", "224.0.0.0/4", "100.64.0.0/10", "192.175.48.0/24","198.18.0.0/15", "198.51.100.0/24", "203.0.113.0/24", "240.0.0.0/4", "::1", "fe80::/10", "ff00::/8")]"
<li><a href="#">query = sequence by process.entity_id [process where process.name : "psexec.exe" and event.type == "start" and process.args : "-accepteula" and not process.executable : ("?:\\programdata\\docusnap\\discovery\\discovery\\plugins\\17\\bin\\psexec.exe", "?:\\docusnap 11\\bin\\psexec.exe", "?:\\program files\\docusnap x\\bin\\psexec.exe", "?:\\program files\\docusnap x\\tools\\dsdns.exe") and not process.parent.executable : "?:\\program files (x86)\\cynet\\cynet scanner\\cynetscanner.exe"] [network where process.name : "psexec.exe"]"
<li><a href="#">query = sequence by process.entity_id [process where process.name == "telnet" and event.type == "start"] [network where process.name == "telnet" and cidrmatch(destination.ip, "10.0.0.0/8", "127.0.0.0/8", "169.254.0.0/16", "172.16.0.0/12", "192.0.0.0/24", "192.0.0.0/29", "192.0.0.8/32", "192.0.0.9/32", "192.0.0.10/32", "192.0.0.170/32", "192.0.0.171/32", "192.0.2.0/24", "192.31.196.0/24", "192.52.193.0/24", "192.168.0.0/16", "192.88.99.0/24", "224.0.0.0/4", "100.64.0.0/10", "192.175.48.0/24", "198.18.0.0/15", "198.51.100.0/24", "203.0.113.0/24", "240.0.0.0/4", "::1", "fe80::/10", "ff00::/8")]"
<li><a href="#">query = sequence by process.entity_id [process where process.name == "telnet" and event.type == "start"] [network where process.name == "telnet" and not cidrmatch(destination.ip, "10.0.0.0/8", "127.0.0.0/8", "169.254.0.0/16", "172.16.0.0/12", "192.0.0.0/24", "192.0.0.0/29", "192.0.0.8/32", "192.0.0.9/32", "192.0.0.10/32", "192.0.0.170/32", "192.0.0.171/32", "192.0.2.0/24", "192.31.196.0/24", "192.52.193.0/24", "192.168.0.0/16", "192.88.99.0/24", "224.0.0.0/4", "100.64.0.0/10", "192.175.48.0/24", "198.18.0.0/15", "198.51.100.0/24", "203.0.113.0/24", "240.0.0.0/4", "::1", "fe80::/10", "ff00::/8")]"
<li><a href="#">query = sequence by process.entity_id [process where process.name:("nc","ncat","netcat","netcat.openbsd","netcat.traditional") and ((process.args:("-l","-p") and process.args:("-c","echo","$*")) or process.args:("-l","-p","-lp") or (process.args:("-e") and process.args:("/bin/bash","/bin/sh")) or process.args:(">","<") or (process.args:("|") and process.args:("nc","ncat")))] [network where (process.name == "nc" or process.name == "ncat" or process.name == "netcat" or process.name == "netcat.openbsd" or process.name == "netcat.traditional")]"
<li><a href="#">query = sequence by process.entity_id with maxspan = 1m [process where event.type == "start" and (process.name : "sc.exe" or process.pe.original_file_name : "sc.exe") and process.args : "\\\\*" and process.args : ("binpath=*", "binpath=*") and process.args : ("create", "config", "failure", "start")] [network where process.name : "sc.exe" and destination.ip != "127.0.0.1"]"
<li><a href="#">query = sequence by process.entity_id with maxspan = 2m [process where event.type == "start" and (process.name : "wmic.exe" or process.pe.original_file_name : "wmic.exe") and process.args : ("format*:*", "/format*:*", "*-format*:*") and not process.command_line : "* /format:table *"] [any where (event.category == "library" or (event.category == "process" and event.action : "image loaded*")) and (dll.name : ("jscript.dll", "vbscript.dll") or file.name : ("jscript.dll", "vbscript.dll"))]"
<li><a href="#">query = sequence by process.entity_id with maxspan = 5m [process where event.type == "start" and not (process.name : "sdbinst.exe" and process.parent.name : "msiexec.exe")] [registry where event.type in ("creation", "change") and registry.path : "hklm\\software\\microsoft\\windows nt\\currentversion\\appcompatflags\\custom\\*.sdb"]"
<li><a href="#">query = sequence by process.entity_id with maxspan=10m [process where event.type == "start" and process.name : "mshta.exe" and not process.parent.name : "microsoft.configurationmanagement.exe" and not (process.parent.executable : "c:\\amazon\\amazon assistant\\amazonassistantservice.exe" or process.parent.executable : "c:\\teamviewer\\teamviewer.exe") and not process.args : "adselfservice_enroll.hta"] [network where process.name : "mshta.exe"]"
<li><a href="#">query = sequence by process.entity_id with maxspan=1m [network where event.type == "start" and event.action == "connection_attempted" and user.id == "0" and not process.executable : ("/bin/ssh", "/sbin/ssh", "/usr/lib/systemd/systemd", "/usr/sbin/sshd")] [process where event.action == "session_id_change" and user.id == "0" and not process.executable : ("/bin/ssh", "/sbin/ssh", "/usr/lib/systemd/systemd", "/usr/sbin/sshd")]"
<li><a href="#">query = sequence by process.entity_id with maxspan=1m [process where event.action == "exec" and process.name:"ssh"] [network where process.name:"ssh" and event.action in ("connection_attempted", "connection_accepted") and destination.port != 22 and destination.ip != "127.0.0.1" and network.transport: "tcp" ]"
<li><a href="#">query = sequence by process.entity_id with maxspan=1m [process where event.category == "process" and process.name : "rundll32.exe"] [process where event.category == "process" and event.dataset : "windows.sysmon_operational" and event.code == "7" and (file.pe.original_file_name : "comsvcs.dll" or file.pe.imphash : "eadbccbb324829acb5f2bbe87e5549a8") and not file.name : "comsvcs.dll"]"
<li><a href="#">query = sequence by process.entity_id with maxspan=1m [process where event.type == "start" and process.name : ("cp", "rsync") and process.args : ("/lib/x86_64-linux-gnu/ld-linux-x86-64.so.2", "/etc/ld.so.preload")] [file where event.action == "creation" and file.extension == "so"]"
<li><a href="#">query = sequence by process.entity_id with maxspan=2m [process where event.type == "start" and (process.code_signature.subject_name in ("microsoft corporation", "microsoft windows") and process.code_signature.trusted == true) and not process.executable : ("?:\\windows\\system32\\cscript.exe", "?:\\windows\\syswow64\\cscript.exe", "?:\\program files (x86)\\internet explorer\\iexplore.exe", "?:\\program files\\internet explorer\\iexplore.exe", "?:\\windows\\systemapps\\microsoft.microsoftedge_*\\microsoftedge.exe", "?:\\windows\\system32\\msiexec.exe", "?:\\windows\\syswow64\\msiexec.exe", "?:\\windows\\system32\\smartscreen.exe", "?:\\windows\\system32\\taskhostw.exe", "?:\\windows\\system32\\inetsrv\\w3wp.exe", "?:\\windows\\syswow64\\inetsrv\\w3wp.exe", "?:\\windows\\system32\\wscript.exe", "?:\\windows\\syswow64\\wscript.exe", "?:\\windows\\system32\\mobsync.exe", "?:\\windows\\syswow64\\mobsync.exe", "?:\\windows\\system32\\cmd.exe", "?:\\windows\\syswow64\\cmd.exe")] [library where event.type == "start" and dll.name : "scrobj.dll"]"
<li><a href="#">query = sequence by process.entity_id with maxspan=2s [file where event.type == "creation" and file.extension == "lnk"] [file where event.type == "creation" and file.extension == "lnk:zone.identifier" and file.ext.windows.zone_identifier > 1]"
<li><a href="#">query = sequence by process.entity_id with maxspan=2s [file where event.type == "creation" and file.extension == "url" and not process.name == "explorer.exe"] [file where event.type == "creation" and file.extension == "url:zone.identifier" and file.ext.windows.zone_identifier > 1 and not process.name == "explorer.exe"]"
<li><a href="#">query = sequence by process.entity_id with maxspan=5m [process where event.type == "start" and (process.name : "bginfo.exe" or process.name : "cdb.exe" or process.name : "control.exe" or process.name : "cmstp.exe" or process.name : "csi.exe" or process.name : "dnx.exe" or process.name : "fsi.exe" or process.name : "ieexec.exe" or process.name : "iexpress.exe" or process.name : "installutil.exe" or process.name : "microsoft.workflow.compiler.exe" or process.name : "msbuild.exe" or process.name : "msdt.exe" or process.name : "mshta.exe" or process.name : "msiexec.exe" or process.name : "msxsl.exe" or process.name : "odbcconf.exe" or process.name : "rcsi.exe" or process.name : "regsvr32.exe" or process.name : "xwizard.exe")] [network where (process.name : "bginfo.exe" or process.name : "cdb.exe" or process.name : "control.exe" or process.name : "cmstp.exe" or process.name : "csi.exe" or process.name : "dnx.exe" or process.name : "fsi.exe" or process.name : "ieexec.exe" or process.name : "iexpress.exe" or process.name : "installutil.exe" or process.name : "microsoft.workflow.compiler.exe" or process.name : "msbuild.exe" or process.name : "msdt.exe" or process.name : "mshta.exe" or process.name : "msiexec.exe" or process.name : "msxsl.exe" or process.name : "odbcconf.exe" or process.name : "rcsi.exe" or process.name : "regsvr32.exe" or process.name : "xwizard.exe")]"
<li><a href="#">query = sequence by process.entity_id with maxspan=5m [process where event.type == "start" and process.name : ("wscript.exe", "cscript.exe", "mshta.exe", "wmic.exe", "regsvr32.exe", "svchost.exe", "dllhost.exe", "cmstp.exe")] [file where event.type != "deletion" and file.name : ("wscript.exe.log", "cscript.exe", "mshta.exe.log", "wmic.exe.log", "svchost.exe.log", "dllhost.exe.log", "cmstp.exe.log", "regsvr32.exe.log")]"
<li><a href="#">query = sequence by user.email with maxspan=10m [any where event.module == "okta" and event.action == "user.mfa.okta_verify.deny_push"] [any where event.module == "okta" and event.action == "user.mfa.okta_verify.deny_push"] [any where event.module == "okta" and event.action == "user.authentication.sso"]"
<li><a href="#">query = sequence by user.id with maxspan=5m [file where event.action in ("creation", "rename") and file.extension : ("htm", "html") and file.path : ("?:\\users\\*\\downloads\\*", "?:\\users\\*\\content.outlook\\*", "?:\\users\\*\\appdata\\local\\temp\\temp?_*", "?:\\users\\*\\appdata\\local\\temp\\7z*", "?:\\users\\*\\appdata\\local\\temp\\rar$*") and ((file.ext.entropy >= 5 and file.size >= 150000) or file.size >= 1000000)] [process where event.action == "start" and ((process.name in ("chrome.exe", "msedge.exe", "brave.exe", "whale.exe", "browser.exe", "dragon.exe", "vivaldi.exe", "opera.exe") and process.args == "--single-argument") or (process.name == "iexplore.exe" and process.args_count == 2) or (process.name in ("firefox.exe", "waterfox.exe") and process.args == "-url")) and process.args : ("?:\\users\\*\\downloads\\*.htm*", "?:\\users\\*\\content.outlook\\*.htm*", "?:\\users\\*\\appdata\\local\\temp\\temp?_*.htm*", "?:\\users\\*\\appdata\\local\\temp\\7z*.htm*", "?:\\users\\*\\appdata\\local\\temp\\rar$*.htm*")]"
<li><a href="#">query = sequence by winlog.computer_name with maxspan=1m [authentication where event.action == "logged-in" and winlog.logon.type == "network" and event.outcome == "success" and not user.name == "anonymous logon" and not winlog.event_data.subjectusername : "*$" and not user.domain == "nt authority" and source.ip != "127.0.0.1" and source.ip !="::1"] by winlog.event_data.targetlogonid [iam where event.action == "scheduled-task-created"] by winlog.event_data.subjectlogonid"
<li><a href="#">query = sequence by winlog.computer_name with maxspan=1m [authentication where event.action:"logged-in" and event.outcome == "success" and user.id : ("s-1-5-21-*", "s-1-12-1-*") and process.name == "svchost.exe" and winlog.event_data.logonprocessname : "seclogo*" and source.ip == "::1" ] by winlog.event_data.targetlogonid [process where event.type == "start"] by winlog.event_data.targetlogonid"
<li><a href="#">query = sequence by winlog.computer_name with maxspan=5m [authentication where event.action == "logged-in" and event.outcome == "success" and winlog.event_data.authenticationpackagename :"kerberos" and winlog.logon.type == "network" and cidrmatch(source.ip, "127.0.0.0/8", "::1") and source.port > 0] by winlog.event_data.targetlogonid [any where event.action : "service-installed"] by winlog.event_data.subjectlogonid"
<li><a href="#">query = sequence by winlog.computer_name with maxspan=5m [authentication where event.action == "logged-in" and winlog.logon.type : "network" and event.outcome == "success" and source.ip != null and source.ip != "127.0.0.1" and source.ip != "::1"] by winlog.event_data.targetlogonid [iam where event.action == "reset-password" and (winlog.event_data.targetusername: ("*admin*", "*super*", "*svc*", "*dc0*", "*service*", "*dmz*", "*adm*") or winlog.event_data.targetsid : ("s-1-5-21-*-500", "s-1-12-1-*-500")) ] by winlog.event_data.subjectlogonid"
<li><a href="#">query = sequence by winlog.computer_name with maxspan=5m [authentication where event.action == "logged-in" and winlog.logon.type == "network" and event.outcome == "success" and not user.name == "anonymous logon" and not winlog.event_data.subjectusername : "*$" and not user.domain == "nt authority" and source.ip != "127.0.0.1" and source.ip !="::1"] by winlog.event_data.targetlogonid [iam where event.action == "changed-computer-account" and winlog.event_data.dnshostname : "??*" and not startswith~(winlog.event_data.dnshostname, substring(winlog.event_data.targetusername, 0, length(winlog.event_data.targetusername) - 1)) ] by winlog.event_data.subjectlogonid"
<li><a href="#">query = sequence by winlog.computer_name, source.ip with maxspan=10s [authentication where event.action == "logon-failed" and winlog.logon.type : "network" and source.ip != null and source.ip != "127.0.0.1" and source.ip != "::1" and not user.name : ("anonymous logon", "-", "*$") and not user.domain == "nt authority" and not winlog.event_data.status : ("0xc000015b", "0xc000005e", "0xc0000133", "0xc0000192")] with runs=10"
<li><a href="#">query = sequence by winlog.computer_name, source.ip with maxspan=10s [authentication where event.action == "logon-failed" and winlog.logon.type : "network" and source.ip != null and source.ip != "127.0.0.1" and source.ip != "::1" and user.name : "*admin*" and not winlog.event_data.status : ("0xc000015b", "0xc000005e", "0xc0000133", "0xc0000192")] with runs=5"
<li><a href="#">query = sequence by winlog.computer_name, source.ip with maxspan=5s [authentication where event.action == "logon-failed" and winlog.logon.type : "network" and source.ip != null and source.ip != "127.0.0.1" and source.ip != "::1" and not user.name : ("anonymous logon", "-", "*$") and not user.domain == "nt authority" and not winlog.event_data.status : ("0xc000015b", "0xc000005e", "0xc0000133", "0xc0000192")] with runs=5 [authentication where event.action == "logged-in" and winlog.logon.type : "network" and source.ip != null and source.ip != "127.0.0.1" and source.ip != "::1" and not user.name : ("anonymous logon", "-", "*$") and not user.domain == "nt authority"]"
<li><a href="#">query = sequence by winlog.computer_name, user.id with maxspan=1m [authentication where event.outcome == "success" and event.action == "logged-in" and winlog.logon.type == "network" and not user.name == "anonymous logon" and not user.domain == "nt authority" and source.ip != "127.0.0.1" and source.ip !="::1"] [file where event.action == "creation" and process.name : "svchost.exe" and file.ext.header_bytes : "72656766*" and user.id : ("s-1-5-21-*", "s-1-12-1-*") and file.size >= 30000 and not file.path : ("?:\\windows\\system32\\hkey_local_machine_software_microsoft_*.registry", "?:\\users\\*\\appdata\\local\\microsoft\\windows\\usrclass.dat.log?", "?:\\users\\*\\appdata\\local\\microsoft\\windows\\usrclass.dat", "?:\\users\\*\\ntuser.dat.log?", "?:\\users\\*\\ntuser.dat")]"
<li><a href="#">query = sequence by winlog.computer_name, winlog.event_data.subjectlogonid with maxspan=1m [iam where event.action == "logged-in-special" and winlog.event_data.privilegelist : "sebackupprivilege" and not winlog.event_data.privilegelist : "sedebugprivilege"] [any where event.action == "detailed file share" and winlog.event_data.relativetargetname : "winreg"]"
<li><a href="#">query = sequence by winlog.computer_name, winlog.event_data.taskname with maxspan=5m [iam where event.action == "scheduled-task-created" and not user.name : "*$"] [iam where event.action == "scheduled-task-deleted" and not user.name : "*$"]"
<li><a href="#">query = sequence by winlog.computer_name, winlog.process.pid with maxspan=1s [any where event.code : "5382" and (winlog.event_data.schemafriendlyname : "windows web password credential" or winlog.event_data.resource : "http*") and not winlog.event_data.subjectlogonid : "0x3e7"] [any where event.code : "5382" and (winlog.event_data.schemafriendlyname : "windows web password credential" or winlog.event_data.resource : "http*") and not winlog.event_data.subjectlogonid : "0x3e7"]"
<li><a href="#">query = sequence by winlog.logon.id, winlog.computer_name with maxspan=1m [authentication where event.action == "logged-in" and winlog.logon.type : "network" and event.outcome=="success" and source.ip != null and source.ip != "127.0.0.1" and source.ip != "::1"] [iam where event.action == "service-installed" and not winlog.event_data.subjectlogonid : "0x3e7" and not winlog.event_data.servicefilename : ("?:\\windows\\adcr_agent\\adcrsvc.exe", "?:\\windows\\system32\\vssvc.exe", "?:\\windows\\servicing\\trustedinstaller.exe", "?:\\windows\\system32\\svchost.exe", "?:\\program files (x86)\\*.exe", "?:\\program files\\*.exe", "?:\\windows\\psexesvc.exe", "?:\\windows\\system32\\sppsvc.exe", "?:\\windows\\system32\\wbem\\wmiapsrv.exe", "?:\\windows\\remoteauditservice.exe", "?:\\windows\\veeamvsssupport\\veeamguesthelper.exe", "?:\\windows\\veeamlogshipper\\veeamlogshipper.exe", "?:\\windows\\cainvokerservice.exe", "?:\\windows\\system32\\upfc.exe", "?:\\windows\\adminarsenal\\pdq*.exe", "?:\\windows\\system32\\vds.exe", "?:\\windows\\veeam\\backup\\veeamdeploymentsvc.exe", "?:\\windows\\propatches\\scheduler\\stschedex.exe", "?:\\windows\\system32\\certsrv.exe", "?:\\windows\\eset-remote-install-service.exe", "?:\\pella corporation\\pella order management\\gpautosvc.exe", "?:\\pella corporation\\osctogpautoservice\\osctogpautosvc.exe", "?:\\pella corporation\\pella order management\\gpautosvc.exe", "?:\\windows\\syswow64\\nwxexesvc\\nwxexesvc.exe", "?:\\windows\\system32\\taskhostex.exe")]"
<li><a href="#">query = sequence with maxspan=1h [process where event.type == "start" and (process.name : "rundll32.exe" or process.pe.original_file_name == "rundll32.exe") and process.args_count == 1 ] by process.entity_id [process where event.type == "start" and process.parent.name : "rundll32.exe" ] by process.parent.entity_id"
<li><a href="#">query = sequence with maxspan=1m [file where event.type in ("creation", "change") and process.pid == 4 and file.extension : "exe"] by host.id, file.path [process where event.type == "start"] by host.id, process.executable"
<li><a href="#">query = sequence with maxspan=1m [process where event.type != "end" and ((process.name : ("cmd.exe", "wscript.exe", "rundll32.exe", "regsvr32.exe", "wmic.exe", "mshta.exe", "powershell.exe", "pwsh.exe", "powershell_ise.exe", "wmiprvse.exe", "wsmprovhost.exe", "winrshost.exe") or process.pe.original_file_name : ("cmd.exe", "wscript.exe", "rundll32.exe", "regsvr32.exe", "wmic.exe", "mshta.exe", "powershell.exe", "pwsh.dll", "powershell_ise.exe", "wmiprvse.exe", "wsmprovhost.exe", "winrshost.exe")) or process.code_signature.trusted == false)] by process.entity_id [process where event.type == "start" and (process.name : "schtasks.exe" or process.pe.original_file_name == "schtasks.exe") and process.args : ("/create", "-create") and process.args : ("/ru", "/sc", "/tn", "/tr", "/f", "/xml") and not (?process.ext.token.integrity_level_name : "system" or ?winlog.event_data.integritylevel : "system") ] by process.parent.entity_id"
<li><a href="#">query = sequence with maxspan=1m [process where event.type == "start" and process.name : "mshta.exe" and process.args : "-embedding" ] by host.id, process.entity_id [network where event.type == "start" and process.name : "mshta.exe" and network.direction : ("incoming", "ingress") and network.transport == "tcp" and source.port > 49151 and destination.port > 49151 and source.ip != "127.0.0.1" and source.ip != "::1" ] by host.id, process.entity_id"
<li><a href="#">query = sequence with maxspan=1m [process where event.type == "start" and process.name : "sdclt.exe" and process.args : "/kickoffelev" ] by process.entity_id [process where event.type == "start" and process.parent.name : "sdclt.exe" and not (process.executable : "c:\\windows\\system32\\sdclt.exe" or process.executable : "c:\\windows\\system32\\control.exe" or process.executable : "c:\\windows\\syswow64\\sdclt.exe" or process.executable : "c:\\windows\\syswow64\\control.exe") ] by process.parent.entity_id"
<li><a href="#">query = sequence with maxspan=1s [network where process.name : "services.exe" and network.direction : ("incoming", "ingress") and network.transport == "tcp" and source.port >= 49152 and destination.port >= 49152 and source.ip != "127.0.0.1" and source.ip != "::1" ] by host.id, process.entity_id [process where event.type == "start" and process.parent.name : "services.exe" and not (process.name : "svchost.exe" and process.args : "tiledatamodelsvc") and not (process.name : "msiexec.exe" and process.args : "/v") and not process.executable : ("?:\\windows\\adcr_agent\\adcrsvc.exe", "?:\\windows\\system32\\vssvc.exe", "?:\\windows\\servicing\\trustedinstaller.exe", "?:\\windows\\system32\\svchost.exe", "?:\\program files (x86)\\*.exe", "?:\\program files\\*.exe", "?:\\windows\\psexesvc.exe", "?:\\windows\\system32\\sppsvc.exe", "?:\\windows\\system32\\wbem\\wmiapsrv.exe", "?:\\windows\\remoteauditservice.exe", "?:\\windows\\veeamvsssupport\\veeamguesthelper.exe", "?:\\windows\\veeamlogshipper\\veeamlogshipper.exe", "?:\\windows\\cainvokerservice.exe", "?:\\windows\\system32\\upfc.exe", "?:\\windows\\adminarsenal\\pdq*.exe", "?:\\windows\\system32\\vds.exe", "?:\\windows\\veeam\\backup\\veeamdeploymentsvc.exe", "?:\\windows\\propatches\\scheduler\\stschedex.exe", "?:\\windows\\system32\\certsrv.exe", "?:\\windows\\eset-remote-install-service.exe", "?:\\pella corporation\\pella order management\\gpautosvc.exe", "?:\\pella corporation\\osctogpautoservice\\osctogpautosvc.exe", "?:\\pella corporation\\pella order management\\gpautosvc.exe", "?:\\windows\\syswow64\\nwxexesvc\\nwxexesvc.exe", "?:\\windows\\system32\\taskhostex.exe") ] by host.id, process.parent.entity_id"
<li><a href="#">query = sequence with maxspan=2h [file where event.type != "deletion" and file.extension : "exe" and (process.name : "acrord32.exe" or process.name : "rdrcef.exe" or process.name : "foxitphantompdf.exe" or process.name : "foxitreader.exe") and not (file.name : "foxitphantompdf.exe" or file.name : "foxitphantompdfupdater.exe" or file.name : "foxitreader.exe" or file.name : "foxitreaderupdater.exe" or file.name : "acrord32.exe" or file.name : "rdrcef.exe") ] by host.id, file.path [process where event.type == "start"] by host.id, process.executable"
<li><a href="#">query = sequence with maxspan=2h [file where event.type != "deletion" and file.extension : "exe" and (process.name : "winword.exe" or process.name : "excel.exe" or process.name : "outlook.exe" or process.name : "powerpnt.exe" or process.name : "eqnedt32.exe" or process.name : "fltldr.exe" or process.name : "mspub.exe" or process.name : "msaccess.exe") ] by host.id, file.path [process where event.type == "start"] by host.id, process.executable"
<li><a href="#">query = sequence with maxspan=5s [process where event.type == "start" and not process.parent.executable : ("?:\\windows\\softwaredistribution\\*.exe", "?:\\program files\\elastic\\agent\\data\\*.exe", "?:\\program files (x86)\\trend micro\\*.exe") ] by host.id, process.executable, process.parent.entity_id [file where event.type == "change" and event.action == "overwrite" and file.extension == "exe"] by host.id, file.path, process.entity_id"
<li><a href="#">query = sequence with maxspan=5s [process where event.type == "start" and process.name : "svchost.exe" and user.domain : "nt authority" and user.name : "local service"] by process.entity_id [network where network.protocol : "dns" and process.name : "svchost.exe" and dns.question.name : "wpad" and process.name : "svchost.exe"] by process.entity_id [network where process.name : "svchost.exe" and network.direction : ("outgoing", "egress") and destination.port == 80] by process.entity_id [library where event.type : "start" and process.name : "svchost.exe" and dll.name : "jscript.dll" and process.name : "svchost.exe"] by process.entity_id [process where event.type == "start" and process.parent.name : "svchost.exe"] by process.parent.entity_id"
<li><a href="#">query: ((((((((((((process.executable:*\\\\cammute.exe and (not (process.executable:(*\\\\lenovo\\\\communication\\ utility\\\\* or *\\\\lenovo\\\\communications\\ utility\\\\*)))) or (process.executable:*\\\\chrome_frame_helper.exe and (not (process.executable:*\\\\google\\\\chrome\\\\application\\\\*)))) or (process.executable:*\\\\dvcemumanager.exe and (not (process.executable:*\\\\microsoft\\ device\\ emulator\\\\*)))) or (process.executable:*\\\\gadget.exe and (not (process.executable:*\\\\windows\\ media\\ player\\\\*)))) or (process.executable:*\\\\hcc.exe and (not (process.executable:*\\\\html\\ help\\ workshop\\\\*)))) or (process.executable:*\\\\hkcmd.exe and (not (process.executable:(*\\\\system32\\\\* or *\\\\sysnative\\\\* or *\\\\syswow64\\\\*))))) or (process.executable:*\\\\mc.exe and (not (process.executable:(*\\\\microsoft\\ visual\\ studio* or *\\\\microsoft\\ sdk* or *\\\\windows\\ kit*))))) or (process.executable:*\\\\msmpeng.exe and (not (process.executable:(*\\\\microsoft\\ security\\ client\\\\* or *\\\\windows\\ defender\\\\* or *\\\\antimalware\\\\*))))) or (process.executable:*\\\\msseces.exe and (not (process.executable:(*\\\\microsoft\\ security\\ center\\\\* or *\\\\microsoft\\ security\\ client\\\\* or *\\\\microsoft\\ security\\ essentials\\\\*))))) or (process.executable:*\\\\oinfop11.exe and (not (process.executable:*\\\\common\\ files\\\\microsoft\\ shared\\\\*)))) or (process.executable:*\\\\oleview.exe and (not (process.executable:(*\\\\microsoft\\ visual\\ studio* or *\\\\microsoft\\ sdk* or *\\\\windows\\ kit* or *\\\\windows\\ resource\\ kit\\\\*))))) or (process.executable:*\\\\rc.exe and (not (process.executable:(*\\\\microsoft\\ visual\\ studio* or *\\\\microsoft\\ sdk* or *\\\\windows\\ kit* or *\\\\windows\\ resource\\ kit\\\\* or *\\\\microsoft.net\\\\*)))))
<li><a href="#">query: ((((((winlog.event_data.originalfilename:(\"sc.exe\" or \"net.exe\" or \"net1.exe\")) or (process.executable.text:(*\\\\sc.exe or *\\\\net.exe or *\\\\net1.exe))) and process.command_line.text:*\\ stop\\ *) and (not (process.command_line.text:(\"sc  stop kscwebconsolemessagequeue\" or \"sc  stop lghubupdaterservice\") and user.name:(*authori* or *autori*))))) or ((process.executable.text:(*\\\\powershell.exe or *\\\\pwsh.exe) and process.command_line.text:*stop\\-service\\ *)))
<li><a href="#">query: (((((\"\\ \\-w\\ \" and \"hidden\" and ((\"\\-nop\" and \"\\ \\-c\\ \" and (\"\\[convert\\]\\:\\:frombase64string\" or (*\\-noni* and *iex* and *new\\-object*))) or (*\\-ep* and *bypass* and *\\-enc*))) or (*powershell* and *reg* and *add* and *hkcu\\\\software\\\\microsoft\\\\windows\\\\currentversion\\\\run*)) or (*bypass* and *\\-noprofile* and *\\-windowstyle* and *hidden* and *new\\-object* and *system.net.webclient* and *.download*)) or (*iex* and *new\\-object* and *net.webclient* and *.download*)) and (not ((*\\(new\\-object\\ system.net.webclient\\).downloadstring\\('https\\:\\/\\/community.chocolatey.org\\/install.ps1* or *\\(new\\-object\\ system.net.webclient\\).downloadstring\\('https\\:\\/\\/chocolatey.org\\/install.ps1'\\)* or *write\\-chocolateywarning*))))
<li><a href="#">query: (((((process.executable.text:*\\\\odbcconf.exe) or (winlog.event_data.originalfilename:\"odbcconf.exe\")) and process.command_line.text:(*\\-a* or *\\-f* or *\\/a* or *\\/f* or *regsvr*))) or ((process.parent.executable.text:*\\\\odbcconf.exe and process.executable.text:*\\\\rundll32.exe)))
<li><a href="#">query: ((((contextinfo:*\\-nop* and contextinfo:*\\ \\-w\\ * and contextinfo:*hidden* and contextinfo:*\\ \\-c\\ * and contextinfo:*\\[convert\\]\\:\\:frombase64string*)) or ((contextinfo:*\\ \\-w\\ * and contextinfo:*hidden* and contextinfo:*\\-noni* and contextinfo:*\\-nop* and contextinfo:*\\ \\-c\\ * and contextinfo:*iex* and contextinfo:*new\\-object*)) or ((contextinfo:*\\ \\-w\\ * and contextinfo:*hidden* and contextinfo:*\\-ep* and contextinfo:*bypass* and contextinfo:*\\-enc*)) or ((contextinfo:*powershell* and contextinfo:*reg* and contextinfo:*add* and contextinfo:*hkcu\\\\software\\\\microsoft\\\\windows\\\\currentversion\\\\run*)) or ((contextinfo:*bypass* and contextinfo:*\\-noprofile* and contextinfo:*\\-windowstyle* and contextinfo:*hidden* and contextinfo:*new\\-object* and contextinfo:*system.net.webclient* and contextinfo:*.download*)) or ((contextinfo:*iex* and contextinfo:*new\\-object* and contextinfo:*net.webclient* and contextinfo:*.download*))) and (not ((contextinfo:(*\\(new\\-object\\ system.net.webclient\\).downloadstring\\('https\\:\\/\\/community.chocolatey.org\\/install.ps1* or *write\\-chocolateywarning*)))))
<li><a href="#">query: ((((cs-uri-query:*\\/..\\/vpns\\/*) or (cs-uri-query:*\\/vpns\\/cfg\\/smb.conf))) or ((cs-uri-query:*\\/vpns\\/portal\\/scripts\\/* and cs-uri-query:*.pl*)))
<li><a href="#">query: ((((dll.path:(*\\\\wsmsvc.dll or *\\\\wsmauto.dll or *\\\\microsoft.wsman.management.ni.dll) or winlog.event_data.originalfilename:(\"wsmsvc.dll\" or \"wsmanautomation.dll\" or \"microsoft.wsman.management.dll\")) or (process.executable.text:*\\\\svchost.exe and winlog.event_data.originalfilename:\"wsmwmipl.dll\")) and (not ((process.executable.text:(*\\\\powershell.exe or *c\\:\\\\windows\\\\system32\\\\sdiagnhost.exe or *c\\:\\\\windows\\\\system32\\\\services.exe)) or (process.command_line.text:(*svchost.exe\\ \\-k\\ netsvcs\\ \\-p\\ \\-s\\ bits* or *svchost.exe\\ \\-k\\ graphicsperfsvcgroup\\ \\-s\\ graphicsperfsvc* or *svchost.exe\\ \\-k\\ networkservice\\ \\-p\\ \\-s\\ wecsvc* or *svchost.exe\\ \\-k\\ netsvcs*)) or (process.executable.text:(c\\:\\\\windows\\\\microsoft.net\\\\framework64\\\\v* or c\\:\\\\windows\\\\microsoft.net\\\\framework\\\\v*) and process.executable.text:*\\\\mscorsvw.exe) or (process.executable.text:(\"c\\:\\\\windows\\\\system32\\\\configure\\-smremoting.exe\" or \"c\\:\\\\windows\\\\system32\\\\servermanager.exe\")) or (process.executable.text:c\\:\\\\windows\\\\temp\\\\asgard2\\-agent\\\\*) or (process.executable.text:c\\:\\\\program\\ files\\\\citrix\\\\*) or (process.executable.text:*\\\\powershell_ise.exe) or (process.executable.text:c\\:\\\\$windows.\\~bt\\\\sources\\\\*)))) and (not ((process.executable.text:*\\\\svchost.exe and not _exists_:process.command_line.text))))
<li><a href="#">query: ((((dll.path:*\\\\log.dll and (not ((dll.path:(c\\:\\\\program\\ files\\\\bitdefender\\ antivirus\\ free\\\\* or c\\:\\\\program\\ files\\ \\(x86\\)\\\\bitdefender\\ antivirus\\ free\\\\*)) or (process.executable.text:\"c\\:\\\\program\\ files\\\\dell\\\\saremediation\\\\audit\\\\telemetryutility.exe\" and dll.path:(\"c\\:\\\\program\\ files\\\\dell\\\\saremediation\\\\plugin\\\\log.dll\" or \"c\\:\\\\program\\ files\\\\dell\\\\saremediation\\\\audit\\\\log.dll\")) or (dll.path:c\\:\\\\program\\ files\\\\canon\\\\myprinter\\\\*)))) or (dll.path:*\\\\qrt.dll and (not (dll.path:(c\\:\\\\program\\ files\\\\f\\-secure\\\\anti\\-virus\\\\* or c\\:\\\\program\\ files\\ \\(x86\\)\\\\f\\-secure\\\\anti\\-virus\\\\*))))) or (dll.path:(*\\\\ashldres.dll or *\\\\lockdown.dll or *\\\\vsodscpl.dll) and (not (dll.path:(c\\:\\\\program\\ files\\\\mcafee\\\\* or c\\:\\\\program\\ files\\ \\(x86\\)\\\\mcafee\\\\*))))) or (dll.path:*\\\\vftrace.dll and (not (dll.path:(c\\:\\\\program\\ files\\\\cyberark\\\\endpoint\\ privilege\\ manager\\\\agent\\\\x32\\\\* or c\\:\\\\program\\ files\\ \\(x86\\)\\\\cyberark\\\\endpoint\\ privilege\\ manager\\\\agent\\\\x32\\\\*)))))
<li><a href="#">query: ((((file.path:*\\\\inetpub\\\\wwwroot\\\\* and file.path:(*.asp* or *.ashx* or *.ph*)) and (not (file.path:(*\\\\appdata\\\\local\\\\temp\\\\* or *\\\\windows\\\\temp\\\\*)))) or ((file.path:(*\\\\www\\\\* or *\\\\htdocs\\\\* or *\\\\html\\\\*) and file.path:*.ph*) and (not (file.path:(*\\\\appdata\\\\local\\\\temp\\\\* or *\\\\windows\\\\temp\\\\*))))) or ((file.path:*.jsp or (file.path:*\\\\cgi\\-bin\\\\* and file.path:*.pl*)) and (not (file.path:(*\\\\appdata\\\\local\\\\temp\\\\* or *\\\\windows\\\\temp\\\\*)))))
<li><a href="#">query: ((((powershell.command.invocation_details:*set\\-psreadlineoption* or winlog.event_data.payload:*set\\-psreadlineoption*) and (powershell.command.invocation_details:*–historysavestyle* or winlog.event_data.payload:*–historysavestyle*) and (powershell.command.invocation_details:*savenothing* or winlog.event_data.payload:*savenothing*)) or ((powershell.command.invocation_details:*set\\-psreadlineoption* or winlog.event_data.payload:*set\\-psreadlineoption*) and (powershell.command.invocation_details:*\\-historysavestyle* or winlog.event_data.payload:*\\-historysavestyle*) and (powershell.command.invocation_details:*savenothing* or winlog.event_data.payload:*savenothing*))) or ((powershell.command.invocation_details:(*del* or *remove\\-item* or *rm*) or winlog.event_data.payload:(*del* or *remove\\-item* or *rm*)) and (powershell.command.invocation_details:*\\(get\\-psreadlineoption\\).historysavepath* or winlog.event_data.payload:*\\(get\\-psreadlineoption\\).historysavepath*)))
<li><a href="#">query: ((((powershell.file.script_block_text:*\\-nop* and powershell.file.script_block_text:*\\ \\-w\\ * and powershell.file.script_block_text:*hidden* and powershell.file.script_block_text:*\\ \\-c\\ * and powershell.file.script_block_text:*\\[convert\\]\\:\\:frombase64string*)) or ((powershell.file.script_block_text:*\\ \\-w\\ * and powershell.file.script_block_text:*hidden* and powershell.file.script_block_text:*\\-noni* and powershell.file.script_block_text:*\\-nop* and powershell.file.script_block_text:*\\ \\-c\\ * and powershell.file.script_block_text:*iex* and powershell.file.script_block_text:*new\\-object*)) or ((powershell.file.script_block_text:*\\ \\-w\\ * and powershell.file.script_block_text:*hidden* and powershell.file.script_block_text:*\\-ep* and powershell.file.script_block_text:*bypass* and powershell.file.script_block_text:*\\-enc*)) or ((powershell.file.script_block_text:*powershell* and powershell.file.script_block_text:*reg* and powershell.file.script_block_text:*add* and powershell.file.script_block_text:*hkcu\\\\software\\\\microsoft\\\\windows\\\\currentversion\\\\run*)) or ((powershell.file.script_block_text:*bypass* and powershell.file.script_block_text:*\\-noprofile* and powershell.file.script_block_text:*\\-windowstyle* and powershell.file.script_block_text:*hidden* and powershell.file.script_block_text:*new\\-object* and powershell.file.script_block_text:*system.net.webclient* and powershell.file.script_block_text:*.download*)) or ((powershell.file.script_block_text:*iex* and powershell.file.script_block_text:*new\\-object* and powershell.file.script_block_text:*net.webclient* and powershell.file.script_block_text:*.download*))) and (not ((powershell.file.script_block_text:(*\\(new\\-object\\ system.net.webclient\\).downloadstring\\('https\\:\\/\\/community.chocolatey.org\\/install.ps1* or *\\(new\\-object\\ system.net.webclient\\).downloadstring\\('https\\:\\/\\/chocolatey.org\\/install.ps1'\\)* or *write\\-chocolateywarning*)))))
<li><a href="#">query: ((((process.command_line.text:*\\-nop* and process.command_line.text:*\\ \\-w\\ * and process.command_line.text:*hidden* and process.command_line.text:*\\ \\-c\\ * and process.command_line.text:*\\[convert\\]\\:\\:frombase64string*)) or ((process.command_line.text:*\\ \\-w\\ * and process.command_line.text:*hidden* and process.command_line.text:*\\-noni* and process.command_line.text:*\\-nop* and process.command_line.text:*\\ \\-c\\ * and process.command_line.text:*iex* and process.command_line.text:*new\\-object*)) or ((process.command_line.text:*\\ \\-w\\ * and process.command_line.text:*hidden* and process.command_line.text:*\\-ep* and process.command_line.text:*bypass* and process.command_line.text:*\\-enc*)) or ((process.command_line.text:*powershell* and process.command_line.text:*reg* and process.command_line.text:*add* and process.command_line.text:*\\\\software\\\\*)) or ((process.command_line.text:*bypass* and process.command_line.text:*\\-noprofile* and process.command_line.text:*\\-windowstyle* and process.command_line.text:*hidden* and process.command_line.text:*new\\-object* and process.command_line.text:*system.net.webclient* and process.command_line.text:*.download*)) or ((process.command_line.text:*iex* and process.command_line.text:*new\\-object* and process.command_line.text:*net.webclient* and process.command_line.text:*.download*))) and (not ((process.command_line.text:(*\\(new\\-object\\ system.net.webclient\\).downloadstring\\('https\\:\\/\\/community.chocolatey.org\\/install.ps1* or *write\\-chocolateywarning*)))))
<li><a href="#">query: ((((process.command_line.text:*7z.exe\\ a\\ \\-v500m\\ \\-mx9\\ \\-r0\\ \\-p*) or ((process.parent.command_line.text:*wscript.exe* and process.parent.command_line.text:*.vbs* and process.command_line.text:*rundll32.exe* and process.command_line.text:*c\\:\\\\windows* and process.command_line.text:*.dll,tk_*)) or ((process.parent.executable.text:*\\\\rundll32.exe and process.parent.command_line.text:*c\\:\\\\windows* and process.command_line.text:*cmd.exe\\ \\/c\\ *)) or ((process.command_line.text:*rundll32\\ c\\:\\\\windows\\\\* and process.command_line.text:*.dll\\ *)))) or (((process.parent.executable.text:*\\\\rundll32.exe and process.executable.text:*\\\\dllhost.exe) and (not (process.command_line.text:(\"\" or \"\"))))))
<li><a href="#">query: ((((process.command_line:*7z.exe\\ a\\ \\-v500m\\ \\-mx9\\ \\-r0\\ \\-p* or (process.parent.command_line:*wscript.exe* and process.parent.command_line:*.vbs* and process.command_line:*rundll32.exe* and process.command_line:*c\\:\\\\windows* and process.command_line:*.dll,tk_*)) or (process.parent.executable:*\\\\rundll32.exe and process.parent.command_line:*c\\:\\\\windows* and process.command_line:*cmd.exe\\ \\/c\\ *)) or (process.command_line:*rundll32\\ c\\:\\\\windows\\\\* and process.command_line:*.dll\\ *)) or ((process.parent.executable:*\\\\rundll32.exe and process.executable:*\\\\dllhost.exe) and (not (process.command_line:(\"\\ \" or \"\")))))
<li><a href="#">query: ((((process.executable.text:(*\\/apt or *\\/apt\\-get) and process.command_line.text:*install*)) or ((process.executable.text:*\\/yum and process.command_line.text:(*localinstall* or *install*))) or ((process.executable.text:*\\/rpm and process.command_line.text:*\\-i*)) or ((process.executable.text:*\\/dpkg and process.command_line.text:(*\\-\\-install* or *\\-i*)))) and process.command_line.text:(*nmap* or *\\ nc* or *netcat* or *wireshark* or *tshark* or *openconnect* or *proxychains*))
<li><a href="#">query: ((((process.executable.text:(*\\\\powershell.exe or *\\\\pwsh.exe or *\\\\cmd.exe)) or (winlog.event_data.originalfilename:(\"powershell.exe\" or \"pwsh.dll\" or \"cmd.exe\"))) and (user.name:(*authori* or *autori*) and logonid:\"0x3e7\")) and (not (((process.parent.executable.text:(c\\:\\\\windows\\\\system32\\\\* or c\\:\\\\program\\ files\\ \\(x86\\)\\\\* or c\\:\\\\program\\ files\\\\*) and process.executable.text:(*\\\\cmd.exe or *\\\\powershell.exe))) or ((process.parent.executable.text:\"c:\\manageengine\\admanager plus\\pgsql\\bin\\postgres.exe\" and process.executable.text:*\\\\cmd.exe)) or ((process.parent.executable.text:c\\:\\\\windows\\\\syswow64\\\\config\\\\systemprofile\\\\citrix\\\\updaterbinaries\\\\* and process.parent.executable.text:*\\\\citrixreceiverupdater.exe and process.executable.text:*\\\\cmd.exe)) or ((process.parent.executable.text:*\\\\python.exe and process.command_line.text:\"c:\\windows\\system32\\cmd.exe /c \"ver\"\" and process.working_directory.text:*c\\:\\\\windows\\\\temp\\\\asgard2\\-agent\\\\*)))))
<li><a href="#">query: ((((process.executable.text:(*\\\\powershell.exe or *\\\\pwsh.exe)) or (winlog.event_data.originalfilename:(\"powershell.exe\" or \"pwsh.dll\")) or (winlog.event_data.description:\"windows powershell\") or (product:\"powershell core 6\")) and process.command_line.text:(*bxor* or *\\-join\\ * or *\\-join'* or *\\-join\\\"* or *\\-join`* or *char*)) and (not (((process.parent.executable.text:\"c:\\program files\\amazon\\ssm\\ssm-document-worker.exe\")) or ((process.command_line.text:*function\\ convert\\-guidtocompressedguid* and process.command_line.text:*valuefrompipelinebypropertyname* and process.command_line.text:*\\:\\:parseexact\\(* and process.command_line.text:*kb\\[000000\\-999999\\]*)))))
<li><a href="#">query: ((((process.executable.text:(*\\\\powershell.exe or *\\\\pwsh.exe)) or (winlog.event_data.originalfilename:(\"powershell.exe\" or \"pwsh.dll\"))) and process.command_line.text:(*\\ \\-e\\ * or *\\ \\-en\\ * or *\\ \\-enc\\ * or *\\ \\-enco*) and process.command_line.text:(*\\ jab* or *\\ suvyi* or *\\ sqbfafga* or *\\ awv4i* or *\\ iab* or *\\ paa* or *\\ aqblahga*)) and (not ((process.parent.executable.text:(*c\\:\\\\packages\\\\plugins\\\\microsoft.guestconfiguration.configurationforwindows\\\\* or *\\\\gc_worker.exe*)))))
<li><a href="#">query: ((((process.executable.text:(*python.exe or *python3.exe or *python2.exe)) or (winlog.event_data.originalfilename:\"python.exe\")) and process.command_line.text:*\\ \\-c*) and (not (((process.parent.executable.text:c\\:\\\\program\\ files\\\\python* and process.parent.executable.text:*\\\\python.exe)) or (process.parent.executable.text:*\\\\appdata\\\\local\\\\programs\\\\microsoft\\ vs\\ code\\\\code.exe))))
<li><a href="#">query: ((((process.executable.text:*\\\\agentexecutor.exe) or (winlog.event_data.originalfilename:\"agentexecutor.exe\")) and process.command_line.text:(*\\ \\-powershell* or *\\ \\-remediationscript*)) and (not (process.command_line.text:(*c\\:\\\\windows\\\\syswow64\\\\windowspowershell\\\\v1.0\\\\* or *c\\:\\\\windows\\\\system32\\\\windowspowershell\\\\v1.0\\\\*))))
<li><a href="#">query: ((((process.executable.text:*\\\\appcmd.exe) or (winlog.event_data.originalfilename:\"appcmd.exe\")) and process.command_line.text:*list\\ *) and ((process.command_line.text:(*\\ \\/config* or *\\ \\/xml*)) or ((process.command_line.text:(*\\ \\/@t* or *\\ \\/text* or *\\ \\/show*) and process.command_line.text:(*\\:\\\\** or *password*)))))
<li><a href="#">query: ((((process.executable.text:*\\\\cmd.exe and process.command_line.text:*\\ \\/c* and process.command_line.text:*dir\\ * and process.command_line.text:*\\\\users\\\\*) and (not (process.command_line.text:*\\ rmdir\\ *)))) or (((process.executable.text:(*\\\\net.exe or *\\\\net1.exe) and process.command_line.text:*user*) and (not (process.command_line.text:(*\\/domain* or *\\/add* or *\\/delete* or *\\/active* or *\\/expires* or *\\/passwordreq* or *\\/scriptpath* or *\\/times* or *\\/workstations*))))) or (process.executable.text:(*\\\\whoami.exe or *\\\\quser.exe or *\\\\qwinsta.exe)) or ((process.executable.text:*\\\\wmic.exe and process.command_line.text:*useraccount* and process.command_line.text:*get*)) or ((process.executable.text:*\\\\cmdkey.exe and process.command_line.text:*\\ \\/l*)))
<li><a href="#">query: ((((process.executable.text:*\\\\curl.exe) or (product:\"the curl executable\")) and ((process.command_line.text:(*\\\\appdata\\\\* or *\\\\users\\\\public\\\\* or *\\\\temp\\\\* or *%appdata%* or *%temp%* or *%tmp%* or *%public%* or *\\\\desktop\\\\* or *c\\:\\\\perflogs\\\\*)) or (process.command_line.text:(*.jpg or *.jpeg or *.png or *.gif or *.tmp or *.temp or *.txt)) or (process.command_line.text:(*\\ \\-o* or *\\-\\-remote\\-name* or *\\-\\-output*)))) and (not (process.parent.executable.text:\"c:\\program files\\git\\usr\\bin\\sh.exe\" and process.executable.text:\"c:\\program files\\git\\mingw64\\bin\\curl.exe\" and process.command_line.text:*\\-\\-silent\\ \\-\\-show\\-error\\ \\-\\-output\\ * and process.command_line.text:*gfw\\-httpget\\-*)))
<li><a href="#">query: ((((process.executable.text:*\\\\mstsc.exe or winlog.event_data.originalfilename:\"mstsc.exe\") and process.command_line.text:*\\ \\/v\\:*) and (not ((process.parent.executable.text:\"c\\:\\\\windows\\\\system32\\\\lxss\\\\wslhost.exe\" and process.command_line.text:*c\\:\\\\programdata\\\\microsoft\\\\wsl\\\\wslg.rdp*)))) or ((process.executable.text:*\\\\cmdkey.exe or winlog.event_data.originalfilename:\"cmdkey.exe\") and (process.command_line.text:*\\ \\/g* and process.command_line.text:*\\ \\/u* and process.command_line.text:*\\ \\/p*)))
<li><a href="#">query: ((((process.executable.text:*\\\\tracker.exe) or (winlog.event_data.description:\"tracker\")) and process.command_line.text:(*\\ \\/d\\ * or *\\ \\/c\\ *)) and (not ((process.command_line.text:*\\ \\/errorreport\\:prompt\\ *) or (process.parent.executable.text:(*\\\\msbuild\\\\current\\\\bin\\\\msbuild.exe or *\\\\msbuild\\\\current\\\\bin\\\\amd64\\\\msbuild.exe)))))
<li><a href="#">query: ((((process.executable.text:*\\\\wevtutil.exe and process.command_line.text:(*clear\\-log\\ * or *\\ cl\\ * or *set\\-log\\ * or *\\ sl\\ * or *lfn\\:*))) or ((process.executable.text:(*\\\\powershell.exe or *\\\\pwsh.exe) and process.command_line.text:(*clear\\-eventlog\\ * or *remove\\-eventlog\\ * or *limit\\-eventlog\\ * or *clear\\-winevent\\ *))) or ((process.executable.text:*\\\\wmic.exe and process.command_line.text:*\\ cleareventlog\\ *))) and (not ((process.parent.executable.text:(\"c:\\windows\\syswow64\\msiexec.exe\" or \"c:\\windows\\system32\\msiexec.exe\") and process.command_line.text:*\\ sl\\ *))))
<li><a href="#">query: ((((process.executable.text:*\\\\windows\\\\installer\\\\* and process.executable.text:*msi* and process.executable.text:*tmp) or (process.executable.text:*\\\\msiexec.exe and integritylevel:\"system\")) and user.name:(*authori* or *autori*)) and (not ((process.parent.executable.text:\"c\\:\\\\windows\\\\system32\\\\services.exe\") or (process.command_line.text:*\\\\system32\\\\msiexec.exe\\ \\/v or process.parent.command_line.text:*\\\\system32\\\\msiexec.exe\\ \\/v) or (process.parent.executable.text:(c\\:\\\\programdata\\\\sophos\\\\* or c\\:\\\\programdata\\\\avira\\\\* or c\\:\\\\program\\ files\\\\avast\\ software\\\\* or c\\:\\\\program\\ files\\ \\(x86\\)\\\\avast\\ software\\\\* or c\\:\\\\program\\ files\\\\google\\\\update\\\\* or c\\:\\\\program\\ files\\ \\(x86\\)\\\\google\\\\update\\\\*)))))
<li><a href="#">query: ((((process.executable.text:*\\\\wmic.exe) or (winlog.event_data.originalfilename:\"wmic.exe\")) and process.command_line.text:(*process* or *qfe*)) and (not (process.command_line.text:*call* and process.command_line.text:*create*)))
<li><a href="#">query: ((((process.executable:(*\\\\powershell.exe or *\\\\pwsh.exe or *\\\\wmic.exe or *\\\\vssadmin.exe or *\\\\diskshadow.exe) or winlog.event_data.originalfilename:(\"powershell.exe\" or \"pwsh.dll\" or \"wmic.exe\" or \"vssadmin.exe\" or \"diskshadow.exe\")) and (process.command_line:*shadow* and process.command_line:*delete*)) or ((process.executable:*\\\\wbadmin.exe or winlog.event_data.originalfilename:\"wbadmin.exe\") and (process.command_line:*delete* and process.command_line:*catalog* and process.command_line:*quiet*))) or ((process.executable:*\\\\vssadmin.exe or winlog.event_data.originalfilename:\"vssadmin.exe\") and (process.command_line:*resize* and process.command_line:*shadowstorage* and process.command_line:*unbounded*)))
<li><a href="#">query: ((((process.executable:*\\\\whoami.exe and (not (process.parent.executable:(*\\\\cmd.exe or *\\\\powershell.exe)))) and (not (process.parent.executable:(\"c\\:\\\\program\\ files\\\\microsoft\\ monitoring\\ agent\\\\agent\\\\monitoringhost.exe\" or \"\")))) and (not (not _exists_:process.parent.executable))) or process.command_line:(*whoami\\ \\-all* or *whoami\\ \\/all* or *whoami.exe\\ \\-all* or *whoami.exe\\ \\/all*))
<li><a href="#">query: ((((winlog.event_data.calltrace:*c\\:\\\\windows\\\\system32\\\\ntdll.dll\\+* and winlog.event_data.calltrace:*|c\\:\\\\windows\\\\system32\\\\kernelbase.dll\\+* and winlog.event_data.calltrace:*|unknown\\(* and winlog.event_data.calltrace:*\\)*) or (winlog.event_data.calltrace:*unknown\\(* and winlog.event_data.calltrace:*\\)|unknown\\(* and winlog.event_data.calltrace:*\\))) or (winlog.event_data.calltrace:*unknown* and winlog.event_data.grantedaccess:(\"0x1f0fff\" or \"0x1f1fff\" or \"0x143a\" or \"0x1410\" or \"0x1010\" or \"0x1f2fff\" or \"0x1f3fff\" or \"0x1fffff\"))) and (not ((process.executable:(*\\\\windows\\\\system32\\\\sdiagnhost.exe or *\\\\procexp64.exe or *\\\\procexp.exe or *\\\\microsoft\\ vs\\ code\\\\code.exe or *\\\\aurora\\-agent\\-64.exe or *\\\\aurora\\-agent.exe or *\\\\git\\\\usr\\\\bin\\\\sh.exe or *\\\\ide\\\\devenv.exe or *\\\\githubdesktop\\\\update.exe or *\\\\runtimebroker.exe or *\\\\backgroundtaskhost.exe or *\\\\githubdesktop.exe) or process.executable:(c\\:\\\\program\\ files\\ \\(x86\\)\\\\* or c\\:\\\\program\\ files\\\\* or c\\:\\\\windows\\\\microsoft.net\\\\framework\\\\*\\\\ngentask.exe* or c\\:\\\\program\\ files\\ \\(x86\\)\\\\microsoft\\ visual\\ studio\\\\* or c\\:\\\\program\\ files\\\\microsoft\\ visual\\ studio\\\\* or c\\:\\\\windows\\\\microsoft.net\\\\framework* or c\\:\\\\windows\\\\system32\\\\driverstore\\\\* or c\\:\\\\windows\\\\system32\\\\windowspowershell\\\\*) or process.executable:(c\\:\\\\users\\\\*\\\\appdata\\\\local\\\\programs\\\\microsoft\\ vs\\ code\\\\code.exe or \"c\\:\\\\windows\\\\system32\\\\taskhostw.exe\" or \"c\\:\\\\windows\\\\system32\\\\ctfmon.exe\" or \"c\\:\\\\windows\\\\system32\\\\nhnotifsys.exe\" or \"c\\:\\\\windows\\\\immersivecontrolpanel\\\\systemsettings.exe\" or \"c\\:\\\\windows\\\\explorer.exe\") or winlog.event_data.targetimage:\"c\\:\\\\windows\\\\system32\\\\runtimebroker.exe\" or winlog.event_data.targetimage:*\\\\microsoft\\ vs\\ code\\\\code.exe or winlog.event_data.calltrace:*|c\\:\\\\windows\\\\system32\\\\rpcrt4.dll\\+*) or (process.executable:\"c\\:\\\\windows\\\\explorer.exe\" and winlog.event_data.targetimage:(\"c\\:\\\\windows\\\\system32\\\\backgroundtaskhost.exe\" or \"c\\:\\\\windows\\\\explorer.exe\")) or (process.executable:c\\:\\\\programdata\\\\microsoft\\\\windows\\ defender\\\\platform\\\\* and process.executable:*\\\\msmpeng.exe) or (process.executable:*\\\\eclipse.exe and winlog.event_data.calltrace:(*\\\\jre\\\\bin\\\\java.dll* or *|c\\:\\\\windows\\\\system32\\\\windows.storage.dll\\+* or *\\\\configuration\\\\org.eclipse.osgi\\\\*)) or (process.executable:\"c\\:\\\\windows\\\\system32\\\\openwith.exe\" and winlog.event_data.targetimage:\"c\\:\\\\windows\\\\explorer.exe\"))))
<li><a href="#">query: ((((winlog.event_data.calltrace:*c\\:\\\\windows\\\\system32\\\\ntdll.dll\\+* and winlog.event_data.calltrace:*|c\\:\\\\windows\\\\system32\\\\kernelbase.dll\\+* and winlog.event_data.calltrace:*|unknown\\(* and winlog.event_data.calltrace:*\\)*) or (winlog.event_data.calltrace:*unknown\\(* and winlog.event_data.calltrace:*\\)|unknown\\(* and winlog.event_data.calltrace:*\\))) or (winlog.event_data.calltrace:*unknown* and winlog.event_data.grantedaccess:(\"0x1f0fff\" or \"0x1f1fff\" or \"0x143a\" or \"0x1410\" or \"0x1010\" or \"0x1f2fff\" or \"0x1f3fff\" or \"0x1fffff\"))) and (not ((process.executable:(*\\\\windows\\\\system32\\\\sdiagnhost.exe or *\\\\procexp64.exe or *\\\\procexp.exe or *\\\\microsoft\\ vs\\ code\\\\code.exe or *\\\\aurora\\-agent\\-64.exe or *\\\\aurora\\-agent.exe or *\\\\git\\\\usr\\\\bin\\\\sh.exe or *\\\\ide\\\\devenv.exe or *\\\\githubdesktop\\\\update.exe or *\\\\runtimebroker.exe or *\\\\backgroundtaskhost.exe or *\\\\githubdesktop.exe) or process.executable:(c\\:\\\\program\\ files\\ \\(x86\\)\\\\* or c\\:\\\\program\\ files\\\\* or c\\:\\\\windows\\\\microsoft.net\\\\framework\\\\*\\\\ngentask.exe* or c\\:\\\\program\\ files\\ \\(x86\\)\\\\microsoft\\ visual\\ studio\\\\* or c\\:\\\\program\\ files\\\\microsoft\\ visual\\ studio\\\\* or c\\:\\\\windows\\\\microsoft.net\\\\framework* or c\\:\\\\windows\\\\system32\\\\driverstore\\\\* or c\\:\\\\windows\\\\system32\\\\windowspowershell\\\\*) or process.executable:(c\\:\\\\users\\\\*\\\\appdata\\\\local\\\\programs\\\\microsoft\\ vs\\ code\\\\code.exe or \"c\\:\\\\windows\\\\system32\\\\taskhostw.exe\" or \"c\\:\\\\windows\\\\system32\\\\ctfmon.exe\" or \"c\\:\\\\windows\\\\system32\\\\nhnotifsys.exe\" or \"c\\:\\\\windows\\\\immersivecontrolpanel\\\\systemsettings.exe\" or \"c\\:\\\\windows\\\\explorer.exe\") or winlog.event_data.targetimage:\"c\\:\\\\windows\\\\system32\\\\runtimebroker.exe\" or winlog.event_data.targetimage:*\\\\microsoft\\ vs\\ code\\\\code.exe or winlog.event_data.calltrace:*|c\\:\\\\windows\\\\system32\\\\rpcrt4.dll\\+*) or (process.executable:\"c\\:\\\\windows\\\\explorer.exe\" and winlog.event_data.targetimage:(\"c\\:\\\\windows\\\\system32\\\\backgroundtaskhost.exe\" or \"c\\:\\\\windows\\\\explorer.exe\")) or (process.executable:c\\:\\\\programdata\\\\microsoft\\\\windows\\ defender\\\\platform\\\\* and process.executable:*\\\\msmpeng.exe) or (process.executable:*\\\\eclipse.exe and winlog.event_data.calltrace:(*\\\\jre\\\\bin\\\\java.dll* or *|c\\:\\\\windows\\\\system32\\\\windows.storage.dll\\+* or *\\\\configuration\\\\org.eclipse.osgi\\\\*)))))
<li><a href="#">query: ((((winlog.event_data.hashes:(*md5\\=a179c4093d05a3e1ee73f6ff07f994aa* or *sha1\\=5d6b9e80e12bfc595d4d26f6afb099b3cb471dd4* or *sha256\\=4b5229b3250c8c08b98cb710d6c056144271de099a57ae09f5d2097fc41bd4f1*)) or (md5:\"a179c4093d05a3e1ee73f6ff07f994aa\") or (sha1:\"5d6b9e80e12bfc595d4d26f6afb099b3cb471dd4\") or (sha256:\"4b5229b3250c8c08b98cb710d6c056144271de099a57ae09f5d2097fc41bd4f1\"))) or ((dll.path:*\\\\aswarpot.sys and ((signed:\"false\") or (signaturestatus:\"expired\")))))
<li><a href="#">query: ((((winlog.event_data.originalfilename:\"cmd.exe\") or (process.executable.text:*\\\\cmd.exe)) and process.command_line.text:*>*) and (not process.command_line.text:(*c\\:\\\\program\\ files\\ \\(x86\\)\\\\internet\\ download\\ manager\\\\idmmsghost.exe* or *chrome\\-extension\\:\\/\\/* or *\\\\.\\\\pipe\\\\chrome.nativemessaging*)))
<li><a href="#">query: ((((winlog.event_id:\"30\" and searchfilter:(*\\(grouptype\\:1.2.840.113556.1.4.803\\:\\=2147483648\\)* or *\\(grouptype\\:1.2.840.113556.1.4.803\\:\\=2147483656\\)* or *\\(grouptype\\:1.2.840.113556.1.4.803\\:\\=2147483652\\)* or *\\(grouptype\\:1.2.840.113556.1.4.803\\:\\=2147483650\\)* or *\\(samaccounttype\\=805306369\\)* or *\\(samaccounttype\\=805306368\\)* or *\\(samaccounttype\\=536870913\\)* or *\\(samaccounttype\\=536870912\\)* or *\\(samaccounttype\\=268435457\\)* or *\\(samaccounttype\\=268435456\\)* or *\\(objectcategory\\=grouppolicycontainer\\)* or *\\(objectcategory\\=organizationalunit\\)* or *\\(objectcategory\\=computer\\)* or *\\(objectcategory\\=ntdsdsa\\)* or *\\(objectcategory\\=server\\)* or *\\(objectcategory\\=domain\\)* or *\\(objectcategory\\=person\\)* or *\\(objectcategory\\=group\\)* or *\\(objectcategory\\=user\\)* or *\\(objectclass\\=trusteddomain\\)* or *\\(objectclass\\=computer\\)* or *\\(objectclass\\=server\\)* or *\\(objectclass\\=group\\)* or *\\(objectclass\\=user\\)* or *\\(primarygroupid\\=521\\)* or *\\(primarygroupid\\=516\\)* or *\\(primarygroupid\\=515\\)* or *\\(primarygroupid\\=512\\)* or *domain\\ admins* or *objectguid\\=\\\\** or *\\(schemaidguid\\=\\\\*\\)*)) and (not (winlog.event_id:\"30\" and searchfilter:(*\\(domainsid\\=\\*\\)* or *\\(objectsid\\=\\*\\)*))))) or ((winlog.event_id:\"30\" and searchfilter:(*\\(useraccountcontrol\\:1.2.840.113556.1.4.803\\:\\=4194304\\)* or *\\(useraccountcontrol\\:1.2.840.113556.1.4.803\\:\\=2097152\\)* or *\\!\\(useraccountcontrol\\:1.2.840.113556.1.4.803\\:\\=1048574\\)* or *\\(useraccountcontrol\\:1.2.840.113556.1.4.803\\:\\=524288\\)* or *\\(useraccountcontrol\\:1.2.840.113556.1.4.803\\:\\=65536\\)* or *\\(useraccountcontrol\\:1.2.840.113556.1.4.803\\:\\=8192\\)* or *\\(useraccountcontrol\\:1.2.840.113556.1.4.803\\:\\=544\\)* or *\\!\\(useraccountcontrol\\:1.2.840.113556.1.4.803\\:\\=2\\)* or *msds\\-allowedtoactonbehalfofotheridentity* or *msds\\-allowedtodelegateto* or *msds\\-groupmanagedserviceaccount* or *\\(accountexpires\\=9223372036854775807\\)* or *\\(accountexpires\\=0\\)* or *\\(admincount\\=1\\)* or *ms\\-mcs\\-admpwd*))))
<li><a href="#">query: (((*new\\-mailboxexportrequest* and *\\ \\-mailbox\\ *) and (*\\-filepath\\ \\\"\\\\\\\\localhost\\\\c$* or *\\-filepath\\ \\\"\\\\\\\\127.0.0.1\\\\c$* or *.aspx*)) or (*new\\-managementroleassignment* and *\\ \\-role\\ \\\"mailbox\\ import\\ export\\\"* and *\\ \\-user\\ *))
<li><a href="#">query: (((contextinfo:*\\-nop* and contextinfo:*\\ \\-w\\ * and contextinfo:*hidden* and contextinfo:*\\ \\-c\\ * and contextinfo:*\\[convert\\]\\:\\:frombase64string*) or (contextinfo:*\\ \\-w\\ * and contextinfo:*hidden* and contextinfo:*\\-noni* and contextinfo:*\\-nop* and contextinfo:*\\ \\-c\\ * and contextinfo:*iex* and contextinfo:*new\\-object*) or (contextinfo:*\\ \\-w\\ * and contextinfo:*hidden* and contextinfo:*\\-ep* and contextinfo:*bypass* and contextinfo:*\\-enc*) or (contextinfo:*powershell* and contextinfo:*reg* and contextinfo:*add* and contextinfo:*hkcu\\\\software\\\\microsoft\\\\windows\\\\currentversion\\\\run*) or (contextinfo:*bypass* and contextinfo:*\\-noprofile* and contextinfo:*\\-windowstyle* and contextinfo:*hidden* and contextinfo:*new\\-object* and contextinfo:*system.net.webclient* and contextinfo:*.download*) or (contextinfo:*iex* and contextinfo:*new\\-object* and contextinfo:*net.webclient* and contextinfo:*.download*)) and (not ((contextinfo:(*\\(new\\-object\\ system.net.webclient\\).downloadstring\\('https\\:\\/\\/community.chocolatey.org\\/install.ps1* or *write\\-chocolateywarning*)))))
<li><a href="#">query: (((cs-method:\"post\" and sc-status:\"200\" and cs-uri-stem:\"/ecp/ddi/ddiservice.svc/setobject\" and cs-uri-query:*schema\\=reset* and cs-uri-query:*virtualdirectory* and cs-username:*$)) or ((*post* and \"200\" and */ecp/ddi/ddiservice.svc/setobject* and *schema=reset* and *virtualdirectory* and *$*)))
<li><a href="#">query: (((cs-uri-query:*..%2f*) or ((cs-uri-query:*..%2f* and cs-uri-query:*apply_abstract.cgi*))) and cs-uri-query:(*\\/images\\/* or *\\/js\\/* or *\\/css\\/* or *\\/setup_top_login.htm* or *\\/login.html* or *\\/loginerror.html* or *\\/loginexclude.html* or *\\/loginlock.html*))
<li><a href="#">query: (((cs-uri-query:*?dwn\\=* and cs-uri-query:*&fn\\=* and cs-uri-query:*.html?*)) or ((cs-uri-query:*&dwn\\=* and cs-uri-query:*?fn\\=* and cs-uri-query:*.html?*)))
<li><a href="#">query: (((cs-uri-query:*\\/api\\/v2.0\\/user\\/remoteserver.saml* and http.request.method:\"post\") and (not (cs-referer:*\\/root\\/user\\/remote\\-user\\/saml\\-user\\/*))) and (not (not _exists_:cs-referer)))
<li><a href="#">query: (((cs-uri-query:*logoimagehandler.ashx* and cs-uri-query:*clazz*)) or ((cs-uri-query:*logoimagehandler.ashx* and http.response.status_code:\"500\")))
<li><a href="#">query: (((eventsource:\"sts.amazonaws.com\" and eventname:\"assumerolewithsaml\")) or ((eventsource:\"iam.amazonaws.com\" and eventname:\"updatesamlprovider\")))
<li><a href="#">query: (((file.name:(\\\\mojo.5688.8052.183894939787088877* or \\\\mojo.5688.8052.35780273329370473* or \\\\mypipe\\-f* or \\\\mypipe\\-h* or \\\\ntsvcs* or \\\\scerpc* or \\\\win_svc* or \\\\spoolss* or \\\\msrpc_* or \\\\win\\\\msrpc_* or \\\\wkssvc* or \\\\f53f* or \\\\windows.update.manager* or \\\\searchtextharvester* or \\\\dsernamepipe* or \\\\pgmessagepipe* or \\\\msftewds* or \\\\f4c3* or \\\\fullduplex_* or \\\\rpc_*) or file.name:(\"\\\\demoagent_11\" or \"\\\\demoagent_22\")) or (file.name:\\\\winsock2\\\\catalogchangelistener\\-* and file.name:*\\-0,)) and (not (file.name:(\"\\\\wkssvc\" or \"\\\\spoolss\" or \"\\\\scerpc\" or \"\\\\ntsvcs\" or \"\\\\searchtextharvester\" or \"\\\\pgmessagepipe\" or \"\\\\msftewds\"))))
<li><a href="#">query: (((file.path.text:*\\\\inetpub\\\\wwwroot\\\\* and file.path.text:(*.asp* or *.ashx* or *.ph*)) or (file.path.text:(*\\\\www\\\\* or *\\\\htdocs\\\\* or *\\\\html\\\\*) and file.path.text:*.ph*)) and (not ((file.path.text:(*\\\\appdata\\\\local\\\\temp\\\\* or *\\\\windows\\\\temp\\\\*)) or (process.executable.text:\"system\") or (file.path.text:*\\\\xampp*))))
<li><a href="#">query: (((file.path:(*\\\\dbghelp.dll or *\\\\dbgcore.dll) and (process.executable:(*\\\\msbuild.exe or *\\\\cmd.exe or *\\\\rundll32.exe or *\\\\word.exe or *\\\\excel.exe or *\\\\powerpnt.exe or *\\\\outlook.exe or *\\\\monitoringhost.exe or *\\\\wmic.exe or *\\\\bash.exe or *\\\\wscript.exe or *\\\\cscript.exe or *\\\\mshta.exe or *\\\\schtasks.exe or *\\\\dnx.exe or *\\\\regsvcs.exe or *\\\\sc.exe or *\\\\scriptrunner.exe) or signed:\"false\")) and (not (process.executable:*visual\\ studio* or process.command_line:(*\\-k\\ localsystemnetworkrestricted* or *\\-k\\ unistacksvcgroup\\ \\-s\\ wpnuserservice*)))) and (not (process.command_line:(\"c\\:\\\\windows\\\\winsxs\\*\\\\tiworker.exe\\ \\-embedding\" or \"c\\:\\\\windows\\\\system32\\\\svchost.exe\\ \\-k\\ netsvcs\\ \\-p\\ \\-s\\ wuauserv\" or \"c\\:\\\\windows\\\\system32\\\\svchost.exe\\ \\-k\\ wersvcgroup\"))))
<li><a href="#">query: (((file.path:*\\\\microsoft\\\\word\\\\startup\\\\* and file.path:*.wll) or (file.path:*\\\\microsoft\\\\excel\\\\startup\\\\* and file.path:*.xll)) or (file.path:*\\\\microsoft\\\\addins\\\\* and file.path:(*.xlam or *.xla)))
<li><a href="#">query: (((http.request.method:\"post\" and cs-uri-query:*\\/service\\/extension\\/backup\\/mboximport\\?* and cs-uri-query:*account\\-name* and cs-uri-query:*ow* and cs-uri-query:*no\\-switch* and cs-uri-query:*append* and http.response.status_code:(\"401\" or \"200\"))) or ((cs-uri-query:*\\/zimbraadmin\\/* and cs-uri-query:*.jsp and http.response.status_code:*200*)))
<li><a href="#">query: (((integritylevel:\"system\" and user.name:(*authori* or *autori*)) and (process.executable.text:(*\\\\calc.exe or *\\\\wscript.exe or *\\\\cscript.exe or *\\\\hh.exe or *\\\\mshta.exe or *\\\\forfiles.exe or *\\\\ping.exe) or process.command_line.text:(*\\ \\-nop\\ * or *\\ \\-w\\ hidden\\ * or *\\ \\-decode\\ * or *\\ \\/decode\\ * or *\\ \\/urlcache\\ * or *\\ \\-urlcache\\ * or *\\ \\-e*\\ jab* or *\\ \\-e*\\ suvyi* or *\\ \\-e*\\ sqbfafga* or *\\ \\-e*\\ awv4i* or *\\ \\-e*\\ iab* or *\\ \\-e*\\ paa* or *\\ \\-e*\\ aqblahga* or *vssadmin\\ delete\\ shadows* or *reg\\ save\\ hklm* or *\\ \\-ma\\ * or *microsoft\\\\windows\\\\currentversion\\\\run* or *.downloadstring\\(* or *.downloadfile\\(* or *\\ \\/ticket\\:* or *dpapi\\:\\:* or *event\\:\\:clear* or *event\\:\\:drop* or *id\\:\\:modify* or *kerberos\\:\\:* or *lsadump\\:\\:* or *misc\\:\\:* or *privilege\\:\\:* or *rpc\\:\\:* or *sekurlsa\\:\\:* or *sid\\:\\:* or *token\\:\\:* or *vault\\:\\:cred* or *vault\\:\\:list* or *\\ p\\:\\:d\\ * or *;iex\\(* or *minidump* or *net\\ user\\ *))) and (not ((process.command_line.text:\"ping\\ 127.0.0.1\\ \\-n\\ 5\") or (process.executable.text:*\\\\ping.exe and process.parent.command_line.text:*\\\\dismfodinstall.cmd*) or (process.parent.executable.text:c\\:\\\\packages\\\\plugins\\\\microsoft.guestconfiguration.configurationforwindows\\\\*))))
<li><a href="#">query: (((powershell.command.invocation_details:*\\&&* or winlog.event_data.payload:*\\&&*) and (powershell.command.invocation_details:*rundll32* or winlog.event_data.payload:*rundll32*) and (powershell.command.invocation_details:*shell32.dll* or winlog.event_data.payload:*shell32.dll*) and (powershell.command.invocation_details:*shellexec_rundll* or winlog.event_data.payload:*shellexec_rundll*)) and (powershell.command.invocation_details:(*value* or *invoke* or *comspec* or *iex*) or winlog.event_data.payload:(*value* or *invoke* or *comspec* or *iex*)))
<li><a href="#">query: (((powershell.command.invocation_details:*new\\-object* or winlog.event_data.payload:*new\\-object*) and (powershell.command.invocation_details:*text.encoding\\]\\:\\:ascii* or winlog.event_data.payload:*text.encoding\\]\\:\\:ascii*)) and (powershell.command.invocation_details:(*system.io.compression.deflatestream* or *system.io.streamreader*) or winlog.event_data.payload:(*system.io.compression.deflatestream* or *system.io.streamreader*)) and (powershell.command.invocation_details:*readtoend or winlog.event_data.payload:*readtoend))
<li><a href="#">query: (((powershell.command.invocation_details:*set*) or (winlog.event_data.payload:*set*)) and ((powershell.command.invocation_details:*\\&&*) or (winlog.event_data.payload:*\\&&*)) and ((powershell.command.invocation_details:*mshta*) or (winlog.event_data.payload:*mshta*)) and ((powershell.command.invocation_details:*vbscript\\:createobject*) or (winlog.event_data.payload:*vbscript\\:createobject*)) and ((powershell.command.invocation_details:*.run*) or (winlog.event_data.payload:*.run*)) and ((powershell.command.invocation_details:*\\(window.close\\)*) or (winlog.event_data.payload:*\\(window.close\\)*)))
<li><a href="#">query: (((powershell.file.script_block_text:*\\-nop* and powershell.file.script_block_text:*\\ \\-w\\ * and powershell.file.script_block_text:*hidden* and powershell.file.script_block_text:*\\ \\-c\\ * and powershell.file.script_block_text:*\\[convert\\]\\:\\:frombase64string*) or (powershell.file.script_block_text:*\\ \\-w\\ * and powershell.file.script_block_text:*hidden* and powershell.file.script_block_text:*\\-noni* and powershell.file.script_block_text:*\\-nop* and powershell.file.script_block_text:*\\ \\-c\\ * and powershell.file.script_block_text:*iex* and powershell.file.script_block_text:*new\\-object*) or (powershell.file.script_block_text:*\\ \\-w\\ * and powershell.file.script_block_text:*hidden* and powershell.file.script_block_text:*\\-ep* and powershell.file.script_block_text:*bypass* and powershell.file.script_block_text:*\\-enc*) or (powershell.file.script_block_text:*powershell* and powershell.file.script_block_text:*reg* and powershell.file.script_block_text:*add* and powershell.file.script_block_text:*hkcu\\\\software\\\\microsoft\\\\windows\\\\currentversion\\\\run*) or (powershell.file.script_block_text:*bypass* and powershell.file.script_block_text:*\\-noprofile* and powershell.file.script_block_text:*\\-windowstyle* and powershell.file.script_block_text:*hidden* and powershell.file.script_block_text:*new\\-object* and powershell.file.script_block_text:*system.net.webclient* and powershell.file.script_block_text:*.download*) or (powershell.file.script_block_text:*iex* and powershell.file.script_block_text:*new\\-object* and powershell.file.script_block_text:*net.webclient* and powershell.file.script_block_text:*.download*)) and (not ((powershell.file.script_block_text:(*\\(new\\-object\\ system.net.webclient\\).downloadstring\\('https\\:\\/\\/community.chocolatey.org\\/install.ps1* or *\\(new\\-object\\ system.net.webclient\\).downloadstring\\('https\\:\\/\\/chocolatey.org\\/install.ps1'\\)* or *write\\-chocolateywarning*)))))
<li><a href="#">query: (((previouscreationutctime:2022* and (not (creationutctime:2022*))) or (previouscreationutctime:202* and (not (creationutctime:202*)))) and (not ((process.executable.text:(\"c\\:\\\\windows\\\\system32\\\\provtool.exe\" or \"c\\:\\\\windows\\\\system32\\\\usocoreworker.exe\" or \"c\\:\\\\windows\\\\immersivecontrolpanel\\\\systemsettings.exe\") or file.path.text:c\\:\\\\programdata\\\\usoprivate\\\\updatestore\\\\* or file.path.text:(*.tmp or *.temp)) or (process.executable.text:c\\:\\\\windows\\\\* and process.executable.text:*\\\\tiworker.exe and file.path.text:*.cab))))
<li><a href="#">query: (((process.command_line.text:(*copy\\-item* or *copy* or *cpi\\ * or *\\ cp\\ * or *move* or *move\\-item* or *\\ mi\\ * or *\\ mv\\ *)) or (process.executable.text:(*\\\\xcopy.exe or *\\\\robocopy.exe)) or (winlog.event_data.originalfilename:(\"xcopy.exe\" or \"robocopy.exe\"))) and process.command_line.text:(*\\\\opera\\ software\\\\opera\\ stable\\\\* or *\\\\mozilla\\\\firefox\\\\profiles* or *\\\\microsoft\\\\edge\\\\user\\ data\\\\* or *\\\\google\\\\chrome\\\\user\\ data\\\\*))
<li><a href="#">query: (((process.command_line.text:(*dumpcreds* or *invoke\\-mimikatz*) or (process.command_line.text:(*rpc* or *token* or *crypto* or *dpapi* or *sekurlsa* or *kerberos* or *lsadump* or *privilege* or *process* or *vault*) and process.command_line.text:*\\:\\:*)) or (process.command_line.text:(*aadcookie* or *detours* or *memssp* or *mflt* or *ncroutemon* or *ngcsign* or *printnightmare* or *skeleton* or *preshutdown* or *mstsc* or *multirdp*) and process.command_line.text:*\\:\\:*)) and (not ((process.command_line.text:*function\\ convert\\-guidtocompressedguid*) or (process.parent.executable.text:*\\\\appdata\\\\local\\\\programs\\\\microsoft\\ vs\\ code\\\\code.exe and process.command_line.text:*\\/d\\ \\/s\\ \\/c\\ * and process.command_line.text:*checkfilenameiocs\\ \\-\\-ioc\\-path\\ *))))
<li><a href="#">query: (((process.command_line.text:*\\\\cmd.exe\\ \\/c\\ whoami* and process.parent.executable.text:c\\:\\\\temp*) or (process.command_line.text:(*cmd.exe\\ \\/c\\ echo* or *>\\ \\\\\\\\.\\\\pipe* or *\\\\whoami.exe*) and process.parent.executable.text:*\\\\dllhost.exe) or (process.executable.text:*\\\\cmd.exe and process.parent.executable.text:*\\\\runonce.exe and process.parent.command_line.text:*\\\\runonce.exe)) or ((process.command_line.text:*conhost.exe\\ 0xffffffff\\ \\-forcev1* and process.parent.command_line.text:(*\\/c\\ whoami* or *cmd.exe\\ \\/c\\ echo* or *\\ >\\ \\\\\\\\.\\\\pipe*)) and (not (process.parent.command_line.text:(*c\\:\\\\program\\ files\\ \\(x86\\)\\\\internet\\ download\\ manager\\\\idmmsghost.exe* or *chrome\\-extension\\:\\/\\/*)))))
<li><a href="#">query: (((process.command_line.text:*impersonate.exe* and process.command_line.text:(*\\ list\\ * or *\\ exec\\ * or *\\ adduser\\ *))) or (((winlog.event_data.hashes:(*md5\\=9520714ab576b0ed01d1513691377d01* or *sha256\\=e81cc96e2118dc4fbfe5bad1604e0ac7681960143e2101e1a024d52264bb0a8a* or *imphash\\=0a358ffc1697b7a07d0e817ac740df62*)) or (md5:\"9520714ab576b0ed01d1513691377d01\") or (sha256:\"e81cc96e2118dc4fbfe5bad1604e0ac7681960143e2101e1a024d52264bb0a8a\") or (winlog.event_data.imphash:\"0a358ffc1697b7a07d0e817ac740df62\"))))
<li><a href="#">query: (((process.command_line.text:*javascript\\:* and process.command_line.text:*.registerxll*) or (process.command_line.text:*url.dll* and process.command_line.text:*openurl*) or (process.command_line.text:*url.dll* and process.command_line.text:*openurla*) or (process.command_line.text:*url.dll* and process.command_line.text:*fileprotocolhandler*) or (process.command_line.text:*zipfldr.dll* and process.command_line.text:*routethecall*) or (process.command_line.text:*shell32.dll* and process.command_line.text:*control_rundll*) or (process.command_line.text:*shell32.dll* and process.command_line.text:*shellexec_rundll*) or (process.command_line.text:*mshtml.dll* and process.command_line.text:*printhtml*) or (process.command_line.text:*advpack.dll* and process.command_line.text:*launchinfsection*) or (process.command_line.text:*advpack.dll* and process.command_line.text:*registerocx*) or (process.command_line.text:*ieadvpack.dll* and process.command_line.text:*launchinfsection*) or (process.command_line.text:*ieadvpack.dll* and process.command_line.text:*registerocx*) or (process.command_line.text:*ieframe.dll* and process.command_line.text:*openurl*) or (process.command_line.text:*shdocvw.dll* and process.command_line.text:*openurl*) or (process.command_line.text:*syssetup.dll* and process.command_line.text:*setupinfobjectinstallaction*) or (process.command_line.text:*setupapi.dll* and process.command_line.text:*installhinfsection*) or (process.command_line.text:*pcwutl.dll* and process.command_line.text:*launchapplication*) or (process.command_line.text:*dfshim.dll* and process.command_line.text:*shopenverbapplication*) or (process.command_line.text:*dfshim.dll* and process.command_line.text:*shopenverbshortcut*) or (process.command_line.text:*scrobj.dll* and process.command_line.text:*generatetypelib* and process.command_line.text:*http*) or (process.command_line.text:*shimgvw.dll* and process.command_line.text:*imageview_fullscreen* and process.command_line.text:*http*)) and (not (process.command_line.text:*shell32.dll,control_rundll\\ desk.cpl,screensaver,@screensaver*)))
<li><a href="#">query: (((process.command_line.text:*localgroup\\ * and process.command_line.text:*\\ \\/add*) or (process.command_line.text:*add\\-localgroupmember\\ * and process.command_line.text:*\\ \\-group\\ *)) and process.command_line.text:(*\\ administrators\\ * or *\\ administrateur*))
<li><a href="#">query: (((process.command_line.text:*localgroup\\ * and process.command_line.text:*\\ \\/add*) or (process.command_line.text:*add\\-localgroupmember\\ * and process.command_line.text:*\\ \\-group\\ *)) and process.command_line.text:(*remote\\ desktop\\ users* or *utilisateurs\\ du\\ bureau\\ à\\ distance* or *usuarios\\ de\\ escritorio\\ remoto*))
<li><a href="#">query: (((process.command_line:(*dumpcreds* or *invoke\\-mimikatz*) or (process.command_line:(*rpc* or *token* or *crypto* or *dpapi* or *sekurlsa* or *kerberos* or *lsadump* or *privilege* or *process* or *vault*) and process.command_line:*\\:\\:*)) or (process.command_line:(*aadcookie* or *detours* or *memssp* or *mflt* or *ncroutemon* or *ngcsign* or *printnightmare* or *skeleton* or *preshutdown* or *mstsc* or *multirdp*) and process.command_line:*\\:\\:*)) and (not ((process.command_line:*function\\ convert\\-guidtocompressedguid*))))
<li><a href="#">query: (((process.command_line:*\\ \\-e* and process.command_line:*\\ jab* and process.command_line:*\\ \\-w* and process.command_line:*\\ hidden\\ *) or (process.command_line:*\\ \\-e* and process.command_line:(*\\ ba\\^j* or *\\ suvyi* or *\\ sqbfafga* or *\\ aqblahga* or *\\ awv4i* or *\\ iaa* or *\\ iab* or *\\ uwb* or *\\ cwb*)) or process.command_line:*.exe\\ \\-encod\\ *) and (not (process.command_line:*\\ \\-executionpolicy* and process.command_line:*remotesigned\\ *)))
<li><a href="#">query: (((process.command_line:*\\/updatedeploymentprovider* and process.command_line:*\\/runhandlercomserver* and process.command_line:*.dll*) and (process.executable:*\\\\wuauclt.exe or winlog.event_data.originalfilename:\"wuauclt.exe\")) and (not (process.command_line:(*\\ \\/classid\\ * or *\\ wuaueng.dll\\ *))))
<li><a href="#">query: (((process.command_line:*lsass* and process.command_line:*.dmp*) and (not (process.executable:*\\\\werfault.exe))) or (process.executable:*\\\\procdump* and process.executable:*.exe and process.command_line:*lsass*))
<li><a href="#">query: (((process.command_line:*reg\\ * and process.command_line:*add*) or process.command_line:(*powershell* or *set\\-itemproperty* or *\\ sp\\ * or *new\\-itemproperty*)) and (integritylevel:\"medium\" and process.command_line:*controlset* and process.command_line:*services* and process.command_line:(*imagepath* or *failurecommand* or *servicedll*)))
<li><a href="#">query: (((process.executable.text:(*\\\\$recycle.bin\\\\* or *\\\\config\\\\systemprofile\\\\* or *\\\\intel\\\\logs\\\\* or *\\\\rsa\\\\machinekeys\\\\* or *\\\\users\\\\all\\ users\\\\* or *\\\\users\\\\default\\\\* or *\\\\users\\\\networkservice\\\\* or *\\\\users\\\\public\\\\* or *\\\\windows\\\\addins\\\\* or *\\\\windows\\\\debug\\\\* or *\\\\windows\\\\fonts\\\\* or *\\\\windows\\\\help\\\\* or *\\\\windows\\\\ime\\\\* or *\\\\windows\\\\media\\\\* or *\\\\windows\\\\repair\\\\* or *\\\\windows\\\\security\\\\* or *\\\\windows\\\\system32\\\\tasks\\\\* or *\\\\windows\\\\tasks\\\\*)) or (process.executable.text:c\\:\\\\perflogs\\\\*)) and (not ((process.executable.text:c\\:\\\\users\\\\public\\\\ibm\\\\clientsolutions\\\\start_programs\\\\*) or ((process.executable.text:c\\:\\\\windows\\\\syswow64\\\\config\\\\systemprofile\\\\citrix\\\\updaterbinaries\\\\* and process.executable.text:*\\\\citrixreceiverupdater.exe)))))
<li><a href="#">query: (((process.executable.text:(*\\\\cacls.exe or *\\\\icacls.exe or *\\\\net.exe or *\\\\net1.exe) and process.command_line.text:*\\/grant*) or (process.executable.text:*\\\\attrib.exe and process.command_line.text:*\\-r*) or process.executable.text:*\\\\takeown.exe) and (not ((process.command_line.text:*icacls\\ c\\:\\\\programdata\\\\dynatrace\\\\gateway\\\\config\\\\connectivity.history\\ \\/reset) or (process.command_line.text:*icacls\\ c\\:\\\\programdata\\\\dynatrace\\\\gateway\\\\config\\\\config.properties\\ \\/grant\\ \\:r\\ * and process.command_line.text:*s\\-1\\-5\\-19\\:f*) or (process.command_line.text:*\\\\appdata\\\\local\\\\programs\\\\microsoft\\ vs\\ code* or process.parent.executable.text:*\\\\microsoft\\ vs\\ code\\\\code.exe))))
<li><a href="#">query: (((process.executable.text:(*\\\\cmd.exe or *\\\\powershell.exe or *\\\\pwsh.exe or *\\\\wscript.exe or *\\\\cscript.exe or *\\\\sh.exe or *\\\\bash.exe or *\\\\msbuild.exe) and file.path.text:(c\\:\\\\users\\\\public* or c\\:\\\\perflogs*))) or ((process.executable.text:(*\\\\schtasks.exe or *\\\\wmic.exe or *\\\\mshta.exe or *\\\\forfiles.exe or *\\\\scriptrunner.exe or *\\\\certutil.exe) and file.path.text:(*c\\:\\\\users\\\\public* or *c\\:\\\\perflogs* or *\\\\appdata\\\\* or *c\\:\\\\windows\\\\temp*))))
<li><a href="#">query: (((process.executable.text:(*\\\\cmd.exe or *\\\\powershell.exe)) or (winlog.event_data.originalfilename:(\"cmd.exe\" or \"powershell.exe\"))) and (process.command_line.text:*echo* and process.command_line.text:*>* and process.command_line.text:*\\\\\\\\.\\\\pipe\\\\*))
<li><a href="#">query: (((process.executable.text:(*\\\\git.exe or *\\\\git\\-remote\\-https.exe)) or (winlog.event_data.originalfilename:\"git.exe\")) and process.command_line.text:(*\\ clone\\ * or *git\\-remote\\-https\\ *) and process.command_line.text:(*exploit* or *vulns* or *vulnerability* or *remotecodeexecution* or *invoke\\-* or *cve\\-* or *poc\\-* or *proofofconcept* or *proxyshell* or *log4shell* or *eternalblue* or *eternal\\-blue* or *ms17\\-*))
<li><a href="#">query: (((process.executable.text:(*\\\\ntdsdump.exe or *\\\\ntdsdumpex.exe) or (process.command_line.text:*ntds.dit* and process.command_line.text:*system.hiv*) or process.command_line.text:*ntdsgrab.ps1*) or (process.command_line.text:*ac\\ i\\ ntds* and process.command_line.text:*create\\ full*) or (process.command_line.text:*\\/c\\ copy\\ * and process.command_line.text:*\\\\windows\\\\ntds\\\\ntds.dit*) or (process.command_line.text:*activate\\ instance\\ ntds* and process.command_line.text:*create\\ full*) or (process.command_line.text:*powershell* and process.command_line.text:*ntds.dit*)) or (process.command_line.text:*ntds.dit* and (process.parent.executable.text:(*\\\\apache* or *\\\\tomcat* or *\\\\appdata\\\\* or *\\\\temp\\\\* or *\\\\public\\\\* or *\\\\perflogs\\\\*) or process.executable.text:(*\\\\apache* or *\\\\tomcat* or *\\\\appdata\\\\* or *\\\\temp\\\\* or *\\\\public\\\\* or *\\\\perflogs\\\\*))))
<li><a href="#">query: (((process.executable.text:(*\\\\powershell.exe or *\\\\pwsh.exe or *\\\\powershell_ise.exe)) or (winlog.event_data.originalfilename:\"powershell.exe\")) and (process.command_line.text:*set\\-netfirewallprofile\\ * and process.command_line.text:*\\ \\-enabled\\ * and process.command_line.text:*\\ false*) and process.command_line.text:(*\\ \\-all\\ * or *public* or *domain* or *private*))
<li><a href="#">query: (((process.executable.text:(*\\\\powershell.exe or *\\\\pwsh.exe)) or (process.command_line.text:(*\\/c\\ powershell* or *\\/c\\ pwsh*)) or (winlog.event_data.description:\"windows powershell\") or (product:\"powershell core 6\") or (winlog.event_data.originalfilename:(\"powershell.exe\" or \"pwsh.dll\"))) and ((process.parent.executable.text:(*\\\\mshta.exe or *\\\\rundll32.exe or *\\\\regsvr32.exe or *\\\\services.exe or *\\\\winword.exe or *\\\\wmiprvse.exe or *\\\\powerpnt.exe or *\\\\excel.exe or *\\\\msaccess.exe or *\\\\mspub.exe or *\\\\visio.exe or *\\\\outlook.exe or *\\\\amigo.exe or *\\\\chrome.exe or *\\\\firefox.exe or *\\\\iexplore.exe or *\\\\microsoftedgecp.exe or *\\\\microsoftedge.exe or *\\\\browser.exe or *\\\\vivaldi.exe or *\\\\safari.exe or *\\\\sqlagent.exe or *\\\\sqlserver.exe or *\\\\sqlservr.exe or *\\\\w3wp.exe or *\\\\httpd.exe or *\\\\nginx.exe or *\\\\php\\-cgi.exe or *\\\\jbosssvc.exe or *\\\\microsoftedgesh.exe)) or (process.parent.executable.text:*tomcat*)))
<li><a href="#">query: (((process.executable.text:(*\\\\powershell.exe or *\\\\pwsh.exe)) or (winlog.event_data.originalfilename:(\"powershell.exe\" or \"pwsh.dll\"))) and process.command_line.text:(*add\\-aadint* or *convertto\\-aadint* or *disable\\-aadint* or *enable\\-aadint* or *export\\-aadint* or *get\\-aadint* or *grant\\-aadint* or *install\\-aadint* or *invoke\\-aadint* or *join\\-aadint* or *new\\-aadint* or *open\\-aadint* or *read\\-aadint* or *register\\-aadint* or *remove\\-aadint* or *restore\\-aadint* or *search\\-aadint* or *send\\-aadint* or *set\\-aadint* or *start\\-aadint* or *update\\-aadint*))
<li><a href="#">query: (((process.executable.text:(*\\\\powershell.exe or *\\\\pwsh.exe)) or (winlog.event_data.originalfilename:(\"powershell.exe\" or \"pwsh.dll\"))) and process.command_line.text:(*tgblafqalgb3aeuaqg* or *4azqbuac4adwbfaeia* or *oaguavaauahcarqbca* or *bgbfahqalgb3aguayg* or *4arqb0ac4adwblagia* or *uaeuadaauahcazqbia* or *tgbfahqalgb3aguayg* or *oaeuadaauahcazqbia* or *bgblafqalgb3aguayg* or *4azqbuac4adwblagia* or *uaguavaauahcazqbia* or *tgblafqalgb3aguayg* or *oaguavaauahcazqbia* or *bgbfafqalgb3aguayg* or *4arqbuac4adwblagia* or *uaeuavaauahcazqbia* or *bgblahqalgbxaguayg* or *4azqb0ac4avwblagia* or *uaguadaauafcazqbia* or *bgbfahqalgbxaguayg* or *4arqb0ac4avwblagia* or *uaeuadaauafcazqbia* or *tgbfahqalgbxaguayg* or *oaeuadaauafcazqbia* or *bgblafqalgbxaguayg* or *4azqbuac4avwblagia* or *uaguavaauafcazqbia* or *tgblafqalgbxaguayg* or *oaguavaauafcazqbia* or *bgbfafqalgbxaguayg* or *4arqbuac4avwblagia* or *uaeuavaauafcazqbia* or *bgblahqalgb3aeuayg* or *4azqb0ac4adwbfagia* or *uaguadaauahcarqbia* or *tgblahqalgb3aeuayg* or *oaguadaauahcarqbia* or *bgbfahqalgb3aeuayg* or *4arqb0ac4adwbfagia* or *uaeuadaauahcarqbia* or *tgbfahqalgb3aeuayg* or *oaeuadaauahcarqbia* or *bgblafqalgb3aeuayg* or *4azqbuac4adwbfagia* or *uaguavaauahcarqbia* or *tgblafqalgb3aeuayg* or *oaguavaauahcarqbia* or *bgbfafqalgb3aeuayg* or *4arqbuac4adwbfagia* or *uaeuavaauahcarqbia* or *tgbfafqalgb3aeuayg* or *oaeuavaauahcarqbia* or *bgblahqalgbxaeuayg* or *4azqb0ac4avwbfagia* or *uaguadaauafcarqbia* or *tgblahqalgbxaeuayg* or *oaguadaauafcarqbia* or *bgbfahqalgbxaeuayg* or *4arqb0ac4avwbfagia* or *uaeuadaauafcarqbia* or *tgbfahqalgbxaeuayg* or *oaeuadaauafcarqbia* or *bgblafqalgbxaeuayg* or *4azqbuac4avwbfagia* or *uaguavaauafcarqbia* or *tgblafqalgbxaeuayg* or *oaguavaauafcarqbia* or *bgbfafqalgbxaeuayg* or *4arqbuac4avwbfagia* or *uaeuavaauafcarqbia* or *tgbfafqalgbxaeuayg* or *oaeuavaauafcarqbia* or *bgblahqalgb3aguaqg* or *4azqb0ac4adwblaeia* or *uaguadaauahcazqbca* or *tgblahqalgb3aguaqg* or *oaguadaauahcazqbca* or *bgbfahqalgb3aguaqg* or *4arqb0ac4adwblaeia* or *uaeuadaauahcazqbca* or *tgbfahqalgb3aguaqg* or *oaeuadaauahcazqbca* or *bgblafqalgb3aguaqg* or *4azqbuac4adwblaeia* or *uaguavaauahcazqbca* or *tgblafqalgb3aguaqg* or *oaguavaauahcazqbca* or *bgbfafqalgb3aguaqg* or *4arqbuac4adwblaeia* or *uaeuavaauahcazqbca* or *tgbfafqalgb3aguaqg* or *oaeuavaauahcazqbca* or *bgblahqalgbxaguaqg* or *4azqb0ac4avwblaeia* or *uaguadaauafcazqbca* or *tgblahqalgbxaguaqg* or *oaguadaauafcazqbca* or *bgbfahqalgbxaguaqg* or *4arqb0ac4avwblaeia* or *uaeuadaauafcazqbca* or *tgbfahqalgbxaguaqg* or *oaeuadaauafcazqbca* or *bgblafqalgbxaguaqg* or *4azqbuac4avwblaeia* or *uaguavaauafcazqbca* or *tgblafqalgbxaguaqg* or *oaguavaauafcazqbca* or *bgbfafqalgbxaguaqg* or *4arqbuac4avwblaeia* or *uaeuavaauafcazqbca* or *tgbfafqalgbxaguaqg* or *oaeuavaauafcazqbca* or *bgblahqalgb3aeuaqg* or *4azqb0ac4adwbfaeia* or *uaguadaauahcarqbca* or *tgblahqalgb3aeuaqg* or *oaguadaauahcarqbca* or *bgbfahqalgb3aeuaqg* or *4arqb0ac4adwbfaeia* or *uaeuadaauahcarqbca* or *tgbfahqalgb3aeuaqg* or *oaeuadaauahcarqbca* or *bgblafqalgb3aeuaqg* or *uaguavaauahcarqbca* or *bgbfafqalgb3aeuaqg* or *4arqbuac4adwbfaeia* or *uaeuavaauahcarqbca* or *tgbfafqalgb3aeuaqg* or *oaeuavaauahcarqbca* or *tgblahqalgbxaeuaqg* or *4azqb0ac4avwbfaeia* or *oaguadaauafcarqbca* or *bgbfahqalgbxaeuaqg* or *4arqb0ac4avwbfaeia* or *uaeuadaauafcarqbca* or *tgbfahqalgbxaeuaqg* or *oaeuadaauafcarqbca* or *bgblafqalgbxaeuaqg* or *4azqbuac4avwbfaeia* or *uaguavaauafcarqbca* or *tgblafqalgbxaeuaqg* or *oaguavaauafcarqbca* or *bgbfafqalgbxaeuaqg* or *4arqbuac4avwbfaeia* or *uaeuavaauafcarqbca*))
<li><a href="#">query: (((process.executable.text:(*\\\\powershell.exe or *\\\\pwsh.exe)) or (winlog.event_data.originalfilename:(\"powershell.exe\" or \"pwsh.dll\"))) and process.command_line.text:*\\ hidden\\ * and process.command_line.text:(*agkadabzageazabtagkabgagac8adabyageabgbzagyazqbya* or *axrzywrtaw4gl3ryyw5zzmvy* or *iaaqb0ahmayqbkag0aaqbuacaalwb0ahiayqbuahmazgblahia* or *jpdhnhzg1pbiavdhjhbnnmzx* or *ygbpahqacwbhagqabqbpag4aiaavahqacgbhag4acwbmaguacg* or *yml0c2fkbwluic90cmfuc2zlc* or *agmaaab1ag4aawbfahmaaqb6agua* or *jabjaggadqbuagsaxwbzagkaegbla* or *jgnodw5rx3npem* or *qaywboahuabgbraf8acwbpahoazq* or *rjahvua19zaxpl* or *y2h1bmtfc2l6z* or *ae8algbdag8abqbwahiazqbzahmaaqbvag4a* or *katwauaemabwbtahaacgblahmacwbpag8abg* or *lplknvbxbyzxnzaw9u* or *sqbpac4aqwbvag0acabyaguacwbzagkabwbua* or *su8uq29tchjlc3npb2* or *ty5db21wcmvzc2lvb* or *ae8algbnaguabqbvahiaeqbtahqacgblageabq* or *katwauae0azqbtag8acgb5afmadabyaguayqbta* or *lplk1lbw9yevn0cmvhb* or *sqbpac4atqblag0abwbyahkauwb0ahiazqbhag0a* or *su8utwvtb3j5u3ryzwft* or *ty5nzw1vcnltdhjlyw* or *4arwblahqaqwboahuabgbra* or *5hzxrdahvua* or *aecazqb0aemaaab1ag4aaw* or *lgbhaguadabdaggadqbuagsa* or *lkdldenodw5r* or *r2v0q2h1bm* or *aegaugbfaeearabfaekatgbgae8anga0a* or *qasabsaeuaqqbeaf8asqboaeyatwa2adqa* or *riukvbrf9jtkzpnj* or *sfjfqurfsu5gtzy0* or *vabiafiarqbbaeqaxwbjae4argbpadyana* or *vehsrufex0lork82n* or *ahiazqbhahqazqbsaguabqbvahqazqbuaggacgblageaza* or *cmvhdgvszw1vdgvuahjlyw* or *macgblageadablafiazqbtag8adablafqaaabyaguayqbka* or *nyzwf0zvjlbw90zvrocmvhz* or *q3jlyxrlumvtb3rlvghyzwfk* or *qwbyaguayqb0aguaugblag0abwb0aguavaboahiazqbhagqa* or *0azqbtag0abwb2agua* or *1lbw1vdm* or *aguabqbtag8adgbla* or *bqblag0abqbvahyazq* or *bwvtbw92z* or *zw1tb3zl*))
<li><a href="#">query: (((process.executable.text:(*petitpotam* or *rottenpotato* or *hotpotato* or *juicypotato* or *\\\\just_dce_* or *juicy\\ potato* or *\\\\temp\\\\rot.exe* or *\\\\potato.exe* or *\\\\spoolsample.exe* or *\\\\responder.exe* or *\\\\smbrelayx* or *\\\\ntlmrelayx* or *\\\\localpotato*)) or (process.command_line.text:(*invoke\\-tater* or *\\ smbrelay* or *\\ ntlmrelay* or *cme\\ smb\\ * or *\\ \\/ntlm\\:ntlmhash\\ * or *invoke\\-petitpotam* or *.exe\\ \\-t\\ \\*\\ \\-p\\ *)) or ((process.command_line.text:*.exe\\ \\-c\\ \\\"\\{* and process.command_line.text:*\\}\\\"\\ \\-z))) and (not process.executable.text:(*hotpotatoes6* or *hotpotatoes7* or *hotpotatoes\\ *)))
<li><a href="#">query: (((process.executable.text:*\\\\aspnet_regiis.exe) or (winlog.event_data.originalfilename:\"aspnet_regiis.exe\")) and (process.command_line.text:*connectionstrings* and process.command_line.text:*\\ \\-pdf*))
<li><a href="#">query: (((process.executable.text:*\\\\cdb.exe) or (winlog.event_data.originalfilename:\"cdb.exe\")) and process.command_line.text:(*\\ \\-c\\ * or *\\ \\-cf\\ *))
<li><a href="#">query: (((process.executable.text:*\\\\cmd.exe and process.command_line.text:*copy\\ *) or (process.executable.text:(*\\\\powershell.exe or *\\\\pwsh.exe) and process.command_line.text:(*copy\\-item* or *\\ copy\\ * or *cpi\\ * or *\\ cp\\ *)) or process.executable.text:(*\\\\robocopy.exe or *\\\\xcopy.exe)) and process.command_line.text:(*\\\\system32* or *\\\\syswow64*))
<li><a href="#">query: (((process.executable.text:*\\\\cmd.exe) or (winlog.event_data.originalfilename:\"cmd.exe\")) and (process.command_line.text:*mklink* and process.command_line.text:*\\\\osk.exe* and process.command_line.text:*\\\\cmd.exe*))
<li><a href="#">query: (((process.executable.text:*\\\\dumpminitool.exe) or (winlog.event_data.originalfilename:\"dumpminitool.exe\")) and (((((not (process.executable.text:(*\\\\microsoft\\ visual\\ studio\\\\* or *\\\\extensions\\\\*)))) or (process.command_line.text:*.txt*))) or ((process.command_line.text:*\\ full* and (not (process.command_line.text:*\\-\\-dumptype*))))))
<li><a href="#">query: (((process.executable.text:*\\\\msiexec.exe or winlog.event_data.originalfilename:\"msiexec.exe\") and process.command_line.text:(*\\/i* or *\\-i* or *\\/package* or *\\-package* or *\\/a* or *\\-a* or *\\/j* or *\\-j*) and process.command_line.text:(*\\/q* or *\\-q*)) and (not ((process.parent.executable.text:c\\:\\\\users\\\\* and process.parent.executable.text:*\\\\appdata\\\\local\\\\temp\\\\*) or (process.parent.executable.text:c\\:\\\\windows\\\\temp\\\\*))))
<li><a href="#">query: (((process.executable.text:*\\\\nslookup.exe*) or (winlog.event_data.originalfilename:\"\\nslookup.exe\")) and (process.parent.executable.text:(*\\\\powershell.exe or *\\\\pwsh.exe) and process.command_line.text:(*\\ \\-q\\=txt\\ * or *\\ \\-querytype\\=txt\\ *)))
<li><a href="#">query: (((process.executable.text:*\\\\perl.exe) or (winlog.event_data.originalfilename:\"perl.exe\")) and process.command_line.text:*\\ \\-e*)
<li><a href="#">query: (((process.executable.text:*\\\\php.exe) or (winlog.event_data.originalfilename:\"php.exe\")) and process.command_line.text:*\\ \\-r*)
<li><a href="#">query: (((process.executable.text:*\\\\protocolhandler.exe) or (winlog.event_data.originalfilename:\"protocolhandler.exe\")) and (((process.command_line.text:*\\\"ms\\-word* and process.command_line.text:*.docx\\\"*)) or (process.command_line.text:*\\ http*)))
<li><a href="#">query: (((process.executable.text:*\\\\regini.exe) or (winlog.event_data.originalfilename:\"regini.exe\")) and (not ((process.command_line.text:/:/ or process.command_line.text:/[/ or process.command_line.text:/^/ or process.command_line.text:/ / or process.command_line.text:/\\/ or process.command_line.text:/\\/ or process.command_line.text:/]/))))
<li><a href="#">query: (((process.executable.text:*\\\\regini.exe) or (winlog.event_data.originalfilename:\"regini.exe\")) and (process.command_line.text:/:/ or process.command_line.text:/[/ or process.command_line.text:/^/ or process.command_line.text:/ / or process.command_line.text:/\\/ or process.command_line.text:/\\/ or process.command_line.text:/]/))
<li><a href="#">query: (((process.executable.text:*\\\\regsvr32.exe and process.command_line.text:*\\\\temp\\\\*) or (process.executable.text:*\\\\regsvr32.exe and process.parent.executable.text:(*\\\\powershell.exe or *\\\\pwsh.exe or *\\\\powershell_ise.exe)) or (process.executable.text:*\\\\regsvr32.exe and process.parent.executable.text:*\\\\cmd.exe) or (process.executable.text:*\\\\regsvr32.exe and process.command_line.text:*\\/i\\:* and process.command_line.text:*http* and process.command_line.text:*scrobj.dll) or (process.executable.text:*\\\\regsvr32.exe and process.command_line.text:*\\/i\\:* and process.command_line.text:*ftp* and process.command_line.text:*scrobj.dll) or (process.executable.text:*\\\\wscript.exe and process.parent.executable.text:*\\\\regsvr32.exe) or (process.executable.text:*\\\\excel.exe and process.command_line.text:*..\\\\..\\\\..\\\\windows\\\\system32\\\\regsvr32.exe\\ *) or (process.parent.executable.text:*\\\\mshta.exe and process.executable.text:*\\\\regsvr32.exe) or (process.executable.text:*\\\\regsvr32.exe and process.command_line.text:(*\\\\appdata\\\\local* or *c\\:\\\\users\\\\public*)) or (process.executable.text:*\\\\regsvr32.exe and process.command_line.text:(*.jpg or *.jpeg or *.png or *.gif or *.bin or *.tmp or *.temp or *.txt))) and (not ((process.command_line.text:(*\\\\appdata\\\\local\\\\microsoft\\\\teams* or *\\\\appdata\\\\local\\\\webex\\\\webex64\\\\meetings\\\\atucfobj.dll*)) or (process.parent.executable.text:\"c\\:\\\\program\\ files\\\\box\\\\box\\\\fs\\\\streem.exe\" and process.command_line.text:*\\\\program\\ files\\\\box\\\\box\\\\temp\\\\*) or (process.command_line.text:*\\/s\\ c\\:\\\\windows\\\\system32\\\\rpcproxy\\\\rpcproxy.dll))))
<li><a href="#">query: (((process.executable.text:*\\\\ruby.exe) or (winlog.event_data.originalfilename:\"ruby.exe\")) and process.command_line.text:*\\ \\-e*)
<li><a href="#">query: (((process.executable.text:*\\\\sc.exe and process.command_line.text:*create* and process.command_line.text:*binpath\\=*) or (process.command_line.text:*new\\-service* and process.command_line.text:*\\-binarypathname*)) and process.command_line.text:(*powershell* or *mshta* or *wscript* or *cscript* or *svchost* or *dllhost* or *cmd\\ * or *cmd.exe\\ \\/c* or *cmd.exe\\ \\/k* or *rundll32* or *c\\:\\\\users\\\\public* or *\\\\downloads\\\\* or *\\\\desktop\\\\* or *\\\\microsoft\\\\windows\\\\start\\ menu\\\\programs\\\\startup\\\\* or *c\\:\\\\windows\\\\temp\\\\* or *\\\\appdata\\\\local\\\\temp*))
<li><a href="#">query: (((process.executable.text:*\\\\schtasks.exe and process.command_line.text:*\\ \\/create\\ * and process.command_line.text:(*%appdata%* or *\\\\appdata\\\\local\\\\* or *\\\\appdata\\\\roaming\\\\* or *%public%* or *\\\\users\\\\public* or *c\\:\\\\windows\\\\temp* or *c\\:\\\\perflogs*)) or (process.parent.command_line.text:*\\\\svchost.exe\\ \\-k\\ netsvcs\\ \\-p\\ \\-s\\ schedule and process.command_line.text:(*%public%* or *\\\\users\\\\public* or *c\\:\\\\windows\\\\temp* or *c\\:\\\\perflogs*))) and (not ((process.command_line.text:(*update_task.xml* or *\\/create\\ \\/tn\\ tvinstallrestore\\ \\/tr*) or process.parent.command_line.text:*unattended.ini*))))
<li><a href="#">query: (((process.executable.text:*\\\\schtasks.exe or winlog.event_data.originalfilename:\"schtasks.exe\") and process.command_line.text:(*\\ onlogon\\ * or *\\ onstart\\ * or *\\ once\\ * or *\\ onidle\\ *)) and (not ((process.command_line.text:(*nt\\ aut* or *\\ system* or *highest*)))))
<li><a href="#">query: (((process.executable.text:*\\\\secedit.exe) or (winlog.event_data.originalfilename:\"secedit\")) and (((process.command_line.text:*\\/export* and process.command_line.text:*\\/cfg*)) or ((process.command_line.text:*\\/configure* and process.command_line.text:*\\/db*))))
<li><a href="#">query: (((process.executable.text:*\\\\systemsettingsadminflows.exe) or (winlog.event_data.originalfilename:\"systemsettingsadminflows.exe\")) and process.command_line.text:*turnondeveloperfeatures* and process.command_line.text:(*developerunlock* or *enablesideloading*))
<li><a href="#">query: (((process.executable.text:*\\\\tracker.exe or winlog.event_data.description:\"tracker\") and process.command_line.text:(*\\ \\/d\\ * or *\\ \\/c\\ *)) and (not ((process.parent.executable.text:*\\\\msbuild\\\\current\\\\bin\\\\msbuild.exe and process.command_line.text:*\\\\vc\\\\tools\\\\msvc\\\\* and process.command_line.text:*\\\\bin\\\\hostx86\\\\x64\\\\*))))
<li><a href="#">query: (((process.executable.text:*\\\\tscon.exe) or (winlog.event_data.originalfilename:\"tscon.exe\")) and integritylevel:\"system\")
<li><a href="#">query: (((process.executable.text:*\\\\unregmp2.exe) or (winlog.event_data.originalfilename:\"unregmp2.exe\")) and process.command_line.text:*\\ \\/hidewmp*)
<li><a href="#">query: (((process.executable.text:*\\\\wermgr.exe and (not (process.executable.text:(*c\\:\\\\windows\\\\system32\\\\* or *c\\:\\\\windows\\\\syswow64\\\\*))))) or ((process.parent.executable.text:*\\\\wermgr.exe and process.executable.text:(*\\\\nslookup.exe or *\\\\ipconfig.exe or *\\\\net.exe or *\\\\net1.exe or *\\\\whoami.exe or *\\\\netstat.exe or *\\\\systeminfo.exe or *\\\\cmd.exe or *\\\\powershell.exe))))
<li><a href="#">query: (((process.executable.text:*\\\\whoami.exe or winlog.event_data.originalfilename:\"whoami.exe\") and (not ((process.parent.executable.text:(*\\\\cmd.exe or *\\\\powershell.exe or *\\\\pwsh.exe or *\\\\powershell_ise.exe)) or (process.parent.executable.text:(\"c\\:\\\\program\\ files\\\\microsoft\\ monitoring\\ agent\\\\agent\\\\monitoringhost.exe\" or \"\")) or (not _exists_:process.parent.executable.text)))) or process.command_line.text:(*whoami\\ \\-all* or *whoami\\ \\/all* or *whoami.exe\\ \\-all* or *whoami.exe\\ \\/all* or *whoami.exe\\ >* or *whoami\\ >*))
<li><a href="#">query: (((process.executable.text:*\\\\windows\\\\* and process.command_line.text:(*\\\\..\\\\windows\\\\* or *\\\\..\\\\system32\\\\* or *\\\\..\\\\..\\\\*)) or process.command_line.text:*.exe\\\\..\\\\*) and (not (process.command_line.text:(*\\\\google\\\\drive\\\\googledrivesync.exe\\\\..\\\\* or *\\\\citrix\\\\virtual\\ smart\\ card\\\\citrix.authentication.virtualsmartcard.launcher.exe\\\\..\\\\*))))
<li><a href="#">query: (((process.executable.text:*\\\\winget.exe) or (winlog.event_data.originalfilename:\"winget.exe\")) and process.command_line.text:*install* and process.command_line.text:(*\\-m\\ * or *\\-\\-manifest*))
<li><a href="#">query: (((process.executable.text:*\\\\wmic.exe or winlog.event_data.originalfilename:\"wmic.exe\") and (process.command_line.text:*process* and process.command_line.text:*call* and process.command_line.text:*create\\ *)) or ((process.executable.text:*\\\\wmic.exe or winlog.event_data.originalfilename:\"wmic.exe\") and (process.command_line.text:*\\ path\\ * and process.command_line.text:(*antivirus* or *firewall*) and process.command_line.text:*product* and process.command_line.text:*\\ get\\ * and process.command_line.text:*wmic\\ csproduct\\ get\\ name*)))
<li><a href="#">query: (((process.executable.text:*wuauclt* or winlog.event_data.originalfilename:\"wuauclt.exe\") and (process.command_line.text:*updatedeploymentprovider* and process.command_line.text:*.dll* and process.command_line.text:*runhandlercomserver*)) and (not (process.command_line.text:(*\\ \\/updatedeploymentprovider\\ updatedeploymentprovider.dll\\ * or *\\ wuaueng.dll\\ *))))
<li><a href="#">query: (((process.executable.text:\"\\agentexecutor.exe\") or (winlog.event_data.originalfilename:\"agentexecutor.exe\")) and process.command_line.text:(*\\ \\-powershell* or *\\ \\-remediationscript*))
<li><a href="#">query: (((process.executable:(*\\\\robocopy.exe or *\\\\xcopy.exe) or (process.executable:*\\\\cmd.exe and process.command_line:*copy*)) or (process.executable:*\\\\powershell* and process.command_line:(*copy\\-item* or *copy* or *cpi\\ * or *\\ cp\\ *))) and (process.command_line:*\\\\\\\\\\* and process.command_line:*$*))
<li><a href="#">query: (((process.executable:*\\\\gup.exe or winlog.event_data.originalfilename:\"gup.exe\") and (process.command_line:*\\ \\-unzipto\\ * and process.command_line:*http*)) and (not (process.parent.executable:*\\\\notepad\\+\\+.exe)))
<li><a href="#">query: (((process.executable:*\\\\mftrace.exe or winlog.event_data.originalfilename:\"mftrace.exe\") and (process.command_line:*.exe\\ * and process.command_line:*.exe)) or process.parent.executable:*\\\\mftrace.exe)
<li><a href="#">query: (((process.executable:*\\\\powershell.exe and process.command_line:(*clear\\-eventlog* or *remove\\-eventlog* or *limit\\-eventlog*)) or (process.executable:*\\\\wmic.exe and process.command_line:*\\ cleareventlog\\ *)) or (process.executable:*\\\\wevtutil.exe and process.command_line:(*clear\\-log* or *\\ cl\\ * or *set\\-log* or *\\ sl\\ *)))
<li><a href="#">query: (((process.executable:*\\\\presentationhost.exe or winlog.event_data.originalfilename:\"presentationhost.exe\") and process.command_line:*.xbap*) and (not (process.command_line:(*c\\:\\\\windows\\\\* or *c\\:\\\\program\\ files*))))
<li><a href="#">query: (((process.executable:*\\\\regedit.exe and process.command_line:(*\\ \\/i\\ * or *\\ \\/s\\ * or *.reg*)) and (not (process.command_line:(*\\ \\/e\\ * or *\\ \\/a\\ * or *\\ \\/c\\ *)))) and (not (process.command_line:/:[\\\\\\\\]/)))
<li><a href="#">query: (((process.executable:*\\\\regsvr32.exe and (not (process.command_line:(*.dll* or *.ocx* or *.cpl* or *.ax* or *.bav* or *.ppl*)))) and (not (not _exists_:process.command_line))) and (not (process.command_line:\"\")))
<li><a href="#">query: (((process.executable:*\\\\rundll32.exe and process.command_line:(*,rundll or *,control_rundll)) and (not (process.parent.executable:*\\\\tracker.exe))) and (not (process.command_line:(*.dll,control_rundll or *.dll\\\",control_rundll or *.dll',control_rundll))))
<li><a href="#">query: (((process.executable:*\\\\svchost.exe and file.path:*\\\\personalization\\\\lockscreenimage\\\\*) and (not (file.path:*c\\:\\\\windows\\\\*))) and (not (file.path:(*.jpg* or *.jpeg* or *.png*))))
<li><a href="#">query: (((process.executable:*\\\\whoami.exe or (process.executable:*\\\\wmic.exe and process.command_line:*useraccount* and process.command_line:*get*) or process.executable:(*\\\\quser.exe or *\\\\qwinsta.exe) or (process.executable:*\\\\cmdkey.exe and process.command_line:*\\/list*) or (process.executable:*\\\\cmd.exe and process.command_line:*\\/c* and process.command_line:*dir\\ * and process.command_line:*\\\\users\\\\*)) and (not (process.command_line:*\\ rmdir\\ *))) or ((process.executable:(*\\\\net.exe or *\\\\net1.exe) and process.command_line:*user*) and (not (process.command_line:(*\\/domain* or *\\/add* or *\\/delete* or *\\/active* or *\\/expires* or *\\/passwordreq* or *\\/scriptpath* or *\\/times* or *\\/workstations*)))))
<li><a href="#">query: (((process.executable:*\\\\windows\\\\* and process.command_line:(*\\\\..\\\\windows\\\\* or *\\\\..\\\\system32\\\\* or *\\\\..\\\\..\\\\*)) or process.command_line:*.exe\\\\..\\\\*) and (not (process.command_line:*\\\\google\\\\drive\\\\googledrivesync.exe\\\\..\\\\*)))
<li><a href="#">query: (((process.executable:*\\\\wmic.exe and process.command_line:*\\/format*) or process.executable:*\\\\msxsl.exe) and (not (process.command_line:(*\\/format\\:list* or *\\/format\\:htable* or *\\/format\\:hform* or *\\/format\\:table* or *\\/format\\:mof* or *\\/format\\:value* or *\\/format\\:rawxml* or *\\/format\\:xml* or *\\/format\\:csv*))))
<li><a href="#">query: (((process.executable:*\\\\wmic.exe or winlog.event_data.originalfilename:\"wmic.exe\") and (process.command_line:*process* and process.command_line:*call* and process.command_line:*create\\ *)) or ((process.executable:*\\\\wmic.exe or winlog.event_data.originalfilename:\"wmic.exe\") and process.command_line:*\\ path\\ * and process.command_line:(*antivirus* or *firewall*) and (process.command_line:*product* and process.command_line:*\\ get\\ *)))
<li><a href="#">query: (((process.executable:*svchost.exe and file.path:*\\\\personalization\\\\lockscreenimage\\\\*) and (not (file.path:*c\\:\\\\windows\\\\*))) and (not (file.path:(*.jpg* or *.jpeg* or *.png*))))
<li><a href="#">query: (((process.executable:*wuauclt* or winlog.event_data.originalfilename:\"wuauclt.exe\") and (process.command_line:*updatedeploymentprovider* and process.command_line:*.dll* and process.command_line:*runhandlercomserver*)) and (not (process.command_line:(*\\ \\/updatedeploymentprovider\\ updatedeploymentprovider.dll\\ * or *\\ wuaueng.dll\\ *))))
<li><a href="#">query: (((process.parent.executable.text:(*\\/httpd or *\\/lighttpd or *\\/nginx or *\\/apache2 or *\\/node or *\\/caddy)) or ((process.parent.command_line.text:*\\/bin\\/java* and process.parent.command_line.text:*tomcat*)) or ((process.parent.command_line.text:*\\/bin\\/java* and process.parent.command_line.text:*websphere*))) and process.executable.text:(*\\/whoami or *\\/ifconfig or *\\/ip or *\\/bin\\/uname or *\\/bin\\/cat or *\\/bin\\/crontab or *\\/hostname or *\\/iptables or *\\/netstat or *\\/pwd or *\\/route))
<li><a href="#">query: (((process.parent.executable.text:(*\\\\w3wp.exe or *\\\\php\\-cgi.exe or *\\\\nginx.exe or *\\\\httpd.exe or *\\\\caddy.exe or *\\\\ws_tomcatservice.exe or *\\\\tomcat.exe or *\\\\umworkerprocess.exe) or (process.parent.executable.text:(*\\\\java.exe or *\\\\javaw.exe) and process.parent.executable.text:(*\\-tomcat\\-* or *\\\\tomcat*)) or (process.parent.executable.text:(*\\\\java.exe or *\\\\javaw.exe) and process.parent.command_line.text:(*catalina.jar* or *catalina_home* or *catalina.home*))) and process.executable.text:(*\\\\cmd.exe or *\\\\sh.exe or *\\\\bash.exe or *\\\\powershell.exe or *\\\\pwsh.exe or *\\\\bitsadmin.exe or *\\\\arp.exe or *\\\\at.exe or *\\\\certutil.exe or *\\\\dsget.exe or *\\\\dsquery.exe or *\\\\find.exe or *\\\\findstr.exe or *\\\\fsutil.exe or *\\\\hostname.exe or *\\\\ipconfig.exe or *\\\\nbtstat.exe or *\\\\net.exe or *\\\\net1.exe or *\\\\netdom.exe or *\\\\netsh.exe or *\\\\netstat.exe or *\\\\nltest.exe or *\\\\nslookup.exe or *\\\\ntdutil.exe or *\\\\pathping.exe or *\\\\ping.exe or *\\\\qprocess.exe or *\\\\query.exe or *\\\\qwinsta.exe or *\\\\reg.exe or *\\\\rundll32.exe or *\\\\sc.exe or *\\\\schtasks.exe or *\\\\systeminfo.exe or *\\\\tasklist.exe or *\\\\tracert.exe or *\\\\ver.exe or *\\\\vssadmin.exe or *\\\\wevtutil.exe or *\\\\whoami.exe or *\\\\wmic.exe or *\\\\wusa.exe)) and (not ((process.command_line.text:*windows\\\\system32\\\\cmd.exe\\ \\/c\\ c\\:\\\\manageengine\\\\admanager\\ \\\"plus\\\\es\\\\bin\\\\elasticsearch.bat\\ \\-enode.name\\=rmp\\-node1\\ \\-pelasticsearch\\-pid.txt))))
<li><a href="#">query: (((process.parent.executable.text:(*\\\\wmiprvse.exe or *\\\\svchost.exe or *\\\\dllhost.exe) and process.executable.text:*\\\\imagingdevices.exe)) or (process.parent.executable.text:*\\\\imagingdevices.exe))
<li><a href="#">query: (((process.parent.executable:*\\\\winrar.exe and process.executable:*\\\\wscript.exe) or process.command_line:*\\ \\/c\\ ping.exe\\ \\-n\\ 6\\ 127.0.0.1\\ &\\ type\\ *) or (process.command_line:*regsvr32.exe* and process.command_line:*c\\:\\\\programdata* and process.command_line:*.tmp*))
<li><a href="#">query: (((process.parent.executable:*\\\\wmiprvse.exe and (process.executable:(*\\\\powershell.exe or *\\\\pwsh.exe) or winlog.event_data.originalfilename:(\"powershell.exe\" or \"pwsh.dll\"))) and (not (process.command_line:\"null\"))) and (not (not _exists_:process.command_line)))
<li><a href="#">query: (((process.parent.executable:*\\\\wmiprvse.exe and process.executable:*\\\\powershell.exe) and (not (process.command_line:\"null\"))) and (not (not _exists_:process.command_line)))
<li><a href="#">query: (((product:\"sqlite\") or (process.executable.text:(*\\\\sqlite.exe or *\\\\sqlite3.exe))) and process.command_line.text:(*\\\\google\\\\chrome\\\\user\\ data\\\\default\\\\network\\\\cookies* or *\\\\google\\\\chrome\\\\user\\ data\\\\default\\\\cookies*))
<li><a href="#">query: (((product:\"sqlite\") or (process.executable.text:(*\\\\sqlite.exe or *\\\\sqlite3.exe))) and process.command_line.text:*cookies.sqlite*)
<li><a href="#">query: (((resulttype:\"50074\" and resultdescription:*strong\\ auth\\ required*)) or ((resulttype:\"500121\" and resultdescription:*authentication\\ failed\\ during\\ strong\\ authentication\\ request*)))
<li><a href="#">query: (((resulttype:\"50097\" and resultdescription:\"device authentication is required\")) or ((resulttype:\"50155\" and resultdescription:\"deviceauthenticationfailed\")) or ((resulttype:\"50158\" and resultdescription:\"externalsecuritychallenge - external security challenge was not satisfied\")))
<li><a href="#">query: (((type:\"path\" and name:(\"/etc/lsb-release\" or \"/etc/redhat-release\" or \"/etc/issue\"))) or ((type:\"execve\" and a0:(\"uname\" or \"uptime\"))))
<li><a href="#">query: (((type:\"path\" and name:(\"/etc/pam.d/common-password\" or \"/etc/security/pwquality.conf\" or \"/etc/pam.d/system-auth\" or \"/etc/login.defs\"))) or ((type:\"execve\" and a0:\"chage\" and a1:(\"--list\" or \"-l\"))) or ((type:\"execve\" and a0:\"passwd\" and a1:(\"-s\" or \"--status\"))))
<li><a href="#">query: (((type:\"path\" and name:(\"/etc/pam.d/system-auth\" or \"/etc/pam.d/password-auth\"))) or (type:(\"tty\" or \"user_tty\")))
<li><a href="#">query: (((type:\"syscall\" and exe:*\\/useradd)) or (type:\"add_user\"))
<li><a href="#">query: (((url.original:*\\/api\\/v2.0\\/user\\/remoteserver.saml* and http.request.method:\"post\") and (not (cs-referer:*\\/root\\/user\\/remote\\-user\\/saml\\-user\\/*))) and (not (not _exists_:cs-referer)))
<li><a href="#">query: (((winlog.event_data.description:\"windows\\ powershell\" or product:\"powershell\\ core\\ 6\") and process.command_line:(*bxor* or *\\-join\\ * or *\\-join'* or *\\-join\\\"* or *\\-join`* or *char*)) and (not (process.parent.executable:\"c\\:\\\\program\\ files\\\\amazon\\\\ssm\\\\ssm\\-document\\-worker.exe\")))
<li><a href="#">query: (((winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:(*software\\\\microsoft\\\\office\\\\* or *\\\\outlook\\\\today\\\\*)) and ((winlog.event_data.targetobject:*stamp and winlog.event_data.details:\"dword\\ \\(0x00000001\\)\") or winlog.event_data.targetobject:*userdefinedurl)) and (not ((process.executable:(c\\:\\\\program\\ files\\\\common\\ files\\\\microsoft\\ shared\\\\clicktorun\\\\* or c\\:\\\\program\\ files\\\\common\\ files\\\\microsoft\\ shared\\\\clicktorun\\\\updates\\\\*) and process.executable:*\\\\officeclicktorun.exe))))
<li><a href="#">query: (((winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:(\"hklm\\\\system\\\\currentcontrolset\\\\services\\\\naldrv\\\\imagepath\" or \"hklm\\\\system\\\\currentcontrolset\\\\services\\\\procexp152\\\\imagepath\")) and (not (process.executable:(*\\\\procexp64.exe or *\\\\procexp.exe or *\\\\procmon64.exe or *\\\\procmon.exe)))) and (not (winlog.event_data.details:*\\\\windows\\\\system32\\\\drivers\\\\procexp152.sys*)))
<li><a href="#">query: (((winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:*classes\\\\ms\\-settings\\\\shell\\\\open\\\\command\\\\symboliclinkvalue and winlog.event_data.details:*\\\\software\\\\classes\\\\\\{*) or winlog.event_data.targetobject:*classes\\\\ms\\-settings\\\\shell\\\\open\\\\command\\\\delegateexecute) or ((winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:(*classes\\\\ms\\-settings\\\\shell\\\\open\\\\command\\\\\\(default\\) or *classes\\\\exefile\\\\shell\\\\open\\\\command\\\\\\(default\\))) and (not (winlog.event_data.details:\"\\(empty\\)\"))))
<li><a href="#">query: (((winlog.event_data.imphash:(\"a53a02b997935fd8eedcb5f7abab9b9f\" or \"e96a73c7bf33a464c510ede582318bf2\") or winlog.event_data.hashes:(*imphash\\=a53a02b997935fd8eedcb5f7abab9b9f* or *imphash\\=e96a73c7bf33a464c510ede582318bf2*)) or (process.command_line:*.exe\\ \\-s and process.parent.executable:*\\\\services.exe)) and (not (process.executable:*\\\\clussvc.exe)))
<li><a href="#">query: (((winlog.event_data.originalfilename:(\"excel.exe\" or \"msaccess.exe\" or \"onenote.exe\" or \"powerpnt.exe\" or \"winword.exe\")) or (winlog.event_data.description:(\"microsoft access\" or \"microsoft excel\" or \"microsoft onenote\" or \"microsoft powerpoint\" or \"microsoft word\"))) and (not (process.executable.text:(*\\\\excel.exe or *\\\\msaccess.exe or *\\\\onenote.exe or *\\\\powerpnt.exe or *\\\\winword.exe))))
<li><a href="#">query: (((winlog.event_data.originalfilename:(\"powershell.exe\" or \"pwsh.dll\")) or (process.executable.text:(*\\\\powershell.exe or *\\\\pwsh.exe))) and (process.command_line.text:*\\ system.net.sockets.tcpclient* and process.command_line.text:*.getbytes* and process.command_line.text:*.write*))
<li><a href="#">query: (((winlog.event_data.originalfilename:\"procdump\" or (process.command_line:*\\ \\-ma\\ * and process.command_line:*\\ \\-accepteula\\ *)) or (process.command_line:*\\ \\-ma\\ * and process.command_line:*.dmp*)) and (not (process.executable:(*\\\\procdump.exe or *\\\\procdump64.exe))))
<li><a href="#">query: (((winlog.event_data.targetimage:\"c\\:\\\\windows\\\\sysmon64.exe\" and winlog.event_data.grantedaccess:\"0x1400\") and (not ((process.executable.text:(c\\:\\\\program\\ files* or c\\:\\\\windows\\\\system32\\\\*)) or (process.executable.text:c\\:\\\\programdata\\\\microsoft\\\\windows\\ defender\\\\platform\\\\* and process.executable.text:*\\\\msmpeng.exe)))) or winlog.event_data.calltrace:\"ente\")
<li><a href="#">query: (((winlog.event_id:(\"808\" or \"4909\") and errorcode:(\"0x45a\" or \"0x7e\")) or (*the\\ print\\ spooler\\ failed\\ to\\ load\\ a\\ plug\\-in\\ module* or *myexploit.dll* or *evil.dll* or *\\\\addcube.dll* or *\\\\rev.dll* or *\\\\rev2.dll* or *\\\\main64.dll* or *\\\\mimilib.dll* or *\\\\mimispool.dll*)) and (not (*\\ registration\\ timed\\ out*)))
<li><a href="#">query: (((winlog.event_id:\"5861\" and (*activescripteventconsumer* or *commandlineeventconsumer* or *commandlinetemplate*)) or winlog.event_id:\"5859\") and (not (provider:\"scm\\ event\\ provider\" and query:select\\ *\\ from\\ msft_scmeventlogevent and user.name:\"s\\-1\\-5\\-32\\-544\" and possiblecause:\"permanent\")))
<li><a href="#">query: ((*\\ \\-enc\\ * or *\\ \\-encodedcommand\\ *) and (*\\ \\-w\\ hidden\\ * or *\\ \\-window\\ hidden\\ * or *\\ \\-windowstyle\\ hidden\\ *) and (*\\ \\-noni\\ * or *\\ \\-noninteractive\\ *))
<li><a href="#">query: ((*cat </dev/tcp/*) or (*exec 3<>/dev/tcp/*) or (*echo >/dev/tcp/*) or (*bash -i >& /dev/tcp/*) or (*sh -i >& /dev/udp/*) or (*0<&196;exec 196<>/dev/tcp/*) or (*exec 5<>/dev/tcp/*) or (*(sh)0>/dev/tcp/*) or (*bash -c 'bash -i >& /dev/tcp/*) or (*echo -e '#!/bin/bash\\nbash -i >& /dev/tcp/*))
<li><a href="#">query: ((*crypto pki export*) or (*crypto pki import*) or (*crypto pki trustpoint*))
<li><a href="#">query: ((*dir*) or (*show processes*) or (*show arp*) or (*show cdp*) or (*show version*) or (*show ip route*) or (*show ip interface*) or (*show ip sockets*) or (*show users*) or (*show ssh*) or (*show clock*))
<li><a href="#">query: ((*dpapi\\:\\:masterkey* or *eo.oe.kiwi* or *event\\:\\:clear* or *event\\:\\:drop* or *gentilkiwi.com* or *kerberos\\:\\:golden* or *kerberos\\:\\:ptc* or *kerberos\\:\\:ptt* or *kerberos\\:\\:tgt* or *kiwi\\ legit\\ printer* or *lsadump\\:\\:* or *mimidrv.sys* or *\\\\mimilib.dll* or *misc\\:\\:printnightmare* or *misc\\:\\:shadowcopies* or *misc\\:\\:skeleton* or *privilege\\:\\:backup* or *privilege\\:\\:debug* or *privilege\\:\\:driver* or *sekurlsa\\:\\:*) and (not (winlog.event_id:\"15\")))
<li><a href="#">query: ((*drop*) or (*truncate*) or (*dump*) or (*select \\*))
<li><a href="#">query: ((*erase*) or (*delete*) or (*format*))
<li><a href="#">query: ((*ip http server*) or (*ip https server*) or (*kron policy-list*) or (*kron occurrence*) or (*policy-list*) or (*access-list*) or (*ip access-group*) or (*archive maximum*))
<li><a href="#">query: ((*mod_security: access denied*) or (*modsecurity: access denied*) or (*mod_security-message: access denied*))
<li><a href="#">query: ((*monitor capture point*) or (*set span*) or (*set rspan*))
<li><a href="#">query: ((*new-exchangecertificate* and * -generaterequest* and * -binaryencoded* and * -requestfile*) and ((*\\\\\\\\localhost\\\\c$*) or (*\\\\\\\\127.0.0.1\\\\c$*) or (*c:\\\\inetpub*) or (*.aspx*)))
<li><a href="#">query: ((*no logging*) or (*no aaa new-model*))
<li><a href="#">query: ((*oabvirtualdirectory* and * -externalurl *) and ((*eval(request*) or (*<script*) or (*\"unsafe\"};*) or (*function page_load()*)))
<li><a href="#">query: ((*rm\\ \\/var\\/log\\/syslog* or *rm\\ \\-r\\ \\/var\\/log\\/syslog* or *rm\\ \\-f\\ \\/var\\/log\\/syslog* or *rm\\ \\-rf\\ \\/var\\/log\\/syslog* or *mv\\ \\/var\\/log\\/syslog* or *\\ >\\/var\\/log\\/syslog* or *\\ >\\ \\/var\\/log\\/syslog*) and (not (*\\/syslog.*)))
<li><a href="#">query: ((*scp\\ * or *rsync\\ * or *sftp\\ *) and (*@* or *\\:*))
<li><a href="#">query: ((*show history*) or (*show history all*) or (*show logging*))
<li><a href="#">query: ((*show running-config*) or (*show startup-config*) or (*show archive config*) or (*more*))
<li><a href="#">query: ((*shutdown*) or (*config-register 0x2100*) or (*config-register 0x2142*))
<li><a href="#">query: ((*tftp*) or (*rcp*) or (*puts*) or (*copy*) or (*configure replace*) or (*archive tar*))
<li><a href="#">query: ((category:\"usermanagement\" and operationname:\"invite\\ external\\ user\") and (not (initiatedby:*<approved\\ guest\\ inviter\\ use\\ or\\ for\\ mulitple>*)))
<li><a href="#">query: ((contents:\\[zonetransfer\\]\\ \\ zoneid\\=3* and file.path.text:*\\:zone.identifier and file.path.text:(*.exe* or *.scr* or *.bat* or *.cmd* or *.docx* or *.hta* or *.jse* or *.lnk* or *.pptx* or *.ps* or *.reg* or *.sct* or *.vb* or *.wsc* or *.wsf* or *.xlsx*)) and (not (process.executable.text:(*\\\\brave.exe or *\\\\google\\\\chrome\\\\application\\\\chrome.exe or *\\\\chromium.exe or *\\\\firefox.exe or *\\\\msedge.exe or *\\\\opera.exe or *\\\\microsoftedge.exe or *\\\\iexplorer.exe or *\\\\vivaldi.exe or *\\\\ccleaner\\ browser\\\\application\\\\ccleanerbrowser.exe))))
<li><a href="#">query: ((contextinfo:*\\ \\=\\ serverremotehost\\ * and contextinfo:*wsmprovhost.exe*) and (not ((contextinfo:*\\\\windows\\\\system32\\\\windowspowershell\\\\v1.0\\\\modules\\\\microsoft.powershell.archive\\\\microsoft.powershell.archive.psm1*))))
<li><a href="#">query: ((cs-uri-query:(*\\/webresource.axd* or *\\/scriptresource.axd* or *\\/i18n.ashx* or *\\/skipi18n*) and cs-uri-query:(*\\/solarwinds\\/* or *\\/api\\/*)) and (not (((cs-uri-query:*orion\\/skipi18n\\/profiler\\/*)) or ((cs-uri-query:(*css.i18n.ashx* or *js.i18n.ashx*))))))
<li><a href="#">query: ((cs-uri-query:*\\/owa\\/calendar\\/a* and http.request.method:\"post\") and (not (http.response.status_code:\"503\")))
<li><a href="#">query: ((cs-uri-query:*\\/rapi\\/filedownload?filter\\=path\\:%2f*) or ((cs-uri-query:*\\/pcidss\\/report* and cs-uri-query:*type\\=all_signatures* and cs-uri-query:*sig_name\\=_default_signature_*)))
<li><a href="#">query: ((cs-user-agent:(*$\\{jndi\\:ldap\\:\\/* or *$\\{jndi\\:rmi\\:\\/* or *$\\{jndi\\:ldaps\\:\\/* or *$\\{jndi\\:dns\\:\\/* or *\\/$%7bjndi\\:* or *%24%7bjndi\\:* or *$%7bjndi\\:* or *%2524%257bjndi* or *%2f%252524%25257bjndi%3a* or *$\\{jndi\\:$\\{lower\\:* or *$\\{\\:\\:\\-j\\}$\\{* or *$\\{jndi\\:nis* or *$\\{jndi\\:nds* or *$\\{jndi\\:corba* or *$\\{jndi\\:iiop* or *reference\\ class\\ name\\:\\ foo* or *$\\{$\\{env\\:barfoo\\:\\-j\\}* or *$\\{\\:\\:\\-l\\}$\\{\\:\\:\\-d\\}$\\{\\:\\:\\-a\\}$\\{\\:\\:\\-p\\}* or *$\\{base64\\:jhtqbmrp* or *$\\{$\\{env\\:env_name\\:\\-j\\}ndi$\\{env\\:env_name\\:\\-\\:\\}$* or *$\\{$\\{lower\\:j\\}ndi\\:* or *$\\{$\\{upper\\:j\\}ndi\\:* or *$\\{$\\{\\:\\:\\-j\\}$\\{\\:\\:\\-n\\}$\\{\\:\\:\\-d\\}$\\{\\:\\:\\-i\\}\\:*)) or (cs-uri-query:(*$\\{jndi\\:ldap\\:\\/* or *$\\{jndi\\:rmi\\:\\/* or *$\\{jndi\\:ldaps\\:\\/* or *$\\{jndi\\:dns\\:\\/* or *\\/$%7bjndi\\:* or *%24%7bjndi\\:* or *$%7bjndi\\:* or *%2524%257bjndi* or *%2f%252524%25257bjndi%3a* or *$\\{jndi\\:$\\{lower\\:* or *$\\{\\:\\:\\-j\\}$\\{* or *$\\{jndi\\:nis* or *$\\{jndi\\:nds* or *$\\{jndi\\:corba* or *$\\{jndi\\:iiop* or *reference\\ class\\ name\\:\\ foo* or *$\\{$\\{env\\:barfoo\\:\\-j\\}* or *$\\{\\:\\:\\-l\\}$\\{\\:\\:\\-d\\}$\\{\\:\\:\\-a\\}$\\{\\:\\:\\-p\\}* or *$\\{base64\\:jhtqbmrp* or *$\\{$\\{env\\:env_name\\:\\-j\\}ndi$\\{env\\:env_name\\:\\-\\:\\}$* or *$\\{$\\{lower\\:j\\}ndi\\:* or *$\\{$\\{upper\\:j\\}ndi\\:* or *$\\{$\\{\\:\\:\\-j\\}$\\{\\:\\:\\-n\\}$\\{\\:\\:\\-d\\}$\\{\\:\\:\\-i\\}\\:*)) or (cs-referer:(*$\\{jndi\\:ldap\\:\\/* or *$\\{jndi\\:rmi\\:\\/* or *$\\{jndi\\:ldaps\\:\\/* or *$\\{jndi\\:dns\\:\\/* or *\\/$%7bjndi\\:* or *%24%7bjndi\\:* or *$%7bjndi\\:* or *%2524%257bjndi* or *%2f%252524%25257bjndi%3a* or *$\\{jndi\\:$\\{lower\\:* or *$\\{\\:\\:\\-j\\}$\\{* or *$\\{jndi\\:nis* or *$\\{jndi\\:nds* or *$\\{jndi\\:corba* or *$\\{jndi\\:iiop* or *reference\\ class\\ name\\:\\ foo* or *$\\{$\\{env\\:barfoo\\:\\-j\\}* or *$\\{\\:\\:\\-l\\}$\\{\\:\\:\\-d\\}$\\{\\:\\:\\-a\\}$\\{\\:\\:\\-p\\}* or *$\\{base64\\:jhtqbmrp* or *$\\{$\\{env\\:env_name\\:\\-j\\}ndi$\\{env\\:env_name\\:\\-\\:\\}$* or *$\\{$\\{lower\\:j\\}ndi\\:* or *$\\{$\\{upper\\:j\\}ndi\\:* or *$\\{$\\{\\:\\:\\-j\\}$\\{\\:\\:\\-n\\}$\\{\\:\\:\\-d\\}$\\{\\:\\:\\-i\\}\\:*)))
<li><a href="#">query: ((destination.domain:\"api.telegram.org\" or url.domain:\"api.telegram.org\") and (not (user_agent.original:(*telegram* or *bot*))))
<li><a href="#">query: ((destination.port:(\"25\" or \"587\" or \"465\" or \"2525\") and winlog.event_data.initiated:\"true\") and (not ((process.executable.text:(*\\\\thunderbird.exe or *\\\\outlook.exe)) or (process.executable.text:c\\:\\\\program\\ files\\\\microsoft\\\\exchange\\ server\\\\*) or (process.executable.text:c\\:\\\\program\\ files\\\\windowsapps\\\\microsoft.windowscommunicationsapps_* and process.executable.text:*\\\\hxtsr.exe))))
<li><a href="#">query: ((destination.port:(\"25\" or \"587\" or \"465\" or \"2525\") and winlog.event_data.initiated:\"true\") and (not ((process.executable:(*\\\\thunderbird.exe or *\\\\outlook.exe)) or (process.executable:c\\:\\\\program\\ files\\\\microsoft\\\\exchange\\ server\\\\*))))
<li><a href="#">query: ((destination.port:(\"5985\" or \"5986\") and winlog.event_data.initiated:\"true\") and (not ((((user.name:(*network\\ service* or *netzwerkdienst* or *servizio\\ di\\ rete* or *servicio\\ de\\ red*)) or (user.name:*service\\ r* and user.name:*seau*) or (source.ip:0\\:0\\:*) or (process.executable.text:(\"c:\\program files\\avast software\\avast\\avastsvc.exe\" or \"c:\\program files (x86)\\avast software\\avast\\avastsvc.exe\")))) or ((source.ip:(\"::1\" or \"127.0.0.1\") and destination.ip:(\"::1\" or \"127.0.0.1\"))))))
<li><a href="#">query: ((destination.port:\"3389\" and winlog.event_data.initiated:\"true\") and (not (process.executable:(*\\\\mstsc.exe or *\\\\rtsapp.exe or *\\\\rts2app.exe or *\\\\rdcman.exe or *\\\\ws_tunnelservice.exe or *\\\\rssensor.exe or *\\\\remotedesktopmanagerfree.exe or *\\\\remotedesktopmanager.exe or *\\\\remotedesktopmanager64.exe or *\\\\mremoteng.exe or *\\\\mremote.exe or *\\\\terminals.exe or *\\\\spiceworks\\-finder.exe or *\\\\fsdiscovery.exe or *\\\\fsassessment.exe or *\\\\mobarte.exe or *\\\\chrome.exe or *\\\\system32\\\\dns.exe or *\\\\thor.exe or *\\\\thor64.exe or *\\\\passwordstate.exe or *\\\\avast\\ software\\\\avast\\\\avastsvc.exe or *\\\\ranger\\\\sentinelranger.exe or *\\\\avast\\\\avastsvc.exe) or process.executable:c\\:\\\\program\\ files\\\\splunkuniversalforwarder\\\\bin\\\\*)))
<li><a href="#">query: ((destination.port:\"3389\" and winlog.event_data.initiated:\"true\") and (not (process.executable:(*\\\\mstsc.exe or *\\\\rtsapp.exe or *\\\\rts2app.exe or *\\\\rdcman.exe or *\\\\ws_tunnelservice.exe or *\\\\rssensor.exe or *\\\\remotedesktopmanagerfree.exe or *\\\\remotedesktopmanager.exe or *\\\\remotedesktopmanager64.exe or *\\\\mremoteng.exe or *\\\\mremote.exe or *\\\\terminals.exe or *\\\\spiceworks\\-finder.exe or *\\\\fsdiscovery.exe or *\\\\fsassessment.exe or *\\\\mobarte.exe or *\\\\chrome.exe or *\\\\system32\\\\dns.exe or *\\\\thor.exe or *\\\\thor64.exe or *\\\\passwordstate.exe) or process.executable:c\\:\\\\program\\ files\\\\splunkuniversalforwarder\\\\bin\\\\*)))
<li><a href="#">query: ((destination.port:\"88\" and winlog.event_data.initiated:\"true\") and (not (process.executable:(*\\\\lsass.exe or *\\\\opera.exe or *\\\\chrome.exe or *\\\\firefox.exe or *\\\\tomcat\\\\bin\\\\tomcat8.exe))))
<li><a href="#">query: ((destination:*new\\-object* and destination:*net.webclient* and destination:*.downloadstring*) or (destination:*new\\-object* and destination:*net.webclient* and destination:*.downloadfile*) or destination:(*\\ iex\\(* or *wscript.shell* or *\\ \\-nop\\ * or *\\ \\-noprofile\\ * or *\\ \\-decode\\ * or *\\ \\-enc\\ *) or destination:(*wscript.shell* or *system.security.cryptography.frombase64transform*))
<li><a href="#">query: ((dll.path:(*\\\\credui.dll or *\\\\wincredui.dll) or winlog.event_data.originalfilename:(\"credui.dll\" or \"wincredui.dll\")) and (not ((process.executable.text:(c\\:\\\\windows\\\\system32\\\\* or c\\:\\\\windows\\\\syswow64\\\\* or c\\:\\\\program\\ files\\\\* or c\\:\\\\program\\ files\\ \\(x86\\)\\\\*)) or (process.executable.text:(*\\\\opera_autoupdate.exe or *\\\\procexp64.exe or *\\\\procexp.exe)) or (process.executable.text:(\"c\\:\\\\windows\\\\immersivecontrolpanel\\\\systemsettings.exe\" or \"c\\:\\\\windows\\\\explorer.exe\")) or (process.executable.text:c\\:\\\\users\\\\* and process.executable.text:(*\\\\appdata\\\\roaming\\\\spotify\\\\spotify.exe or *\\\\appdata\\\\local\\\\microsoft\\\\teams\\\\current\\\\teams.exe)) or (process.executable.text:c\\:\\\\users\\\\* and process.executable.text:*\\\\appdata\\\\local\\\\microsoft\\\\onedrive\\\\*) or (process.executable.text:\"c\\:\\\\windows\\\\regedit.exe\") or (provider_name:\"microsoft\\-windows\\-kernel\\-process\" and process.command_line.text:*c\\:\\\\program\\ files\\\\windowsapps\\\\spotifyab.spotifymusic_*))))
<li><a href="#">query: ((dll.path:(*\\\\dbghelp.dll or *\\\\dbgcore.dll) and (process.executable.text:(*\\\\msbuild.exe or *\\\\cmd.exe or *\\\\rundll32.exe or *\\\\word.exe or *\\\\excel.exe or *\\\\powerpnt.exe or *\\\\outlook.exe or *\\\\monitoringhost.exe or *\\\\wmic.exe or *\\\\bash.exe or *\\\\wscript.exe or *\\\\cscript.exe or *\\\\mshta.exe or *\\\\dnx.exe or *\\\\regsvcs.exe or *\\\\sc.exe or *\\\\scriptrunner.exe) or signed:\"false\")) and (not ((process.executable.text:*visual\\ studio* or process.command_line.text:(*\\-k\\ localsystemnetworkrestricted* or *\\-k\\ unistacksvcgroup\\ \\-s\\ wpnuserservice*)) or (process.command_line.text:(\"c\\:\\\\windows\\\\system32\\\\svchost.exe\\ \\-k\\ netsvcs\\ \\-p\\ \\-s\\ wuauserv\" or \"c\\:\\\\windows\\\\system32\\\\svchost.exe\\ \\-k\\ wersvcgroup\")) or (process.command_line.text:c\\:\\\\windows\\\\winsxs\\\\* and process.command_line.text:*\\\\tiworker.exe\\ \\-embedding))))
<li><a href="#">query: ((dll.path:(*\\\\kprocesshacker.sys or *\\\\systeminformer.sys)) or (winlog.event_data.hashes:(*imphash\\=821d74031d3f625bcbd0df08b70f1e77* or *imphash\\=f86759bb4de4320918615dc06e998a39* or *imphash\\=0a64eeb85419257d0ce32bd5d55c3a18* or *imphash\\=6e7b34dfc017700b1517b230df6ff0d0*)) or (winlog.event_data.imphash:(\"821d74031d3f625bcbd0df08b70f1e77\" or \"f86759bb4de4320918615dc06e998a39\" or \"0a64eeb85419257d0ce32bd5d55c3a18\" or \"6e7b34dfc017700b1517b230df6ff0d0\")) or (winlog.event_data.hashes:(*sha256\\=8b9ad98944ac9886ea4cb07700e71b78be4a2740934bb7e46ca3b56a7c59ad24* or *sha256\\=a41348bec147ca4d9ea2869817527eb5cea2e20202af599d2b30625433bcf454* or *sha256\\=38ee0a88af8535a11efe8d8da9c6812aa07067b75a64d99705a742589bdd846d* or *sha256\\=a773891acf203a7eb0c0d30942fb1347648f1cd918ae2bfd9a4857b4dcf5081b* or *sha256\\=4c3b81ac88a987bbdf7d41fa0aecc2cedf5b9bd2f45e7a21f376d05345fc211d* or *sha256\\=3241bc14bec51ce6a691b9a3562e5c1d52e9d057d27a3d67fd0b245c350b6d34* or *sha256\\=047c42e9bba28366868847c7dafc1e043fb038c796422d37220493517d68ee89* or *sha256\\=18931dc81e95d0020466fa091e16869dbe824e543a4c2c8fe644fa71a0f44feb* or *sha256\\=b4c2ef76c204273132fde38f0ded641c2c5ee767652e64e4c4071a4a973b6c1b* or *sha256\\=640954afc268565f7daa6e6f81a8ee05311e33e34332b501a3c3fe5b22adea97* or *sha256\\=251be949f662c838718f8aa0a5f8211fb90346d02bd63ff91e6b224e0e01b656* or *sha256\\=e2606f272f7ba054df16be464fda57211ef0d14a0d959f9c8dcb0575df1186e4* or *sha256\\=3a9e1d17beeb514f1b9b3bacaee7420285de5cbdce89c5319a992c6cbd1de138*)) or (sha256:(\"8b9ad98944ac9886ea4cb07700e71b78be4a2740934bb7e46ca3b56a7c59ad24\" or \"a41348bec147ca4d9ea2869817527eb5cea2e20202af599d2b30625433bcf454\" or \"38ee0a88af8535a11efe8d8da9c6812aa07067b75a64d99705a742589bdd846d\" or \"a773891acf203a7eb0c0d30942fb1347648f1cd918ae2bfd9a4857b4dcf5081b\" or \"4c3b81ac88a987bbdf7d41fa0aecc2cedf5b9bd2f45e7a21f376d05345fc211d\" or \"3241bc14bec51ce6a691b9a3562e5c1d52e9d057d27a3d67fd0b245c350b6d34\" or \"047c42e9bba28366868847c7dafc1e043fb038c796422d37220493517d68ee89\" or \"18931dc81e95d0020466fa091e16869dbe824e543a4c2c8fe644fa71a0f44feb\" or \"b4c2ef76c204273132fde38f0ded641c2c5ee767652e64e4c4071a4a973b6c1b\" or \"640954afc268565f7daa6e6f81a8ee05311e33e34332b501a3c3fe5b22adea97\" or \"251be949f662c838718f8aa0a5f8211fb90346d02bd63ff91e6b224e0e01b656\" or \"e2606f272f7ba054df16be464fda57211ef0d14a0d959f9c8dcb0575df1186e4\" or \"3a9e1d17beeb514f1b9b3bacaee7420285de5cbdce89c5319a992c6cbd1de138\")))
<li><a href="#">query: ((dll.path:(*\\\\prokiller64.sys* or *\\\\gftkyj64.sys* or *\\\\kapchelper_x64.sys* or *\\\\nodedriver.sys* or *\\\\lctka.sys*)) or (winlog.event_data.hashes:(*sha256\\=0440ef40c46fdd2b5d86e7feef8577a8591de862cfd7928cdbcc8f47b8fa3ffc* or *sha256\\=9b1b15a3aacb0e786a608726c3abfc94968915cedcbd239ddf903c4a54bfcf0c* or *sha256\\=8e035beb02a411f8a9e92d4cf184ad34f52bbd0a81a50c222cdd4706e4e45104* or *sha256\\=d7c81b0f3c14844f6424e8bdd31a128e773cb96cccef6d05cbff473f0ccb9f9c* or *sha256\\=05b146a48a69dd62a02759487e769bd30d39f16374bc76c86453b4ae59e7ffa4* or *sha256\\=c8f9e1ad7b8cce62fba349a00bc168c849d42cfb2ca5b2c6cc4b51d054e0c497* or *sha1\\=31cc8718894d6e6ce8c132f68b8caaba39b5ba7a* or *sha1\\=a804ebec7e341b4d98d9e94f6e4860a55ea1638d* or *sha1\\=6debce728bcff73d9d1d334df0c6b1c3735e295c* or *sha1\\=cc65bf60600b64feece5575f21ab89e03a728332* or *sha1\\=3ef30c95e40a854cc4ded94fc503d0c3dc3e620e* or *sha1\\=b2f955b3e6107f831ebe67997f8586d4fe9f3e98* or *md5\\=10f3679384a03cb487bda9621ceb5f90* or *md5\\=04a88f5974caa621cee18f34300fc08a* or *md5\\=6fcf56f6ca3210ec397e55f727353c4a* or *md5\\=0f16a43f7989034641fd2de3eb268bf1* or *md5\\=ee6b1a79cb6641aa44c762ee90786fe0* or *md5\\=909f3fc221acbe999483c87d9ead024a*)) or (sha256:(\"0440ef40c46fdd2b5d86e7feef8577a8591de862cfd7928cdbcc8f47b8fa3ffc\" or \"9b1b15a3aacb0e786a608726c3abfc94968915cedcbd239ddf903c4a54bfcf0c\" or \"8e035beb02a411f8a9e92d4cf184ad34f52bbd0a81a50c222cdd4706e4e45104\" or \"d7c81b0f3c14844f6424e8bdd31a128e773cb96cccef6d05cbff473f0ccb9f9c\" or \"05b146a48a69dd62a02759487e769bd30d39f16374bc76c86453b4ae59e7ffa4\" or \"c8f9e1ad7b8cce62fba349a00bc168c849d42cfb2ca5b2c6cc4b51d054e0c497\")) or (sha1:(\"31cc8718894d6e6ce8c132f68b8caaba39b5ba7a\" or \"a804ebec7e341b4d98d9e94f6e4860a55ea1638d\" or \"6debce728bcff73d9d1d334df0c6b1c3735e295c\" or \"cc65bf60600b64feece5575f21ab89e03a728332\" or \"3ef30c95e40a854cc4ded94fc503d0c3dc3e620e\" or \"b2f955b3e6107f831ebe67997f8586d4fe9f3e98\")) or (md5:(\"10f3679384a03cb487bda9621ceb5f90\" or \"04a88f5974caa621cee18f34300fc08a\" or \"6fcf56f6ca3210ec397e55f727353c4a\" or \"0f16a43f7989034641fd2de3eb268bf1\" or \"ee6b1a79cb6641aa44c762ee90786fe0\" or \"909f3fc221acbe999483c87d9ead024a\")))
<li><a href="#">query: ((dll.path:*\\\\dbutil_2_3.sys*) or (winlog.event_data.hashes:(*sha256\\=0296e2ce999e67c76352613a718e11516fe1b0efc3ffdb8918fc999dd76a73a5* or *sha256\\=ddbf5ecca5c8086afde1fb4f551e9e6400e94f4428fe7fb5559da5cffa654cc1* or *sha1\\=c948ae14761095e4d76b55d9de86412258be7afd* or *sha1\\=10b30bdee43b3a2ec4aa63375577ade650269d25* or *md5\\=c996d7971c49252c582171d9380360f2* or *md5\\=d2fd132ab7bbc6bbb87a84f026fa0244*)) or (sha256:(\"0296e2ce999e67c76352613a718e11516fe1b0efc3ffdb8918fc999dd76a73a5\" or \"ddbf5ecca5c8086afde1fb4f551e9e6400e94f4428fe7fb5559da5cffa654cc1\")) or (sha1:(\"c948ae14761095e4d76b55d9de86412258be7afd\" or \"10b30bdee43b3a2ec4aa63375577ade650269d25\")) or (md5:(\"c996d7971c49252c582171d9380360f2\" or \"d2fd132ab7bbc6bbb87a84f026fa0244\")))
<li><a href="#">query: ((dll.path:*\\\\hw.sys) or (winlog.event_data.hashes:(*sha256\\=4880f40f2e557cff38100620b9aa1a3a753cb693af16cd3d95841583edcb57a8* or *sha256\\=55963284bbd5a3297f39f12f0d8a01ed99fe59d008561e3537bcd4db4b4268fa* or *sha256\\=6a4875ae86131a594019dec4abd46ac6ba47e57a88287b814d07d929858fe3e5* or *sha1\\=74e4e3006b644392f5fcea4a9bae1d9d84714b57* or *sha1\\=18f34a0005e82a9a1556ba40b997b0eae554d5fd* or *sha1\\=4e56e0b1d12664c05615c69697a2f5c5d893058a* or *md5\\=3247014ba35d406475311a2eab0c4657* or *md5\\=376b1e8957227a3639ec1482900d9b97* or *md5\\=45c2d133d41d2732f3653ed615a745c8*)) or (sha256:(\"4880f40f2e557cff38100620b9aa1a3a753cb693af16cd3d95841583edcb57a8\" or \"55963284bbd5a3297f39f12f0d8a01ed99fe59d008561e3537bcd4db4b4268fa\" or \"6a4875ae86131a594019dec4abd46ac6ba47e57a88287b814d07d929858fe3e5\")) or (sha1:(\"74e4e3006b644392f5fcea4a9bae1d9d84714b57\" or \"18f34a0005e82a9a1556ba40b997b0eae554d5fd\" or \"4e56e0b1d12664c05615c69697a2f5c5d893058a\")) or (md5:(\"3247014ba35d406475311a2eab0c4657\" or \"376b1e8957227a3639ec1482900d9b97\" or \"45c2d133d41d2732f3653ed615a745c8\")))
<li><a href="#">query: ((eventlog:\"rpcfw\" and winlog.event_id:\"3\" and interfaceuuid:\"1ff70682\\-0a51\\-30e8\\-076d\\-740be8cee98b\") and (not (opnum:(\"0\" or \"1\"))))
<li><a href="#">query: ((eventlog:\"rpcfw\" and winlog.event_id:\"3\" and interfaceuuid:\"338cd001\\-2244\\-31f1\\-aaaa\\-900038001003\") and (not (opnum:(\"6\" or \"7\" or \"8\" or \"13\" or \"18\" or \"19\" or \"21\" or \"22\" or \"23\" or \"35\"))))
<li><a href="#">query: ((eventlog:\"rpcfw\" and winlog.event_id:\"3\" and interfaceuuid:\"378e52b0\\-c0a9\\-11cf\\-822d\\-00aa0051e40f\") and (not (opnum:(\"0\" or \"1\"))))
<li><a href="#">query: ((eventlog:\"rpcfw\" and winlog.event_id:\"3\" and interfaceuuid:\"86d35949\\-83c9\\-4044\\-b424\\-db363231fd0c\") and (not (opnum:(\"1\" or \"3\" or \"4\" or \"10\" or \"11\" or \"12\" or \"13\" or \"14\" or \"15\"))))
<li><a href="#">query: ((eventlog:\"rpcfw\" and winlog.event_id:\"3\" and interfaceuuid:\"e3514235\\-4b06\\-11d1\\-ab04\\-00c04fc2dcd2\") and (not (opnum:(\"0\" or \"1\" or \"12\"))))
<li><a href="#">query: ((eventname:\"createinstanceexporttask\" and eventsource:\"ec2.amazonaws.com\") and (errormessage:* or errorcode:* or responseelements:*failure*))
<li><a href="#">query: ((eventsource:\"ec2.amazonaws.com\" and eventname:\"listbuckets\") and (not (type:\"assumedrole\")))
<li><a href="#">query: ((eventsource:\"iam.amazonaws.com\" and eventname:\"createaccesskey\") and (not (useridentity.arn:*responseelements.accesskey.username*)))
<li><a href="#">query: ((eventsource:\"iam.amazonaws.com\" and eventname:\"updateloginprofile\") and (not (useridentity.arn:*requestparameters.username*)))
<li><a href="#">query: ((eventsource:\"sts.amazonaws.com\" and eventname:\"assumerolewithsaml\") or (eventsource:\"iam.amazonaws.com\" and eventname:\"updatesamlprovider\"))
<li><a href="#">query: ((file.name:*\\\\msse\\-* and file.name:*\\-server*) or file.name:\\\\postex_* or file.name:\\\\postex_ssh_* or file.name:\\\\status_* or file.name:\\\\msagent_*)
<li><a href="#">query: ((file.name:*\\\\msse\\-* and file.name:*\\-server*) or file.name:\\\\postex_* or file.name:\\\\status_* or file.name:\\\\msagent_*)
<li><a href="#">query: ((file.path.text:(*.zip or *.rar or *.iso or *.exe) and file.path.text:(*.doc.* or *.docx.* or *.xls.* or *.xlsx.* or *.ppt.* or *.pptx.* or *.jpg.* or *.pdf.*)) or file.path.text:(*.zip.exe or *.rar.exe))
<li><a href="#">query: ((file.path.text:(*\\\\temp\\\\sam or *\\\\sam.sav or *\\\\intel\\\\sam or *\\\\sam.hive or *\\\\perflogs\\\\sam or *\\\\programdata\\\\sam or *\\\\users\\\\public\\\\sam or *\\\\appdata\\\\local\\\\sam or *\\\\appdata\\\\roaming\\\\sam or *_shadowsteal.zip or *\\\\documents\\\\sam.export or *\\:\\\\sam)) or (file.path.text:(*\\\\hive_sam_* or *\\\\sam.save* or *\\\\sam.export* or *\\\\\\~reg_sam.save* or *\\\\sam_backup* or *\\\\sam.bck* or *\\\\sam.backup*)))
<li><a href="#">query: ((file.path.text:(\\/etc\\/cron.d\\/* or \\/etc\\/cron.daily\\/* or \\/etc\\/cron.hourly\\/* or \\/etc\\/cron.monthly\\/* or \\/etc\\/cron.weekly\\/* or \\/var\\/spool\\/cron\\/crontabs\\/*)) or (file.path.text:(*\\/etc\\/cron.allow* or *\\/etc\\/cron.deny* or *\\/etc\\/crontab*)))
<li><a href="#">query: ((file.path.text:*.lnk and file.path.text:(*.doc.* or *.docx.* or *.xls.* or *.xlsx.* or *.ppt.* or *.pptx.* or *.jpg.* or *.pdf.*)) and (not (file.path.text:(*\\\\appdata\\\\roaming\\\\microsoft\\\\office\\\\recent\\\\* or *\\\\appdata\\\\roaming\\\\microsoft\\\\windows\\\\recent\\\\*))))
<li><a href="#">query: ((file.path.text:*\\\\appdata\\\\* and file.path.text:(*.exe or *.dll or *.bat or *.vbe or *.vbs or *.msi or *.iso or *.lnk or *.cmd or *.ps1 or *.psm1 or *.hta or *.cpl or *.scr)) and (not (file.path.text:(*\\\\appdata\\\\local\\\\* or *\\\\appdata\\\\locallow\\\\* or *\\\\appdata\\\\roaming\\\\*))))
<li><a href="#">query: ((file.path.text:*\\\\appdata\\\\roaming\\\\oracle\\\\bin\\\\java* and file.path.text:*.exe*) or (file.path.text:*\\\\retrive* and file.path.text:*.vbs*))
<li><a href="#">query: ((file.path.text:*\\\\local\\\\microsoft\\\\windows\\\\schcache\\\\* and file.path.text:*.sch) and (not ((process.executable.text:(\"c:\\windows\\system32\\svchost.exe\" or \"c:\\windows\\system32\\dllhost.exe\" or \"c:\\windows\\system32\\mmc.exe\" or \"c:\\windows\\system32\\windowspowershell\\v1.0\\powershell.exe\" or \"c:\\windows\\ccm\\ccmexec.exe\" or \"c:\\program files\\cylance\\desktop\\cylancesvc.exe\" or \"c:\\windows\\system32\\wbem\\wmiprvse.exe\")) or (process.executable.text:(c\\:\\\\windows\\\\ccmsetup\\\\autoupgrade\\\\ccmsetup* or c\\:\\\\program\\ files\\\\sentinelone\\\\sentinel\\ agent*)) or (process.executable.text:*\\\\landesk\\\\ldclient\\\\ldapwhoami.exe) or (process.executable.text:(\"c:\\windows\\system32\\efsui.exe\" or \"c:\\windows\\system32\\dsac.exe\")) or (process.executable.text:*\\:\\\\program\\ files\\\\citrix\\\\receiver\\ storefront\\\\services\\\\defaultdomainservices\\\\citrix.deliveryservices.domainservices.servicehost.exe))))
<li><a href="#">query: ((file.path.text:*\\\\notepad\\+\\+\\\\plugins\\\\* and file.path.text:*.dll) and (not (((process.executable.text:*\\\\notepad\\+\\+\\\\updater\\\\gup.exe)) or ((process.executable.text:c\\:\\\\users\\\\* and process.executable.text:*\\\\appdata\\\\local\\\\temp\\\\* and process.executable.text:(*\\\\target.exe or *installer.x64.exe))))))
<li><a href="#">query: ((file.path.text:c\\:\\\\users\\\\* and file.path.text:*\\\\appdata\\\\local\\\\temp\\\\osksupport.dll) or (process.executable.text:\"c\\:\\\\windows\\\\system32\\\\dllhost.exe\" and file.path.text:\"c\\:\\\\program\\ files\\\\windows\\ media\\ player\\\\osk.exe\"))
<li><a href="#">query: ((file.path:(*\\\\credui.dll or *\\\\wincredui.dll) or winlog.event_data.originalfilename:(\"credui.dll\" or \"wincredui.dll\")) and (not (process.executable:(c\\:\\\\windows\\\\system32\\\\* or c\\:\\\\windows\\\\explorer.exe* or c\\:\\\\program\\ files\\\\* or c\\:\\\\users\\\\*\\\\appdata\\\\local\\\\microsoft\\\\onedrive\\\\*\\\\microsoft.sharepoint.exe* or c\\:\\\\program\\ files\\ \\(x86\\)\\\\* or c\\:\\\\windows\\\\immersivecontrolpanel\\\\systemsettings.exe* or c\\:\\\\users\\\\*\\\\appdata\\\\local\\\\microsoft\\\\onedrive\\\\onedrive.exe* or c\\:\\\\users\\\\*\\\\appdata\\\\roaming\\\\spotify\\\\spotify.exe*) or process.executable:*\\\\opera_autoupdate.exe)))
<li><a href="#">query: ((file.path:(*\\\\wmiclnt.dll or *\\\\wmiaprpl.dll or *\\\\wmiprov.dll or *\\\\wmiutils.dll or *\\\\wbemcomn.dll or *\\\\wbemprox.dll or *\\\\wminet_utils.dll or *\\\\wbemsvc.dll or *\\\\fastprox.dll) and (not (process.executable:(*\\\\wmiprvse.exe or *\\\\wmiapsrv.exe or *\\\\svchost.exe or *\\\\devicecensus.exe or *\\\\compattelrunner.exe or *\\\\sdiagnhost.exe or *\\\\sihclient.exe or *\\\\ngentask.exe or *\\\\windows\\\\system32\\\\taskhostw.exe or *\\\\windows\\\\system32\\\\mousocoreworker.exe or *\\\\windows\\\\system32\\\\wbem\\\\wmiadap.exe or *c\\:\\\\windows\\\\sysmon64.exe or *c\\:\\\\windows\\\\sysmon.exe or *c\\:\\\\windows\\\\system32\\\\wbem\\\\unsecapp.exe or *\\\\logman.exe or *\\\\systeminfo.exe or *\\\\nvcontainer.exe or *c\\:\\\\windows\\\\system32\\\\wbem\\\\wmic.exe or *\\\\explorer.exe or *\\\\opera_autoupdate.exe or *\\\\msmpeng.exe or *\\\\thor64.exe or *\\\\thor.exe)))) and (not (process.executable:(c\\:\\\\program\\ files\\\\* or c\\:\\\\program\\ files\\ \\(x86\\)\\\\*))))
<li><a href="#">query: ((file.path:*.dll and (not (originalfilename:(*.dll or *.tmp) or originalfilename:*.dll.*))) and (not (process.executable:c\\:\\\\windows\\\\winsxs\\\\* and process.executable:*\\\\tiworker.exe)))
<li><a href="#">query: ((file.path:*.log and file.path:*\\\\teamviewer_*) and (not (process.executable:\"c\\:\\\\windows\\\\system32\\\\svchost.exe\")))
<li><a href="#">query: ((file.path:*\\/etc\\/emond.d\\/rules\\/* and file.path:*.plist) or file.path:*\\/private\\/var\\/db\\/emondclients\\/*)
<li><a href="#">query: ((file.path:*\\\\appdata\\\\local\\\\temp\\\\* and file.path:*procexp152.sys) and (not (process.executable:(*\\\\procexp64.exe* or *\\\\procexp.exe* or *\\\\procmon64.exe* or *\\\\procmon.exe*))))
<li><a href="#">query: ((file.path:*\\\\appdata\\\\roaming\\\\oracle\\\\bin\\\\java* and file.path:*.exe*) or (file.path:*\\\\retrive* and file.path:*.vbs*))
<li><a href="#">query: ((file.path:*\\\\local\\\\microsoft\\\\windows\\\\schcache\\\\* and file.path:*.sch) and (not (process.executable:(\"c\\:\\\\windows\\\\system32\\\\svchost.exe\" or \"c\\:\\\\windows\\\\system32\\\\dllhost.exe\" or \"c\\:\\\\windows\\\\system32\\\\mmc.exe\" or \"c\\:\\\\windows\\\\system32\\\\windowspowershell\\\\v1.0\\\\powershell.exe\" or \"c\\:\\\\windows\\\\ccm\\\\ccmexec.exe\" or \"c\\:\\\\program\\ files\\\\cylance\\\\desktop\\\\cylancesvc.exe\" or \"c\\:\\\\windows\\\\system32\\\\wbem\\\\wmiprvse.exe\"))))
<li><a href="#">query: ((file.path:c\\:\\\\users\\\\* and file.path:*\\\\appdata\\\\local\\\\temp\\\\osksupport.dll) or (process.executable:\"c\\:\\\\windows\\\\system32\\\\dllhost.exe\" and file.path:\"c\\:\\\\program\\ files\\\\windows\\ media\\ player\\\\osk.exe\"))
<li><a href="#">query: ((file.path:c\\:\\\\windows\\\\prefetch\\\\* and file.path:*.pf) and (not (process.executable:\"c\\:\\\\windows\\\\system32\\\\svchost.exe\" and user.name:(nt\\ authority\\\\system* or autorite\\ nt\\\\sys*))))
<li><a href="#">query: ((file.path:c\\:\\\\windows\\\\temp\\\\* and process.executable:\"c\\:\\\\windows\\\\system32\\\\rundll32.exe\" and user.name:(*nt\\ authori* or *nt\\ autori*) and file.path:(*.rtf or *.otf or *.odt or *.txt or *.doc or *.pdf or *.dll or *.docx or *.wpd or *.icns or *.db or *.ini or *.tex or *.sys or *.csv or *.fon or *.tar or *.ttf or *.xml or *.cfg or *.cpl or *.jpg or *.drv or *.cur or *.tmp)) or (file.path:\"c\\:\\\\windows\\\\temp\\\\procdump.exe\" and user.name:(*nt\\ autho* or *nt\\ auto*)))
<li><a href="#">query: ((filename:(c\\:\\\\windows\\\\* or c\\:\\\\temp\\\\* or c\\:\\\\perflogs\\\\* or c\\:\\\\users\\\\public\\\\* or c\\:\\\\users\\\\default\\\\*)) or (filename:(*\\\\client\\\\* or *\\\\tsclient\\\\* or *\\\\inetpub\\\\* or *\\/www\\/* or *apache* or *tomcat* or *nginx* or *weblogic*)) or (filename:(*.asax or *.ashx or *.asmx or *.asp or *.aspx or *.bat or *.cfm or *.cgi or *.chm or *.cmd or *.dat or *.ear or *.gif or *.hta or *.jpeg or *.jpg or *.jsp or *.jspx or *.lnk or *.php or *.pl or *.png or *.ps1 or *.psm1 or *.py or *.pyc or *.rb or *.scf or *.sct or *.sh or *.svg or *.txt or *.vbe or *.vbs or *.war or *.wsf or *.wsh or *.xml)))
<li><a href="#">query: ((http.request.method:\"get\" and (*\\=(script)* or *\\=%3cscript%3e* or *\\=%253cscript%253e* or *<iframe\\ * or *%3ciframe\\ * or *<svg\\ * or *%3csvg\\ * or *document.cookie* or *document.domain* or *\\ onerror\\=* or *\\ onresize\\=* or *\\ onload\\=\\\"* or *onmouseover\\=* or *$\\{alert* or *javascript\\:alert* or *javascript%3aalert*)) and (not (http.response.status_code:\"404\")))
<li><a href="#">query: ((http.request.method:\"get\" and (*\\=\\{\\{* or *\\=%7b%7b* or *\\=$\\{* or *\\=$%7b* or *\\=<%\\=* or *\\=%3c%25\\=* or *\\=@\\(* or *freemarker.template.utility.execute* or *.getclass\\(\\).forname\\('javax.script.scriptenginemanager'\\)* or *t\\(org.apache.commons.io.ioutils\\)*)) and (not (http.response.status_code:\"404\")))
<li><a href="#">query: ((http.request.method:\"get\" and (*\\=select* or *union\\ select* or *union%20select* or *union\\ all\\ select* or *union%20all%20select* or *concat\\(0x* or *order\\ by\\ * or *order%20by%20* or *information_schema.tables* or *group_concat\\(* or *table_schema* or *select%28sleep%2810%29* or *@@version* or *'1'\\='1* or *%271%27%3d%271* or *selectchar\\(* or *select\\ *\\ * or *select%20*%20* or *or\\ 1\\=1#* or *or%201\\=1#*)) and (not ((http.response.status_code:\"404\") or (*\\=select2*))))
<li><a href="#">query: ((http.request.method:\"get\" and url.original:*\\?manifest\\=wac and (url.domain:\"onedrive.live.com\" or destination.domain:\"onedrive.live.com\")) and (not (url.original:http* and url.original:*\\:\\/\\/onedrive.live.com\\/*)))
<li><a href="#">query: ((http.request.method:\"post\" and http.response.status_code:\"200\" and cs-uri-query:*\\/owa\\/* and cs-uri-query:*\\/powershell* and cs-uri-query:(*@* or *%40*)) and (not (cs-user-agent:(\"clientinfo\" or \"microsoft winrm client\" or \"exchange backend probes\"))))
<li><a href="#">query: ((http.request.method:\"post\" and http.response.status_code:\"200\" and cs-username:\"anonymous\") and (((cs-uri-query:*\\/pages\\/createpage\\-entervariables.action* and cs-uri-query:*spacekey\\=x*)) or ((cs-uri-query:*\\/doenterpagevariables.action* and \"u0027\"))))
<li><a href="#">query: ((http.request.method:\"post\" and http.response.status_code:\"200\" and url.original:*\\/owa\\/* and url.original:*\\/powershell* and url.original:(*@* or *%40*)) and (not (user_agent.original:(\"clientinfo\" or \"microsoft winrm client\" or \"exchange backend probes\"))))
<li><a href="#">query: ((image:*\\\\wbadmin.exe or process.command_line:*wbadmin*) and (process.command_line:*delete\\ * and process.command_line:*systemstatebackup\\ * and process.command_line:*\\-keepversions\\:0*))
<li><a href="#">query: ((integritylevel:(\"high\" or \"system\") and process.executable.text:\"c\\:\\\\windows\\\\system32\\\\computerdefaults.exe\") and (not (process.parent.executable.text:(*\\:\\\\windows\\\\system32* or *\\:\\\\program\\ files*))))
<li><a href="#">query: ((integritylevel:(\"high\" or \"system\") and process.executable:\"c\\:\\\\windows\\\\system32\\\\computerdefaults.exe\") and (not (process.parent.executable:(*\\:\\\\windows\\\\system32* or *\\:\\\\program\\ files*))))
<li><a href="#">query: ((integritylevel:\"system\" and user.name:(*authori* or *autori*)) and (process.executable:(*\\\\calc.exe or *\\\\wscript.exe or *\\\\cscript.exe or *\\\\hh.exe or *\\\\mshta.exe or *\\\\forfiles.exe or *\\\\ping.exe) or process.command_line:(*sc\\ stop\\ * or *\\ \\-nop\\ * or *\\ \\-w\\ hidden\\ * or *\\ \\-decode\\ * or *\\ \\/decode\\ * or *\\ \\/urlcache\\ * or *\\ \\-urlcache\\ * or *\\ \\-e*\\ jab* or *\\ \\-e*\\ suvyi* or *\\ \\-e*\\ sqbfafga* or *\\ \\-e*\\ awv4i* or *\\ \\-e*\\ iab* or *\\ \\-e*\\ paa* or *\\ \\-e*\\ aqblahga* or *vssadmin\\ delete\\ shadows* or *reg\\ save\\ hklm* or *\\ \\-ma\\ * or *microsoft\\\\windows\\\\currentversion\\\\run* or *.downloadstring\\(* or *.downloadfile\\(* or *\\ \\/ticket\\:* or *dpapi\\:\\:* or *event\\:\\:clear* or *event\\:\\:drop* or *id\\:\\:modify* or *kerberos\\:\\:* or *lsadump\\:\\:* or *misc\\:\\:* or *privilege\\:\\:* or *rpc\\:\\:* or *sekurlsa\\:\\:* or *sid\\:\\:* or *token\\:\\:* or *vault\\:\\:cred* or *vault\\:\\:list* or *\\ p\\:\\:d\\ * or *;iex\\(* or *minidump* or *net\\ user\\ *)))
<li><a href="#">query: ((not (process.executable.text:(*.exe or *.tmp))) and (not ((not _exists_:process.executable.text) or (process.executable.text:(\"registry\" or \"memcompression\" or \"vmmem\")) or (process.executable.text:(\"\\-\" or \"\")) or (process.executable.text:c\\:\\\\windows\\\\installer\\\\msi*) or (process.parent.executable.text:(c\\:\\\\programdata\\\\avira\\\\* or c\\:\\\\windows\\\\system32\\\\driverstore\\\\filerepository\\\\*)) or (process.executable.text:*.scr) or (process.executable.text:*nvidia\\\\nvbackend\\\\* and process.executable.text:*.dat) or (process.executable.text:(c\\:\\\\windows\\\\system32\\\\* or c\\:\\\\windows\\\\syswow64\\\\*) and process.executable.text:*.com) or (process.executable.text:*\\\\winscp.com) or (process.executable.text:*c\\:\\\\users\\\\* and process.executable.text:*\\\\appdata\\\\* and process.executable.text:*.tmp* and process.executable.text:*codesetup*) or (process.executable.text:*\\\\program\\\\soffice.bin) or (process.executable.text:(\"c\\:\\\\program\\ files\\\\emc\\ networker\\\\management\\\\gst\\\\apache\\\\cgi\\-bin\\\\update_jnlp.cgi\" or \"c\\:\\\\program\\ files\\ \\(x86\\)\\\\emc\\ networker\\\\management\\\\gst\\\\apache\\\\cgi\\-bin\\\\update_jnlp.cgi\")) or (process.executable.text:(c\\:\\\\program\\ files\\ \\(x86\\)\\\\winpakpro\\\\* or c\\:\\\\program\\ files\\\\winpakpro\\\\*) and process.executable.text:*.ngn) or (process.executable.text:(\"c\\:\\\\program\\ files\\ \\(x86\\)\\\\myq\\\\server\\\\pcltool.dll\" or \"c\\:\\\\program\\ files\\\\myq\\\\server\\\\pcltool.dll\")) or (process.executable.text:(c\\:\\\\program\\ files\\\\microsoft\\ visual\\ studio\\\\* or c\\:\\\\program\\ files\\ \\(x86\\)\\\\microsoft\\ visual\\ studio*) and process.executable.text:*.com) or (process.executable.text:c\\:\\\\config.msi\\\\* and process.executable.text:(*.rbf or *.rbs)) or (process.executable.text:*\\\\appdata\\\\local\\\\packages\\\\* and process.executable.text:*\\\\localstate\\\\rootfs\\\\*) or (process.executable.text:*\\\\lzma_exe) or (process.parent.executable.text:c\\:\\\\windows\\\\temp\\\\* and process.executable.text:c\\:\\\\windows\\\\temp\\\\helper\\\\*) or (process.parent.executable.text:c\\:\\\\windows\\\\temp\\\\* and process.parent.executable.text:*\\\\tbt_dock_firmware\\\\getdockver32w.exe))))
<li><a href="#">query: ((not (process.executable.text:*\\\\*)) and (not ((not _exists_:process.executable.text) or (process.executable.text:(\"\\-\" or \"\")) or (process.executable.text:(\"registry\" or \"memcompression\" or \"vmmem\") or process.command_line.text:(\"registry\" or \"memcompression\" or \"vmmem\")))))
<li><a href="#">query: ((not (process.executable:(*.exe or *.tmp))) and (not ((not _exists_:process.executable) or (process.executable:(\"registry\" or \"memcompression\")) or (process.executable:(\"\\-\" or \"\")) or (process.executable:c\\:\\\\windows\\\\installer\\\\msi*) or (process.parent.executable:(c\\:\\\\programdata\\\\avira\\\\* or c\\:\\\\windows\\\\system32\\\\driverstore\\\\filerepository\\\\*)) or (process.executable:*.scr) or (process.executable:*nvidia\\\\nvbackend\\\\* and process.executable:*.dat) or (process.executable:(c\\:\\\\windows\\\\system32\\\\* or c\\:\\\\windows\\\\syswow64\\\\*) and process.executable:*.com) or (process.executable:*\\\\winscp.com) or (process.executable:*c\\:\\\\users\\\\* and process.executable:*\\\\appdata\\\\* and process.executable:*.tmp* and process.executable:*codesetup*) or (process.executable:*\\\\program\\\\soffice.bin) or (process.executable:(\"c\\:\\\\program\\ files\\\\emc\\ networker\\\\management\\\\gst\\\\apache\\\\cgi\\-bin\\\\update_jnlp.cgi\" or \"c\\:\\\\program\\ files\\ \\(x86\\)\\\\emc\\ networker\\\\management\\\\gst\\\\apache\\\\cgi\\-bin\\\\update_jnlp.cgi\")) or (process.executable:(c\\:\\\\program\\ files\\ \\(x86\\)\\\\winpakpro\\\\* or c\\:\\\\program\\ files\\\\winpakpro\\\\*) and process.executable:*.ngn) or (process.executable:(\"c\\:\\\\program\\ files\\ \\(x86\\)\\\\myq\\\\server\\\\pcltool.dll\" or \"c\\:\\\\program\\ files\\\\myq\\\\server\\\\pcltool.dll\")) or (process.executable:(c\\:\\\\program\\ files\\\\microsoft\\ visual\\ studio\\\\* or c\\:\\\\program\\ files\\ \\(x86\\)\\\\microsoft\\ visual\\ studio*) and process.executable:*.com) or (process.executable:c\\:\\\\config.msi\\\\* and process.executable:(*.rbf or *.rbs)))))
<li><a href="#">query: ((not (process.executable:(c\\:\\\\windows\\\\system32\\\\* or c\\:\\\\windows\\\\syswow64\\\\*))) and (process.parent.command_line:*cmd.exe\\ \\/c* and process.parent.command_line:*roamdiag.cmd* and process.parent.command_line:*\\-outputpath*))
<li><a href="#">query: ((not (process.executable:*\\\\*)) and (not ((not _exists_:process.executable) or (process.executable:(\"\\-\" or \"\")) or (process.executable:\"registry\" or process.command_line:\"registry\"))))
<li><a href="#">query: ((not (winlog.event_data.status:\"success\")) and (not (location:*<countries\\ you\\ do\\ operate\\ out\\ of\\ e,g\\ gb,\\ use\\ or\\ for\\ mulitple>*)))
<li><a href="#">query: ((parentuser:(\"nt\\ authority\\\\network\\ service\" or \"nt\\ authority\\\\local\\ service\" or \"autorite\\ nt\\\\\") and user.name:(\"nt\\ authority\\\\system\" or \"autorite\\ nt\\\\sys\") and integritylevel:\"system\") and (not (process.executable:*\\\\rundll32.exe and process.command_line:*davsetcookie*)))
<li><a href="#">query: ((powershell.command.invocation_details:(*get\\-localgroup* or *get\\-localgroupmember*) or winlog.event_data.payload:(*get\\-localgroup* or *get\\-localgroupmember*)) or contextinfo:(*get\\-localgroup* or *get\\-localgroupmember*) or ((powershell.command.invocation_details:*get\\-wmiobject* or winlog.event_data.payload:*get\\-wmiobject*) and (powershell.command.invocation_details:*win32_group* or winlog.event_data.payload:*win32_group*)) or (contextinfo:*get\\-wmiobject* and contextinfo:*win32_group*))
<li><a href="#">query: ((powershell.command.invocation_details:*get\\-addbaccount* or winlog.event_data.payload:*get\\-addbaccount*) and (powershell.command.invocation_details:*bootkey\\ * or winlog.event_data.payload:*bootkey\\ *) and (powershell.command.invocation_details:*databasepath\\ * or winlog.event_data.payload:*databasepath\\ *))
<li><a href="#">query: ((powershell.command.invocation_details:*get\\-adprincipalgroupmembership* or winlog.event_data.payload:*get\\-adprincipalgroupmembership*) or contextinfo:*get\\-adprincipalgroupmembership* or ((powershell.command.invocation_details:*get\\-aduser* or winlog.event_data.payload:*get\\-aduser*) and (powershell.command.invocation_details:*\\-f\\ * or winlog.event_data.payload:*\\-f\\ *) and (powershell.command.invocation_details:*\\-pr\\ * or winlog.event_data.payload:*\\-pr\\ *) and (powershell.command.invocation_details:*doesnotrequirepreauth* or winlog.event_data.payload:*doesnotrequirepreauth*)) or (contextinfo:*get\\-aduser* and contextinfo:*\\-f\\ * and contextinfo:*\\-pr\\ * and contextinfo:*doesnotrequirepreauth*))
<li><a href="#">query: ((powershell.command.invocation_details:*get\\-clipboard*) or (winlog.event_data.payload:*get\\-clipboard*))
<li><a href="#">query: ((powershell.command.invocation_details:*rundll32.exe* or winlog.event_data.payload:*rundll32.exe*) and (powershell.command.invocation_details:*shell32.dll* or winlog.event_data.payload:*shell32.dll*) and (powershell.command.invocation_details:*shellexec_rundll* or winlog.event_data.payload:*shellexec_rundll*) and (powershell.command.invocation_details:*powershell* or winlog.event_data.payload:*powershell*))
<li><a href="#">query: ((powershell.file.script_block_text:*get\\-itemproperty* and powershell.file.script_block_text:*registry\\:\\:* and powershell.file.script_block_text:*hkey_current_user\\\\control\\ panel\\\\desktop\\\\* and powershell.file.script_block_text:*wallpaper*) or powershell.file.script_block_text:*systemparametersinfo\\(20,0,*,3\\)*)
<li><a href="#">query: ((powershell.file.script_block_text:*powershell* and powershell.file.script_block_text:*windowstyle* and powershell.file.script_block_text:*hidden*) and (not (powershell.file.script_block_text:*\\:\\\\program\\ files\\\\amazon\\\\workspacesconfig\\\\scripts\\\\* and powershell.file.script_block_text:*$psscriptroot\\\\module\\\\workspacescriptmodule\\\\workspacescriptmodule*)))
<li><a href="#">query: ((powershell.file.script_block_text:*remove\\-item* and powershell.file.script_block_text:*\\-path\\ *) and (not (powershell.file.script_block_text:(*hkcu\\:\\\\* or *hklm\\:\\\\*))))
<li><a href="#">query: ((powershell.file.script_block_text:*set\\-executionpolicy* and powershell.file.script_block_text:(*unrestricted* or *bypass* or *remotesigned*)) and (not (powershell.file.script_block_text:(*\\(new\\-object\\ system.net.webclient\\).downloadstring\\('https\\:\\/\\/community.chocolatey.org\\/install.ps1'\\)* or *\\(new\\-object\\ system.net.webclient\\).downloadstring\\('https\\:\\/\\/chocolatey.org\\/install.ps1'\\)* or *\\\\appdata\\\\roaming\\\\code\\\\*))))
<li><a href="#">query: ((powershell.file.script_block_text:*set\\-psreadlineoption* and powershell.file.script_block_text:*savenothing* and (powershell.file.script_block_text:*–historysavestyle* or powershell.file.script_block_text:*\\-historysavestyle*)) or (powershell.file.script_block_text:(*del* or *remove\\-item* or *rm*) and powershell.file.script_block_text:*\\(get\\-psreadlineoption\\).historysavepath*))
<li><a href="#">query: ((powershell.file.script_block_text:*test\\-netconnection* and powershell.file.script_block_text:*\\-computername\\ * and powershell.file.script_block_text:*\\-port\\ *) and (not (powershell.file.script_block_text:(*\\ 443\\ * or *\\ 80\\ *))))
<li><a href="#">query: ((process.command_line.text:(*\\ \\-executionpolicy\\ * or *\\ \\-ep\\ * or *\\ \\-exec\\ *) and process.command_line.text:(*unrestricted* or *bypass* or *remotesigned*)) and (not (process.command_line.text:(*c\\:\\\\program\\ files* or *c\\:\\\\programdata* or *\\\\appdata\\\\roaming\\\\code\\\\*))))
<li><a href="#">query: ((process.command_line.text:(*\\ \\-s\\ cmd.exe or *\\ \\-s\\ \\-i\\ cmd.exe) or (process.command_line.text:*accepteula* and process.command_line.text:*\\ \\-u\\ * and process.command_line.text:*\\ \\-p\\ * and process.command_line.text:*\\ \\\\\\*)) and (not (process.command_line.text:(*paexec* or *psexec*))))
<li><a href="#">query: ((process.command_line.text:(*\\\\appdata\\\\roaming\\\\* or *\\\\appdata\\\\local\\\\temp\\\\*) and process.command_line.text:*\\\\\\{* and process.command_line.text:*\\}\\\\*) and (not (((process.executable.text:*\\\\\\{* and process.executable.text:*\\}\\\\*)) or ((not _exists_:process.executable.text)) or ((process.executable.text:\"c:\\windows\\system32\\drvinst.exe\")))))
<li><a href="#">query: ((process.command_line.text:(*cmd.exe\\/c* or *\\\\cmd\\/c* or *\\\"cmd\\/c* or *cmd.exe\\/k* or *\\\\cmd\\/k* or *\\\"cmd\\/k*) or process.command_line.text:(*\\/cwhoami* or *\\/cpowershell* or *\\/cschtasks* or *\\/cbitsadmin* or *\\/ccertutil* or *\\/kwhoami* or *\\/kpowershell* or *\\/kschtasks* or *\\/kbitsadmin* or *\\/kcertutil*) or process.command_line.text:(*cmd.exe\\ \\/c* or *cmd\\ \\/c* or *cmd.exe\\ \\/k* or *cmd\\ \\/k*)) and (not ((process.command_line.text:(*cmd.exe\\ \\/c\\ * or *cmd\\ \\/c\\ * or *cmd.exe\\ \\/k\\ * or *cmd\\ \\/k\\ *)) or (process.command_line.text:*appdata\\\\local\\\\programs\\\\microsoft\\ vs\\ code\\\\resources\\\\app\\\\node_modules* or process.command_line.text:*cmd.exe\\/c\\ . or process.command_line.text:\"cmd.exe\\ \\/c\"))))
<li><a href="#">query: ((process.command_line.text:(*wevtutil\\ cl\\ application\\ &\\ fsutil\\ usn\\ deletejournal\\ \\/d\\ c\\:* or *dllhost.dat\\ %windir%\\\\ransoms*)) or ((process.executable.text:*\\\\rundll32.exe and process.command_line.text:(*.dat,#1 or *.dat\\ #1 or *.zip.dll\\\",#1))) or (\"\\perfc.dat\"))
<li><a href="#">query: ((process.command_line.text:(cmd.exe* or c\\:\\\\windows\\\\system32\\\\cmd.exe*) and process.command_line.text:(*psinject* or *spawnas* or *make_token* or *remote\\-exec* or *rev2self* or *dcsync* or *logonpasswords* or *execute\\-assembly* or *getsystem*) and process.executable.text:*\\\\cmd.exe) and (not ((process.parent.executable.text:*\\\\appdata\\\\local\\\\programs\\\\microsoft\\ vs\\ code\\\\code.exe and process.command_line.text:*\\/d\\ \\/s\\ \\/c\\ * and process.command_line.text:*checkfilenameiocs\\ \\-\\-ioc\\-path\\ *))))
<li><a href="#">query: ((process.command_line.text:*\\ ) or (process.executable.text:*\\ ))
<li><a href="#">query: ((process.command_line.text:*\\ \\-\\-remote\\-debugging\\-*) or ((process.executable.text:*\\\\firefox.exe and process.command_line.text:*\\ \\-start\\-debugger\\-server*)))
<li><a href="#">query: ((process.command_line.text:*\\\\\\\\* and process.command_line.text:*$*) and ((((((process.executable.text:(*\\\\robocopy.exe or *\\\\xcopy.exe)) or (winlog.event_data.originalfilename:(\"robocopy.exe\" or \"xcopy.exe\")))) or ((((process.executable.text:*\\\\cmd.exe) or (winlog.event_data.originalfilename:\"cmd.exe\")) and process.command_line.text:*copy*)))) or ((((process.executable.text:(*\\\\powershell.exe* or *\\\\pwsh.exe*)) or (winlog.event_data.originalfilename:(\"powershell.exe\" or \"pwsh.dll\"))) and process.command_line.text:(*copy\\-item* or *copy* or *cpi\\ * or *\\ cp\\ * or *move* or *move\\-item* or *\\ mi\\ * or *\\ mv\\ *)))))
<li><a href="#">query: ((process.command_line.text:*\\\\appdata\\\\roaming\\\\oracle* and process.command_line.text:*\\\\java* and process.command_line.text:*.exe\\ *) or (process.command_line.text:*cscript.exe* and process.command_line.text:*retrive* and process.command_line.text:*.vbs\\ *))
<li><a href="#">query: ((process.command_line.text:*\\\\system\\\\currentcontrolset\\\\services\\\\* and process.command_line.text:*\\\\networkprovider*) and (not (process.command_line.text:(*\\\\system\\\\currentcontrolset\\\\services\\\\webclient\\\\networkprovider* or *\\\\system\\\\currentcontrolset\\\\services\\\\lanmanworkstation\\\\networkprovider* or *\\\\system\\\\currentcontrolset\\\\services\\\\rdpnp\\\\networkprovider*))))
<li><a href="#">query: ((process.command_line.text:*attrib* and process.command_line.text:*\\ \\+h\\ * and process.command_line.text:*\\ \\+s\\ * and process.command_line.text:*\\ \\+r\\ * and process.command_line.text:*.aspx*) or (process.command_line.text:*schtasks* and process.command_line.text:*vsperfmon*) or (process.command_line.text:*vssadmin\\ list\\ shadows* and process.command_line.text:*temp\\\\__output*) or process.command_line.text:*%temp%\\\\execute.bat* or process.executable.text:*users\\\\public\\\\opera\\\\opera_browser.exe or (process.executable.text:*opera_browser.exe and process.parent.executable.text:(*\\\\services.exe or *\\\\svchost.exe)) or process.executable.text:*\\\\programdata\\\\vsperfmon\\\\* or (process.command_line.text:*\\ \\-t7z\\ * and process.command_line.text:*c\\:\\\\programdata\\\\pst* and process.command_line.text:*\\\\it.zip*) or (process.executable.text:*\\\\makecab.exe and process.command_line.text:(*microsoft\\\\exchange\\ server\\\\* or *inetpub\\\\wwwroot*)) or process.command_line.text:(*\\\\temp\\\\xx.bat* or *windows\\\\wwansvcdcs* or *windows\\\\temp\\\\cw.exe*) or (process.command_line.text:*\\\\comsvcs.dll* and process.command_line.text:*minidump* and process.command_line.text:*\\\\inetpub\\\\wwwroot*) or (process.command_line.text:*dsquery* and process.command_line.text:*\\ \\-uco\\ * and process.command_line.text:*\\\\inetpub\\\\wwwroot*))
<li><a href="#">query: ((process.command_line.text:*bash.exe* and process.command_line.text:*\\-c\\ *) and (not ((process.parent.command_line.text:(*c\\:\\\\program\\ files\\\\git\\\\post\\-install.bat* or *c\\:\\\\program\\ files\\ \\(x86\\)\\\\git\\\\post\\-install.bat* or *echo\\ \\/etc\\/post\\-install\\/*.post*) or process.command_line.text:*echo\\ \\/etc\\/post\\-install\\/*.post*))))
<li><a href="#">query: ((process.command_line.text:*execute* and process.command_line.text:*createobject* and process.command_line.text:*regread* and process.command_line.text:*window.close* and process.command_line.text:*\\\\microsoft\\\\windows\\\\currentversion*) and (not (process.command_line.text:*\\\\software\\\\microsoft\\\\windows\\\\currentversion\\\\run*)))
<li><a href="#">query: ((process.command_line.text:*invoke\\-wmimethod\\ win32_process\\ \\-name\\ create\\ \\-argumentlist* and process.command_line.text:*rundll32\\ c\\:\\\\windows*) or (process.command_line.text:*wmic\\ \\/node\\:* and process.command_line.text:*process\\ call\\ create\\ \\\"rundll32\\ c\\:\\\\windows*))
<li><a href="#">query: ((process.command_line.text:*mshta* and process.command_line.text:*.zip*) or (process.parent.executable.text:\"c\\:\\\\windows\\\\system32\\\\wbem\\\\wmiprvse.exe\" and process.executable.text:\"c\\:\\\\windows\\\\system32\\\\mshta.exe\") or (process.parent.executable.text:*\\:\\\\users\\\\public\\\\* and process.executable.text:\"c\\:\\\\windows\\\\system32\\\\rundll32.exe\"))
<li><a href="#">query: ((process.command_line.text:*taskkill\\ * and process.command_line.text:*raccinesettings.exe*) or (process.command_line.text:*reg.exe* and process.command_line.text:*delete* and process.command_line.text:*raccine\\ tray*) or (process.command_line.text:*schtasks* and process.command_line.text:*\\/delete* and process.command_line.text:*raccine\\ rules\\ updater*))
<li><a href="#">query: ((process.command_line:(*\\ \\-s\\ cmd.exe or *\\ \\-s\\ \\-i\\ cmd.exe) or (process.command_line:*accepteula* and process.command_line:*\\ \\-u\\ * and process.command_line:*\\ \\-p\\ * and process.command_line:*\\ \\\\\\*)) and (not (process.command_line:(*paexec* or *psexec*))))
<li><a href="#">query: ((process.command_line:(*add\\-mppreference\\ * or *set\\-mppreference\\ *) and process.command_line:(*\\ \\-exclusionpath\\ * or *\\ \\-exclusionextension\\ * or *\\ \\-exclusionprocess\\ *)) or process.command_line:(*qwrklu1wuhjlzmvyzw5jz* or *fkzc1ncfbyzwzlcmvuy2* or *bzgqttxbqcmvmzxjlbmnl*))
<li><a href="#">query: ((process.command_line:(*add\\-mppreference\\ * or *set\\-mppreference\\ *) and process.command_line:(*disablerealtimemonitoring\\ * or *disableioavprotection\\ * or *disablebehaviormonitoring\\ * or *disableblockatfirstseen\\ *) and process.command_line:(*$true* or *\\ 1\\ *)) or (process.command_line:(*rglzywjszvjlywx0aw1ltw9uaxrvcmluzy* or *rpc2fibgvszwfsdgltzu1vbml0b3jpbmcg* or *eaxnhymxlumvhbhrpbwvnb25pdg9yaw5ni* or *rglzywjszulpqvzqcm90zwn0aw9ui* or *rpc2fibgvjt0fwuhjvdgvjdglvbi* or *eaxnhymxlsu9bvlbyb3rly3rpb24g* or *rglzywjszujlagf2aw9ytw9uaxrvcmluzy* or *rpc2fibgvczwhhdmlvck1vbml0b3jpbmcg* or *eaxnhymxlqmvoyxzpb3jnb25pdg9yaw5ni* or *rglzywjszujsb2nrqxrgaxjzdfnlzw4g* or *rpc2fibgvcbg9ja0f0rmlyc3rtzwvui* or *eaxnhymxlqmxvy2tbdezpcnn0u2vlbi* or *zglzywjszxjlywx0aw1lbw9uaxrvcmluzy* or *rpc2fibgvyzwfsdgltzw1vbml0b3jpbmcg* or *kaxnhymxlcmvhbhrpbwvtb25pdg9yaw5ni* or *zglzywjszwlvyxzwcm90zwn0aw9ui* or *rpc2fibgvpb2f2chjvdgvjdglvbi* or *kaxnhymxlaw9hdnbyb3rly3rpb24g* or *zglzywjszwjlagf2aw9ybw9uaxrvcmluzy* or *rpc2fibgvizwhhdmlvcm1vbml0b3jpbmcg* or *kaxnhymxlymvoyxzpb3jtb25pdg9yaw5ni* or *zglzywjszwjsb2nryxrmaxjzdhnlzw4g* or *rpc2fibgvibg9ja2f0zmlyc3rzzwvui* or *kaxnhymxlymxvy2thdgzpcnn0c2vlbi*) and process.command_line:(*rabpahmayqbiagwazqbsaguayqbsahqaaqbtaguatqbvag4aaqb0ag8acgbpag4azwaga* or *qaaqbzageaygbsaguaugblageabab0agkabqblae0abwbuagkadabvahiaaqbuagcaia* or *eagkacwbhagiabablafiazqbhagwadabpag0azqbnag8abgbpahqabwbyagkabgbnacaa* or *rabpahmayqbiagwazqbjae8aqqbwafaacgbvahqazqbjahqaaqbvag4aia* or *qaaqbzageaygbsaguasqbpaeeavgbqahiabwb0aguaywb0agkabwbuacaa* or *eagkacwbhagiabablaekatwbbafyauabyag8adablagmadabpag8abgaga* or *rabpahmayqbiagwazqbcaguaaabhahyaaqbvahiatqbvag4aaqb0ag8acgbpag4azwaga* or *qaaqbzageaygbsaguaqgblaggayqb2agkabwbyae0abwbuagkadabvahiaaqbuagcaia* or *eagkacwbhagiabablaeiazqboageadgbpag8acgbnag8abgbpahqabwbyagkabgbnacaa* or *rabpahmayqbiagwazqbcagwabwbjagsaqqb0aeyaaqbyahmadabtaguazqbuacaa* or *qaaqbzageaygbsaguaqgbsag8aywbraeeadabgagkacgbzahqauwblaguabgaga* or *eagkacwbhagiabablaeiababvagmaawbbahqargbpahiacwb0afmazqblag4aia* or *zabpahmayqbiagwazqbyaguayqbsahqaaqbtaguabqbvag4aaqb0ag8acgbpag4azwaga* or *qaaqbzageaygbsaguacgblageabab0agkabqblag0abwbuagkadabvahiaaqbuagcaia* or *kagkacwbhagiabablahiazqbhagwadabpag0azqbtag8abgbpahqabwbyagkabgbnacaa* or *zabpahmayqbiagwazqbpag8ayqb2ahaacgbvahqazqbjahqaaqbvag4aia* or *qaaqbzageaygbsaguaaqbvageadgbwahiabwb0aguaywb0agkabwbuacaa* or *kagkacwbhagiabablagkabwbhahyacabyag8adablagmadabpag8abgaga* or *zabpahmayqbiagwazqbiaguaaabhahyaaqbvahiabqbvag4aaqb0ag8acgbpag4azwaga* or *qaaqbzageaygbsaguaygblaggayqb2agkabwbyag0abwbuagkadabvahiaaqbuagcaia* or *kagkacwbhagiabablagiazqboageadgbpag8acgbtag8abgbpahqabwbyagkabgbnacaa* or *zabpahmayqbiagwazqbiagwabwbjagsayqb0agyaaqbyahmadabzaguazqbuacaa* or *qaaqbzageaygbsaguaygbsag8aywbrageadabmagkacgbzahqacwblaguabgaga* or *kagkacwbhagiabablagiababvagmaawbhahqazgbpahiacwb0ahmazqblag4aia*)))
<li><a href="#">query: ((process.command_line:(*comsvcs.dll* or *rundll32* or *.dmp*) and process.command_line:(*#24* or *#\\+24* or *minidump*) and process.command_line:*\\ full*) or process.command_line:*#\\-4294967272*)
<li><a href="#">query: ((process.command_line:(*powershell* or *pwsh*) or winlog.event_data.description:\"windows\\ powershell\" or product:\"powershell\\ core\\ 6\") and process.command_line:/.{1000,}/)
<li><a href="#">query: ((process.command_line:*.cpl and (not (process.command_line:(*\\\\system32\\\\* or *%system%*)))) or (process.executable:*\\\\reg.exe and process.command_line:*add* and process.command_line:*currentversion\\\\control\\ panel\\\\cpls*))
<li><a href="#">query: ((process.command_line:*\\ \\/injectrunning* and process.command_line:*.dll*) and (winlog.event_data.originalfilename:(\"mavinject32.exe\" or \"mavinject64.exe\") or process.executable:(*\\\\mavinject32.exe or *\\\\mavinject64.exe)))
<li><a href="#">query: ((process.command_line:*\\ \\/lockscreenurl\\:* and (not (process.command_line:(*.jpg* or *.jpeg* or *.png*)))) or (process.command_line:*reg\\ delete* and process.command_line:*\\\\personalizationcsp*))
<li><a href="#">query: ((process.command_line:*\\ \\-m\\ pe_inject\\ * or (process.command_line:*\\ \\-\\-local\\-auth* and process.command_line:*\\ \\-u\\ * and process.command_line:*\\ \\-x\\ *) or (process.command_line:*\\ \\-\\-local\\-auth* and process.command_line:*\\ \\-u\\ * and process.command_line:*\\ \\-p\\ * and process.command_line:*\\ \\-h\\ 'nthash'*) or (process.command_line:*\\ mssql\\ * and process.command_line:*\\ \\-u\\ * and process.command_line:*\\ \\-p\\ * and process.command_line:*\\ \\-m\\ * and process.command_line:*\\ \\-d\\ *) or (process.command_line:*\\ smb\\ * and process.command_line:*\\ \\-u\\ * and process.command_line:*\\ \\-h\\ * and process.command_line:*\\ \\-m\\ * and process.command_line:*\\ \\-o\\ *) or (process.command_line:*\\ smb\\ * and process.command_line:*\\ \\-u\\ * and process.command_line:*\\ \\-p\\ * and process.command_line:*\\ \\-\\-local\\-auth*)) or (process.command_line:*\\ \\-\\-local\\-auth* and process.command_line:*\\ \\-u\\ * and process.command_line:*\\ \\-p\\ * and process.command_line:*\\ 10.* and process.command_line:*\\ 192.168.* and process.command_line:*\\/24\\ *))
<li><a href="#">query: ((process.command_line:*\\ \\-name\\ ieharden\\ * and process.command_line:*\\ \\-value\\ 0\\ *) or (process.command_line:*\\ \\-name\\ depoff\\ * and process.command_line:*\\ \\-value\\ 1\\ *) or (process.command_line:*\\ \\-name\\ disablefirstruncustomize\\ * and process.command_line:*\\ \\-value\\ 2\\ *))
<li><a href="#">query: ((process.command_line:*\\/updatedeploymentprovider* and process.command_line:*\\/runhandlercomserver* and process.command_line:*.dll* and process.executable:*\\\\wuauclt.exe) and (not (process.command_line:(*\\ \\/classid\\ * or *\\ wuaueng.dll\\ *))))
<li><a href="#">query: ((process.command_line:*\\\\appdata\\\\local\\\\* and (process.command_line:*\\\\regsvr32* or process.command_line:*,dllentry*)) and (not ((process.command_line:*appdata\\\\local\\\\microsoft\\\\teamsmeetingaddin\\\\* or process.command_line:(*\\\\x86\\\\microsoft.teams.addinloader.dll or *\\\\x86\\\\microsoft.teams.addinloader.dll\\\" or *\\\\x64\\\\microsoft.teams.addinloader.dll or *\\\\x64\\\\microsoft.teams.addinloader.dll\\\")) or (process.command_line:*\\\\appdata\\\\local\\\\webex\\\\webex64\\\\meetings\\\\atucfobj.dll))))
<li><a href="#">query: ((process.command_line:*\\\\appdata\\\\local\\\\* and (process.command_line:*\\\\regsvr32* or process.command_line:*,dllentry*)) and (not ((process.command_line:*appdata\\\\local\\\\microsoft\\\\teamsmeetingaddin\\\\* or process.command_line:*\\\\x86\\\\microsoft.teams.addinloader.dll))))
<li><a href="#">query: ((process.command_line:*\\\\appdata\\\\local\\\\temp\\\\* and process.command_line:*\\\\.\\\\pipe\\\\\\*) or (process.executable:*\\\\rundll32.exe and process.command_line:(*.dat,#1 or *.dat\\ #1)) or \"\\\\perfc.dat\")
<li><a href="#">query: ((process.command_line:*\\\\appdata\\\\roaming\\\\oracle* and process.command_line:*\\\\java* and process.command_line:*.exe\\ *) or (process.command_line:*cscript.exe* and process.command_line:*retrive* and process.command_line:*.vbs\\ *))
<li><a href="#">query: ((process.command_line:*\\\\cmd.exe\\ \\/c\\ whoami* and process.parent.executable:c\\:\\\\temp*) or (process.command_line:*conhost.exe\\ 0xffffffff\\ \\-forcev1* and process.parent.command_line:(*\\/c\\ whoami* or *cmd.exe\\ \\/c\\ echo* or *\\ >\\ \\\\.\\\\pipe*)) or (process.command_line:(*cmd.exe\\ \\/c\\ echo* or *>\\ \\\\.\\\\pipe* or *\\\\whoami.exe*) and process.parent.executable:*\\\\dllhost.exe) or (process.executable:*\\\\cmd.exe and process.parent.executable:*\\\\runonce.exe and process.parent.command_line:*\\\\runonce.exe))
<li><a href="#">query: ((process.command_line:*\\-\\-config\\ * and process.command_line:*\\-\\-no\\-check\\-certificate\\ * and process.command_line:*\\ copy\\ *) or (process.command_line:(*pass* or *user* or *copy* or *sync* or *config* or *lsd* or *remote* or *ls* or *mega* or *pcloud* or *ftp* or *ignore\\-existing* or *auto\\-confirm* or *transfers* or *multi\\-thread\\-streams* or *no\\-check\\-certificate\\ *) and (winlog.event_data.description:\"rsync\\ for\\ cloud\\ storage\" or (process.executable:*\\\\rclone.exe and process.parent.executable:(*\\\\powershell.exe or *\\\\cmd.exe)))))
<li><a href="#">query: ((process.command_line:*\\-\\-config\\ * and process.command_line:*\\-\\-no\\-check\\-certificate\\ * and process.command_line:*\\ copy\\ *) or (process.command_line:(*pass* or *user* or *copy* or *sync* or *config* or *lsd* or *remote* or *ls* or *mega* or *pcloud* or *ftp* or *ignore\\-existing* or *auto\\-confirm* or *transfers* or *multi\\-thread\\-streams* or *no\\-check\\-certificate\\ *) and (winlog.event_data.description:\"rsync\\ for\\ cloud\\ storage\" or (process.executable:*\\\\rclone.exe and process.parent.executable:(*\\\\powershell.exe or *\\\\pwsh.exe or *\\\\cmd.exe)))))
<li><a href="#">query: ((process.command_line:*\\\\rundll32.exe and (not (process.parent.executable:*\\\\svchost.exe))) and (not (process.parent.executable:(*\\\\appdata\\\\local\\\\* or *\\\\microsoft\\\\edge\\\\*))))
<li><a href="#">query: ((process.command_line:*\\\\service.exe* and process.command_line:(*i or *u)) or (process.command_line:*\\\\microsoft\\\\taskbar\\\\autoit3.exe or process.command_line:c\\:\\\\wsc.exe*) or (process.executable:*\\\\windows\\\\temp\\\\db\\\\* and process.executable:*.exe) or (process.command_line:*\\\\nslookup.exe* and process.command_line:*\\-q\\=txt* and process.parent.executable:*\\\\autoit*))
<li><a href="#">query: ((process.command_line:*\\-s\\:* and (process.executable:*ftp.exe or winlog.event_data.originalfilename:*ftp.exe*)) or (winlog.event_data.originalfilename:*ftp.exe* and (not (process.executable:*ftp.exe))) or process.parent.executable:*ftp.exe)
<li><a href="#">query: ((process.command_line:*\\-s\\:* and (process.executable:*ftp.exe or winlog.event_data.originalfilename:\"ftp.exe\")) or (winlog.event_data.originalfilename:\"ftp.exe\" and (not (process.executable:*ftp.exe))) or process.parent.executable:*ftp.exe)
<li><a href="#">query: ((process.command_line:*\\-sta* and process.command_line:*\\-nop* and process.command_line:*\\-window* and process.command_line:*hidden* and process.command_line:(*\\-command* or *\\-encodedcommand*)) or process.command_line:(*sv\\ o\\ \\(new\\-object\\ io.memorysteam\\);sv\\ d\\ * or *mshta\\ file.hta* or *grunthttp* or *\\-encodedcommand\\ cwb2acaabwaga*))
<li><a href="#">query: ((process.command_line:*add\\-printerport\\ \\-name* and process.command_line:(*.exe* or *.dll* or *.bat*)) or process.command_line:*generic\\ \\/\\ text\\ only*)
<li><a href="#">query: ((process.command_line:*attrib* and process.command_line:*\\ \\+h\\ * and process.command_line:*\\ \\+s\\ * and process.command_line:*\\ \\+r\\ * and process.command_line:*.aspx*) or (process.command_line:*schtasks* and process.command_line:*vsperfmon*) or (process.command_line:*vssadmin\\ list\\ shadows* and process.command_line:*temp\\\\__output*) or process.command_line:*%temp%\\\\execute.bat* or process.executable:*users\\\\public\\\\opera\\\\opera_browser.exe or (process.executable:*opera_browser.exe and process.parent.executable:(*\\\\services.exe or *\\\\svchost.exe)) or process.executable:*\\\\programdata\\\\vsperfmon\\\\* or (process.command_line:*\\ \\-t7z\\ * and process.command_line:*c\\:\\\\programdata\\\\pst* and process.command_line:*\\\\it.zip*) or (process.executable:*\\\\makecab.exe and process.command_line:(*microsoft\\\\exchange\\ server\\\\* or *inetpub\\\\wwwroot*)) or process.command_line:(*\\\\temp\\\\xx.bat* or *windows\\\\wwansvcdcs* or *windows\\\\temp\\\\cw.exe*) or (process.command_line:*\\\\comsvcs.dll* and process.command_line:*minidump* and process.command_line:*\\\\inetpub\\\\wwwroot*) or (process.command_line:*dsquery* and process.command_line:*\\ \\-uco\\ * and process.command_line:*\\\\inetpub\\\\wwwroot*))
<li><a href="#">query: ((process.command_line:*bitsadmin* and process.command_line:*\\/transfer* and process.command_line:*csidl_appdata*) or process.command_line:*csidl_system_drive* or process.command_line:(*\\\\msf.ps1* or *8989\\ \\-e\\ cmd.exe* or *system.data.sqlclient.sqldataadapter\\($cmd\\);\\ \\[void\\]$da.fill* or *\\-nop\\ \\-w\\ hidden\\ \\-c\\ $k\\=new\\-object* or *\\[net.credentialcache\\]\\:\\:defaultcredentials;iex\\ * or *\\ \\-nop\\ \\-w\\ hidden\\ \\-c\\ $m\\=new\\-object\\ net.webclient;$m* or *\\-noninteractive\\ \\-executionpolicy\\ bypass\\ whoami* or *\\-noninteractive\\ \\-executionpolicy\\ bypass\\ netstat\\ \\-a* or *l3nlcnzlcj1*) or process.executable:(*\\\\adobe\\\\adobe.exe or *\\\\oracle\\\\local.exe or *\\\\revshell.exe or *infopagesbackup\\\\ncat.exe or *csidl_system\\\\cmd.exe or *\\\\programdata\\\\oracle\\\\java.exe or *csidl_common_appdata\\\\comms\\\\comms.exe or *\\\\programdata\\\\vmware\\\\vmware.exe))
<li><a href="#">query: ((process.command_line:*cl* and process.command_line:*\\/trace*) or (process.command_line:*clear\\-log* and process.command_line:*\\/trace*) or (process.command_line:*sl* and process.command_line:*\\/e\\:false*) or (process.command_line:*set\\-log* and process.command_line:*\\/e\\:false*) or (process.command_line:*logman* and process.command_line:*update* and process.command_line:*trace* and process.command_line:*\\-\\-p* and process.command_line:*\\-ets*) or process.command_line:*remove\\-etwtraceprovider* or (process.command_line:*set\\-etwtraceprovider* and process.command_line:*0x11*))
<li><a href="#">query: ((process.command_line:*cl* and process.command_line:*\\/trace*) or (process.command_line:*clear\\-log* and process.command_line:*\\/trace*) or (process.command_line:*sl* and process.command_line:*\\/e\\:false*) or (process.command_line:*set\\-log* and process.command_line:*\\/e\\:false*) or (process.command_line:*remove\\-etwtraceprovider* and process.command_line:*eventlog\\-microsoft\\-windows\\-wmi\\-activity\\-trace* and process.command_line:*\\{1418ef04\\-b0b4\\-4623\\-bf7e\\-d74ab47bbdaa\\}*) or (process.command_line:*set\\-etwtraceprovider* and process.command_line:*\\{1418ef04\\-b0b4\\-4623\\-bf7e\\-d74ab47bbdaa\\}* and process.command_line:*eventlog\\-microsoft\\-windows\\-wmi\\-activity\\-trace* and process.command_line:*0x11*) or (process.command_line:*logman* and process.command_line:*update* and process.command_line:*trace* and process.command_line:*\\-\\-p* and process.command_line:*\\-ets*))
<li><a href="#">query: ((process.command_line:*cmd* and process.command_line:*\\ \\/c\\ * and process.command_line:*assoc\\ * and process.command_line:*exefile*) and (not (process.command_line:*.exe\\=exefile*)))
<li><a href="#">query: ((process.command_line:*cmd.exe\\ \\/c\\ * and process.command_line:*\\ \\-p\\ 0x* and process.command_line:(*c\\:\\\\programdata\\\\* or *c\\:\\\\recycler\\\\*)) or (process.command_line:*rundll32.exe\\ * and process.command_line:*c\\:\\\\programdata\\\\* and process.command_line:(*.bin,* or *.tmp,* or *.dat,* or *.io,* or *.ini,* or *.db,*)))
<li><a href="#">query: ((process.command_line:*cmd.exe\\ \\/c\\ * and process.command_line:*tasklist\\ \\/fi\\ * and process.command_line:*imagename\\ eq\\ lsass.exe* and user.name:(*nt\\ autho* or *nt\\ auto*)) or (process.command_line:*do\\ rundll32.exe\\ c\\:\\\\windows\\\\system32\\\\comsvcs.dll,\\ minidump* and process.command_line:*\\\\windows\\\\temp\\\\* and process.command_line:*\\ full* and process.command_line:*%%b*) or (process.command_line:*tasklist\\ \\/v\\ \\/fo\\ csv* and process.command_line:*findstr\\ \\/i\\ \\\"lsass\\\"*))
<li><a href="#">query: ((process.command_line:*del\\ * and process.command_line:*\\/f*) or (process.command_line:*rmdir* and process.command_line:*\\/s* and process.command_line:*\\/q*))
<li><a href="#">query: ((process.command_line:*del\\ *.exe* and process.command_line:*\\/f\\ * and process.command_line:*\\/q\\ *) or (process.command_line:*del\\ *.dll* and process.command_line:*c\\:\\\\programdata\\\\*))
<li><a href="#">query: ((process.command_line:*execute* and process.command_line:*createobject* and process.command_line:*regread* and process.command_line:*window.close* and process.command_line:*\\\\microsoft\\\\windows\\\\currentversion*) and (not (process.command_line:*\\\\software\\\\microsoft\\\\windows\\\\currentversion\\\\run*)))
<li><a href="#">query: ((process.command_line:*extrac32.exe* or process.executable:*\\\\extrac32.exe or winlog.event_data.originalfilename:\"extrac32.exe\") and process.command_line:*.cab* and process.command_line:(*\\/c* or *\\/y* or *\\ \\\\\\*))
<li><a href="#">query: ((process.command_line:*invoke\\-wmimethod\\ win32_process\\ \\-name\\ create\\ \\-argumentlist* and process.command_line:*rundll32\\ c\\:\\\\windows*) or (process.command_line:*wmic\\ \\/node\\:* and process.command_line:*process\\ call\\ create\\ \\\"rundll32\\ c\\:\\\\windows*))
<li><a href="#">query: ((process.command_line:*javascript\\:* and process.command_line:*.registerxll*) or (process.command_line:*url.dll* and process.command_line:*openurl*) or (process.command_line:*url.dll* and process.command_line:*openurla*) or (process.command_line:*url.dll* and process.command_line:*fileprotocolhandler*) or (process.command_line:*zipfldr.dll* and process.command_line:*routethecall*) or (process.command_line:*shell32.dll* and process.command_line:*control_rundll*) or (process.command_line:*shell32.dll* and process.command_line:*shellexec_rundll*) or (process.command_line:*mshtml.dll* and process.command_line:*printhtml*) or (process.command_line:*advpack.dll* and process.command_line:*launchinfsection*) or (process.command_line:*advpack.dll* and process.command_line:*registerocx*) or (process.command_line:*ieadvpack.dll* and process.command_line:*launchinfsection*) or (process.command_line:*ieadvpack.dll* and process.command_line:*registerocx*) or (process.command_line:*ieframe.dll* and process.command_line:*openurl*) or (process.command_line:*shdocvw.dll* and process.command_line:*openurl*) or (process.command_line:*syssetup.dll* and process.command_line:*setupinfobjectinstallaction*) or (process.command_line:*setupapi.dll* and process.command_line:*installhinfsection*) or (process.command_line:*pcwutl.dll* and process.command_line:*launchapplication*) or (process.command_line:*dfshim.dll* and process.command_line:*shopenverbapplication*))
<li><a href="#">query: ((process.command_line:*localgroup* and process.command_line:*admin* and process.command_line:*\\/add*) or process.command_line:*\\\\win64.exe*)
<li><a href="#">query: ((process.command_line:*microsoft.nodejstools.pressanykey.exe\\ normal\\ * or (process.command_line:*.exe\\ normal\\ * and process.command_line:*.exe)) and (not ((process.executable:*\\\\microsoft\\\\nodejstools\\\\nodejstools*))))
<li><a href="#">query: ((process.command_line:*mpcmdrun.exe* or winlog.event_data.description:\"microsoft\\ malware\\ protection\\ command\\ line\\ utility\") and (process.command_line:*downloadfile* and process.command_line:*url*))
<li><a href="#">query: ((process.command_line:*mshta* and process.command_line:*.zip*) or (process.parent.executable:\"c\\:\\\\windows\\\\system32\\\\wbem\\\\wmiprvse.exe\" and process.executable:\"c\\:\\\\windows\\\\system32\\\\mshta.exe\") or (process.parent.executable:*\\:\\\\users\\\\public\\\\* and process.executable:\"c\\:\\\\windows\\\\system32\\\\rundll32.exe\"))
<li><a href="#">query: ((process.command_line:*reg* and process.command_line:*add*) and ((process.command_line:*\\ \\/d\\ 4* and process.command_line:*\\ \\/v\\ start* and process.command_line:(*\\\\sense* or *\\\\windefend* or *\\\\msmpsvc* or *\\\\nissrv* or *\\\\wdboot* or *\\\\wdnisdrv* or *\\\\wdnissvc* or *\\\\wscsvc* or *\\\\securityhealthservice* or *\\\\wuauserv* or *\\\\usosvc* or *\\\\wdfilter* or *\\\\appidsvc*)) or (process.command_line:*\\ \\/d\\ 1* and process.command_line:*windows\\ defender* and process.command_line:(*disableioavprotection* or *disableonaccessprotection* or *disableroutinelytakingaction* or *disablescanonrealtimeenable* or *disableblockatfirstseen* or *disablebehaviormonitoring* or *disableenhancednotifications* or *disableantispyware* or *disableantispywarerealtimeprotection* or *disableconfig* or *disableprivacymode* or *signaturedisableupdateonstartupwithoutengine* or *disablearchivescanning* or *disableintrusionpreventionsystem* or *disablescriptscanning*))))
<li><a href="#">query: ((process.command_line:*rundll32* and process.command_line:*javascript* and process.command_line:*..\\\\..\\\\mshtml,runhtmlapplication*) or process.command_line:*;document.write\\(\\);getobject\\(\\\"script*)
<li><a href="#">query: ((process.command_line:*rundll32.exe* and process.command_line:*%appdata%\\\\*) and (process.command_line:*.dat\\\",* or process.command_line:(*.dll\\\",#1 or *.dll\\ #1 or *.dll\\\"\\ #1)))
<li><a href="#">query: ((process.command_line:*sc\\ * and process.command_line:*config\\ * and process.command_line:*binpath\\=*) or (process.command_line:*sc\\ * and process.command_line:*failure* and process.command_line:*command\\=*) or (process.command_line:*reg\\ * and process.command_line:*add\\ * and process.command_line:*failurecommand* and process.command_line:(*.sh* or *.exe* or *.dll* or *.bin$* or *.bat* or *.cmd* or *.js* or *.msh$* or *.reg$* or *.scr* or *.ps* or *.vb* or *.jar* or *.pl*)) or (process.command_line:*reg\\ * and process.command_line:*add\\ * and process.command_line:*imagepath* and process.command_line:(*.sh* or *.exe* or *.dll* or *.bin$* or *.bat* or *.cmd* or *.js* or *.msh$* or *.reg$* or *.scr* or *.ps* or *.vb* or *.jar* or *.pl*)))
<li><a href="#">query: ((process.command_line:*svchost.exe and process.executable:*\\\\svchost.exe) and (not (process.parent.executable:(*\\\\rpcnet.exe or *\\\\rpcnetp.exe) or not _exists_:process.command_line)))
<li><a href="#">query: ((process.command_line:*taskkill\\ * and process.command_line:*raccinesettings.exe*) or (process.command_line:*reg.exe* and process.command_line:*delete* and process.command_line:*raccine\\ tray*) or (process.command_line:*schtasks* and process.command_line:*\\/delete* and process.command_line:*raccine\\ rules\\ updater*))
<li><a href="#">query: ((process.command_line:*whoami* and process.command_line:(*.\\/client\\/common\\/* or *.\\\\client\\\\common\\\\*)) or process.command_line:*c\\:\\\\windows\\\\temp\\\\serv\\-u.bat*)
<li><a href="#">query: ((process.command_line:*wuauclt.exe* and process.command_line:*\\/updatedeploymentprovider* and process.command_line:*\\/runhandlercomserver*) and (not (process.command_line:(*wuaueng.dll* or *updatedeploymentprovider.dll\\ \\/classid*))))
<li><a href="#">query: ((process.executable.text:(*\\/nc or *\\/netcat) and (not (process.command_line.text:*l*))) or process.executable.text:(*\\/telnet or *\\/nmap))
<li><a href="#">query: ((process.executable.text:(*\\/netstat or *\\/ifconfig or *\\/socketfilterfw or *\\/networksetup or *\\/arp)) or ((process.executable.text:\"/usr/bin/defaults\" and process.command_line.text:*read* and process.command_line.text:*\\/library\\/preferences\\/com.apple.alf*)))
<li><a href="#">query: ((process.executable.text:(*\\\\cmd.exe or *\\\\powershell.exe or *\\\\pwsh.exe) or winlog.event_data.originalfilename:(\"cmd.exe\" or \"powershell.exe\" or \"pwsh.dll\")) and (process.parent.executable.text:*\\\\windows\\\\installer\\\\* and process.parent.executable.text:*msi* and process.parent.executable.text:*tmp))
<li><a href="#">query: ((process.executable.text:(*\\\\htran.exe or *\\\\lcx.exe)) or (process.command_line.text:(*.exe\\ \\-tran\\ * or *.exe\\ \\-slave\\ *)))
<li><a href="#">query: ((process.executable.text:(*\\\\mpcmdrun.exe or *\\\\nissrv.exe) and dll.path:*\\\\mpclient.dll) and (not (dll.path:(c\\:\\\\program\\ files\\\\windows\\ defender\\\\* or c\\:\\\\programdata\\\\microsoft\\\\windows\\ defender\\\\platform\\\\*))))
<li><a href="#">query: ((process.executable.text:(*\\\\nc.exe or *\\\\ncat.exe or *\\\\netcat.exe)) or (process.command_line.text:(*\\ \\-lvp\\ * or *\\ \\-lvnp* or *\\ \\-l\\ \\-v\\ \\-p\\ * or *\\ \\-lv\\ \\-p\\ * or *\\ \\-l\\ \\-\\-proxy\\-type\\ http\\ * or *\\ \\-vnl\\ \\-\\-exec\\ * or *\\ \\-vnl\\ \\-e\\ * or *\\ \\-\\-lua\\-exec\\ * or *\\ \\-\\-sh\\-exec\\ *)))
<li><a href="#">query: ((process.executable.text:(*\\\\net.exe or *\\\\net1.exe) and process.command_line.text:*\\ user\\ * and process.command_line.text:(*\\ järjestelmänvalvoja\\ * or *\\ rendszergazda\\ * or *\\ администратор\\ * or *\\ administrateur\\ * or *\\ administrador\\ * or *\\ administratör\\ * or *\\ administrator\\ * or *\\ guest\\ * or *\\ defaultaccount\\ * or *\\ \\\"järjestelmänvalvoja\\\"\\ * or *\\ \\\"rendszergazda\\\"\\ * or *\\ \\\"администратор\\\"\\ * or *\\ \\\"administrateur\\\"\\ * or *\\ \\\"administrador\\\"\\ * or *\\ \\\"administratör\\\"\\ * or *\\ \\\"administrator\\\"\\ * or *\\ \\\"guest\\\"\\ * or *\\ \\\"defaultaccount\\\"\\ * or *\\ 'järjestelmänvalvoja'\\ * or *\\ 'rendszergazda'\\ * or *\\ 'администратор'\\ * or *\\ 'administrateur'\\ * or *\\ 'administrador'\\ * or *\\ 'administratör'\\ * or *\\ 'administrator'\\ * or *\\ 'guest'\\ * or *\\ 'defaultaccount'\\ *)) and (not (process.command_line.text:*guest* and process.command_line.text:*\\/active\\ no*)))
<li><a href="#">query: ((process.executable.text:(*\\\\net.exe or *\\\\net1.exe) or winlog.event_data.originalfilename:(\"net.exe\" or \"net1.exe\")) and ((process.command_line.text:(*\\ group\\ * or *\\ localgroup\\ *) and process.command_line.text:(*domain\\ admins* or *\\ administrator* or *\\ administrateur* or *enterprise\\ admins* or *exchange\\ trusted\\ subsystem* or *remote\\ desktop\\ users* or *utilisateurs\\ du\\ bureau\\ à\\ distance* or *usuarios\\ de\\ escritorio\\ remoto* or *\\ \\/do*)) or (process.command_line.text:*\\ accounts\\ * and process.command_line.text:*\\ \\/do*)))
<li><a href="#">query: ((process.executable.text:(*\\\\pchunter64.exe or *\\\\pchunter32.exe)) or (winlog.event_data.originalfilename:\"pchunter.exe\") or (winlog.event_data.description:\"epoolsoft windows information view tools\") or (winlog.event_data.hashes:(*sha1\\=5f1cbc3d99558307bc1250d084fa968521482025* or *md5\\=987b65cd9b9f4e9a1afd8f8b48cf64a7* or *sha256\\=2b214bddaab130c274de6204af6dba5aeec7433da99aa950022fa306421a6d32* or *imphash\\=444d210cea1ff8112f256a4997eed7ff* or *sha1\\=3fb89787cb97d902780da080545584d97fb1c2eb* or *md5\\=228dd0c2e6287547e26ffbd973a40f14* or *sha256\\=55f041bf4e78e9bfa6d4ee68be40e496ce3a1353e1ca4306598589e19802522c* or *imphash\\=0479f44df47cfa2ef1ccc4416a538663*)) or (md5:(\"228dd0c2e6287547e26ffbd973a40f14\" or \"987b65cd9b9f4e9a1afd8f8b48cf64a7\")) or (sha1:(\"5f1cbc3d99558307bc1250d084fa968521482025\" or \"3fb89787cb97d902780da080545584d97fb1c2eb\")) or (sha256:(\"2b214bddaab130c274de6204af6dba5aeec7433da99aa950022fa306421a6d32\" or \"55f041bf4e78e9bfa6d4ee68be40e496ce3a1353e1ca4306598589e19802522c\")) or (winlog.event_data.imphash:(\"444d210cea1ff8112f256a4997eed7ff\" or \"0479f44df47cfa2ef1ccc4416a538663\")))
<li><a href="#">query: ((process.executable.text:(*\\\\powershell.exe or *\\\\pwsh.exe or *\\\\mshta.exe or *\\\\wscript.exe or *\\\\cscript.exe) and process.command_line.text:(*\\\\windows\\\\temp* or *\\\\temporary\\ internet* or *\\\\appdata\\\\local\\\\temp* or *\\\\appdata\\\\roaming\\\\temp* or *%temp%* or *%tmp%* or *%localappdata%\\\\temp*)) and (not (process.command_line.text:(*\\ >* or *out\\-file* or *convertto\\-json* or *\\-windowstyle\\ hidden\\ \\-verb\\ runas* or *\\\\windows\\\\system32\\\\config\\\\systemprofile\\\\appdata\\\\local\\\\temp\\\\amazon\\\\ec2\\-windows\\\\*))))
<li><a href="#">query: ((process.executable.text:(*\\\\powershell.exe or *\\\\pwsh.exe or *\\\\wmic.exe or *\\\\vssadmin.exe) or winlog.event_data.originalfilename:(\"powershell.exe\" or \"pwsh.dll\" or \"wmic.exe\" or \"vssadmin.exe\")) and (process.command_line.text:*shadow* and process.command_line.text:*create*))
<li><a href="#">query: ((process.executable.text:(*\\\\powershell.exe or *\\\\pwsh.exe) and process.command_line.text:(*\\ \\-e\\ * or *\\ \\-en\\ * or *\\ \\-enc\\ * or *\\ \\-enco* or *\\ \\-ec\\ *)) and (not (((process.command_line.text:*\\ \\-encoding\\ *)) or ((process.parent.executable.text:(*c\\:\\\\packages\\\\plugins\\\\microsoft.guestconfiguration.configurationforwindows\\\\* or *\\\\gc_worker.exe*))))))
<li><a href="#">query: ((process.executable.text:(*\\\\powershell.exe or *\\\\pwsh.exe) and process.command_line.text:(*\\ \\-e\\ * or *\\ \\-en\\ * or *\\ \\-enc\\ * or *\\ \\-enco*) and process.command_line.text:(*\\ jab* or *\\ suvyi* or *\\ sqbfafga* or *\\ awv4i* or *\\ iab* or *\\ paa* or *\\ aqblahga*)) and (not (process.parent.executable.text:(*c\\:\\\\packages\\\\plugins\\\\microsoft.guestconfiguration.configurationforwindows\\\\* or *\\\\gc_worker.exe*))))
<li><a href="#">query: ((process.executable.text:(*\\\\powershell.exe or *\\\\pwsh.exe) and process.command_line.text:(*\\ |\\ iex;* or *\\ |\\ iex\\ * or *\\ |\\ iex\\}* or *\\ |\\ iex;* or *\\ |\\ iex\\ ;* or *\\ |\\ iex\\ \\-error* or *\\ |\\ iex\\ \\(new* or *\\ |\\ iex\\ \\(new* or *\\);iex\\ *) and process.command_line.text:(*\\:\\:frombase64string* or *.getstring\\(\\[system.convert\\]\\:\\:*)) or process.command_line.text:(*\\)|iex;$* or *\\)|iex;$* or *\\);iex\\($* or *\\);iex\\ $* or *\\ |\\ iex\\ |\\ *))
<li><a href="#">query: ((process.executable.text:(*\\\\powershell.exe or *\\\\pwsh.exe) or winlog.event_data.originalfilename:(\"powershell.exe\" or \"pwsh.dll\")) and (process.command_line.text:*get\\-adcomputer\\ * and process.command_line.text:*\\ \\-filter\\ \\*) and process.command_line.text:(*\\ >\\ * or *out\\-file* or *set\\-content* or *add\\-content*))
<li><a href="#">query: ((process.executable.text:(*\\\\powershell.exe or *\\\\pwsh.exe) or winlog.event_data.originalfilename:(\"powershell.exe\" or \"pwsh.dll\")) and (process.command_line.text:*get\\-aduser\\ * and process.command_line.text:*\\ \\-filter\\ \\*) and process.command_line.text:(*\\ >\\ * or *out\\-file* or *set\\-content* or *add\\-content*))
<li><a href="#">query: ((process.executable.text:*.exe and file.path.text:*.exe) and (not ((process.executable.text:(\"c\\:\\\\windows\\\\system32\\\\msiexec.exe\" or \"c\\:\\\\windows\\\\system32\\\\cleanmgr.exe\" or \"c\\:\\\\windows\\\\explorer.exe\" or \"c\\:\\\\windows\\\\system32\\\\dxgiadaptercache.exe\" or \"c\\:\\\\windows\\\\system32\\\\dism.exe\" or \"c\\:\\\\windows\\\\system32\\\\wuauclt.exe\")) or (process.executable.text:\"c\\:\\\\windows\\\\system32\\\\svchost.exe\" and file.path.text:c\\:\\\\windows\\\\softwaredistribution\\\\download\\\\*) or (process.executable.text:\"c\\:\\\\windows\\\\system32\\\\svchost.exe\" and file.path.text:*\\:\\\\wudownloadcache\\\\* and file.path.text:*\\\\windowsupdatebox.exe*) or (process.executable.text:c\\:\\\\windows\\\\softwaredistribution\\\\download\\\\* and process.executable.text:*\\\\windowsupdatebox.exe and file.path.text:c\\:\\\\$windows.\\~bt\\\\sources\\\\*) or (process.executable.text:c\\:\\\\windows\\\\winsxs\\\\* and process.executable.text:*\\\\tiworker.exe) or (process.executable.text:(c\\:\\\\program\\ files\\\\* or c\\:\\\\program\\ files\\ \\(x86\\)\\\\*) or file.path.text:(c\\:\\\\program\\ files\\\\* or c\\:\\\\program\\ files\\ \\(x86\\)\\\\*)) or (process.executable.text:c\\:\\\\programdata\\\\microsoft\\\\windows\\ defender\\\\*) or (file.path.text:*\\\\microsoft\\\\windowsapps\\\\*) or (process.executable.text:c\\:\\\\users\\\\* and process.executable.text:*\\\\appdata\\\\local\\\\microsoft\\\\teams\\\\update.exe and file.path.text:c\\:\\\\users\\\\* and file.path.text:(*\\\\appdata\\\\local\\\\microsoft\\\\teams\\\\stage\\\\teams.exe or *\\\\appdata\\\\local\\\\microsoft\\\\teams\\\\stage\\\\squirrel.exe)) or (process.executable.text:c\\:\\\\windows\\\\microsoft.net\\\\framework\\\\* and process.executable.text:*\\\\mscorsvw.exe and file.path.text:c\\:\\\\windows\\\\assembly\\\\nativeimages_*))))
<li><a href="#">query: ((process.executable.text:*\\/service and process.command_line.text:*iptables* and process.command_line.text:*stop*) or (process.executable.text:*\\/service and process.command_line.text:*ip6tables* and process.command_line.text:*stop*) or (process.executable.text:*\\/chkconfig and process.command_line.text:*iptables* and process.command_line.text:*stop*) or (process.executable.text:*\\/chkconfig and process.command_line.text:*ip6tables* and process.command_line.text:*stop*) or (process.executable.text:*\\/systemctl and process.command_line.text:*firewalld* and process.command_line.text:*stop*) or (process.executable.text:*\\/systemctl and process.command_line.text:*firewalld* and process.command_line.text:*disable*) or (process.executable.text:*\\/service and process.command_line.text:*cbdaemon* and process.command_line.text:*stop*) or (process.executable.text:*\\/chkconfig and process.command_line.text:*cbdaemon* and process.command_line.text:*off*) or (process.executable.text:*\\/systemctl and process.command_line.text:*cbdaemon* and process.command_line.text:*stop*) or (process.executable.text:*\\/systemctl and process.command_line.text:*cbdaemon* and process.command_line.text:*disable*) or (process.executable.text:*\\/setenforce and process.command_line.text:*0*) or (process.executable.text:*\\/systemctl and process.command_line.text:*stop* and process.command_line.text:*falcon\\-sensor*) or (process.executable.text:*\\/systemctl and process.command_line.text:*disable* and process.command_line.text:*falcon\\-sensor*))
<li><a href="#">query: ((process.executable.text:*\\\\3proxy.exe) or (winlog.event_data.description:\"3proxy - tiny proxy server\") or (process.command_line.text:*.exe\\ \\-i127.0.0.1\\ \\-p*))
<li><a href="#">query: ((process.executable.text:*\\\\anydesk.exe and file.path.text:(*.dll or *.exe)) and (not ((file.path.text:*\\\\gcapi.dll))))
<li><a href="#">query: ((process.executable.text:*\\\\bitsadmin.exe and ((process.command_line.text:(*\\ \\/create\\ * or *\\ \\/addfile\\ *) and process.command_line.text:*http*) or process.command_line.text:*\\ \\/transfer\\ *)) or process.command_line.text:*copy\\ bitsadmin.exe*)
<li><a href="#">query: ((process.executable.text:*\\\\certutil.exe or winlog.event_data.originalfilename:\"certutil.exe\") and process.command_line.text:(*\\ \\-decode\\ * or *\\ \\-decodehex\\ * or *\\ \\-urlcache\\ * or *\\ \\-verifyctl\\ * or *\\ \\-encode\\ * or *\\ \\-exportpfx\\ * or *\\ \\/decode\\ * or *\\ \\/decodehex\\ * or *\\ \\/urlcache\\ * or *\\ \\/verifyctl\\ * or *\\ \\/encode\\ * or *\\ \\/exportpfx\\ *))
<li><a href="#">query: ((process.executable.text:*\\\\cmd.exe and process.command_line.text:*sc\\ config* and process.command_line.text:*wercplsupporte.dll*) or (process.executable.text:*\\\\wmic.exe and process.command_line.text:*cor_profiler))
<li><a href="#">query: ((process.executable.text:*\\\\conhost.exe and process.parent.executable.text:(*\\\\svchost.exe or *\\\\lsass.exe or *\\\\services.exe or *\\\\smss.exe or *\\\\winlogon.exe or *\\\\explorer.exe or *\\\\rundll32.exe or *\\\\regsvr32.exe or *\\\\userinit.exe or *\\\\wininit.exe or *\\\\spoolsv.exe or *\\\\ctfmon.exe)) and (not (process.parent.command_line.text:(*\\-k\\ apphost\\ \\-s\\ apphostsvc* or *\\-k\\ imgsvc* or *\\-k\\ netsvcs\\ \\-p\\ \\-s\\ netsetupsvc* or *\\-k\\ localsystemnetworkrestricted\\ \\-p\\ \\-s\\ ngcsvc* or *\\-k\\ wsappx\\ \\-p\\ \\-s\\ clipsvc* or *\\-k\\ netsvcs\\ \\-p\\ \\-s\\ wlidsvc*))))
<li><a href="#">query: ((process.executable.text:*\\\\createdump.exe or winlog.event_data.originalfilename:\"fx_ver_internalname_str\") and process.command_line.text:(*\\ \\-u\\ * or *\\ \\-\\-full\\ * or *\\ \\-f\\ * or *\\ \\-\\-name\\ * or *.dmp\\ *))
<li><a href="#">query: ((process.executable.text:*\\\\csc.exe and process.command_line.text:(*\\\\appdata\\\\* or *\\\\windows\\\\temp\\\\*)) and (not (process.parent.executable.text:c\\:\\\\program\\ files* or process.parent.executable.text:(*\\\\sdiagnhost.exe or *\\\\w3wp.exe or *\\\\choco.exe) or process.parent.command_line.text:*\\\\programdata\\\\microsoft\\\\windows\\ defender\\ advanced\\ threat\\ protection*)))
<li><a href="#">query: ((process.executable.text:*\\\\curl.exe or product:\"the\\ curl\\ executable\") and process.command_line.text:(*\\ \\-f\\ * or *\\ \\-\\-form* or *\\ \\-t\\ * or *\\ \\-\\-upload\\-file\\ * or *\\ \\-d\\ * or *\\ \\-\\-data\\ * or *\\ \\-\\-data\\-*))
<li><a href="#">query: ((process.executable.text:*\\\\dismhost.exe and process.parent.command_line.text:*\\/online* and process.parent.command_line.text:*\\/disable\\-feature*) or (process.executable.text:*\\\\dism.exe and process.command_line.text:*\\/online* and process.command_line.text:*\\/disable\\-feature*))
<li><a href="#">query: ((process.executable.text:*\\\\esentutl.exe or winlog.event_data.originalfilename:\"esentutl.exe\") and process.command_line.text:(*\\/r* or *\\-r*) and process.command_line.text:*\\\\windows\\\\webcache*)
<li><a href="#">query: ((process.executable.text:*\\\\expand.exe and process.command_line.text:(*.cab* or *\\/f\\:* or *\\-f\\:* or *c\\:\\\\programdata\\\\* or *c\\:\\\\public\\\\* or *\\\\appdata\\\\local\\\\temp\\\\* or *\\\\appdata\\\\roaming\\\\temp\\\\*)) and (not ((process.parent.executable.text:\"c\\:\\\\program\\ files\\ \\(x86\\)\\\\dell\\\\updateservice\\\\serviceshell.exe\" and process.command_line.text:*c\\:\\\\programdata\\\\dell\\\\updateservice\\\\temp\\\\*))))
<li><a href="#">query: ((process.executable.text:*\\\\installutil.exe or winlog.event_data.originalfilename:\"installutil.exe\") and process.command_line.text:(*http\\:\\/\\/* or *https\\:\\/\\/* or *ftp\\:\\/\\/*))
<li><a href="#">query: ((process.executable.text:*\\\\link.exe and process.command_line.text:*link\\ \\/*) and (not ((process.parent.executable.text:(c\\:\\\\program\\ files\\\\microsoft\\ visual\\ studio\\\\* or c\\:\\\\program\\ files\\ \\(x86\\)\\\\microsoft\\ visual\\ studio\\\\*) and process.parent.executable.text:*\\\\vc\\\\tools\\\\msvc\\\\*))))
<li><a href="#">query: ((process.executable.text:*\\\\mshta.exe or winlog.event_data.originalfilename:\"mshta.exe\") and process.command_line.text:(*http\\:\\/\\/* or *https\\:\\/\\/* or *ftp\\:\\/\\/*))
<li><a href="#">query: ((process.executable.text:*\\\\msiexec.exe and process.command_line.text:(*\\ \\/y* or *\\ \\-y*)) and (not ((process.command_line.text:(*\\\\msiexec.exe\\\"\\ \\/y\\ \\\"c\\:\\\\program\\ files\\\\bonjour\\\\mdnsnsp.dll* or *\\\\msiexec.exe\\\"\\ \\/y\\ \\\"c\\:\\\\program\\ files\\ \\(x86\\)\\\\bonjour\\\\mdnsnsp.dll* or *\\\\msiexec.exe\\\"\\ \\/y\\ \\\"c\\:\\\\program\\ files\\ \\(x86\\)\\\\apple\\ software\\ update\\\\scriptingobjectmodel.dll* or *\\\\msiexec.exe\\\"\\ \\/y\\ \\\"c\\:\\\\program\\ files\\ \\(x86\\)\\\\apple\\ software\\ update\\\\softwareupdateadmin.dll* or *\\\\msiexec.exe\\\"\\ \\/y\\ \\\"c\\:\\\\windows\\\\ccm\\\\* or *\\\\msiexec.exe\\\"\\ \\/y\\ c\\:\\\\windows\\\\ccm\\\\*)))))
<li><a href="#">query: ((process.executable.text:*\\\\msiexec.exe or winlog.event_data.originalfilename:\"msiexec.exe\") and process.command_line.text:(*\\/i* or *\\-i* or *\\/package* or *\\-package* or *\\/a* or *\\-a* or *\\/j* or *\\-j*) and process.command_line.text:(*\\/q* or *\\-q*) and process.command_line.text:(*http* or *\\\\\\\\\\*))
<li><a href="#">query: ((process.executable.text:*\\\\msohtmed.exe or winlog.event_data.originalfilename:\"msohtmed.exe\") and process.command_line.text:(*http\\:\\/\\/* or *https\\:\\/\\/* or *ftp\\:\\/\\/*))
<li><a href="#">query: ((process.executable.text:*\\\\mspub.exe or winlog.event_data.originalfilename:\"mspub.exe\") and process.command_line.text:(*http\\:\\/\\/* or *https\\:\\/\\/* or *ftp\\:\\/\\/*))
<li><a href="#">query: ((process.executable.text:*\\\\netsh.exe and process.command_line.text:*firewall* and process.command_line.text:*delete*) and (not (process.parent.executable.text:*\\\\dropbox.exe and process.command_line.text:*name\\=dropbox*)))
<li><a href="#">query: ((process.executable.text:*\\\\nimgrab.exe) or (winlog.event_data.hashes:(*md5\\=2dd44c3c29d667f5c0ef5f9d7c7ffb8b* or *sha256\\=f266609e91985f0fe3e31c5e8faeeec4ffa5e0322d8b6f15fe69f4c5165b9559* or *imphash\\=c07fddd21d123ea9b3a08eef44aaac45*)) or (md5:\"2dd44c3c29d667f5c0ef5f9d7c7ffb8b\") or (sha256:\"f266609e91985f0fe3e31c5e8faeeec4ffa5e0322d8b6f15fe69f4c5165b9559\") or (winlog.event_data.imphash:\"c07fddd21d123ea9b3a08eef44aaac45\"))
<li><a href="#">query: ((process.executable.text:*\\\\nltest.exe and process.command_line.text:(*domain_trusts* or *all_trusts* or *\\/trusted_domains* or *\\/dclist*)) or (process.executable.text:*\\\\dsquery.exe and process.command_line.text:*trusteddomain*) or (process.executable.text:*\\\\dsquery.exe and process.command_line.text:*\\-filter* and process.command_line.text:*trusteddomain*))
<li><a href="#">query: ((process.executable.text:*\\\\nltest.exe or winlog.event_data.originalfilename:\"nltestrk.exe\") and ((process.command_line.text:*\\/server* and process.command_line.text:*\\/query*) or process.command_line.text:(*\\/dclist\\:* or *\\/parentdomain* or *\\/domain_trusts* or *\\/trusted_domains* or *\\/user*)))
<li><a href="#">query: ((process.executable.text:*\\\\presentationhost.exe or winlog.event_data.originalfilename:\"presentationhost.exe\") and process.command_line.text:(*http\\:\\/\\/* or *https\\:\\/\\/* or *ftp\\:\\/\\/*))
<li><a href="#">query: ((process.executable.text:*\\\\processhacker_*) or (process.executable.text:(*\\\\systeminformer.exe or *\\\\processhacker.exe)) or (winlog.event_data.originalfilename:(\"processhacker.exe\" or \"process hacker\" or \"systeminformer.exe\")) or (winlog.event_data.description:(\"process hacker\" or \"system informer\")) or (product:\"process hacker\") or (winlog.event_data.hashes:(*md5\\=68f9b52895f4d34e74112f3129b3b00d* or *sha1\\=c5e2018bf7c0f314fed4fd7fe7e69fa2e648359e* or *sha256\\=d4a0fe56316a2c45b9ba9ac1005363309a3edc7acf9e4df64d326a0ff273e80f* or *imphash\\=04de0ad9c37eb7bd52043d2ecac958df* or *md5\\=b365af317ae730a67c936f21432b9c71* or *sha1\\=a0bdfac3ce1880b32ff9b696458327ce352e3b1d* or *sha256\\=bd2c2cf0631d881ed382817afcce2b093f4e412ffb170a719e2762f250abfea4* or *imphash\\=3695333c60dedecdcaff1590409aa462*)) or (md5:(\"68f9b52895f4d34e74112f3129b3b00d\" or \"b365af317ae730a67c936f21432b9c71\")) or (sha1:(\"c5e2018bf7c0f314fed4fd7fe7e69fa2e648359e\" or \"a0bdfac3ce1880b32ff9b696458327ce352e3b1d\")) or (sha256:(\"d4a0fe56316a2c45b9ba9ac1005363309a3edc7acf9e4df64d326a0ff273e80f\" or \"bd2c2cf0631d881ed382817afcce2b093f4e412ffb170a719e2762f250abfea4\")) or (winlog.event_data.imphash:(\"04de0ad9c37eb7bd52043d2ecac958df\" or \"3695333c60dedecdcaff1590409aa462\")))
<li><a href="#">query: ((process.executable.text:*\\\\protocolhandler.exe or winlog.event_data.originalfilename:\"protocolhandler.exe\") and (process.command_line.text:*\\\"ms\\-word* and process.command_line.text:*.docx\\\"*))
<li><a href="#">query: ((process.executable.text:*\\\\reg.exe and process.command_line.text:*\\ add\\ * and process.command_line.text:*\\\\currentcontrolset\\\\control\\\\terminal\\ server* and process.command_line.text:*reg_dword* and process.command_line.text:*\\ \\/f*) and ((process.command_line.text:*licensing\\ core* and process.command_line.text:*enableconcurrentsessions*) or process.command_line.text:(*winstations\\\\rdp\\-tcp* or *maxinstancecount* or *fenablewinstation* or *tsuserenabled* or *tsenabled* or *tsappcompat* or *idlewinstationpoolcount* or *tsadvertise* or *allowtsconnections* or *fsinglesessionperuser* or *fdenytsconnections*)))
<li><a href="#">query: ((process.executable.text:*\\\\reg.exe and process.command_line.text:*add* and process.command_line.text:*currentversion\\\\control\\ panel\\\\cpls*) or (process.command_line.text:*.cpl and (not ((process.command_line.text:(*\\\\system32\\\\* or *%system%*)) or (process.command_line.text:*regsvr32\\ * and process.command_line.text:*\\ \\/s\\ * and process.command_line.text:*igfxcpl.cpl*)))))
<li><a href="#">query: ((process.executable.text:*\\\\reg.exe or winlog.event_data.originalfilename:\"reg.exe\") and process.command_line.text:(*\\\\appdatalow\\\\software\\\\microsoft\\\\* or *\\\\policies\\\\microsoft\\\\windows\\\\oobe* or *\\\\policies\\\\microsoft\\\\windows\\ nt\\\\currentversion\\\\winlogon* or *\\\\currentcontrolset\\\\control\\\\securityproviders\\\\wdigest* or *\\\\microsoft\\\\windows\\ defender\\\\*))
<li><a href="#">query: ((process.executable.text:*\\\\reg.exe or winlog.event_data.originalfilename:\"reg.exe\") and process.command_line.text:*\\\\software\\\\policies\\\\microsoft\\\\windows\\\\system* and process.command_line.text:(*grouppolicyrefreshtimedc* or *grouppolicyrefreshtimeoffsetdc* or *grouppolicyrefreshtime* or *grouppolicyrefreshtimeoffset* or *enablesmartscreen* or *shellsmartscreenlevel*))
<li><a href="#">query: ((process.executable.text:*\\\\regedit.exe and process.command_line.text:(*\\ \\/i\\ * or *\\ \\/s\\ * or *.reg*)) and (not ((process.command_line.text:(*\\ \\/e\\ * or *\\ \\/a\\ * or *\\ \\/c\\ * or *\\ \\-e\\ * or *\\ \\-a\\ * or *\\ \\-c\\ *)) and ((process.command_line.text:/:/ or process.command_line.text:/[/ or process.command_line.text:/^/ or process.command_line.text:/ / or process.command_line.text:/\\/ or process.command_line.text:/\\/ or process.command_line.text:/]/)))))
<li><a href="#">query: ((process.executable.text:*\\\\regsvr32.exe or winlog.event_data.originalfilename:\"\\\\regsvr32.exe\") and process.command_line.text:(*.jpg or *.jpeg or *.gif or *.png or *.ico or *.bmp or *.tif or *.tiff or *.eps or *.raw or *.cr2 or *.nef or *.orf or *.sr2))
<li><a href="#">query: ((process.executable.text:*\\\\regsvr32.exe or winlog.event_data.originalfilename:\"\\\\regsvr32.exe\") and process.command_line.text:*\\ \\\\\\\\\\*)
<li><a href="#">query: ((process.executable.text:*\\\\rundll32.exe and process.command_line.text:(*,#* or *,\\ #* or *.dll\\ #* or *.ocx\\ #*)) and (not (((process.command_line.text:*edgehtml.dll* and process.command_line.text:*#141*)) or ((process.parent.executable.text:(*\\\\msbuild\\\\current\\\\bin\\\\* or *\\\\vc\\\\tools\\\\msvc\\\\* or *\\\\tracker.exe*) and process.command_line.text:(*\\\\filetracker32.dll,#1* or *\\\\filetracker32.dll\\\",#1* or *\\\\filetracker64.dll,#1* or *\\\\filetracker64.dll\\\",#1*))))))
<li><a href="#">query: ((process.executable.text:*\\\\rundll32.exe and process.parent.executable.text:*\\\\explorer.exe) and (not ((process.command_line.text:*\\ c\\:\\\\windows\\\\system32\\\\*) or (process.command_line.text:*\\ \\-localserver\\ 22d8c27b\\-47a1\\-48d1\\-ad08\\-7da7abd79617))))
<li><a href="#">query: ((process.executable.text:*\\\\rundll32.exe and winlog.event_data.initiated:\"true\") and (not ((((destination.ip:(10.* or 192.168.* or 172.16.* or 172.17.* or 172.18.* or 172.19.* or 172.20.* or 172.21.* or 172.22.* or 172.23.* or 172.24.* or 172.25.* or 172.26.* or 172.27.* or 172.28.* or 172.29.* or 172.30.* or 172.31.* or 127.* or 20.* or 51.103.* or 51.104.* or 51.105.*)) or (process.command_line.text:*pcasvc.dll,pcapatchsdbtask*))) or ((process.parent.executable.text:\"c:\\windows\\system32\\svchost.exe\" and destination.port:\"443\")))))
<li><a href="#">query: ((process.executable.text:*\\\\rundll32.exe or winlog.event_data.originalfilename:\"rundll32.exe\" or process.command_line.text:(*rundll32.exe* or *rundll32\\ *)) and (process.command_line.text:*.dll* and process.command_line.text:(*\\ startw or *,startw)))
<li><a href="#">query: ((process.executable.text:*\\\\rundll32.exe or winlog.event_data.originalfilename:\"rundll32.exe\" or process.command_line.text:*rundll32*) and process.command_line.text:*\\ \\\\\\\\\\*)
<li><a href="#">query: ((process.executable.text:*\\\\rundll32.exe or winlog.event_data.originalfilename:\"rundll32.exe\") and (process.command_line.text:*comsvcs* and process.command_line.text:*minidump* and process.command_line.text:*full*))
<li><a href="#">query: ((process.executable.text:*\\\\sc.exe or winlog.event_data.originalfilename:\"sc.exe\") and process.command_line.text:*\\ delete\\ * and process.command_line.text:(*avgadminserver* or *avg\\ antivirus* or *mbendpointagent* or *mbamservice* or *mbcloudea* or *avgadminclient* or *savservice* or *savadminservice* or *sophos\\ autoupdate\\ service* or *sophos\\ clean\\ service* or *sophos\\ device\\ control\\ service* or *sophos\\ file\\ scanner\\ service* or *sophos\\ health\\ service* or *sophos\\ mcs\\ agent* or *sophos\\ mcs\\ client* or *sntpservice* or *swc_service* or *swi_service* or *sophos\\ ui* or *swi_update* or *sophos\\ web\\ control\\ service* or *sophos\\ system\\ protection\\ service* or *sophos\\ safestore\\ service* or *hmpalertsvc* or *rpceptmapper* or *sophos\\ endpoint\\ defense\\ service* or *sophosfim* or *swi_filter* or *firebirdguardiandefaultinstance* or *firebirdserverdefaultinstance* or *wrsvc* or *ekrn* or *ekrnepsw* or *klim6* or *avp18.0.0* or *klif* or *klpd* or *klflt* or *klbackupdisk* or *klbackupflt* or *klkbdflt* or *klmouflt* or *klhk* or *ksde1.0.0* or *kltap* or *scsecsvc* or *core\\ mail\\ protection* or *core\\ scanning\\ server* or *core\\ scanning\\ serverex* or *online\\ protection\\ system* or *repairservice* or *core\\ browsing\\ protection* or *quick\\ update\\ service* or *mcafeeframework* or *macmnsvc* or *masvc* or *mfemms* or *mfevtp* or *tmfilter* or *tmlwcsservice* or *tmusa* or *tmprefilter* or *tmsmartrelayservice* or *tmicrcscanservice* or *vsapint* or *tmccsf* or *tmlisten* or *tmproxy* or *ntrtscan* or *ofcservice* or *tmpfw* or *pccntupd* or *pandaaetheragent* or *psuaservice* or *nanoservicemain* or *epintegrationservice* or *epprotectedservice* or *epredline* or *epsecurityservice* or *epupdateservice*))
<li><a href="#">query: ((process.executable.text:*\\\\schtasks.exe and process.command_line.text:(*\\ \\/change\\ * or *\\ \\/create\\ *) and process.command_line.text:*\\/ru\\ * and process.command_line.text:(*nt\\ aut* or *\\ system\\ *)) and (not (process.parent.executable.text:*\\\\appdata\\\\local\\\\temp\\\\* and process.parent.executable.text:*teamviewer_.exe* and process.executable.text:*\\\\schtasks.exe and process.command_line.text:*\\/tn\\ tvinstallrestore*)))
<li><a href="#">query: ((process.executable.text:*\\\\schtasks.exe and process.command_line.text:*\\ \\/create\\ *) and (not (user.name:(*authori* or *autori*))))
<li><a href="#">query: ((process.executable.text:*\\\\schtasks.exe and process.command_line.text:*\\/create* and process.command_line.text:*\\/ru* and process.command_line.text:*\\/tr* and process.command_line.text:*c\\:\\\\users\\\\* and process.command_line.text:*\\\\appdata\\\\local\\\\* and process.command_line.text:(*nt\\ aut* or *\\ system\\ *)) and (not (process.parent.executable.text:*\\\\appdata\\\\local\\\\temp\\\\* and process.parent.executable.text:*teamviewer_.exe* and process.executable.text:*\\\\schtasks.exe and process.command_line.text:*\\/tn\\ tvinstallrestore*)))
<li><a href="#">query: ((process.executable.text:*\\\\sdbinst.exe and process.command_line.text:*.sdb*) and (not (process.command_line.text:*iisexpressshim.sdb*)))
<li><a href="#">query: ((process.executable.text:*\\\\sharpimpersonation.exe) or (winlog.event_data.originalfilename:\"sharpimpersonation.exe\") or ((process.command_line.text:*\\ user\\:* and process.command_line.text:*\\ binary\\:*)) or ((process.command_line.text:*\\ user\\:* and process.command_line.text:*\\ shellcode\\:*)) or (process.command_line.text:(*\\ technique\\:createprocessasuserw* or *\\ technique\\:impersonateloggedonuser*)))
<li><a href="#">query: ((process.executable.text:*\\\\svchost.exe and winlog.event_data.initiated:\"true\" and source.port:\"3389\") and (destination.ip:127.* or destination.ip:\"\\:\\:1\"))
<li><a href="#">query: ((process.executable.text:*\\\\sysmoneop.exe) or (winlog.event_data.hashes:(\"imphash=22f4089eb8aba31e1bb162c6d9bf72e5\" or \"imphash=5123fa4c4384d431cd0d893eeb49bbec\")) or (winlog.event_data.imphash:(\"22f4089eb8aba31e1bb162c6d9bf72e5\" or \"5123fa4c4384d431cd0d893eeb49bbec\")))
<li><a href="#">query: ((process.executable.text:*\\\\update.exe and process.command_line.text:*.exe* and process.command_line.text:(*\\-\\-processstart* or *\\-\\-processstartandwait* or *\\-\\-createshortcut*)) and (not ((process.command_line.text:*c\\:\\\\users\\\\* and process.command_line.text:*\\\\appdata\\\\local\\\\discord\\\\update.exe* and process.command_line.text:*\\ \\-\\-processstart* and process.command_line.text:*discord.exe*) or (process.command_line.text:*c\\:\\\\users\\\\* and process.command_line.text:*\\\\appdata\\\\local\\\\githubdesktop\\\\update.exe* and process.command_line.text:*githubdesktop.exe* and process.command_line.text:(*\\-\\-createshortcut* or *\\-\\-processstartandwait*)) or (process.command_line.text:*c\\:\\\\users\\\\* and process.command_line.text:*\\\\appdata\\\\local\\\\microsoft\\\\teams\\\\update.exe* and process.command_line.text:*teams.exe* and process.command_line.text:(*\\-\\-processstart* or *\\-\\-createshortcut*)))))
<li><a href="#">query: ((process.executable.text:*\\\\vsls\\-agent.exe and process.command_line.text:*\\-\\-agentextensionpath*) and (not (process.command_line.text:*microsoft.visualstudio.liveshare.agent.*)))
<li><a href="#">query: ((process.executable.text:*\\\\w3wp.exe or process.parent.executable.text:*\\\\w3wp.exe) and process.command_line.text:(*&ipconfig&echo* or *&quser&echo* or *&whoami&echo* or *&c\\:&echo* or *&cd&echo* or *&dir&echo* or *&echo\\ \\[e\\]* or *&echo\\ \\[s\\]*))
<li><a href="#">query: ((process.executable.text:*\\\\werfault.exe and process.command_line.text:*werfault.exe) or (process.executable.text:*\\\\rundll32.exe and process.command_line.text:*rundll32.exe) or (process.executable.text:*\\\\regsvcs.exe and process.command_line.text:*regsvcs.exe) or (process.executable.text:*\\\\regasm.exe and process.command_line.text:*regasm.exe) or (process.executable.text:*\\\\regsvr32.exe and process.command_line.text:*regsvr32.exe))
<li><a href="#">query: ((process.executable.text:*\\\\winword.exe or winlog.event_data.originalfilename:\"winword.exe\") and process.command_line.text:(*\\/l\\ * or *.dll* or *http\\:\\/\\/* or *https\\:\\/\\/*))
<li><a href="#">query: ((process.executable.text:*\\\\wlrmdr.exe and process.command_line.text:*\\-s\\ * and process.command_line.text:*\\-f\\ * and process.command_line.text:*\\-t\\ * and process.command_line.text:*\\-m\\ * and process.command_line.text:*\\-a\\ * and process.command_line.text:*\\-u\\ *) and (not ((process.parent.executable.text:\"c\\:\\\\windows\\\\system32\\\\winlogon.exe\") or (process.parent.executable.text:\"\\-\"))))
<li><a href="#">query: ((process.executable.text:*atbroker.exe and process.command_line.text:*start*) and (not (process.command_line.text:(*animations* or *audiodescription* or *caretbrowsing* or *caretwidth* or *colorfiltering* or *cursorscheme* or *filterkeys* or *focusborderheight* or *focusborderwidth* or *highcontrast* or *keyboardcues* or *keyboardpref* or *magnifierpane* or *messageduration* or *minimumhitradius* or *mousekeys* or *narrator* or *osk* or *overlappedcontent* or *showsounds* or *soundsentry* or *stickykeys* or *togglekeys* or *windowarranging* or *windowtracking* or *windowtrackingtimeout* or *windowtrackingzorder*))))
<li><a href="#">query: ((process.executable.text:*reg.exe or winlog.event_data.originalfilename:\"reg.exe\") and (process.command_line.text:*\\ delete\\ * and process.command_line.text:*\\\\system\\\\currentcontrolset\\\\control\\\\safeboot*))
<li><a href="#">query: ((process.executable.text:*reg.exe or winlog.event_data.originalfilename:\"reg.exe\") and process.command_line.text:*\\ delete\\ * and process.command_line.text:*\\\\system\\\\currentcontrolset\\\\services\\\\*)
<li><a href="#">query: ((process.executable.text:*reg.exe or winlog.event_data.originalfilename:\"reg.exe\") and process.command_line.text:*\\\\system\\\\currentcontrolset\\\\control\\\\safeboot* and process.command_line.text:(*\\ copy\\ * or *\\ add\\ *))
<li><a href="#">query: ((process.executable.text:\"c\\:\\\\windows\\\\syswow64\\\\iscsicpl.exe\" and file.path.text:*\\\\iscsiexe.dll) and (not (file.path.text:*c\\:\\\\windows\\\\* and file.path.text:*iscsiexe.dll*)))
<li><a href="#">query: ((process.executable.text:c\\:\\\\windows\\\\* and dll.path:(*\\\\users\\\\public\\\\* or *\\\\downloads\\\\* or *\\\\appdata\\\\local\\\\temp\\\\* or *c\\:\\\\perflogs\\\\*)) and (not ((process.executable.text:*\\\\msiexec.exe or dll.path:(c\\:\\\\program\\ files\\\\* or c\\:\\\\program\\ files\\ \\(x86\\)\\\\*)) or (process.executable.text:\"c\\:\\\\windows\\\\system32\\\\cleanmgr.exe\" and dll.path:*\\\\ssshim.dll) or (process.executable.text:c\\:\\\\windows\\\\microsoft.net\\\\framework\\\\v* and process.executable.text:*\\\\mscorsvw.exe and dll.path:*\\\\appdata\\\\local\\\\temp\\\\*))))
<li><a href="#">query: ((process.executable:(*\\/nc or *\\/netcat) and (not (process.command_line:*l*))) or process.executable:(*\\/nmap or *\\/telnet))
<li><a href="#">query: ((process.executable:(*\\/nc or *\\/netcat) and (not (process.command_line:*l*))) or process.executable:(*\\/telnet or *\\/nmap))
<li><a href="#">query: ((process.executable:(*\\\\cmd.exe or *\\\\powershell.exe or *\\\\pwsh.exe or *\\\\wscript.exe or *\\\\cscript.exe or *\\\\sh.exe or *\\\\bash.exe or *\\\\msbuild.exe or *\\\\certutil.exe) and file.path:(*c\\:\\\\users\\\\public* or *c\\:\\\\perflogs*)) or (process.executable:(*\\\\schtasks.exe or *\\\\wmic.exe or *\\\\mshta.exe or *\\\\forfiles.exe or *\\\\scriptrunner.exe or *\\\\certutil.exe) and file.path:(*c\\:\\\\users\\\\public* or *c\\:\\\\perflogs* or *\\\\appdata\\\\* or *c\\:\\\\windows\\\\temp*)))
<li><a href="#">query: ((process.executable:(*\\\\csi.exe or *\\\\rcsi.exe) or winlog.event_data.originalfilename:(\"csi.exe\" or \"rcsi.exe\")) and company:\"microsoft\\ corporation\")
<li><a href="#">query: ((process.executable:(*\\\\curl.exe or *\\\\wget.exe) or process.command_line:(*start\\-bitstransfer* or *.downloadfile\\(* or *.downloadstring\\(*)) and process.command_line:(*https\\:\\/\\/attachment.outlook.live.net\\/owa\\/* or *https\\:\\/\\/onenoteonlinesync.onenote.com\\/onenoteonlinesync\\/*))
<li><a href="#">query: ((process.executable:(*\\\\net.exe or *\\\\net1.exe) and process.command_line:*time*) or (process.executable:*\\\\w32tm.exe and process.command_line:*tz*) or (process.executable:*\\\\powershell.exe and process.command_line:*get\\-date*))
<li><a href="#">query: ((process.executable:(*\\\\net.exe or *\\\\net1.exe) and process.command_line:*time*) or (process.executable:*\\\\w32tm.exe and process.command_line:*tz*))
<li><a href="#">query: ((process.executable:(*\\\\net.exe or *\\\\net1.exe) and process.command_line:*view*) and (not (process.command_line:*\\\\\\\\*)))
<li><a href="#">query: ((process.executable:(*\\\\net.exe or *\\\\net1.exe) or winlog.event_data.originalfilename:(\"net.exe\" or \"net1.exe\")) and (process.command_line:*share* and process.command_line:*\\/delete*))
<li><a href="#">query: ((process.executable:(*\\\\net.exe or *\\\\net1.exe) or winlog.event_data.originalfilename:(\"net.exe\" or \"net1.exe\")) and process.command_line:(*\\ group* or *\\ localgroup* or *\\ user* or *\\ view* or *\\ share* or *\\ accounts* or *\\ stop\\ * or *\\ start*))
<li><a href="#">query: ((process.executable:(*\\\\nsudo.exe or *\\\\nsudolc.exe or *\\\\nsudolg.exe) or winlog.event_data.originalfilename:(\"nsudo.exe\" or \"nsudolc.exe\" or \"nsudolg.exe\")) and process.command_line:(*\\-u\\:s\\ * or *\\-u\\:t\\ * or *\\-u\\:e\\ * or *\\-p\\:e\\ * or *\\-m\\:s\\ * or *\\-m\\:h\\ * or *\\-u\\=s\\ * or *\\-u\\=t\\ * or *\\-u\\=e\\ * or *\\-p\\=e\\ * or *\\-m\\=s\\ * or *\\-m\\=h\\ *))
<li><a href="#">query: ((process.executable:(*\\\\powershell.exe or *\\\\mshta.exe or *\\\\wscript.exe or *\\\\cscript.exe or *\\\\cmd.exe) or process.command_line:(*\\ \\-w\\ hidden\\ * or *\\ \\-ep\\ bypass\\ * or *\\/e\\:vbscript\\ * or *\\/e\\:javascript\\ *) or winlog.event_data.originalfilename:(\"powershell.exe\" or \"mshta.exe\" or \"wscript.exe\" or \"cscript.exe\" or \"cmd.exe\")) and process.executable:(*\\\\windows\\\\temp* or *\\\\temporary\\ internet* or *\\\\appdata\\\\local\\\\temp* or *\\\\appdata\\\\roaming\\\\temp* or *c\\:\\\\users\\\\public\\\\* or *c\\:\\\\perflogs\\\\*))
<li><a href="#">query: ((process.executable:(*\\\\powershell.exe or *\\\\mshta.exe or *\\\\wscript.exe or *\\\\cscript.exe) and process.command_line:(*\\\\windows\\\\temp* or *\\\\temporary\\ internet* or *\\\\appdata\\\\local\\\\temp* or *\\\\appdata\\\\roaming\\\\temp* or *%temp%* or *%tmp%* or *%localappdata%\\\\temp*)) and (not (process.command_line:(*\\ >* or *out\\-file* or *convertto\\-json* or *\\-windowstyle\\ hidden\\ \\-verb\\ runas*))))
<li><a href="#">query: ((process.executable:(*\\\\powershell.exe or *\\\\pwsh.exe or *\\\\cmd.exe) and process.parent.command_line:*msiexec.exe* and process.parent.command_line:*\\-embedding\\ *) and (not ((process.executable:*\\:\\\\windows\\\\system32\\\\cmd.exe and process.command_line:*c\\:\\\\program\\ files\\\\splunkuniversalforwarder\\\\bin\\\\*) or (process.command_line:*\\\\dismfodinstall.cmd* or process.parent.command_line:*\\\\msiexec.exe\\ \\-embedding\\ * and process.parent.command_line:*global\\\\msi0000*))))
<li><a href="#">query: ((process.executable:(*\\\\powershell.exe or *\\\\pwsh.exe) and process.command_line:(*\\-disablebehaviormonitoring\\ $true* or *\\-disableruntimemonitoring\\ $true*)) or (process.command_line:*sc* and process.command_line:*stop* and process.command_line:*windefend*) or (process.command_line:*sc* and process.command_line:*config* and process.command_line:*windefend* and process.command_line:*start\\=disabled*))
<li><a href="#">query: ((process.executable:(*\\\\powershell.exe or *\\\\pwsh.exe) and process.command_line:*pester* and process.command_line:*get\\-help*) or (process.executable:*\\\\cmd.exe and process.command_line:*pester* and process.command_line:*;* and process.command_line:(*help* or *?*)))
<li><a href="#">query: ((process.executable:(*\\\\powershell.exe or *\\\\pwsh.exe) and winlog.event_data.initiated:\"true\" and destinationisipv6:\"false\") and (not (destination.ip:(10.* or 192.168.* or 172.16.* or 172.17.* or 172.18.* or 172.19.* or 172.20.* or 172.21.* or 172.22.* or 172.23.* or 172.24.* or 172.25.* or 172.26.* or 172.27.* or 172.28.* or 172.29.* or 172.30.* or 172.31.* or 127.0.0.1*) and user.name:(*authori* or *autori*))))
<li><a href="#">query: ((process.executable:(*\\\\powershell.exe or *\\\\wmic.exe or *\\\\vssadmin.exe or *\\\\diskshadow.exe) and process.command_line:*shadow* and process.command_line:*delete*) or (process.executable:*\\\\wbadmin.exe and process.command_line:*delete* and process.command_line:*catalog* and process.command_line:*quiet*) or (process.executable:*\\\\vssadmin.exe and process.command_line:*resize* and process.command_line:*shadowstorage* and process.command_line:*unbounded*))
<li><a href="#">query: ((process.executable:(*\\\\rar.exe or *\\\\winrar.exe) or winlog.event_data.description:\"command\\ line\\ rar\") and (not (process.executable:(*\\\\winrar* or *c\\:\\\\windows\\\\temp* or *\\\\unrar.exe*))))
<li><a href="#">query: ((process.executable:(*\\\\rar.exe or *\\\\winrar.exe) or winlog.event_data.description:\"command\\ line\\ rar\") and process.command_line:*.dmp*)
<li><a href="#">query: ((process.executable:(*\\\\rar.exe or *\\\\winrar.exe) or winlog.event_data.description:\"command\\ line\\ rar\") and process.command_line:\".dmp\")
<li><a href="#">query: ((process.executable:(*\\\\sc.exe or *\\\\net.exe or *\\\\net1.exe) and process.command_line:*stop*) and (not (process.command_line:\"sc\\ \\ stop\\ kscwebconsolemessagequeue\" and user.name:(nt\\ authority\\\\system* or autorite\\ nt\\\\sys*))))
<li><a href="#">query: ((process.executable:(*\\\\takeown.exe or *\\\\cacls.exe or *\\\\icacls.exe) and process.command_line:*\\/grant*) or (process.executable:*\\\\attrib.exe and process.command_line:*\\-r*))
<li><a href="#">query: ((process.executable:(*\\\\users\\\\all\\ users\\\\* or *\\\\users\\\\default\\\\* or *\\\\users\\\\public\\\\* or *\\\\users\\\\contacts\\\\* or *\\\\users\\\\searches\\\\* or *\\\\config\\\\systemprofile\\\\* or *\\\\windows\\\\fonts\\\\* or *\\\\windows\\\\ime\\\\* or *\\\\windows\\\\addins\\\\*) or process.executable:*\\\\$recycle.bin or process.executable:c\\:\\\\perflogs\\\\*) and (not ((process.executable:c\\:\\\\users\\\\public\\\\ibm\\\\clientsolutions\\\\start_programs\\\\*))))
<li><a href="#">query: ((process.executable:(*\\\\winword.exe or *\\\\excel.exe or *\\\\powerpnt.exe) and file.path:(*.exe or *.dll or *.ocx or *.com or *.ps1 or *.vbs or *.sys or *.bat or *.scr or *.proj)) and (not ((file.path:*c\\:\\\\users\\\\* and file.path:*\\\\appdata\\\\local\\\\microsoft\\\\office\\\\* and file.path:*\\\\webservicecache\\\\allusers* and file.path:*.com) or (process.executable:*\\\\winword.exe and file.path:*\\\\appdata\\\\local\\\\temp\\\\webexdelta\\\\* and file.path:(*.dll or *.exe)) or (file.path:*\\\\appdata\\\\local\\\\assembly\\\\tmp\\\\* and file.path:*.dll))))
<li><a href="#">query: ((process.executable:(*\\\\wscript.exe or *\\\\cscript.exe) and process.command_line:(*c\\:\\\\users\\\\* or *c\\:\\\\programdata\\\\*) and process.command_line:(*.jse* or *.vbe* or *.js* or *.vba* or *.vbs*)) and (not (process.parent.executable:*\\\\winzip*)))
<li><a href="#">query: ((process.executable:(*powershell.exe or *pwsh.exe) and process.command_line:(*hctac* or *kaerb* or *dnammoc* or *ekovn* or *elifd* or *rahc* or *etirw* or *golon* or *tninon* or *eddih* or *tpircs* or *ssecorp* or *llehsrewop* or *esnopser* or *daolnwod* or *tneilcbew* or *tneilc* or *ptth* or *elifotevas* or *46esab* or *htappmetteg* or *tcejbo* or *maerts* or *hcaerof* or *ekovni* or *retupmoc*)) and (not ((process.command_line:*\\-encodedcommand*))))
<li><a href="#">query: ((process.executable:(*winword.exe or *excel.exe or *powerpnt.exe) and file.path:(*.exe or *.dll or *.ocx or *.com or *.ps1 or *.vbs or *.sys or *.bat or *.scr or *.proj)) and (not ((file.path:*c\\:\\\\users\\\\* and file.path:*\\\\appdata\\\\local\\\\microsoft\\\\office\\\\* and file.path:*\\\\webservicecache\\\\allusers* and file.path:*.com))))
<li><a href="#">query: ((process.executable:*\\/arp and process.command_line:*\\-a*) or (process.executable:*\\/ping and process.command_line:(*\\ 10.* or *\\ 192.168.* or *\\ 172.16.* or *\\ 172.17.* or *\\ 172.18.* or *\\ 172.19.* or *\\ 172.20.* or *\\ 172.21.* or *\\ 172.22.* or *\\ 172.23.* or *\\ 172.24.* or *\\ 172.25.* or *\\ 172.26.* or *\\ 172.27.* or *\\ 172.28.* or *\\ 172.29.* or *\\ 172.30.* or *\\ 172.31.* or *\\ 127.* or *\\ 169.254.*)))
<li><a href="#">query: ((process.executable:*\\/dscacheutil and process.command_line:*\\-q* and process.command_line:*group*) or (process.executable:*\\/cat and process.command_line:*\\/etc\\/group*) or (process.executable:*\\/dscl and process.command_line:*\\-list* and process.command_line:*\\/groups*))
<li><a href="#">query: ((process.executable:*\\/dscl and process.command_line:*list* and process.command_line:*\\/users*) or (process.executable:*\\/dscacheutil and process.command_line:*\\-q* and process.command_line:*user*) or process.command_line:*'x\\:0\\:'* or (process.executable:*\\/cat and process.command_line:(*\\/etc\\/passwd* or *\\/etc\\/sudoers*)) or process.executable:*\\/id or (process.executable:*\\/lsof and process.command_line:*\\-u*))
<li><a href="#">query: ((process.executable:*\\/file and process.command_line:/(.){200,}/) or (process.executable:*\\/ls and process.command_line:*\\-r*) or process.executable:*\\/find or process.executable:*\\/tree)
<li><a href="#">query: ((process.executable:*\\/grep and process.command_line:*password*) or process.command_line:*lazagne*)
<li><a href="#">query: ((process.executable:*\\/service and process.command_line:*iptables* and process.command_line:*stop*) or (process.executable:*\\/service and process.command_line:*ip6tables* and process.command_line:*stop*) or (process.executable:*\\/chkconfig and process.command_line:*iptables* and process.command_line:*stop*) or (process.executable:*\\/chkconfig and process.command_line:*ip6tables* and process.command_line:*stop*) or (process.executable:*\\/systemctl and process.command_line:*firewalld* and process.command_line:*stop*) or (process.executable:*\\/systemctl and process.command_line:*firewalld* and process.command_line:*disable*) or (process.executable:*\\/service and process.command_line:*cbdaemon* and process.command_line:*stop*) or (process.executable:*\\/chkconfig and process.command_line:*cbdaemon* and process.command_line:*off*) or (process.executable:*\\/systemctl and process.command_line:*cbdaemon* and process.command_line:*stop*) or (process.executable:*\\/systemctl and process.command_line:*cbdaemon* and process.command_line:*disable*) or (process.executable:*\\/setenforce and process.command_line:*0*) or (process.executable:*\\/systemctl and process.command_line:*stop* and process.command_line:*falcon\\-sensor*) or (process.executable:*\\/systemctl and process.command_line:*disable* and process.command_line:*falcon\\-sensor*))
<li><a href="#">query: ((process.executable:*\\/truncate and process.command_line:*\\-s*) or ((process.executable:*\\/dd and process.command_line:*if\\=*) and (not (process.command_line:*of\\=*))))
<li><a href="#">query: ((process.executable:*\\\\adplus.exe or winlog.event_data.originalfilename:\"adplus.exe\") and process.command_line:(*\\ \\-hang\\ * or *\\ \\-pn\\ * or *\\ \\-pmn\\ * or *\\ \\-p\\ * or *\\ \\-po\\ * or *\\ \\-c\\ * or *\\ \\-sc\\ *))
<li><a href="#">query: ((process.executable:*\\\\attrib.exe and process.command_line:*\\ \\+h\\ *) and (not ((process.command_line:*\\\\desktop.ini\\ * or (process.parent.executable:*\\\\cmd.exe and process.command_line:\\+r\\ \\+h\\ \\+s\\ \\+a\\ \\\\*.cui and process.parent.command_line:c\\:\\\\windows\\\\system32\\\\*.bat)))))
<li><a href="#">query: ((process.executable:*\\\\attrib.exe and process.command_line:*\\ \\+s* and process.command_line:(*\\ %* or *\\\\users\\\\public\\\\* or *\\\\appdata\\\\local\\\\* or *\\\\programdata\\\\* or *\\\\downloads\\\\* or *\\\\windows\\\\temp\\\\*) and process.command_line:(*.bat* or *.ps1* or *.vbe* or *.vbs* or *.exe*)) and (not (process.command_line:*\\\\windows\\\\temp\\\\* and process.command_line:*.exe*)))
<li><a href="#">query: ((process.executable:*\\\\bcdedit.exe and process.command_line:*set*) and ((process.command_line:*bootstatuspolicy* and process.command_line:*ignoreallfailures*) or (process.command_line:*recoveryenabled* and process.command_line:*no*)))
<li><a href="#">query: ((process.executable:*\\\\bitsadmin.exe and ((process.command_line:(*\\ \\/create\\ * or *\\ \\/addfile\\ *) and process.command_line:*http*) or process.command_line:*\\ \\/transfer\\ *)) or process.command_line:*copy\\ bitsadmin.exe*)
<li><a href="#">query: ((process.executable:*\\\\cdb.exe or winlog.event_data.originalfilename:\"cdb.exe\") and process.command_line:(*\\ \\-c\\ * or *\\ \\-cf\\ *))
<li><a href="#">query: ((process.executable:*\\\\certreq.exe or winlog.event_data.originalfilename:\"certreq.exe\") and (process.command_line:*\\ \\-post\\ * and process.command_line:*\\ \\-config\\ * and process.command_line:*\\ http* and process.command_line:*\\ c\\:\\\\windows\\\\win.ini\\ *))
<li><a href="#">query: ((process.executable:*\\\\cmd.exe and process.command_line:*>\\ * and process.command_line:*\\:*) and (not (process.command_line:*\\:\\\\*)))
<li><a href="#">query: ((process.executable:*\\\\cmd.exe and process.command_line:*sc\\ config* and process.command_line:*wercplsupporte.dll*) or (process.executable:*\\\\wmic.exe and process.command_line:*cor_profiler))
<li><a href="#">query: ((process.executable:*\\\\cmd.exe and process.parent.executable:*\\\\7zfm.exe) and (not ((process.command_line:*\\ \\/c\\ *) or (not _exists_:process.command_line))))
<li><a href="#">query: ((process.executable:*\\\\cmdkey.exe or winlog.event_data.originalfilename:\"cmdkey.exe\") and process.command_line:(*\\ \\/l* or *\\ \\-l*))
<li><a href="#">query: ((process.executable:*\\\\cmdl32.exe or winlog.event_data.originalfilename:\"cmdl32.exe\") and (process.command_line:*\\/vpn\\ * and process.command_line:*\\/lan\\ *))
<li><a href="#">query: ((process.executable:*\\\\cmstp.exe or winlog.event_data.originalfilename:\"cmstp.exe\") and process.command_line:(*\\/s* or *\\/au*))
<li><a href="#">query: ((process.executable:*\\\\control.exe and process.parent.executable:(*\\\\winword.exe or *\\\\powerpnt.exe or *\\\\excel.exe)) and (not (process.command_line:(*\\\\control.exe\\ input.dll or *\\\\control.exe\\\"\\ input.dll))))
<li><a href="#">query: ((process.executable:*\\\\control.exe and process.parent.executable:(*\\\\winword.exe or *\\\\powerpnt.exe or *\\\\excel.exe)) and (not (process.command_line:*\\\\control.exe\\ input.dll)))
<li><a href="#">query: ((process.executable:*\\\\control.exe and process.parent.executable:*\\\\workfolders.exe) and (not (process.executable:\"c\\:\\\\windows\\\\system32\\\\control.exe\")))
<li><a href="#">query: ((process.executable:*\\\\createdump.exe and process.command_line:*\\ \\-u\\ * and process.command_line:*\\ \\-f\\ *) or (process.command_line:*\\ \\-u\\ \\-f\\ * and process.command_line:*.dmp\\ *))
<li><a href="#">query: ((process.executable:*\\\\csc.exe and process.command_line:(*\\\\appdata\\\\* or *\\\\windows\\\\temp\\\\*)) and (not (process.parent.executable:c\\:\\\\program\\ files* or process.parent.executable:(*\\\\sdiagnhost.exe or *\\\\w3wp.exe or *\\\\choco.exe) or process.parent.command_line:*\\\\programdata\\\\microsoft\\\\windows\\ defender\\ advanced\\ threat\\ protection*)))
<li><a href="#">query: ((process.executable:*\\\\cscript.exe or winlog.event_data.originalfilename:\"cscript.exe\") and (process.command_line:*winrm* and process.command_line:*invoke\\ create\\ wmicimv2\\/win32_* and process.command_line:*\\-r\\:http*))
<li><a href="#">query: ((process.executable:*\\\\csi.exe or process.executable:*\\\\rcsi.exe or winlog.event_data.originalfilename:\"csi.exe\" or winlog.event_data.originalfilename:\"rcsi.exe\") and company:\"microsoft\\ corporation\")
<li><a href="#">query: ((process.executable:*\\\\curl.exe or product:\"the\\ curl\\ executable\") and process.command_line:(*\\ \\-a\\ * or *\\ \\-\\-user\\-agent\\ *))
<li><a href="#">query: ((process.executable:*\\\\curl.exe or product:\"the\\ curl\\ executable\") and process.command_line:(*\\ start\\ * or *&call\\ * or *&\\ call\\ *))
<li><a href="#">query: ((process.executable:*\\\\curl.exe or product:\"the\\ curl\\ executable\") and process.command_line:*\\ \\-o\\ *)
<li><a href="#">query: ((process.executable:*\\\\dism.exe and file.path:*\\\\dismcore.dll) and (not (file.path:\"c\\:\\\\windows\\\\system32\\\\dism\\\\dismcore.dll\")))
<li><a href="#">query: ((process.executable:*\\\\dismhost.exe and process.parent.command_line:*\\/online* and process.parent.command_line:*\\/disable\\-feature* and process.parent.command_line:*\\/featurename\\:* and process.parent.command_line:*\\/remove*) or (process.executable:*\\\\dism.exe and process.command_line:*\\/online* and process.command_line:*\\/disable\\-feature* and process.command_line:*\\/featurename\\:* and process.command_line:*\\/remove*))
<li><a href="#">query: ((process.executable:*\\\\dllhost.exe and winlog.event_data.initiated:\"true\") and (not ((destination.ip:(10.* or 192.168.* or 172.16.* or 172.17.* or 172.18.* or 172.19.* or 172.20.* or 172.21.* or 172.22.* or 172.23.* or 172.24.* or 172.25.* or 172.26.* or 172.27.* or 172.28.* or 172.29.* or 172.30.* or 172.31.* or 169.254.* or 127.*)) or (destination.ip:(\\:\\:1* or 0\\:0\\:0\\:0\\:0\\:0\\:0\\:1* or fe80\\:* or fc* or fd*)))))
<li><a href="#">query: ((process.executable:*\\\\dllhost.exe and winlog.event_data.initiated:\"true\") and (not ((destination.ip:(10.* or 192.168.* or 172.16.* or 172.17.* or 172.18.* or 172.19.* or 172.20.* or 172.21.* or 172.22.* or 172.23.* or 172.24.* or 172.25.* or 172.26.* or 172.27.* or 172.28.* or 172.29.* or 172.30.* or 172.31.*)) or (destination.ip:\"0\\:0\\:0\\:0\\:0\\:0\\:0\\:1\"))))
<li><a href="#">query: ((process.executable:*\\\\dtrace.exe and process.command_line:*lkd\\(0\\)*) or (process.command_line:*syscall\\:\\:\\:return* and process.command_line:*lkd\\(*))
<li><a href="#">query: ((process.executable:*\\\\dxcap.exe or originalfilename:\"dxcap.exe\") and process.command_line:*\\ \\-c\\ *)
<li><a href="#">query: ((process.executable:*\\\\esentutl.exe and process.command_line:(*vss* or *\\ \\/m\\ * or *\\ \\/y\\ *)) or process.command_line:(*\\\\windows\\\\ntds\\\\ntds.dit* or *\\\\config\\\\sam* or *\\\\config\\\\security* or *\\\\config\\\\system\\ * or *\\\\repair\\\\sam* or *\\\\repair\\\\system* or *\\\\repair\\\\security* or *\\\\config\\\\regback\\\\sam* or *\\\\config\\\\regback\\\\system* or *\\\\config\\\\regback\\\\security*))
<li><a href="#">query: ((process.executable:*\\\\excel.exe and winlog.event_data.initiated:\"true\" and destinationisipv6:\"false\") and (not (destination.ip:(10.* or 192.168.* or 172.16.* or 172.17.* or 172.18.* or 172.19.* or 172.20.* or 172.21.* or 172.22.* or 172.23.* or 172.24.* or 172.25.* or 172.26.* or 172.27.* or 172.28.* or 172.29.* or 172.30.* or 172.31.* or 127.0.0.1*) and destinationisipv6:\"false\")))
<li><a href="#">query: ((process.executable:*\\\\excel.exe and winlog.event_data.initiated:\"true\" and destinationisipv6:\"false\") and (not (destination.ip:(10.* or 192.168.* or 172.16.* or 172.17.* or 172.18.* or 172.19.* or 172.20.* or 172.21.* or 172.22.* or 172.23.* or 172.24.* or 172.25.* or 172.26.* or 172.27.* or 172.28.* or 172.29.* or 172.30.* or 172.31.* or 127.0.0.1*))))
<li><a href="#">query: ((process.executable:*\\\\explorer.exe and process.command_line:*\\/nouaccheck*) and (not ((process.parent.command_line:\"c\\:\\\\windows\\\\system32\\\\svchost.exe\\ \\-k\\ netsvcs\\ \\-p\\ \\-s\\ schedule\" or process.parent.executable:\"c\\:\\\\windows\\\\system32\\\\svchost.exe\"))))
<li><a href="#">query: ((process.executable:*\\\\forfiles.exe or winlog.event_data.originalfilename:\"forfiles.exe\") and process.command_line:(*\\ \\/p\\ * or *\\ \\-p\\ *) and process.command_line:(*\\ \\/m\\ * or *\\ \\-m\\ *) and process.command_line:(*\\ \\/c\\ * or *\\ \\-c\\ *))
<li><a href="#">query: ((process.executable:*\\\\format.com and process.command_line:*\\/fs\\:*) and (not ((process.command_line:(*\\/fs\\:fat* or *\\/fs\\:exfat* or *\\/fs\\:ntfs* or *\\/fs\\:udf* or *\\/fs\\:refs*)))))
<li><a href="#">query: ((process.executable:*\\\\fsutil.exe or winlog.event_data.originalfilename:\"fsutil.exe\") and process.command_line:(*deletejournal* or *createjournal*))
<li><a href="#">query: ((process.executable:*\\\\fsutil.exe or winlog.event_data.originalfilename:\"fsutil.exe\") and process.command_line:*drives*)
<li><a href="#">query: ((process.executable:*\\\\fxssvc.exe and file.path:*ualapi.dll) and (not (file.path:c\\:\\\\windows\\\\winsxs\\\\*)))
<li><a href="#">query: ((process.executable:*\\\\gfxdownloadwrapper.exe and (not (process.command_line:*gameplayapi.intel.com*))) and (not (process.parent.executable:*\\\\gfxdownloadwrapper.exe)))
<li><a href="#">query: ((process.executable:*\\\\mpiexec.exe or winlog.event_data.imphash:\"d8b52ef6aaa3a81501bdfff9dbb96217\" or winlog.event_data.hashes:*imphash\\=d8b52ef6aaa3a81501bdfff9dbb96217*) and process.command_line:(*\\ \\/n\\ 1\\ * or *\\ \\-n\\ 1\\ *))
<li><a href="#">query: ((process.executable:*\\\\mpiexec.exe or winlog.event_data.imphash:\"d8b52ef6aaa3a81501bdfff9dbb96217\") and process.command_line:(*\\ \\/n\\ 1\\ * or *\\ \\-n\\ 1\\ *))
<li><a href="#">query: ((process.executable:*\\\\msdt.exe and process.command_line:*\\\\windows\\\\diagnostics\\\\index\\\\pcwdiagnostic.xml* and process.command_line:(*\\ \\-af\\ * or *\\ \\/af\\ *)) and (not (process.parent.executable:*\\\\pcwrun.exe)))
<li><a href="#">query: ((process.executable:*\\\\msdt.exe or winlog.event_data.originalfilename:\"msdt.exe\") and (process.command_line:*\\/cab* and process.command_line:*.diagcab*))
<li><a href="#">query: ((process.executable:*\\\\msdt.exe or winlog.event_data.originalfilename:\"msdt.exe\") and (process.command_line:*it_browseforfile\\=* or (process.command_line:*\\ pcwdiagnostic* and process.command_line:(*\\ \\/af\\ * or *\\ \\-af\\ *))))
<li><a href="#">query: ((process.executable:*\\\\msdt.exe or winlog.event_data.originalfilename:\"msdt.exe\") and process.command_line:(*\\ \\/cab\\ * or *\\ \\-cab\\ *))
<li><a href="#">query: ((process.executable:*\\\\msiexec.exe and process.command_line:*\\ \\/y*) and (not ((process.command_line:(*\\\\msiexec.exe\\\"\\ \\/y\\ \\\"c\\:\\\\program\\ files\\\\bonjour\\\\mdnsnsp.dll* or *\\\\msiexec.exe\\\"\\ \\/y\\ \\\"c\\:\\\\program\\ files\\ \\(x86\\)\\\\bonjour\\\\mdnsnsp.dll* or *\\\\msiexec.exe\\\"\\ \\/y\\ \\\"c\\:\\\\program\\ files\\ \\(x86\\)\\\\apple\\ software\\ update\\\\scriptingobjectmodel.dll* or *\\\\msiexec.exe\\\"\\ \\/y\\ \\\"c\\:\\\\program\\ files\\ \\(x86\\)\\\\apple\\ software\\ update\\\\softwareupdateadmin.dll*)))))
<li><a href="#">query: ((process.executable:*\\\\mstsc.exe and process.command_line:*\\ \\/v\\:*) or (process.executable:*\\\\cmdkey.exe and process.command_line:*\\/generic\\:* and process.command_line:*\\/user\\:* and process.command_line:*\\/pass\\:*))
<li><a href="#">query: ((process.executable:*\\\\netsh.exe and process.command_line:*firewall* and process.command_line:*add* and (process.command_line:*allowedprogram* or (process.command_line:*advfirewall* and process.command_line:*rule* and process.command_line:*action\\=allow* and process.command_line:*program\\=*))) and (process.command_line:(*%temp%* or *\\:\\\\recycler\\\\* or *c\\:\\\\$recycle.bin\\\\* or *\\:\\\\systemvolumeinformation\\\\* or *c\\:\\\\windows\\\\temp\\\\* or *c\\:\\\\temp\\\\* or *c\\:\\\\users\\\\public\\\\* or *c\\:\\\\users\\\\default\\\\* or *c\\:\\\\users\\\\desktop\\\\* or *\\\\downloads\\\\* or *\\\\temporary\\ internet\\ files\\\\content.outlook\\\\* or *\\\\local\\ settings\\\\temporary\\ internet\\ files\\\\*) or process.command_line:(c\\:\\\\windows\\\\tasks\\\\* or c\\:\\\\windows\\\\debug\\\\* or c\\:\\\\windows\\\\fonts\\\\* or c\\:\\\\windows\\\\help\\\\* or c\\:\\\\windows\\\\drivers\\\\* or c\\:\\\\windows\\\\addins\\\\* or c\\:\\\\windows\\\\cursors\\\\* or c\\:\\\\windows\\\\system32\\\\tasks\\\\* or %public%\\\\*)))
<li><a href="#">query: ((process.executable:*\\\\netsh.exe and process.command_line:*firewall* and process.command_line:*add*) and (not ((process.command_line:(*\\\\netsh.exe\\ advfirewall\\ firewall\\ add\\ rule\\ name\\=dropbox\\ dir\\=in\\ action\\=allow\\ \\\"program\\=c\\:\\\\program\\ files\\ \\(x86\\)\\\\dropbox\\\\client\\\\dropbox.exe\\\"\\ enable\\=yes\\ profile\\=any* or *\\\\netsh.exe\\ advfirewall\\ firewall\\ add\\ rule\\ name\\=dropbox\\ dir\\=in\\ action\\=allow\\ \\\"program\\=c\\:\\\\program\\ files\\\\dropbox\\\\client\\\\dropbox.exe\\\"\\ enable\\=yes\\ profile\\=any*)))))
<li><a href="#">query: ((process.executable:*\\\\nltest.exe and process.command_line:(*domain_trusts* or *all_trusts* or *\\/trusted_domains* or *\\/dclist*)) or (process.executable:*\\\\dsquery.exe and process.command_line:*trusteddomain*) or (process.executable:*\\\\dsquery.exe and process.command_line:*\\-filter* and process.command_line:*trusteddomain*))
<li><a href="#">query: ((process.executable:*\\\\odbcconf.exe and process.command_line:(*\\-f* or *regsvr*)) or (process.parent.executable:*\\\\odbcconf.exe and process.executable:*\\\\rundll32.exe))
<li><a href="#">query: ((process.executable:*\\\\powershell.exe and (process.command_line:/.*\\+.*\\+.*\\+.*\\+.*\\+.*\\+.*\\+.*\\+.*\\+.*\\+.*\\+.*\\+.*\\+.*\\+.*/ or process.command_line:/.*\\{.*\\{.*\\{.*\\{.*\\{.*\\{.*\\{.*\\{.*\\{.*\\{.*/ or process.command_line:/.*{.*{.*{.*{.*{.*/ or process.command_line:/.*\\^.*\\^.*\\^.*\\^.*\\^.*/ or process.command_line:/.*`.*`.*`.*`.*`.*/)) and (not (process.parent.executable:\"c\\:\\\\program\\ files\\\\amazon\\\\ssm\\\\ssm\\-document\\-worker.exe\")))
<li><a href="#">query: ((process.executable:*\\\\powershell.exe and process.command_line:(*\\ \\-e\\ * or *\\ \\-en\\ * or *\\ \\-enc\\ * or *\\ \\-enco* or *\\ \\-ec\\ *)) and (not (process.command_line:*\\ \\-encoding\\ *)))
<li><a href="#">query: ((process.executable:*\\\\powershell.exe and process.command_line:(*\\-disablebehaviormonitoring\\ $true* or *\\-disableruntimemonitoring\\ $true*)) or (process.command_line:*sc* and process.command_line:*stop* and process.command_line:*windefend*) or (process.command_line:*sc* and process.command_line:*config* and process.command_line:*windefend* and process.command_line:*start\\=disabled*))
<li><a href="#">query: ((process.executable:*\\\\powershell.exe and process.command_line:(*hctac* or *kearb* or *dnammoc* or *ekovn* or *elifd* or *rahc* or *etirw* or *golon* or *tninon* or *eddih* or *tpircs* or *ssecorp* or *llehsrewop* or *esnopser* or *daolnwod* or *tneilcbew* or *tneilc* or *ptth* or *elifotevas* or *46esab* or *htappmetteg* or *tcejbo* or *maerts* or *hcaerof* or *ekovni* or *retupmoc*)) and (not ((process.command_line:*\\-encodedcommand*))))
<li><a href="#">query: ((process.executable:*\\\\powershell.exe and process.command_line:*pester* and process.command_line:*get\\-help*) or (process.executable:*\\\\cmd.exe and process.command_line:*pester* and process.command_line:*;* and process.command_line:(*help* or *?*)))
<li><a href="#">query: ((process.executable:*\\\\powershell.exe and winlog.event_data.initiated:\"true\" and destinationisipv6:\"false\") and (not (destination.ip:(10.* or 192.168.* or 172.16.* or 172.17.* or 172.18.* or 172.19.* or 172.20.* or 172.21.* or 172.22.* or 172.23.* or 172.24.* or 172.25.* or 172.26.* or 172.27.* or 172.28.* or 172.29.* or 172.30.* or 172.31.* or 127.0.0.1*) and user.name:(*authori* or *autori*))))
<li><a href="#">query: ((process.executable:*\\\\print.exe and process.command_line:print* and process.command_line:*\\/d* and process.command_line:*.exe*) and (not (process.command_line:*print.exe*)))
<li><a href="#">query: ((process.executable:*\\\\rasautou.exe or winlog.event_data.originalfilename:\"rasdlui.exe\") and (process.command_line:*\\-d* and process.command_line:*\\-p*))
<li><a href="#">query: ((process.executable:*\\\\reg.exe and process.command_line:*\\ query\\ * and process.command_line:*\\/t\\ * and process.command_line:*reg_sz* and process.command_line:*\\/s*) and ((process.command_line:*\\/f\\ * and process.command_line:*hklm*) or (process.command_line:*\\/f\\ * and process.command_line:*hkcu*) or process.command_line:*hkcu\\\\software\\\\simontatham\\\\putty\\\\sessions*))
<li><a href="#">query: ((process.executable:*\\\\regedit.exe and process.command_line:(*\\ \\/e\\ * or *\\ \\-e\\ *)) and (not ((process.command_line:(*hklm* or *hkey_local_machine*)) and (process.command_line:(*\\\\system or *\\\\sam or *\\\\security)))))
<li><a href="#">query: ((process.executable:*\\\\regedit.exe and process.command_line:(*\\ \\/i\\ * or *.reg*) and process.command_line:/:[\\\\\\\\]/) and (not (process.command_line:(*\\ \\/e\\ * or *\\ \\/a\\ * or *\\ \\/c\\ *))))
<li><a href="#">query: ((process.executable:*\\\\regedit.exe and process.command_line:*\\ \\/e\\ *) and (not ((process.command_line:(*hklm* or *hkey_local_machine*) and process.command_line:(*\\\\system or *\\\\sam or *\\\\security)))))
<li><a href="#">query: ((process.executable:*\\\\regsvr32.exe and process.command_line:*\\ \\/i\\:*) and (not (process.command_line:*\\ \\/n\\ *)))
<li><a href="#">query: ((process.executable:*\\\\regsvr32.exe and process.command_line:*\\\\temp\\\\*) or (process.executable:*\\\\regsvr32.exe and process.parent.executable:*\\\\powershell.exe) or (process.executable:*\\\\regsvr32.exe and process.parent.executable:*\\\\cmd.exe) or (process.executable:*\\\\regsvr32.exe and process.command_line:*\\/i\\:* and process.command_line:(*http* or *ftp*) and process.command_line:*scrobj.dll) or (process.executable:*\\\\wscript.exe and process.parent.executable:*\\\\regsvr32.exe) or (process.executable:*\\\\excel.exe and process.command_line:*..\\\\..\\\\..\\\\windows\\\\system32\\\\regsvr32.exe\\ *) or (process.parent.executable:*\\\\mshta.exe and process.executable:*\\\\regsvr32.exe) or (process.executable:*\\\\regsvr32.exe and process.command_line:(*\\\\appdata\\\\local* or *c\\:\\\\users\\\\public*)))
<li><a href="#">query: ((process.executable:*\\\\rpcping.exe and process.command_line:(*\\-s* or *\\/s*)) and ((process.command_line:*\\-u* and process.command_line:*ntlm*) or (process.command_line:*\\/u* and process.command_line:*ntlm*) or (process.command_line:*\\-t* and process.command_line:*ncacn_np*) or (process.command_line:*\\/t* and process.command_line:*ncacn_np*)))
<li><a href="#">query: ((process.executable:*\\\\rundll32.exe and process.command_line:(*,#* or *,\\ #* or *.dll\\ #*)) and (not (process.command_line:*edgehtml.dll* and process.command_line:*#141*)))
<li><a href="#">query: ((process.executable:*\\\\rundll32.exe and process.command_line:*,dll_u) or process.command_line:*\\ \\-export\\ dll_u\\ *)
<li><a href="#">query: ((process.executable:*\\\\rundll32.exe and winlog.event_data.initiated:\"true\") and (not ((destination.ip:(10.* or 192.168.* or 172.16.* or 172.17.* or 172.18.* or 172.19.* or 172.20.* or 172.21.* or 172.22.* or 172.23.* or 172.24.* or 172.25.* or 172.26.* or 172.27.* or 172.28.* or 172.29.* or 172.30.* or 172.31.* or 127.*) or process.command_line:*pcasvc.dll,pcapatchsdbtask*) or (destination.ip:51.124.*))))
<li><a href="#">query: ((process.executable:*\\\\rundll32.exe or winlog.event_data.description:*windows\\-hostprozess\\ \\(rundll32\\)*) and process.command_line:(*default.getstring* or *frombase64string*))
<li><a href="#">query: ((process.executable:*\\\\rundll32.exe or winlog.event_data.originalfilename:\"rundll32.exe\") and (process.command_line:*comsvcs* and process.command_line:*minidump* and process.command_line:*full*))
<li><a href="#">query: ((process.executable:*\\\\rundll32.exe or winlog.event_data.originalfilename:\"rundll32.exe\") and process.command_line:*c\\:\\\\windows\\\\system32\\\\davclnt.dll,davsetcookie*)
<li><a href="#">query: ((process.executable:*\\\\runonce.exe or winlog.event_data.description:\"run\\ once\\ wrapper\") and process.command_line:*\\ \\/alternateshellstartup*)
<li><a href="#">query: ((process.executable:*\\\\sc.exe and integritylevel:\"medium\") and ((process.command_line:*config* and process.command_line:*binpath*) or (process.command_line:*failure* and process.command_line:*command*)))
<li><a href="#">query: ((process.executable:*\\\\sc.exe and process.command_line:*create* and process.command_line:*binpath*) or (process.command_line:*new\\-service* and process.command_line:*\\-binarypathname*))
<li><a href="#">query: ((process.executable:*\\\\sc.exe and process.command_line:*create* and process.command_line:*binpath*) or (process.executable:*\\\\powershell.exe and process.command_line:*new\\-service*))
<li><a href="#">query: ((process.executable:*\\\\sc.exe or winlog.event_data.originalfilename:\"sc.exe\") and (process.command_line:*sdset* and process.command_line:*dclcwpdtsd*))
<li><a href="#">query: ((process.executable:*\\\\schtasks.exe and process.command_line:*\\ \\/create\\ *) and (not (user.name:(nt\\ authority\\\\system* or autorite\\ nt\\\\sys*))))
<li><a href="#">query: ((process.executable:*\\\\schtasks.exe and process.command_line:*\\/create\\ * and process.command_line:*\\\\appdata\\\\local\\\\temp*) and (not ((process.command_line:*\\/create\\ \\/tn\\ \\\"klcp_update\\\"\\ \\/xml\\ * and process.command_line:*\\\\klcp_update_task.xml*))))
<li><a href="#">query: ((process.executable:*\\\\schtasks.exe and process.command_line:*\\/create\\ * and process.parent.executable:(*\\\\appdata\\\\local\\\\* or *\\\\appdata\\\\roaming\\\\* or *\\\\temporary\\ internet* or *\\\\users\\\\public\\\\*)) and (not ((process.command_line:(*update_task.xml* or *unattended.ini*)))))
<li><a href="#">query: ((process.executable:*\\\\schtasks.exe and process.command_line:*\\/create\\ *) and ((process.command_line:(*\\/sc\\ minute\\ * or *\\/ru\\ system\\ *) and process.command_line:(*cmd.exe\\ \\/c\\ * or *cmd\\ \\/c*)) or process.command_line:(*\\ bypass\\ * or *.downloadstring* or *.downloadfile* or *frombase64string* or *\\ \\-w\\ hidden\\ * or *\\ iex* or *\\ \\-enc\\ * or *\\ \\-decode\\ * or *\\/c\\ start\\ \\/min\\ * or *\\ curl\\ *) or (process.command_line:*\\/xml\\ c\\:\\\\users\\\\* and process.command_line:*\\\\appdata\\\\local\\\\*) or (process.command_line:*wscript.exe* and process.command_line:*\\\\appdata\\\\*)))
<li><a href="#">query: ((process.executable:*\\\\schtasks.exe* and process.command_line:(*wscript* or *vbscript* or *cscript* or *wmic\\ * or *wmic.exe* or *regsvr32.exe* or *powershell* or *\\\\appdata\\\\*)) and ((process.command_line:*once* and process.command_line:*00\\:00*) or process.command_line:*joke*))
<li><a href="#">query: ((process.executable:*\\\\scriptrunner.exe or winlog.event_data.originalfilename:\"scriptrunner.exe\") and process.command_line:*\\ \\-appvscript\\ *)
<li><a href="#">query: ((process.executable:*\\\\sdbinst.exe and process.command_line:*.sdb*) and (not (process.command_line:*iisexpressshim.sdb*)))
<li><a href="#">query: ((process.executable:*\\\\setspn.exe or (winlog.event_data.description:*query\\ or\\ reset\\ the\\ computer* and winlog.event_data.description:*spn\\ attribute*)) and process.command_line:*\\-q*)
<li><a href="#">query: ((process.executable:*\\\\sqlps.exe or process.parent.executable:*\\\\sqlps.exe or winlog.event_data.originalfilename:\"\\\\sqlps.exe\") and (not (process.parent.executable:*\\\\sqlagent.exe)))
<li><a href="#">query: ((process.executable:*\\\\sqlps.exe or process.parent.executable:*\\\\sqlps.exe) or (winlog.event_data.originalfilename:\"\\\\sqlps.exe\" and (not (process.parent.executable:*\\\\sqlagent.exe))))
<li><a href="#">query: ((process.executable:*\\\\sqltoolsps.exe or process.parent.executable:*\\\\sqltoolsps.exe or winlog.event_data.originalfilename:\"\\\\sqltoolsps.exe\") and (not (process.parent.executable:*\\\\smss.exe)))
<li><a href="#">query: ((process.executable:*\\\\sqltoolsps.exe or process.parent.executable:*\\\\sqltoolsps.exe) or (winlog.event_data.originalfilename:\"\\\\sqltoolsps.exe\" and (not (process.parent.executable:*\\\\smss.exe))))
<li><a href="#">query: ((process.executable:*\\\\svchost.exe and file.path:(*\\\\tsmsisrv.dll or *\\\\tsvipsrv.dll or *\\\\wlbsctrl.dll)) and (not (file.path:c\\:\\\\windows\\\\winsxs\\\\*)))
<li><a href="#">query: ((process.executable:*\\\\svchost.exe and process.command_line:*c\\:\\\\users\\\\* and process.command_line:*\\\\desktop\\\\*) or (process.parent.executable:*\\\\svchost.exe and ((process.executable:*\\\\whoami.exe and process.command_line:*all*) or (process.executable:(*\\\\net.exe or *\\\\net1.exe) and process.command_line:*view*))))
<li><a href="#">query: ((process.executable:*\\\\svchost.exe and winlog.event_data.initiated:\"true\" and source.port:\"3389\") and (destination.ip:127.* or destination.ip:\"\\:\\:1\"))
<li><a href="#">query: ((process.executable:*\\\\taskkill.exe or winlog.event_data.originalfilename:\"taskkill.exe\") and (process.command_line:*\\ \\/f* and process.command_line:*\\ \\/im\\ *))
<li><a href="#">query: ((process.executable:*\\\\tracker.exe or winlog.event_data.description:\"tracker\") and process.command_line:*\\ \\/d\\ * and process.command_line:*\\ \\/c\\ *)
<li><a href="#">query: ((process.executable:*\\\\tshark.exe and process.command_line:*\\-i*) or process.executable:*\\\\windump.exe)
<li><a href="#">query: ((process.executable:*\\\\update.exe and process.command_line:(*\\-\\-processstart* or *\\-\\-processstartandwait* or *\\-\\-createshortcut*) and process.command_line:*.exe*) and (not ((process.command_line:*c\\:\\\\users\\\\* and process.command_line:*\\\\appdata\\\\local\\\\discord\\\\update.exe* and process.command_line:*\\ \\-\\-processstart\\ discord.exe*))))
<li><a href="#">query: ((process.executable:*\\\\vaultcmd.exe or winlog.event_data.originalfilename:\"vaultcmd.exe\") and process.command_line:*\\/listcreds\\:*)
<li><a href="#">query: ((process.executable:*\\\\verclsid.exe or winlog.event_data.originalfilename:\"verclsid.exe\") and (process.command_line:*\\/s* and process.command_line:*\\/c*))
<li><a href="#">query: ((process.executable:*\\\\vsiisexelauncher.exe or winlog.event_data.originalfilename:\"vsiisexelauncher.exe\") and process.command_line:(*\\ \\-p\\ * or *\\ \\-a\\ *))
<li><a href="#">query: ((process.executable:*\\\\wbadmin.exe or process.command_line:*wbadmin*) and (process.command_line:*delete\\ * and process.command_line:*systemstatebackup\\ * and process.command_line:*\\-keepversions\\:0*))
<li><a href="#">query: ((process.executable:*\\\\wbem\\\\wmic.exe or process.command_line:*wmic\\ * or winlog.event_data.originalfilename:\"wmic.exe\" or winlog.event_data.description:\"wmi\\ commandline\\ utility\") and process.command_line:(*regsvr32* or *rundll32* or *msiexec* or *mshta* or *verclsid*) and process.parent.executable:(*\\\\winword.exe or *\\\\excel.exe or *\\\\powerpnt.exe) and process.command_line:*process* and process.command_line:*create* and process.command_line:*call*)
<li><a href="#">query: ((process.executable:*\\\\wbem\\\\wmic.exe or process.command_line:*wmic\\ *) and process.parent.executable:(*\\\\winword.exe or *\\\\excel.exe or *\\\\powerpnt.exe or *\\\\msaccess.exe or *\\\\mspub.exe or *\\\\eqnedt32.exe or *\\\\visio.exe))
<li><a href="#">query: ((process.executable:*\\\\wbem\\\\wmic.exe or process.parent.command_line:*wmic\\ * or winlog.event_data.originalfilename:\"wmic.exe\" or winlog.event_data.description:\"wmi\\ commandline\\ utility\") and process.command_line:(*regsvr32* or *rundll32* or *msiexec* or *mshta* or *verclsid*) and process.parent.executable:(*winword.exe or *excel.exe or *powerpnt.exe) and process.parent.command_line:*process* and process.parent.command_line:*create* and process.parent.command_line:*call*)
<li><a href="#">query: ((process.executable:*\\\\wbem\\\\wmic.exe or process.parent.command_line:*wmic\\ *) and process.parent.executable:(\"winword.exe\" or \"excel.exe\" or \"powerpnt.exe\"))
<li><a href="#">query: ((process.executable:*\\\\werfault.exe and process.command_line:*\\\\werfault.exe) or (process.executable:*\\\\rundll32.exe and process.command_line:*\\\\rundll32.exe) or (process.executable:*\\\\regsvcs.exe and process.command_line:*\\\\regsvcs.exe) or (process.executable:*\\\\regasm.exe and process.command_line:*\\\\regasm.exe) or (process.executable:*\\\\regsvr32.exe and process.command_line:*\\\\regsvr32.exe))
<li><a href="#">query: ((process.executable:*\\\\where.exe or winlog.event_data.originalfilename:\"where.exe\") and process.command_line:(*places.sqlite* or *cookies.sqlite* or *formhistory.sqlite* or *logins.json* or *key4.db* or *key3.db* or *sessionstore.jsonlz4* or *history* or *bookmarks* or *cookies* or *login\\ data*))
<li><a href="#">query: ((process.executable:*\\\\whoami.exe or winlog.event_data.originalfilename:\"whoami.exe\") and process.command_line:*\\/priv*)
<li><a href="#">query: ((process.executable:*\\\\winword.exe and ((file.path:*.cab and file.path:*\\\\windows\\\\inetcache*) or (file.path:*\\\\appdata\\\\local\\\\temp\\\\* and file.path:*.inf*))) and (not (file.path:c\\:\\\\users\\\\* and file.path:*appdata\\\\local\\\\temp* and file.path:*\\\\content.inf)))
<li><a href="#">query: ((process.executable:*\\\\winword.exe or winlog.event_data.originalfilename:\"winword.exe\") and (process.command_line:(*http\\:\\/\\/* or *https\\:\\/\\/*) or process.command_line:(*\\/l\\ * or *.dll*)))
<li><a href="#">query: ((process.executable:*\\\\wmic.exe and process.command_line:(*process* or *qfe*)) and (not (process.command_line:*call* and process.command_line:*create*)))
<li><a href="#">query: ((process.executable:*\\\\wmic.exe and process.command_line:*wmic* and process.command_line:*format* and process.command_line:*http*) or ((winlog.event_data.imphash:(\"1b1a3f43bf37b5bfe60751f2ee2f326e\" or \"37777a96245a3c74eb217308f3546f4c\" or \"9d87c9d67ce724033c0b40cc4ca1b206\") or winlog.event_data.hashes:(*imphash\\=1b1a3f43bf37b5bfe60751f2ee2f326e* or *imphash\\=37777a96245a3c74eb217308f3546f4c* or *imphash\\=9d87c9d67ce724033c0b40cc4ca1b206*)) and (process.command_line:*format\\:* and process.command_line:*http*)))
<li><a href="#">query: ((process.executable:*\\\\wmic.exe or winlog.event_data.originalfilename:\"wmic.exe\") and (process.command_line:*\\/node\\:* and process.command_line:*process* and process.command_line:*call* and process.command_line:*create*))
<li><a href="#">query: ((process.executable:*\\\\wmic.exe or winlog.event_data.originalfilename:\"wmic.exe\") and (process.command_line:*\\/node\\:* and process.command_line:*service*))
<li><a href="#">query: ((process.executable:*\\\\wmic.exe or winlog.event_data.originalfilename:\"wmic.exe\") and process.command_line:*\\ group*)
<li><a href="#">query: ((process.executable:*\\\\wmic.exe or winlog.event_data.originalfilename:\"wmic.exe\") and process.command_line:*call\\ uninstall*)
<li><a href="#">query: ((process.executable:*\\\\wsl.exe or winlog.event_data.originalfilename:\"wsl.exe\") and process.command_line:(*\\ \\-e\\ * or *\\ \\-\\-exec\\ * or *\\ \\-\\-system\\ * or *\\ \\/mnt\\/c*))
<li><a href="#">query: ((process.executable:*\\\\wuauclt.exe or winlog.event_data.originalfilename:\"wuauclt.exe\") and process.command_line:*\\\\wuauclt.exe)
<li><a href="#">query: ((process.executable:*\\\\xcopy.exe and process.command_line:*\\/s* and process.command_line:*\\/e* and process.command_line:*\\/c* and process.command_line:*\\/q* and process.command_line:*\\/h* and process.command_line:*\\\\\\*) or (process.executable:*\\\\adexplorer.exe and process.command_line:*\\-snapshot* and process.command_line:*\\\"\\\"* and process.command_line:*c\\:\\\\users\\\\*))
<li><a href="#">query: ((process.executable:*atbroker.exe and process.command_line:*start*) and (not (process.command_line:(*animations* or *audiodescription* or *caretbrowsing* or *caretwidth* or *colorfiltering* or *cursorscheme* or *filterkeys* or *focusborderheight* or *focusborderwidth* or *highcontrast* or *keyboardcues* or *keyboardpref* or *magnifierpane* or *messageduration* or *minimumhitradius* or *mousekeys* or *narrator* or *osk* or *overlappedcontent* or *showsounds* or *soundsentry* or *stickykeys* or *togglekeys* or *windowarranging* or *windowtracking* or *windowtrackingtimeout* or *windowtrackingzorder*))))
<li><a href="#">query: ((process.executable:*fxssvc.exe and file.path:*ualapi.dll) and (not (file.path:c\\:\\\\windows\\\\winsxs\\\\*)))
<li><a href="#">query: ((process.executable:*schtasks.exe and process.command_line:*\\ \\/create\\ * and process.command_line:(*%appdata%* or *\\\\appdata\\\\local\\\\* or *\\\\appdata\\\\roaming\\\\* or *%public%* or *\\\\users\\\\public* or *c\\:\\\\windows\\\\temp* or *c\\:\\\\perflogs*)) and (not ((process.command_line:*update_task.xml* or process.parent.command_line:*unattended.ini*))))
<li><a href="#">query: ((process.executable:*schtasks.exe and process.command_line:*\\/create\\ * and process.command_line:*\\\\appdata\\\\local\\\\temp*) and (not ((process.command_line:*\\/create\\ \\/tn\\ \\\"klcp_update\\\"\\ \\/xml\\ * and process.command_line:*\\\\klcp_update_task.xml*))))
<li><a href="#">query: ((process.executable:*windows\\\\system32\\\\physmem.sys* or process.executable:(*windows\\\\system32\\\\ime\\\\shared\\\\wimbootconfigurations.ini* or *windows\\\\system32\\\\ime\\\\imejp\\\\wimbootconfigurations.ini* or *windows\\\\system32\\\\ime\\\\imetc\\\\wimbootconfigurations.ini*)) or (process.executable:(*windows\\\\system32\\\\filepath2* or *windows\\\\system32\\\\ime*) and process.command_line:*reg\\ add* and process.command_line:(*hkey_local_machine\\\\software\\\\classes\\\\clsid\\\\\\{7c857801\\-7381\\-11cf\\-884d\\-00aa004b2e24\\}\\\\inprocserver32* or *hkey_local_machine\\\\software\\\\classes\\\\clsid\\\\\\{cf4cc405\\-e2c5\\-4ddd\\-b3ce\\-5e7582d8c9fa\\}\\\\inprocserver32*)))
<li><a href="#">query: ((process.executable:*wlrmdr.exe and process.command_line:*\\-s\\ * and process.command_line:*\\-f\\ * and process.command_line:*\\-t\\ * and process.command_line:*\\-m\\ * and process.command_line:*\\-a\\ * and process.command_line:*\\-u\\ *) and (not (process.parent.executable:\"c\\:\\\\windows\\\\system32\\\\winlogon.exe\")))
<li><a href="#">query: ((process.executable:\"\\/bin\\/launchctl\" and process.command_line:*unload* and process.command_line:(*com.objective\\-see.lulu.plist* or *com.objective\\-see.blockblock.plist* or *com.google.santad.plist* or *com.carbonblack.defense.daemon.plist* or *com.carbonblack.daemon.plist* or *at.obdev.littlesnitchd.plist* or *com.tenablesecurity.nessusagent.plist* or *com.opendns.osx.roamingclientconfigupdater.plist* or *com.crowdstrike.falcond.plist* or *com.crowdstrike.userdaemon.plist* or *osquery* or *filebeat* or *auditbeat* or *packetbeat* or *td\\-agent*)) or (process.executable:\"\\/usr\\/sbin\\/spctl\" and process.command_line:*disable*))
<li><a href="#">query: ((process.executable:\"\\/usr\\/bin\\/file\" and process.command_line:/(.){200,}/) or (process.executable:\"\\/bin\\/ls\" and process.command_line:*\\-r*) or process.executable:\"\\/usr\\/bin\\/find\" or process.executable:\"\\/usr\\/bin\\/mdfind\" or process.executable:\"\\/tree\")
<li><a href="#">query: ((process.executable:\"\\/usr\\/bin\\/security\" and process.command_line:(*find\\-certificate* or *\\ export\\ *)) or process.command_line:(*\\ dump\\-keychain\\ * or *\\ login\\-keychain\\ *))
<li><a href="#">query: ((process.executable:\"\\\\wbem\\\\wmic.exe\" or process.command_line:*wmic\\ * or winlog.event_data.originalfilename:\"wmic.exe\" or winlog.event_data.description:\"wmi\\ commandline\\ utility\") and process.parent.executable:(*\\\\winword.exe or *\\\\excel.exe or *\\\\powerpnt.exe))
<li><a href="#">query: ((process.executable:\"\\\\wbem\\\\wmic.exe\" or process.command_line:*wmic\\ * or winlog.event_data.originalfilename:\"wmic.exe\" or winlog.event_data.description:\"wmi\\ commandline\\ utility\") and process.parent.executable:(*winword.exe or *excel.exe or *powerpnt.exe))
<li><a href="#">query: ((process.executable:\"c\\:\\\\windows\\\\system32\\\\net.exe\" and process.command_line:*net* and process.command_line:*\\ use\\ * and process.command_line:*\\:*\\\\\\* and process.command_line:*\\/user\\:*\\ *) and (not ((process.command_line:*\\ ))))
<li><a href="#">query: ((process.executable:\"c\\:\\\\windows\\\\syswow64\\\\cmd.exe\" and process.command_line:*\\\\windows\\\\caches\\\\navshext.dll\\ *) or process.command_line:*\\\\appdata\\\\roaming\\\\micros\\~1\\\\windows\\\\caches\\\\navshext.dll,setting)
<li><a href="#">query: ((process.executable:c\\:\\\\users\\\\public\\\\* and process.command_line:*\\ \\-single\\ *) or process.command_line:(*del\\ c\\:\\\\windows\\\\system32\\\\taskmgr.exe* or *;set\\-service\\ \\-startuptype\\ disabled\\ $* or *powershell\\ \\-command\\ \\\"$x\\ \\=\\[system.text.encoding\\]\\:\\:unicode.getstring\\(\\[system.convert\\]\\:\\:frombase64string\\(* or *\\ do\\ start\\ wordpad.exe\\ \\/p\\ *))
<li><a href="#">query: ((process.parent.command_line:*\\\\cmd.exe* and process.parent.command_line:*\\/c* and process.parent.command_line:*c\\:\\\\windows\\\\setup\\\\scripts\\\\* and process.parent.command_line:(*setupcomplete.cmd or *partnersetupcomplete.cmd)) and (not (process.executable:(c\\:\\\\windows\\\\system32\\\\* or c\\:\\\\windows\\\\syswow64\\\\* or c\\:\\\\windows\\\\winsxs\\\\* or c\\:\\\\windows\\\\setup\\\\*))))
<li><a href="#">query: ((process.parent.command_line:*\\\\svchost.exe* and process.parent.command_line:*termsvcs*) and (not (process.executable:*\\\\rdpclip.exe)))
<li><a href="#">query: ((process.parent.command_line:*cmd* and process.parent.command_line:*\\/c* and process.command_line:*\\/..\\/..\\/*) and (not ((process.command_line:*\\\\tasktop\\\\keycloak\\\\bin\\\\\\/..\\/..\\/jre\\\\bin\\\\java*))))
<li><a href="#">query: ((process.parent.executable.text:(*\\\\mshta.exe or *\\\\powershell.exe or *\\\\pwsh.exe or *\\\\rundll32.exe or *\\\\cscript.exe or *\\\\wscript.exe or *\\\\wmiprvse.exe or *\\\\regsvr32.exe) and process.executable.text:(*\\\\schtasks.exe or *\\\\nslookup.exe or *\\\\certutil.exe or *\\\\bitsadmin.exe or *\\\\mshta.exe)) and (not ((process.working_directory.text:*\\\\ccmcache\\\\*) or (process.parent.command_line.text:(*\\\\program\\ files\\\\amazon\\\\workspacesconfig\\\\scripts\\\\setup\\-scheduledtask.ps1* or *\\\\program\\ files\\\\amazon\\\\workspacesconfig\\\\scripts\\\\set\\-selfhealing.ps1* or *\\\\program\\ files\\\\amazon\\\\workspacesconfig\\\\scripts\\\\check\\-workspacehealth.ps1* or *\\\\nessus_*)) or (process.command_line.text:*\\\\nessus_*))))
<li><a href="#">query: ((process.parent.executable.text:(*\\\\powershell.exe or *\\\\pwsh.exe or *\\\\powershell_ise.exe) and process.executable.text:(*\\\\sh.exe or *\\\\bash.exe or *\\\\schtasks.exe or *\\\\certutil.exe or *\\\\bitsadmin.exe or *\\\\wscript.exe or *\\\\cscript.exe or *\\\\scrcons.exe or *\\\\regsvr32.exe or *\\\\hh.exe or *\\\\wmic.exe or *\\\\mshta.exe or *\\\\rundll32.exe or *\\\\forfiles.exe or *\\\\scriptrunner.exe)) and (not ((process.parent.command_line.text:*\\\\program\\ files\\\\amazon\\\\workspacesconfig\\\\scripts\\\\* and process.command_line.text:*\\\\program\\ files\\\\amazon\\\\workspacesconfig\\\\scripts\\\\*))))
<li><a href="#">query: ((process.parent.executable.text:(*\\\\w3wp.exe or *\\\\php\\-cgi.exe or *\\\\nginx.exe or *\\\\httpd.exe or *\\\\caddy.exe or *\\\\ws_tomcatservice.exe) or (process.parent.executable.text:(*\\\\java.exe or *\\\\javaw.exe) and process.parent.executable.text:(*\\-tomcat\\-* or *\\\\tomcat*)) or (process.parent.executable.text:(*\\\\java.exe or *\\\\javaw.exe) and process.command_line.text:(*catalina.jar* or *catalina_home*))) and process.command_line.text:(*perl\\ \\-\\-help* or *python\\ \\-\\-help* or *python\\ \\-h* or *python3\\ \\-\\-help* or *python3\\ \\-h* or *wget\\ \\-\\-help* or *perl\\ \\-h*))
<li><a href="#">query: ((process.parent.executable.text:(*\\\\wmiprvse.exe or *\\\\svchost.exe or *\\\\dllhost.exe) and process.executable.text:*\\\\wab.exe) or process.parent.executable.text:*\\\\wab.exe)
<li><a href="#">query: ((process.parent.executable.text:(*\\\\wscript.exe or *\\\\cscript.exe) and process.executable.text:(*\\\\powershell.exe or *\\\\pwsh.exe)) and (not ((process.working_directory.text:*\\\\health\\ service\\ state\\\\*))))
<li><a href="#">query: ((process.parent.executable.text:*\\\\cmd.exe and process.parent.command_line.text:(*\\ \\/c\\ * or *\\ \\/k\\ *) and process.executable.text:*\\\\chcp.com and process.command_line.text:(*chcp or *chcp\\  or *chcp\\ \\ )) and (not ((grandparentcommandline:*\\/c\\ c\\:\\\\programdata\\\\anaconda3*))))
<li><a href="#">query: ((process.parent.executable.text:*\\\\dllhost.exe and process.parent.command_line.text:(*\\/processid\\:\\{3e5fc7f9\\-9a51\\-4367\\-9063\\-a120244fbec7\\}* or *\\/processid\\:\\{d2e7041b\\-2927\\-42fb\\-8e9f\\-7ce93b6dc937\\}*)) and (not (process.executable.text:*\\\\werfault.exe or winlog.event_data.originalfilename:\"werfault.exe\")))
<li><a href="#">query: ((process.parent.executable.text:*\\\\explorer.exe and process.command_line.text:*c\\:\\\\windows\\\\temp\\\\meg.exe*) or (winlog.event_data.originalfilename:\"meg.exe\" and (not (process.executable.text:*\\\\meg.exe))))
<li><a href="#">query: ((process.parent.executable.text:*\\\\gup.exe and process.executable.text:*\\\\explorer.exe) and (not ((process.executable.text:*\\\\explorer.exe and process.command_line.text:*\\\\notepad\\+\\+\\\\notepad\\+\\+.exe*) or (process.parent.executable.text:*\\\\notepad\\+\\+\\\\updater\\\\*) or (not _exists_:process.command_line.text))))
<li><a href="#">query: ((process.parent.executable.text:*\\\\java.exe and process.executable.text:(*\\\\cmd.exe or *\\\\powershell.exe or *\\\\pwsh.exe)) and (not (process.parent.executable.text:*build* and process.command_line.text:*build*)))
<li><a href="#">query: ((process.parent.executable.text:*\\\\razerinstaller.exe and integritylevel:\"system\") and (not (process.executable.text:c\\:\\\\windows\\\\installer\\\\razer\\\\installer\\\\*)))
<li><a href="#">query: ((process.parent.executable.text:*\\\\services.exe and ((process.command_line.text:*cmd* and process.command_line.text:*\\/c* and process.command_line.text:*echo* and process.command_line.text:*\\\\pipe\\\\*) or (process.command_line.text:*%comspec%* and process.command_line.text:*\\/c* and process.command_line.text:*echo* and process.command_line.text:*\\\\pipe\\\\*) or (process.command_line.text:*cmd.exe* and process.command_line.text:*\\/c* and process.command_line.text:*echo* and process.command_line.text:*\\\\pipe\\\\*) or (process.command_line.text:*rundll32* and process.command_line.text:*.dll,a* and process.command_line.text:*\\/p\\:*))) and (not (process.command_line.text:*mpcmdrun*)))
<li><a href="#">query: ((process.parent.executable.text:*\\\\windowsterminal.exe and (process.executable.text:(*\\\\rundll32.exe or *\\\\regsvr32.exe or *\\\\certutil.exe or *\\\\cscript.exe or *\\\\wscript.exe or *\\\\csc.exe) or process.executable.text:(*c\\:\\\\users\\\\public\\\\* or *\\\\downloads\\\\* or *\\\\desktop\\\\* or *\\\\appdata\\\\local\\\\temp\\\\* or *\\\\windows\\\\temp\\\\*) or process.command_line.text:(*\\ iex\\ * or *invoke\\-* or *import\\-module* or *downloadstring\\(* or *\\ \\/c\\ * or *\\ \\/k\\ *))) and (not ((process.command_line.text:*import\\-module* and process.command_line.text:*microsoft.visualstudio.devshell.dll* and process.command_line.text:*enter\\-vsdevshell*) or (process.command_line.text:*\\\\appdata\\\\local\\\\packages\\\\microsoft.windowsterminal_* and process.command_line.text:*\\\\localstate\\\\settings.json*))))
<li><a href="#">query: ((process.parent.executable.text:*\\\\winrar.exe and process.executable.text:*\\\\wscript.exe) or process.command_line.text:*\\ \\/c\\ ping.exe\\ \\-n\\ 6\\ 127.0.0.1\\ &\\ type\\ * or (process.command_line.text:*regsvr32.exe* and process.command_line.text:*c\\:\\\\programdata* and process.command_line.text:*.tmp*))
<li><a href="#">query: ((process.parent.executable:(*\\\\apache* or *\\\\tomcat*) or process.parent.executable:(*\\\\w3wp.exe or *\\\\php\\-cgi.exe or *\\\\nginx.exe or *\\\\httpd.exe)) and (process.executable:*\\\\cmd.exe and process.command_line:(*perl\\ \\-\\-help* or *python\\ \\-\\-help* or *wget\\ \\-\\-help* or *perl\\ \\-h*)))
<li><a href="#">query: ((process.parent.executable:(*\\\\mshta.exe or *\\\\powershell.exe or *\\\\rundll32.exe or *\\\\cscript.exe or *\\\\wscript.exe or *\\\\wmiprvse.exe) and process.executable:(*\\\\schtasks.exe or *\\\\nslookup.exe or *\\\\certutil.exe or *\\\\bitsadmin.exe or *\\\\mshta.exe)) and (not (process.working_directory:*\\\\ccmcache\\\\*)))
<li><a href="#">query: ((process.parent.executable:(*\\\\mshta.exe or *\\\\rundll32.exe or *\\\\regsvr32.exe or *\\\\services.exe or *\\\\winword.exe or *\\\\wmiprvse.exe or *\\\\powerpnt.exe or *\\\\excel.exe or *\\\\msaccess.exe or *\\\\mspub.exe or *\\\\visio.exe or *\\\\outlook.exe or *\\\\amigo.exe or *\\\\chrome.exe or *\\\\firefox.exe or *\\\\iexplore.exe or *\\\\microsoftedgecp.exe or *\\\\microsoftedge.exe or *\\\\browser.exe or *\\\\vivaldi.exe or *\\\\safari.exe or *\\\\sqlagent.exe or *\\\\sqlserver.exe or *\\\\sqlservr.exe or *\\\\w3wp.exe or *\\\\httpd.exe or *\\\\nginx.exe or *\\\\php\\-cgi.exe or *\\\\jbosssvc.exe or *microsoftedgesh.exe) or process.parent.executable:*tomcat*) and (process.command_line:(*powershell* or *pwsh*) or winlog.event_data.description:\"windows\\ powershell\" or product:\"powershell\\ core\\ 6\"))
<li><a href="#">query: ((process.parent.executable:(*\\\\w3wp.exe or *\\\\php\\-cgi.exe or *\\\\nginx.exe or *\\\\httpd.exe or *\\\\caddy.exe or *\\\\ws_tomcatservice.exe) or (process.parent.executable:(*\\\\java.exe or *\\\\javaw.exe) and process.parent.executable:(*\\-tomcat\\-* or *\\\\tomcat*)) or (process.parent.executable:(*\\\\java.exe or *\\\\javaw.exe) and process.command_line:(*catalina.jar* or *catalina_home*))) and ((process.command_line:*rundll32* and process.command_line:*comsvcs.dll*) or (process.command_line:*\\ \\-hp* and process.command_line:*\\ a\\ * and process.command_line:*\\ \\-m*) or (process.command_line:*net* and process.command_line:*\\ user\\ * and process.command_line:*\\ \\/add*) or (process.command_line:*net* and process.command_line:*\\ localgroup\\ * and process.command_line:*\\ administrators\\ * and process.command_line:*\\/add*) or process.executable:(*\\\\ntdsutil.exe or *\\\\ldifde.exe or *\\\\adfind.exe or *\\\\procdump.exe or *\\\\nanodump.exe or *\\\\vssadmin.exe or *\\\\fsutil.exe) or process.command_line:(*\\ \\-nop\\ * or *\\ \\-w\\ hidden\\ * or *\\ \\-decode\\ * or *\\ \\/decode\\ * or *reg\\ save\\ * or *.downloadstring\\(* or *.downloadfile\\(* or *frombase64string* or *\\ \\/ticket\\:* or *\\ sekurlsa* or *.dmp\\ full* or *process\\ call\\ create* or *whoami\\ \\/priv*)))
<li><a href="#">query: ((process.parent.executable:(*\\\\w3wp.exe or *\\\\php\\-cgi.exe or *\\\\nginx.exe or *\\\\httpd.exe or *\\\\caddy.exe or *\\\\ws_tomcatservice.exe) or (process.parent.executable:(*\\\\java.exe or *\\\\javaw.exe) and process.parent.executable:(*\\-tomcat\\-* or *\\\\tomcat*)) or (process.parent.executable:(*\\\\java.exe or *\\\\javaw.exe) and process.command_line:(*catalina.jar* or *catalina_home*))) and ((winlog.event_data.originalfilename:(\"net.exe\" or \"net1.exe\") and process.command_line:(*\\ user\\ * or *\\ use\\ * or *\\ group\\ *)) or (winlog.event_data.originalfilename:\"ping.exe\" and process.command_line:*\\ \\-n\\ *) or process.command_line:(*&cd&echo* or *cd\\ \\/d\\ *) or (winlog.event_data.originalfilename:\"wmic.exe\" and process.command_line:*\\ \\/node\\:*) or (process.executable:(*\\\\whoami.exe or *\\\\systeminfo.exe or *\\\\quser.exe or *\\\\ipconfig.exe or *\\\\pathping.exe or *\\\\tracert.exe or *\\\\netstat.exe or *\\\\schtasks.exe or *\\\\vssadmin.exe or *\\\\wevtutil.exe or *\\\\tasklist.exe) or winlog.event_data.originalfilename:(\"whoami.exe\" or \"sysinfo.exe\" or \"quser.exe\" or \"ipconfig.exe\" or \"pathping.exe\" or \"tracert.exe\" or \"netstat.exe\" or \"schtasks.exe\" or \"vssadmin.exe\" or \"wevtutil.exe\" or \"tasklist.exe\")) or process.command_line:(*\\ test\\-netconnection\\ * or *dir\\ \\\\*)))
<li><a href="#">query: ((process.parent.executable:(*\\\\w3wp.exe or *\\\\php\\-cgi.exe or *\\\\nginx.exe or *\\\\httpd.exe) or process.parent.executable:(*\\\\apache* or *\\\\tomcat*)) and (((process.executable:(*\\\\net.exe or *\\\\net1.exe) and process.command_line:(*\\ user\\ * or *\\ use\\ * or *\\ group\\ *)) or (process.executable:*\\\\ping.exe and process.command_line:*\\ \\-n\\ *) or process.command_line:(*&cd&echo* or *cd\\ \\/d\\ *)) or (process.executable:*\\\\wmic.exe and process.command_line:*\\ \\/node\\:*) or process.executable:(*\\\\whoami.exe or *\\\\systeminfo.exe or *\\\\quser.exe or *\\\\ipconfig.exe or *\\\\pathping.exe or *\\\\tracert.exe or *\\\\netstat.exe or *\\\\schtasks.exe or *\\\\vssadmin.exe or *\\\\wevtutil.exe or *\\\\tasklist.exe) or process.command_line:(*\\ test\\-netconnection\\ * or *dir\\ \\\\*)))
<li><a href="#">query: ((process.parent.executable:(*\\\\winlogon.exe or *\\\\services.exe or *\\\\lsass.exe or *\\\\csrss.exe or *\\\\smss.exe or *\\\\wininit.exe or *\\\\spoolsv.exe or *\\\\searchindexer.exe) and process.executable:(*\\\\powershell.exe or *\\\\cmd.exe) and user.name:(nt\\ authority\\\\system* or autorite\\ nt\\\\sys*)) and (not (process.command_line:*\\ route\\ * and process.command_line:*\\ add\\ *)))
<li><a href="#">query: ((process.parent.executable:(*\\\\winlogon.exe or *\\\\services.exe or *\\\\lsass.exe or *\\\\csrss.exe or *\\\\smss.exe or *\\\\wininit.exe or *\\\\spoolsv.exe or *\\\\searchindexer.exe) and process.executable:(*\\\\powershell.exe or *\\\\pwsh.exe or *\\\\cmd.exe) and user.name:(*authori* or *autori*)) and (not (process.command_line:*\\ route\\ * and process.command_line:*\\ add\\ *)))
<li><a href="#">query: ((process.parent.executable:(*\\\\winword.exe or *\\\\excel.exe or *\\\\powerpnt.exe or *\\\\mspub.exe or *\\\\visio.exe or *\\\\msaccess.exe or *\\\\eqnedt32.exe) and process.executable:c\\:\\\\users\\\\* and process.executable:*.exe) and (not (process.executable:*\\\\teams.exe)))
<li><a href="#">query: ((process.parent.executable:(*\\\\winword.exe or *\\\\excel.exe or *\\\\powerpnt.exe or *\\\\mspub.exe or *\\\\visio.exe) and process.executable:c\\:\\\\users\\\\* and process.executable:*.exe) and (not (process.executable:*\\\\teams.exe)))
<li><a href="#">query: ((process.parent.executable:(*\\\\wscript.exe or *\\\\cscript.exe) and process.executable:(*\\\\powershell.exe or *\\\\pwsh.exe)) and (not (process.working_directory:*\\\\health\\ service\\ state\\\\*)))
<li><a href="#">query: ((process.parent.executable:(*\\\\wscript.exe or *\\\\cscript.exe) and process.executable:*\\\\powershell.exe) and (not (process.working_directory:*\\\\health\\ service\\ state\\\\*)))
<li><a href="#">query: ((process.parent.executable:(*c\\:\\\\windows\\\\temp* or *\\\\hpqhvind.exe*) and process.executable:c\\:\\\\programdata\\\\drm*) or (process.parent.executable:c\\:\\\\programdata\\\\drm* and process.executable:*\\\\wmplayer.exe) or (process.parent.executable:*\\\\test.exe and process.executable:*\\\\wmplayer.exe) or process.executable:\"c\\:\\\\programdata\\\\drm\\\\clr\\\\clr.exe\" or (process.parent.executable:c\\:\\\\programdata\\\\drm\\\\windows* and process.executable:*\\\\searchfilterhost.exe))
<li><a href="#">query: ((process.parent.executable:*\\\\consent.exe and process.executable:*\\\\iexplore.exe and process.command_line:*\\ http*) and (integritylevel:\"system\" or user.name:(nt\\ authority\\\\system* or autorite\\ nt\\\\sys*)))
<li><a href="#">query: ((process.parent.executable:*\\\\explorer.exe and process.command_line:*c\\:\\\\windows\\\\temp\\\\meg.exe*) or (winlog.event_data.originalfilename:\"meg.exe\" and (not (process.executable:*\\\\meg.exe))))
<li><a href="#">query: ((process.parent.executable:*\\\\java.exe and process.executable:*\\\\cmd.exe) and (not (process.parent.executable:*build* and process.command_line:*build*)))
<li><a href="#">query: ((process.parent.executable:*\\\\razerinstaller.exe and integritylevel:\"system\") and (not (process.executable:c\\:\\\\windows\\\\installer\\\\razer\\\\installer\\\\*)))
<li><a href="#">query: ((process.parent.executable:*\\\\services.exe and ((process.command_line:*cmd* and process.command_line:*\\/c* and process.command_line:*echo* and process.command_line:*\\\\pipe\\\\*) or (process.command_line:*%comspec%* and process.command_line:*\\/c* and process.command_line:*echo* and process.command_line:*\\\\pipe\\\\*) or (process.command_line:*cmd.exe* and process.command_line:*\\/c* and process.command_line:*echo* and process.command_line:*\\\\pipe\\\\*) or (process.command_line:*rundll32* and process.command_line:*.dll,a* and process.command_line:*\\/p\\:*))) and (not (process.command_line:*mpcmdrun*)))
<li><a href="#">query: ((process.parent.executable:*\\\\spoolsv.exe and integritylevel:\"system\") and (((((process.executable:(*\\\\gpupdate.exe or *\\\\whoami.exe or *\\\\nltest.exe or *\\\\taskkill.exe or *\\\\wmic.exe or *\\\\taskmgr.exe or *\\\\sc.exe or *\\\\findstr.exe or *\\\\curl.exe or *\\\\wget.exe or *\\\\certutil.exe or *\\\\bitsadmin.exe or *\\\\accesschk.exe or *\\\\wevtutil.exe or *\\\\bcdedit.exe or *\\\\fsutil.exe or *\\\\cipher.exe or *\\\\schtasks.exe or *\\\\write.exe or *\\\\wuauclt.exe) or (process.executable:*\\\\net.exe and (not (process.command_line:*start*)))) or (process.executable:*\\\\cmd.exe and (not (process.command_line:(*.spl* or *route\\ add* or *program\\ files*))))) or (process.executable:*\\\\netsh.exe and (not (process.command_line:(*add\\ portopening* or *rule\\ name*))))) or (process.executable:(*\\\\powershell.exe or *\\\\pwsh.exe) and (not (process.command_line:*.spl*)))) or (process.executable:*\\\\rundll32.exe and process.command_line:*rundll32.exe)))
<li><a href="#">query: ((process.parent.executable:*\\\\spoolsv.exe and integritylevel:\"system\") and (((((process.executable:(*\\\\gpupdate.exe or *\\\\whoami.exe or *\\\\nltest.exe or *\\\\taskkill.exe or *\\\\wmic.exe or *\\\\taskmgr.exe or *\\\\sc.exe or *\\\\findstr.exe or *\\\\curl.exe or *\\\\wget.exe or *\\\\certutil.exe or *\\\\bitsadmin.exe or *\\\\accesschk.exe or *\\\\wevtutil.exe or *\\\\bcdedit.exe or *\\\\fsutil.exe or *\\\\cipher.exe or *\\\\schtasks.exe or *\\\\write.exe or *\\\\wuauclt.exe) or (process.executable:*\\\\net.exe and (not (process.command_line:*start*)))) or (process.executable:*\\\\cmd.exe and (not (process.command_line:(*.spl* or *route\\ add* or *program\\ files*))))) or (process.executable:*\\\\netsh.exe and (not (process.command_line:(*add\\ portopening* or *rule\\ name*))))) or (process.executable:*\\\\powershell.exe and (not (process.command_line:*.spl*)))) or (process.executable:*\\\\rundll32.exe and process.command_line:*rundll32.exe)))
<li><a href="#">query: ((process.parent.executable:*\\\\sqlservr.exe and process.executable:(*\\\\cmd.exe or *\\\\sh.exe or *\\\\bash.exe or *\\\\powershell.exe or *\\\\pwsh.exe or *\\\\bitsadmin.exe)) and (not ((process.parent.executable:c\\:\\\\program\\ files\\\\microsoft\\ sql\\ server\\\\* and process.parent.executable:*datev_dbengine\\\\mssql\\\\binn\\\\sqlservr.exe and process.executable:\"c\\:\\\\windows\\\\system32\\\\cmd.exe\" and process.command_line:\\\"c\\:\\\\windows\\\\system32\\\\cmd.exe\\\"\\ *))))
<li><a href="#">query: ((process.parent.executable:*\\\\stordiag.exe and process.executable:(*\\\\schtasks.exe or *\\\\systeminfo.exe or *\\\\fltmc.exe)) and (not (process.parent.executable:(c\\:\\\\windows\\\\system32\\\\* or c\\:\\\\windows\\\\syswow64\\\\*))))
<li><a href="#">query: ((process.parent.executable:*\\\\system32\\\\control.exe and process.executable:*\\\\rundll32.exe\\ ) and (not (process.command_line:*shell32.dll*)))
<li><a href="#">query: ((process.parent.executable:*\\\\userinit.exe and (not ((process.executable:(*explorer.exe or *\\\\proquota.exe)) or (process.command_line:(*netlogon*.bat* or *usrlogon.cmd* or *c\\:\\\\windows\\\\explorer.exe*)) or (process.executable:*\\\\citrix\\\\system32\\\\icast.exe)))) or process.command_line:*userinitmprlogonscript*)
<li><a href="#">query: ((process.parent.executable:*\\\\userinit.exe and (not ((process.executable:(*explorer.exe or *\\\\proquota.exe)) or (process.command_line:(*netlogon*.bat* or *usrlogon.cmd* or *c\\:\\\\windows\\\\explorer.exe*))))) or process.command_line:*userinitmprlogonscript*)
<li><a href="#">query: ((process.parent.executable:*\\\\userinit.exe and (not (process.command_line:*\\\\netlogon\\\\*))) and (not (process.executable:*\\\\explorer.exe)))
<li><a href="#">query: ((process.parent.executable:*\\\\vmtoolsd.exe and (process.executable:(*\\\\cmd.exe or *\\\\powershell.exe or *\\\\pwsh.exe or *\\\\rundll32.exe or *\\\\regsvr32.exe or *\\\\wscript.exe or *\\\\cscript.exe) or winlog.event_data.originalfilename:(\"cmd.exe\" or \"powershell.exe\" or \"pwsh.dll\" or \"rundll32.exe\" or \"regsvr32.exe\" or \"wscript.exe\" or \"cscript.exe\"))) and (not (process.command_line:(*\\\\vmware\\\\vmware\\ tools\\\\poweron\\-vm\\-default.bat* or *\\\\vmware\\\\vmware\\ tools\\\\poweroff\\-vm\\-default.bat* or *\\\\vmware\\\\vmware\\ tools\\\\resume\\-vm\\-default.bat* or *\\\\vmware\\\\vmware\\ tools\\\\suspend\\-vm\\-default.bat*))))
<li><a href="#">query: ((process.parent.executable:*\\\\vmtoolsd.exe and process.executable:(*\\\\cmd.exe or *\\\\powershell.exe or *\\\\rundll32.exe or *\\\\regsvr32.exe or *\\\\wscript.exe or *\\\\cscript.exe)) and (not (process.command_line:(*\\\\vmware\\\\vmware\\ tools\\\\poweron\\-vm\\-default.bat* or *\\\\vmware\\\\vmware\\ tools\\\\poweroff\\-vm\\-default.bat* or *\\\\vmware\\\\vmware\\ tools\\\\resume\\-vm\\-default.bat* or *\\\\vmware\\\\vmware\\ tools\\\\suspend\\-vm\\-default.bat*))))
<li><a href="#">query: ((process.parent.executable:*\\\\winword.exe and process.executable:*.tmp) or (process.executable:*\\\\wmic.exe and process.parent.executable:*\\\\temp\\\\* and process.command_line:*shadowcopy\\ delete) or (process.command_line:*shadowcopy\\ delete and process.command_line:*\\\\..\\\\..\\\\system32*))
<li><a href="#">query: ((process.parent.executable:*\\\\wmiprvse.exe and (not (logonid:(\"0x3e7\" or \"null\") or user.name:(nt\\ authority\\\\system* or autorite\\ nt\\\\sys*) or process.executable:(*\\\\wmiprvse.exe or *\\\\werfault.exe)))) and (not (not _exists_:logonid)))
<li><a href="#">query: ((product:*accesschk or winlog.event_data.description:*reports\\ effective\\ permissions* or process.executable.text:(*\\\\accesschk.exe or *\\\\accesschk64.exe) or winlog.event_data.originalfilename:\"accesschk.exe\") and process.command_line.text:(*uwcqv\\ * or *kwsu\\ * or *qwsu\\ * or *uwdqs\\ *))
<li><a href="#">query: ((product:*paexec* and (winlog.event_data.imphash:(\"11d40a7b7876288f919ab819cc2d9802\" or \"6444f8a34e99b8f7d9647de66aabe516\" or \"dfd6aa3f7b2b1035b76b718f1ddc689f\" or \"1a6cca4d5460b1710a12dea39e4a592c\") or winlog.event_data.hashes:(*imphash\\=11d40a7b7876288f919ab819cc2d9802* or *imphash\\=6444f8a34e99b8f7d9647de66aabe516* or *imphash\\=dfd6aa3f7b2b1035b76b718f1ddc689f* or *imphash\\=1a6cca4d5460b1710a12dea39e4a592c*))) and (not (process.executable:*paexec*)))
<li><a href="#">query: ((product:*paexec* and winlog.event_data.imphash:(\"11d40a7b7876288f919ab819cc2d9802\" or \"6444f8a34e99b8f7d9647de66aabe516\" or \"dfd6aa3f7b2b1035b76b718f1ddc689f\" or \"1a6cca4d5460b1710a12dea39e4a592c\")) and (not (process.executable:*paexec*)))
<li><a href="#">query: ((protocol:\"tcp\" and winlog.event_data.initiated:\"true\" and destination.port:\"135\") and (not (process.executable:c\\:\\\\windows\\\\*)))
<li><a href="#">query: ((sourcefilename:(*.lnk or *.rtf or *.pst or *.docx or *.xlsx or *.jpg or *.jpeg or *.png or *.pdf) and file.path.text:(*.lnk.* or *.rtf.* or *.pst.* or *.docx.* or *.xlsx.* or *.jpg.* or *.jpeg.* or *.png.* or *.pdf.*)) and (not (((file.path.text:(*.tmp or *.bak or *.old or *.orig or *.backup or *.temp))) or ((file.path.text:c\\:\\\\programdata\\\\anaconda3\\\\* and file.path.text:*.c\\~)))))
<li><a href="#">query: ((state:\"stopped\" or \"sysmon\\ config\\ state\\ changed\") and (not (state:\"started\")))
<li><a href="#">query: ((type:\"execve\" and \"touch\") and (*\\-t* or *\\-acmr* or *\\-d* or *\\-r*))
<li><a href="#">query: ((type:\"execve\" and a0:(\"mkdir\" or \"touch\" or \"vim\" or \"nano\" or \"vi\")) and (a1:*\\/.* or a1:.* or a2:*\\/.* or a2:.*))
<li><a href="#">query: ((type:\"execve\" and a0:\"/usr/bin/sudoedit\") and ((a1:\"-s\") or (a2:\"-s\") or (a3:\"-s\") or (a4:\"-s\")) and ((a1:\"\\\") or (a2:\"\\\") or (a3:\"\\\") or (a4:\"\\\")))
<li><a href="#">query: ((type:\"execve\" and a0:\"import\") and ((a1:\"\\-window\" and a2:\"root\" and a3:(*.png or *.jpg or *.jpeg)) or a1:(*.png or *.jpg or *.jpeg)))
<li><a href="#">query: ((type:\"execve\" and a0:\"xwd\") and (((a1:\"-root\" and a2:\"-out\" and a3:*.xwd)) or ((a1:\"-out\" and a2:*.xwd))))
<li><a href="#">query: ((type:\"path\" and name:*\\/.*) and (not (name:(*\\/.cache\\/* or *\\/.config\\/* or *\\/.pyenv\\/* or *\\/.rustup\\/toolchains*))))
<li><a href="#">query: ((type:\"path\" and nametype:\"create\") and (name:(\\/usr\\/lib\\/systemd\\/system\\/* or \\/etc\\/systemd\\/system\\/*) or name:*\\/.config\\/systemd\\/user\\/*))
<li><a href="#">query: ((url.original:(*webresource.axd* or *scriptresource.axd* or *i18n.ashx* or *skipi18n*) and (not (url.original:*orion\\/skipi18n\\/profiler\\/*))) and (not (url.original:(*css.i18n.ashx* or *js.i18n.ashx*))))
<li><a href="#">query: ((url.original:*..%2f* or (url.original:*..%2f* and url.original:*apply_abstract.cgi*)) and url.original:(*\\/images\\/* or *\\/js\\/* or *\\/css\\/* or *\\/setup_top_login.htm* or *\\/login.html* or *\\/loginerror.html* or *\\/loginexclude.html* or *\\/loginlock.html*))
<li><a href="#">query: ((url.original:*\\/owa\\/calendar\\/a* and http.request.method:\"post\") and (not (http.response.status_code:\"503\")))
<li><a href="#">query: ((url.query:*\\/flash_install.php* or url.query:*\\/install_flash_player.exe) and (not (url.original:*.adobe.com\\/*)))
<li><a href="#">query: ((user.name:(*authori* or *autori*) and ((process.executable:*\\\\windows\\\\installer\\\\* and process.executable:*msi* and process.executable:*tmp) or (process.executable:*\\\\msiexec.exe and integritylevel:\"system\"))) and (not (process.command_line:*\\\\system32\\\\msiexec.exe\\ \\/v or process.parent.command_line:*\\\\system32\\\\msiexec.exe\\ \\/v)))
<li><a href="#">query: ((user_agent.original:(user\\-agent* or mozilla\\/3.0\\ * or mozilla\\/2.0\\ * or mozilla\\/1.0\\ * or mozilla\\ * or \\ mozilla\\/* or mozila\\/* or mozilla\\/4.0\\ \\(compatible;\\ msie\\ 6.0;\\ ms\\ web\\ services\\ client\\ protocol*) or user_agent.original:(*\\ \\(compatible;msie\\ * or *.0;windows\\ nt\\ * or *loader*) or user_agent.original:(\"_\" or \"certutil\\ url\\ agent\" or \"mozilla\\/5.0\\ \\(windows\\ nt\\ 10.0;\\ win64;\\ x64;\\ rv\\:60.0\\)\" or \"mozilla\\/5.0\\ \\(windows\\ nt\\ 6.3;\\ wow64;\\ rv\\:28.0\\)\\ gecko\\/20100101\\ firefox\\/28.0\" or \"https\" or \"erbium\\-ua\\-4ce7c27cb4be9d32e333bf032c88235a\" or \"rqwrwqrqwrqw\" or \"qwrqrwrqwrqwr\" or \"rc2.0\\/client\" or \"takemypainback\")) and (not (user_agent.original:mozilla\\/3.0\\ *\\ acrobat\\ * or (url.domain:(*.acrobat.com or *.adobe.com or *.adobe.io) or destination.domain:(*.acrobat.com or *.adobe.com or *.adobe.io)))))
<li><a href="#">query: ((user_agent.original:(user\\-agent* or mozilla\\/3.0\\ * or mozilla\\/2.0\\ * or mozilla\\/1.0\\ * or mozilla\\ * or \\ mozilla\\/* or mozila\\/* or mozilla\\/4.0\\ \\(compatible;\\ msie\\ 6.0;\\ ms\\ web\\ services\\ client\\ protocol*) or user_agent.original:(*\\ \\(compatible;msie\\ * or *.0;windows\\ nt\\ * or *loader*) or user_agent.original:(\"_\" or \"certutil\\ url\\ agent\" or \"mozilla\\/5.0\\ \\(windows\\ nt\\ 10.0;\\ win64;\\ x64;\\ rv\\:60.0\\)\" or \"mozilla\\/5.0\\ \\(windows\\ nt\\ 6.3;\\ wow64;\\ rv\\:28.0\\)\\ gecko\\/20100101\\ firefox\\/28.0\" or \"https\")) and (not (user_agent.original:mozilla\\/3.0\\ *\\ acrobat\\ *)))
<li><a href="#">query: ((winlog.event_data.description:(windows\\ powershell* or pwsh*) and company:\"microsoft\\ corporation\") and (not (process.executable:(*\\\\powershell.exe or *\\\\powershell_ise.exe or *\\\\pwsh.exe))))
<li><a href="#">query: ((winlog.event_data.description:\"execute\\ processes\\ remotely\" and product:\"sysinternals\\ psexec\") and (not (process.executable:(*\\\\psexec.exe or *\\\\psexec64.exe))))
<li><a href="#">query: ((winlog.event_data.description:\"java\\ update\\ scheduler\" or winlog.event_data.description:\"java\\(tm\\)\\ update\\ scheduler\") and (not (process.executable:*\\\\jusched.exe)))
<li><a href="#">query: ((winlog.event_data.description:\"paexec\\ application\" or winlog.event_data.originalfilename:\"paexec.exe\") and (not (process.executable.text:(*\\\\paexec.exe or *\\\\paexec.exe))))
<li><a href="#">query: ((winlog.event_data.description:\"paexec\\ application\" or winlog.event_data.originalfilename:\"paexec.exe\") and (not (process.executable:(*\\\\paexec.exe or *\\\\paexec.exe))))
<li><a href="#">query: ((winlog.event_data.description:\"system.management.automation\" and dll.path:*system.management.automation*) and (not ((process.executable.text:(*\\\\powershell.exe or *\\\\mscorsvw.exe) or process.executable.text:(c\\:\\\\program\\ files\\ \\(x86\\)\\\\microsoft\\ visual\\ studio\\\\* or c\\:\\\\program\\ files\\\\microsoft\\ visual\\ studio\\\\* or c\\:\\\\windows\\\\system32\\\\* or c\\:\\\\program\\ files\\\\citrix\\\\configsync\\\\*)) or (not _exists_:process.executable.text))))
<li><a href="#">query: ((winlog.event_data.description:\"system.management.automation\" and file.path:*system.management.automation*) and (not (process.executable:(*\\\\powershell.exe or *\\\\mscorsvw.exe) or process.executable:(c\\:\\\\program\\ files\\ \\(x86\\)\\\\microsoft\\ visual\\ studio\\\\* or c\\:\\\\program\\ files\\\\microsoft\\ visual\\ studio\\\\* or c\\:\\\\windows\\\\system32\\\\* or c\\:\\\\program\\ files\\\\citrix\\\\configsync\\\\*))))
<li><a href="#">query: ((winlog.event_data.eventtype:\"createkey\" and winlog.event_data.targetobject:(*\\\\psexec* or *\\\\procdump* or *\\\\handle* or *\\\\livekd* or *\\\\process\\ explorer* or *\\\\psloglist* or *\\\\pspasswd* or *\\\\active\\ directory\\ explorer*) and winlog.event_data.targetobject:*\\\\eulaaccepted) and (not (process.executable.text:(*\\\\psexec.exe or *\\\\psexec64.exe or *\\\\procdump.exe or *\\\\procdump64.exe or *\\\\handle.exe or *\\\\handle64.exe or *\\\\livekd.exe or *\\\\livekd64.exe or *\\\\procexp.exe or *\\\\procexp64.exe or *\\\\psloglist.exe or *\\\\psloglist64.exe or *\\\\pspasswd.exe or *\\\\pspasswd64.exe or *\\\\adexplorer.exe or *\\\\adexplorer64.exe))))
<li><a href="#">query: ((winlog.event_data.eventtype:\"createkey\" and winlog.event_data.targetobject:(*\\\\software\\\\microsoft\\\\amsi\\\\providers\\\\* or *\\\\software\\\\wow6432node\\\\microsoft\\\\amsi\\\\providers\\\\*)) and (not (process.executable:c\\:\\\\program\\ files*)))
<li><a href="#">query: ((winlog.event_data.eventtype:\"createkey\" and winlog.event_data.targetobject:*\\\\software\\\\appdatalow\\\\software\\\\microsoft\\\\*) and (not (winlog.event_data.targetobject:(*\\\\software\\\\appdatalow\\\\software\\\\microsoft\\\\internet\\ explorer\\\\* or *\\\\software\\\\appdatalow\\\\software\\\\microsoft\\\\repservice\\\\* or *\\\\software\\\\appdatalow\\\\software\\\\microsoft\\\\ime\\\\* or *\\\\software\\\\appdatalow\\\\software\\\\microsoft\\\\edge\\\\*))))
<li><a href="#">query: ((winlog.event_data.eventtype:\"createkey\" and winlog.event_data.targetobject:*\\\\software\\\\microsoft\\\\windows\\\\currentversion\\\\explorer\\\\volumecaches\\\\*) and (not (winlog.event_data.targetobject:(*\\\\active\\ setup\\ temp\\ folders or *\\\\branchcache or *\\\\content\\ indexer\\ cleaner or *\\\\d3d\\ shader\\ cache or *\\\\delivery\\ optimization\\ files or *\\\\device\\ driver\\ packages or *\\\\diagnostic\\ data\\ viewer\\ database\\ files or *\\\\downloaded\\ program\\ files or *\\\\downloadsfolder or *\\\\feedback\\ hub\\ archive\\ log\\ files or *\\\\internet\\ cache\\ files or *\\\\language\\ pack or *\\\\microsoft\\ office\\ temp\\ files or *\\\\offline\\ pages\\ files or *\\\\old\\ chkdsk\\ files or *\\\\previous\\ installations or *\\\\recycle\\ bin or *\\\\retaildemo\\ offline\\ content or *\\\\setup\\ log\\ files or *\\\\system\\ error\\ memory\\ dump\\ files or *\\\\system\\ error\\ minidump\\ files or *\\\\temporary\\ files or *\\\\temporary\\ setup\\ files or *\\\\temporary\\ sync\\ files or *\\\\thumbnail\\ cache or *\\\\update\\ cleanup or *\\\\upgrade\\ discarded\\ files or *\\\\user\\ file\\ versions or *\\\\windows\\ defender or *\\\\windows\\ error\\ reporting\\ files or *\\\\windows\\ esd\\ installation\\ files or *\\\\windows\\ upgrade\\ log\\ files))))
<li><a href="#">query: ((winlog.event_data.eventtype:\"createkey\" and winlog.event_data.targetobject:*hku\\\\* and winlog.event_data.targetobject:*classes\\\\clsid\\\\* and winlog.event_data.targetobject:*\\\\treatas*) and (not ((process.executable.text:\"c\\:\\\\windows\\\\system32\\\\svchost.exe\"))))
<li><a href="#">query: ((winlog.event_data.eventtype:\"deletekey\" and winlog.event_data.targetobject:*\\\\shell\\\\open\\\\command) and (not ((process.executable.text:\"c\\:\\\\windows\\\\system32\\\\svchost.exe\") or (process.executable.text:(c\\:\\\\program\\ files\\\\common\\ files\\\\microsoft\\ shared\\\\clicktorun\\\\* or c\\:\\\\program\\ files\\\\common\\ files\\\\microsoft\\ shared\\\\clicktorun\\\\updates\\\\*) and process.executable.text:*\\\\officeclicktorun.exe) or (process.executable.text:\"c\\:\\\\program\\ files\\ \\(x86\\)\\\\microsoft\\ office\\\\root\\\\integration\\\\integrator.exe\") or (process.executable.text:*\\\\dropbox.exe and winlog.event_data.targetobject:*\\\\dropbox.*) or (process.executable.text:*\\\\appdata\\\\local\\\\temp\\\\wireshark_uninstaller.exe and winlog.event_data.targetobject:*\\\\wireshark\\-capture\\-file\\\\*) or (process.executable.text:(c\\:\\\\program\\ files\\\\opera\\\\* or c\\:\\\\program\\ files\\ \\(x86\\)\\\\opera\\\\*) and process.executable.text:*\\\\installer.exe) or (process.executable.text:*peazip* and winlog.event_data.targetobject:*\\\\peazip.*) or (process.executable.text:*\\\\everything.exe and winlog.event_data.targetobject:*\\\\everything.*))))
<li><a href="#">query: ((winlog.event_data.eventtype:\"deletekey\" and winlog.event_data.targetobject:*\\\\shell\\\\open\\\\command) and (not ((process.executable:\"c\\:\\\\windows\\\\system32\\\\svchost.exe\") or (process.executable:(c\\:\\\\program\\ files\\\\common\\ files\\\\microsoft\\ shared\\\\clicktorun\\\\* or c\\:\\\\program\\ files\\\\common\\ files\\\\microsoft\\ shared\\\\clicktorun\\\\updates\\\\*) and process.executable:*\\\\officeclicktorun.exe) or (process.executable:\"c\\:\\\\program\\ files\\ \\(x86\\)\\\\microsoft\\ office\\\\root\\\\integration\\\\integrator.exe\") or (process.executable:*\\\\dropbox.exe and winlog.event_data.targetobject:hkcr\\\\dropbox.*))))
<li><a href="#">query: ((winlog.event_data.eventtype:\"deletevalue\" and winlog.event_data.targetobject:*\\\\appxypsaf9f1qserqevf0sws76dx4k9a5206\\\\shell\\\\open\\\\command\\\\delegateexecute) or winlog.event_data.targetobject:*\\\\appxypsaf9f1qserqevf0sws76dx4k9a5206\\\\shell\\\\open\\\\command\\\\\\(default\\))
<li><a href="#">query: ((winlog.event_data.eventtype:\"deletevalue\" and winlog.event_data.targetobject:*\\\\microsoft\\\\terminal\\ server\\ client\\\\default\\\\mru*) or (winlog.event_data.eventtype:\"deletekey\" and winlog.event_data.targetobject:*\\\\microsoft\\\\terminal\\ server\\ client\\\\servers\\\\*))
<li><a href="#">query: ((winlog.event_data.eventtype:\"renamekey\" and newname:\"hkcr\\\\clsid\\\\\\{645ff040\\-5081\\-101b\\-9f08\\-00aa002f954e\\}\\\\shell\\\\open\") or (winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:\"hkcr\\\\clsid\\\\\\{645ff040\\-5081\\-101b\\-9f08\\-00aa002f954e\\}\\\\shell\\\\open\\\\command\\\\\\(default\\)\"))
<li><a href="#">query: ((winlog.event_data.eventtype:\"setvalue\" and (((winlog.event_data.targetobject:(hklm\\\\software\\\\classes\\\\.* or hkey_local_machine\\\\software\\\\classes\\\\.*) and winlog.event_data.targetobject:*\\\\persistenthandler*)) or ((winlog.event_data.targetobject:(hklm\\\\software\\\\classes\\\\clsid* or hkey_local_machine\\\\software\\\\classes\\\\clsid*) and winlog.event_data.targetobject:*\\\\persistentaddinsregistered\\\\\\{89bcb740\\-6119\\-101a\\-bcb7\\-00dd010655af\\}*)))) and (not ((process.executable.text:(c\\:\\\\windows\\\\system32\\\\* or c\\:\\\\program\\ files\\ \\(x86\\)\\\\* or c\\:\\\\program\\ files\\\\*) and winlog.event_data.targetobject:(*\\\\clsid\\\\\\{4f46f75f\\-199f\\-4c63\\-8b7d\\-86d48fe7970c\\}\\\\* or *\\\\clsid\\\\\\{4887767f\\-7adc\\-4983\\-b576\\-88fb643d6f79\\}\\\\* or *\\\\clsid\\\\\\{d3b41fa1\\-01e3\\-49af\\-aa25\\-1d0d824275ae\\}\\\\* or *\\\\clsid\\\\\\{72773e1a\\-b711\\-4d8d\\-81fa\\-b9a43b0650dd\\}\\\\* or *\\\\clsid\\\\\\{098f2470\\-bae0\\-11cd\\-b579\\-08002b30bfeb\\}\\\\* or *\\\\clsid\\\\\\{1aa9bf05\\-9a97\\-48c1\\-ba28\\-d9dce795e93c\\}\\\\* or *\\\\clsid\\\\\\{2e2294a9\\-50d7\\-4fe7\\-a09f\\-e6492e185884\\}\\\\* or *\\\\clsid\\\\\\{34ceac8d\\-cbc0\\-4f77\\-b7b1\\-8a60cb6da0f7\\}\\\\* or *\\\\clsid\\\\\\{3b224b11\\-9363\\-407e\\-850f\\-c9e1ffacd8fb\\}\\\\* or *\\\\clsid\\\\\\{3ddeb7a4\\-8abf\\-4d82\\-b9ee\\-e1f4552e95be\\}\\\\* or *\\\\clsid\\\\\\{5645c8c1\\-e277\\-11cf\\-8fda\\-00aa00a14f93\\}\\\\* or *\\\\clsid\\\\\\{5645c8c4\\-e277\\-11cf\\-8fda\\-00aa00a14f93\\}\\\\* or *\\\\clsid\\\\\\{58a9ebf6\\-5755\\-4554\\-a67e\\-a2467ad1447b\\}\\\\* or *\\\\clsid\\\\\\{5e941d80\\-bf96\\-11cd\\-b579\\-08002b30bfeb\\}\\\\* or *\\\\clsid\\\\\\{698a4ffc\\-63a3\\-4e70\\-8f00\\-376ad29363fb\\}\\\\* or *\\\\clsid\\\\\\{7e9d8d44\\-6926\\-426f\\-aa2b\\-217a819a5cce\\}\\\\* or *\\\\clsid\\\\\\{8cd34779\\-9f10\\-4f9b\\-adfb\\-b3faeabdab5a\\}\\\\* or *\\\\clsid\\\\\\{9694e38a\\-e081\\-46ac\\-99a0\\-8743c909acb6\\}\\\\* or *\\\\clsid\\\\\\{98de59a0\\-d175\\-11cd\\-a7bd\\-00006b827d94\\}\\\\* or *\\\\clsid\\\\\\{aa10385a\\-f5aa\\-4eff\\-b3df\\-71b701e25e18\\}\\\\* or *\\\\clsid\\\\\\{b4132098\\-7a03\\-423d\\-9463\\-163cb07c151f\\}\\\\* or *\\\\clsid\\\\\\{d044309b\\-5da6\\-4633\\-b085\\-4ed02522e5a5\\}\\\\* or *\\\\clsid\\\\\\{d169c14a\\-5148\\-4322\\-92c8\\-754fc9d018d8\\}\\\\* or *\\\\clsid\\\\\\{dd75716e\\-b42e\\-4978\\-bb60\\-1497b92e30c4\\}\\\\* or *\\\\clsid\\\\\\{e2f83eed\\-62de\\-4a9f\\-9cd0\\-a1d40dcd13b6\\}\\\\* or *\\\\clsid\\\\\\{e772ceb3\\-e203\\-4828\\-adf1\\-765713d981b8\\}\\\\* or *\\\\clsid\\\\\\{eec97550\\-47a9\\-11cf\\-b952\\-00aa0051fe20\\}* or *\\\\clsid\\\\\\{fb10bd80\\-a331\\-4e9e\\-9eb7\\-00279903ad99\\}\\\\*)))))
<li><a href="#">query: ((winlog.event_data.eventtype:\"setvalue\" and (((winlog.event_data.targetobject:(hklm\\\\software\\\\classes\\\\.* or hkey_local_machine\\\\software\\\\classes\\\\.*) and winlog.event_data.targetobject:*\\\\persistenthandler*)) or ((winlog.event_data.targetobject:(hklm\\\\software\\\\classes\\\\clsid* or hkey_local_machine\\\\software\\\\classes\\\\clsid*) and winlog.event_data.targetobject:*\\\\persistentaddinsregistered\\\\\\{89bcb740\\-6119\\-101a\\-bcb7\\-00dd010655af\\}*)))) and (not ((winlog.event_data.targetobject:(*\\\\clsid\\\\\\{4f46f75f\\-199f\\-4c63\\-8b7d\\-86d48fe7970c\\}\\\\* or *\\\\clsid\\\\\\{4887767f\\-7adc\\-4983\\-b576\\-88fb643d6f79\\}\\\\* or *\\\\clsid\\\\\\{d3b41fa1\\-01e3\\-49af\\-aa25\\-1d0d824275ae\\}\\\\* or *\\\\clsid\\\\\\{72773e1a\\-b711\\-4d8d\\-81fa\\-b9a43b0650dd\\}\\\\* or *\\\\clsid\\\\\\{098f2470\\-bae0\\-11cd\\-b579\\-08002b30bfeb\\}\\\\* or *\\\\clsid\\\\\\{1aa9bf05\\-9a97\\-48c1\\-ba28\\-d9dce795e93c\\}\\\\* or *\\\\clsid\\\\\\{2e2294a9\\-50d7\\-4fe7\\-a09f\\-e6492e185884\\}\\\\* or *\\\\clsid\\\\\\{34ceac8d\\-cbc0\\-4f77\\-b7b1\\-8a60cb6da0f7\\}\\\\* or *\\\\clsid\\\\\\{3b224b11\\-9363\\-407e\\-850f\\-c9e1ffacd8fb\\}\\\\* or *\\\\clsid\\\\\\{3ddeb7a4\\-8abf\\-4d82\\-b9ee\\-e1f4552e95be\\}\\\\* or *\\\\clsid\\\\\\{5645c8c1\\-e277\\-11cf\\-8fda\\-00aa00a14f93\\}\\\\* or *\\\\clsid\\\\\\{5645c8c4\\-e277\\-11cf\\-8fda\\-00aa00a14f93\\}\\\\* or *\\\\clsid\\\\\\{58a9ebf6\\-5755\\-4554\\-a67e\\-a2467ad1447b\\}\\\\* or *\\\\clsid\\\\\\{5e941d80\\-bf96\\-11cd\\-b579\\-08002b30bfeb\\}\\\\* or *\\\\clsid\\\\\\{698a4ffc\\-63a3\\-4e70\\-8f00\\-376ad29363fb\\}\\\\* or *\\\\clsid\\\\\\{7e9d8d44\\-6926\\-426f\\-aa2b\\-217a819a5cce\\}\\\\* or *\\\\clsid\\\\\\{8cd34779\\-9f10\\-4f9b\\-adfb\\-b3faeabdab5a\\}\\\\* or *\\\\clsid\\\\\\{9694e38a\\-e081\\-46ac\\-99a0\\-8743c909acb6\\}\\\\* or *\\\\clsid\\\\\\{98de59a0\\-d175\\-11cd\\-a7bd\\-00006b827d94\\}\\\\* or *\\\\clsid\\\\\\{aa10385a\\-f5aa\\-4eff\\-b3df\\-71b701e25e18\\}\\\\* or *\\\\clsid\\\\\\{b4132098\\-7a03\\-423d\\-9463\\-163cb07c151f\\}\\\\* or *\\\\clsid\\\\\\{d044309b\\-5da6\\-4633\\-b085\\-4ed02522e5a5\\}\\\\* or *\\\\clsid\\\\\\{d169c14a\\-5148\\-4322\\-92c8\\-754fc9d018d8\\}\\\\* or *\\\\clsid\\\\\\{dd75716e\\-b42e\\-4978\\-bb60\\-1497b92e30c4\\}\\\\* or *\\\\clsid\\\\\\{e2f83eed\\-62de\\-4a9f\\-9cd0\\-a1d40dcd13b6\\}\\\\* or *\\\\clsid\\\\\\{e772ceb3\\-e203\\-4828\\-adf1\\-765713d981b8\\}\\\\* or *\\\\clsid\\\\\\{eec97550\\-47a9\\-11cf\\-b952\\-00aa0051fe20\\}* or *\\\\clsid\\\\\\{fb10bd80\\-a331\\-4e9e\\-9eb7\\-00279903ad99\\}\\\\*)) or (process.executable.text:(c\\:\\\\windows\\\\system32\\\\* or c\\:\\\\program\\ files\\ \\(x86\\)\\\\* or c\\:\\\\program\\ files\\\\*)))))
<li><a href="#">query: ((winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:(*\\\\shellids\\\\microsoft.powershell\\\\executionpolicy or *\\\\policies\\\\microsoft\\\\windows\\\\powershell\\\\executionpolicy) and winlog.event_data.details:(*bypass* or *remotesigned* or *unrestricted*)) and (not process.executable.text:(c\\:\\\\windows\\\\system32\\\\* or c\\:\\\\windows\\\\syswow64\\\\*)))
<li><a href="#">query: ((winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:(*\\\\software\\\\microsoft\\\\cryptography\\\\providers\\\\* or *\\\\software\\\\microsoft\\\\cryptography\\\\oid\\\\encodingtype* or *\\\\software\\\\wow6432node\\\\microsoft\\\\cryptography\\\\providers\\\\* or *\\\\software\\\\wow6432node\\\\microsoft\\\\cryptography\\\\oid\\\\encodingtype*) and winlog.event_data.targetobject:(*\\\\dll* or *\\\\$dll*)) and (not ((winlog.event_data.details:(\"wintrust.dll\" or \"mso.dll\")) or (process.executable.text:\"c\\:\\\\windows\\\\system32\\\\poqexec.exe\" and winlog.event_data.targetobject:*\\\\cryptsipdll* and winlog.event_data.details:\"c\\:\\\\windows\\\\system32\\\\psfsip.dll\"))))
<li><a href="#">query: ((winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:(*\\\\software\\\\microsoft\\\\office\\\\outlook\\\\addins\\\\* or *\\\\software\\\\microsoft\\\\office\\\\word\\\\addins\\\\* or *\\\\software\\\\microsoft\\\\office\\\\excel\\\\addins\\\\* or *\\\\software\\\\microsoft\\\\office\\\\powerpoint\\\\addins\\\\* or *\\\\software\\\\microsoft\\\\vsto\\\\security\\\\inclusion\\\\*)) and (not ((process.executable.text:(*\\\\msiexec.exe or *\\\\regsvr32.exe)) or (process.executable.text:(*\\\\winword.exe or *\\\\integrator.exe or *\\\\officeclicktorun.exe)) or ((process.executable.text:\"c:\\program files\\avg\\antivirus\\regsvr.exe\" and winlog.event_data.targetobject:*\\\\microsoft\\\\office\\\\outlook\\\\addins\\\\antivirus.asoutext\\\\*)))))
<li><a href="#">query: ((winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:(*\\\\software\\\\microsoft\\\\office\\\\outlook\\\\addins\\\\* or *\\\\software\\\\microsoft\\\\office\\\\word\\\\addins\\\\* or *\\\\software\\\\microsoft\\\\office\\\\excel\\\\addins\\\\* or *\\\\software\\\\microsoft\\\\office\\\\powerpoint\\\\addins\\\\* or *\\\\software\\\\microsoft\\\\vsto\\\\security\\\\inclusion\\\\*)) and (not ((process.executable:(*\\\\msiexec.exe or *\\\\regsvr32.exe)) or (process.executable:(*\\\\winword.exe or *\\\\integrator.exe or *\\\\officeclicktorun.exe)))))
<li><a href="#">query: ((winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:(*\\\\software\\\\microsoft\\\\windows\\\\currentversion\\\\run\\\\* or *\\\\software\\\\microsoft\\\\windows\\\\currentversion\\\\runonce\\\\*)) and (winlog.event_data.details:(*c\\:\\\\windows\\\\temp\\\\* or *c\\:\\\\$recycle.bin\\\\* or *c\\:\\\\temp\\\\* or *c\\:\\\\users\\\\public\\\\* or *c\\:\\\\users\\\\default\\\\* or *c\\:\\\\users\\\\desktop\\\\* or *\\\\appdata\\\\local\\\\temp\\\\*) or winlog.event_data.details:(%public%\\\\* or wscript* or cscript*)))
<li><a href="#">query: ((winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:(*\\\\software\\\\wow6432node\\\\microsoft\\\\internet\\ explorer* or *\\\\software\\\\microsoft\\\\internet\\ explorer*) and winlog.event_data.targetobject:(*\\\\toolbar* or *\\\\extensions* or *\\\\explorer\\ bars*)) and (not ((winlog.event_data.details:\"\\(empty\\)\") or (winlog.event_data.targetobject:(*\\\\extensions\\\\\\{2670000a\\-7350\\-4f3c\\-8081\\-5663ee0c6c49\\}* or *\\\\extensions\\\\\\{31d09ba0\\-12f5\\-4cce\\-be8a\\-2923e76605da\\}* or *\\\\extensions\\\\\\{789fe86f\\-6fc4\\-46a1\\-9849\\-ede0db0c95ca\\}* or *\\\\extensions\\\\\\{a95fe080\\-8f5d\\-11d2\\-a20b\\-00aa003c157a\\}*)) or (winlog.event_data.targetobject:(*\\\\toolbar\\\\shellbrowser\\\\itbar7layout or *\\\\toolbar\\\\showdiscussionbutton or *\\\\toolbar\\\\locked)))))
<li><a href="#">query: ((winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:(*\\\\software\\\\wow6432node\\\\microsoft\\\\office* or *\\\\software\\\\microsoft\\\\office*) and winlog.event_data.targetobject:(*\\\\word\\\\addins* or *\\\\powerpoint\\\\addins* or *\\\\outlook\\\\addins* or *\\\\onenote\\\\addins* or *\\\\excel\\\\addins* or *\\\\access\\\\addins* or *test\\\\special\\\\perf*)) and (not ((winlog.event_data.details:\"\\(empty\\)\") or (winlog.event_data.targetobject:(*\\\\excel\\\\addins\\\\adhocreportingexcelclientlib.adhocreportingexcelclientaddin.1\\\\* or *\\\\excel\\\\addins\\\\excelpluginshell.powermapconnect\\\\* or *\\\\excel\\\\addins\\\\nativeshim\\\\* or *\\\\excel\\\\addins\\\\nativeshim.inquireconnector.1\\\\* or *\\\\excel\\\\addins\\\\powerpivotexcelclientaddin.nativeentry.1\\\\*)) or (winlog.event_data.targetobject:(*\\\\outlook\\\\addins\\\\accessaddin.dc\\\\* or *\\\\outlook\\\\addins\\\\colleagueimport.colleagueimportaddin\\\\* or *\\\\outlook\\\\addins\\\\evernotecc.evernotecontactconnector\\\\* or *\\\\outlook\\\\addins\\\\evernoteolrd.connect\\\\* or *\\\\outlook\\\\addins\\\\microsoft.vbaaddinforoutlook.1\\\\* or *\\\\outlook\\\\addins\\\\ocoffice.ocforms\\\\* or *\\\\outlook\\\\addins\\\\oscaddin.connect\\\\* or *\\\\outlook\\\\addins\\\\outlookchangenotifier.connect\\\\* or *\\\\outlook\\\\addins\\\쫝in.lyncaddin.1* or *\\\\outlook\\\\addins\\\쫝in.ucaddin.1* or *\\\\outlook\\\\addins\\\\umoutlookaddin.formregionaddin\\\\*)) or (process.executable:(c\\:\\\\program\\ files\\\\common\\ files\\\\microsoft\\ shared\\\\clicktorun\\\\* or c\\:\\\\program\\ files\\\\common\\ files\\\\microsoft\\ shared\\\\clicktorun\\\\updates\\\\*) and process.executable:*\\\\officeclicktorun.exe))))
<li><a href="#">query: ((winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:(*\\\\software\\\\wow6432node\\\\microsoft\\\\office* or *\\\\software\\\\microsoft\\\\office*) and winlog.event_data.targetobject:(*\\\\word\\\\addins* or *\\\\powerpoint\\\\addins* or *\\\\outlook\\\\addins* or *\\\\onenote\\\\addins* or *\\\\excel\\\\addins* or *\\\\access\\\\addins* or *test\\\\special\\\\perf*)) and (not ((winlog.event_data.details:\"\\(empty\\)\") or (winlog.event_data.targetobject:(*\\\\excel\\\\addins\\\\adhocreportingexcelclientlib.adhocreportingexcelclientaddin.1\\\\* or *\\\\excel\\\\addins\\\\excelpluginshell.powermapconnect\\\\* or *\\\\excel\\\\addins\\\\nativeshim\\\\* or *\\\\excel\\\\addins\\\\nativeshim.inquireconnector.1\\\\* or *\\\\excel\\\\addins\\\\powerpivotexcelclientaddin.nativeentry.1\\\\*)) or (winlog.event_data.targetobject:(*\\\\outlook\\\\addins\\\\accessaddin.dc\\\\* or *\\\\outlook\\\\addins\\\\colleagueimport.colleagueimportaddin\\\\* or *\\\\outlook\\\\addins\\\\evernotecc.evernotecontactconnector\\\\* or *\\\\outlook\\\\addins\\\\evernoteolrd.connect\\\\* or *\\\\outlook\\\\addins\\\\microsoft.vbaaddinforoutlook.1\\\\* or *\\\\outlook\\\\addins\\\\ocoffice.ocforms\\\\* or *\\\\outlook\\\\addins\\\\oscaddin.connect\\\\* or *\\\\outlook\\\\addins\\\\outlookchangenotifier.connect\\\\* or *\\\\outlook\\\\addins\\\쫝in.lyncaddin.1* or *\\\\outlook\\\\addins\\\쫝in.ucaddin.1* or *\\\\outlook\\\\addins\\\\umoutlookaddin.formregionaddin\\\\*)))))
<li><a href="#">query: ((winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:(*\\\\software\\\\wow6432node\\\\microsoft\\\\windows\\ ce\\ services\\\\autostart* or *\\\\software\\\\wow6432node\\\\microsoft\\\\command\\ processor\\\\autorun* or *\\\\software\\\\wow6432node\\\\microsoft\\\\active\\ setup\\\\installed\\ components* or *\\\\software\\\\microsoft\\\\windows\\ ce\\ services\\\\autostartondisconnect* or *\\\\software\\\\microsoft\\\\windows\\ ce\\ services\\\\autostartonconnect* or *\\\\system\\\\setup\\\\cmdline* or *\\\\software\\\\microsoft\\\\ctf\\\\langbaraddin* or *\\\\software\\\\microsoft\\\\command\\ processor\\\\autorun* or *\\\\software\\\\microsoft\\\\active\\ setup\\\\installed\\ components* or *\\\\software\\\\classes\\\\protocols\\\\handler* or *\\\\software\\\\classes\\\\protocols\\\\filter* or *\\\\software\\\\classes\\\\htmlfile\\\\shell\\\\open\\\\command\\\\\\(default\\)* or *\\\\environment\\\\userinitmprlogonscript* or *\\\\software\\\\policies\\\\microsoft\\\\windows\\\\control\\ panel\\\\desktop\\\\scrnsave.exe* or *\\\\software\\\\microsoft\\\\internet\\ explorer\\\\urlsearchhooks* or *\\\\software\\\\microsoft\\\\internet\\ explorer\\\\desktop\\\\components* or *\\\\software\\\\classes\\\\clsid\\\\\\{ab8902b4\\-09ca\\-4bb6\\-b78d\\-a8f59079a8d5\\}\\\\inprocserver32* or *\\\\control\\ panel\\\\desktop\\\\scrnsave.exe*)) and (not ((winlog.event_data.details:\"\\(empty\\)\") or (winlog.event_data.targetobject:(*\\\\office\\\\clicktorun\\\\registry\\\\machine\\\\software\\\\classes\\\\protocols\\\\handler\\\\* or *\\\\clicktorunstore\\\\hkmu\\\\software\\\\classes\\\\protocols\\\\handler\\\\*) or winlog.event_data.details:(\"\\{314111c7\\-a502\\-11d2\\-bbca\\-00c04f8ec294\\}\" or \"\\{3459b272\\-cc19\\-4448\\-86c9\\-ddc3b4b2fad3\\}\" or \"\\{42089d2d\\-912d\\-4018\\-9087\\-2b87803e93fb\\}\" or \"\\{5504be45\\-a83b\\-4808\\-900a\\-3a5c36e7f77a\\}\" or \"\\{807583e5\\-5146\\-11d5\\-a672\\-00b0d022e945\\}\")) or (winlog.event_data.targetobject:*\\\\software\\\\microsoft\\\\active\\ setup\\\\installed\\ components\\\\\\{8a69d345\\-d564\\-463c\\-aff1\\-a69d9e530f96\\}\\\\*) or (process.executable:(\"c\\:\\\\windows\\\\system32\\\\poqexec.exe\" or \"c\\:\\\\program\\ files\\ \\(x86\\)\\\\microsoft\\ office\\\\root\\\\integration\\\\integrator.exe\")) or (process.executable:(c\\:\\\\program\\ files\\\\common\\ files\\\\microsoft\\ shared\\\\clicktorun\\\\* or c\\:\\\\program\\ files\\\\common\\ files\\\\microsoft\\ shared\\\\clicktorun\\\\updates\\\\*) and process.executable:*\\\\officeclicktorun.exe))))
<li><a href="#">query: ((winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:(*\\\\software\\\\wow6432node\\\\microsoft\\\\windows\\ ce\\ services\\\\autostart* or *\\\\software\\\\wow6432node\\\\microsoft\\\\command\\ processor\\\\autorun* or *\\\\software\\\\wow6432node\\\\microsoft\\\\active\\ setup\\\\installed\\ components* or *\\\\software\\\\microsoft\\\\windows\\ ce\\ services\\\\autostartondisconnect* or *\\\\software\\\\microsoft\\\\windows\\ ce\\ services\\\\autostartonconnect* or *\\\\system\\\\setup\\\\cmdline* or *\\\\software\\\\microsoft\\\\ctf\\\\langbaraddin* or *\\\\software\\\\microsoft\\\\command\\ processor\\\\autorun* or *\\\\software\\\\microsoft\\\\active\\ setup\\\\installed\\ components* or *\\\\software\\\\classes\\\\protocols\\\\handler* or *\\\\software\\\\classes\\\\protocols\\\\filter* or *\\\\software\\\\classes\\\\htmlfile\\\\shell\\\\open\\\\command\\\\\\(default\\)* or *\\\\environment\\\\userinitmprlogonscript* or *\\\\software\\\\policies\\\\microsoft\\\\windows\\\\control\\ panel\\\\desktop\\\\scrnsave.exe* or *\\\\software\\\\microsoft\\\\internet\\ explorer\\\\urlsearchhooks* or *\\\\software\\\\microsoft\\\\internet\\ explorer\\\\desktop\\\\components* or *\\\\software\\\\classes\\\\clsid\\\\\\{ab8902b4\\-09ca\\-4bb6\\-b78d\\-a8f59079a8d5\\}\\\\inprocserver32* or *\\\\control\\ panel\\\\desktop\\\\scrnsave.exe*)) and (not ((winlog.event_data.details:\"\\(empty\\)\") or (winlog.event_data.targetobject:(*\\\\office\\\\clicktorun\\\\registry\\\\machine\\\\software\\\\classes\\\\protocols\\\\handler\\\\* or *\\\\clicktorunstore\\\\hkmu\\\\software\\\\classes\\\\protocols\\\\handler\\\\*) or winlog.event_data.details:(\"\\{314111c7\\-a502\\-11d2\\-bbca\\-00c04f8ec294\\}\" or \"\\{3459b272\\-cc19\\-4448\\-86c9\\-ddc3b4b2fad3\\}\" or \"\\{42089d2d\\-912d\\-4018\\-9087\\-2b87803e93fb\\}\" or \"\\{5504be45\\-a83b\\-4808\\-900a\\-3a5c36e7f77a\\}\" or \"\\{807583e5\\-5146\\-11d5\\-a672\\-00b0d022e945\\}\")) or (winlog.event_data.targetobject:*\\\\software\\\\microsoft\\\\active\\ setup\\\\installed\\ components\\\\\\{8a69d345\\-d564\\-463c\\-aff1\\-a69d9e530f96\\}\\\\*) or (winlog.event_data.targetobject:*\\\\software\\\\microsoft\\\\active\\ setup\\\\installed\\ components\\\\\\{9459c573\\-b17a\\-45ae\\-9f64\\-1857b5d58cee\\}\\\\*) or (winlog.event_data.targetobject:*\\\\software\\\\microsoft\\\\active\\ setup\\\\installed\\ components\\\\\\{89820200\\-ecbd\\-11cf\\-8b85\\-00aa005b4383\\}\\\\*) or (process.executable:(\"c\\:\\\\windows\\\\system32\\\\poqexec.exe\" or \"c\\:\\\\program\\ files\\ \\(x86\\)\\\\microsoft\\ office\\\\root\\\\integration\\\\integrator.exe\")) or (process.executable:(c\\:\\\\program\\ files\\\\common\\ files\\\\microsoft\\ shared\\\\clicktorun\\\\* or c\\:\\\\program\\ files\\\\common\\ files\\\\microsoft\\ shared\\\\clicktorun\\\\updates\\\\*) and process.executable:*\\\\officeclicktorun.exe))))
<li><a href="#">query: ((winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:(*\\\\software\\\\wow6432node\\\\microsoft\\\\windows\\ ce\\ services\\\\autostart* or *\\\\software\\\\wow6432node\\\\microsoft\\\\command\\ processor\\\\autorun* or *\\\\software\\\\wow6432node\\\\microsoft\\\\active\\ setup\\\\installed\\ components* or *\\\\software\\\\microsoft\\\\windows\\ ce\\ services\\\\autostartondisconnect* or *\\\\software\\\\microsoft\\\\windows\\ ce\\ services\\\\autostartonconnect* or *\\\\system\\\\setup\\\\cmdline* or *\\\\software\\\\microsoft\\\\ctf\\\\langbaraddin* or *\\\\software\\\\microsoft\\\\command\\ processor\\\\autorun* or *\\\\software\\\\microsoft\\\\active\\ setup\\\\installed\\ components* or *\\\\software\\\\classes\\\\protocols\\\\handler* or *\\\\software\\\\classes\\\\protocols\\\\filter* or *\\\\software\\\\classes\\\\htmlfile\\\\shell\\\\open\\\\command\\\\\\(default\\)* or *\\\\environment\\\\userinitmprlogonscript* or *\\\\software\\\\policies\\\\microsoft\\\\windows\\\\control\\ panel\\\\desktop\\\\scrnsave.exe* or *\\\\software\\\\microsoft\\\\internet\\ explorer\\\\urlsearchhooks* or *\\\\software\\\\microsoft\\\\internet\\ explorer\\\\desktop\\\\components* or *\\\\software\\\\classes\\\\clsid\\\\\\{ab8902b4\\-09ca\\-4bb6\\-b78d\\-a8f59079a8d5\\}\\\\inprocserver32* or *\\\\control\\ panel\\\\desktop\\\\scrnsave.exe*)) and (not ((winlog.event_data.details:\"\\(empty\\)\") or (winlog.event_data.targetobject:(*\\\\office\\\\clicktorun\\\\registry\\\\machine\\\\software\\\\classes\\\\protocols\\\\handler\\\\* or *\\\\clicktorunstore\\\\hkmu\\\\software\\\\classes\\\\protocols\\\\handler\\\\*) or winlog.event_data.details:(\"\\{314111c7\\-a502\\-11d2\\-bbca\\-00c04f8ec294\\}\" or \"\\{3459b272\\-cc19\\-4448\\-86c9\\-ddc3b4b2fad3\\}\" or \"\\{42089d2d\\-912d\\-4018\\-9087\\-2b87803e93fb\\}\" or \"\\{5504be45\\-a83b\\-4808\\-900a\\-3a5c36e7f77a\\}\" or \"\\{807583e5\\-5146\\-11d5\\-a672\\-00b0d022e945\\}\")) or (winlog.event_data.targetobject:*\\\\software\\\\microsoft\\\\active\\ setup\\\\installed\\ components\\\\\\{8a69d345\\-d564\\-463c\\-aff1\\-a69d9e530f96\\}\\\\*))))
<li><a href="#">query: ((winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:(*\\\\software\\\\wow6432node\\\\microsoft\\\\windows\\ ce\\ services\\\\autostart* or *\\\\software\\\\wow6432node\\\\microsoft\\\\command\\ processor\\\\autorun* or *\\\\software\\\\wow6432node\\\\microsoft\\\\active\\ setup\\\\installed\\ components* or *\\\\software\\\\microsoft\\\\windows\\ ce\\ services\\\\autostartondisconnect* or *\\\\software\\\\microsoft\\\\windows\\ ce\\ services\\\\autostartonconnect* or *\\\\system\\\\setup\\\\cmdline* or *\\\\software\\\\microsoft\\\\ctf\\\\langbaraddin* or *\\\\software\\\\microsoft\\\\command\\ processor\\\\autorun* or *\\\\software\\\\microsoft\\\\active\\ setup\\\\installed\\ components* or *\\\\software\\\\classes\\\\protocols\\\\handler* or *\\\\software\\\\classes\\\\protocols\\\\filter* or *\\\\software\\\\classes\\\\htmlfile\\\\shell\\\\open\\\\command\\\\\\(default\\)* or *\\\\environment\\\\userinitmprlogonscript* or *\\\\software\\\\policies\\\\microsoft\\\\windows\\\\control\\ panel\\\\desktop\\\\scrnsave.exe* or *\\\\software\\\\microsoft\\\\internet\\ explorer\\\\urlsearchhooks* or *\\\\software\\\\microsoft\\\\internet\\ explorer\\\\desktop\\\\components* or *\\\\software\\\\classes\\\\clsid\\\\\\{ab8902b4\\-09ca\\-4bb6\\-b78d\\-a8f59079a8d5\\}\\\\inprocserver32* or *\\\\control\\ panel\\\\desktop\\\\scrnsave.exe*)) and (not (winlog.event_data.details:\"\\(empty\\)\")))
<li><a href="#">query: ((winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:(hkcr\\\\clsid\\\\* or hkcu\\\\software\\\\classes\\\\clsid\\\\*) and winlog.event_data.targetobject:*\\\\inprocserver32\\\\\\(default\\)) and (not ((winlog.event_data.details:(*%%systemroot%%\\\\system32\\\\* or *%%systemroot%%\\\\syswow64\\\\*)) or (winlog.event_data.details:(*\\\\appdata\\\\local\\\\microsoft\\\\onedrive\\\\* or *\\\\filecoauthlib64.dll* or *\\\\filesyncshell64.dll* or *\\\\filesyncapi64.dll*)) or (process.executable.text:\"c:\\windows\\system32\\securityhealthservice.exe\") or (winlog.event_data.details:*\\\\appdata\\\\local\\\\microsoft\\\\teamsmeetingaddin\\\\* and winlog.event_data.details:*\\\\microsoft.teams.addinloader.dll*) or (winlog.event_data.details:*\\\\appdata\\\\roaming\\\\dropbox\\\\* and winlog.event_data.details:*\\\\dropboxext64.\\*.dll*) or (winlog.event_data.details:*tmopieplg.dll) or (process.executable.text:(\"c:\\windows\\system32\\wuauclt.exe\" or \"c:\\windows\\system32\\svchost.exe\")) or ((process.executable.text:(c\\:\\\\programdata\\\\microsoft\\\\windows\\ defender\\\\platform\\\\* or c\\:\\\\program\\ files\\\\windows\\ defender\\\\*) and process.executable.text:*\\\\msmpeng.exe)) or (winlog.event_data.details:*\\\\filerepository\\\\nvmdi.inf*) or (process.executable.text:*\\\\microsoftedgeupdatecomregistershell64.exe) or (process.executable.text:\"c:\\windows\\system32\\dxdiag.exe\") or (winlog.event_data.details:(\"c:\\windows\\pyshellext.amd64.dll\" or \"c:\\windows\\pyshellext.dll\")) or (winlog.event_data.details:(\"c:\\windows\\system32\\dnssdx.dll\" or \"c:\\windows\\syswow64\\dnssdx.dll\")) or (winlog.event_data.details:\"c:\\windows\\system32\\spool\\drivers\\x64\\3\\printconfig.dll\") or (winlog.event_data.details:(c\\:\\\\program\\ files\\\\* or c\\:\\\\program\\ files\\ \\(x86\\)\\\\*)) or (winlog.event_data.details:c\\:\\\\programdata\\\\microsoft\\\\*) or (winlog.event_data.details:*c\\:\\\\windows\\\\system32\\\\gamingservicesproxy.dll*) or ((process.executable.text:\"c:\\windows\\system32\\poqexec.exe\" and winlog.event_data.details:*c\\:\\\\windows\\\\system32\\\\autopilot.dll*)) or ((process.executable.text:\"c:\\windows\\system32\\securityhealthservice.exe\" and winlog.event_data.details:*c\\:\\\\windows\\\\system32\\\\securityhealth*)) or ((process.executable.text:(\"c:\\windows\\system32\\poqexec.exe\" or \"c:\\windows\\system32\\regsvr32.exe\") and winlog.event_data.targetobject:*\\\\inprocserver32\\\\\\(default\\))))))
<li><a href="#">query: ((winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:(hkcr\\\\clsid\\\\* or hkcu\\\\software\\\\classes\\\\clsid\\\\*) and winlog.event_data.targetobject:*\\\\inprocserver32\\\\\\(default\\)) and (not ((winlog.event_data.details:(*%%systemroot%%\\\\system32\\\\* or *%%systemroot%%\\\\syswow64\\\\*)) or (winlog.event_data.details:(*\\\\appdata\\\\local\\\\microsoft\\\\onedrive\\\\* or *\\\\filecoauthlib64.dll* or *\\\\filesyncshell64.dll* or *\\\\filesyncapi64.dll*)) or (winlog.event_data.details:*\\\\appdata\\\\local\\\\microsoft\\\\teamsmeetingaddin\\\\* and winlog.event_data.details:*\\\\microsoft.teams.addinloader.dll*) or (winlog.event_data.details:*\\\\appdata\\\\roaming\\\\dropbox\\\\* and winlog.event_data.details:*\\\\dropboxext64.*.dll*) or (winlog.event_data.details:*tmopieplg.dll) or (process.executable:(\"c\\:\\\\windows\\\\system32\\\\wuauclt.exe\" or \"c\\:\\\\windows\\\\system32\\\\svchost.exe\")) or (process.executable:(*c\\:\\\\programdata\\\\microsoft\\\\windows\\ defender\\\\platform\\\\* or *c\\:\\\\program\\ files\\\\windows\\ defender\\\\*) and process.executable:*\\\\msmpeng.exe*) or (winlog.event_data.details:*\\\\filerepository\\\\nvmdi.inf*) or (process.executable:*\\\\microsoftedgeupdatecomregistershell64.exe) or (process.executable:\"c\\:\\\\windows\\\\system32\\\\dxdiag.exe\") or (winlog.event_data.details:(\"c\\:\\\\windows\\\\pyshellext.amd64.dll\" or \"c\\:\\\\windows\\\\pyshellext.dll\")) or (winlog.event_data.details:(\"c\\:\\\\windows\\\\system32\\\\dnssdx.dll\" or \"c\\:\\\\windows\\\\syswow64\\\\dnssdx.dll\")) or (winlog.event_data.details:(c\\:\\\\program\\ files\\\\* or c\\:\\\\program\\ files\\ \\(x86\\)\\\\*)) or (winlog.event_data.details:*c\\:\\\\windows\\\\system32\\\\gamingservicesproxy.dll*))))
<li><a href="#">query: ((winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:(hkcr\\\\clsid\\\\* or hkcu\\\\software\\\\classes\\\\clsid\\\\*) and winlog.event_data.targetobject:*\\\\inprocserver32\\\\\\(default\\)) and (not ((winlog.event_data.details:(*%%systemroot%%\\\\system32\\\\* or *%%systemroot%%\\\\syswow64\\\\*)) or (winlog.event_data.details:(*\\\\appdata\\\\local\\\\microsoft\\\\onedrive\\\\* or *\\\\filecoauthlib64.dll* or *\\\\filesyncshell64.dll* or *\\\\filesyncapi64.dll*)) or (winlog.event_data.details:*\\\\appdata\\\\local\\\\microsoft\\\\teamsmeetingaddin\\\\* and winlog.event_data.details:*\\\\microsoft.teams.addinloader.dll*) or (winlog.event_data.details:*\\\\appdata\\\\roaming\\\\dropbox\\\\* and winlog.event_data.details:*\\\\dropboxext64.*.dll*) or (winlog.event_data.details:*tmopieplg.dll) or (process.executable:(\"c\\:\\\\windows\\\\system32\\\\wuauclt.exe\" or \"c\\:\\\\windows\\\\system32\\\\svchost.exe\")) or (process.executable:*c\\:\\\\programdata\\\\microsoft\\\\windows\\ defender\\\\platform\\\\* and process.executable:*\\\\msmpeng.exe*) or (winlog.event_data.details:*\\\\filerepository\\\\nvmdi.inf*) or (process.executable:*\\\\microsoftedgeupdatecomregistershell64.exe) or (process.executable:\"c\\:\\\\windows\\\\system32\\\\dxdiag.exe\") or (winlog.event_data.details:(\"c\\:\\\\windows\\\\pyshellext.amd64.dll\" or \"c\\:\\\\windows\\\\pyshellext.dll\")) or (winlog.event_data.details:(\"c\\:\\\\windows\\\\system32\\\\dnssdx.dll\" or \"c\\:\\\\windows\\\\syswow64\\\\dnssdx.dll\")) or (winlog.event_data.details:(c\\:\\\\program\\ files\\\\* or c\\:\\\\program\\ files\\ \\(x86\\)\\\\*)) or (winlog.event_data.details:*c\\:\\\\windows\\\\system32\\\\gamingservicesproxy.dll*))))
<li><a href="#">query: ((winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:(hklm\\\\system\\\\currentcontrolset\\\\control\\\\safeboot\\\\minimal\\\\* or hklm\\\\system\\\\currentcontrolset\\\\control\\\\safeboot\\\\network\\\\*) and winlog.event_data.targetobject:*\\\\\\(default\\) and winlog.event_data.details:\"service\") and (not ((process.executable:\"c\\:\\\\windows\\\\system32\\\\msiexec.exe\" and winlog.event_data.targetobject:(\"hklm\\\\system\\\\currentcontrolset\\\\control\\\\safeboot\\\\minimal\\\\savservice\\\\\\(default\\)\" or \"hklm\\\\system\\\\currentcontrolset\\\\control\\\\safeboot\\\\network\\\\savservice\\\\\\(default\\)\")))))
<li><a href="#">query: ((winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:*\\\\clsid\\\\\\{52a2aaae\\-085d\\-4187\\-97ea\\-8c30db990436\\}\\\\inprocserver32\\\\\\(default\\)*) and (not (winlog.event_data.details:\"c\\:\\\\windows\\\\system32\\\\hhctrl.ocx\")))
<li><a href="#">query: ((winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:*\\\\clsid\\\\\\{fdb00e52\\-a214\\-4aa1\\-8fba\\-4357bb0072ec\\}\\\\inprocserver32\\\\\\(default\\)) and (not (winlog.event_data.details:\"%windir%\\system32\\amsi.dll\")))
<li><a href="#">query: ((winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:*\\\\control\\\\print\\\\environments\\\\windows\\ x64\\\\drivers* and winlog.event_data.targetobject:*\\\\manufacturer* and winlog.event_data.details:\"\\(empty\\)\") and (not ((winlog.event_data.targetobject:*\\\\cutepdf\\ writer\\ v4.0\\\\*) or (winlog.event_data.targetobject:(*\\\\vnc\\ printer\\ \\(ps\\)\\\\* or *\\\\vnc\\ printer\\ \\(ud\\)\\\\*)))))
<li><a href="#">query: ((winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:*\\\\control\\\\print\\\\environments\\\\windows\\ x64\\\\drivers* and winlog.event_data.targetobject:*\\\\manufacturer* and winlog.event_data.details:\"\\(empty\\)\") and (not ((winlog.event_data.targetobject:*\\\\cutepdf\\ writer\\ v4.0\\\\*))))
<li><a href="#">query: ((winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:*\\\\environment\\\\*) and ((winlog.event_data.details:(\"powershell\" or \"pwsh\")) or (winlog.event_data.details:(*\\\\appdata\\\\local\\\\temp\\\\* or *c\\:\\\\users\\\\public\\\\* or *tvqqaamaaaaeaaaa* or *tvpqaaiaaaaeaa8a* or *tvqaaaeaaaaeabaa* or *tvoaaaaaaaaaaaaa* or *tvptaqeaaaaeaaaa* or *sw52b2tll* or *ludm9rzs* or *jbnzva2ut* or *sqbuahyabwbragualq* or *kabgb2ag8aawblac0a* or *jag4adgbvagsazqata*)) or (winlog.event_data.details:(suvy* or sqbfaf* or sqbuah* or cwbha* or awv4* or aqbla* or r2v0* or dmfy* or dgbha* or dxnpbm* or h4sia* or y21k* or cabhah* or qzpc* or yzpc*))))
<li><a href="#">query: ((winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:*\\\\microsoft\\\\.netframework\\\\dbgmanageddebugger) and (not (winlog.event_data.details:\"\\\"c\\:\\\\windows\\\\system32\\\\vsjitdebugger.exe\\\"\\ pid\\ %d\\ appdom\\ %d\\ extext\\ \\\"%s\\\"\\ evthdl\\ %d\")))
<li><a href="#">query: ((winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:*\\\\microsoft\\\\windows\\ defender\\\\features\\\\tamperprotection* and winlog.event_data.details:\"dword\\ \\(0x00000000\\)\") and (not ((process.executable:c\\:\\\\programdata\\\\microsoft\\\\windows\\ defender\\\\platform\\\\* and process.executable:*\\\\msmpeng.exe) or (process.executable:\"c\\:\\\\program\\ files\\\\windows\\ defender\\\\msmpeng.exe\"))))
<li><a href="#">query: ((winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:*\\\\microsoft\\\\windows\\\\currentversion\\\\policies\\\\explorer\\\\run) and (winlog.event_data.details:(c\\:\\\\windows\\\\temp\\\\* or c\\:\\\\programdata\\\\* or c\\:\\\\$recycle.bin\\\\* or c\\:\\\\temp\\\\* or c\\:\\\\users\\\\public\\\\* or c\\:\\\\users\\\\default\\\\*) or winlog.event_data.details:*\\\\appdata\\\\*))
<li><a href="#">query: ((winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:*\\\\software\\\\classes* and winlog.event_data.targetobject:(*\\\\folder\\\\shellex\\\\extshellfolderviews* or *\\\\folder\\\\shellex\\\\dragdrophandlers* or *\\\\folder\\\\shellex\\\\columnhandlers* or *\\\\filter* or *\\\\exefile\\\\shell\\\\open\\\\command\\\\\\(default\\)* or *\\\\directory\\\\shellex\\\\dragdrophandlers* or *\\\\directory\\\\shellex\\\\copyhookhandlers* or *\\\\clsid\\\\\\{ac757296\\-3522\\-4e11\\-9862\\-c17be5a1767e\\}\\\\instance* or *\\\\clsid\\\\\\{abe3b9a4\\-257d\\-4b97\\-bd1a\\-294af496222e\\}\\\\instance* or *\\\\clsid\\\\\\{7ed96837\\-96f0\\-4812\\-b211\\-f13c24117ed3\\}\\\\instance* or *\\\\clsid\\\\\\{083863f1\\-70de\\-11d0\\-bd40\\-00a0c911ce86\\}\\\\instance* or *\\\\classes\\\\allfilesystemobjects\\\\shellex\\\\dragdrophandlers* or *\\\\.exe* or *\\\\.cmd* or *\\\\shellex\\\\propertysheethandlers* or *\\\\shellex\\\\contextmenuhandlers*)) and (not ((winlog.event_data.details:\"\\(empty\\)\") or (winlog.event_data.details:\"\\{807583e5\\-5146\\-11d5\\-a672\\-00b0d022e945\\}\") or (process.executable:\"c\\:\\\\windows\\\\system32\\\\drvinst.exe\"))))
<li><a href="#">query: ((winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:*\\\\software\\\\classes* and winlog.event_data.targetobject:(*\\\\folder\\\\shellex\\\\extshellfolderviews* or *\\\\folder\\\\shellex\\\\dragdrophandlers* or *\\\\folder\\\\shellex\\\\columnhandlers* or *\\\\filter* or *\\\\exefile\\\\shell\\\\open\\\\command\\\\\\(default\\)* or *\\\\directory\\\\shellex\\\\dragdrophandlers* or *\\\\directory\\\\shellex\\\\copyhookhandlers* or *\\\\clsid\\\\\\{ac757296\\-3522\\-4e11\\-9862\\-c17be5a1767e\\}\\\\instance* or *\\\\clsid\\\\\\{abe3b9a4\\-257d\\-4b97\\-bd1a\\-294af496222e\\}\\\\instance* or *\\\\clsid\\\\\\{7ed96837\\-96f0\\-4812\\-b211\\-f13c24117ed3\\}\\\\instance* or *\\\\clsid\\\\\\{083863f1\\-70de\\-11d0\\-bd40\\-00a0c911ce86\\}\\\\instance* or *\\\\classes\\\\allfilesystemobjects\\\\shellex\\\\dragdrophandlers* or *\\\\.exe* or *\\\\.cmd* or *\\\\shellex\\\\propertysheethandlers* or *\\\\shellex\\\\contextmenuhandlers*)) and (not ((winlog.event_data.details:\"\\(empty\\)\") or (winlog.event_data.details:\"\\{807583e5\\-5146\\-11d5\\-a672\\-00b0d022e945\\}\"))))
<li><a href="#">query: ((winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:*\\\\software\\\\microsoft\\\\wab\\\\dllpath) and (not (winlog.event_data.details:\"%commonprogramfiles%\\\\system\\\\wab32.dll\")))
<li><a href="#">query: ((winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:*\\\\software\\\\microsoft\\\\windows\\ defender\\\\*) and ((winlog.event_data.targetobject:(*\\\\real\\-time\\ protection\\\\disablebehaviormonitoring or *\\\\real\\-time\\ protection\\\\disableioavprotection or *\\\\real\\-time\\ protection\\\\disableonaccessprotection or *\\\\real\\-time\\ protection\\\\disablerealtimemonitoring or *\\\\real\\-time\\ protection\\\\disablescanonrealtimeenable or *\\\\spynet\\\\disableblockatfirstseen or *\\\\disableantispyware or *\\\\disableantivirus) and winlog.event_data.details:\"dword\\ \\(0x00000001\\)\") or (winlog.event_data.targetobject:(*\\\\spynet\\\\spynetreporting or *\\\\spynet\\\\submitsamplesconsent or *\\\\mpengine\\\\mpenablepus) and winlog.event_data.details:\"dword\\ \\(0x00000000\\)\")))
<li><a href="#">query: ((winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:*\\\\software\\\\microsoft\\\\windows\\ nt\\\\currentversion* and winlog.event_data.targetobject:(*\\\\winlogon\\\\vmapplet* or *\\\\winlogon\\\\userinit* or *\\\\winlogon\\\\taskman* or *\\\\winlogon\\\\shell* or *\\\\winlogon\\\\gpextensions* or *\\\\winlogon\\\\appsetup* or *\\\\winlogon\\\\alternateshells\\\\availableshells* or *\\\\windows\\\\iconservicelib* or *\\\\windows\\\\appinit_dlls* or *\\\\image\\ file\\ execution\\ options* or *\\\\font\\ drivers* or *\\\\drivers32* or *\\\\windows\\\\run* or *\\\\windows\\\\load*)) and (not ((winlog.event_data.details:\"\\(empty\\)\") or (process.executable:c\\:\\\\program\\ files\\ \\(x86\\)\\\\microsoft\\\\temp\\\\* and process.executable:*\\\\microsoftedgeupdate.exe) or (winlog.event_data.targetobject:(*\\\\clicktorunstore\\\\hklm\\\\software\\\\microsoft\\\\windows\\ nt\\\\currentversion\\\\* or *\\\\clicktorun\\\\registry\\\\machine\\\\software\\\\microsoft\\\\windows\\ nt\\\\currentversion\\\\*) or process.executable:(\"c\\:\\\\program\\ files\\\\microsoft\\ office\\\\root\\\\integration\\\\integrator.exe\" or \"c\\:\\\\program\\ files\\ \\(x86\\)\\\\microsoft\\ office\\\\root\\\\integration\\\\integrator.exe\") or winlog.event_data.targetobject:(*\\\\image\\ file\\ execution\\ options\\\\ospprearm.exe\\\\disableexceptionchainvalidation or *\\\\image\\ file\\ execution\\ options\\\\liclua.exe\\\\disableexceptionchainvalidation)) or (process.executable:*\\\\dropboxupdate.exe and winlog.event_data.targetobject:*\\\\image\\ file\\ execution\\ options\\\\dropboxupdate.exe\\\\disableexceptionchainvalidation) or (process.executable:(c\\:\\\\program\\ files\\\\common\\ files\\\\microsoft\\ shared\\\\clicktorun\\\\* or c\\:\\\\program\\ files\\\\common\\ files\\\\microsoft\\ shared\\\\clicktorun\\\\updates\\\\*) and process.executable:*\\\\officeclicktorun.exe))))
<li><a href="#">query: ((winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:*\\\\software\\\\microsoft\\\\windows\\ nt\\\\currentversion* and winlog.event_data.targetobject:(*\\\\winlogon\\\\vmapplet* or *\\\\winlogon\\\\userinit* or *\\\\winlogon\\\\taskman* or *\\\\winlogon\\\\shell* or *\\\\winlogon\\\\gpextensions* or *\\\\winlogon\\\\appsetup* or *\\\\winlogon\\\\alternateshells\\\\availableshells* or *\\\\windows\\\\iconservicelib* or *\\\\windows\\\\appinit_dlls* or *\\\\image\\ file\\ execution\\ options* or *\\\\font\\ drivers* or *\\\\drivers32* or *\\\\windows\\\\run* or *\\\\windows\\\\load*)) and (not ((winlog.event_data.details:\"\\(empty\\)\") or (process.executable:c\\:\\\\program\\ files\\ \\(x86\\)\\\\microsoft\\\\temp\\\\* and process.executable:*\\\\microsoftedgeupdate.exe) or (winlog.event_data.targetobject:(*\\\\clicktorunstore\\\\hklm\\\\software\\\\microsoft\\\\windows\\ nt\\\\currentversion\\\\* or *\\\\clicktorun\\\\registry\\\\machine\\\\software\\\\microsoft\\\\windows\\ nt\\\\currentversion\\\\*) or process.executable:(\"c\\:\\\\program\\ files\\\\microsoft\\ office\\\\root\\\\integration\\\\integrator.exe\" or \"c\\:\\\\program\\ files\\ \\(x86\\)\\\\microsoft\\ office\\\\root\\\\integration\\\\integrator.exe\") or winlog.event_data.targetobject:(*\\\\image\\ file\\ execution\\ options\\\\ospprearm.exe\\\\disableexceptionchainvalidation or *\\\\image\\ file\\ execution\\ options\\\\liclua.exe\\\\disableexceptionchainvalidation)) or (process.executable:*\\\\dropboxupdate.exe and winlog.event_data.targetobject:*\\\\image\\ file\\ execution\\ options\\\\dropboxupdate.exe\\\\disableexceptionchainvalidation))))
<li><a href="#">query: ((winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:*\\\\software\\\\microsoft\\\\windows\\ nt\\\\currentversion* and winlog.event_data.targetobject:(*\\\\winlogon\\\\vmapplet* or *\\\\winlogon\\\\userinit* or *\\\\winlogon\\\\taskman* or *\\\\winlogon\\\\shell* or *\\\\winlogon\\\\gpextensions* or *\\\\winlogon\\\\appsetup* or *\\\\winlogon\\\\alternateshells\\\\availableshells* or *\\\\windows\\\\iconservicelib* or *\\\\windows\\\\appinit_dlls* or *\\\\image\\ file\\ execution\\ options* or *\\\\font\\ drivers* or *\\\\drivers32* or *\\\\windows\\\\run* or *\\\\windows\\\\load*)) and (not ((winlog.event_data.details:\"\\(empty\\)\") or (winlog.event_data.targetobject:*\\\\image\\ file\\ execution\\ options\\\\* and winlog.event_data.targetobject:(*\\\\disableexceptionchainvalidation or *\\\\mitigationoptions)) or (process.executable:c\\:\\\\program\\ files\\ \\(x86\\)\\\\microsoft\\\\temp\\\\* and process.executable:*\\\\microsoftedgeupdate.exe) or (winlog.event_data.targetobject:(*\\\\clicktorunstore\\\\hklm\\\\software\\\\microsoft\\\\windows\\ nt\\\\currentversion\\\\* or *\\\\clicktorun\\\\registry\\\\machine\\\\software\\\\microsoft\\\\windows\\ nt\\\\currentversion\\\\*) or process.executable:(\"c\\:\\\\program\\ files\\\\microsoft\\ office\\\\root\\\\integration\\\\integrator.exe\" or \"c\\:\\\\program\\ files\\ \\(x86\\)\\\\microsoft\\ office\\\\root\\\\integration\\\\integrator.exe\")) or (process.executable:(c\\:\\\\program\\ files\\\\common\\ files\\\\microsoft\\ shared\\\\clicktorun\\\\* or c\\:\\\\program\\ files\\\\common\\ files\\\\microsoft\\ shared\\\\clicktorun\\\\updates\\\\*) and process.executable:*\\\\officeclicktorun.exe) or (process.executable:\"c\\:\\\\windows\\\\system32\\\\svchost.exe\" and winlog.event_data.targetobject:(*\\\\winlogon\\\\gpextensions\\\\\\{827d319e\\-6eac\\-11d2\\-a4ea\\-00c04f79f83a\\}\\\\previouspolicyareas* or *\\\\winlogon\\\\gpextensions\\\\\\{827d319e\\-6eac\\-11d2\\-a4ea\\-00c04f79f83a\\}\\\\maxnogpolistchangesinterval*) and winlog.event_data.details:(\"dword\\ \\(0x00000009\\)\" or \"dword\\ \\(0x000003c0\\)\")) or (process.executable:c\\:\\\\windows\\\\microsoft.net\\\\framework* and process.executable:*\\\\ngen.exe) or (process.executable:*\\\\appdata\\\\local\\\\microsoft\\\\onedrive\\\\standaloneupdater\\\\onedrivesetup.exe and winlog.event_data.targetobject:*\\\\microsoft\\\\windows\\\\currentversion\\\\runonce\\\\delete\\ cached\\ update\\ binary and winlog.event_data.details:c\\:\\\\windows\\\\system32\\\\cmd.exe\\ \\/q\\ \\/c\\ del\\ \\/q\\ \\\"c\\:\\\\users\\\\* and winlog.event_data.details:*\\\\appdata\\\\local\\\\microsoft\\\\onedrive\\\\update\\\\onedrivesetup.exe\\\"))))
<li><a href="#">query: ((winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:*\\\\software\\\\microsoft\\\\windows\\ nt\\\\currentversion\\\\aedebug\\\\debugger* and winlog.event_data.details:*.dll) and (not (winlog.event_data.details:\"\\\"c\\:\\\\windows\\\\system32\\\\vsjitdebugger.exe\\\"\\ \\-p\\ %ld\\ \\-e\\ %ld\\ \\-j\\ 0x%p\")))
<li><a href="#">query: ((winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:*\\\\software\\\\microsoft\\\\windows\\ nt\\\\currentversion\\\\appcompatflags\\\\telemetrycontroller\\\\* and winlog.event_data.targetobject:*\\\\command* and winlog.event_data.details:*.exe*) and (not (winlog.event_data.details:(*\\\\system32\\\\compattelrunner.exe* or *\\\\system32\\\\devicecensus.exe*))))
<li><a href="#">query: ((winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:*\\\\software\\\\microsoft\\\\windows\\\\currentversion* and winlog.event_data.targetobject:(*\\\\shellserviceobjectdelayload* or *\\\\run\\\\* or *\\\\runonce\\\\* or *\\\\policies\\\\system\\\\shell* or *\\\\policies\\\\explorer\\\\run* or *\\\\group\\ policy\\\\scripts\\\\startup* or *\\\\group\\ policy\\\\scripts\\\\shutdown* or *\\\\group\\ policy\\\\scripts\\\\logon* or *\\\\group\\ policy\\\\scripts\\\\logoff* or *\\\\explorer\\\\shellserviceobjects* or *\\\\explorer\\\\shelliconoverlayidentifiers* or *\\\\explorer\\\\shellexecutehooks* or *\\\\explorer\\\\sharedtaskscheduler* or *\\\\explorer\\\\browser\\ helper\\ objects* or *\\\\authentication\\\\plap\\ providers* or *\\\\authentication\\\\credential\\ providers* or *\\\\authentication\\\\credential\\ provider\\ filters*)) and (not ((winlog.event_data.details:\"\\(empty\\)\" or winlog.event_data.targetobject:*\\\\ngcfirst\\\\consecutiveswitchcount or process.executable:(*\\\\appdata\\\\local\\\\microsoft\\\\onedrive\\\\update\\\\onedrivesetup.exe or *\\\\appdata\\\\roaming\\\\spotify\\\\spotify.exe) or process.executable:(\"c\\:\\\\windows\\\\system32\\\\devicecensus.exe\" or \"c\\:\\\\program\\ files\\\\microsoft\\ onedrive\\\\standaloneupdater\\\\onedrivesetup.exe\" or \"c\\:\\\\program\\ files\\\\keepass\\ password\\ safe\\ 2\\\\shinstutil.exe\" or \"c\\:\\\\program\\ files\\\\everything\\\\everything.exe\" or \"c\\:\\\\program\\ files\\\\common\\ files\\\\microsoft\\ shared\\\\clicktorun\\\\officeclicktorun.exe\" or \"c\\:\\\\program\\ files\\ \\(x86\\)\\\\microsoft\\ office\\\\root\\\\integration\\\\integrator.exe\")) or (process.executable:(c\\:\\\\program\\ files\\ \\(x86\\)\\\\microsoft\\\\edgeupdate\\\\install\\\\* or c\\:\\\\program\\ files\\ \\(x86\\)\\\\microsoft\\\\edgewebview\\\\* or c\\:\\\\program\\ files\\ \\(x86\\)\\\\microsoft\\\\edge\\\\application\\\\msedge.exe*)) or (process.executable:\"c\\:\\\\windows\\\\system32\\\\regsvr32.exe\" and winlog.event_data.targetobject:*dropboxext* and winlog.event_data.details:*a251\\-47b7\\-93e1\\-cdd82e34af8b\\}) or (winlog.event_data.targetobject:*\\\\software\\\\microsoft\\\\windows\\\\currentversion\\\\run\\\\opera\\ browser\\ assistant and winlog.event_data.details:\"c\\:\\\\program\\ files\\\\opera\\\\assistant\\\\browser_assistant.exe\") or (winlog.event_data.targetobject:*\\\\software\\\\microsoft\\\\windows\\\\currentversion\\\\run\\\\ituneshelper and winlog.event_data.details:\"\\\"c\\:\\\\program\\ files\\\\itunes\\\\ituneshelper.exe\\\"\") or (winlog.event_data.targetobject:*\\\\software\\\\microsoft\\\\windows\\\\currentversion\\\\runonce\\\\zoommsirepair and winlog.event_data.details:\"\\\"c\\:\\\\program\\ files\\\\zoom\\\\bin\\\\installer.exe\\\"\\ \\/repair\") or (winlog.event_data.targetobject:*\\\\software\\\\microsoft\\\\windows\\\\currentversion\\\\run\\\\greenshot and winlog.event_data.details:\"c\\:\\\\program\\ files\\\\greenshot\\\\greenshot.exe\") or (winlog.event_data.targetobject:*\\\\software\\\\microsoft\\\\windows\\\\currentversion\\\\run\\\\googledrivefs and winlog.event_data.details:c\\:\\\\program\\ files\\\\google\\\\drive\\ file\\ stream\\\\* and winlog.event_data.details:*\\\\googledrivefs.exe\\ \\-\\-startup_mode) or (winlog.event_data.targetobject:*googledrive* and winlog.event_data.details:(\"\\{cfe8b367\\-77a7\\-41d7\\-9c90\\-75d16d7dc6b6\\}\" or \"\\{a8e52322\\-8734\\-481d\\-a7e2\\-27b309ef8d56\\}\" or \"\\{c973da94\\-cbdf\\-4e77\\-81d1\\-e5b794fbd146\\}\" or \"\\{51ef1569\\-67ee\\-4ad6\\-9646\\-e726c3ffc8a2\\}\")) or (winlog.event_data.details:c\\:\\\\windows\\\\system32\\\\cmd.exe\\ \\/q\\ \\/c\\ rmdir\\ \\/s\\ \\/q\\ \\\"c\\:\\\\users\\\\* and winlog.event_data.details:*\\\\appdata\\\\local\\\\microsoft\\\\onedrive\\\\*) or (winlog.event_data.targetobject:*\\\\software\\\\microsoft\\\\windows\\\\currentversion\\\\runonce\\\\\\{c60fd5ac\\-367d\\-4e3a\\-a975\\-f157502ac30a\\} and winlog.event_data.details:*\\\\appdata\\\\local\\\\package\\ cache\\\\\\{c60fd5ac\\-367d\\-4e3a\\-a975\\-f157502ac30a\\}\\\\python* and winlog.event_data.details:*.exe\\\"\\ \\/burn.runonce))))
<li><a href="#">query: ((winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:*\\\\software\\\\microsoft\\\\windows\\\\currentversion\\\\explorer\\\\typedpaths\\\\*) and (not process.executable.text:(\"c:\\windows\\explorer.exe\" or \"c:\\windows\\syswow64\\explorer.exe\")))
<li><a href="#">query: ((winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:*\\\\software\\\\microsoft\\\\windows\\\\currentversion\\\\explorer\\\\volumecaches\\\\*) and ((winlog.event_data.targetobject:*\\\\autorun* and winlog.event_data.details:\"dword\\ \\(0x00000001\\)\") or (winlog.event_data.targetobject:(*\\\\cleanupstring* or *\\\\precleanupstring*) and winlog.event_data.details:(*cmd* or *powershell* or *rundll32* or *mshta* or *cscript* or *wscript* or *wsl* or *\\\\users\\\\public\\\\* or *\\\\windows\\\\temp\\\\* or *\\\\microsoft\\\\windows\\\\start\\ menu\\\\programs\\\\startup\\\\*))))
<li><a href="#">query: ((winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:*\\\\software\\\\microsoft\\\\windows\\\\currentversion\\\\internet\\ settings*) and (not (((winlog.event_data.details:dword*)) or ((winlog.event_data.details:(\"cookie:\" or \"visited:\" or \"(empty)\"))) or ((winlog.event_data.targetobject:(*\\\\cache* or *\\\\zonemap* or *\\\\wpaddecision*))) or ((winlog.event_data.details:\"binary data\")) or ((winlog.event_data.targetobject:*\\\\accepted\\ documents\\\\*)))))
<li><a href="#">query: ((winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:*\\\\software\\\\microsoft\\\\windows\\\\currentversion\\\\internet\\ settings*) and (not ((winlog.event_data.details:dword*) or (winlog.event_data.details:(\"cookie\\:\" or \"visited\\:\" or \"\\(empty\\)\")) or (winlog.event_data.details:\"binary\\ data\"))))
<li><a href="#">query: ((winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:*\\\\software\\\\microsoft\\\\windows\\\\currentversion\\\\internet\\ settings*) and (not ((winlog.event_data.details:dword*) or (winlog.event_data.details:(\"cookie\\:\" or \"visited\\:\" or \"\\(empty\\)\")) or (winlog.event_data.targetobject:(*\\\\cache* or *\\\\zonemap*)) or (winlog.event_data.details:\"binary\\ data\"))))
<li><a href="#">query: ((winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:*\\\\software\\\\microsoft\\\\windows\\\\currentversion\\\\internet\\ settings\\\\zonemap\\\\domains\\\\*) and (not (winlog.event_data.details:(\"dword\\ \\(0x00000000\\)\" or \"dword\\ \\(0x00000001\\)\" or \"\\(empty\\)\"))))
<li><a href="#">query: ((winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:*\\\\software\\\\microsoft\\\\windows\\\\currentversion\\\\policies\\\\associations\\\\*) and (((winlog.event_data.targetobject:*\\\\defaultfiletyperisk and winlog.event_data.details:\"dword (0x00006152)\")) or ((winlog.event_data.targetobject:*\\\\lowriskfiletypes and winlog.event_data.details:(*.zip;* or *.rar;* or *.exe;* or *.bat;* or *.com;* or *.cmd;* or *.reg;* or *.msi;* or *.htm;* or *.html;*)))))
<li><a href="#">query: ((winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:*\\\\software\\\\microsoft\\\\windows\\\\currentversion\\\\policies\\\\attachments\\\\*) and (((winlog.event_data.targetobject:*\\\\hidezoneinfoonproperties and winlog.event_data.details:\"dword (0x00000001)\")) or ((winlog.event_data.targetobject:*\\\\savezoneinformation and winlog.event_data.details:\"dword (0x00000002)\")) or ((winlog.event_data.targetobject:*\\\\scanwithantivirus and winlog.event_data.details:\"dword (0x00000001)\"))))
<li><a href="#">query: ((winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:*\\\\software\\\\policies\\\\microsoft\\\\windows\\\\system\\\\scripts* and winlog.event_data.targetobject:(*\\\\startup* or *\\\\shutdown* or *\\\\logon* or *\\\\logoff*)) and (not (winlog.event_data.details:\"\\(empty\\)\")))
<li><a href="#">query: ((winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:*\\\\software\\\\wow6432node\\\\classes* and winlog.event_data.targetobject:(*\\\\folder\\\\shellex\\\\extshellfolderviews* or *\\\\folder\\\\shellex\\\\dragdrophandlers* or *\\\\folder\\\\shellex\\\\columnhandlers* or *\\\\directory\\\\shellex\\\\dragdrophandlers* or *\\\\directory\\\\shellex\\\\copyhookhandlers* or *\\\\clsid\\\\\\{ac757296\\-3522\\-4e11\\-9862\\-c17be5a1767e\\}\\\\instance* or *\\\\clsid\\\\\\{abe3b9a4\\-257d\\-4b97\\-bd1a\\-294af496222e\\}\\\\instance* or *\\\\clsid\\\\\\{7ed96837\\-96f0\\-4812\\-b211\\-f13c24117ed3\\}\\\\instance* or *\\\\clsid\\\\\\{083863f1\\-70de\\-11d0\\-bd40\\-00a0c911ce86\\}\\\\instance* or *\\\\allfilesystemobjects\\\\shellex\\\\dragdrophandlers* or *\\\\shellex\\\\propertysheethandlers* or *\\\\shellex\\\\contextmenuhandlers*)) and (not (winlog.event_data.details:\"\\(empty\\)\")))
<li><a href="#">query: ((winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:*\\\\software\\\\wow6432node\\\\microsoft\\\\windows\\ nt\\\\currentversion* and winlog.event_data.targetobject:(*\\\\windows\\\\appinit_dlls* or *\\\\image\\ file\\ execution\\ options* or *\\\\drivers32*)) and (not (winlog.event_data.details:(\"\\(empty\\)\" or \"\\\\registry\\\\machine\\\\software\\\\microsoft\\\\windows\\ nt\\\\currentversion\\\\image\\ file\\ execution\\ options\"))))
<li><a href="#">query: ((winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:*\\\\software\\\\wow6432node\\\\microsoft\\\\windows\\\\currentversion* and winlog.event_data.targetobject:(*\\\\shellserviceobjectdelayload* or *\\\\run\\\\* or *\\\\runonce\\\\* or *\\\\explorer\\\\shellserviceobjects* or *\\\\explorer\\\\shelliconoverlayidentifiers* or *\\\\explorer\\\\shellexecutehooks* or *\\\\explorer\\\\sharedtaskscheduler* or *\\\\explorer\\\\browser\\ helper\\ objects*)) and (not ((winlog.event_data.details:\"\\(empty\\)\") or (process.executable:*c\\:\\\\program\\ files\\ \\(x86\\)\\\\microsoft\\\\edgeupdate\\\\install\\\\\\{* and process.executable:*\\\\setup.exe*) or (process.executable:\"c\\:\\\\program\\ files\\\\common\\ files\\\\microsoft\\ shared\\\\clicktorun\\\\officeclicktorun.exe\" and winlog.event_data.targetobject:*\\\\office\\\\clicktorun\\\\registry\\\\machine\\\\software\\\\wow6432node\\\\*) or (process.executable:(\"c\\:\\\\program\\ files\\\\microsoft\\ office\\\\root\\\\integration\\\\integrator.exe\" or \"c\\:\\\\program\\ files\\ \\(x86\\)\\\\microsoft\\ office\\\\root\\\\integration\\\\integrator.exe\") and winlog.event_data.targetobject:*\\\\explorer\\\\browser\\ helper\\ objects\\\\\\{31d09ba0\\-12f5\\-4cce\\-be8a\\-2923e76605da\\}\\\\*) or (winlog.event_data.details:*\\-a251\\-47b7\\-93e1\\-cdd82e34af8b\\} or winlog.event_data.details:\"grpconv\\ \\-o\" or winlog.event_data.details:*c\\:\\\\program\\ files* and winlog.event_data.details:*\\\\dropbox\\\\client\\\\dropbox.exe* and winlog.event_data.details:*\\ \\/systemstartup*) or (winlog.event_data.targetobject:*\\\\explorer\\\\browser\\ helper\\ objects\\\\\\{92ef2ead\\-a7ce\\-4424\\-b0db\\-499cf856608e\\}\\\\noexplorer) or (process.executable:*\\\\windowsdesktop\\-runtime\\-* and winlog.event_data.targetobject:(*\\\\wow6432node\\\\microsoft\\\\windows\\\\currentversion\\\\runonce\\\\\\{e2d1ae32\\-dd1d\\-4ad7\\-a298\\-10e42e7840fc\\} or *\\\\wow6432node\\\\microsoft\\\\windows\\\\currentversion\\\\runonce\\\\\\{7037b699\\-7382\\-448c\\-89a7\\-4765961d2537\\}) and winlog.event_data.details:(\\\"c\\:\\\\programdata\\\\package\\ cache\\\\\\{7037b699\\-7382\\-448c\\-89a7\\-4765961d2537\\}\\\\windowsdesktop\\-runtime\\-* or \\\"c\\:\\\\programdata\\\\package\\ cache\\\\\\{e2d1ae32\\-dd1d\\-4ad7\\-a298\\-10e42e7840fc\\}\\\\windowsdesktop\\-runtime\\-*) and winlog.event_data.details:*.exe\\\"\\ \\/burn.runonce) or (process.executable:(c\\:\\\\program\\ files\\\\common\\ files\\\\microsoft\\ shared\\\\clicktorun\\\\* or c\\:\\\\program\\ files\\\\common\\ files\\\\microsoft\\ shared\\\\clicktorun\\\\updates\\\\*) and process.executable:*\\\\officeclicktorun.exe))))
<li><a href="#">query: ((winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:*\\\\software\\\\wow6432node\\\\microsoft\\\\windows\\\\currentversion* and winlog.event_data.targetobject:(*\\\\shellserviceobjectdelayload* or *\\\\run\\\\* or *\\\\runonce\\\\* or *\\\\explorer\\\\shellserviceobjects* or *\\\\explorer\\\\shelliconoverlayidentifiers* or *\\\\explorer\\\\shellexecutehooks* or *\\\\explorer\\\\sharedtaskscheduler* or *\\\\explorer\\\\browser\\ helper\\ objects*)) and (not ((winlog.event_data.details:\"\\(empty\\)\") or (process.executable:*c\\:\\\\program\\ files\\ \\(x86\\)\\\\microsoft\\\\edgeupdate\\\\install\\\\\\{* and process.executable:*\\\\setup.exe*) or (process.executable:\"c\\:\\\\program\\ files\\\\common\\ files\\\\microsoft\\ shared\\\\clicktorun\\\\officeclicktorun.exe\" and winlog.event_data.targetobject:*\\\\office\\\\clicktorun\\\\registry\\\\machine\\\\software\\\\wow6432node\\\\*) or (process.executable:(\"c\\:\\\\program\\ files\\\\microsoft\\ office\\\\root\\\\integration\\\\integrator.exe\" or \"c\\:\\\\program\\ files\\ \\(x86\\)\\\\microsoft\\ office\\\\root\\\\integration\\\\integrator.exe\") and winlog.event_data.targetobject:*\\\\explorer\\\\browser\\ helper\\ objects\\\\\\{31d09ba0\\-12f5\\-4cce\\-be8a\\-2923e76605da\\}\\\\*) or (winlog.event_data.details:*\\-a251\\-47b7\\-93e1\\-cdd82e34af8b\\} or winlog.event_data.details:\"grpconv\\ \\-o\" or winlog.event_data.details:*c\\:\\\\program\\ files* and winlog.event_data.details:*\\\\dropbox\\\\client\\\\dropbox.exe* and winlog.event_data.details:*\\ \\/systemstartup*) or (winlog.event_data.targetobject:*\\\\explorer\\\\browser\\ helper\\ objects\\\\\\{92ef2ead\\-a7ce\\-4424\\-b0db\\-499cf856608e\\}\\\\noexplorer) or (process.executable:*\\\\windowsdesktop\\-runtime\\-* and winlog.event_data.targetobject:(*\\\\wow6432node\\\\microsoft\\\\windows\\\\currentversion\\\\runonce\\\\\\{e2d1ae32\\-dd1d\\-4ad7\\-a298\\-10e42e7840fc\\} or *\\\\wow6432node\\\\microsoft\\\\windows\\\\currentversion\\\\runonce\\\\\\{7037b699\\-7382\\-448c\\-89a7\\-4765961d2537\\}) and winlog.event_data.details:(\\\"c\\:\\\\programdata\\\\package\\ cache\\\\\\{7037b699\\-7382\\-448c\\-89a7\\-4765961d2537\\}\\\\windowsdesktop\\-runtime\\-* or \\\"c\\:\\\\programdata\\\\package\\ cache\\\\\\{e2d1ae32\\-dd1d\\-4ad7\\-a298\\-10e42e7840fc\\}\\\\windowsdesktop\\-runtime\\-*) and winlog.event_data.details:*.exe\\\"\\ \\/burn.runonce))))
<li><a href="#">query: ((winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:*\\\\software\\\\wow6432node\\\\microsoft\\\\windows\\\\currentversion* and winlog.event_data.targetobject:(*\\\\shellserviceobjectdelayload* or *\\\\run\\\\* or *\\\\runonce\\\\* or *\\\\runonceex\\\\* or *\\\\runservices\\\\* or *\\\\runservicesonce\\\\* or *\\\\explorer\\\\shellserviceobjects* or *\\\\explorer\\\\shelliconoverlayidentifiers* or *\\\\explorer\\\\shellexecutehooks* or *\\\\explorer\\\\sharedtaskscheduler* or *\\\\explorer\\\\browser\\ helper\\ objects*)) and (not ((winlog.event_data.details:\"\\(empty\\)\") or (process.executable.text:*c\\:\\\\program\\ files\\ \\(x86\\)\\\\microsoft\\\\edgeupdate\\\\install\\\\\\{* and process.executable.text:*\\\\setup.exe*) or (process.executable.text:\"c\\:\\\\program\\ files\\\\common\\ files\\\\microsoft\\ shared\\\\clicktorun\\\\officeclicktorun.exe\" and winlog.event_data.targetobject:*\\\\office\\\\clicktorun\\\\registry\\\\machine\\\\software\\\\wow6432node\\\\*) or (process.executable.text:(\"c\\:\\\\program\\ files\\\\microsoft\\ office\\\\root\\\\integration\\\\integrator.exe\" or \"c\\:\\\\program\\ files\\ \\(x86\\)\\\\microsoft\\ office\\\\root\\\\integration\\\\integrator.exe\") and winlog.event_data.targetobject:*\\\\explorer\\\\browser\\ helper\\ objects\\\\\\{31d09ba0\\-12f5\\-4cce\\-be8a\\-2923e76605da\\}\\\\*) or (winlog.event_data.details:*\\-a251\\-47b7\\-93e1\\-cdd82e34af8b\\} or winlog.event_data.details:\"grpconv\\ \\-o\" or winlog.event_data.details:*c\\:\\\\program\\ files* and winlog.event_data.details:*\\\\dropbox\\\\client\\\\dropbox.exe* and winlog.event_data.details:*\\ \\/systemstartup*) or (winlog.event_data.targetobject:*\\\\explorer\\\\browser\\ helper\\ objects\\\\\\{92ef2ead\\-a7ce\\-4424\\-b0db\\-499cf856608e\\}\\\\noexplorer) or (process.executable.text:*\\\\windowsdesktop\\-runtime\\-* and winlog.event_data.targetobject:(*\\\\wow6432node\\\\microsoft\\\\windows\\\\currentversion\\\\runonce\\\\\\{e2d1ae32\\-dd1d\\-4ad7\\-a298\\-10e42e7840fc\\} or *\\\\wow6432node\\\\microsoft\\\\windows\\\\currentversion\\\\runonce\\\\\\{7037b699\\-7382\\-448c\\-89a7\\-4765961d2537\\}) and winlog.event_data.details:(\\\"c\\:\\\\programdata\\\\package\\ cache\\\\\\{7037b699\\-7382\\-448c\\-89a7\\-4765961d2537\\}\\\\windowsdesktop\\-runtime\\-* or \\\"c\\:\\\\programdata\\\\package\\ cache\\\\\\{e2d1ae32\\-dd1d\\-4ad7\\-a298\\-10e42e7840fc\\}\\\\windowsdesktop\\-runtime\\-*) and winlog.event_data.details:*.exe\\\"\\ \\/burn.runonce) or (process.executable.text:(c\\:\\\\program\\ files\\\\common\\ files\\\\microsoft\\ shared\\\\clicktorun\\\\* or c\\:\\\\program\\ files\\\\common\\ files\\\\microsoft\\ shared\\\\clicktorun\\\\updates\\\\*) and process.executable.text:*\\\\officeclicktorun.exe) or (winlog.event_data.details:\\\"c\\:\\\\programdata\\\\package\\ cache\\\\\\{d21a4f20\\-968a\\-4b0c\\-bf04\\-a38da5f06e41\\}\\\\windowsdesktop\\-runtime\\-*) or (process.executable.text:*\\\\vc_redist.x64.exe and winlog.event_data.details:*\\}\\\\vc_redist.x64.exe\\\"\\ \\/burn.runonce) or (process.executable.text:(c\\:\\\\programdata\\\\package\\ cache* or c\\:\\\\windows\\\\temp\\\\*) and process.executable.text:*\\\\winsdksetup.exe and winlog.event_data.details:*\\\\winsdksetup.exe\\\"\\ \\/burn.runonce))))
<li><a href="#">query: ((winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:*\\\\system\\\\currentcontrolset\\\\control* and winlog.event_data.targetobject:(*\\\\terminal\\ server\\\\winstations\\\\rdp\\-tcp\\\\initialprogram* or *\\\\terminal\\ server\\\\wds\\\\rdpwd\\\\startupprograms* or *\\\\securityproviders\\\\securityproviders* or *\\\\safeboot\\\\alternateshell* or *\\\\print\\\\providers* or *\\\\print\\\\monitors* or *\\\\networkprovider\\\\order* or *\\\\lsa\\\\notification\\ packages* or *\\\\lsa\\\\authentication\\ packages* or *\\\\bootverificationprogram\\\\imagepath*)) and (not ((winlog.event_data.details:\"\\(empty\\)\") or (process.executable.text:\"c\\:\\\\windows\\\\system32\\\\spoolsv.exe\" and winlog.event_data.targetobject:*\\\\print\\\\monitors\\\\cutepdf\\ writer\\ monitor* and winlog.event_data.details:(\"cpwmon64_v40.dll\" or \"cutepdf\\ writer\")) or (process.executable.text:\"c\\:\\\\windows\\\\system32\\\\spoolsv.exe\" and winlog.event_data.targetobject:*print\\\\monitors\\\\appmon\\\\ports\\\\microsoft.office.onenote_* and user.name:(*authori* or *autori*)) or (process.executable.text:\"c\\:\\\\windows\\\\system32\\\\poqexec.exe\" and winlog.event_data.targetobject:*\\\\networkprovider\\\\order\\\\providerorder) or (process.executable.text:\"c\\:\\\\windows\\\\system32\\\\spoolsv.exe\" and winlog.event_data.targetobject:*\\\\print\\\\monitors\\\\monvnc\\\\driver and winlog.event_data.details:\"vncpm.dll\"))))
<li><a href="#">query: ((winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:*\\\\system\\\\currentcontrolset\\\\control* and winlog.event_data.targetobject:(*\\\\terminal\\ server\\\\winstations\\\\rdp\\-tcp\\\\initialprogram* or *\\\\terminal\\ server\\\\wds\\\\rdpwd\\\\startupprograms* or *\\\\securityproviders\\\\securityproviders* or *\\\\safeboot\\\\alternateshell* or *\\\\print\\\\providers* or *\\\\print\\\\monitors* or *\\\\networkprovider\\\\order* or *\\\\lsa\\\\notification\\ packages* or *\\\\lsa\\\\authentication\\ packages* or *\\\\bootverificationprogram\\\\imagepath*)) and (not ((winlog.event_data.details:\"\\(empty\\)\") or (process.executable:\"c\\:\\\\windows\\\\system32\\\\spoolsv.exe\" and winlog.event_data.targetobject:*\\\\print\\\\monitors\\\\cutepdf\\ writer\\ monitor* and winlog.event_data.details:(\"cpwmon64_v40.dll\" or \"cutepdf\\ writer\")))))
<li><a href="#">query: ((winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:*\\\\system\\\\currentcontrolset\\\\control\\\\session\\ manager* and winlog.event_data.targetobject:(*\\\\setupexecute* or *\\\\s0initialcommand* or *\\\\knowndlls* or *\\\\execute* or *\\\\bootexecute* or *\\\\appcertdlls*)) and (not (winlog.event_data.details:\"\\(empty\\)\")))
<li><a href="#">query: ((winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:*\\\\system\\\\currentcontrolset\\\\services\\\\* and winlog.event_data.targetobject:*\\\\networkprovider*) and (not ((winlog.event_data.targetobject:(*\\\\system\\\\currentcontrolset\\\\services\\\\webclient\\\\networkprovider* or *\\\\system\\\\currentcontrolset\\\\services\\\\lanmanworkstation\\\\networkprovider* or *\\\\system\\\\currentcontrolset\\\\services\\\\rdpnp\\\\networkprovider*)) or (process.executable.text:\"c\\:\\\\windows\\\\system32\\\\poqexec.exe\"))))
<li><a href="#">query: ((winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:*\\\\system\\\\currentcontrolset\\\\services\\\\eventlog\\\\* and winlog.event_data.targetobject:*\\\\file) and (not (winlog.event_data.details:*\\\\system32\\\\winevt\\\\logs\\\\*)))
<li><a href="#">query: ((winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:*\\\\system\\\\currentcontrolset\\\\services\\\\winsock2\\\\parameters* and winlog.event_data.targetobject:(*\\\\protocol_catalog9\\\\catalog_entries* or *\\\\namespace_catalog5\\\\catalog_entries*)) and (not (winlog.event_data.details:\"\\(empty\\)\" or process.executable:\"c\\:\\\\windows\\\\system32\\\\msiexec.exe\" or process.executable:\"c\\:\\\\windows\\\\syswow64\\\\msiexec.exe\")))
<li><a href="#">query: ((winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:*_classes\\\\mscfile\\\\shell\\\\open\\\\command\\\\\\(default\\)) and (not (winlog.event_data.details:%systemroot%\\\\system32\\\\mmc.exe\\ \\\"%1\\\"\\ %*)))
<li><a href="#">query: ((winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:*hklm\\\\system\\\\currentcontrolset\\\\services*) and ((winlog.event_data.details:*admin$* and winlog.event_data.details:*.exe*) or (winlog.event_data.details:*%comspec%* and winlog.event_data.details:*start* and winlog.event_data.details:*powershell*)))
<li><a href="#">query: ((winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:*software\\\\microsoft\\\\windows\\ nt\\\\currentversion\\\\schedule\\\\taskcache\\\\*) and (not ((winlog.event_data.targetobject:(*microsoft\\\\windows\\\\updateorchestrator* or *microsoft\\\\windows\\\\softwareprotectionplatform\\\\svcrestarttask\\\\index* or *microsoft\\\\windows\\\\flighting\\\\onesettings\\\\refreshcache\\\\index*)) or (process.executable.text:c\\:\\\\windows\\\\* and process.executable.text:*\\\\tiworker.exe) or (process.executable.text:\"c\\:\\\\windows\\\\system32\\\\svchost.exe\") or (process.executable.text:c\\:\\\\windows\\\\microsoft.net\\\\framework* and process.executable.text:*\\\\ngen.exe and winlog.event_data.targetobject:(*\\\\microsoft\\\\windows\\ nt\\\\currentversion\\\\schedule\\\\taskcache\\\\tasks\\\\\\{b66b135d\\-da06\\-4fc4\\-95f8\\-7458e1d10129\\}* or *\\\\microsoft\\\\windows\\ nt\\\\currentversion\\\\schedule\\\\taskcache\\\\tree\\\\microsoft\\\\windows\\\\.net\\ framework\\\\.net\\ framework\\ ngen*)) or (process.executable.text:(\"c\\:\\\\program\\ files\\\\microsoft\\ office\\\\root\\\\integration\\\\integrator.exe\" or \"c\\:\\\\program\\ files\\ \\(x86\\)\\\\microsoft\\ office\\\\root\\\\integration\\\\integrator.exe\")) or (process.executable.text:\"c\\:\\\\windows\\\\system32\\\\msiexec.exe\") or (process.executable.text:(\"c\\:\\\\program\\ files\\ \\(x86\\)\\\\dropbox\\\\update\\\\dropboxupdate.exe\" or \"c\\:\\\\program\\ files\\\\dropbox\\\\update\\\\dropboxupdate.exe\")) or (process.executable.text:\"c\\:\\\\windows\\\\explorer.exe\" and winlog.event_data.targetobject:*\\\\microsoft\\\\windows\\ nt\\\\currentversion\\\\schedule\\\\taskcache\\\\tree\\\\microsoft\\\\windows\\\\pla\\\\server\\ manager\\ performance\\ monitor\\\\*) or (process.executable.text:\"system\"))))
<li><a href="#">query: ((winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:*software\\\\microsoft\\\\windows\\ nt\\\\currentversion\\\\schedule\\\\taskcache\\\\tree\\\\*) and (not ((winlog.event_data.targetobject:(*microsoft\\\\windows\\\\updateorchestrator* or *microsoft\\\\windows\\\\softwareprotectionplatform\\\\svcrestarttask\\\\index* or *microsoft\\\\windows\\\\flighting\\\\onesettings\\\\refreshcache\\\\index*)) or (process.executable:\"c\\:\\\\windows\\\\system32\\\\svchost.exe\" and winlog.event_data.targetobject:(*microsoft\\\\windows\\\\windowsupdate\\\\scheduled\\ start\\\\index* or *microsoft\\\\windows\\\\pushtoinstall\\\\registration\\\\index* or *microsoft\\\\windows\\\\grouppolicy\\\\\\{*\\}\\\\index* or *\\\\taskcache\\\\tree\\\\opera\\ scheduled\\ autoupdate* or *\\\\taskcache\\\\tree\\\\opera\\ scheduled\\ assistant\\ autoupdate* or *\\\\taskcache\\\\tree\\\\onedrive\\ reporting* or *\\\\taskcache\\\\tree\\\\onedrive\\ standalone\\ update\\ task* or *\\\\taskcache\\\\tree\\\\mozilla\\\\sd* or *\\\\taskcache\\\\tree\\\\microsoft\\\\windows\\\\.net\\ framework\\\\.net\\ framework\\ * or *\\\\taskcache\\\\tree\\\\microsoft\\\\office\\\\officeosfinstaller\\\\* or *\\\\taskcache\\\\tree\\\\microsoft\\\\office\\\\officebackgroundtaskhandler* or *\\\\taskcache\\\\tree\\\\googleupdatetaskmachine* or *\\\\taskcache\\\\tree\\\\dropboxupdatetaskmachine* or *\\\\taskcache\\\\tree\\\\mozilla\\\\firefox\\ default\\ browser\\ agent\\ * or *\\\\taskcache\\\\tree\\\\mozilla\\\\firefox\\ background\\ update\\ * or *\\\\taskcache\\\\tree\\\\microsoft\\\\windows\\\\wof\\\\wim\\-hash\\-validation\\\\index* or *\\\\taskcache\\\\tree\\\\microsoft\\\\office\\\\sd* or *\\\\taskcache\\\\tree\\\\microsoft\\\\office\\\\officetelemetry* or *\\\\taskcache\\\\tree\\\\microsoft\\\\office\\\\office\\ clicktorun\\ service\\ monitor\\\\* or *\\\\taskcache\\\\tree\\\\microsoft\\\\office\\\\office\\ automatic\\ updates\\ 2.0\\\\* or *\\\\taskcache\\\\tree\\\\klcp_update\\\\* or *\\\\taskcache\\\\tree\\\\apple\\\\sd* or *\\\\taskcache\\\\tree\\\\apple\\\\applesoftwareupdate\\\\* or *\\\\taskcache\\\\tree\\\\microsoft\\\\windows\\\\windows\\ defender\\\\windows\\ defender\\ verification\\\\* or *\\\\taskcache\\\\tree\\\\microsoft\\\\windows\\\\windows\\ defender\\\\windows\\ defender\\ cache\\ maintenance\\\\* or *\\\\taskcache\\\\tree\\\\microsoft\\\\windows\\\\windows\\ defender\\\\windows\\ defender\\ cleanup\\\\* or *\\\\taskcache\\\\tree\\\\microsoft\\\\windows\\\\windows\\ defender\\\\windows\\ defender\\ scheduled\\ scan\\\\*)))))
<li><a href="#">query: ((winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:*software\\\\microsoft\\\\windows\\ nt\\\\currentversion\\\\schedule\\\\taskcache\\\\tree\\\\*) and (not ((winlog.event_data.targetobject:(*microsoft\\\\windows\\\\updateorchestrator* or *microsoft\\\\windows\\\\softwareprotectionplatform\\\\svcrestarttask\\\\index* or *microsoft\\\\windows\\\\flighting\\\\onesettings\\\\refreshcache\\\\index*)) or (process.executable:\"c\\:\\\\windows\\\\system32\\\\svchost.exe\" and winlog.event_data.targetobject:(*microsoft\\\\windows\\\\windowsupdate\\\\scheduled\\ start\\\\index* or *microsoft\\\\windows\\\\pushtoinstall\\\\registration\\\\index* or *microsoft\\\\windows\\\\grouppolicy\\\\\\{*\\}\\\\index* or *\\\\taskcache\\\\tree\\\\opera\\ scheduled\\ autoupdate* or *\\\\taskcache\\\\tree\\\\opera\\ scheduled\\ assistant\\ autoupdate* or *\\\\taskcache\\\\tree\\\\onedrive\\ reporting* or *\\\\taskcache\\\\tree\\\\onedrive\\ standalone\\ update\\ task* or *\\\\taskcache\\\\tree\\\\mozilla\\\\sd* or *\\\\taskcache\\\\tree\\\\microsoft\\\\windows\\\\.net\\ framework\\\\.net\\ framework\\ * or *\\\\taskcache\\\\tree\\\\microsoft\\\\office\\\\officeosfinstaller\\\\* or *\\\\taskcache\\\\tree\\\\microsoft\\\\office\\\\officebackgroundtaskhandler* or *\\\\taskcache\\\\tree\\\\googleupdatetaskmachine* or *\\\\taskcache\\\\tree\\\\dropboxupdatetaskmachine* or *\\\\taskcache\\\\tree\\\\mozilla\\\\firefox\\ default\\ browser\\ agent\\ * or *\\\\taskcache\\\\tree\\\\mozilla\\\\firefox\\ background\\ update\\ * or *\\\\taskcache\\\\tree\\\\microsoft\\\\windows\\\\wof\\\\wim\\-hash\\-validation\\\\index* or *\\\\taskcache\\\\tree\\\\microsoft\\\\office\\\\sd* or *\\\\taskcache\\\\tree\\\\microsoft\\\\office\\\\officetelemetry* or *\\\\taskcache\\\\tree\\\\microsoft\\\\office\\\\office\\ clicktorun\\ service\\ monitor\\\\* or *\\\\taskcache\\\\tree\\\\microsoft\\\\office\\\\office\\ automatic\\ updates\\ 2.0\\\\* or *\\\\taskcache\\\\tree\\\\klcp_update\\\\* or *\\\\taskcache\\\\tree\\\\apple\\\\sd* or *\\\\taskcache\\\\tree\\\\apple\\\\applesoftwareupdate\\\\*)))))
<li><a href="#">query: ((winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:*software\\\\microsoft\\\\windows\\\\currentversion* and winlog.event_data.details:(*vbscript* or *jscript* or *mshtml* or *runhtmlapplication* or *execute\\(* or *createobject* or *regread* or *window.close*)) and (not ((winlog.event_data.targetobject:*software\\\\microsoft\\\\windows\\\\currentversion\\\\run*) or (process.executable:*\\\\msiexec.exe and winlog.event_data.targetobject:*\\\\software\\\\microsoft\\\\windows\\\\currentversion\\\\installer\\\\userdata\\\\* and winlog.event_data.details:(*\\\\microsoft.net\\\\primary\\ interop\\ assemblies\\\\microsoft.mshtml.dll* or *<\\\\microsoft.mshtml,fileversion\\=* or *fl_microsoft_mshtml_dll_____x86.* or *microsoft_mshtml_dll_1_____x86.* or *<\\\\microsoft.mshtml,culture\\=*)))))
<li><a href="#">query: ((winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:*software\\\\microsoft\\\\windows\\\\currentversion* and winlog.event_data.details:(*vbscript* or *jscript* or *mshtml* or *runhtmlapplication* or *execute\\(* or *createobject* or *regread* or *window.close*)) and (not ((winlog.event_data.targetobject:*software\\\\microsoft\\\\windows\\\\currentversion\\\\run*) or (process.executable:*\\\\msiexec.exe and winlog.event_data.targetobject:*\\\\software\\\\microsoft\\\\windows\\\\currentversion\\\\installer\\\\userdata\\\\* and winlog.event_data.details:(*\\\\microsoft.net\\\\primary\\ interop\\ assemblies\\\\microsoft.mshtml.dll* or *<\\\\microsoft.mshtml,fileversion\\=*)))))
<li><a href="#">query: ((winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:*software\\\\microsoft\\\\windows\\\\currentversion* and winlog.event_data.details:(*vbscript\\:* or *jscript\\:* or *mshtml,* or *runhtmlapplication* or *execute\\(* or *createobject* or *window.close*)) and (not ((winlog.event_data.targetobject:*software\\\\microsoft\\\\windows\\\\currentversion\\\\run*) or (process.executable.text:*\\\\msiexec.exe and winlog.event_data.targetobject:*\\\\software\\\\microsoft\\\\windows\\\\currentversion\\\\installer\\\\userdata\\\\* and winlog.event_data.details:(*\\\\microsoft.net\\\\primary\\ interop\\ assemblies\\\\microsoft.mshtml.dll* or *<\\\\microsoft.mshtml,fileversion\\=* or *_mshtml_dll_* or *<\\\\microsoft.mshtml,culture\\=*)))))
<li><a href="#">query: ((winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:*treatas\\\\\\(default\\)) and (not (((process.executable.text:c\\:\\\\program\\ files\\\\common\\ files\\\\microsoft\\ shared\\\\clicktorun\\\\* and process.executable.text:*\\\\officeclicktorun.exe)) or ((process.executable.text:\"c:\\program files (x86)\\microsoft office\\root\\integration\\integrator.exe\")) or ((process.executable.text:\"c:\\windows\\system32\\svchost.exe\")) or ((process.executable.text:(\"c:\\windows\\system32\\msiexec.exe\" or \"c:\\windows\\syswow64\\msiexec.exe\"))))))
<li><a href="#">query: ((winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:\"hklm\\\\system\\\\currentcontrolset\\\\control\\\\terminal\\ server\\\\winstations\\\\rdp\\-tcp\\\\portnumber\") and (not (winlog.event_data.details:\"dword\\ \\(0x00000d3d\\)\")))
<li><a href="#">query: ((winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:hklm\\\\software\\\\microsoft\\\\windows\\\\currentversion\\\\winevt\\\\channels\\\\* and winlog.event_data.targetobject:*\\\\channelaccess and winlog.event_data.details:(*\\(a;;0x1;;;sy\\)* or *\\(a;;0x5;;;ba\\)* or *\\(a;;0x1;;;la\\)*)) and (not ((process.executable.text:\"c\\:\\\\windows\\\\servicing\\\\trustedinstaller.exe\") or (process.executable.text:*\\\\tiworker.exe))))
<li><a href="#">query: ((winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:hklm\\\\software\\\\microsoft\\\\windows\\\\currentversion\\\\winevt\\\\channels\\\\* and winlog.event_data.targetobject:*\\\\enabled and winlog.event_data.details:\"dword\\ \\(0x00000000\\)\") and (not ((process.executable.text:*\\\\windows\\\\system32\\\\wevtutil.exe) or (process.executable.text:c\\:\\\\windows\\\\winsxs\\\\* and process.executable.text:*\\\\tiworker.exe) or (process.executable.text:\"c\\:\\\\windows\\\\system32\\\\svchost.exe\" and winlog.event_data.targetobject:(*\\\\microsoft\\\\windows\\\\currentversion\\\\winevt\\\\channels\\\\microsoft\\-windows\\-fileinfominifilter* or *\\\\microsoft\\\\windows\\\\currentversion\\\\winevt\\\\channels\\\\microsoft\\-windows\\-asn1\\\\*)))))
<li><a href="#">query: ((winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:hklm\\\\system\\\\currentcontrolset\\\\services\\\\* and ((winlog.event_data.targetobject:*\\\\start and process.executable:(*\\\\appdata\\\\local\\\\* or *\\\\appdata\\\\roaming\\\\*) and winlog.event_data.details:(\"dword\\ \\(0x00000000\\)\" or \"dword\\ \\(0x00000001\\)\" or \"dword\\ \\(0x00000002\\)\")) or (winlog.event_data.targetobject:*\\\\imagepath and winlog.event_data.details:(*\\\\appdata\\\\local\\\\* or *\\\\appdata\\\\roaming\\\\*)))) and (not (process.executable:(*\\\\appdata\\\\roaming\\\\zoom* or *\\\\appdata\\\\local\\\\zoom*) or winlog.event_data.details:(*\\\\appdata\\\\roaming\\\\zoom* or *\\\\appdata\\\\local\\\\zoom*))))
<li><a href="#">query: ((winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:hklm\\\\system\\\\currentcontrolset\\\\services\\\\* and winlog.event_data.targetobject:*\\\\parameters\\\\servicedll) and (not ((winlog.event_data.details:\"c\\:\\\\windows\\\\system32\\\\spool\\\\drivers\\\\x64\\\\3\\\\printconfig.dll\") or (process.executable.text:\"c\\:\\\\windows\\\\system32\\\\lsass.exe\" and winlog.event_data.targetobject:*\\\\currentcontrolset\\\\services\\\\ntds\\\\parameters\\\\servicedll and winlog.event_data.details:\"%%systemroot%%\\\\system32\\\\ntdsa.dll\") or (process.executable.text:\"c\\:\\\\windows\\\\system32\\\\poqexec.exe\"))))
<li><a href="#">query: ((winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:hklm\\\\system\\\\currentcontrolset\\\\services\\\\* and winlog.event_data.targetobject:*\\\\parameters\\\\servicedll) and (not ((winlog.event_data.details:\"c\\:\\\\windows\\\\system32\\\\spool\\\\drivers\\\\x64\\\\3\\\\printconfig.dll\") or (process.executable:\"c\\:\\\\windows\\\\system32\\\\lsass.exe\" and winlog.event_data.targetobject:*\\\\currentcontrolset\\\\services\\\\ntds\\\\parameters\\\\servicedll and winlog.event_data.details:\"%%systemroot%%\\\\system32\\\\ntdsa.dll\"))))
<li><a href="#">query: ((winlog.event_data.grantedaccess:(\"0x147a\" or \"0x1f3fff\") and winlog.event_data.calltrace:*unknown*) and (not (((process.executable.text:(c\\:\\\\program\\ files\\\\dell\\\\* or c\\:\\\\program\\ files\\ \\(x86\\)\\\\dell\\\\*) and winlog.event_data.targetimage:(c\\:\\\\program\\ files\\\\dell\\\\* or c\\:\\\\program\\ files\\ \\(x86\\)\\\\dell\\\\*) and winlog.event_data.grantedaccess:\"0x1f3fff\" and winlog.event_data.calltrace:c\\:\\\\windows\\\\system32\\\\ntdll.dll*)) or ((process.executable.text:\"c:\\program files (x86)\\dell\\updateservice\\serviceshell.exe\" and winlog.event_data.targetimage:\"c:\\windows\\explorer.exe\" and winlog.event_data.grantedaccess:\"0x1f3fff\" and winlog.event_data.calltrace:c\\:\\\\windows\\\\system32\\\\ntdll.dll*)) or ((process.executable.text:(\"c:\\program files\\microsoft visual studio\\2022\\community\\common7\\ide\\perfwatson2.exe\" or \"c:\\program files (x86)\\microsoft visual studio\\2019\\community\\common7\\ide\\perfwatson2.exe\") and winlog.event_data.targetimage:(\"c:\\program files\\microsoft visual studio\\2022\\community\\common7\\ide\\devenv.exe\" or \"c:\\program files (x86)\\microsoft visual studio\\2019\\community\\common7\\ide\\devenv.exe\") and winlog.event_data.calltrace:c\\:\\\\windows\\\\system32\\\\ntdll.dll*)) or ((process.executable.text:c\\:\\\\program\\ files\\\\microsoft\\ visual\\ studio\\\\* and process.executable.text:*\\\\msbuild\\\\current\\\\bin\\\\msbuild.exe and winlog.event_data.targetimage:\"c:\\program files\\dell\\delldatavault\\ddvdatacollector.exe\")) or ((process.executable.text:\"c:\\windows\\system32\\wbem\\wmiprvse.exe\" and winlog.event_data.targetimage:\"c:\\windows\\system32\\lsass.exe\" and winlog.event_data.calltrace:c\\:\\\\windows\\\\system32\\\\ntdll.dll* and winlog.event_data.calltrace:*\\\\system.ni.dll\\+*)))))
<li><a href="#">query: ((winlog.event_data.grantedaccess:\"0x1fffff\" and winlog.event_data.calltrace:c\\:\\\\windows\\\\system32\\\\ntdll.dll\\+* and winlog.event_data.calltrace:*|unknown\\(* and winlog.event_data.calltrace:*\\)) and (not (((process.executable.text:(c\\:\\\\program\\ files\\\\* or c\\:\\\\program\\ files\\ \\(x86\\)\\\\* or c\\:\\\\windows\\\\system32\\\\* or c\\:\\\\windows\\\\syswow64\\\\*) and winlog.event_data.targetimage:(c\\:\\\\program\\ files\\\\* or c\\:\\\\program\\ files\\ \\(x86\\)\\\\* or c\\:\\\\windows\\\\system32\\\\* or c\\:\\\\windows\\\\syswow64\\\\*))) or ((process.executable.text:c\\:\\\\windows\\\\temp\\\\asgard2\\-agent\\\\* and process.executable.text:*\\\\thor\\\\thor64.exe)))))
<li><a href="#">query: ((winlog.event_data.hashes:(*md5\\=9ab9f3b75a2eb87fafb1b7361be9dfb3* or *md5\\=c832a4313ff082258240b61b88efa025* or *sha1\\=fe10018af723986db50701c8532df5ed98b17c39* or *sha1\\=1f1ce28c10453acbc9d3844b4604c59c0ab0ad46* or *sha256\\=31f4cfb4c71da44120752721103a16512444c13c2ac2d857a7e6f13cb679b427* or *sha256\\=cfc5c585dd4e592dd1a08887ded28b92d9a5820587b6f4f8fa4f56d60289259b*)) or (md5:(\"9ab9f3b75a2eb87fafb1b7361be9dfb3\" or \"c832a4313ff082258240b61b88efa025\")) or (sha1:(\"fe10018af723986db50701c8532df5ed98b17c39\" or \"1f1ce28c10453acbc9d3844b4604c59c0ab0ad46\")) or (sha256:(\"31f4cfb4c71da44120752721103a16512444c13c2ac2d857a7e6f13cb679b427\" or \"cfc5c585dd4e592dd1a08887ded28b92d9a5820587b6f4f8fa4f56d60289259b\")))
<li><a href="#">query: ((winlog.event_data.hashes:(*md5\\=a179c4093d05a3e1ee73f6ff07f994aa* or *sha1\\=5d6b9e80e12bfc595d4d26f6afb099b3cb471dd4* or *sha256\\=4b5229b3250c8c08b98cb710d6c056144271de099a57ae09f5d2097fc41bd4f1*) or md5:\"a179c4093d05a3e1ee73f6ff07f994aa\" or sha1:\"5d6b9e80e12bfc595d4d26f6afb099b3cb471dd4\" or sha256:\"4b5229b3250c8c08b98cb710d6c056144271de099a57ae09f5d2097fc41bd4f1\") or (dll.path:*\\\\aswarpot.sys and (signed:\"false\" or signaturestatus:\"expired\")))
<li><a href="#">query: ((winlog.event_data.hashes:(*sha256\\=f05b1ee9e2f6ab704b8919d5071becbce6f9d0f9d0ba32a460c41d5272134abe* or *sha1\\=b89a8eef5aeae806af5ba212a8068845cafdab6f* or *md5\\=b941c8364308990ee4cc6eadf7214e0f*)) or (sha256:\"f05b1ee9e2f6ab704b8919d5071becbce6f9d0f9d0ba32a460c41d5272134abe\") or (sha1:\"b89a8eef5aeae806af5ba212a8068845cafdab6f\") or (md5:\"b941c8364308990ee4cc6eadf7214e0f\"))
<li><a href="#">query: ((winlog.event_data.imagepath:*cmd* and winlog.event_data.imagepath:*\\/c* and winlog.event_data.imagepath:*echo* and winlog.event_data.imagepath:*\\\\pipe\\\\*) or (winlog.event_data.imagepath:*%comspec%* and winlog.event_data.imagepath:*\\/c* and winlog.event_data.imagepath:*echo* and winlog.event_data.imagepath:*\\\\pipe\\\\*) or (winlog.event_data.imagepath:*cmd.exe* and winlog.event_data.imagepath:*\\/c* and winlog.event_data.imagepath:*echo* and winlog.event_data.imagepath:*\\\\pipe\\\\*) or (winlog.event_data.imagepath:*rundll32* and winlog.event_data.imagepath:*.dll,a* and winlog.event_data.imagepath:*\\/p\\:*))
<li><a href="#">query: ((winlog.event_data.imphash:(\"a53a02b997935fd8eedcb5f7abab9b9f\" or \"e96a73c7bf33a464c510ede582318bf2\") or (process.command_line:*.exe\\ \\-s and process.parent.executable:*\\\\services.exe)) and (not (process.executable:*\\\\clussvc.exe)))
<li><a href="#">query: ((winlog.event_data.initiated:\"true\" and destination.domain:(*api.dropboxapi.com or *content.dropboxapi.com)) and (not (process.executable:*\\\\dropbox*)))
<li><a href="#">query: ((winlog.event_data.initiated:\"true\" and destination.domain:(*cdn.discordapp.com or *pastebin.com or *youtube.com or *technet.microsoft.com or *facebook.com or *.cloudflare.com or *docs.google.com or *steamcommunity.com or *reddit.com or *fotolog.com or *twitter.com or *imgur.com or *feeds.rapidfeeds.com or *livejournal.com or *.githubusercontent.com)) and (not ((process.executable.text:(*\\\\iexplore.exe or *\\\\msedge.exe or *\\\\edge.exe or *\\\\opera.exe or *\\\\brave.exe or *\\\\vivaldi.exe or *\\\\whale.exe or *\\\\chrome.exe or *\\\\firefox.exe)) or (process.executable.text:(*\\\\msmpeng.exe or *\\\\mssense.exe or *\\\\prtg\\ probe.exe or *\\\\engine.exe or *\\\\msedgewebview2.exe)))))
<li><a href="#">query: ((winlog.event_data.initiated:\"true\" and destination.port:(\"4443\" or \"2448\" or \"8143\" or \"1777\" or \"1443\" or \"243\" or \"65535\" or \"13506\" or \"3360\" or \"200\" or \"198\" or \"49180\" or \"13507\" or \"6625\" or \"4444\" or \"4438\" or \"1904\" or \"13505\" or \"13504\" or \"12102\" or \"9631\" or \"5445\" or \"2443\" or \"777\" or \"13394\" or \"13145\" or \"12103\" or \"5552\" or \"3939\" or \"3675\" or \"666\" or \"473\" or \"5649\" or \"4455\" or \"4433\" or \"1817\" or \"100\" or \"65520\" or \"1960\" or \"1515\" or \"743\" or \"700\" or \"14154\" or \"14103\" or \"14102\" or \"12322\" or \"10101\" or \"7210\" or \"4040\" or \"9943\")) and (not ((process.executable:*\\\\program\\ files*) or (destination.ip:(10.* or 192.168.* or 172.16.* or 172.17.* or 172.18.* or 172.19.* or 172.20.* or 172.21.* or 172.22.* or 172.23.* or 172.24.* or 172.25.* or 172.26.* or 172.27.* or 172.28.* or 172.29.* or 172.30.* or 172.31.* or 127.*)))))
<li><a href="#">query: ((winlog.event_data.initiated:\"true\" and process.executable.text:(*\\\\wscript.exe or *\\\\cscript.exe)) and (not ((destination.ip:(127.* or 10.* or 172.* or 192.* or 169.254.* or 20.*)) or (destination.ip:(\\:\\:1* or 0\\:0\\:0\\:0\\:0\\:0\\:0\\:1* or fe80\\:* or fc* or fd*)))))
<li><a href="#">query: ((winlog.event_data.initiated:\"true\" and process.executable.text:*python*) and (not ((process.parent.executable.text:\"c\\:\\\\programdata\\\\anaconda3\\\\scripts\\\\conda.exe\" and process.command_line.text:*c\\:\\\\programdata\\\\anaconda3\\\\scripts\\\\conda\\-script.py* and process.command_line.text:*update*) or (process.parent.executable.text:\"c\\:\\\\programdata\\\\anaconda3\\\\python.exe\" and process.command_line.text:*c\\:\\\\programdata\\\\anaconda3\\\\scripts\\\\jupyter\\-notebook\\-script.py*) or (destination.ip:\"127.0.0.1\" and source.ip:\"127.0.0.1\"))))
<li><a href="#">query: ((winlog.event_data.initiated:\"true\" and process.executable:(*\\\\regsvr32.exe or *\\\\rundll32.exe or *\\\\dllhost.exe) and process.command_line:(*\\\\regsvr32.exe or *\\\\rundll32.exe or *\\\\dllhost.exe)) and (not ((process.command_line:\"\") or (not _exists_:process.command_line))))
<li><a href="#">query: ((winlog.event_data.originalfilename:(7z*.exe or *rar.exe or *command*line*rar*) and process.command_line:(*\\ \\-p* or *\\ \\-ta* or *\\ \\-tb* or *\\ \\-sdel* or *\\ \\-dw* or *\\ \\-hp*)) and (not (process.parent.executable:c\\:\\\\program*)))
<li><a href="#">query: ((winlog.event_data.originalfilename:*psloglist* or process.executable:(*\\\\psloglist.exe or *\\\\psloglist64.exe)) or (process.command_line:(*\\-d* or *\\/d* or *\\-x* or *\\/x* or *\\-s* or *\\/s*) and process.command_line:*security* and process.command_line:*accepteula*))
<li><a href="#">query: ((winlog.event_data.originalfilename:\"cmd.exe\" or process.executable.text:*\\\\cmd.exe) and ((process.parent.command_line.text:*cmd\\ * and process.parent.command_line.text:*\\/r\\ * and process.parent.command_line.text:*<*) or (process.command_line.text:*cmd\\ * and process.command_line.text:*\\/r\\ * and process.command_line.text:*<*)))
<li><a href="#">query: ((winlog.event_data.originalfilename:\"nircmd.exe\" or process.command_line:(*\\ execmd\\ * or *.exe\\ script\\ * or *.exe\\ shexec\\ * or *\\ runinteractive\\ *)) or (process.command_line:(*\\ exec\\ * or *\\ exec2\\ *) and process.command_line:(*\\ show\\ * or *\\ hide\\ *)))
<li><a href="#">query: ((winlog.event_data.originalfilename:\"openconsole.exe\" or process.executable:*\\\\openconsole.exe) and (not (process.executable:c\\:\\\\program\\ files\\\\windowsapps\\\\microsoft.windowsterminal*)))
<li><a href="#">query: ((winlog.event_data.originalfilename:\"plink\" or (process.command_line.text:*\\ \\-l\\ forward* and process.command_line.text:*\\ \\-p\\ * and process.command_line.text:*\\ \\-r\\ *)) and (not (process.executable.text:*\\\\plink.exe)))
<li><a href="#">query: ((winlog.event_data.originalfilename:\"procdump\" or (process.command_line.text:(*\\ \\-ma\\ * or *\\ \\/ma\\ *) and process.command_line.text:(*\\ \\-accepteula\\ * or *\\ \\/accepteula\\ *))) and (not (process.executable.text:(*\\\\procdump.exe or *\\\\procdump64.exe))))
<li><a href="#">query: ((winlog.event_data.originalfilename:\"psloglist.exe\" or process.executable:(*\\\\psloglist.exe or *\\\\psloglist64.exe)) or (process.command_line:*security* and process.command_line:*accepteula* and process.command_line:(*\\ \\-d* or *\\ \\/d* or *\\ \\-x* or *\\ \\/x* or *\\ \\-s* or *\\ \\/s*)))
<li><a href="#">query: ((winlog.event_data.samaccountname:samtheadmin\\-* and winlog.event_data.samaccountname:*$) or (winlog.event_data.targetusername:samtheadmin\\-* and winlog.event_data.targetusername:*$))
<li><a href="#">query: ((winlog.event_data.signature:(php.* or jsp.* or asp.* or perl.* or vbs\\/uxor* or iis\\/backdoor* or java\\/backdoor* or troj\\/asp* or troj\\/php* or troj\\/jsp*)) or (winlog.event_data.signature:(*webshell* or *chopper* or *sinochoper* or *aspxspy* or *aspdoor* or *filebrowser* or *php_* or *jsp_* or *asp_* or *php\\:* or *jsp\\:* or *asp\\:* or *perl\\:* or *php\\/* or *jsp\\/* or *asp\\/* or *perl\\/* or *phpshell* or *trojan.php* or *trojan.asp* or *trojan.jsp* or *trojan.vbs* or *php?agent* or *asp?agent* or *jsp?agent* or *vbs?agent* or *backdoor?php* or *backdoor?jsp* or *backdoor?asp* or *backdoor?vbs* or *backdoor?java* or *pshlspy* or *c99shell*)))
<li><a href="#">query: ((winlog.event_data.targetimage:*\\\\lsass.exe and process.executable:\"c\\:\\\\windows\\\\system32\\\\wsmprovhost.exe\") and (not (winlog.event_data.grantedaccess:\"0x80000000\")))
<li><a href="#">query: ((winlog.event_data.targetimage:*\\\\lsass.exe and winlog.event_data.grantedaccess:(*0x1038* or *0x1438* or *0x143a*) and winlog.event_data.calltrace:(*dbghelp.dll* or *dbgcore.dll* or *ntdll.dll*)) and (not ((winlog.event_data.calltrace:*|c\\:\\\\windows\\\\temp\\\\asgard2\\-agent\\\\* and winlog.event_data.calltrace:*\\\\thor\\\\thor64.exe\\+* and winlog.event_data.calltrace:*|unknown\\(* and winlog.event_data.grantedaccess:\"0x103800\") or (process.executable.text:\"c\\:\\\\windows\\\\sysmon64.exe\"))))
<li><a href="#">query: ((winlog.event_data.targetimage:*\\\\lsass.exe and winlog.event_data.grantedaccess:(*10 or *30 or *50 or *70 or *90 or *b0 or *d0 or *f0 or *18 or *38 or *58 or *78 or *98 or *b8 or *d8 or *f8 or *1a or *3a or *5a or *7a or *9a or *ba or *da or *fa or *0x14c2 or *ff) and process.executable.text:(*\\\\temp\\\\* or *\\\\users\\\\public\\\\* or *\\\\perflogs\\\\* or *\\\\appdata\\\\* or *\\\\temporary*)) and (not ((process.executable.text:c\\:\\\\users\\\\* and process.executable.text:*\\\\appdata\\\\local\\\\* and process.executable.text:(*\\\\microsoft\\ vs\\ code\\\\code.exe or *\\\\software_reporter_tool.exe or *\\\\dropboxupdate.exe or *\\\\mbaminstallerservice.exe or *\\\\webexmta.exe or *\\\\webex\\\\webexhost.exe or *\\\\jetbrains\\\\toolbox\\\\bin\\\\jetbrains\\-toolbox.exe) and winlog.event_data.grantedaccess:\"0x410\") or (process.executable.text:c\\:\\\\windows\\\\temp\\\\* and process.executable.text:*.tmp\\\\dropboxupdate.exe and winlog.event_data.grantedaccess:(\"0x410\" or \"0x1410\")) or (process.executable.text:c\\:\\\\users\\\\* and process.executable.text:*\\\\appdata\\\\local\\\\temp\\\\* and process.executable.text:*.tmp\\\\dropboxupdate.exe and winlog.event_data.grantedaccess:\"0x1410\") or (process.executable.text:(c\\:\\\\windows\\\\temp\\\\asgard2\\-agent\\\\* or c\\:\\\\windows\\\\temp\\\\asgard2\\-agent\\-sc\\\\*) and process.executable.text:(*\\\\thor64.exe or *\\\\thor.exe or *\\\\aurora\\-agent\\-64.exe or *\\\\aurora\\-agent.exe) and winlog.event_data.grantedaccess:(\"0x1fffff\" or \"0x1010\" or \"0x101010\")) or (process.executable.text:c\\:\\\\users\\\\* and process.executable.text:*\\\\appdata\\\\local\\\\temp\\\\* and process.executable.text:*\\\\vs_bootstrapper_* and winlog.event_data.grantedaccess:\"0x1410\") or (process.executable.text:c\\:\\\\program\\ files\\ \\(x86\\)\\\\google\\\\temp\\\\* and process.executable.text:*.tmp\\\\googleupdate.exe and winlog.event_data.grantedaccess:\"0x410\") or (process.executable.text:(c\\:\\\\program\\ files\\ \\(x86\\)\\\\* or c\\:\\\\program\\ files\\\\*)) or (process.executable.text:c\\:\\\\users\\\\* and process.executable.text:*\\\\appdata\\\\local\\\\keybase\\\\keybase.exe and winlog.event_data.grantedaccess:\"0x1fffff\"))))
<li><a href="#">query: ((winlog.event_data.targetimage:*\\\\lsass.exe and winlog.event_data.grantedaccess:(*10 or *30 or *50 or *70 or *90 or *b0 or *d0 or *f0 or *18 or *38 or *58 or *78 or *98 or *b8 or *d8 or *f8 or *1a or *3a or *5a or *7a or *9a or *ba or *da or *fa or *0x14c2 or *ff) and process.executable:(*\\\\temp\\\\* or *\\\\users\\\\public\\\\* or *\\\\perflogs\\\\* or *\\\\appdata\\\\* or *\\\\temporary*)) and (not ((process.executable:*c\\:\\\\users\\\\* and process.executable:*\\\\appdata\\\\local\\\\* and process.executable:(*\\\\microsoft\\ vs\\ code\\\\code.exe or *\\\\software_reporter_tool.exe or *\\\\dropboxupdate.exe) and winlog.event_data.grantedaccess:\"0x410\") or (process.executable:c\\:\\\\windows\\\\temp\\\\asgard2\\-agent\\\\* and process.executable:(*\\\\thor64.exe or *\\\\thor.exe) and winlog.event_data.grantedaccess:(\"0x1fffff\" or \"0x1010\")))))
<li><a href="#">query: ((winlog.event_data.targetimage:*\\\\lsass.exe and winlog.event_data.grantedaccess:(*10 or *30 or *50 or *70 or *90 or *b0 or *d0 or *f0 or *18 or *38 or *58 or *78 or *98 or *b8 or *d8 or *f8 or *1a or *3a or *5a or *7a or *9a or *ba or *da or *fa or *0x14c2)) and (not ((process.executable:(\"c\\:\\\\windows\\\\system32\\\\taskmgr.exe\" or \"c\\:\\\\program\\ files\\\\malwarebytes\\\\anti\\-malware\\\\mbamservice.exe\" or \"c\\:\\\\programdata\\\\malwarebytes\\\\mbamservice\\\\ctlrupdate\\\\mbupdatr.exe\" or \"c\\:\\\\windows\\\\system32\\\\taskhostw.exe\" or c\\:\\\\users\\\\*\\\\appdata\\\\local\\\\programs\\\\microsoft\\ vs\\ code\\\\code.exe or \"c\\:\\\\program\\ files\\\\windows\\ defender\\\\msmpeng.exe\" or \"c\\:\\\\windows\\\\syswow64\\\\msiexec.exe\" or \"c\\:\\\\windows\\\\system32\\\\msiexec.exe\" or \"c\\:\\\\windows\\\\system32\\\\lsass.exe\" or \"c\\:\\\\windows\\\\system32\\\\perfmon.exe\")) or (process.executable:c\\:\\\\programdata\\\\microsoft\\\\windows\\ defender\\\\* and process.executable:*\\\\msmpeng.exe) or (process.executable:c\\:\\\\program\\ files\\\\windowsapps\\\\* and process.executable:*\\\\gamingservices.exe and winlog.event_data.grantedaccess:(\"0x1410\" or \"0x410\" or \"0x1040\")) or (process.executable:(*\\\\procexp64.exe or *\\\\procexp.exe) and winlog.event_data.grantedaccess:(\"0x1410\" or \"0x410\")) or (process.executable:c\\:\\\\programdata\\\\vmware\\\\vmware\\ tools\\\\* and process.executable:*\\\\vmtoolsd.exe) or (process.executable:(c\\:\\\\progra\\ files\\\\* or c\\:\\\\progra\\ files\\ \\(x86\\)\\\\*) and process.executable:*antivirus*) or (process.executable:\"c\\:\\\\windows\\\\system32\\\\wbem\\\\wmiprvse.exe\" and winlog.event_data.grantedaccess:(\"0x1410\" or \"0x410\")) or (process.executable:\"c\\:\\\\windows\\\\syswow64\\\\wbem\\\\wmiprvse.exe\" and winlog.event_data.grantedaccess:\"0x1010\") or (process.executable:\"c\\:\\\\windows\\\\system32\\\\mrt.exe\" and winlog.event_data.grantedaccess:\"0x1418\") or (process.executable:\"c\\:\\\\program\\ files\\\\common\\ files\\\\mcafee\\\\mmsshost\\\\mmsshost.exe\") or (process.executable:c\\:\\\\windows\\\\temp\\\\asgard2\\-agent\\\\* and process.executable:(*\\\\thor64.exe or *\\\\thor.exe) and winlog.event_data.grantedaccess:(\"0x1fffff\" or \"0x1010\")) or (process.executable:(c\\:\\\\program\\ files\\\\* or c\\:\\\\program\\ files\\ \\(x86\\)\\\\* or c\\:\\\\windows\\\\system32\\\\*) and winlog.event_data.grantedaccess:(\"0x1410\" or \"0x410\")) or (process.executable:*c\\:\\\\users\\\\* and process.executable:*\\\\appdata\\\\local\\\\* and process.executable:(*\\\\microsoft\\ vs\\ code\\\\code.exe or *\\\\software_reporter_tool.exe or *\\\\dropboxupdate.exe) and winlog.event_data.grantedaccess:\"0x410\"))))
<li><a href="#">query: ((winlog.event_data.targetimage:*\\\\lsass.exe and winlog.event_data.grantedaccess:(*30 or *50 or *70 or *90 or *b0 or *d0 or *f0 or *18 or *38 or *58 or *78 or *98 or *b8 or *d8 or *f8 or *1a or *3a or *5a or *7a or *9a or *ba or *da or *fa or *0x14c2)) and (not ((process.executable:(\"c\\:\\\\windows\\\\system32\\\\taskmgr.exe\" or \"c\\:\\\\program\\ files\\\\malwarebytes\\\\anti\\-malware\\\\mbamservice.exe\" or \"c\\:\\\\programdata\\\\malwarebytes\\\\mbamservice\\\\ctlrupdate\\\\mbupdatr.exe\" or \"c\\:\\\\windows\\\\system32\\\\taskhostw.exe\" or c\\:\\\\users\\\\*\\\\appdata\\\\local\\\\programs\\\\microsoft\\ vs\\ code\\\\code.exe or \"c\\:\\\\program\\ files\\\\windows\\ defender\\\\msmpeng.exe\" or \"c\\:\\\\windows\\\\syswow64\\\\msiexec.exe\" or \"c\\:\\\\windows\\\\system32\\\\msiexec.exe\" or \"c\\:\\\\windows\\\\system32\\\\lsass.exe\" or \"c\\:\\\\windows\\\\system32\\\\perfmon.exe\" or \"c\\:\\\\windows\\\\system32\\\\mrt.exe\" or \"c\\:\\\\program\\ files\\\\cisco\\\\cisco\\ anyconnect\\ secure\\ mobility\\ client\\\\vpnagent.exe\" or \"c\\:\\\\program\\ files\\ \\(x86\\)\\\\cisco\\\\cisco\\ anyconnect\\ secure\\ mobility\\ client\\\\vpnagent.exe\")) or (process.executable:c\\:\\\\programdata\\\\microsoft\\\\windows\\ defender\\\\* and process.executable:*\\\\msmpeng.exe) or (process.executable:c\\:\\\\programdata\\\\vmware\\\\vmware\\ tools\\\\* and process.executable:*\\\\vmtoolsd.exe) or (process.executable:(c\\:\\\\program\\ files\\\\* or c\\:\\\\program\\ files\\ \\(x86\\)\\\\*) and process.executable:*antivirus*) or (process.executable:\"c\\:\\\\windows\\\\system32\\\\mrt.exe\" and winlog.event_data.grantedaccess:\"0x1418\") or (process.executable:\"c\\:\\\\program\\ files\\\\common\\ files\\\\mcafee\\\\mmsshost\\\\mmsshost.exe\") or (process.executable:c\\:\\\\windows\\\\temp\\\\asgard2\\-agent\\\\* and process.executable:(*\\\\thor64.exe or *\\\\thor.exe) and winlog.event_data.grantedaccess:\"0x1fffff\") or (winlog.event_data.calltrace:*|c\\:\\\\programdata\\\\microsoft\\\\windows\\ defender\\\\definition\\ updates\\\\\\{* and winlog.event_data.calltrace:*\\}\\\\mpengine.dll\\+* and winlog.event_data.grantedaccess:\"0x1418\"))))
<li><a href="#">query: ((winlog.event_data.targetimage:*\\\\lsass.exe and winlog.event_data.grantedaccess:(\"0x1410\" or \"0x1010\" or \"0x410\")) and (not (process.executable:(c\\:\\\\program\\ files\\\\windowsapps\\\\* or c\\:\\\\windows\\\\system32\\\\*) and process.executable:*\\\\gamingservices.exe)))
<li><a href="#">query: ((winlog.event_data.targetimage:*\\\\lsass.exe and winlog.event_data.grantedaccess:(0x40* or 0x100000* or 0x1410* or 0x1438* or 0x143a* or 0x1418* or 0x1f0fff* or 0x1f1fff* or 0x1f2fff* or 0x1f3fff*)) and (not ((process.executable.text:(\"c\\:\\\\windows\\\\system32\\\\taskmgr.exe\" or \"c\\:\\\\windows\\\\system32\\\\perfmon.exe\")) or (process.executable.text:c\\:\\\\programdata\\\\microsoft\\\\windows\\ defender\\\\* and process.executable.text:*\\\\msmpeng.exe) or (process.executable.text:\"c\\:\\\\windows\\\\system32\\\\svchost.exe\" and winlog.event_data.calltrace:*|c\\:\\\\programdata\\\\microsoft\\\\windows\\ defender\\\\definition\\ updates\\\\\\{* and winlog.event_data.calltrace:*\\}\\\\mpengine.dll\\+* and winlog.event_data.grantedaccess:\"0x1418\") or (process.executable.text:c\\:\\\\program\\ files\\\\windowsapps\\\\* and process.executable.text:*\\\\gamingservices.exe and winlog.event_data.grantedaccess:(\"0x1410\" or \"0x410\")) or (process.executable.text:(*\\\\procexp64.exe or *\\\\procexp.exe or *c\\:\\\\windows\\\\system32\\\\taskhostw.exe or *\\\\mbaminstallerservice.exe) and winlog.event_data.grantedaccess:(\"0x1410\" or \"0x410\" or \"0x40\")) or (process.executable.text:c\\:\\\\programdata\\\\vmware\\\\vmware\\ tools\\\\* and process.executable.text:*\\\\vmtoolsd.exe) or (process.executable.text:\"c\\:\\\\windows\\\\system32\\\\svchost.exe\" and winlog.event_data.grantedaccess:\"0x100000\") or (process.executable.text:(\"c\\:\\\\windows\\\\system32\\\\wbem\\\\wmiprvse.exe\" or \"c\\:\\\\windows\\\\syswow64\\\\msiexec.exe\" or \"c\\:\\\\windows\\\\system32\\\\msiexec.exe\") and winlog.event_data.grantedaccess:(\"0x1410\" or \"0x410\")) or (process.executable.text:(*\\\\thor.exe or *\\\\thor64.exe or *\\\\aurora\\-agent.exe or *\\\\aurora\\-agent\\-64.exe) and winlog.event_data.grantedaccess:(\"0x40\" or \"0x1010\")) or (process.executable.text:*\\\\explorer.exe and winlog.event_data.grantedaccess:\"0x401\") or (process.executable.text:(\"c\\:\\\\windows\\\\system32\\\\wininit.exe\" or \"c\\:\\\\windows\\\\system32\\\\lsass.exe\") and winlog.event_data.grantedaccess:\"0x1000000\") or (process.executable.text:\"c\\:\\\\windows\\\\system32\\\\mrt.exe\" and winlog.event_data.grantedaccess:(\"0x1410\" or \"0x1418\")) or (winlog.event_data.grantedaccess:\"0x40\" and process.executable.text:(*\\\\handle.exe or *\\\\handle64.exe)) or (process.executable.text:(c\\:\\\\program\\ files\\\\* or c\\:\\\\program\\ files\\ \\(x86\\)\\\\*) and winlog.event_data.grantedaccess:(\"0x1410\" or \"0x410\")) or (process.executable.text:c\\:\\\\program\\ files\\ \\(x86\\)\\\\microsoft\\\\edge\\\\application\\\\* and process.executable.text:*\\\\installer\\\\setup.exe) or (process.executable.text:*\\\\appdata\\\\local\\\\webex\\\\webexhost.exe and winlog.event_data.grantedaccess:\"0x401\") or (process.executable.text:\"c\\:\\\\programdata\\\\malwarebytes\\\\mbamservice\\\\ctlrupdate\\\\mbupdatr.exe\" and winlog.event_data.grantedaccess:\"0x1410\") or (winlog.event_data.calltrace:(*|c\\:\\\\program\\ files\\\\windows\\ defender\\\\mprtp.dll* or *|c\\:\\\\program\\ files\\\\windows\\ defender\\\\mpclient.dll*)) or (process.executable.text:c\\:\\\\windows\\\\temp\\\\* and process.executable.text:*.tmp\\\\dropboxupdate.exe and winlog.event_data.grantedaccess:(\"0x410\" or \"0x1410\")) or (process.executable.text:*\\\\appdata\\\\local\\\\temp\\\\* and process.executable.text:*.tmp\\\\dropboxupdate.exe and winlog.event_data.grantedaccess:\"0x1410\") or (process.executable.text:c\\:\\\\program\\ files\\\\microsoft\\ visual\\ studio\\\\* and process.executable.text:*\\\\msbuild\\\\current\\\\bin\\\\msbuild.exe and winlog.event_data.grantedaccess:\"0x1f3fff\"))))
<li><a href="#">query: ((winlog.event_data.targetimage:*\\\\lsass.exe and winlog.event_data.grantedaccess:(0x40* or 0x100000* or 0x1410* or 0x1438* or 0x143a* or 0x1418* or 0x1f0fff* or 0x1f1fff* or 0x1f2fff* or 0x1f3fff*)) and (not ((process.executable:(\"c\\:\\\\windows\\\\system32\\\\taskmgr.exe\" or \"c\\:\\\\windows\\\\system32\\\\perfmon.exe\")) or (process.executable:c\\:\\\\programdata\\\\microsoft\\\\windows\\ defender\\\\* and process.executable:*\\\\msmpeng.exe) or (process.executable:c\\:\\\\program\\ files\\\\windowsapps\\\\* and process.executable:*\\\\gamingservices.exe and winlog.event_data.grantedaccess:(\"0x1410\" or \"0x410\")) or (process.executable:(*\\\\procexp64.exe or *\\\\procexp.exe or *c\\:\\\\windows\\\\system32\\\\taskhostw.exe) and winlog.event_data.grantedaccess:(\"0x1410\" or \"0x410\")) or (process.executable:c\\:\\\\programdata\\\\vmware\\\\vmware\\ tools\\\\* and process.executable:*\\\\vmtoolsd.exe) or (process.executable:\"c\\:\\\\windows\\\\system32\\\\svchost.exe\" and winlog.event_data.grantedaccess:\"0x100000\") or (process.executable:(\"c\\:\\\\windows\\\\system32\\\\wbem\\\\wmiprvse.exe\" or \"c\\:\\\\windows\\\\syswow64\\\\msiexec.exe\" or \"c\\:\\\\windows\\\\system32\\\\msiexec.exe\") and winlog.event_data.grantedaccess:(\"0x1410\" or \"0x410\")) or (process.executable:(*\\\\thor.exe or *\\\\thor64.exe) and winlog.event_data.grantedaccess:(\"0x40\" or \"0x1010\")) or (process.executable:*\\\\explorer.exe and winlog.event_data.grantedaccess:\"0x401\") or (process.executable:\"c\\:\\\\windows\\\\system32\\\\wininit.exe\" and winlog.event_data.grantedaccess:\"0x1000000\") or (process.executable:\"c\\:\\\\windows\\\\system32\\\\mrt.exe\" and winlog.event_data.grantedaccess:(\"0x1410\" or \"0x1418\")) or (process.executable:(c\\:\\\\program\\ files\\\\* or c\\:\\\\program\\ files\\ \\(x86\\)\\\\*) and winlog.event_data.grantedaccess:(\"0x1410\" or \"0x410\")) or (process.executable:c\\:\\\\program\\ files\\ \\(x86\\)\\\\microsoft\\\\edge\\\\application\\\\* and process.executable:*\\\\installer\\\\setup.exe))))
<li><a href="#">query: ((winlog.event_data.targetimage:*\\\\lsass.exe and winlog.event_data.grantedaccess:*10) and (not ((process.executable.text:(\"c\\:\\\\windows\\\\system32\\\\taskmgr.exe\" or \"c\\:\\\\program\\ files\\\\malwarebytes\\\\anti\\-malware\\\\mbamservice.exe\" or \"c\\:\\\\programdata\\\\malwarebytes\\\\mbamservice\\\\ctlrupdate\\\\mbupdatr.exe\" or \"c\\:\\\\windows\\\\system32\\\\taskhostw.exe\" or \"c\\:\\\\program\\ files\\\\windows\\ defender\\\\msmpeng.exe\" or \"c\\:\\\\windows\\\\syswow64\\\\msiexec.exe\" or \"c\\:\\\\windows\\\\system32\\\\msiexec.exe\" or \"c\\:\\\\windows\\\\system32\\\\lsass.exe\" or \"c\\:\\\\windows\\\\system32\\\\perfmon.exe\" or \"c\\:\\\\windows\\\\system32\\\\wbem\\\\wmiprvse.exe\" or \"c\\:\\\\windows\\\\syswow64\\\\wbem\\\\wmiprvse.exe\" or \"c\\:\\\\program\\ files\\\\common\\ files\\\\mcafee\\\\mmsshost\\\\mmsshost.exe\")) or (process.executable.text:c\\:\\\\programdata\\\\microsoft\\\\windows\\ defender\\\\* and process.executable.text:*\\\\msmpeng.exe) or (process.executable.text:c\\:\\\\program\\ files\\\\windowsapps\\\\* and process.executable.text:*\\\\gamingservices.exe) or (process.executable.text:(*\\\\procexp64.exe or *\\\\procexp.exe)) or (process.executable.text:c\\:\\\\programdata\\\\vmware\\\\vmware\\ tools\\\\* and process.executable.text:*\\\\vmtoolsd.exe) or (process.executable.text:(c\\:\\\\program\\ files\\\\* or c\\:\\\\program\\ files\\ \\(x86\\)\\\\*) and process.executable.text:*antivirus*) or (process.executable.text:(*\\\\thor64.exe or *\\\\thor.exe or *\\\\aurora\\-agent\\-64.exe or *\\\\aurora\\-agent.exe)) or (process.executable.text:*\\\\appdata\\\\local\\\\temp\\\\* and process.executable.text:*\\\\vs_bootstrapper_* and winlog.event_data.grantedaccess:\"0x1410\") or (process.executable.text:(c\\:\\\\program\\ files\\\\* or c\\:\\\\program\\ files\\ \\(x86\\)\\\\* or c\\:\\\\windows\\\\system32\\\\*)) or (sourcecommandline:\"c\\:\\\\windows\\\\system32\\\\wermgr.exe\\ \\-upload\") or (process.executable.text:*c\\:\\\\users\\\\* and process.executable.text:*\\\\appdata\\\\local\\\\* and process.executable.text:(*\\\\microsoft\\ vs\\ code\\\\code.exe or *\\\\software_reporter_tool.exe or *\\\\dropboxupdate.exe or *\\\\mbaminstallerservice.exe or *\\\\webex\\\\webexhost.exe or *\\\\programs\\\\microsoft\\ vs\\ code\\\\code.exe or *\\\\jetbrains\\\\toolbox\\\\bin\\\\jetbrains\\-toolbox.exe)) or (process.executable.text:*\\\\xampp\\-control.exe and winlog.event_data.grantedaccess:\"0x410\") or (process.executable.text:*\\\\steamlibrary\\\\steamapps\\\\* and winlog.event_data.grantedaccess:\"0x410\"))))
<li><a href="#">query: ((winlog.event_data.targetimage:*\\\\svchost.exe and winlog.event_data.grantedaccess:\"0x143a\") and (not (process.executable.text:(*\\\\services.exe or *\\\\msiexec.exe))))
<li><a href="#">query: ((winlog.event_data.targetimage:*\\\\svchost.exe and winlog.event_data.grantedaccess:\"0x143a\") and (not (process.executable:(*\\\\services.exe or *\\\\msiexec.exe))))
<li><a href="#">query: ((winlog.event_data.targetimage:*\\\\verclsid.exe and winlog.event_data.grantedaccess:\"0x1fffff\") and ((winlog.event_data.calltrace:*|unknown\\(* and winlog.event_data.calltrace:*vbe7.dll*) or (process.executable:*\\\\microsoft\\ office\\\\* and winlog.event_data.calltrace:*|unknown*)))
<li><a href="#">query: ((winlog.event_data.targetimage:*\\\\windows\\\\system32\\\\svchost.exe and winlog.event_data.grantedaccess:\"0x1f3fff\" and winlog.event_data.calltrace:*unknown*) and (not ((process.executable.text:c\\:\\\\program\\ files\\\\microsoft\\ visual\\ studio\\\\* and process.executable.text:*\\\\msbuild\\\\current\\\\bin\\\\msbuild.exe and winlog.event_data.calltrace:(*microsoft.build.ni.dll* or *system.ni.dll*)))))
<li><a href="#">query: ((winlog.event_data.targetobject:(*\\\\control\\\\print\\\\environments\\\\windows\\ x64\\\\drivers\\\\version\\-3\\\\qms\\ 810\\\\* or *\\\\control\\\\print\\\\environments\\\\windows\\ x64\\\\drivers\\\\version\\-3\\\\mimikatz*) or (winlog.event_data.targetobject:*legitprinter* and winlog.event_data.targetobject:*\\\\control\\\\print\\\\environments\\\\windows*)) or (winlog.event_data.targetobject:(*\\\\control\\\\print\\\\environments* or *\\\\currentversion\\\\print\\\\printers*) and winlog.event_data.targetobject:(*gentil\\ kiwi* or *mimikatz\\ printer* or *kiwi\\ legit\\ printer*)))
<li><a href="#">query: ((winlog.event_data.targetobject:(*\\\\software\\\\microsoft\\\\windows\\ nt\\\\currentversion\\\\windows\\\\appinit_dlls or *\\\\software\\\\wow6432node\\\\microsoft\\\\windows\\ nt\\\\currentversion\\\\windows\\\\appinit_dlls) or newname:(*\\\\software\\\\microsoft\\\\windows\\ nt\\\\currentversion\\\\windows\\\\appinit_dlls or *\\\\software\\\\wow6432node\\\\microsoft\\\\windows\\ nt\\\\currentversion\\\\windows\\\\appinit_dlls)) and (not (winlog.event_data.details:\"\\(empty\\)\")))
<li><a href="#">query: ((winlog.event_data.targetobject:(*software\\\\microsoft\\\\office\\\\* or *\\\\outlook\\\\today\\\\*) and ((winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:*stamp and winlog.event_data.details:\"dword\\ \\(0x00000001\\)\") or winlog.event_data.targetobject:*userdefinedurl)) and (not ((process.executable:(c\\:\\\\program\\ files\\\\common\\ files\\\\microsoft\\ shared\\\\clicktorun\\\\* or c\\:\\\\program\\ files\\\\common\\ files\\\\microsoft\\ shared\\\\clicktorun\\\\updates\\\\*) and process.executable:*\\\\officeclicktorun.exe))))
<li><a href="#">query: ((winlog.event_data.targetobject:(hklm\\\\software\\\\microsoft\\\\windows\\ nt\\\\currentversion\\\\appcompatflags\\\\installedsdb\\\\* or hklm\\\\software\\\\microsoft\\\\windows\\ nt\\\\currentversion\\\\appcompatflags\\\\custom\\\\*) and winlog.event_data.eventtype:\"setvalue\") and (not (winlog.event_data.details:\"\")))
<li><a href="#">query: ((winlog.event_data.targetobject:(hklm\\\\software\\\\microsoft\\\\windows\\ nt\\\\currentversion\\\\appcompatflags\\\\installedsdb\\\\* or hklm\\\\software\\\\microsoft\\\\windows\\ nt\\\\currentversion\\\\appcompatflags\\\\custom\\\\*) and winlog.event_data.eventtype:\"setvalue\") and (not winlog.event_data.details:\"\"))
<li><a href="#">query: ((winlog.event_data.targetobject:*\\\\software\\\\microsoft\\\\fax\\\\device\\ providers\\\\* and winlog.event_data.targetobject:*\\\\imagename*) and (not (winlog.event_data.details:\"%systemroot%\\system32\\fxst30.dll\")))
<li><a href="#">query: ((winlog.event_data.targetobject:*\\\\system\\\\currentcontrolset\\\\control\\\\wmi\\\\autologger\\\\* and winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:(*\\\\eventlog\\-* or *\\\\defender*) and winlog.event_data.targetobject:(*\\\\enabled or *\\\\start) and winlog.event_data.details:\"dword\\ \\(0x00000000\\)\") and (not ((process.executable.text:\"c\\:\\\\windows\\\\system32\\\\wevtutil.exe\"))))
<li><a href="#">query: ((winlog.event_data.targetobject:*system\\\\currentcontrolset\\\\services\\\\vss* and process.executable:*esentutl.exe) and (not (winlog.event_data.targetobject:*system\\\\currentcontrolset\\\\services\\\\vss\\\\start*)))
<li><a href="#">query: ((winlog.event_data.targetobject:\"hkcu\\\\software\\\\classes\\\\clsid\\\\\\{e08a0f4b\\-1f65\\-4d4d\\-9a09\\-bd4625b9c5a1\\}\\\\model\" or (winlog.event_data.targetobject:(hkcu\\\\software\\\\app\\\\* or hklm\\\\software\\\\app\\\\*) and winlog.event_data.targetobject:(*appxbf13d4ea2945444d8b13e2121cb6b663\\\\* or *appx70162486c7554f7f80f481985d67586d\\\\* or *appx37cc7fdccd644b4f85f4b22d5a3f105a\\\\*) and winlog.event_data.targetobject:(*application or *defaulticon))) or (winlog.event_data.targetobject:hkcu\\\\* and winlog.event_data.targetobject:(*classes\\\\appxc52346ec40fb4061ad96be0e6cb7d16a\\\\* or *classes\\\\appx3bbba44c6cae4d9695755183472171e2\\\\* or *classes\\\\clsid\\\\\\{e3517e26\\-8e93\\-458d\\-a6df\\-8030bc80528b\\}\\\\* or *classes\\\\clsid\\\\\\{e08a0f4b\\-1f65\\-4d4d\\-9a09\\-bd4625b9c5a1\\}\\\\model*)))
<li><a href="#">query: ((winlog.event_data.targetobject:\"hklm\\\\system\\\\currentcontrolset\\\\control\\\\minint\" and winlog.event_data.eventtype:\"createkey\") or newname:\"hklm\\\\system\\\\currentcontrolset\\\\control\\\\minint\")
<li><a href="#">query: ((winlog.event_data.targetobject:hkcr\\\\* and winlog.event_data.details:url\\:*) and (not ((winlog.event_data.details:url\\:ms\\-*) or (process.executable.text:(c\\:\\\\program\\ files\\\\* or c\\:\\\\program\\ files\\ \\(x86\\)* or c\\:\\\\windows\\\\*)))))
<li><a href="#">query: ((winlog.event_data.targetobject:hklm\\\\software\\\\microsoft\\\\active\\ setup\\\\installed\\ components* and winlog.event_data.targetobject:*\\\\stubpath) and (not ((winlog.event_data.details:\\\"c\\:\\\\program\\ files\\\\google\\\\chrome\\\\application\\\\* and winlog.event_data.details:*\\\\installer\\\\chrmstp.exe\\\"\\ \\-\\-configure\\-user\\-settings\\ \\-\\-verbose\\-logging\\ \\-\\-system\\-level) or (winlog.event_data.details:(\\\"c\\:\\\\program\\ files\\ \\(x86\\)\\\\microsoft\\\\edge\\\\application\\\\* or \\\"c\\:\\\\program\\ files\\\\microsoft\\\\edge\\\\application\\\\*) and winlog.event_data.details:*\\\\installer\\\\setup.exe\\\"\\ \\-\\-configure\\-user\\-settings\\ \\-\\-verbose\\-logging\\ \\-\\-system\\-level\\ \\-\\-msedge\\ \\-\\-channel\\=stable))))
<li><a href="#">query: ((winlog.event_data.targetobject:hklm\\\\software\\\\microsoft\\\\active\\ setup\\\\installed\\ components* and winlog.event_data.targetobject:*\\\\stubpath) and (not ((winlog.event_data.details:\\\"c\\:\\\\program\\ files\\\\google\\\\chrome\\\\application\\\\* and winlog.event_data.details:*\\\\installer\\\\chrmstp.exe\\\"\\ \\-\\-configure\\-user\\-settings\\ \\-\\-verbose\\-logging\\ \\-\\-system\\-level))))
<li><a href="#">query: ((winlog.event_data.targetobject:hklm\\\\system\\\\currentcontrolset\\\\control\\\\print\\\\monitors\\\\* and winlog.event_data.details:*.dll and winlog.event_data.eventtype:\"setvalue\") and (not ((process.executable.text:\"c\\:\\\\windows\\\\system32\\\\spoolsv.exe\" and winlog.event_data.targetobject:*\\\\system\\\\currentcontrolset\\\\control\\\\print\\\\monitors\\\\cutepdf\\ writer\\ monitor\\ v4.0\\\\driver* and winlog.event_data.details:\"cpwmon64_v40.dll\" and user.name:(*authori* or *autori*)) or (winlog.event_data.targetobject:*control\\\\print\\\\monitors\\\\monvnc\\\\driver*) or (winlog.event_data.targetobject:*control\\\\print\\\\environments\\\\* and winlog.event_data.targetobject:*\\\\drivers\\\\* and winlog.event_data.targetobject:*\\\\vnc\\ printer*))))
<li><a href="#">query: ((winlog.event_data.targetobject:hklm\\\\system\\\\currentcontrolset\\\\control\\\\print\\\\monitors\\\\* and winlog.event_data.details:*.dll and winlog.event_data.eventtype:\"setvalue\") and (not ((process.executable:\"c\\:\\\\windows\\\\system32\\\\spoolsv.exe\" and winlog.event_data.targetobject:*\\\\system\\\\currentcontrolset\\\\control\\\\print\\\\monitors\\\\cutepdf\\ writer\\ monitor\\ v4.0\\\\driver* and winlog.event_data.details:\"cpwmon64_v40.dll\" and user.name:(*authori* or *autori*)))))
<li><a href="#">query: ((winlog.event_id:\"16403\" and localname:(*.bat or *.dll or *.exe or *.ps1 or *.vbe or *.vbs)) and (not (localname:*\\\\appdata\\\\* and remotename:*.com*)))
<li><a href="#">query: ((winlog.event_id:\"16403\" and remotename:(*http\\:\\/\\/1* or *http\\:\\/\\/2* or *http\\:\\/\\/3* or *http\\:\\/\\/4* or *http\\:\\/\\/5* or *http\\:\\/\\/6* or *http\\:\\/\\/7* or *http\\:\\/\\/8* or *http\\:\\/\\/9* or *https\\:\\/\\/1* or *https\\:\\/\\/2* or *https\\:\\/\\/3* or *https\\:\\/\\/4* or *https\\:\\/\\/5* or *https\\:\\/\\/6* or *https\\:\\/\\/7* or *https\\:\\/\\/8* or *https\\:\\/\\/9*)) and (not ((remotename:(*\\:\\/\\/10.* or *\\:\\/\\/192.168.* or *\\:\\/\\/172.16.* or *\\:\\/\\/172.17.* or *\\:\\/\\/172.18.* or *\\:\\/\\/172.19.* or *\\:\\/\\/172.20.* or *\\:\\/\\/172.21.* or *\\:\\/\\/172.22.* or *\\:\\/\\/172.23.* or *\\:\\/\\/172.24.* or *\\:\\/\\/172.25.* or *\\:\\/\\/172.26.* or *\\:\\/\\/172.27.* or *\\:\\/\\/172.28.* or *\\:\\/\\/172.29.* or *\\:\\/\\/172.30.* or *\\:\\/\\/172.31.* or *\\:\\/\\/127.* or *\\:\\/\\/169.254.*)) or (remotename:(*https\\:\\/\\/7\\-* or *http\\:\\/\\/7\\-*)))))
<li><a href="#">query: (*$\\{jndi\\:ldap\\:\\/* or *$\\{jndi\\:rmi\\:\\/* or *$\\{jndi\\:ldaps\\:\\/* or *$\\{jndi\\:dns\\:\\/* or *\\/$%7bjndi\\:* or *%24%7bjndi\\:* or *$%7bjndi\\:* or *%2524%257bjndi* or *%2f%252524%25257bjndi%3a* or *$\\{jndi\\:$\\{lower\\:* or *$\\{\\:\\:\\-j\\}$\\{* or *$\\{jndi\\:nis* or *$\\{jndi\\:nds* or *$\\{jndi\\:corba* or *$\\{jndi\\:iiop* or *reference\\ class\\ name\\:\\ foo* or *$\\{$\\{env\\:barfoo\\:\\-j\\}* or *$\\{\\:\\:\\-l\\}$\\{\\:\\:\\-d\\}$\\{\\:\\:\\-a\\}$\\{\\:\\:\\-p\\}* or *$\\{base64\\:jhtqbmrp* or *$\\{$\\{env\\:env_name\\:\\-j\\}ndi$\\{env\\:env_name\\:\\-\\:\\}$* or *$\\{$\\{lower\\:j\\}ndi\\:* or *$\\{$\\{upper\\:j\\}ndi\\:* or *$\\{$\\{\\:\\:\\-j\\}$\\{\\:\\:\\-n\\}$\\{\\:\\:\\-d\\}$\\{\\:\\:\\-i\\}\\:*)
<li><a href="#">query: (*%24%7b%28%23a%3d%40* or *$\\{\\(#a\\=@* or *%24%7b%40java* or *$\\{@java* or *u0022java* or *%2f%24%7b%23* or *\\/$\\{#* or *new\\+java.*)
<li><a href="#">query: (*\\ dropping\\ source\\ port\\ zero\\ packet\\ from\\ * or *\\ denied\\ axfr\\ from\\ * or *\\ exiting\\ \\(due\\ to\\ fatal\\ error\\)*)
<li><a href="#">query: (*\\(\\)\\{\\:;\\};* or *\\(\\)\\ \\{\\:;\\};* or *\\(\\)\\ \\{\\ \\:;\\};* or *\\(\\)\\ \\{\\ \\:;\\ \\};*)
<li><a href="#">query: (*\\/basic\\/command\\/base64\\/* or *\\/basic\\/reverseshell\\/* or *\\/basic\\/tomcatmemshell* or *\\/basic\\/jettymemshell* or *\\/basic\\/weblogicmemshell* or *\\/basic\\/jbossmemshell* or *\\/basic\\/webspherememshell* or *\\/basic\\/springmemshell* or *\\/deserialization\\/urldns\\/* or *\\/deserialization\\/commonscollections1\\/dnslog\\/* or *\\/deserialization\\/commonscollections2\\/command\\/base64\\/* or *\\/deserialization\\/commonsbeanutils1\\/reverseshell\\/* or *\\/deserialization\\/jre8u20\\/tomcatmemshell* or *\\/tomcatbypass\\/dnslog\\/* or *\\/tomcatbypass\\/command\\/* or *\\/tomcatbypass\\/reverseshell\\/* or *\\/tomcatbypass\\/tomcatmemshell* or *\\/tomcatbypass\\/springmemshell* or *\\/groovybypass\\/command\\/* or *\\/webspherebypass\\/upload\\/*)
<li><a href="#">query: (*\\=cookie* or *\\=script* or *\\=onload* or *\\=onmouseover*)
<li><a href="#">query: (*\\=select* or *\\=union* or *\\=concat*)
<li><a href="#">query: (*\\=whoami* or *\\=net%20user* or *\\=cmd%20\\/c%20* or *\\=powershell%20* or *\\=tasklist%20* or *\\=wmic%20*)
<li><a href="#">query: (*accessdeniedexception* or *csrfexception* or *invalidcsrftokenexception* or *missingcsrftokenexception* or *cookietheftexception* or *invalidcookieexception* or *requestrejectedexception*)
<li><a href="#">query: (*actioncontroller\\:\\:invalidauthenticitytoken* or *actioncontroller\\:\\:invalidcrossoriginrequest* or *actioncontroller\\:\\:methodnotallowed* or *actioncontroller\\:\\:badrequest* or *actioncontroller\\:\\:parametermissing*)
<li><a href="#">query: (*attempt\\ to\\ execute\\ code\\ on\\ stack\\ by* or *ftp\\ login\\ from\\ .*\\ 0bin0sh* or *rpc.statd\\[\\\\d\\+\\]\\:\\ gethostbyname\\ error\\ for* or *aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa*)
<li><a href="#">query: (*bash\\ \\-c\\ \\/bin\\/bash* and *&\\/dev\\/tcp\\/*)
<li><a href="#">query: (*begin\\ \\{s\\ \\=\\ \\\"\\/inet\\/tcp\\/0\\/* or *bash\\ \\-i\\ >&\\ \\/dev\\/tcp\\/* or *bash\\ \\-i\\ >&\\ \\/dev\\/udp\\/* or *sh\\ \\-i\\ >$\\ \\/dev\\/udp\\/* or *sh\\ \\-i\\ >$\\ \\/dev\\/tcp\\/* or *\\&&\\ while\\ read\\ line\\ 0<&5;\\ do* or *\\/bin\\/bash\\ \\-c\\ exec\\ 5<>\\/dev\\/tcp\\/* or *\\/bin\\/bash\\ \\-c\\ exec\\ 5<>\\/dev\\/udp\\/* or *nc\\ \\-e\\ \\/bin\\/sh\\ * or *\\/bin\\/sh\\ |\\ nc* or *rm\\ \\-f\\ backpipe;\\ mknod\\ \\/tmp\\/backpipe\\ p\\ \\&&\\ nc\\ * or *;socket\\(s,pf_inet,sock_stream,getprotobyname\\(\\\"tcp\\\"\\)\\);if\\(connect\\(s,sockaddr_in\\($p,inet_aton\\($i\\)\\)\\)\\)* or *;stdin\\->fdopen\\($c,r\\);$\\~\\->fdopen\\($c,w\\);system$_\\ while<>;* or *\\/bin\\/sh\\ \\-i\\ <&3\\ >&3\\ 2>&3* or *uname\\ \\-a;\\ w;\\ id;\\ \\/bin\\/bash\\ \\-i* or *$sendbyte\\ \\=\\ \\(\\[text.encoding\\]\\:\\:ascii\\).getbytes\\($sendback2\\);\\ $stream.write\\($sendbyte,0,$sendbyte.length\\);\\ $stream.flush\\(\\)\\};* or *;os.dup2\\(s.fileno\\(\\),0\\);os.dup2\\(s.fileno\\(\\),1\\);os.dup2\\(s.fileno\\(\\),2\\);os.putenv\\('histfile','\\/dev\\/null'\\);* or *.to_i;exec\\ sprintf\\(\\\"\\/bin\\/sh\\ \\-i\\ <&%d\\ >&%d\\ 2>&%d\\\",f,f,f\\)* or *;while\\(cmd\\=c.gets\\);io.popen\\(cmd,\\\"r\\\"\\)\\{|io|c.print* or *socat\\ exec\\:'bash\\ \\-li',pty,stderr,setsid,sigint,sane\\ tcp\\:* or *rm\\ \\-f\\ \\/tmp\\/p;\\ mknod\\ \\/tmp\\/p\\ p\\ \\&&* or *\\ |\\ \\/bin\\/bash\\ |\\ telnet\\ * or *,echo\\=0,raw\\ tcp\\-listen\\:* or *nc\\ \\-lvvp\\ * or *xterm\\ \\-display\\ 1*)
<li><a href="#">query: (*cat\\ \\/etc\\/issue* or *cat\\ \\/etc\\/*\\-release* or *cat\\ \\/proc\\/version* or *uname\\ \\-a* or *uname\\ \\-mrs* or *rpm\\ \\-q\\ kernel* or *dmesg\\ |\\ grep\\ linux* or *ls\\ \\/boot\\ |\\ grep\\ vmlinuz\\-* or *cat\\ \\/etc\\/profile* or *cat\\ \\/etc\\/bashrc* or *cat\\ \\~\\/.bash_profile* or *cat\\ \\~\\/.bashrc* or *cat\\ \\~\\/.bash_logout* or *ps\\ \\-aux\\ |\\ grep\\ root* or *ps\\ \\-ef\\ |\\ grep\\ root* or *crontab\\ \\-l* or *cat\\ \\/etc\\/cron* or *cat\\ \\/etc\\/cron.allow* or *cat\\ \\/etc\\/cron.deny* or *cat\\ \\/etc\\/crontab* or *grep\\ \\-i\\ user\\ * or *grep\\ \\-i\\ pass\\ * or *ifconfig* or *cat\\ \\/etc\\/network\\/interfaces* or *cat\\ \\/etc\\/sysconfig\\/network* or *cat\\ \\/etc\\/resolv.conf* or *cat\\ \\/etc\\/networks* or *iptables\\ \\-l* or *ip6tables\\ \\-l* or *lsof\\ \\-i* or *netstat\\ \\-antup* or *netstat\\ \\-antpx* or *netstat\\ \\-tulpn* or *arp\\ \\-e* or *route* or *cat\\ \\/etc\\/passwd* or *cat\\ \\/etc\\/group* or *cat\\ \\/etc\\/shadow* or *find\\ \\/\\ \\-perm\\ \\-u\\=s* or *find\\ \\/\\ \\-perm\\ \\-g\\=s* or *find\\ \\/\\ \\-perm\\ \\-4000* or *find\\ \\/\\ \\-perm\\ \\-2000* or *find\\ \\/\\ \\-perm\\ \\-o\\+w*)
<li><a href="#">query: (*chown\\ root* and (*\\ chmod\\ u\\+s* or *\\ chmod\\ g\\+s*))
<li><a href="#">query: (*chown\\ root*chmod\\ 4777\\ * or *cp\\ \\/bin\\/sh\\ .;chown* or *chmod\\ 4777\\ \\/tmp\\/.scsi\\/dev\\/bin\\/gsh* or *chown\\ root\\:root\\ \\/tmp\\/.scsi\\/dev\\/bin\\/* or *chown\\ root\\:root\\ x;* or *\\/bin\\/telnet\\ locip\\ locport\\ <\\ \\/dev\\/console\\ |\\ \\/bin\\/sh* or *\\/tmp\\/ratload* or *ewok\\ \\-t\\ * or *xspy\\ \\-display\\ * or *cat\\ >\\ \\/dev\\/tcp\\/127.0.0.1\\/80\\ <<end* or *rm\\ \\-f\\ \\/current\\/tmp\\/ftshell.latest* or *ghost_*\\ \\-v\\ * or *\\ \\-\\-wipe\\ >\\ \\/dev\\/null* or *ping\\ \\-c\\ 2\\ *;\\ grep\\ *\\ \\/proc\\/net\\/arp\\ >\\/tmp\\/gx* or *iptables\\ *\\ output\\ \\-p\\ tcp\\ \\-d\\ 127.0.0.1\\ \\-\\-tcp\\-flags\\ rst\\ rst\\ \\-j\\ drop;* or *>\\ \\/var\\/log\\/audit\\/audit.log;\\ rm\\ \\-f\\ .* or *cp\\ \\/var\\/log\\/audit\\/audit.log\\ .tmp* or *sh\\ >\\/dev\\/tcp\\/*\\ <&1\\ 2>&1* or *ncat\\ \\-vv\\ \\-l\\ \\-p\\ *\\ <* or *nc\\ \\-vv\\ \\-l\\ \\-p\\ *\\ <* or *<\\ \\/dev\\/console\\ |\\ uudecode\\ \\&&\\ uncompress* or *sendmail\\ \\-osendmail;chmod\\ \\+x\\ sendmail* or *\\/usr\\/bin\\/wget\\ \\-o\\ \\/tmp\\/a\\ http*\\ \\&&\\ chmod\\ 755\\ \\/tmp\\/cron* or *chmod\\ 666\\ \\/var\\/run\\/utmp\\~* or *chmod\\ 700\\ nscd\\ crond* or *cp\\ \\/etc\\/shadow\\ \\/tmp\\/.* or *<\\/dev\\/console\\ |uudecode\\ >\\ \\/dev\\/null\\ 2>&1\\ \\&&\\ uncompress* or *chmod\\ 700\\ jp\\&&netstat\\ \\-an|grep* or *uudecode\\ >\\ \\/dev\\/null\\ 2>&1\\ \\&&\\ uncompress\\ \\-f\\ *\\ \\&&\\ chmod\\ 755* or *chmod\\ 700\\ crond* or *wget\\ http*;\\ chmod\\ \\+x\\ \\/tmp\\/sendmail* or *chmod\\ 700\\ fp\\ sendmail\\ pt* or *chmod\\ 755\\ \\/usr\\/vmsys\\/bin\\/pipe* or *chmod\\ \\-r\\ 755\\ \\/usr\\/vmsys* or *chmod\\ 755\\ $opbin\\/*tunnel* or *chmod\\ 700\\ sendmail* or *chmod\\ 0700\\ sendmail* or *\\/usr\\/bin\\/wget\\ http*sendmail;chmod\\ \\+x\\ sendmail;* or *\\&&\\ telnet\\ *\\ 2>&1\\ <\\/dev\\/console*)
<li><a href="#">query: (*clear\\ logging* or *clear\\ archive*)
<li><a href="#">query: (*connection\\ refused\\:\\ too\\ many\\ sessions\\ for\\ this\\ address.* or *connection\\ refused\\:\\ tcp_wrappers\\ denial.* or *bad\\ http\\ verb.* or *port\\ and\\ pasv\\ both\\ active* or *pasv\\ and\\ port\\ both\\ active* or *transfer\\ done\\ \\(but\\ failed\\ to\\ open\\ directory\\).* or *could\\ not\\ set\\ file\\ modification\\ time.* or *bug\\:\\ pid\\ active\\ in\\ ptrace_sandbox_free* or *ptrace_setoptions\\ failure* or *weird\\ status\\:* or *couldn't\\ handle\\ sandbox\\ event* or *syscall\\ *\\ out\\ of\\ bounds* or *syscall\\ not\\ permitted\\:* or *syscall\\ validate\\ failed\\:* or *input\\ line\\ too\\ long.* or *poor\\ buffer\\ accounting\\ in\\ str_netfd_alloc* or *vsf_sysutil_read_loop*)
<li><a href="#">query: (*dataerror* or *integrityerror* or *programmingerror* or *operationalerror*)
<li><a href="#">query: (*echo\\ \\\"*\\\"\\ >\\ *\\ \\&&\\ chmod\\ \\+x\\ * and *mv\\ *\\ \\\"*\\ \\\"*)
<li><a href="#">query: (*entered\\ promiscuous\\ mode* or *deactivating\\ service* or *oversized\\ packet\\ received\\ from* or *imuxsock\\ begins\\ to\\ drop\\ messages*)
<li><a href="#">query: (*http_proxy\\=* or *https_proxy\\=*)
<li><a href="#">query: (*ln\\ \\-s\\ \\-f\\ \\/etc\\/passwd* or *ln\\ \\-s\\ \\/etc\\/passwd*)
<li><a href="#">query: (*microsoft.compute\\/virtualmachines\\/write* or *microsoft.resources\\/deployments\\/write*)
<li><a href="#">query: (*microsoft.documentdb\\/databaseaccounts\\/listkeys\\/action* or *microsoft.maps\\/accounts\\/listkeys\\/action* or *microsoft.media\\/mediaservices\\/listkeys\\/action* or *microsoft.cognitiveservices\\/accounts\\/listkeys\\/action* or *microsoft.storage\\/storageaccounts\\/listkeys\\/action* or *microsoft.compute\\/snapshots\\/write* or *microsoft.network\\/networksecuritygroups\\/write*)
<li><a href="#">query: (*networkd-dispatcher* and *error handling notification for interface* and *../../*)
<li><a href="#">query: (*pkexec* and *the value for environment variable xauthority contains suscipious content* and *[user=root] [tty=/dev/pts/0]*)
<li><a href="#">query: (*quoted\\ string\\ not\\ properly\\ terminated* or *you\\ have\\ an\\ error\\ in\\ your\\ sql\\ syntax* or *unclosed\\ quotation\\ mark* or *near\\ \\\"*\\\"\\:\\ syntax\\ error* or *selects\\ to\\ the\\ left\\ and\\ right\\ of\\ union\\ do\\ not\\ have\\ the\\ same\\ number\\ of\\ result\\ columns*)
<li><a href="#">query: (*remove-mailboxexportrequest* and * -identity * and * -confirm \"false\"*)
<li><a href="#">query: (*rm\\ *bash_history* or *echo\\ \\\"\\\"\\ >\\ *bash_history* or *cat\\ \\/dev\\/null\\ >\\ *bash_history* or *cat\\ \\/dev\\/zero\\ >\\ *bash_history* or *ln\\ \\-sf\\ \\/dev\\/null\\ *bash_history* or *ln\\ \\-sf\\ \\/dev\\/zero\\ *bash_history* or *truncate\\ \\-s0\\ *bash_history* or *export\\ histfilesize\\=0* or *history\\ \\-c* or *history\\ \\-w* or *shred\\ *bash_history* or *empty_bash_history* or *chattr\\ \\+i\\ *bash_history*)
<li><a href="#">query: (*set\\-oabvirtualdirectory* and *externalurl* and *page_load* and *script*)
<li><a href="#">query: (*set-oabvirtualdirectory* and *externalurl* and *page_load* and *script*)
<li><a href="#">query: (*stopping\\ iptables* or *stopping\\ ip6tables* or *stopping\\ firewalld* or *stopping\\ cbdaemon* or *stopping\\ falcon\\-sensor*)
<li><a href="#">query: (*suspiciousoperation* or *disallowedhost* or *disallowedmodeladminlookup* or *disallowedmodeladmintofield* or *disallowedredirect* or *invalidsessionkey* or *requestdatatoobig* or *suspiciousfileoperation* or *suspiciousmultipartform* or *suspicioussession* or *toomanyfieldssent* or *permissiondenied*)
<li><a href="#">query: (*trojan*found* or *virtool*found* or *webshell*found* or *rootkit*found* or *htran*found*)
<li><a href="#">query: (*unexpected\\ internal\\ error* or *unknown\\ or\\ unsupported\\ key\\ type* or *invalid\\ certificate\\ signing\\ key* or *invalid\\ elliptic\\ curve\\ value* or *incorrect\\ signature* or *error\\ in\\ libcrypto* or *unexpected\\ bytes\\ remain\\ after\\ decoding* or *fatal\\:\\ buffer_get_string\\:\\ bad\\ string* or *local\\:\\ crc32\\ compensation\\ attack* or *bad\\ client\\ public\\ dh\\ value* or *corrupted\\ mac\\ on\\ input*)
<li><a href="#">query: (*wget\\ *\\ \\-\\ http*\\ |\\ perl* or *wget\\ *\\ \\-\\ http*\\ |\\ sh* or *wget\\ *\\ \\-\\ http*\\ |\\ bash* or *python\\ \\-m\\ simplehttpserver* or *\\-m\\ http.server* or *import\\ pty;\\ pty.spawn* or *socat\\ exec\\:* or *socat\\ \\-o\\ \\/tmp\\/* or *socat\\ tcp\\-connect* or *echo\\ binary\\ >>* or *wget\\ *;\\ chmod\\ \\+x* or *wget\\ *;\\ chmod\\ 777\\ * or *cd\\ \\/tmp\\ \\||\\ cd\\ \\/var\\/run\\ \\||\\ cd\\ \\/mnt* or *stop;service\\ iptables\\ stop;* or *stop;susefirewall2\\ stop;* or *chmod\\ 777\\ 2020* or *>>\\/etc\\/rc.local* or *base64\\ \\-d\\ \\/tmp\\/* or *\\ |\\ base64\\ \\-d\\ * or *\\/chmod\\ u\\+s\\ * or *chmod\\ \\+s\\ \\/tmp\\/* or *chmod\\ u\\+s\\ \\/tmp\\/* or *\\ \\/tmp\\/haxhax* or *\\ \\/tmp\\/ns_sploit* or *nc\\ \\-l\\ \\-p\\ * or *cp\\ \\/bin\\/ksh\\ * or *cp\\ \\/bin\\/sh\\ * or *\\ \\/tmp\\/*.b64\\ * or *\\/tmp\\/ysocereal.jar* or *\\/tmp\\/x\\ * or *;\\ chmod\\ \\+x\\ \\/tmp\\/* or *;chmod\\ \\+x\\ \\/tmp\\/*)
<li><a href="#">query: (\"new user\" and ((*gid=0*) or (*uid=0*) or (*gid=10*) or (*gid=27*)))
<li><a href="#">query: (\"system.net.webclient\" and (*.downloadfile\\(* or *.downloadstring\\(*))
<li><a href="#">query: (a1:\\-\\-cpu\\-priority* or a2:\\-\\-cpu\\-priority* or a3:\\-\\-cpu\\-priority* or a4:\\-\\-cpu\\-priority* or a5:\\-\\-cpu\\-priority* or a6:\\-\\-cpu\\-priority* or a7:\\-\\-cpu\\-priority*)
<li><a href="#">query: (authenticationrequirement:\"multifactorauthentication\" and winlog.event_data.status:*mfa\\ denied*)
<li><a href="#">query: (authenticationrequirement:\"singlefactorauthentication\" and resulttype:\"0\" and networklocationdetails:\"\\[\\]\" and devicedetail.deviceid:\"\")
<li><a href="#">query: (category:\"administrative\" and operationname:\"assigns\\ the\\ caller\\ to\\ user\\ access\\ admin\")
<li><a href="#">query: (category:\"keymanagement\" and operationname:\"read\\ bitlocker\\ key\")
<li><a href="#">query: (categoryvalue:\"administrative\" and resourceprovidervalue:\"microsoft.adhybridhealthservice\" and resourceid:*adfederationservice* and operationnamevalue:\"microsoft.adhybridhealthservice\\/services\\/delete\")
<li><a href="#">query: (categoryvalue:\"administrative\" and resourceprovidervalue:\"microsoft.adhybridhealthservice\" and resourceid:*adfederationservice* and operationnamevalue:\"microsoft.adhybridhealthservice\\/services\\/servicemembers\\/action\")
<li><a href="#">query: (company:\"securityxploded\" or process.executable:*passworddump.exe or winlog.event_data.originalfilename:*passworddump.exe)
<li><a href="#">query: (contents:(*\\:\\/\\/1* or *\\:\\/\\/2* or *\\:\\/\\/3* or *\\:\\/\\/4* or *\\:\\/\\/5* or *\\:\\/\\/6* or *\\:\\/\\/7* or *\\:\\/\\/8* or *\\:\\/\\/9*) and file.path.text:(*.ps1\\:zone* or *.bat\\:zone* or *.exe\\:zone* or *.vbe\\:zone* or *.vbs\\:zone* or *.dll\\:zone*))
<li><a href="#">query: (contents:(*https\\:\\/\\/transfer.sh\\/* or *raw.githubusercontent.com* or *gist.githubusercontent.com* or *pastebin.com* or *cdn.discordapp.com\\/attachments\\/* or *mediafire.com* or *mega.nz* or *ddns.net* or *.paste.ee* or *.hastebin.com* or *.ghostbin.co\\/* or *ufile.io* or *storage.googleapis.com* or *anonfiles.com* or *send.exploit.in*) and file.path.text:(*.exe\\:zone* or *.vbs\\:zone* or *.dll\\:zone*))
<li><a href="#">query: (contents:(*transfer.sh* or *raw.githubusercontent.com* or *gist.githubusercontent.com* or *pastebin.com* or *cdn.discordapp.com\\/attachments\\/* or *mediafire.com* or *mega.nz* or *ddns.net* or *.paste.ee* or *.hastebin.com* or *.ghostbin.co\\/* or *ufile.io* or *storage.googleapis.com* or *anonfiles.com* or *send.exploit.in*) and file.path.text:(*.ps1\\:zone* or *.bat\\:zone*))
<li><a href="#">query: (contextinfo:(*\\ \\-enc\\ * or *\\ \\-encodedcommand\\ * or *\\ \\-ec\\ *) and contextinfo:(*\\ \\-w\\ hidden\\ * or *\\ \\-window\\ hidden\\ * or *\\ \\-windowstyle\\ hidden\\ * or *\\ \\-w\\ 1\\ *) and contextinfo:(*\\ \\-noni\\ * or *\\ \\-noninteractive\\ *))
<li><a href="#">query: (contextinfo:(*\\ \\-enc\\ * or *\\ \\-encodedcommand\\ *) and contextinfo:(*\\ \\-w\\ hidden\\ * or *\\ \\-window\\ hidden\\ * or *\\ \\-windowstyle\\ hidden\\ *) and contextinfo:(*\\ \\-noni\\ * or *\\ \\-noninteractive\\ *))
<li><a href="#">query: (contextinfo:*\\** and (not ((contextinfo:(*\\=\\ powershell* or *\\=\\ c\\:\\\\windows\\\\system32\\\\windowspowershell\\\\v1.0\\\\powershell* or *\\=\\ c\\:\\\\windows\\\\syswow64\\\\windowspowershell\\\\v1.0\\\\powershell*)) or (contextinfo:*configsyncrun.exe*) or (contextinfo:*c\\:\\\\windows\\\\system32\\\\dsac.exe*) or (contextinfo:*c\\:\\\\windows\\\\system32\\\\wsmprovhost.exe\\ \\-embedding*) or ((powershell.command.invocation_details:(*update\\-help* or *failed\\ to\\ update\\ help\\ for\\ the\\ module*) or winlog.event_data.payload:(*update\\-help* or *failed\\ to\\ update\\ help\\ for\\ the\\ module*))))))
<li><a href="#">query: (contextinfo:*compress\\-archive\\ * and contextinfo:*\\ \\-path\\ * and contextinfo:*\\ \\-destinationpath\\ * and contextinfo:*$env\\:temp\\\\*)
<li><a href="#">query: (contextinfo:*invoke\\-athremotefxvgpudisablementcommand\\ * and contextinfo:(*\\-modulename\\ * or *\\-modulepath\\ * or *\\-scriptblock\\ * or *\\-remotefxvgpudisablementfilepath*))
<li><a href="#">query: (contextinfo:*system.net.webclient* and contextinfo:(*.downloadfile\\(* or *.downloadstring\\(*))
<li><a href="#">query: (cs-uri-query:(*\\/cgi\\-bin\\/.%2e\\/* or *\\/icons\\/.%2e\\/* or *\\/cgi\\-bin\\/.%%32%65\\/* or *\\/icons\\/.%%32%65\\/* or *\\/cgi\\-bin\\/.%%%25%33* or *\\/icons\\/.%%%25%33*) and http.response.status_code:(\"200\" or \"301\"))
<li><a href="#">query: (cs-uri-query:(*\\/dana\\-na\\/auth\\/* or *\\/dana\\-ws\\/* or *\\/dana\\-cached\\/*) and cs-uri-query:(*?id\\=* or *?token\\=* or *secid_canceltoken.cgi* or *cgi\\:\\:param* or *meeting* or *smb* or *namedusers* or *metric*))
<li><a href="#">query: (cs-uri-query:(*\\/tmui\\/* or *\\/hsqldb*) and cs-uri-query:(*..;\\/* or *.jsp\\/..*))
<li><a href="#">query: (cs-uri-query:(*\\+cscot\\+\\/translation\\-table* or *\\+cscot\\+\\/oem\\-customization*) and cs-uri-query:(*&textdomain\\=\\/* or *&textdomain\\=%* or *&name\\=\\/* or *&name\\=%*) and http.response.status_code:\"200\")
<li><a href="#">query: (cs-uri-query:(*cmd\\=read* or *connect&target* or *cmd\\=connect* or *cmd\\=disconnect* or *cmd\\=forward*) and not _exists_:cs-referer and not _exists_:cs-user-agent and http.request.method:\"post\")
<li><a href="#">query: (cs-uri-query:*?search\\=%00\\{.* and cs-uri-query:(*save|* or *powershell* or *cmd.exe* or *cmd\\ \\/c* or *cmd\\ \\/r* or *cmd\\ \\/k* or *cscript* or *wscript* or *python* or *c\\:\\\\users\\\\public\\\\* or *%comspec%*))
<li><a href="#">query: (cs-uri-query:*\\/..\\/..\\/..\\/..\\/..\\/..\\/..\\/* and http.response.status_code:\"200\" and cs-uri-query:(*\\/public\\/plugins\\/live* or *\\/public\\/plugins\\/icon* or *\\/public\\/plugins\\/loki* or *\\/public\\/plugins\\/text* or *\\/public\\/plugins\\/logs* or *\\/public\\/plugins\\/news* or *\\/public\\/plugins\\/stat* or *\\/public\\/plugins\\/mssql* or *\\/public\\/plugins\\/mixed* or *\\/public\\/plugins\\/mysql* or *\\/public\\/plugins\\/tempo* or *\\/public\\/plugins\\/graph* or *\\/public\\/plugins\\/gauge* or *\\/public\\/plugins\\/table* or *\\/public\\/plugins\\/debug* or *\\/public\\/plugins\\/zipkin* or *\\/public\\/plugins\\/jaeger* or *\\/public\\/plugins\\/geomap* or *\\/public\\/plugins\\/canvas* or *\\/public\\/plugins\\/grafana* or *\\/public\\/plugins\\/welcome* or *\\/public\\/plugins\\/xychart* or *\\/public\\/plugins\\/heatmap* or *\\/public\\/plugins\\/postgres* or *\\/public\\/plugins\\/testdata* or *\\/public\\/plugins\\/opentsdb* or *\\/public\\/plugins\\/influxdb* or *\\/public\\/plugins\\/barchart* or *\\/public\\/plugins\\/annolist* or *\\/public\\/plugins\\/bargauge* or *\\/public\\/plugins\\/graphite* or *\\/public\\/plugins\\/dashlist* or *\\/public\\/plugins\\/piechart* or *\\/public\\/plugins\\/dashboard* or *\\/public\\/plugins\\/nodegraph* or *\\/public\\/plugins\\/alertlist* or *\\/public\\/plugins\\/histogram* or *\\/public\\/plugins\\/table\\-old* or *\\/public\\/plugins\\/pluginlist* or *\\/public\\/plugins\\/timeseries* or *\\/public\\/plugins\\/cloudwatch* or *\\/public\\/plugins\\/prometheus* or *\\/public\\/plugins\\/stackdriver* or *\\/public\\/plugins\\/alertgroups* or *\\/public\\/plugins\\/alertmanager* or *\\/public\\/plugins\\/elasticsearch* or *\\/public\\/plugins\\/gettingstarted* or *\\/public\\/plugins\\/state\\-timeline* or *\\/public\\/plugins\\/status\\-history* or *\\/public\\/plugins\\/grafana\\-clock\\-panel* or *\\/public\\/plugins\\/grafana\\-simple\\-json\\-datasource* or *\\/public\\/plugins\\/grafana\\-azure\\-monitor\\-datasource*))
<li><a href="#">query: (cs-uri-query:*\\/autodiscover.json* and cs-uri-query:(*\\/powershell* or *\\/mapi\\/nspi* or *\\/ews* or *x\\-rps\\-cat*) and http.response.status_code:(\"200\" or \"301\"))
<li><a href="#">query: (cs-uri-query:*\\/cgi\\-bin\\/jarrewrite.sh* and cs-user-agent:(*\\:;* or *\\(\\)\\ \\{* or *\\/bin\\/bash\\ \\-c*))
<li><a href="#">query: (cs-uri-query:*\\/ecp\\/default.aspx* and cs-uri-query:*__viewstategenerator\\=* and cs-uri-query:*__viewstate\\=*)
<li><a href="#">query: (cs-uri-query:*\\/rest\\/api\\/latest\\/projects\\/* and cs-uri-query:*prefix\\=* and cs-uri-query:*%00\\-\\-exec*)
<li><a href="#">query: (cs-uri-query:*\\~1* and cs-uri-query:*a.aspx and http.request.method:(\"get\" or \"options\") and http.response.status_code:(\"200\" or \"301\"))
<li><a href="#">query: (cs-uri-query:*lang\\=\\/..\\/..\\/* and cs-uri-query:*\\/dev\\/cmdb\\/sslvpn_websession*)
<li><a href="#">query: (cs-user-agent:\"mozilla/5.0 (windows nt 10.0; win64; x64) applewebkit/537.36 (khtml, like gecko) chrome/105.0.5195.54 safari/537.36\" and http.request.method:\"post\" and http.response.status_code:\"200\" and cs-uri-query:*\\/owa\\/mastermailbox* and cs-uri-query:*\\/powershell*)
<li><a href="#">query: (destination.ip:(\"69.42.98.86\" or \"89.185.234.145\") or source.ip:(\"69.42.98.86\" or \"89.185.234.145\"))
<li><a href="#">query: (destination.port:(\"5985\" or \"5986\") and (not (user.name:(*authori* or *autori*))))
<li><a href="#">query: (destination.port:(\"8080\" or \"21\" or \"80\" or \"23\" or \"50000\" or \"1521\" or \"27017\" or \"3306\" or \"1433\" or \"11211\" or \"15672\" or \"5900\" or \"5901\" or \"5902\" or \"5903\" or \"5904\") and action:(\"forward\" or \"accept\" or \"2\"))
<li><a href="#">query: (dll.path:(*\\\\system.management.automation.dll or *\\\\system.management.automation.ni.dll) and (not ((process.executable.text:(\"c\\:\\\\windows\\\\system32\\\\dsac.exe\" or \"c\\:\\\\program\\ files\\\\powershell\\\\7\\\\pwsh.exe\") or process.executable.text:(*\\\\powershell.exe or *\\\\powershell_ise.exe or *\\\\windows\\\\system32\\\\sdiagnhost.exe or *\\\\mscorsvw.exe or *\\\\windows\\\\system32\\\\remotefxvgpudisablement.exe or *\\\\sqlps.exe or *\\\\wsmprovhost.exe or *\\\\winrshost.exe or *\\\\syncappvpublishingserver.exe or *\\\\runscripthelper.exe or *\\\\servermanager.exe or *\\\\microsoft\\ sql\\ server\\ management\\ studio\\ *\\\\common*\\\\ide\\\\ssms.exe or *\\\\ide\\\\devenv.exe or *\\\\servicehub.vsdetouredhost.exe or *\\\\servicehub.settingshost.exe or *\\\\servicehub.host.clr.x86.exe or *\\\\citrix\\\\configsync\\\\configsyncrun.exe) or process.executable.text:(c\\:\\\\program\\ files\\ \\(x86\\)\\\\microsoft\\ visual\\ studio\\\\* or c\\:\\\\program\\ files\\\\microsoft\\ visual\\ studio\\\\*)) or (process.executable.text:c\\:\\\\windows\\\\temp\\\\asgard2\\-agent\\\\* and process.executable.text:(*\\\\thor64.exe or *\\\\thor.exe)))))
<li><a href="#">query: (dll.path:(*\\\\vsstrace.dll or *\\\\vssapi.dll) and (not ((process.executable.text:(c\\:\\\\windows\\\\* or c\\:\\\\program\\ files\\\\* or c\\:\\\\program\\ files\\ \\(x86\\)\\\\*)))))
<li><a href="#">query: (dll.path:(*c\\:\\\\windows\\\\system32\\\\wlbsctrl.dll or *c\\:\\\\windows\\\\system32\\\\tsmsisrv.dll or *c\\:\\\\windows\\\\system32\\\\tsvipsrv.dll or *c\\:\\\\windows\\\\system32\\\\wow64log.dll or *c\\:\\\\windows\\\\system32\\\\wptsextensions.dll or *c\\:\\\\windows\\\\system32\\\\wbem\\\\wbemcomn.dll) and (not (signed:\"true\" and winlog.event_data.signature:\"microsoft windows\")))
<li><a href="#">query: (dll.path:(c\\:\\\\windows\\\\system32\\\\logonui.exe.local\\\\* or c\\:\\\\windows\\\\system32\\\\werfault.exe.local\\\\* or c\\:\\\\windows\\\\system32\\\\consent.exe.local\\\\* or c\\:\\\\windows\\\\system32\\\\narrator.exe.local\\\\* or c\\:\\\\windows\\\\system32\\\\wermgr.exe.local\\\\*) and dll.path:*\\\\comctl32.dll)
<li><a href="#">query: (dll.path:*\\\\dbgcore.dll and (not ((dll.path:(c\\:\\\\windows\\\\system32\\\\* or c\\:\\\\windows\\\\syswow64\\\\* or c\\:\\\\windows\\\\winsxs\\\\* or c\\:\\\\windows\\\\softwaredistribution\\\\* or c\\:\\\\windows\\\\systemtemp\\\\* or c\\:\\\\program\\ files\\ \\(x86\\)\\\\* or c\\:\\\\program\\ files\\\\*)) or (dll.path:*\\\\steam\\\\bin\\\\cef\\\\cef.win7x64\\\\dbgcore.dll))))
<li><a href="#">query: (dll.path:*\\\\dbghelp.dll and (not ((dll.path:(c\\:\\\\windows\\\\system32\\\\* or c\\:\\\\windows\\\\syswow64\\\\* or c\\:\\\\windows\\\\winsxs\\\\* or c\\:\\\\windows\\\\softwaredistribution\\\\* or c\\:\\\\windows\\\\systemtemp\\\\* or c\\:\\\\program\\ files\\ \\(x86\\)\\\\* or c\\:\\\\program\\ files\\\\*) or dll.path:(*\\\\epic\\ games\\\\launcher\\\\engine\\\\binaries\\\\thirdparty\\\\dbghelp\\\\dbghelp.dll or *\\\\epic\\ games\\\\magiclegends\\\\x86\\\\dbghelp.dll or *\\\\anaconda3\\\\lib\\\\site\\-packages\\\\vtrace\\\\platforms\\\\windll\\\\amd64\\\\dbghelp.dll or *\\\\anaconda3\\\\lib\\\\site\\-packages\\\\vtrace\\\\platforms\\\\windll\\\\i386\\\\dbghelp.dll)))))
<li><a href="#">query: (dll.path:*\\\\dbutil_2_3.sys* or winlog.event_data.hashes:(*sha256\\=0296e2ce999e67c76352613a718e11516fe1b0efc3ffdb8918fc999dd76a73a5* or *sha256\\=ddbf5ecca5c8086afde1fb4f551e9e6400e94f4428fe7fb5559da5cffa654cc1* or *sha1\\=c948ae14761095e4d76b55d9de86412258be7afd* or *sha1\\=10b30bdee43b3a2ec4aa63375577ade650269d25* or *md5\\=c996d7971c49252c582171d9380360f2* or *md5\\=d2fd132ab7bbc6bbb87a84f026fa0244*) or sha256:(\"0296e2ce999e67c76352613a718e11516fe1b0efc3ffdb8918fc999dd76a73a5\" or \"ddbf5ecca5c8086afde1fb4f551e9e6400e94f4428fe7fb5559da5cffa654cc1\") or sha1:(\"c948ae14761095e4d76b55d9de86412258be7afd\" or \"10b30bdee43b3a2ec4aa63375577ade650269d25\") or md5:(\"c996d7971c49252c582171d9380360f2\" or \"d2fd132ab7bbc6bbb87a84f026fa0244\"))
<li><a href="#">query: (dll.path:*\\\\vss_ps.dll and (not ((process.executable.text:(*\\\\svchost.exe or *\\\\msiexec.exe or *\\\\vssvc.exe or *\\\\srtasks.exe or *\\\\tiworker.exe or *\\\\dllhost.exe or *\\\\searchindexer.exe or *\\\\dismhost.exe or *\\\\taskhostw.exe or *\\\\clussvc.exe or *\\\\thor64.exe or *\\\\thor.exe or *\\\\rundll32.exe or *\\\\inetsrv\\\\iissetup.exe or *\\\\inetsrv\\\\appcmd.exe or *\\\\wmiprvse.exe) and process.executable.text:c\\:\\\\windows\\\\*) or (process.executable.text:(c\\:\\\\program\\ files\\\\* or c\\:\\\\program\\ files\\ \\(x86\\)\\\\*)) or (process.command_line.text:c\\:\\\\$winreagent\\\\scratch\\\\* and process.command_line.text:*\\\\dismhost.exe\\ \\{*))))
<li><a href="#">query: (dll.path:*microsoftaccounttokenprovider.dll and (not (process.executable.text:(*\\\\backgroundtaskhost.exe or *\\\\devenv.exe or *\\\\iexplore.exe or *\\\\microsoftedge.exe or *\\\\microsoft\\\\edge\\\\application\\\\msedge.exe or *\\\\appdata\\\\local\\\\microsoft\\\\onedrive\\\\onedrive.exe or *\\\\msedgewebview2.exe or *\\\\onedrive.exe) or process.executable.text:c\\:\\\\program\\ files\\ \\(x86\\)\\\\microsoft\\\\edgewebview\\\\application\\\\* or not _exists_:process.executable.text)))
<li><a href="#">query: (dns.question.name:(*.getgo.com or *.logmein.com or *.ammyy.com or *.netsupportsoftware.com or *remoteutilities.com or *.net.anydesk.com or *api.playanext.com or *.relay.splashtop.com or *.api.splashtop.com or *app.atera.com or *.agentreporting.atera.com or *.pubsub.atera.com or *logmeincdn.http.internapcdn.net or *logmein\\-gateway.com or *client.teamviewer.com or *integratedchat.teamviewer.com or *static.remotepc.com or *.n\\-able.com or *comserver.corporate.beanywhere.com or *.swi\\-rc.com or *.swi\\-tc.com or *telemetry.servers.qetqo.com or *relay.screenconnect.com or *control.connectwise.com or *express.gotoassist.com or *authentication.logmeininc.com or *.services.vnc.com or *.tmate.io or *api.parsec.app or *parsecusercontent.com or *remotedesktop\\-pa.googleapis.com or *.logmein\\-gateway.com or *secure.logmeinrescue.com or *join.zoho.com or *assist.zoho.com or *.zohoassist.com or *downloads.zohocdn.com or *agent.jumpcloud.com or *kickstart.jumpcloud.com or *cdn.kaseya.net or *relay.kaseya.net or *license.bomgar.com or *.beyondtrustcloud.com) and (not (process.executable.text:(*\\\\google\\\\chrome\\\\application\\\\chrome.exe or *\\\\brave.exe or *\\\\chromium.exe or *\\\\firefox.exe or *\\\\msedge.exe or *\\\\opera.exe or *\\\\microsoftedge.exe or *\\\\iexplorer.exe or *\\\\vivaldi.exe or *\\\\ccleaner\\ browser\\\\application\\\\ccleanerbrowser.exe))))
<li><a href="#">query: (dns.question.name:(*.getgo.com or *.logmein.com or *.ammyy.com or *.netsupportsoftware.com or *remoteutilities.com) and (not (process.executable.text:(*\\\\google\\\\chrome\\\\application\\\\chrome.exe or *\\\\brave.exe or *\\\\chromium.exe or *\\\\firefox.exe or *\\\\msedge.exe or *\\\\opera.exe or *\\\\microsoftedge.exe or *\\\\iexplorer.exe or *\\\\vivaldi.exe or *\\\\ccleaner\\ browser\\\\application\\\\ccleanerbrowser.exe))))
<li><a href="#">query: (dns.question.name:(\"canireachthe.net\" or \"ipv4.icanhazip.com\" or \"ip.anysrc.net\" or \"edns.ip\\-api.com\" or \"wtfismyip.com\" or \"checkip.dyndns.org\" or \"api.2ip.ua\" or \"icanhazip.com\" or \"api.ipify.org\" or \"ip\\-api.com\" or \"checkip.amazonaws.com\" or \"ipecho.net\" or \"ipinfo.io\" or \"ipv4bot.whatismyipaddress.com\" or \"freegeoip.app\" or \"ifconfig.me\") and (not (process.executable.text:(*\\\\google\\\\chrome\\\\application\\\\chrome.exe or *\\\\iexplore.exe or *\\\\firefox.exe or *\\\\brave.exe or *\\\\opera.exe or *\\\\msedge.exe or *\\\\vivaldi.exe or *\\\\chromium.exe or *\\\\microsoftedge.exe or *\\\\iexplorer.exe or *\\\\ccleaner\\ browser\\\\application\\\\ccleanerbrowser.exe))))
<li><a href="#">query: (dns.question.name:(\"canireachthe.net\" or \"ipv4.icanhazip.com\" or \"ip.anysrc.net\" or \"edns.ip\\-api.com\" or \"wtfismyip.com\" or \"checkip.dyndns.org\" or \"api.2ip.ua\" or \"icanhazip.com\" or \"api.ipify.org\" or \"ip\\-api.com\" or \"checkip.amazonaws.com\" or \"ipecho.net\" or \"ipinfo.io\" or \"ipv4bot.whatismyipaddress.com\" or \"freegeoip.app\") and (not (process.executable:(*\\\\chrome.exe or *\\\\iexplore.exe or *\\\\firefox.exe or *\\\\brave.exe or *\\\\opera.exe or *\\\\msedge.exe or *\\\\vivaldi.exe))))
<li><a href="#">query: (dns.question.name:(\"taf.teamviewer.com\" or \"udp.ping.teamviewer.com\") and (not (process.executable:*teamviewer*)))
<li><a href="#">query: (dns.question.name:(aaa.stage.* or post.1*) or dns.question.name:*.stage.123456.*)
<li><a href="#">query: (dns.question.name:*servicebus.windows.net* and process.executable.text:*hybridconnectionmanager*)
<li><a href="#">query: (dns.question.name:*servicebus.windows.net* and process.executable:*hybridconnectionmanager*)
<li><a href="#">query: (dns.question.name:_ldap.* and (not ((process.executable.text:c\\:\\\\windows\\\\*) or (process.executable.text:(c\\:\\\\programdata\\\\microsoft\\\\windows\\ defender\\\\platform\\\\* or c\\:\\\\program\\ files\\\\windows\\ defender\\\\msmpeng.exe* or c\\:\\\\program\\ files\\ \\(x86\\)\\\\windows\\ defender\\\\msmpeng.exe*) and process.executable.text:*\\\\msmpeng.exe) or (process.executable.text:\"<unknown\\ process>\") or (process.executable.text:c\\:\\\\windowsazure\\\\guestagent*))))
<li><a href="#">query: (dns.question.type:\"txt\" and dns.answers.name:(*iex* or *invoke\\-expression* or *cmd.exe*))
<li><a href="#">query: (event.category:\"security\\ policy\" and host.scan.vuln_name:firewall\\ product\\ not\\ detected*)
<li><a href="#">query: (event.dataset:\"dce_rpc\" and ((dce_rpc.endpoint.text:\"jobadd\" and dce_rpc.operation.text:\"atsvc\") or (dce_rpc.endpoint.text:\"itaskschedulerservice\" and dce_rpc.operation.text:\"schrpcenabletask\") or (dce_rpc.endpoint.text:\"itaskschedulerservice\" and dce_rpc.operation.text:\"schrpcregistertask\") or (dce_rpc.endpoint.text:\"itaskschedulerservice\" and dce_rpc.operation.text:\"schrpcrun\") or (dce_rpc.endpoint.text:\"iwbemservices\" and dce_rpc.operation.text:\"execmethod\") or (dce_rpc.endpoint.text:\"iwbemservices\" and dce_rpc.operation.text:\"execmethodasync\") or (dce_rpc.endpoint.text:\"svcctl\" and dce_rpc.operation.text:\"createservicea\") or (dce_rpc.endpoint.text:\"svcctl\" and dce_rpc.operation.text:\"createservicew\") or (dce_rpc.endpoint.text:\"svcctl\" and dce_rpc.operation.text:\"startservicea\") or (dce_rpc.endpoint.text:\"svcctl\" and dce_rpc.operation.text:\"startservicew\")))
<li><a href="#">query: (event.dataset:\"dce_rpc\" and ((dce_rpc.endpoint.text:\"spoolss\" and dce_rpc.operation.text:\"rpcaddmonitor\") or (dce_rpc.endpoint.text:\"spoolss\" and dce_rpc.operation.text:\"rpcaddprintprocessor\") or (dce_rpc.endpoint.text:\"iremotewinspool\" and dce_rpc.operation.text:\"rpcasyncaddmonitor\") or (dce_rpc.endpoint.text:\"iremotewinspool\" and dce_rpc.operation.text:\"rpcasyncaddprintprocessor\") or (dce_rpc.endpoint.text:\"iseclogon\" and dce_rpc.operation.text:\"seclcreateprocesswithlogonw\") or (dce_rpc.endpoint.text:\"iseclogon\" and dce_rpc.operation.text:\"seclcreateprocesswithlogonexw\")))
<li><a href="#">query: (event.dataset:\"dce_rpc\" and dce_rpc.operation.text:(\"rpcasyncinstallprinterdriverfrompackage\" or \"rpcasyncaddprintprocessor\" or \"rpcaddprintprocessor\" or \"rpcaddprinterdriverex\" or \"rpcaddprinterdriver\" or \"rpcasyncaddprinterdriver\"))
<li><a href="#">query: (event.dataset:\"dce_rpc\" and dce_rpc.operation:(efs* or efs*))
<li><a href="#">query: (event.dataset:\"dns\" and ((not (dns.z.text:\"0\")) and dns.question.name:*.*) and (not ((dns.question.name:(*.arpa or *.local or *.ultradns.net or *.twtrdns.net or *.azuredns\\-prd.info or *.azure\\-dns.com or *.azuredns\\-ff.info or *.azuredns\\-ff.org or *.azuregov\\-dns.org) or dns.question.type.text:(\"ns\" or \"ns\" or \"mx\" or \"mx\") or dns.answers.name:*\\\\x00 or destination.port:(\"137\" or \"138\" or \"139\")))))
<li><a href="#">query: (event.dataset:\"dns\" and dns.question.name.text:(\"tor2web.org\" or \"tor2web.com\" or \"torlink.co\" or \"onion.to\" or \"onion.ink\" or \"onion.cab\" or \"onion.nu\" or \"onion.link\" or \"onion.it\" or \"onion.city\" or \"onion.direct\" or \"onion.top\" or \"onion.casa\" or \"onion.plus\" or \"onion.rip\" or \"onion.dog\" or \"tor2web.fi\" or \"tor2web.blutmagie.de\" or \"onion.sh\" or \"onion.lu\" or \"onion.pet\" or \"t2w.pw\" or \"tor2web.ae.org\" or \"tor2web.io\" or \"tor2web.xyz\" or \"onion.lt\" or \"s1.tor\\-gateways.de\" or \"s2.tor\\-gateways.de\" or \"s3.tor\\-gateways.de\" or \"s4.tor\\-gateways.de\" or \"s5.tor\\-gateways.de\" or \"hiddenservice.net\"))
<li><a href="#">query: (event.dataset:\"dns\" and dns.question.name:(*monerohash.com or *do\\-dear.com or *xmrminerpro.com or *secumine.net or *xmrpool.com or *minexmr.org or *hashanywhere.com or *xmrget.com or *mininglottery.eu or *minergate.com or *moriaxmr.com or *multipooler.com or *moneropools.com or *xmrpool.eu or *coolmining.club or *supportxmr.com or *minexmr.com or *hashvault.pro or *xmrpool.net or *crypto\\-pool.fr or *xmr.pt or *miner.rocks or *walpool.com or *herominers.com or *gntl.co.uk or *semipool.com or *coinfoundry.org or *cryptoknight.cc or *fairhash.org or *baikalmine.com or *tubepool.xyz or *fairpool.xyz or *asiapool.io or *coinpoolit.webhop.me or *nanopool.org or *moneropool.com or *miner.center or *prohash.net or *poolto.be or *cryptoescrow.eu or *monerominers.net or *cryptonotepool.org or *extrmepool.org or *webcoin.me or *kippo.eu or *hashinvest.ws or *monero.farm or *linux\\-repository\\-updates.com or *1gh.com or *dwarfpool.com or *hash\\-to\\-coins.com or *pool\\-proxy.com or *hashfor.cash or *fairpool.cloud or *litecoinpool.org or *mineshaft.ml or *abcxyz.stream or *moneropool.ru or *cryptonotepool.org.uk or *extremepool.org or *extremehash.com or *hashinvest.net or *unipool.pro or *crypto\\-pools.org or *monero.net or *backup\\-pool.com or *mooo.com or *freeyy.me or *cryptonight.net or *shscrypto.net) and (not ((dns.answers.name.text:(\"127.0.0.1\" or \"0.0.0.0\")) or (dns.rejected.text:\"true\"))))
<li><a href="#">query: (event.dataset:\"http\" and ((http.response.status_code.text:\"200\" and url.original.text:\"\\/wsman\" and http.request.method.text:\"post\") and (not (http.client_header_names:*authorization*))) and (not (http.response.body.bytes:\"0\")))
<li><a href="#">query: (event.dataset:\"http\" and (user_agent.original:*webdav* and http.request.method.text:\"put\") and (not (destination.ip:(\"192.168.0.0\\/16\" or \"172.16.0.0\\/12\" or \"10.0.0.0\\/8\"))))
<li><a href="#">query: (event.dataset:\"http\" and (user_agent.original:*webdav* or url.original:*webdav*) and (http.resp_mime_types:*dosexec* or url.original:*.exe))
<li><a href="#">query: (event.dataset:\"kerberos\" and (kerberos.request_type.text:\"tgs\" and kerberos.cipher.text:\"rc4\\-hmac\") and (not (kerberos.service:$*)))
<li><a href="#">query: (event.dataset:\"rdp\" and (not (source.ip:(192.168.* or 10.* or 172.16.* or 172.17.* or 172.18.* or 172.19.* or 172.20.* or 172.21.* or 172.22.* or 172.23.* or 172.24.* or 172.25.* or 172.26.* or 172.27.* or 172.28.* or 172.29.* or 172.30.* or 172.31.*))))
<li><a href="#">query: (event.dataset:\"smb_files\" and (file.path.text:*\\\\* and file.path.text:*\\\\ipc$* and file.name.text:(*\\-stdin or *\\-stdout or *\\-stderr)) and (not (file.name.text:psexesvc*)))
<li><a href="#">query: (event.dataset:\"smb_files\" and file.name.text:(\"\\\\mimidrv\" or \"\\\\lsass\" or \"\\\\windows\\\\minidump\\\\\" or \"\\\\hiberfil\" or \"\\\\sqldmpr\" or \"\\\\sam\" or \"\\\\ntds.dit\" or \"\\\\security\"))
<li><a href="#">query: (event.dataset:\"smb_files\" and file.name:(*.pst or *.ost or *.msg or *.nst or *.oab or *.edb or *.nsf or *.bak or *.dmp or *.kirbi or *\\\\groups.xml or *.rdp))
<li><a href="#">query: (event.dataset:\"smb_files\" and file.path:*\\\\* and file.path:*admin$* and file.name:*system32\\\\* and file.name:*.tmp)
<li><a href="#">query: (event.dataset:\"smb_files\" and file.path:*ipc$ and file.name.text:\"spoolss\")
<li><a href="#">query: (event.dataset:\"smb_files\" and file.path:\\\\\\*\\ipc$ and file.name.text:\"atsvc\")
<li><a href="#">query: (event.dataset:\"smb_files\" and file.path:\\\\\\\\\\*\\\\ipc$ and (not (((*samr*) or (*lsarpc*) or (*winreg*) or (*netlogon*) or (*srvsvc*) or (*protected_storage*) or (*wkssvc*) or (*browser*) or (*netdfs*) or (*svcctl*) or (*spoolss*) or (*ntsvcs*) or (*lsm_api_service*) or (*hydralspipe*) or (*termsrv_api_service*) or (*msftewds*)))))
<li><a href="#">query: (event.dataset:\"x509\" and x509.certificate.serial.text:\"8bb00ee\")
<li><a href="#">query: (event_type_id:\"532\" or event_type_id:\"553\" or event_type_id:\"551\")
<li><a href="#">query: (eventlog:\"edr\" and winlog.event_data.eventtype:\"wmiexecution\" and wmicommand:*win32_process\\\\\\:\\\\\\:create* and process.executable:(*\\\\winword.exe or *\\\\excel.exe or *\\\\powerpnt.exe))
<li><a href="#">query: (eventlog:\"rpcfw\" and winlog.event_id:\"3\" and interfaceuuid:(\"12345678\\-1234\\-abcd\\-ef00\\-0123456789ab\" or \"76f03f96\\-cdfd\\-44fc\\-a22c\\-64950a001209\" or \"0b6edbfa\\-4a24\\-4fc6\\-8a23\\-942b1eca65d1\" or \"ae33069b\\-a2a8\\-46ee\\-a235\\-ddfd339be281\"))
<li><a href="#">query: (eventlog:\"rpcfw\" and winlog.event_id:\"3\" and interfaceuuid:(\"4d9f4ab8\\-7d1c\\-11cf\\-861e\\-0020af6e7c57\" or \"99fcfec4\\-5260\\-101b\\-bbcb\\-00aa0021347a\" or \"000001a0\\-0000\\-0000\\-c000\\-000000000046\" or \"00000131\\-0000\\-0000\\-c000\\-000000000046\" or \"00000143\\-0000\\-0000\\-c000\\-000000000046\" or \"00000000\\-0000\\-0000\\-c000\\-000000000046\"))
<li><a href="#">query: (eventlog:\"rpcfw\" and winlog.event_id:\"3\" and interfaceuuid:(\"82273fdc\\-e32a\\-18c3\\-3f78\\-827929dc23ea\" or \"f6beaff7\\-1e19\\-4fbb\\-9f8f\\-b89e2018337c\"))
<li><a href="#">query: (eventlog:\"rpcfw\" and winlog.event_id:\"3\" and interfaceuuid:(\"df1941c5\\-fe89\\-4e79\\-bf10\\-463657acf44d\" or \"c681d488\\-d850\\-11d0\\-8c52\\-00c04fd90f7e\"))
<li><a href="#">query: (eventlog:\"rpcfw\" and winlog.event_id:\"3\" and interfaceuuid:\"1ff70682\\-0a51\\-30e8\\-076d\\-740be8cee98b\" and opnum:(\"0\" or \"1\"))
<li><a href="#">query: (eventlog:\"rpcfw\" and winlog.event_id:\"3\" and interfaceuuid:\"338cd001\\-2244\\-31f1\\-aaaa\\-900038001003\" and opnum:(\"6\" or \"7\" or \"8\" or \"13\" or \"18\" or \"19\" or \"21\" or \"22\" or \"23\" or \"35\"))
<li><a href="#">query: (eventlog:\"rpcfw\" and winlog.event_id:\"3\" and interfaceuuid:\"367abb81\\-9844\\-35f1\\-ad32\\-98f038001003\")
<li><a href="#">query: (eventlog:\"rpcfw\" and winlog.event_id:\"3\" and interfaceuuid:\"378e52b0\\-c0a9\\-11cf\\-822d\\-00aa0051e40f\" and opnum:(\"0\" or \"1\"))
<li><a href="#">query: (eventlog:\"rpcfw\" and winlog.event_id:\"3\" and interfaceuuid:\"4b324fc8\\-1670\\-01d3\\-1278\\-5a47bf6ee188\" and opnum:\"12\")
<li><a href="#">query: (eventlog:\"rpcfw\" and winlog.event_id:\"3\" and interfaceuuid:\"4b324fc8\\-1670\\-01d3\\-1278\\-5a47bf6ee188\")
<li><a href="#">query: (eventlog:\"rpcfw\" and winlog.event_id:\"3\" and interfaceuuid:\"6bffd098\\-a112\\-3610\\-9833\\-46c3f87e345a\" and opnum:\"2\")
<li><a href="#">query: (eventlog:\"rpcfw\" and winlog.event_id:\"3\" and interfaceuuid:\"86d35949\\-83c9\\-4044\\-b424\\-db363231fd0c\" and opnum:(\"1\" or \"3\" or \"4\" or \"10\" or \"11\" or \"12\" or \"13\" or \"14\" or \"15\"))
<li><a href="#">query: (eventservice:\"admin.googleapis.com\" and eventname:(\"delete_role\" or \"rename_role\" or \"update_role\"))
<li><a href="#">query: (eventservice:\"admin.googleapis.com\" and eventname:(\"enforce_strong_authentication\" or \"allow_strong_authentication\") and new_value:\"false\")
<li><a href="#">query: (eventservice:\"admin.googleapis.com\" and eventname:(\"grant_delegated_admin_privileges\" or \"grant_admin_privilege\"))
<li><a href="#">query: (eventservice:\"admin.googleapis.com\" and eventname:(\"remove_application\" or \"remove_application_from_whitelist\"))
<li><a href="#">query: (eventservice:\"admin.googleapis.com\" and eventname:\"authorize_api_client_access\")
<li><a href="#">query: (eventservice:\"admin.googleapis.com\" and eventname:\"remove_privilege\")
<li><a href="#">query: (eventsource:\"azureactivedirectory\" and eventname:\"disable\\ strong\\ authentication.\" and status:\"success\")
<li><a href="#">query: (eventsource:\"cloudtrail.amazonaws.com\" and eventname:(\"stoplogging\" or \"updatetrail\" or \"deletetrail\"))
<li><a href="#">query: (eventsource:\"config.amazonaws.com\" and eventname:(\"deletedeliverychannel\" or \"stopconfigurationrecorder\"))
<li><a href="#">query: (eventsource:\"ec2.amazonaws.com\" and eventname:(\"describecarriergateways\" or \"describevpcendpointconnectionnotifications\" or \"describetransitgatewaymulticastdomains\" or \"describeclientvpnroutes\" or \"describedhcpoptions\" or \"gettransitgatewayroutetableassociations\"))
<li><a href="#">query: (eventsource:\"ec2.amazonaws.com\" and eventname:(\"getpassworddata\" or \"getebsencryptionbydefault\" or \"getebsdefaultkmskeyid\" or \"getbucketreplication\" or \"describevolumes\" or \"describevolumesmodifications\" or \"describesnapshotattribute\" or \"describesnapshottierstatus\" or \"describeimages\"))
<li><a href="#">query: (eventsource:\"ec2.amazonaws.com\" and eventname:\"disableebsencryptionbydefault\")
<li><a href="#">query: (eventsource:\"ec2.amazonaws.com\" and eventname:\"modifysnapshotattribute\")
<li><a href="#">query: (eventsource:\"ec2.amazonaws.com\" and requestparameters.attribute:\"userdata\" and eventname:\"describeinstanceattribute\")
<li><a href="#">query: (eventsource:\"ec2.amazonaws.com\" and requestparameters.attribute:\"userdata\" and eventname:\"modifyinstanceattribute\")
<li><a href="#">query: (eventsource:\"ecs.amazonaws.com\" and eventname:(\"describetaskdefinition\" or \"registertaskdefinition\" or \"runtask\") and requestparameters.containerdefinitions.command:*169.254* and requestparameters.containerdefinitions.command:*$aws_container_credentials*)
<li><a href="#">query: (eventsource:\"eks.amazonaws.com\" and eventname:(\"createcluster\" or \"deletecluster\"))
<li><a href="#">query: (eventsource:\"elasticache.amazonaws.com\" and eventname:(\"deletecachesecuritygroup\" or \"authorizecachesecuritygroupingress\" or \"revokecachesecuritygroupingress\" or \"authorizecachesecuritygroupegress\" or \"revokecachesecuritygroupegress\"))
<li><a href="#">query: (eventsource:\"elasticache.amazonaws.com\" and eventname:\"createcachesecuritygroup\")
<li><a href="#">query: (eventsource:\"elasticfilesystem.amazonaws.com\" and eventname:\"deletefilesystem\")
<li><a href="#">query: (eventsource:\"elasticfilesystem.amazonaws.com\" and eventname:\"deletemounttarget\")
<li><a href="#">query: (eventsource:\"exchange\" and eventname:\"add\\-federateddomain\" and status:\"success\")
<li><a href="#">query: (eventsource:\"glue.amazonaws.com\" and eventname:(\"createdevendpoint\" or \"deletedevendpoint\" or \"updatedevendpoint\"))
<li><a href="#">query: (eventsource:\"guardduty.amazonaws.com\" and eventname:\"createipset\")
<li><a href="#">query: (eventsource:\"lambda.amazonaws.com\" and eventname:updatefunctionconfiguration*)
<li><a href="#">query: (eventsource:\"rds.amazonaws.com\" and responseelements.pendingmodifiedvalues.masteruserpassword:* and eventname:\"modifydbinstance\")
<li><a href="#">query: (eventsource:\"rds.amazonaws.com\" and responseelements.publiclyaccessible:\"true\" and eventname:\"restoredbinstancefromdbsnapshot\")
<li><a href="#">query: (eventsource:\"route53.amazonaws.com\" and eventname:\"disabledomaintransferlock\")
<li><a href="#">query: (eventsource:\"route53.amazonaws.com\" and eventname:\"transferdomaintoanotherawsaccount\")
<li><a href="#">query: (eventsource:\"s3.amazonaws.com\" and eventname:(\"listbuckets\" or \"getbucketcors\" or \"getbucketinventoryconfiguration\" or \"getbucketpublicaccessblock\" or \"getbucketmetricsconfiguration\" or \"getbucketpolicy\" or \"getbuckettagging\"))
<li><a href="#">query: (eventsource:\"s3.amazonaws.com\" and eventname:(\"putbucketlogging\" or \"putbucketwebsite\" or \"putencryptionconfiguration\" or \"putlifecycleconfiguration\" or \"putreplicationconfiguration\" or \"replicateobject\" or \"restoreobject\"))
<li><a href="#">query: (eventsource:\"securitycompliancecenter\" and eventname:\"activity\\ from\\ anonymous\\ ip\\ addresses\" and status:\"success\")
<li><a href="#">query: (eventsource:\"securitycompliancecenter\" and eventname:\"activity\\ from\\ infrequent\\ country\" and status:\"success\")
<li><a href="#">query: (eventsource:\"securitycompliancecenter\" and eventname:\"activity\\ from\\ suspicious\\ ip\\ addresses\" and status:\"success\")
<li><a href="#">query: (eventsource:\"securitycompliancecenter\" and eventname:\"activity\\ performed\\ by\\ terminated\\ user\" and status:\"success\")
<li><a href="#">query: (eventsource:\"securitycompliancecenter\" and eventname:\"data\\ exfiltration\\ to\\ unsanctioned\\ apps\" and status:\"success\")
<li><a href="#">query: (eventsource:\"securitycompliancecenter\" and eventname:\"impossible\\ travel\\ activity\" and status:\"success\")
<li><a href="#">query: (eventsource:\"securitycompliancecenter\" and eventname:\"log\\ on\\ from\\ a\\ risky\\ ip\\ address\" and status:\"success\")
<li><a href="#">query: (eventsource:\"securitycompliancecenter\" and eventname:\"potential\\ ransomware\\ activity\" and status:\"success\")
<li><a href="#">query: (eventsource:\"securitycompliancecenter\" and eventname:\"suspicious\\ inbox\\ forwarding\" and status:\"success\")
<li><a href="#">query: (eventsource:\"securitycompliancecenter\" and eventname:\"suspicious\\ oauth\\ app\\ file\\ download\\ activities\" and status:\"success\")
<li><a href="#">query: (eventsource:\"securitycompliancecenter\" and eventname:\"unusual\\ volume\\ of\\ file\\ deletion\" and status:\"success\")
<li><a href="#">query: (eventsource:\"securitycompliancecenter\" and eventname:\"user\\ restricted\\ from\\ sending\\ email\" and status:\"success\")
<li><a href="#">query: (eventsource:\"securityhub.amazonaws.com\" and eventname:(\"batchupdatefindings\" or \"deleteinsight\" or \"updatefindings\" or \"updateinsight\"))
<li><a href="#">query: (eventsource:\"ses.amazonaws.com\" and eventname:\"deleteidentity\")
<li><a href="#">query: (eventsource:\"ses.amazonaws.com\" and eventname:\"updateaccountsendingenabled\" and eventname:\"verifyemailidentity\")
<li><a href="#">query: (eventsource:\"sts.amazonaws.com\" and eventname:\"getsessiontoken\" and useridentity.type:\"iamuser\")
<li><a href="#">query: (file.name:(*\\\\pipe\\\\* or *\\\\pipe\\\\srvsvc*) and (not (file.name:*\\\\ctxshare*)))
<li><a href="#">query: (file.name:/\\\\\\\\mojo\\.5688\\.8052\\.(?:183894939787088877|35780273329370473)[0-9a-f]{2}/ or file.name:/\\\\\\\\wkssvc_?[0-9a-f]{2}/ or file.name:/\\\\\\\\ntsvcs[0-9a-f]{2}/ or file.name:/\\\\\\\\dsernamepipe[0-9a-f]{2}/ or file.name:/\\\\\\\\searchtextharvester[0-9a-f]{2}/ or file.name:/\\\\\\\\mypipe\\-(?:f|h)[0-9a-f]{2}/ or file.name:/\\\\\\\\windows\\.update\\.manager[0-9a-f]{2,3}/ or file.name:/\\\\\\\\ntsvcs_[0-9a-f]{2}/ or file.name:/\\\\\\\\scerpc_?[0-9a-f]{2}/ or file.name:/\\\\\\\\pgmessagepipe[0-9a-f]{2}/ or file.name:/\\\\\\\\msftewds[0-9a-f]{2}/ or file.name:/\\\\\\\\f4c3[0-9a-f]{2}/ or file.name:/\\\\\\\\fullduplex_[0-9a-f]{2}/ or file.name:/\\\\\\\\msrpc_[0-9a-f]{4}/ or file.name:/\\\\\\\\win\\\\\\\\msrpc_[0-9a-f]{2}/ or file.name:/\\\\\\\\f53f[0-9a-f]{2}/ or file.name:/\\\\\\\\rpc_[0-9a-f]{2}/ or file.name:/\\\\\\\\spoolss_[0-9a-f]{2}/ or file.name:/\\\\\\\\winsock2\\\\\\\\catalogchangelistener-[0-9a-f]{3}-0,/)
<li><a href="#">query: (file.name:\"\\\\microsoft##wid\\\\tsql\\\\query\" and (not (process.executable:(*\\\\microsoft.identityserver.servicehost.exe or *\\\\microsoft.identity.health.adfs.pshsurrogate.exe or *\\\\azureadconnect.exe or *\\\\microsoft.tri.sensor.exe or *\\\\wsmprovhost.exe or *\\\\mmc.exe or *\\\\sqlservr.exe or *\\\\tssdis.exe))))
<li><a href="#">query: (file.name:\\\\pshost* and (not ((process.executable.text:(*\\\\powershell.exe or *\\\\powershell_ise.exe or *\\\\windows\\\\system32\\\\sdiagnhost.exe or *\\\\windows\\\\system32\\\\wsmprovhost.exe or *\\\\windows\\\\system32\\\\dsac.exe or *\\\\windows\\\\system32\\\\wbem\\\\wmiprvse.exe or *\\\\forefrontactivedirectoryconnector.exe or *c\\:\\\\windows\\\\system32\\\\inetsrv\\\\w3wp.exe)) or (not _exists_:process.executable.text) or (process.executable.text:*\\:\\\\program\\ files* and process.executable.text:*\\\\microsoft\\ sql\\ server\\\\* and process.executable.text:*\\\\tools\\\\binn\\\\sqlps.exe) or (process.executable.text:(c\\:\\\\program\\ files\\\\citrix\\\\* or c\\:\\\\program\\ files\\\\microsoft\\\\exchange\\ server\\\\*)) or (process.executable.text:(\"c\\:\\\\windows\\\\system32\\\\servermanager.exe\" or \"c\\:\\\\program\\ files\\\\powershell\\\\7\\\\pwsh.exe\")))))
<li><a href="#">query: (file.name:\\\\pshost* and (not ((process.executable:(*\\\\powershell.exe or *\\\\powershell_ise.exe or *\\\\windows\\\\system32\\\\sdiagnhost.exe or *\\\\windows\\\\system32\\\\wsmprovhost.exe or *\\\\windows\\\\system32\\\\dsac.exe or *\\\\windows\\\\system32\\\\wbem\\\\wmiprvse.exe or *\\\\forefrontactivedirectoryconnector.exe or *c\\:\\\\windows\\\\system32\\\\inetsrv\\\\w3wp.exe)) or (not _exists_:process.executable) or (process.executable:*\\:\\\\program\\ files* and process.executable:*\\\\microsoft\\ sql\\ server\\\\* and process.executable:*\\\\tools\\\\binn\\\\sqlps.exe) or (process.executable:(c\\:\\\\program\\ files\\\\citrix\\\\* or c\\:\\\\program\\ files\\\\microsoft\\\\exchange\\ server\\\\*)))))
<li><a href="#">query: (file.path.text:(*.aaa or *.zzz) and (not ((file.path.text:*\\\\wireshark\\\\radius\\\\dictionary.alcatel\\-lucent.aaa))))
<li><a href="#">query: (file.path.text:(*.bat.exe or *.sys.exe) or file.path.text:(\"c\\:\\\\$recycle.bin.exe\" or \"c\\:\\\\documents\\ and\\ settings.exe\" or \"c\\:\\\\msocache.exe\" or \"c\\:\\\\recovery.exe\" or \"c\\:\\\\perflogs.exe\"))
<li><a href="#">query: (file.path.text:(*\\\\atbroker.exe or *\\\\audiodg.exe or *\\\\backgroundtaskhost.exe or *\\\\bcdedit.exe or *\\\\bitsadmin.exe or *\\\\cmdl32.exe or *\\\\cmstp.exe or *\\\\conhost.exe or *\\\\csrss.exe or *\\\\dashost.exe or *\\\\dfrgui.exe or *\\\\dllhost.exe or *\\\\dwm.exe or *\\\\eventcreate.exe or *\\\\eventvwr.exe or *\\\\explorer.exe or *\\\\extrac32.exe or *\\\\fontdrvhost.exe or *\\\\ipconfig.exe or *\\\\iscsicli.exe or *\\\\iscsicpl.exe or *\\\\logman.exe or *\\\\logonui.exe or *\\\\lsaiso.exe or *\\\\lsass.exe or *\\\\lsm.exe or *\\\\msiexec.exe or *\\\\msinfo32.exe or *\\\\mstsc.exe or *\\\\nbtstat.exe or *\\\\odbcconf.exe or *\\\\powershell.exe or *\\\\pwsh.exe or *\\\\regini.exe or *\\\\regsvr32.exe or *\\\\rundll32.exe or *\\\\runtimebroker.exe or *\\\\schtasks.exe or *\\\\searchfilterhost.exe or *\\\\searchindexer.exe or *\\\\searchprotocolhost.exe or *\\\\securityhealthservice.exe or *\\\\securityhealthsystray.exe or *\\\\services.exe or *\\\\shellappruntime.exe or *\\\\sihost.exe or *\\\\smartscreen.exe or *\\\\smss.exe or *\\\\spoolsv.exe or *\\\\svchost.exe or *\\\\systemsettingsbroker.exe or *\\\\taskhost.exe or *\\\\taskhostw.exe or *\\\\taskmgr.exe or *\\\\tiworker.exe or *\\\\vssadmin.exe or *\\\\w32tm.exe or *\\\\werfault.exe or *\\\\werfaultsecure.exe or *\\\\wermgr.exe or *\\\\wevtutil.exe or *\\\\wininit.exe or *\\\\winlogon.exe or *\\\\winrshost.exe or *\\\\winrtnetmuahostserver.exe or *\\\\wlanext.exe or *\\\\wlrmdr.exe or *\\\\wmiprvse.exe or *\\\\wslhost.exe or *\\\\wsreset.exe or *\\\\wudfhost.exe or *\\\\wwahost.exe) and (not ((file.path.text:(c\\:\\\\windows\\\\system32\\\\* or c\\:\\\\windows\\\\syswow64\\\\* or c\\:\\\\windows\\\\winsxs\\\\* or c\\:\\\\windows\\\\softwaredistribution\\\\* or \\\\systemroot\\\\system32\\\\*) and process.executable.text:(*\\\\windows\\\\system32\\\\dism.exe or *\\\\tiworker.exe)) or (file.path.text:c\\:\\\\$windows.\\~bt\\\\* and process.executable.text:\"c\\:\\\\$windows.\\~bt\\\\sources\\\\setuphost.exe\") or (file.path.text:*\\\\runtimebroker.exe and process.executable.text:\"c\\:\\\\windows\\\\system32\\\\wbengine.exe\") or (process.executable.text:*\\:\\\\windows\\\\system32\\\\svchost.exe and file.path.text:c\\:\\\\windows\\\\softwaredistribution\\\\download\\\\* and file.path.text:(*\\\\spoolsv.exe or *\\\\bcdedit.exe)) or (process.executable.text:\"c\\:\\\\windows\\\\system32\\\\wuauclt.exe\") or (file.path.text:\"c\\:\\\\windows\\\\explorer.exe\") or (process.executable.text:\"c\\:\\\\windows\\\\system32\\\\msiexec.exe\" and file.path.text:\"c\\:\\\\program\\ files\\\\powershell\\\\7\\\\pwsh.exe\"))))
<li><a href="#">query: (file.path.text:(*\\\\hive_sam_* or *\\\\sam\\-2021\\-* or *\\\\sam\\-2022\\-* or *\\\\sam\\-2023\\-* or *\\\\sam\\-haxx* or *\\\\sam.save*) or file.path.text:\"c\\:\\\\windows\\\\temp\\\\sam\")
<li><a href="#">query: (file.path.text:(*\\\\microsoft\\\\teams\\\\cookies* or *\\\\microsoft\\\\teams\\\\local\\ storage\\\\leveldb*) and (not (process.executable.text:*\\\\microsoft\\\\teams\\\\current\\\\teams.exe*)))
<li><a href="#">query: (file.path.text:(*\\\\windivert.sys* or *\\\\windivert64.sys* or *\\\\norddivert.sys* or *\\\\lingtiwfp.sys* or *\\\\eswfp.sys*) or winlog.event_data.hashes:(*imphash\\=0604bb7cb4bb851e2168d5c7d9399087* or *imphash\\=2e5f0e649d97f32b03c09e4686d0574f* or *imphash\\=52f8aa269f69f0edad9e8fcdaedce276* or *imphash\\=c0e5d314da39dbf65a2dbff409cc2c76* or *imphash\\=58623490691babe8330adc81cd04a663* or *imphash\\=8ee39b48656e4d6b8459d7ba7da7438b* or *imphash\\=45ee545ae77e8d43fc70ede9efcd4c96* or *imphash\\=a1b2e245acd47e4a348e1a552a02859a* or *imphash\\=2a5f85fe4609461c6339637594fa9b0a* or *imphash\\=6b2c6f95233c2914d1d488ee27531acc* or *imphash\\=9f2fdd3f9ab922bbb0560a7df46f4342* or *imphash\\=d8a719865c448b1bd2ec241e46ac1c88* or *imphash\\=0ea54f8c9af4a2fe8367fa457f48ed38* or *imphash\\=9d519ae0a0864d6d6ae3f8b6c9c70af6* or *imphash\\=a74929edfc3289895e3f2885278947ae* or *imphash\\=a66b476c2d06c370f0a53b5537f2f11e* or *imphash\\=bdcd836a46bc2415773f6b5ea77a46e4* or *imphash\\=c28cd6ccd83179e79dac132a553693d9*) or imphash:(\"0604bb7cb4bb851e2168d5c7d9399087\" or \"2e5f0e649d97f32b03c09e4686d0574f\" or \"52f8aa269f69f0edad9e8fcdaedce276\" or \"c0e5d314da39dbf65a2dbff409cc2c76\" or \"58623490691babe8330adc81cd04a663\" or \"8ee39b48656e4d6b8459d7ba7da7438b\" or \"45ee545ae77e8d43fc70ede9efcd4c96\" or \"a1b2e245acd47e4a348e1a552a02859a\" or \"2a5f85fe4609461c6339637594fa9b0a\" or \"6b2c6f95233c2914d1d488ee27531acc\" or \"9f2fdd3f9ab922bbb0560a7df46f4342\" or \"d8a719865c448b1bd2ec241e46ac1c88\" or \"0ea54f8c9af4a2fe8367fa457f48ed38\" or \"9d519ae0a0864d6d6ae3f8b6c9c70af6\" or \"a74929edfc3289895e3f2885278947ae\" or \"a66b476c2d06c370f0a53b5537f2f11e\" or \"bdcd836a46bc2415773f6b5ea77a46e4\" or \"c28cd6ccd83179e79dac132a553693d9\"))
<li><a href="#">query: (file.path.text:(*\\\\winring0x64.sys or *\\\\winring0.sys or *\\\\winring0.dll or *\\\\winring0x64.dll) or winlog.event_data.hashes:*imphash\\=d41fa95d4642dc981f10de36f4dc8cd7* or imphash:\"d41fa95d4642dc981f10de36f4dc8cd7\")
<li><a href="#">query: (file.path.text:(*wsmpty.xsl or *wsmtxt.xsl) and (not (file.path.text:(c\\:\\\\windows\\\\system32\\\\* or c\\:\\\\windows\\\\syswow64\\\\*))))
<li><a href="#">query: (file.path.text:(c\\:\\\\windows\\ \\\\* or c\\:\\\\program\\ files\\ \\\\* or c\\:\\\\program\\ files\\ \\(x86\\)\\ \\\\*) and file.path.text:*.dll)
<li><a href="#">query: (file.path.text:(c\\:\\\\windows\\\\system32\\\\logonui.exe.local* or c\\:\\\\windows\\\\system32\\\\werfault.exe.local* or c\\:\\\\windows\\\\system32\\\\consent.exe.local* or c\\:\\\\windows\\\\system32\\\\narrator.exe.local* or c\\:\\\\windows\\\\system32\\\\wermgr.exe.local*) and file.path.text:*\\\\comctl32.dll)
<li><a href="#">query: (file.path.text:*.evtx and (not (((file.path.text:c\\:\\\\windows\\\\system32\\\\winevt\\\\logs\\\\*)) or ((file.path.text:c\\:\\\\programdata\\\\microsoft\\\\windows\\\\containers\\\\baseimages\\\\* and file.path.text:*\\\\windows\\\\system32\\\\winevt\\\\logs\\\\)) or ((process.executable.text:(\"c:\\windows\\explorer.exe\" or \"c:\\windows\\system32\\dllhost.exe\"))))))
<li><a href="#">query: (file.path.text:*.iso and ((file.path.text:*\\\\appdata\\\\local\\\\temp\\\\* and file.path.text:*.zip\\\\*) or file.path.text:*\\\\appdata\\\\local\\\\microsoft\\\\windows\\\\inetcache\\\\content.outlook\\\\*))
<li><a href="#">query: (file.path.text:*.scr and (not ((process.executable.text:(*\\\\kindle.exe or *\\\\bin\\\\ccsvchst.exe)) or (process.executable.text:*\\\\tiworker.exe and file.path.text:*\\\\uwfservicingscr.scr))))
<li><a href="#">query: (file.path.text:*.scr and (not (file.path.text:(c\\:\\\\windows\\\\system32\\\\* or c\\:\\\\windows\\\\system32\\\\* or c\\:\\\\windows\\\\syswow64\\\\* or c\\:\\\\windows\\\\syswow64\\\\* or c\\:\\\\windows\\\\winsxs\\\\* or c\\:\\\\windows\\\\winsxs\\\\* or c\\:\\\\$windows.\\~bt\\\\newos\\\\*))))
<li><a href="#">query: (file.path.text:*\\:\\\\users\\\\* and file.path.text:*\\\\.config\\\\rclone\\\\*)
<li><a href="#">query: (file.path.text:*\\\\desktop.ini and (not ((process.executable.text:(c\\:\\\\windows\\\\* or c\\:\\\\program\\ files\\\\* or c\\:\\\\program\\ files\\ \\(x86\\)\\\\*)) or (process.executable.text:*\\\\appdata\\\\local\\\\jetbrains\\\\toolbox\\\\bin\\\\7z.exe and file.path.text:*\\\\jetbrains\\\\apps\\\\*) or (file.path.text:c\\:\\\\$windows.\\~bt\\\\newos\\\\*))))
<li><a href="#">query: (file.path.text:*\\\\hw.sys or winlog.event_data.hashes:(*sha256\\=4880f40f2e557cff38100620b9aa1a3a753cb693af16cd3d95841583edcb57a8* or *sha256\\=55963284bbd5a3297f39f12f0d8a01ed99fe59d008561e3537bcd4db4b4268fa* or *sha256\\=6a4875ae86131a594019dec4abd46ac6ba47e57a88287b814d07d929858fe3e5* or *sha1\\=74e4e3006b644392f5fcea4a9bae1d9d84714b57* or *sha1\\=18f34a0005e82a9a1556ba40b997b0eae554d5fd* or *sha1\\=4e56e0b1d12664c05615c69697a2f5c5d893058a* or *md5\\=3247014ba35d406475311a2eab0c4657* or *md5\\=376b1e8957227a3639ec1482900d9b97* or *md5\\=45c2d133d41d2732f3653ed615a745c8*) or sha256:(\"4880f40f2e557cff38100620b9aa1a3a753cb693af16cd3d95841583edcb57a8\" or \"55963284bbd5a3297f39f12f0d8a01ed99fe59d008561e3537bcd4db4b4268fa\" or \"6a4875ae86131a594019dec4abd46ac6ba47e57a88287b814d07d929858fe3e5\") or sha1:(\"74e4e3006b644392f5fcea4a9bae1d9d84714b57\" or \"18f34a0005e82a9a1556ba40b997b0eae554d5fd\" or \"4e56e0b1d12664c05615c69697a2f5c5d893058a\") or md5:(\"3247014ba35d406475311a2eab0c4657\" or \"376b1e8957227a3639ec1482900d9b97\" or \"45c2d133d41d2732f3653ed615a745c8\"))
<li><a href="#">query: (file.path.text:*\\\\microsoft\\\\windows\\\\start\\ menu\\\\programs\\\\startup* and (not (process.executable.text:\"c\\:\\\\windows\\\\system32\\\\wuauclt.exe\" or file.path.text:c\\:\\\\$windows.\\~bt\\\\newos\\\\*)))
<li><a href="#">query: (file.path.text:*\\\\microsoft\\\\windows\\\\start\\ menu\\\\programs\\\\startup* and file.path.text:*.lnk.\\{0afaced1\\-e828\\-11d1\\-9187\\-b532f1e9575d\\}* and process.executable.text:*\\\\explorer.exe)
<li><a href="#">query: (file.path.text:*\\\\ntds.dit and ((process.parent.executable.text:(*\\\\powershell.exe or *\\\\pwsh.exe or *\\\\wscript.exe or *\\\\cscript.exe or *\\\\w3wp.exe or *\\\\php\\-cgi.exe or *\\\\nginx.exe or *\\\\httpd.exe)) or (process.parent.executable.text:(*\\\\apache* or *\\\\tomcat* or *\\\\appdata\\\\* or *\\\\temp\\\\* or *\\\\public\\\\* or *\\\\perflogs\\\\*)) or (process.executable.text:(*\\\\appdata\\\\* or *\\\\temp\\\\* or *\\\\public\\\\* or *\\\\perflogs\\\\*))))
<li><a href="#">query: (file.path.text:*\\\\windows\\\\start\\ menu\\\\programs\\\\startup\\\\* and file.path.text:(*.vbs or *.vbe or *.bat or *.ps1 or *.hta or *.dll or *.jar or *.msi or *.scr or *.cmd))
<li><a href="#">query: (file.path.text:*iphlpapi.dll* and file.path.text:*\\\\appdata\\\\local\\\\microsoft*)
<li><a href="#">query: (file.path.text:*lsass* and file.path.text:*dmp)
<li><a href="#">query: (file.path.text:\\\\logging\\\\cmdletinfra\\\\localpowershell\\\\cmdlet\\\\* and file.path.text:*_cmdlet_*)
<li><a href="#">query: (file.path.text:c\\:\\\\inetpub\\\\logs\\\\logfiles\\\\* and file.path.text:*.log)
<li><a href="#">query: (file.path.text:c\\:\\\\users\\\\* and file.path.text:(*\\\\appdata\\\\local\\\\temp\\\\system32\\\\winsat.exe or *\\\\appdata\\\\local\\\\temp\\\\system32\\\\winmm.dll))
<li><a href="#">query: (file.path.text:c\\:\\\\users\\\\* and file.path.text:*\\\\appdata\\\\local\\\\temp\\\\api\\-ms\\-win\\-core\\-kernel32\\-legacy\\-l1.dll)
<li><a href="#">query: (file.path.text:c\\:\\\\users\\\\* and file.path.text:*\\\\appdata\\\\local\\\\temp\\\\pe386.dll)
<li><a href="#">query: (file.path.text:c\\:\\\\users\\\\* and file.path.text:*\\\\appdata\\\\local\\\\temp\\\\pkgmgr.exe)
<li><a href="#">query: (file.path.text:c\\:\\\\windows\\\\system32\\\\consent.exe.@* and file.path.text:*\\\\comctl32.dll)
<li><a href="#">query: (file.path.text:c\\:\\\\windows\\\\system32\\\\spool\\\\drivers\\\\color\\\\* and file.path.text:(*.dll or *.exe or *.sys))
<li><a href="#">query: (file.path:(*.docm or *.dotm or *.xlsm or *.xltm or *.potm or *.pptm or *.pptx) and (process.executable:(*\\\\cmd.exe or *\\\\powershell.exe or *\\\\pwsh.exe) or process.parent.executable:(*\\\\cmd.exe or *\\\\powershell.exe or *\\\\pwsh.exe)))
<li><a href="#">query: (file.path:(*.docm or *.dotm or *.xlsm or *.xltm or *.potm or *.pptm or *.pptx) and (process.executable:(*\\\\cmd.exe or *\\\\powershell.exe) or process.parent.executable:(*\\\\cmd.exe or *\\\\powershell.exe)))
<li><a href="#">query: (file.path:(*.iso.lnk or *.img.lnk or *.vhd.lnk or *.vhdx.lnk) and file.path:*\\\\microsoft\\\\windows\\\\recent\\\\*)
<li><a href="#">query: (file.path:(*\\\\appdata\\\\local\\\\google\\\\chrome\\\\userdata\\\\default\\\\network\\\\cookies or *\\\\appdata\\\\local\\\\chrome\\\\user\\ data\\\\default\\\\login\\ data or *\\\\appdata\\\\local\\\\google\\\\chrome\\\\userdata\\\\localstate or *\\\\appdata\\\\local\\\\microsoft\\\\windows\\\\webcache\\\\webcachev01.dat or *\\\\cookies.sqlite) and (not ((process.executable:(*\\\\firefox.exe or *\\\\chrome.exe)) or (process.executable:(c\\:\\\\program\\ files\\\\* or c\\:\\\\program\\ files\\ \\(x86\\)\\\\*)) or (process.executable:(*\\\\msmpeng.exe or *\\\\mpcopyaccelerator.exe)) or (process.parent.executable:\"c\\:\\\\windows\\\\system32\\\\services.exe\" and file.path:*\\\\appdata\\\\local\\\\microsoft\\\\windows\\\\webcache\\\\webcachev01.dat))))
<li><a href="#">query: (file.path:(*\\\\appdata\\\\roaming\\\\anydesk\\\\user.conf* or *\\\\appdata\\\\roaming\\\\anydesk\\\\system.conf*) and file.path:*.temp)
<li><a href="#">query: (file.path:(*\\\\hive_sam_* or *\\\\sam\\-2021\\-* or *\\\\sam\\-2022\\-* or *\\\\sam\\-haxx* or *\\\\sam.save*) or file.path:\"c\\:\\\\windows\\\\temp\\\\sam\")
<li><a href="#">query: (file.path:(*\\\\lsass.dmp or *\\\\lsass.zip or *\\\\lsass.rar or *\\\\temp\\\\dumpert.dmp or *\\\\andrew.dmp or *\\\\coredump.dmp) or file.path:(*\\\\lsass_2* or *\\\\lsassdump* or *\\\\lsassdmp*) or (file.path:*\\\\lsass* and file.path:*.dmp*) or (file.path:*sqldmpr* and file.path:*.mdmp) or (file.path:nanodump* and file.path:*.dmp))
<li><a href="#">query: (file.path:(*\\\\lsass.dmp or *\\\\lsass.zip or *\\\\lsass.rar or *\\\\temp\\\\dumpert.dmp) or file.path:(*\\\\lsass_2* or *\\\\lsassdump* or *\\\\lsassdmp*) or (file.path:*\\\\lsass* and file.path:*.dmp*))
<li><a href="#">query: (file.path:(*\\\\pwdump* or *\\\\kirbi* or *\\\\pwhashes* or *\\\\wce_ccache* or *\\\\wce_krbtkts* or *\\\\fgdump\\-log*) or file.path:(*\\\\test.pwd or *\\\\lsremora64.dll or *\\\\lsremora.dll or *\\\\fgexec.exe or *\\\\wceaux.dll or *\\\\sam.out or *\\\\security.out or *\\\\system.out or *\\\\ntds.out or *\\\\dumpext.dll or *\\\\dumpsvc.exe or *\\\\cachedump64.exe or *\\\\cachedump.exe or *\\\\pstgdump.exe or *\\\\servpw.exe or *\\\\servpw64.exe or *\\\\pwdump.exe or *\\\\procdump64.exe))
<li><a href="#">query: (file.path:(*\\\\svchost.exe or *\\\\rundll32.exe or *\\\\services.exe or *\\\\powershell.exe or *\\\\regsvr32.exe or *\\\\spoolsv.exe or *\\\\lsass.exe or *\\\\smss.exe or *\\\\csrss.exe or *\\\\conhost.exe or *\\\\wininit.exe or *\\\\lsm.exe or *\\\\winlogon.exe or *\\\\explorer.exe or *\\\\taskhost.exe or *\\\\taskmgr.exe or *\\\\taskmgr.exe or *\\\\sihost.exe or *\\\\runtimebroker.exe or *\\\\runtimebroker.exe or *\\\\smartscreen.exe or *\\\\dllhost.exe or *\\\\audiodg.exe or *\\\\wlanext.exe) and (not ((file.path:(c\\:\\\\windows\\\\system32\\\\* or c\\:\\\\windows\\\\system32\\\\* or c\\:\\\\windows\\\\syswow64\\\\* or c\\:\\\\windows\\\\syswow64\\\\* or c\\:\\\\windows\\\\winsxs\\\\* or c\\:\\\\windows\\\\winsxs\\\\* or \\\\systemroot\\\\system32\\\\*) and process.executable:(*\\\\windows\\\\system32\\\\dism.exe or *\\\\tiworker.exe)) or (file.path:c\\:\\\\$windows.\\~bt\\\\* and process.executable:\"c\\:\\\\$windows.\\~bt\\\\sources\\\\setuphost.exe\") or (file.path:*\\\\runtimebroker.exe and process.executable:\"c\\:\\\\windows\\\\system32\\\\wbengine.exe\"))))
<li><a href="#">query: (file.path:(*\\\\system.management.automation.dll or *\\\\system.management.automation.ni.dll) and (not ((process.executable:(*\\\\powershell.exe or *\\\\powershell_ise.exe or *\\\\windows\\\\system32\\\\sdiagnhost.exe or *\\\\mscorsvw.exe or *\\\\windows\\\\system32\\\\remotefxvgpudisablement.exe or *\\\\sqlps.exe or *\\\\wsmprovhost.exe or *\\\\winrshost.exe or *\\\\syncappvpublishingserver.exe or *\\\\runscripthelper.exe or *\\\\servermanager.exe or *\\\\microsoft\\ sql\\ server\\ management\\ studio\\ *\\\\common*\\\\ide\\\\ssms.exe or *\\\\ide\\\\devenv.exe or *\\\\servicehub.vsdetouredhost.exe or *\\\\servicehub.settingshost.exe or *\\\\servicehub.host.clr.x86.exe or *\\\\citrix\\\\configsync\\\\configsyncrun.exe) or process.executable:(c\\:\\\\program\\ files\\ \\(x86\\)\\\\microsoft\\ visual\\ studio\\\\* or c\\:\\\\program\\ files\\\\microsoft\\ visual\\ studio\\\\*)) or (process.executable:c\\:\\\\windows\\\\temp\\\\asgard2\\-agent\\\\* and process.executable:(*\\\\thor64.exe or *\\\\thor.exe)))))
<li><a href="#">query: (file.path:(*\\\\teamviewer\\\\remoteprinting\\\\tvprint.db or *\\\\teamviewer\\\\tvnetwork.log) or (file.path:*\\\\teamviewer* and file.path:*_logfile.log*))
<li><a href="#">query: (file.path:(*\\\\temp\\\\sam or *\\\\sam.sav or *\\\\intel\\\\sam or *\\\\perflogs\\\\sam or *\\\\programdata\\\\sam or *\\\\users\\\\public\\\\sam or *\\\\appdata\\\\local\\\\sam or *\\\\appdata\\\\roaming\\\\sam or *_shadowsteal.zip or *\\\\documents\\\\sam.export) or file.path:\"c\\:\\\\sam\" or file.path:(*\\\\hive_sam_* or *\\\\sam.save* or *\\\\sam.export* or *\\\\\\~reg_sam.save* or *\\\\sam_backup* or *\\\\sam.bck* or *\\\\sam.backup*))
<li><a href="#">query: (file.path:(*wsmpty.xsl or *wsmtxt.xsl) and (not (file.path:(c\\:\\\\windows\\\\system32\\\\* or c\\:\\\\windows\\\\syswow64\\\\*))))
<li><a href="#">query: (file.path:(\\/etc\\/cron.d\\/* or \\/etc\\/cron.daily\\/* or \\/etc\\/cron.hourly\\/* or \\/etc\\/cron.monthly\\/* or \\/etc\\/cron.weekly\\/* or \\/var\\/spool\\/cron\\/crontabs\\/*) or file.path:(*\\/etc\\/cron.allow* or *\\/etc\\/cron.deny* or *\\/etc\\/crontab*))
<li><a href="#">query: (file.path:*.pfx and (not ((file.path:*\\\\templates\\\\windows\\\\windows_temporarykey.pfx* and file.path:*\\\\cmake\\\\*))))
<li><a href="#">query: (file.path:*.scr and (not ((process.executable:(*\\\\kindle.exe or *\\\\bin\\\\ccsvchst.exe)))))
<li><a href="#">query: (file.path:*.sdb and file.path:*\\\\windows\\\\apppatch\\\\custom\\\\*)
<li><a href="#">query: (file.path:*\\/library\\/startupitems\\/* and file.path:*.plist)
<li><a href="#">query: (file.path:*\\/library\\/startupitems\\/* or file.path:*.plist)
<li><a href="#">query: (file.path:*\\:\\\\users\\\\* and file.path:*\\\\.config\\\\rclone\\\\*)
<li><a href="#">query: (file.path:*\\\\127.0.0* and file.path:*\\\\admin$\\\\*)
<li><a href="#">query: (file.path:*\\\\advapi32.dll and (not ((process.executable:(c\\:\\\\windows\\\\* or c\\:\\\\program\\ files\\ \\(x86\\)\\\\* or c\\:\\\\program\\ files\\\\*)) or (process.executable:c\\:\\\\programdata\\\\microsoft\\\\windows\\ defender\\\\platform\\\\* and process.executable:*\\\\mpcmdrun.exe) or (process.executable:c\\:\\\\users\\\\* and process.executable:*\\\\appdata\\\\local\\\\microsoft\\\\onedrive\\\\* and process.executable:*filecoauth.exe))))
<li><a href="#">query: (file.path:*\\\\appdata\\\\local\\\\microsoft\\\\clr* and file.path:*\\\\usagelogs\\\\* and file.path:(*mshta* or *cscript* or *wscript* or *regsvr32* or *wmic* or *rundll32* or *svchost*))
<li><a href="#">query: (file.path:*\\\\appdata\\\\local\\\\microsoft\\\\event\\ viewer\\\\recentviews* and (not (process.executable:(c\\:\\\\windows\\\\system32\\\\* or c\\:\\\\windows\\\\syswow64\\\\*))))
<li><a href="#">query: (file.path:*\\\\appdata\\\\local\\\\temp\\\\sam\\-* and file.path:*.dmp*)
<li><a href="#">query: (file.path:*\\\\desktop.ini and (not (process.executable:(c\\:\\\\windows\\\\* or c\\:\\\\program\\ files\\\\* or c\\:\\\\program\\ files\\ \\(x86\\)\\\\*))))
<li><a href="#">query: (file.path:*\\\\ntds.dit and process.executable:(*\\\\powershell.exe or *\\\\cmd.exe))
<li><a href="#">query: (file.path:*\\\\ntds.dit and process.executable:(*\\\\powershell.exe or *\\\\pwsh.exe or *\\\\cmd.exe or *\\\\wscript.exe or *\\\\cscript.exe or *\\\\mshta.exe or *\\\\wsl.exe))
<li><a href="#">query: (file.path:*\\\\policies\\\\\\{31b2f340\\-016d\\-11d2\\-945f\\-00c04fb984f9\\}\\\\* and file.path:(*.dll or *.exe))
<li><a href="#">query: (file.path:*\\\\profile.ps1* and (file.path:*\\\\my\\ documents\\\\powershell\\\\* or file.path:*c\\:\\\\windows\\\\system32\\\\windowspowershell\\\\v1.0\\\\*))
<li><a href="#">query: (file.path:*\\\\system.drawing.ni.dll and (not ((process.executable:(c\\:\\\\program\\ files\\\\* or c\\:\\\\program\\ files\\ \\(x86\\)\\\\* or c\\:\\\\windows\\\\system32\\\\* or c\\:\\\\windows\\\\microsoft.net\\\\* or c\\:\\\\windows\\\\immersivecontrolpanel\\\\*)) or (process.executable:(c\\:\\\\users\\\\*\\\\appdata\\\\local\\\\nhnotifsys\\\\nahimic\\\\nahimicnotifsys.exe or c\\:\\\\users\\\\*\\\\githubdesktop\\\\update.exe or \"c\\:\\\\windows\\\\system32\\\\nhnotifsys.exe\")))))
<li><a href="#">query: (file.path:*\\\\vss_ps.dll and (not (process.executable:(*\\\\svchost.exe or *\\\\msiexec.exe or *\\\\vssvc.exe or *\\\\srtasks.exe or *\\\\tiworker.exe or *\\\\dllhost.exe or *\\\\searchindexer.exe or *dismhost.exe or *taskhostw.exe or *\\\\clussvc.exe or *\\\\thor64.exe or *\\\\thor.exe or *\\\\rundll32.exe or *\\\\inetsrv\\\\iissetup.exe) and process.executable:*c\\:\\\\windows\\\\*)))
<li><a href="#">query: (file.path:*\\\\vss_ps.dll and (not (process.executable:(*\\\\svchost.exe or *\\\\msiexec.exe or *\\\\vssvc.exe or *\\\\srtasks.exe or *\\\\tiworker.exe or *\\\\dllhost.exe or *\\\\searchindexer.exe or *dismhost.exe or *taskhostw.exe or *\\\\clussvc.exe or *\\\\thor64.exe or *\\\\thor.exe) and process.executable:*c\\:\\\\windows\\\\*)))
<li><a href="#">query: (file.path:*\\\\windows\\\\system32\\\\tasks* and process.executable:(*\\\\appdata\\\\* or *c\\:\\\\perflogs* or *\\\\windows\\\\system32\\\\config\\\\systemprofile*))
<li><a href="#">query: (file.path:*lsass* and file.path:*dmp)
<li><a href="#">query: (file.path:*microsoftaccounttokenprovider.dll and (not (process.executable:(*\\\\backgroundtaskhost.exe or *\\\\devenv.exe or *\\\\iexplore.exe or *\\\\microsoftedge.exe or *\\\\microsoft\\\\edge\\\\application\\\\msedge.exe or *\\\\appdata\\\\local\\\\microsoft\\\\onedrive\\\\onedrive.exe or *\\\\msedgewebview2.exe or *\\\\onedrive.exe) or process.executable:c\\:\\\\program\\ files\\ \\(x86\\)\\\\microsoft\\\\edgewebview\\\\application\\\\*)))
<li><a href="#">query: (file.path:*windowspowershell\\\\modules\\\\webadministration\\\\webadministration.psm1 and (not (user.name:(*authori* or *autori*))))
<li><a href="#">query: (file.path:c\\:\\\\users\\\\* and file.path:(*\\\\appdata\\\\local\\\\temp\\\\system32\\\\winsat.exe or *\\\\appdata\\\\local\\\\temp\\\\system32\\\\winmm.dll))
<li><a href="#">query: (file.path:c\\:\\\\users\\\\* and file.path:*\\\\appdata\\\\local\\\\temp\\\\api\\-ms\\-win\\-core\\-kernel32\\-legacy\\-l1.dll)
<li><a href="#">query: (file.path:c\\:\\\\users\\\\* and file.path:*\\\\appdata\\\\local\\\\temp\\\\pe386.dll)
<li><a href="#">query: (file.path:c\\:\\\\users\\\\* and file.path:*\\\\appdata\\\\local\\\\temp\\\\pkgmgr.exe)
<li><a href="#">query: (file.path:c\\:\\\\windows\\\\system32\\\\consent.exe.@* and file.path:*\\\\comctl32.dll)
<li><a href="#">query: (filename:*c\\:\\\\windows\\\\system32\\\\spool\\\\drivers\\\\x64\\\\* and (not (*file\\ submitted\\ to\\ symantec*)))
<li><a href="#">query: (gcp.audit.method_name:admissionregistration.k8s.io.v* and gcp.audit.method_name:(*.mutatingwebhookconfigurations.* or *.validatingwebhookconfigurations.*) and gcp.audit.method_name:(*create or *patch or *replace))
<li><a href="#">query: (hash:*imphash\\=* and (not (hash:*imphash\\=00000000000000000000000000000000*)))
<li><a href="#">query: (hostname:\"consolehost\" and (not (process.command_line:(powershell.exe* or c\\:\\\\windows\\\\system32\\\\windowspowershell\\\\v1.0\\\\powershell.exe*))))
<li><a href="#">query: (hostname:\"consolehost\" and process.command_line:(*bxor* or *join* or *char*))
<li><a href="#">query: (hostname:\"serverremotehost\" and process.command_line:*wsmprovhost.exe*)
<li><a href="#">query: (http.request.method:\"get\" and (*\\=whoami* or *\\=net%20user* or *\\=cmd%20\\/c%20* or *\\=powershell%20* or *\\=tasklist%20* or *\\=wmic%20* or *\\=ssh%20* or *\\=python%20* or *\\=ipconfig* or *\\=wget%20* or *\\=curl%20* or *\\=certutil* or *\\=copy%20%5c%5c*))
<li><a href="#">query: (http.request.method:\"get\" and cs-uri-query:(*\\/ecp\\/* or *\\/owa\\/*) and cs-uri-query:*__viewstate\\=*)
<li><a href="#">query: (http.request.method:\"get\" and cs-uri-query:*\\/include\\/makecvs.php* and cs-uri-query:*?event\\=* and cs-uri-query:(*curl* or *wget* or *.py* or *.sh* or *chmod* or *_get*))
<li><a href="#">query: (http.request.method:\"get\" and cs-uri-query:*\\/remote_agent.php* and cs-uri-query:*action\\=polldata* and cs-uri-query:*poller_id\\=* and cs-uri-query:(*|\\ base64\\ \\-d\\ |\\ \\/bin\\/bash`* or *%7c%20base64%20\\-d%20%7c%20%2fbin%2fbash%60* or *`whoami* or *powershell* or *cmd* or *wget*))
<li><a href="#">query: (http.request.method:\"get\" and cs-uri-query:*com.bea.console.handles.jndibindinghandle* and cs-uri-query:*ldap\\:\\/\\/* and cs-uri-query:*adminserver*)
<li><a href="#">query: (http.request.method:\"get\" and url.original:*\\/include\\/makecvs.php* and url.original:*?event\\=* and url.original:(*curl* or *wget* or *.py* or *.sh* or *chmod* or *_get*))
<li><a href="#">query: (http.request.method:\"post\" and ((cs-uri-query:*\\/owa\\/auth\\/current\\/themes\\/resources\\/*) or ((cs-uri-query:*\\/owa\\/auth\\/current\\/* and cs-user-agent:(\"duckduckbot/1.0;+(+)\" or \"facebookexternalhit/1.1+(+)\" or \"mozilla/5.0+(compatible;+baiduspider/2.0;++)\" or \"mozilla/5.0+(compatible;+bingbot/2.0;++)\" or \"mozilla/5.0+(compatible;+googlebot/2.1;++\" or \"mozilla/5.0+(compatible;+konqueror/3.5;+linux)+khtml/3.5.5+(like+gecko)+(exabot-thumbnails)\" or \"mozilla/5.0+(compatible;+yahoo!+slurp;+)\" or \"mozilla/5.0+(compatible;+yandexbot/3.0;++)\" or \"mozilla/5.0+(x11;+linux+x86_64)+applewebkit/537.36+(khtml,+like+gecko)+chrome/51.0.2704.103+safari/537.36\"))) or ((cs-uri-query:*\\/ecp\\/* and cs-user-agent:(\"exchangeservicesclient/0.0.0.0\" or \"python-requests/2.19.1\" or \"python-requests/2.25.1\"))) or ((cs-uri-query:(*\\/aspnet_client\\/* or *\\/owa\\/*) and cs-user-agent:(\"antsword/v2.1\" or \"googlebot/2.1+(+)\" or \"mozilla/5.0+(compatible;+baiduspider/2.0;++)\"))) or (cs-uri-query:(*\\/owa\\/auth\\/current\\/* or *\\/ecp\\/default.flt* or *\\/ecp\\/main.css*)) or ((cs-uri-query:*\\/ecp\\/* and cs-uri-query:*.js*))))
<li><a href="#">query: (http.request.method:\"post\" and cs-uri-query:*\\/analytics\\/telemetry\\/ph\\/api\\/hyper\\/send?*)
<li><a href="#">query: (http.request.method:\"post\" and cs-uri-query:*\\/saas\\/jersey\\/manager\\/api\\/migrate\\/tenant*)
<li><a href="#">query: (http.request.method:\"post\" and cs-uri-query:*\\/sitecore\\/shell\\/clientbin\\/reporting\\/report.ashx* and http.response.status_code:\"200\")
<li><a href="#">query: (http.request.method:\"post\" and cs-uri-query:*\\/upload.action* and cs-uri-query:*filename\\=..\\/..\\/..\\/..\\/*)
<li><a href="#">query: (http.request.method:\"post\" and cs-uri-query:*logupload* and cs-uri-query:*log
<li><a href="#">query: (http.request.method:\"post\" and cs-uri-query:\"/ui/vropspluginui/rest/services/uploadova\")
<li><a href="#">query: (http.request.method:\"post\" and url.original:\"\\/ui\\/vropspluginui\\/rest\\/services\\/uploadova\")
<li><a href="#">query: (http.response.status_code:\"200\" and (((cs-uri-query:*\\/solr\\/* and cs-uri-query:*\\/debug\\/dump?* and cs-uri-query:*param\\=contentstream*)) or ((http.request.method:\"get\" and cs-uri-query:*\\/solr\\/* and cs-uri-query:*command\\=fetchindex* and cs-uri-query:*masterurl\\=*))))
<li><a href="#">query: (http.response.status_code:\"401\" and (((cs-uri-query:*\\/autodiscover.json* and cs-uri-query:(*\\/powershell* or *\\/mapi\\/nspi* or *\\/ews* or *x\\-rps\\-cat*))) or (cs-uri-query:(*autodiscover.json?@* or *autodiscover.json%3f@* or *%3f@foo.com* or *email\\=autodiscover\\/autodiscover.json* or *json?@foo.com*))))
<li><a href="#">query: (http.response.status_code:\"500\" and (((http.request.method:\"post\" and cs-uri-query:*\\/ecp\\/* and cs-uri-query:*\\/ruleseditor\\/inboxrules.svc\\/newobject*)) or ((cs-uri-query:*securitytoken\\=* and cs-uri-query:*\\/ecp\\/*))))
<li><a href="#">query: (integritylevel:(\"high\" or \"system\") and ((process.command_line.text:\\\"c\\:\\\\windows\\\\system32\\\\wusa.exe\\\"\\ \\ \\/quiet\\ c\\:\\\\users\\\\* and process.command_line.text:*\\\\appdata\\\\local\\\\temp\\\\update.msu) or (process.parent.command_line.text:\"\\\"c\\:\\\\windows\\\\system32\\\\dism.exe\\\"\\ \\/online\\ \\/quiet\\ \\/norestart\\ \\/add\\-package\\ \\/packagepath\\:\\\"c\\:\\\\windows\\\\system32\\\\pe386\\\"\\ \\/ignorecheck\" and process.command_line.text:*c\\:\\\\users\\\\* and process.command_line.text:*\\\\appdata\\\\local\\\\temp\\\\* and process.command_line.text:*\\\\dismhost.exe\\ \\{* and process.executable.text:*\\\\dismhost.exe)))
<li><a href="#">query: (integritylevel:(\"high\" or \"system\") and ((process.command_line:\\\"c\\:\\\\windows\\\\system32\\\\wusa.exe\\\"\\ \\ \\/quiet\\ c\\:\\\\users\\\\* and process.command_line:*\\\\appdata\\\\local\\\\temp\\\\update.msu) or (process.parent.command_line:\"\\\"c\\:\\\\windows\\\\system32\\\\dism.exe\\\"\\ \\/online\\ \\/quiet\\ \\/norestart\\ \\/add\\-package\\ \\/packagepath\\:\\\"c\\:\\\\windows\\\\system32\\\\pe386\\\"\\ \\/ignorecheck\" and process.command_line:*c\\:\\\\users\\\\* and process.command_line:*\\\\appdata\\\\local\\\\temp\\\\* and process.command_line:*\\\\dismhost.exe\\ \\{* and process.executable:*\\\\dismhost.exe)))
<li><a href="#">query: (integritylevel:(\"high\" or \"system\") and (process.executable.text:\"c\\:\\\\program\\ files\\\\windows\\ media\\ player\\\\osk.exe\" or (process.executable.text:\"c\\:\\\\windows\\\\system32\\\\cmd.exe\" and process.parent.command_line.text:\"\\\"c\\:\\\\windows\\\\system32\\\\mmc.exe\\\"\\ \\\"c\\:\\\\windows\\\\system32\\\\eventvwr.msc\\\"\\ \\/s\")))
<li><a href="#">query: (integritylevel:(\"high\" or \"system\") and (process.executable:\"c\\:\\\\program\\ files\\\\windows\\ media\\ player\\\\osk.exe\" or (process.executable:\"c\\:\\\\windows\\\\system32\\\\cmd.exe\" and process.parent.command_line:\"\\\"c\\:\\\\windows\\\\system32\\\\mmc.exe\\\"\\ \\\"c\\:\\\\windows\\\\system32\\\\eventvwr.msc\\\"\\ \\/s\")))
<li><a href="#">query: (integritylevel:(\"high\" or \"system\") and process.parent.executable.text:*\\\\appdata\\\\local\\\\temp\\\\pkgmgr.exe and process.command_line.text:\"\\\"c\\:\\\\windows\\\\system32\\\\msconfig.exe\\\"\\ \\-5\")
<li><a href="#">query: (integritylevel:(\"high\" or \"system\") and process.parent.executable.text:*\\\\appdata\\\\local\\\\temp\\\\system32\\\\winsat.exe and process.parent.command_line.text:*c\\:\\\\windows\\ \\\\system32\\\\winsat.exe*)
<li><a href="#">query: (integritylevel:(\"high\" or \"system\") and process.parent.executable.text:*\\\\ieinstal.exe and process.executable.text:*\\\\appdata\\\\local\\\\temp\\\\* and process.executable.text:*consent.exe)
<li><a href="#">query: (integritylevel:(\"high\" or \"system\") and process.parent.executable:*\\\\appdata\\\\local\\\\temp\\\\pkgmgr.exe and process.command_line:\"\\\"c\\:\\\\windows\\\\system32\\\\msconfig.exe\\\"\\ \\-5\")
<li><a href="#">query: (integritylevel:(\"high\" or \"system\") and process.parent.executable:*\\\\appdata\\\\local\\\\temp\\\\system32\\\\winsat.exe and process.parent.command_line:*c\\:\\\\windows\\ \\\\system32\\\\winsat.exe*)
<li><a href="#">query: (integritylevel:(\"high\" or \"system\") and process.parent.executable:*\\\\ieinstal.exe and process.executable:*\\\\appdata\\\\local\\\\temp\\\\* and process.executable:*consent.exe)
<li><a href="#">query: (integritylevel:\"medium\" and ((process.command_line:*reg* and process.command_line:*add*) or (process.command_line:*powershell* and process.command_line:(*set\\-itemproperty* or *\\ sp\\ * or *new\\-itemproperty*))) and (process.command_line:*controlset* and process.command_line:*services*) and process.command_line:(*imagepath* or *failurecommand* or *servicedll*))
<li><a href="#">query: (integritylevel:\"medium\" and (product:*accesschk or winlog.event_data.description:*reports\\ effective\\ permissions*))
<li><a href="#">query: (integritylevel:\"medium\" and process.command_line.text:*controlset* and process.command_line.text:*services* and process.command_line.text:(*\\\\imagepath* or *\\\\failurecommand* or *\\\\servicedll*))
<li><a href="#">query: (integritylevel:\"medium\" and process.command_line:*controlset* and process.command_line:*services* and process.command_line:(*\\\\imagepath* or *\\\\failurecommand* or *\\\\servicedll*))
<li><a href="#">query: (loggedbyservice:\"authentication\\ methods\" and category:\"usermanagement\" and operationname:\"user\\ registered\\ security\\ info\")
<li><a href="#">query: (not ((device:*floppy*) or (process.executable.text:(c\\:\\\\windows\\\\system32\\\\* or c\\:\\\\windows\\\\systemapps\\\\* or c\\:\\\\windows\\\\winsxs\\\\* or c\\:\\\\windows\\\\servicing\\\\* or c\\:\\\\windows\\\\ccm\\\\* or c\\:\\\\windows\\\\uus\\\\* or c\\:\\\\windows\\\\winsxs\\\\*)) or (processid:\"4\") or (process.executable.text:(\"c\\:\\\\windows\\\\uus\\\\amd64\\\\mousocoreworker.exe\" or \"c\\:\\\\windows\\\\explorer.exe\")) or (process.executable.text:(\"system\" or \"registry\")) or (process.executable.text:*\\\\keybase\\\\upd.exe) or (process.executable.text:c\\:\\\\programdata\\\\microsoft\\\\windows\\ defender\\\\platform\\\\* and process.executable.text:*\\\\msmpeng.exe) or (process.executable.text:(c\\:\\\\program\\ files\\\\* or c\\:\\\\program\\ files\\ \\(x86\\)\\\\*)) or (process.executable.text:*c\\:\\\\users\\\\* and process.executable.text:*\\\\appdata\\\\* and process.executable.text:*\\\\microsoft\\\\*) or (process.executable.text:c\\:\\\\windows\\\\temp\\\\asgard2\\-agent\\\\* and process.executable.text:*\\\\thor.exe) or (process.executable.text:c\\:\\\\windows\\\\systemapps\\\\microsoft.windows.startmenuexperiencehost* and process.executable.text:*\\\\startmenuexperiencehost.exe) or (process.executable.text:\"c\\:\\\\$windows.\\~bt\\\\sources\\\\setuphost.exe\") or (process.executable.text:c\\:\\\\windows\\\\softwaredistribution\\\\download* and process.executable.text:*\\\\windowsupdatebox.exe)))
<li><a href="#">query: (not ((device:*floppy*) or (process.executable:(c\\:\\\\windows\\\\system32\\\\* or c\\:\\\\windows\\\\systemapps\\\\* or c\\:\\\\windows\\\\winsxs\\\\* or c\\:\\\\windows\\\\servicing\\\\* or c\\:\\\\windows\\\\ccm\\\\* or c\\:\\\\windows\\\\uus\\\\* or c\\:\\\\windows\\\\winsxs\\\\*)) or (processid:\"4\") or (process.executable:(\"c\\:\\\\windows\\\\uus\\\\amd64\\\\mousocoreworker.exe\" or \"c\\:\\\\windows\\\\explorer.exe\")) or (process.executable:(\"system\" or \"registry\")) or (process.executable:*\\\\keybase\\\\upd.exe) or (process.executable:c\\:\\\\programdata\\\\microsoft\\\\windows\\ defender\\\\platform\\\\* and process.executable:*\\\\msmpeng.exe) or (process.executable:(c\\:\\\\program\\ files\\\\* or c\\:\\\\program\\ files\\ \\(x86\\)\\\\*)) or (process.executable:*c\\:\\\\users\\\\* and process.executable:*\\\\appdata\\\\* and process.executable:*\\\\microsoft\\\\*) or (process.executable:c\\:\\\\windows\\\\temp\\\\asgard2\\-agent\\\\* and process.executable:*\\\\thor.exe) or (process.executable:c\\:\\\\windows\\\\systemapps\\\\microsoft.windows.startmenuexperiencehost* and process.executable:*\\\\startmenuexperiencehost.exe)))
<li><a href="#">query: (operation:\"add\\ member\\ to\\ role.\" and workload:\"azureactivedirectory\" and modifiedproperties{}.newvalue:(*admins or *administrator))
<li><a href="#">query: (operationname:(microsoft.kubernetes\\/connectedclusters\\/admissionregistration.k8s.io* or microsoft.containerservice\\/managedclusters\\/admissionregistration.k8s.io*) and operationname:(*\\/mutatingwebhookconfigurations\\/write or *\\/validatingwebhookconfigurations\\/write))
<li><a href="#">query: (operationname:(microsoft.kubernetes\\/connectedclusters\\/batch* or microsoft.containerservice\\/managedclusters\\/batch*) and operationname:(*\\/cronjobs\\/write or *\\/jobs\\/write))
<li><a href="#">query: (powershell.command.invocation_details:(*$doit* or *harmj0y* or *mattifestation* or *_rastamouse* or *tifkin_* or *0xdeadbeef*) or winlog.event_data.payload:(*$doit* or *harmj0y* or *mattifestation* or *_rastamouse* or *tifkin_* or *0xdeadbeef*))
<li><a href="#">query: (powershell.command.invocation_details:*expand\\-archive* or winlog.event_data.payload:*expand\\-archive*)
<li><a href="#">query: (powershell.command.invocation_details:*get\\-smbshare* or winlog.event_data.payload:*get\\-smbshare* or contextinfo:*get\\-smbshare*)
<li><a href="#">query: (powershell.command.invocation_details:/(?i).*&&set.*(\\{\\d\\}){2,}\\\\\\\"\\s+?\\-f.*&&.*cmd.*\\/c/ or winlog.event_data.payload:/(?i).*&&set.*(\\{\\d\\}){2,}\\\\\\\"\\s+?\\-f.*&&.*cmd.*\\/c/)
<li><a href="#">query: (powershell.command.invocation_details:/(?i).*(set).*&&\\s?set.*(environment|invoke|\\${?input).*&&.*\"/ or winlog.event_data.payload:/(?i).*(set).*&&\\s?set.*(environment|invoke|\\${?input).*&&.*\"/)
<li><a href="#">query: (powershell.command.invocation_details:/(?i).*?echo.*clip.*&&.*(clipboard|i`?n`?v`?o`?k`?e`?).*/ or winlog.event_data.payload:/(?i).*?echo.*clip.*&&.*(clipboard|i`?n`?v`?o`?k`?e`?).*/)
<li><a href="#">query: (powershell.command.invocation_details:/.*cmd.{0,5}(?:\\/c|\\/r)(?:\\s|)\\\"set\\s[a-za-z]{3,6}.*(?:\\{\\d\\}){1,}\\\\\\\"\\s+?\\-f(?:.*\\)){1,}.*\\\"/ or winlog.event_data.payload:/.*cmd.{0,5}(?:\\/c|\\/r)(?:\\s|)\\\"set\\s[a-za-z]{3,6}.*(?:\\{\\d\\}){1,}\\\\\\\"\\s+?\\-f(?:.*\\)){1,}.*\\\"/)
<li><a href="#">query: (powershell.command.invocation_details:/.*cmd.{0,5}(?:\\/c|\\/r).+clip(?:\\.exe)?.{0,4}&&.+clipboard]::\\(\\s\\\\\\\"\\{\\d\\}.+\\-f.+\\\"/ or winlog.event_data.payload:/.*cmd.{0,5}(?:\\/c|\\/r).+clip(?:\\.exe)?.{0,4}&&.+clipboard]::\\(\\s\\\\\\\"\\{\\d\\}.+\\-f.+\\\"/)
<li><a href="#">query: (powershell.command.invocation_details:/.*cmd.{0,5}(?:\\/c|\\/r).+powershell.+(?:\\$\\{?input\\}?|noexit).+\\\"/ or winlog.event_data.payload:/.*cmd.{0,5}(?:\\/c|\\/r).+powershell.+(?:\\$\\{?input\\}?|noexit).+\\\"/)
<li><a href="#">query: (powershell.file.script_block_text:(*.doc* or *.docx* or *.xls* or *.xlsx* or *.ppt* or *.pptx* or *.rtf* or *.pdf* or *.txt*) and powershell.file.script_block_text:*get\\-childitem* and powershell.file.script_block_text:*\\ \\-recurse\\ * and powershell.file.script_block_text:*\\ \\-include\\ *)
<li><a href="#">query: (powershell.file.script_block_text:(*\\ \\-enc\\ * or *\\ \\-encodedcommand\\ * or *\\ \\-ec\\ *) and powershell.file.script_block_text:(*\\ \\-w\\ hidden\\ * or *\\ \\-window\\ hidden\\ * or *\\ \\-windowstyle\\ hidden\\ * or *\\ \\-w\\ 1\\ *) and powershell.file.script_block_text:(*\\ \\-noni\\ * or *\\ \\-noninteractive\\ *))
<li><a href="#">query: (powershell.file.script_block_text:(*\\ \\-enc\\ * or *\\ \\-encodedcommand\\ *) and powershell.file.script_block_text:(*\\ \\-w\\ hidden\\ * or *\\ \\-window\\ hidden\\ * or *\\ \\-windowstyle\\ hidden\\ *) and powershell.file.script_block_text:(*\\ \\-noni\\ * or *\\ \\-noninteractive\\ *))
<li><a href="#">query: (powershell.file.script_block_text:(*addsecuritypackage* or *adjusttokenprivileges* or *advapi32* or *closehandle* or *createprocesswithtoken* or *createremotethread* or *createthread* or *createuserthread* or *dangerousgethandle* or *duplicatetokenex* or *enumeratesecuritypackages* or *freelibrary* or *getdelegateforfunctionpointer* or *getlogonsessiondata* or *getmodulehandle* or *getprocaddress* or *getprocesshandle* or *gettokeninformation* or *impersonateloggedonuser* or *kernel32* or *loadlibrary* or *memcpy* or *minidumpwritedump* or *msvcrt* or *ntdll* or *opendesktop* or *openprocess* or *openprocesstoken* or *openthreadtoken* or *openwindowstation* or *queueuserapc* or *readprocessmemory* or *reverttoself* or *rtlcreateuserthread* or *secur32* or *setthreadtoken* or *virtualalloc* or *virtualfree* or *virtualprotect* or *waitforsingleobject* or *writeint32* or *writeprocessmemory* or *zerofreeglobalallocunicode*) and (not (powershell.file.script_block_text:#\\ copyright\\ 2016\\ amazon.com,\\ inc.\\ or\\ its\\ affiliates.* and powershell.file.script_block_text:*function\\ import\\-serialportutil\\ *)))
<li><a href="#">query: (powershell.file.script_block_text:(*get\\-localgroup* or *get\\-localgroupmember*) or (powershell.file.script_block_text:*get\\-wmiobject* and powershell.file.script_block_text:*win32_group*))
<li><a href="#">query: (powershell.file.script_block_text:(*get\\-passwordvaultcredentials* or *get\\-credmancreds*) or (powershell.file.script_block_text:*new\\-object* and powershell.file.script_block_text:*windows.security.credentials.passwordvault*) or (powershell.file.script_block_text:*new\\-object* and powershell.file.script_block_text:*microsoft.csharp.csharpcodeprovider* and powershell.file.script_block_text:*\\[system.runtime.interopservices.runtimeenvironment\\]\\:\\:getruntimedirectory\\(\\)\\)* and powershell.file.script_block_text:*collections.arraylist* and powershell.file.script_block_text:*system.codedom.compiler.compilerparameters*))
<li><a href="#">query: (powershell.file.script_block_text:(*get\\-service\\ * or *get\\-childitem\\ * or *get\\-process\\ *) and powershell.file.script_block_text:*>\\ $env\\:temp\\\\*)
<li><a href="#">query: (powershell.file.script_block_text:(*get\\-wmiobject* or *gwmi*) and powershell.file.script_block_text:(*msacpi_thermalzonetemperature* or *win32_computersystem*))
<li><a href="#">query: (powershell.file.script_block_text:(*invoke\\-webrequest* or *iwr\\ * or *wget\\ * or *curl\\ * or *net.webclient* or *start\\-bitstransfer* or *resume\\-bitstransfer* or *\\[system.net.webrequest\\]\\:\\:create* or *invoke\\-restmethod* or *winhttp.winhttprequest*) and (not winlog.event_data.path:c\\:\\\\packages\\\\plugins\\\\microsoft.guestconfiguration.configurationforwindows\\\\*))
<li><a href="#">query: (powershell.file.script_block_text:(*invoke\\-webrequest* or *iwr\\ * or *wget\\ * or *curl\\ * or *net.webclient* or *start\\-bitstransfer*) and (not (winlog.event_data.path:c\\:\\\\packages\\\\plugins\\\\microsoft.guestconfiguration.configurationforwindows\\\\*)))
<li><a href="#">query: (powershell.file.script_block_text:(*invoke\\-webrequest* or *iwr\\ *) and powershell.file.script_block_text:*\\-method\\ * and powershell.file.script_block_text:(*\\ put\\ * or *\\ post\\ *))
<li><a href="#">query: (powershell.file.script_block_text:(*ls* or *get\\-childitem* or *gci*) and powershell.file.script_block_text:*\\-recurse*)
<li><a href="#">query: (powershell.file.script_block_text:(*new\\-scheduledtaskaction* or *new\\-scheduledtasktrigger* or *new\\-scheduledtaskprincipal* or *new\\-scheduledtasksettingsset* or *new\\-scheduledtask* or *register\\-scheduledtask*) or (powershell.file.script_block_text:*invoke\\-cimmethod* and powershell.file.script_block_text:*\\-classname* and powershell.file.script_block_text:*ps_scheduledtask* and powershell.file.script_block_text:*\\-namespace* and powershell.file.script_block_text:*root\\\\microsoft\\\\windows\\\\taskscheduler*))
<li><a href="#">query: (powershell.file.script_block_text:(*set\\-content* or *add\\-content*) and powershell.file.script_block_text:*\\-stream*)
<li><a href="#">query: (powershell.file.script_block_text:*$env\\:cor_enable_profiling* and powershell.file.script_block_text:*$env\\:cor_profiler* and powershell.file.script_block_text:*$env\\:cor_profiler_path*)
<li><a href="#">query: (powershell.file.script_block_text:*\\&&* and powershell.file.script_block_text:*rundll32* and powershell.file.script_block_text:*shell32.dll* and powershell.file.script_block_text:*shellexec_rundll* and powershell.file.script_block_text:(*value* or *invoke* or *comspec* or *iex*))
<li><a href="#">query: (powershell.file.script_block_text:*\\[ref\\].assembly.gettype* and powershell.file.script_block_text:*setvalue\\($null,$true\\)* and powershell.file.script_block_text:*nonpublic,static*)
<li><a href="#">query: (powershell.file.script_block_text:*\\\\software\\\\policies\\\\microsoft\\\\windows\\\\system* and powershell.file.script_block_text:(*grouppolicyrefreshtimedc* or *grouppolicyrefreshtimeoffsetdc* or *grouppolicyrefreshtime* or *grouppolicyrefreshtimeoffset* or *enablesmartscreen* or *shellsmartscreenlevel*))
<li><a href="#">query: (powershell.file.script_block_text:*\\-alias* and powershell.file.script_block_text:*\\ \\-value\\ \\(\\-join\\(*)
<li><a href="#">query: (powershell.file.script_block_text:*\\-recurse* and powershell.file.script_block_text:*|* and powershell.file.script_block_text:*compress\\-archive*)
<li><a href="#">query: (powershell.file.script_block_text:*aaaayinlm* and powershell.file.script_block_text:(*oicaaaayinlm* or *oijaaaayinlm*))
<li><a href="#">query: (powershell.file.script_block_text:*add\\-content* and powershell.file.script_block_text:*$profile* and powershell.file.script_block_text:*\\-value* and powershell.file.script_block_text:(*start\\-process* or *\\\"\\\"*))
<li><a href="#">query: (powershell.file.script_block_text:*add\\-dnsclientnrptrule* and powershell.file.script_block_text:*\\-namesp* and powershell.file.script_block_text:*\\-namese*)
<li><a href="#">query: (powershell.file.script_block_text:*cert\\:\\\\localmachine\\\\root* and (powershell.file.script_block_text:*move\\-item* or powershell.file.script_block_text:*import\\-certificate*))
<li><a href="#">query: (powershell.file.script_block_text:*cl_invocation.ps1* and powershell.file.script_block_text:*syncinvoke*)
<li><a href="#">query: (powershell.file.script_block_text:*cl_mutexverifiers.ps1* and powershell.file.script_block_text:*runaftercancelprocess*)
<li><a href="#">query: (powershell.file.script_block_text:*clear\\-history* or (powershell.file.script_block_text:(*remove\\-item* or *rm*) and powershell.file.script_block_text:(*consolehost_history.txt* or *\\(get\\-psreadlineoption\\).historysavepath*)))
<li><a href="#">query: (powershell.file.script_block_text:*compress\\-archive\\ * and powershell.file.script_block_text:*\\ \\-path\\ * and powershell.file.script_block_text:*\\ \\-destinationpath\\ * and powershell.file.script_block_text:*$env\\:temp\\\\*)
<li><a href="#">query: (powershell.file.script_block_text:*copy\\-item* and powershell.file.script_block_text:*\\-destination* and powershell.file.script_block_text:(*\\\\google\\\\chrome\\\\user\\ data\\\\default\\\\login\\ data* or *\\\\google\\\\chrome\\\\user\\ data\\\\default\\\\login\\ data\\ for\\ account*))
<li><a href="#">query: (powershell.file.script_block_text:*copy\\-item* and powershell.file.script_block_text:*\\-destination* and powershell.file.script_block_text:(*\\\\opera\\ software\\\\opera\\ stable\\\\login\\ data* or *\\\\mozilla\\\\firefox\\\\profiles* or *\\\\microsoft\\\\edge\\\\user\\ data\\\\default* or *\\\\google\\\\chrome\\\\user\\ data\\\\default\\\\login\\ data* or *\\\\google\\\\chrome\\\\user\\ data\\\\default\\\\login\\ data\\ for\\ account*))
<li><a href="#">query: (powershell.file.script_block_text:*copy\\-item\\ * and powershell.file.script_block_text:*\\-destination\\ * and powershell.file.script_block_text:(*\\\\windows\\\\system32* or *\\\\windows\\\\syswow64*))
<li><a href="#">query: (powershell.file.script_block_text:*currentversion\\\\winlogon* and powershell.file.script_block_text:(*set\\-itemproperty* or *new\\-item*))
<li><a href="#">query: (powershell.file.script_block_text:*enable\\-windowsoptionalfeature* and powershell.file.script_block_text:*\\-online* and powershell.file.script_block_text:*\\-featurename* and powershell.file.script_block_text:(*telnetserver* or *internet\\-explorer\\-optional\\-amd64* or *tftp* or *smb1protocol* or *client\\-projfs* or *microsoft\\-windows\\-subsystem\\-linux*))
<li><a href="#">query: (powershell.file.script_block_text:*foreach* and powershell.file.script_block_text:*get\\-childitem* and powershell.file.script_block_text:*\\-path\\ * and powershell.file.script_block_text:*\\-erroraction\\ * and powershell.file.script_block_text:*silentlycontinue* and powershell.file.script_block_text:*out\\-file\\ * and powershell.file.script_block_text:*\\-append*)
<li><a href="#">query: (powershell.file.script_block_text:*frombase64string* and powershell.file.script_block_text:*memorystream* and powershell.file.script_block_text:*h4si*)
<li><a href="#">query: (powershell.file.script_block_text:*get\\-acl* and powershell.file.script_block_text:*registry\\:\\:hklm\\\\system\\\\currentcontrolset\\\\services\\\\*)
<li><a href="#">query: (powershell.file.script_block_text:*get\\-adcomputer\\ * and powershell.file.script_block_text:*\\-filter*)
<li><a href="#">query: (powershell.file.script_block_text:*get\\-adgroup\\ * and powershell.file.script_block_text:*\\-filter*)
<li><a href="#">query: (powershell.file.script_block_text:*get\\-adprincipalgroupmembership* or (powershell.file.script_block_text:*get\\-aduser* and powershell.file.script_block_text:*\\-f\\ * and powershell.file.script_block_text:*\\-pr\\ * and powershell.file.script_block_text:*doesnotrequirepreauth*))
<li><a href="#">query: (powershell.file.script_block_text:*get\\-adreplaccount* and powershell.file.script_block_text:*\\-all\\ * and powershell.file.script_block_text:*\\-server\\ *)
<li><a href="#">query: (powershell.file.script_block_text:*get\\-aduser* and powershell.file.script_block_text:*\\-filter* and powershell.file.script_block_text:*useraccountcontrol* and powershell.file.script_block_text:*\\-band* and powershell.file.script_block_text:*4194304*)
<li><a href="#">query: (powershell.file.script_block_text:*get\\-childitem* and powershell.file.script_block_text:*\\ \\-recurse\\ * and powershell.file.script_block_text:*\\ \\-path\\ * and powershell.file.script_block_text:*\\ \\-filter\\ bookmarks* and powershell.file.script_block_text:*\\ \\-erroraction\\ silentlycontinue* and powershell.file.script_block_text:*\\ \\-force*)
<li><a href="#">query: (powershell.file.script_block_text:*get\\-itemproperty* and powershell.file.script_block_text:*\\\\software\\\\* and powershell.file.script_block_text:*select\\-object* and powershell.file.script_block_text:*format\\-table*)
<li><a href="#">query: (powershell.file.script_block_text:*get\\-keystrokes* or (powershell.file.script_block_text:*get\\-procaddress\\ user32.dll\\ getasynckeystate* and powershell.file.script_block_text:*get\\-procaddress\\ user32.dll\\ getforegroundwindow*))
<li><a href="#">query: (powershell.file.script_block_text:*get\\-process* and powershell.file.script_block_text:*.description* and powershell.file.script_block_text:*\\-like* and powershell.file.script_block_text:(*\\\"*virus*\\\"* or *\\\"*carbonblack*\\\"* or *\\\"*defender*\\\"* or *\\\"*cylance*\\\"*))
<li><a href="#">query: (powershell.file.script_block_text:*get\\-storagediagnosticinfo* and powershell.file.script_block_text:*\\-includelivedump*)
<li><a href="#">query: (powershell.file.script_block_text:*get\\-wmiobject* and powershell.file.script_block_text:*win32_shadowcopy* and powershell.file.script_block_text:*.delete\\(\\)*)
<li><a href="#">query: (powershell.file.script_block_text:*invoke\\-command\\ * and powershell.file.script_block_text:*\\ \\-computername\\ *)
<li><a href="#">query: (powershell.file.script_block_text:*invoke\\-dnsexfiltrator* or (powershell.file.script_block_text:*\\ \\-i\\ * and powershell.file.script_block_text:*\\ \\-d\\ * and powershell.file.script_block_text:*\\ \\-p\\ * and powershell.file.script_block_text:*\\ \\-doh\\ * and powershell.file.script_block_text:*\\ \\-t\\ *))
<li><a href="#">query: (powershell.file.script_block_text:*invoke\\-troubleshootingpack* and powershell.file.script_block_text:*c\\:\\\\windows\\\\diagnostics\\\\system\\\\pcw* and powershell.file.script_block_text:*\\-answerfile* and powershell.file.script_block_text:*\\-unattended*)
<li><a href="#">query: (powershell.file.script_block_text:*invoke\\-webrequest* and powershell.file.script_block_text:*\\-useragent\\ *)
<li><a href="#">query: (powershell.file.script_block_text:*ls* and powershell.file.script_block_text:*\\ \\-r* and powershell.file.script_block_text:*select\\-string\\ * and powershell.file.script_block_text:*\\-pattern\\ *)
<li><a href="#">query: (powershell.file.script_block_text:*mount\\-diskimage\\ * and powershell.file.script_block_text:*\\-imagepath\\ * and powershell.file.script_block_text:*get\\-volume* and powershell.file.script_block_text:*.driveletter* and powershell.file.script_block_text:*invoke\\-item\\ * and powershell.file.script_block_text:*\\)\\:\\\\*)
<li><a href="#">query: (powershell.file.script_block_text:*mount\\-diskimage\\ * and powershell.file.script_block_text:*\\-imagepath\\ *)
<li><a href="#">query: (powershell.file.script_block_text:*new\\-ciminstance\\ * and powershell.file.script_block_text:*\\-namespace\\ root\\/subscription\\ * and powershell.file.script_block_text:*\\-property\\ * and (powershell.file.script_block_text:*\\-classname\\ __eventfilter\\ * or powershell.file.script_block_text:*\\-classname\\ commandlineeventconsumer\\ *))
<li><a href="#">query: (powershell.file.script_block_text:*new\\-object* and powershell.file.script_block_text:*\\-comobject* and powershell.file.script_block_text:*msxml2.* and powershell.file.script_block_text:*xmlhttp*)
<li><a href="#">query: (powershell.file.script_block_text:*new\\-object* and powershell.file.script_block_text:*io.filestream* and powershell.file.script_block_text:*\\\\\\\\.\\\\\\*)
<li><a href="#">query: (powershell.file.script_block_text:*new\\-object* and powershell.file.script_block_text:*system.net.networkinformation.ping* and powershell.file.script_block_text:*.send\\(*)
<li><a href="#">query: (powershell.file.script_block_text:*new\\-object* and powershell.file.script_block_text:*system.xml.xmldocument* and powershell.file.script_block_text:*.load* and powershell.file.script_block_text:(*iex\\ * or *invoke\\-expression\\ *))
<li><a href="#">query: (powershell.file.script_block_text:*new\\-object* and powershell.file.script_block_text:*text.encoding\\]\\:\\:ascii* and powershell.file.script_block_text:(*system.io.compression.deflatestream* or *system.io.streamreader*) and powershell.file.script_block_text:*readtoend)
<li><a href="#">query: (powershell.file.script_block_text:*new\\-object\\ * and powershell.file.script_block_text:*\\-comobject\\ * and powershell.file.script_block_text:*.application* and powershell.file.script_block_text:*.registerxll*)
<li><a href="#">query: (powershell.file.script_block_text:*new\\-object\\ * and powershell.file.script_block_text:*system.directoryservices.directorysearcher* and powershell.file.script_block_text:*.propertiestoload.add* and powershell.file.script_block_text:*.findall\\(\\)* and powershell.file.script_block_text:*properties.name*)
<li><a href="#">query: (powershell.file.script_block_text:*new\\-psdrive* and powershell.file.script_block_text:*\\-psprovider\\ * and powershell.file.script_block_text:*filesystem* and powershell.file.script_block_text:*\\-root\\ * and powershell.file.script_block_text:*\\\\\\* and powershell.file.script_block_text:*$*)
<li><a href="#">query: (powershell.file.script_block_text:*new\\-pssession* and powershell.file.script_block_text:*\\-computername\\ *)
<li><a href="#">query: (powershell.file.script_block_text:*powershell* and powershell.file.script_block_text:*windowstyle* and powershell.file.script_block_text:*hidden*)
<li><a href="#">query: (powershell.file.script_block_text:*remove\\-adgroupmember* and powershell.file.script_block_text:*\\-identity\\ * and powershell.file.script_block_text:*\\-members\\ *)
<li><a href="#">query: (powershell.file.script_block_text:*remove\\-etwtraceprovider\\ * or (powershell.file.script_block_text:*set\\-etwtraceprovider\\ * and powershell.file.script_block_text:*0x11*))
<li><a href="#">query: (powershell.file.script_block_text:*remove\\-mppreference* and powershell.file.script_block_text:(*\\-controlledfolderaccessprotectedfolders\\ * or *\\-attacksurfacereductionrules_ids\\ * or *\\-attacksurfacereductionrules_actions\\ * or *\\-checkforsignaturesbeforerunningscan\\ *))
<li><a href="#">query: (powershell.file.script_block_text:*rundll32.exe* and powershell.file.script_block_text:*shell32.dll* and powershell.file.script_block_text:*shellexec_rundll* and powershell.file.script_block_text:*powershell*)
<li><a href="#">query: (powershell.file.script_block_text:*send\\-mailmessage* and (not (powershell.file.script_block_text:*cmdletstoexport*)))
<li><a href="#">query: (powershell.file.script_block_text:*set* and powershell.file.script_block_text:*\\&&* and powershell.file.script_block_text:*mshta* and powershell.file.script_block_text:*vbscript\\:createobject* and powershell.file.script_block_text:*.run* and powershell.file.script_block_text:*\\(window.close\\)*)
<li><a href="#">query: (powershell.file.script_block_text:*set\\-mppreference* and (powershell.file.script_block_text:(*disablerealtimemonitoring\\ 1* or *disablebehaviormonitoring\\ 1* or *disablescriptscanning\\ 1* or *disablearchivescanning\\ 1* or *disableblockatfirstseen\\ 1* or *disableioavprotection\\ 1* or *disableintrusionpreventionsystem\\ 1* or *disableremovabledrivescanning\\ 1* or *disablescanningmappednetworkdrivesforfullscan\\ 1* or *disablescanningnetworkfiles\\ 1* or *disablerealtimemonitoring\\ $true* or *disablebehaviormonitoring\\ $true* or *disablescriptscanning\\ $true* or *disablearchivescanning\\ $true* or *disableblockatfirstseen\\ $true* or *disableioavprotection\\ $true* or *disableintrusionpreventionsystem\\ $true* or *disableremovabledrivescanning\\ $true* or *disablescanningmappednetworkdrivesforfullscan\\ $true* or *disablescanningnetworkfiles\\ $true*) or (powershell.file.script_block_text:*allow* and powershell.file.script_block_text:(*lowthreatdefaultaction* or *moderatethreatdefaultaction* or *highthreatdefaultaction*))))
<li><a href="#">query: (powershell.file.script_block_text:*set\\-netfirewallprofile\\ * and powershell.file.script_block_text:*\\ \\-enabled\\ * and powershell.file.script_block_text:*\\ false* and powershell.file.script_block_text:(*\\ \\-all\\ * or *public* or *domain* or *private*))
<li><a href="#">query: (powershell.file.script_block_text:*start\\-process* and powershell.file.script_block_text:(*.cmd* or *.bat*))
<li><a href="#">query: (powershell.file.script_block_text:*start\\-process* and powershell.file.script_block_text:*\\-filepath\\ \\\"$env\\:comspec\\\"\\ * and powershell.file.script_block_text:*\\-argumentlist\\ * and powershell.file.script_block_text:*>*)
<li><a href="#">query: (powershell.file.script_block_text:*start\\-process* and powershell.file.script_block_text:*\\-passthru\\ * and powershell.file.script_block_text:*\\-filepath\\ *)
<li><a href="#">query: (powershell.file.script_block_text:*system.diagnostics.process* and powershell.file.script_block_text:*stop\\-computer* and powershell.file.script_block_text:*restart\\-computer* and powershell.file.script_block_text:*exception\\ in\\ execution* and powershell.file.script_block_text:*$cmdargs* and powershell.file.script_block_text:*close\\-dnscat2tunnel* and powershell.file.script_block_text:*set\\ type\\=$lookuptype`nserver* and powershell.file.script_block_text:*$command\\ |\\ nslookup\\ 2>&1\\ |\\ out\\-string* and powershell.file.script_block_text:*new\\-randomdnsfield* and powershell.file.script_block_text:*\\[convert\\]\\:\\:tostring\\($synoptions,\\ 16\\)* and powershell.file.script_block_text:*$session.dead\\ \\=\\ $true* and powershell.file.script_block_text:*$session\\[\\\"driver\\\"\\]\\ \\-eq*)
<li><a href="#">query: (powershell.file.script_block_text:*system.net.security.sslstream* and powershell.file.script_block_text:*net.security.remotecertificatevalidationcallback* and powershell.file.script_block_text:*.authenticateasclient*)
<li><a href="#">query: (powershell.file.script_block_text:*system.net.webclient* and powershell.file.script_block_text:(*.downloadfile\\(* or *.downloadstring\\(*))
<li><a href="#">query: (powershell.file.script_block_text:*unblock\\-file\\ * and powershell.file.script_block_text:*\\-path\\ *)
<li><a href="#">query: (powershell.file.script_block_text:*vaultcmd* and powershell.file.script_block_text:*\\/listcreds\\:* and powershell.file.script_block_text:(*windows\\ credentials* or *web\\ credentials*))
<li><a href="#">query: (powershell.file.script_block_text:*win32_quickfixengineering* and powershell.file.script_block_text:*hotfixid*)
<li><a href="#">query: (powershell.file.script_block_text:*win32_shadowcopy* and powershell.file.script_block_text:*\\).create\\(* and powershell.file.script_block_text:*clientaccessible*)
<li><a href="#">query: (powershell.file.script_block_text:*win32_trustee* and powershell.file.script_block_text:*win32_ace* and powershell.file.script_block_text:*.accessmask* and powershell.file.script_block_text:*.acetype* and powershell.file.script_block_text:*.setsecuritydescriptor* and powershell.file.script_block_text:(*\\\\lsa\\\\jd* or *\\\\lsa\\\\skew1* or *\\\\lsa\\\\data* or *\\\\lsa\\\\gbg*))
<li><a href="#">query: (process.command_line.text:(*.doc* or *.docx* or *.xls* or *.xlsx* or *.ppt* or *.pptx* or *.rtf* or *.pdf* or *.txt*) and ((process.command_line.text:*dir\\ * and process.command_line.text:*\\ \\/b\\ * and process.command_line.text:*\\ \\/s\\ *) or (winlog.event_data.originalfilename:\"findstr.exe\" and process.command_line.text:(*\\ \\/e\\ * or *\\ \\/si\\ *))))
<li><a href="#">query: (process.command_line.text:(*.downloadstring\\(* or *.downloadfile\\(* or *invoke\\-webrequest\\ * or *iwr\\ *) and process.command_line.text:(*iex\\(* or *iex\\ \\(* or *i`ex* or *ie`x* or *i`e`x* or *|\\ iex* or *|iex\\ * or *invoke\\-expression* or *;iex\\ $*))
<li><a href="#">query: (process.command_line.text:(*\\ \\-\\-cpu\\-priority\\=* or *\\-\\-donate\\-level\\=0* or *\\ \\-o\\ pool.* or *\\ \\-\\-nicehash* or *\\ \\-\\-algo\\=rx\\/0\\ * or *stratum\\+tcp\\:\\/\\/* or *stratum\\+udp\\:\\/\\/* or *ls1kb25hdgutbgv2zww9* or *0tzg9uyxrllwxldmvsp* or *tlwrvbmf0zs1szxzlbd* or *c3ryyxr1bst0y3a6ly* or *n0cmf0dw0rdgnwoi8v* or *zdhjhdhvtk3rjcdovl* or *c3ryyxr1bst1zha6ly* or *n0cmf0dw0rdwrwoi8v* or *zdhjhdhvtk3vkcdovl*) and (not (process.command_line.text:(*\\ pool.c\\ * or *\\ pool.o\\ * or *gcc\\ \\-*))))
<li><a href="#">query: (process.command_line.text:(*\\ \\-\\-remote\\-debugging\\-address\\=* or *\\ \\-\\-remote\\-debugging\\-port\\=*) or (process.executable.text:*\\\\firefox.exe and process.command_line.text:*\\ \\-start\\-debugger\\-server\\ *))
<li><a href="#">query: (process.command_line.text:(*\\ \\-e*\\ paa* or *jablag4adga6ahuacwblahiacabyag8azgbpagwazq* or *qazqbuahyaogb1ahmazqbyahaacgbvagyaaqbsagua* or *kaguabgb2adoadqbzaguacgbwahiabwbmagkababla* or *igaoaccakganackaowaka* or *iakaanacoajwapadsaja* or *iacgajwaqaccakqa7acqa* or *jabgagwaeabyaggaywbmagq* or *pqakaguabgb2adoadablag0acaaracga* or *0ajablag4adga6ahqazqbtahaakwaoa* or *9acqazqbuahyaogb0aguabqbwacsaka*) and (not (process.command_line.text:(*faagaemabwbuahyazqbyahqavabvac0asgbzag8abgagac0arqbyahiabwbyaeeaywb0agkabwbuacaauwbpagwazqbuahqabab5aemabwbuahqaaqbuahuazq* or *waiabdag8abgb2aguacgb0afqabwataeoacwbvag4aiaataeuacgbyag8acgbbagmadabpag8abgagafmaaqbsaguabgb0agwaeqbdag8abgb0agkabgb1agua* or *8acaaqwbvag4adgblahiadabuag8alqbkahmabwbuacaalqbfahiacgbvahiaqqbjahqaaqbvag4aiabtagkabablag4adabsahkaqwbvag4adabpag4adqbla*))))
<li><a href="#">query: (process.command_line.text:(*\\ \\-ma\\ * or *\\ \\/ma\\ *) and process.command_line.text:*\\ ls*)
<li><a href="#">query: (process.command_line.text:(*\\ tcp\\ 139* or *\\ tcp\\ 445* or *\\ tcp\\ 3389* or *\\ tcp\\ 5985* or *\\ tcp\\ 5986*) or (process.command_line.text:*\\ start\\ * and process.command_line.text:*\\-\\-all* and process.command_line.text:*\\-\\-config* and process.command_line.text:*.yml*) or (process.executable.text:*ngrok.exe and process.command_line.text:(*\\ tcp\\ * or *\\ http\\ * or *\\ authtoken\\ *)))
<li><a href="#">query: (process.command_line.text:(*\\\\microsoft\\\\teams\\\\cookies* or *\\\\microsoft\\\\teams\\\\local\\ storage\\\\leveldb*) and (not (process.executable.text:*\\\\microsoft\\\\teams\\\\current\\\\teams.exe)))
<li><a href="#">query: (process.command_line.text:(*\\\\shellids\\\\microsoft.powershell\\\\executionpolicy* or *\\\\policies\\\\microsoft\\\\windows\\\\powershell\\\\executionpolicy*) and process.command_line.text:(*bypass* or *remotesigned* or *unrestricted*))
<li><a href="#">query: (process.command_line.text:(*\\~1.exe* or *\\~1.bat* or *\\~1.msi* or *\\~1.vbe* or *\\~1.vbs* or *\\~1.dll* or *\\~1.ps1* or *\\~1.js* or *\\~1.hta* or *\\~2.exe* or *\\~2.bat* or *\\~2.msi* or *\\~2.vbe* or *\\~2.vbs* or *\\~2.dll* or *\\~2.ps1* or *\\~2.js* or *\\~2.hta*) and (not (process.parent.executable.text:(*\\\\webex\\\\webexhost.exe or *\\\\thor\\\\thor64.exe) or process.command_line.text:*c\\:\\\\xampp\\\\vcredist\\\\vcredi\\~1.exe*)))
<li><a href="#">query: (process.command_line.text:(*\\~1\\\\* or *\\~2\\\\*) and (not (process.parent.executable.text:(\"c\\:\\\\windows\\\\system32\\\\dism.exe\" or \"c\\:\\\\windows\\\\system32\\\\cleanmgr.exe\" or \"c\\:\\\\program\\ files\\\\gpsoftware\\\\directory\\ opus\\\\dopus.exe\") or process.parent.executable.text:(*\\\\webex\\\\webexhost.exe or *\\\\thor\\\\thor64.exe or *\\\\veam.backup.shell.exe or *\\\\winget.exe or *\\\\everything\\\\everything.exe) or process.parent.executable.text:*\\\\appdata\\\\local\\\\temp\\\\winget\\\\* or process.command_line.text:(*\\\\appdata\\\\local\\\\webex\\\\webex64\\\\meetings\\\\wbxreport.exe* or *c\\:\\\\program\\ files\\\\git\\\\post\\-install.bat* or *c\\:\\\\program\\ files\\\\git\\\\cmd\\\\scalar.exe*))))
<li><a href="#">query: (process.command_line.text:(*\\-i* or *\\/install* or *\\-a* or *\\/add\\-driver* or *.inf*) and process.executable.text:*\\\\pnputil.exe)
<li><a href="#">query: (process.command_line.text:(*addsecuritypackage* or *adjusttokenprivileges* or *advapi32* or *closehandle* or *createprocesswithtoken* or *createpseudoconsole* or *createremotethread* or *createthread* or *createuserthread* or *dangerousgethandle* or *duplicatetokenex* or *enumeratesecuritypackages* or *freehglobal* or *freelibrary* or *getdelegateforfunctionpointer* or *getlogonsessiondata* or *getmodulehandle* or *getprocaddress* or *getprocesshandle* or *gettokeninformation* or *impersonateloggedonuser* or *kernel32* or *loadlibrary* or *memcpy* or *minidumpwritedump* or *ntdll* or *opendesktop* or *openprocess* or *openprocesstoken* or *openthreadtoken* or *openwindowstation* or *ptrtostring* or *queueuserapc* or *readprocessmemory* or *reverttoself* or *rtlcreateuserthread* or *secur32* or *setthreadtoken* or *virtualalloc* or *virtualfree* or *virtualprotect* or *waitforsingleobject* or *writeint32* or *writeprocessmemory* or *zerofreeglobalallocunicode*) and (not (process.executable.text:*\\\\mpcmdrun.exe and process.command_line.text:*getloadlibrarywaddress32*)))
<li><a href="#">query: (process.command_line.text:(*dir\\ * or *findstr\\ *) and process.command_line.text:(*.key* or *.pgp* or *.gpg* or *.ppk* or *.p12* or *.pem* or *.pfx* or *.cer* or *.p7b* or *.asc*))
<li><a href="#">query: (process.command_line.text:(*get\\-wmiobject* or *gwmi* or *get\\-ciminstance* or *gcim*) and process.command_line.text:*win32_shadowcopy* and process.command_line.text:(*.delete\\(\\)* or *remove\\-wmiobject* or *rwmi* or *remove\\-ciminstance* or *rcim*))
<li><a href="#">query: (process.command_line.text:(*invoke\\-webrequest* or *iwr\\ * or *wget\\ * or *curl\\ * or *downloadfile* or *downloadstring*) and (process.command_line.text:(*\\/\\/0x* or *.0x* or *.00x*) or (process.command_line.text:*http\\:\\/\\/%* and process.command_line.text:*%2e*)))
<li><a href="#">query: (process.command_line.text:(*lockoutduration* or *lockoutthreshold* or *lockoutobservationwindow* or *maxpwdage* or *minpwdage* or *minpwdlength* or *pwdhistorylength* or *pwdproperties*) or process.command_line.text:*\\-sc\\ admincountdmp* or process.command_line.text:*\\-sc\\ exchaddresses*)
<li><a href="#">query: (process.command_line.text:(*qwrklu1wuhjlzmvyzw5jzs* or *fkzc1ncfbyzwzlcmvuy2ug* or *bzgqttxbqcmvmzxjlbmnli* or *u2v0lu1wuhjlzmvyzw5jzs* or *nldc1ncfbyzwzlcmvuy2ug* or *tzxqttxbqcmvmzxjlbmnli* or *ywrklw1wchjlzmvyzw5jzs* or *fkzc1tchbyzwzlcmvuy2ug* or *hzgqtbxbwcmvmzxjlbmnli* or *c2v0lw1wchjlzmvyzw5jzs* or *nldc1tchbyzwzlcmvuy2ug* or *zzxqtbxbwcmvmzxjlbmnli*) and process.command_line.text:(*qqbkagqalqbnahaauabyaguazgblahiazqbuagmazqaga* or *eazabkac0atqbwafaacgblagyazqbyaguabgbjaguaia* or *bagqazaatae0acabqahiazqbmaguacgblag4aywblacaa* or *uwblahqalqbnahaauabyaguazgblahiazqbuagmazqaga* or *mazqb0ac0atqbwafaacgblagyazqbyaguabgbjaguaia* or *taguadaatae0acabqahiazqbmaguacgblag4aywblacaa* or *yqbkagqalqbtahaacabyaguazgblahiazqbuagmazqaga* or *eazabkac0abqbwahaacgblagyazqbyaguabgbjaguaia* or *hagqazaatag0acabwahiazqbmaguacgblag4aywblacaa* or *cwblahqalqbtahaacabyaguazgblahiazqbuagmazqaga* or *mazqb0ac0abqbwahaacgblagyazqbyaguabgbjaguaia* or *zaguadaatag0acabwahiazqbmaguacgblag4aywblacaa*))
<li><a href="#">query: (process.command_line.text:(*reg.exe\\ save\\ hklm\\\\sam\\ %temp%\\\\\\~reg_sam.save* or *1q2w3e4r@#$@#$@#$* or *\\ \\-hp1q2w3e4\\ * or *.dat\\ data03\\ 10000\\ \\-p\\ *) or (process.command_line.text:*process\\ call\\ create* and process.command_line.text:*\\ >\\ %temp%\\\\\\~*) or (process.command_line.text:*netstat\\ \\-aon\\ |\\ find\\ * and process.command_line.text:*\\ >\\ %temp%\\\\\\~*) or process.command_line.text:*.255\\ 10\\ c\\:\\\\programdata\\\\*)
<li><a href="#">query: (process.command_line.text:(*stop\\-service\\ * or *remove\\-service\\ *) and process.command_line.text:(*\\ mcafeedlpagentservice* or *\\ trend\\ micro\\ deep\\ security\\ manager* or *\\ tmbmserver* or *sophos* or *symantec*))
<li><a href="#">query: (process.command_line.text:(sh\\ \\-c\\ * or bash\\ \\-c\\ *) and (process.command_line.text:(*|\\ bash\\ * or *|\\ sh\\ * or *|bash\\ * or *|sh\\ *) or process.command_line.text:(*|\\ bash or *|\\ sh or *|bash or *\\ |sh)))
<li><a href="#">query: (process.command_line.text:*\\ \\/injectrunning\\ * or (winlog.event_data.originalfilename:(\"mavinject32.exe\" or \"mavinject64.exe\") and (not (process.executable.text:(*\\\\mavinject32.exe or *\\\\mavinject64.exe)))))
<li><a href="#">query: (process.command_line.text:*\\ \\/s* and process.command_line.text:*\\ \\/u* and process.command_line.text:(*\\ \\/i\\:http\\:\\/\\/1* or *\\ \\/i\\:http\\:\\/\\/2* or *\\ \\/i\\:http\\:\\/\\/3* or *\\ \\/i\\:http\\:\\/\\/4* or *\\ \\/i\\:http\\:\\/\\/5* or *\\ \\/i\\:http\\:\\/\\/6* or *\\ \\/i\\:http\\:\\/\\/7* or *\\ \\/i\\:http\\:\\/\\/8* or *\\ \\/i\\:http\\:\\/\\/9* or *\\ \\/i\\:https\\:\\/\\/1* or *\\ \\/i\\:https\\:\\/\\/2* or *\\ \\/i\\:https\\:\\/\\/3* or *\\ \\/i\\:https\\:\\/\\/4* or *\\ \\/i\\:https\\:\\/\\/5* or *\\ \\/i\\:https\\:\\/\\/6* or *\\ \\/i\\:https\\:\\/\\/7* or *\\ \\/i\\:https\\:\\/\\/8* or *\\ \\/i\\:https\\:\\/\\/9*))
<li><a href="#">query: (process.command_line.text:*\\ \\-s\\ cmd.exe and process.command_line.text:(*psexec* or *paexec* or *accepteula* or *cmd\\ \\/c\\ * or *cmd\\ \\/k\\ *))
<li><a href="#">query: (process.command_line.text:*\\ run\\ run\\-cmd\\ * and (not (process.parent.executable.text:(*\\\\kavremover.exe or *\\\\cleanapi.exe))))
<li><a href="#">query: (process.command_line.text:*\\/c* and process.command_line.text:*echo\\ * and process.command_line.text:*\\ \\-\\-set\\-password*)
<li><a href="#">query: (process.command_line.text:*\\/factory,\\{75dff2b7\\-6936\\-4c06\\-a8bb\\-676a7b00b24b\\}* or (process.command_line.text:*explorer.exe* and process.command_line.text:*\\ \\/root,*))
<li><a href="#">query: (process.command_line.text:*\\\"\\\\system32\\\\cleanmgr.exe\\ \\/autoclean\\ \\/d\\ c\\: and process.parent.command_line.text:\"c\\:\\\\windows\\\\system32\\\\svchost.exe\\ \\-k\\ netsvcs\\ \\-p\\ \\-s\\ schedule\" and integritylevel:(\"high\" or \"system\"))
<li><a href="#">query: (process.command_line.text:*\\\\\\\\\\?\\\\globalroot\\\\device\\\\harddiskvolumeshadowcopy* and process.command_line.text:(*\\\\ntds.dit* or *\\\\system* or *\\\\security* or *c\\:\\\\tmp\\\\log*))
<li><a href="#">query: (process.command_line.text:*\\\\calc.exe\\ * or (process.executable.text:*\\\\calc.exe and (not (process.executable.text:(c\\:\\\\windows\\\\system32\\\\* or c\\:\\\\windows\\\\syswow64\\\\* or c\\:\\\\windows\\\\winsxs\\\\*)))))
<li><a href="#">query: (process.command_line.text:*\\\\harddiskvolumeshadowcopy* and process.command_line.text:*system32\\\\config\\\\sam* and process.command_line.text:(*copy\\-item* or *cp\\ $_.* or *cpi\\ $_.* or *copy\\ $_.* or *.file\\]\\:\\:copy\\(*))
<li><a href="#">query: (process.command_line.text:*\\-\\-install* and process.command_line.text:*\\-\\-start\\-with\\-win* and process.command_line.text:*\\-\\-silent*)
<li><a href="#">query: (process.command_line.text:*\\\\register_app.vbs* and process.command_line.text:*\\-register*)
<li><a href="#">query: (process.command_line.text:*\\-\\-remote\\-debugging\\-* and process.command_line.text:*\\-\\-user\\-data\\-dir* and process.command_line.text:*\\-\\-headless*)
<li><a href="#">query: (process.command_line.text:*\\\\rundll32.exe and (not ((process.parent.executable.text:*\\\\svchost.exe) or (process.parent.executable.text:(*\\\\appdata\\\\local\\\\* or *\\\\microsoft\\\\edge\\\\*)))))
<li><a href="#">query: (process.command_line.text:*\\\\windowssensor.exe* and process.command_line.text:*\\ \\/uninstall* and process.command_line.text:*\\ \\/quiet*)
<li><a href="#">query: (process.command_line.text:*\\-exec\\ bypass\\ \\-w\\ 1\\ \\-enc* and process.command_line.text:*uwb0ageacgb0ac0asgbvagiaiaatafmaywbyagkacab0aeiababvagmaaw*)
<li><a href="#">query: (process.command_line.text:*>* and (*\\\\\\\\127.0.0.1\\\\admin$\\\\* or *\\\\\\\\localhost\\\\admin$\\\\*))
<li><a href="#">query: (process.command_line.text:*7za.exe* and process.command_line.text:*\\\\c$\\\\temp\\\\log.zip*)
<li><a href="#">query: (process.command_line.text:*activescripteventconsumer* and process.command_line.text:*\\ create\\ *)
<li><a href="#">query: (process.command_line.text:*base64\\ \\-w0\\ * and (process.command_line.text:(*|\\ bash\\ * or *|\\ sh\\ * or *|bash\\ * or *|sh\\ *) or process.command_line.text:(*|\\ bash or *|\\ sh or *|bash or *\\ |sh)))
<li><a href="#">query: (process.command_line.text:*cl_invocation.ps1* and process.command_line.text:*syncinvoke*)
<li><a href="#">query: (process.command_line.text:*compress\\-archive\\ * and process.command_line.text:*\\ \\-path\\ * and process.command_line.text:*\\ \\-destinationpath\\ * and process.command_line.text:*$env\\:temp\\\\*)
<li><a href="#">query: (process.command_line.text:*cscript* and process.command_line.text:*manage\\-bde.wsf*)
<li><a href="#">query: (process.command_line.text:*del\\ * and ((process.command_line.text:*\\*.exe* and process.command_line.text:*\\/f\\ * and process.command_line.text:*\\/q\\ *) or (process.command_line.text:*\\*.dll* and process.command_line.text:*c\\:\\\\programdata\\\\*)))
<li><a href="#">query: (process.command_line.text:*diantz.exe* and process.command_line.text:*.cab* and (process.command_line.text:/:/ or process.command_line.text:/[/ or process.command_line.text:/^/ or process.command_line.text:/\\/ or process.command_line.text:/\\/ or process.command_line.text:/]/))
<li><a href="#">query: (process.command_line.text:*dllregisterserver* and (not process.executable.text:*\\\\rundll32.exe))
<li><a href="#">query: (process.command_line.text:*e\\=access&* and process.command_line.text:*y\\=guest&* and process.command_line.text:*&p\\=* and process.command_line.text:*&c\\=* and process.command_line.text:*&k\\=*)
<li><a href="#">query: (process.command_line.text:*enable\\-windowsoptionalfeature* and process.command_line.text:*\\-online* and process.command_line.text:*\\-featurename* and process.command_line.text:(*telnetserver* or *internet\\-explorer\\-optional\\-amd64* or *tftp* or *smb1protocol* or *client\\-projfs* or *microsoft\\-windows\\-subsystem\\-linux*))
<li><a href="#">query: (process.command_line.text:*esentutl* and process.command_line.text:*\\ \\/p*)
<li><a href="#">query: (process.command_line.text:*extrac32.exe* and process.command_line.text:*.cab* and (process.command_line.text:/:/ or process.command_line.text:/[/ or process.command_line.text:/^/ or process.command_line.text:/\\/ or process.command_line.text:/\\/ or process.command_line.text:/]/))
<li><a href="#">query: (process.command_line.text:*frombase64string* and process.command_line.text:*memorystream* and process.command_line.text:*h4si*)
<li><a href="#">query: (process.command_line.text:*hklm\\\\system\\\\currentcontrolset\\\\control\\\\lsa* and process.command_line.text:*scecli\\\\0\\** and process.command_line.text:*reg\\ add*)
<li><a href="#">query: (process.command_line.text:*import\\-certificate* and process.command_line.text:*\\ \\-file\\-path\\ * and process.command_line.text:*cert\\:\\\\localmachine\\\\root* and process.command_line.text:(*\\\\appdata\\\\local\\\\temp\\\\* or *\\:\\\\windows\\\\temp\\\\* or *\\\\desktop\\\\* or *\\\\downloads\\\\* or *\\\\perflogs\\\\* or *\\:\\\\users\\\\public\\\\*))
<li><a href="#">query: (process.command_line.text:*infdefaultinstall.exe\\ * and process.command_line.text:*.inf*)
<li><a href="#">query: (process.command_line.text:*invoke\\-athremotefxvgpudisablementcommand\\ * and process.command_line.text:(*\\-modulename\\ * or *\\-modulepath\\ * or *\\-scriptblock\\ * or *\\-remotefxvgpudisablementfilepath*))
<li><a href="#">query: (process.command_line.text:*launch\\-vsdevshell.ps1* and process.command_line.text:(*vswherepath\\ * or *vsinstallationpath\\ *))
<li><a href="#">query: (process.command_line.text:*net.webclient* and process.command_line.text:(*.downloadfile\\(* or *.downloadstring\\(*))
<li><a href="#">query: (process.command_line.text:*new\\-object* and process.command_line.text:*text.encoding\\]\\:\\:ascii* and process.command_line.text:(*system.io.compression.deflatestream* or *system.io.streamreader* or *readtoend\\(*))
<li><a href="#">query: (process.command_line.text:*powershell* and process.command_line.text:*nslookup* and process.command_line.text:(*\\-q\\=txt* or *\\-querytype\\=txt*))
<li><a href="#">query: (process.command_line.text:*process\\ * and process.command_line.text:*call\\ * and process.command_line.text:*create\\ * and process.command_line.text:(*rundll32* or *bitsadmin* or *regsvr32* or *cmd.exe\\ \\/c\\ * or *cmd.exe\\ \\/k\\ * or *powershell* or *pwsh* or *certutil* or *cscript* or *wscript* or *mshta* or *\\\\users\\\\public\\\\* or *\\\\windows\\\\temp\\\\* or *\\\\appdata\\\\local\\\\* or *%temp%* or *%programdata%* or *%appdata%* or *%comspec%* or *%localappdata%*))
<li><a href="#">query: (process.command_line.text:*reg* and process.command_line.text:*\\ add\\ * and process.command_line.text:*\\\\services\\\\vss\\\\diag* and process.command_line.text:*\\/d\\ disabled*)
<li><a href="#">query: (process.command_line.text:*reg* and process.command_line.text:*\\ add\\ * and process.command_line.text:*software\\\\microsoft\\\\windows\\\\currentversion\\\\run*)
<li><a href="#">query: (process.command_line.text:*reg* and process.command_line.text:*add* and process.command_line.text:*\\\\software\\\\policies\\\\microsoft\\\\fve* and process.command_line.text:*\\/v* and process.command_line.text:*\\/f* and process.command_line.text:(*enablebdewithnotpm* or *useadvancedstartup* or *usetpm* or *usetpmkey* or *usetpmkeypin* or *recoverykeymessagesource* or *usetpmpin* or *recoverykeymessage*))
<li><a href="#">query: (process.command_line.text:*reg\\ add* and process.command_line.text:*\\\\system\\\\currentcontrolset\\\\control* and process.command_line.text:*write\\ protection* and process.command_line.text:*0* and process.command_line.text:(*storage* or *storagedevicepolicies*))
<li><a href="#">query: (process.command_line.text:*remove\\-mppreference* and process.command_line.text:(*\\-controlledfolderaccessprotectedfolders\\ * or *\\-attacksurfacereductionrules_ids\\ * or *\\-attacksurfacereductionrules_actions\\ * or *\\-checkforsignaturesbeforerunningscan\\ *))
<li><a href="#">query: (process.command_line.text:*root* and ((process.executable.text:*\\\\certutil.exe and process.command_line.text:*\\-addstore*) or (process.executable.text:*\\\\certmgr.exe and process.command_line.text:*\\/add*)))
<li><a href="#">query: (process.command_line.text:*rundll32.exe* and process.command_line.text:(*.sys,* or *.sys\\ *))
<li><a href="#">query: (process.command_line.text:*rundll32.exe* and process.command_line.text:*execute* and process.command_line.text:*regread* and process.command_line.text:*window.close*)
<li><a href="#">query: (process.command_line.text:*set\\-mppreference* and (process.command_line.text:(*disablerealtimemonitoring\\ 1* or *disablebehaviormonitoring\\ 1* or *disablescriptscanning\\ 1* or *disablearchivescanning\\ 1* or *disableblockatfirstseen\\ 1* or *disableioavprotection\\ 1* or *disableintrusionpreventionsystem\\ 1* or *disableremovabledrivescanning\\ 1* or *disablescanningmappednetworkdrivesforfullscan\\ 1* or *disablescanningnetworkfiles\\ 1* or *disablerealtimemonitoring\\ $true* or *disablebehaviormonitoring\\ $true* or *disablescriptscanning\\ $true* or *disablearchivescanning\\ $true* or *disableblockatfirstseen\\ $true* or *disableioavprotection\\ $true* or *disableintrusionpreventionsystem\\ $true* or *disableremovabledrivescanning\\ $true* or *disablescanningmappednetworkdrivesforfullscan\\ $true* or *disablescanningnetworkfiles\\ $true*) or (process.command_line.text:*allow* and process.command_line.text:(*lowthreatdefaultaction* or *moderatethreatdefaultaction* or *highthreatdefaultaction*))))
<li><a href="#">query: (process.command_line.text:*shellexec_rundll* and process.command_line.text:(*regsvr32* or *msiexec* or *\\\\users\\\\public\\\\* or *odbcconf* or *\\\\desktop\\\\* or *\\\\temp\\\\* or *invoke\\-* or *iex* or *comspec*))
<li><a href="#">query: (process.command_line.text:*txt\\:* and ((process.command_line.text:*type\\ * and process.command_line.text:*\\ >\\ *) or (process.command_line.text:*makecab\\ * and process.command_line.text:*.cab*) or (process.command_line.text:*reg\\ * and process.command_line.text:*\\ export\\ *) or (process.command_line.text:*regedit\\ * and process.command_line.text:*\\ \\/e\\ *) or (process.command_line.text:*esentutl\\ * and process.command_line.text:*\\ \\/y\\ * and process.command_line.text:*\\ \\/d\\ * and process.command_line.text:*\\ \\/o\\ *)))
<li><a href="#">query: (process.command_line.text:*whoami* and ((process.command_line.text:(*.\\/client\\/common\\/* or *.\\\\client\\\\common\\\\*)) or (process.command_line.text:*c\\:\\\\windows\\\\temp\\\\serv\\-u.bat*)))
<li><a href="#">query: (process.command_line.text:*winrm* and process.command_line.text:(*format\\:pretty* or *format\\:\\\"pretty\\\"* or *format\\:\\\"text\\\"* or *format\\:text*) and (not (process.executable.text:(c\\:\\\\windows\\\\system32\\\\* or c\\:\\\\windows\\\\syswow64\\\\*))))
<li><a href="#">query: (process.command_line.text:*wmic* and ((process.command_line.text:*product\\ where\\ * and process.command_line.text:*call\\ uninstall* and process.command_line.text:*\\/nointeractive*) or (process.command_line.text:*caption\\ like\\ * and process.command_line.text:(*call\\ delete* or *call\\ terminate*))) and process.command_line.text:(*antivirus* or *avg\\ * or *crowdstrike\\ sensor* or *dlp\\ endpoint* or *endpoint\\ detection* or *endpoint\\ protection* or *endpoint\\ security* or *endpoint\\ sensor* or *eset\\ file\\ security* or *malwarebytes* or *mcafee\\ agent* or *microsoft\\ security\\ client* or *threat\\ protection* or *virusscan* or *webroot\\ secureanywhere* or *windows\\ defender* or *carbonblack* or *carbon\\ black* or *cb\\ defense\\ sensor\\ 64\\-bit* or *dell\\ threat\\ defense* or *cylance\\ * or *logrhythm\\ system\\ monitor\\ service* or *sophos\\ anti\\-virus* or *sophos\\ autoupdate* or *sophos\\ management\\ console* or *sophos\\ management\\ database* or *sophos\\ credential\\ store* or *sophos\\ update\\ manager* or *sophos\\ management\\ server* or *sophos\\ remote\\ management\\ system* or *%sophos%* or *%carbon%* or *%cylance%* or *%eset%* or *%symantec%*))
<li><a href="#">query: (process.command_line.text:/\\.[a-za-z0-9]{1,6}\\.[ |\"|']{0,1}/ and (not (process.command_line.text:/\\.[a-za-z0-9]{1,6}\\.[a-za-z0-9]{1}/)))
<li><a href="#">query: (process.command_line:(*.dll or *.csproj) and process.executable:*\\\\dotnet.exe)
<li><a href="#">query: (process.command_line:(*.doc* or *.docx* or *.xls* or *.xlsx* or *.ppt* or *.pptx* or *.rtf* or *.pdf* or *.txt*) and ((process.command_line:*dir\\ * and process.command_line:*\\ \\/b\\ * and process.command_line:*\\ \\/s\\ *) or (winlog.event_data.originalfilename:\"findstr.exe\" and process.command_line:(*\\ \\/e\\ * or *\\ \\/si\\ *))))
<li><a href="#">query: (process.command_line:(*\\ \\/am51* or *\\ \\/password*) and (not ((process.command_line:*\\ \\/passwordchg* or process.parent.executable:(\"c\\:\\\\program\\ files\\\\ceetis\\\\ceetis_ide.exe\" or \"c\\:\\\\program\\ files\\ \\(x86\\)\\\\ceetis\\\\ceetis_ide.exe\")))))
<li><a href="#">query: (process.command_line:(*\\ \\-decode\\ * or *\\ \\-decodehex\\ * or *\\ \\-urlcache\\ * or *\\ \\-verifyctl\\ * or *\\ \\-encode\\ * or *\\ \\/decode\\ * or *\\ \\/decodehex\\ * or *\\ \\/urlcache\\ * or *\\ \\/verifyctl\\ * or *\\ \\/encode\\ *) or (process.executable:*\\\\certutil.exe and process.command_line:(*url* or *ping*)))
<li><a href="#">query: (process.command_line:(*\\ \\-version\\ 2\\ * or *\\ \\-versio\\ 2\\ * or *\\ \\-versi\\ 2\\ * or *\\ \\-vers\\ 2\\ * or *\\ \\-ver\\ 2\\ * or *\\ \\-ve\\ 2\\ *) and process.executable:*\\\\powershell.exe)
<li><a href="#">query: (process.command_line:(*\\ pass\\ * or *\\ user\\ * or *\\ copy\\ * or *\\ mega\\ * or *\\ sync\\ * or *\\ config\\ * or *\\ lsd\\ * or *\\ remote\\ * or *\\ ls\\ *) and (winlog.event_data.description:\"rsync\\ for\\ cloud\\ storage\" or (process.executable:*\\\\rclone.exe and process.parent.executable:(*\\\\powershell.exe or *\\\\cmd.exe))))
<li><a href="#">query: (process.command_line:(*\\ tcp\\ 139* or *\\ tcp\\ 445* or *\\ tcp\\ 3389* or *\\ tcp\\ 5985* or *\\ tcp\\ 5986*) or (process.command_line:*\\ start\\ * and process.command_line:*\\-\\-all* and process.command_line:*\\-\\-config* and process.command_line:*.yml*) or (process.executable:*ngrok.exe and process.command_line:(*\\ tcp\\ * or *\\ http\\ * or *\\ authtoken\\ *)))
<li><a href="#">query: (process.command_line:(*\\/exefilename* or *\\/commandline*) and (process.command_line:(*\\ \\/runas\\ 8\\ * or *\\ \\/runas\\ 4\\ * or *\\ \\/runas\\ 10\\ * or *\\ \\/runas\\ 11\\ *) or process.command_line:(*\\/runas\\ 8 or *\\/runas\\ 4 or *\\/runas\\ 10 or *\\/runas\\ 11)))
<li><a href="#">query: (process.command_line:(*\\/exefilename* or *\\/commandline*) and (process.command_line:(*\\ \\/runas\\ 8\\ * or *\\ \\/runas\\ 4\\ *) or process.command_line:(*\\/runas\\ 8 or *\\/runas\\ 4)))
<li><a href="#">query: (process.command_line:(*\\\\trolleyexpress\\ 7* or *\\\\trolleyexpress\\ 8* or *\\\\trolleyexpress\\ 9* or *\\\\trolleyexpress.exe\\ 7* or *\\\\trolleyexpress.exe\\ 8* or *\\\\trolleyexpress.exe\\ 9* or *\\\\trolleyexpress.exe\\ \\-ma\\ *) or (process.executable:*\\\\trolleyexpress.exe and (not ((winlog.event_data.originalfilename:*ctxinstall*) or (not _exists_:winlog.event_data.originalfilename)))))
<li><a href="#">query: (process.command_line:(*\\=\\[char\\]\\[byte\\]\\('0x'\\+* or *\\ \\-work\\ worker0\\ \\-path\\ *) or (process.parent.command_line:*dllhost.exe\\ \\/processid\\:\\{3e5fc7f9\\-9a51\\-4367\\-9063\\-a120244fbec7\\}* and process.executable:*\\\\appdata\\\\local\\\\temp\\\\*))
<li><a href="#">query: (process.command_line:(*\\-i* or *\\/install* or *\\-a* or *\\/add\\-driver* or *.inf*) and process.executable:*\\\\pnputil.exe)
<li><a href="#">query: (process.command_line:(*7z.exe* or *7za.exe*) and process.command_line:*\\ \\-p* and process.command_line:(*\\ a\\ * or *\\ u\\ *))
<li><a href="#">query: (process.command_line:(*add\\-mppreference\\ * or *set\\-mppreference\\ *) and process.command_line:(*\\ \\-exclusionpath\\ * or *\\ \\-exclusionextension\\ * or *\\ \\-exclusionprocess\\ * or *\\ \\-exclusionipaddress\\ *))
<li><a href="#">query: (process.command_line:(*c\\:\\\\windows\\\\cert.exe* or *del\\ \\/q\\ \\/f\\ c\\:\\\\kworking\\\\agent.crt* or *kaseya\\ vsa\\ agent\\ hot\\-fix* or *\\\\appdata\\\\local\\\\temp\\\\msmpeng.exe* or *rmdir\\ \\/s\\ \\/q\\ %systemdrive%\\\\inetpub\\\\logs* or *del\\ \\/s\\ \\/q\\ \\/f\\ %systemdrive%\\\\*.log* or *c\\:\\\\kworking1\\\\agent.exe* or *c\\:\\\\kworking1\\\\agent.crt*) or process.executable:(\"c\\:\\\\windows\\\\msmpeng.exe\" or \"c\\:\\\\windows\\\\cert.exe\" or \"c\\:\\\\kworking\\\\agent.exe\" or \"c\\:\\\\kworking1\\\\agent.exe\") or (process.command_line:*del\\ \\/s\\ \\/q\\ \\/f* and process.command_line:*webpages\\\\errors\\\\weberrorlog.txt*))
<li><a href="#">query: (process.command_line:(*c\\:\\\\windows\\\\cert.exe* or *set\\-mppreference\\ \\-disablerealtimemonitoring\\ $true\\ \\-disableintrusionpreventionsystem\\ $true\\ \\-disableioavprotection\\ $true\\ \\-disablescriptscanning\\ $true\\ \\-enablecontrolledfolderaccess\\ disabled\\ \\-enablenetworkprotection\\ auditmode\\ \\-force\\ \\-mapsreporting\\ disabled* or *del\\ \\/q\\ \\/f\\ c\\:\\\\kworking\\\\agent.crt* or *kaseya\\ vsa\\ agent\\ hot\\-fix* or *\\\\appdata\\\\local\\\\temp\\\\msmpeng.exe* or *rmdir\\ \\/s\\ \\/q\\ %systemdrive%\\\\inetpub\\\\logs* or *del\\ \\/s\\ \\/q\\ \\/f\\ %systemdrive%\\\\*.log* or *c\\:\\\\kworking1\\\\agent.exe* or *c\\:\\\\kworking1\\\\agent.crt*) and process.executable:(\"c\\:\\\\windows\\\\msmpeng.exe\" or \"c\\:\\\\windows\\\\cert.exe\" or \"c\\:\\\\kworking\\\\agent.exe\" or \"c\\:\\\\kworking1\\\\agent.exe\"))
<li><a href="#">query: (process.command_line:(*cmd.exe\\ \\/q\\ \\/c\\ *\\ 1>\\ \\\\\\\\*\\\\*\\\\*\\ 2>&1 or *cmd.exe\\ \\/c\\ *\\ >\\ \\\\\\\\*\\\\*\\\\*\\ 2>&1 or *cmd.exe\\ \\/c\\ *\\ >\\ *\\\\temp\\\\*\\ 2>&1) and process.command_line:(*powershell.exe\\ \\-exec\\ bypass\\ \\-noni\\ \\-nop\\ \\-w\\ 1\\ \\-c\\ \\\"* or *powershell.exe\\ \\-noni\\ \\-nop\\ \\-w\\ 1\\ \\-enc\\ *))
<li><a href="#">query: (process.command_line:(*copy\\ procdump* or *move\\ procdump*) or (process.command_line:*copy\\ * and process.command_line:*.dmp\\ * and process.command_line:(*2.dmp* or *lsass* or *out.dmp*)) or process.command_line:(*copy\\ lsass.exe_* or *move\\ lsass.exe_*))
<li><a href="#">query: (process.command_line:(*dir\\ * or *findstr\\ *) and process.command_line:(*.key* or *.pgp* or *.gpg* or *.ppk* or *.p12* or *.pem* or *.pfx* or *.cer* or *.p7b* or *.asc*))
<li><a href="#">query: (process.command_line:(*dll,mystart* or *dll\\ mystart*) or (process.command_line:*\\ mystart and process.command_line:*rundll32.exe*))
<li><a href="#">query: (process.command_line:(*echo* or *copy* or *type* or *file\\ createnew* or *cacls*) and process.command_line:*c\\:\\\\windows\\\\fonts\\\\* and process.command_line:(*.sh* or *.exe* or *.dll* or *.bin* or *.bat* or *.cmd* or *.js* or *.msh* or *.reg* or *.scr* or *.ps* or *.vb* or *.jar* or *.pl* or *.inf* or *.cpl* or *.hta* or *.msi* or *.vbs*))
<li><a href="#">query: (process.command_line:(*echo\\ * or *copy\\ * or *type\\ * or *file\\ createnew*) and process.command_line:(*\\ c\\:\\\\windows\\\\system32\\\\tasks\\\\* or *\\ c\\:\\\\windows\\\\syswow64\\\\tasks\\\\*))
<li><a href="#">query: (process.command_line:(*for\\ * or *foreach\\ *) and process.command_line:(*nslookup* or *ping*))
<li><a href="#">query: (process.command_line:(*objectcategory* or *trustdmp* or *dcmodes* or *dclist* or *computers_pwdnotreqd*) and process.executable:*\\\\adfind.exe)
<li><a href="#">query: (process.command_line:(*ojpgcm9tqmfzzty0u3ryaw5n* or *o6rnjvbujhc2u2nfn0cmluz* or *6okzyb21cyxnlnjrtdhjpbm*) or process.command_line:(*oga6aeyacgbvag0aqgbhahmazqa2adqauwb0ahiaaqbuagca* or *oaogbgahiabwbtaeiayqbzaguanga0afmadabyagkabgbna* or *6adoargbyag8abqbcageacwbladyanabtahqacgbpag4azw*))
<li><a href="#">query: (process.command_line:(*powershell.exe* or *\\\\powershell* or *\\\\pwsh* or *pwsh.exe*) and process.command_line:*\\/c\\ * and process.command_line:*\\\\appdata\\\\* and process.command_line:(*local\\\\* or *roaming\\\\*))
<li><a href="#">query: (process.command_line:(*powershell.exe* or *\\\\powershell*) and process.command_line:*\\/c\\ * and process.command_line:*\\\\appdata\\\\* and process.command_line:(*local\\\\* or *roaming\\\\*))
<li><a href="#">query: (process.command_line:(*psexec* or *paexec* or *accepteula* or *cmd\\ \\/c\\ *) and process.command_line:*\\ \\-s\\ cmd.exe)
<li><a href="#">query: (process.command_line:(*reg.exe\\ save\\ hklm\\\\sam\\ %temp%\\\\\\~reg_sam.save* or *1q2w3e4r@#$@#$@#$* or *\\ \\-hp1q2w3e4\\ * or *.dat\\ data03\\ 10000\\ \\-p\\ *) or (process.command_line:*process\\ call\\ create* and process.command_line:*\\ >\\ %temp%\\\\\\~*) or (process.command_line:*netstat\\ \\-aon\\ |\\ find\\ * and process.command_line:*\\ >\\ %temp%\\\\\\~*) or process.command_line:*.255\\ 10\\ c\\:\\\\programdata\\\\*)
<li><a href="#">query: (process.command_line:(*regsvr32* or *rundll32* or *msiexec* or *mshta* or *verclsid*) and (process.executable:*\\\\wbem\\\\wmic.exe or process.command_line:*wmic\\ *) and process.parent.executable:(*\\\\winword.exe or *\\\\excel.exe or *\\\\powerpnt.exe) and (process.command_line:*process* and process.command_line:*create* and process.command_line:*call*))
<li><a href="#">query: (process.command_line:(*sqlcmd\\ * or *sqlcmd.exe*) and process.command_line:*\\ \\-s\\ localhost\\ * and process.command_line:(*sys.sysprocesses* or *master.dbo.sysdatabases* or *backup\\ database*))
<li><a href="#">query: (process.command_line:(*stop\\-service\\ * or *remove\\-service\\ *) and process.command_line:(*\\ mcafeedlpagentservice* or *\\ trend\\ micro\\ deep\\ security\\ manager* or *\\ tmbmserver*))
<li><a href="#">query: (process.command_line:(*suvyichb* or *lfwcaow* or *jrvggkf* or *awv4ichb* or *llecaow* or *pzxggkf* or *awv4ichozx* or *llecaotmv3* or *pzxggke5ld* or *suvyichozx* or *lfwcaotmv3* or *jrvggke5ld*) or process.command_line:(*sqbfafgaiaaoafsa* or *karqbyacaakabba* or *jaeuawaagacgaww* or *aqblahgaiaaoafsa* or *kazqb4acaakabba* or *paguaeaagacgaww* or *aqblahgaiaaoae4azqb3a* or *kazqb4acaakaboaguadw* or *paguaeaagacgatgblahca* or *sqbfafgaiaaoae4azqb3a* or *karqbyacaakaboaguadw* or *jaeuawaagacgatgblahca*))
<li><a href="#">query: (process.command_line:(*temp\\\\wtask.exe\\ \\/create* or *%windir\\:\\~\\-3,1%%public\\:\\~\\-9,1%* or *\\/tn\\ \\\"security\\ script\\ * or *%windir\\:\\~\\-1,1%*) or (process.command_line:*\\/e\\:vbscript* and process.command_line:*c\\:\\\\users\\\\* and process.command_line:*.txt* and process.command_line:*\\/f*) or process.executable:*temp\\\\winwsh.exe)
<li><a href="#">query: (process.command_line:(*tracert\\ \\-h\\ 10\\ yahoo.com* or *.wsqmcons\\)\\)|iex;* or *fr`omba`se6`4str`ing*) or (process.command_line:*net\\ use\\ https\\:\\/\\/docs.live.net* and process.command_line:*@aol.co.uk*))
<li><a href="#">query: (process.command_line:(*vboxrt.dll,rtr3init* or *vboxc.dll* or *vboxdrv.sys*) or process.command_line:(*startvm* or *controlvm*))
<li><a href="#">query: (process.command_line:(*winzip.exe* or *winzip64.exe*) and process.command_line:*\\-s\\\"* and process.command_line:(*\\ \\-min\\ * or *\\ \\-a\\ *))
<li><a href="#">query: (process.command_line:(*ˣ* or *˪* or *ˢ*) or process.command_line:(*∕* or *⁄*) or process.command_line:(*―* or *—*))
<li><a href="#">query: (process.command_line:(*xyz123456.exe* or *purplesharp*) or winlog.event_data.originalfilename:\"purplesharp.exe\")
<li><a href="#">query: (process.command_line:* and (not (process.command_line:c\\:\\\\windows\\\\system32\\\\windowspowershell\\\\v1.0\\\\powershell.exe* or contextinfo:*citrix\\\\configsync\\\\configsync.ps1*)))
<li><a href="#">query: (process.command_line:*.settingcontent\\-ms* and (not (process.command_line:*immersivecontrolpanel*)))
<li><a href="#">query: (process.command_line:*.zip* and ((process.command_line:*\\/generic\\:microsoft_windows_shell_zipfolder\\:filename\\=* and process.command_line:*\\/pass\\:* and process.command_line:*\\/user\\:*) or (process.command_line:*\\/delete* and process.command_line:*microsoft_windows_shell_zipfolder\\:filename\\=*)))
<li><a href="#">query: (process.command_line:*\\  or imagename:*\\ )
<li><a href="#">query: (process.command_line:*\\ \\/account\\=system\\ * and process.command_line:*\\/exec\\=*)
<li><a href="#">query: (process.command_line:*\\ \\/injectrunning* and process.command_line:*.dll* and winlog.event_data.originalfilename:*mavinject*)
<li><a href="#">query: (process.command_line:*\\ \\/s* and process.command_line:*\\ \\/u* and process.command_line:(*\\ \\/i\\:http\\:\\/\\/1* or *\\ \\/i\\:http\\:\\/\\/2* or *\\ \\/i\\:http\\:\\/\\/3* or *\\ \\/i\\:http\\:\\/\\/4* or *\\ \\/i\\:http\\:\\/\\/5* or *\\ \\/i\\:http\\:\\/\\/6* or *\\ \\/i\\:http\\:\\/\\/7* or *\\ \\/i\\:http\\:\\/\\/8* or *\\ \\/i\\:http\\:\\/\\/9*))
<li><a href="#">query: (process.command_line:*\\ \\/vss\\ * and process.command_line:*\\ \\/y\\ *)
<li><a href="#">query: (process.command_line:*\\ \\-\\-adcs\\ * and process.command_line:*\\ \\-\\-port\\ *)
<li><a href="#">query: (process.command_line:*\\ \\-hp* and process.command_line:(*\\ \\-m* or *\\ a\\ *))
<li><a href="#">query: (process.command_line:*\\ \\-ma\\ * and (process.command_line:*\\ lsass* or process.command_line:*\\ ls*))
<li><a href="#">query: (process.command_line:*\\ \\-ma\\ * and process.command_line:*\\ \\-accepteula\\ *)
<li><a href="#">query: (process.command_line:*\\ \\-t\\ msi\\-install\\ * and process.command_line:*\\ \\-i\\ http*)
<li><a href="#">query: (process.command_line:*\\ msiexec* and process.command_line:*\\:\\/\\/*)
<li><a href="#">query: (process.command_line:*\\ save\\ * and process.command_line:(*hklm\\\\sam* or *hklm\\\\system* or *hklm\\\\security*))
<li><a href="#">query: (process.command_line:*\\&&* and process.command_line:*rundll32* and process.command_line:*shell32.dll* and process.command_line:*shellexec_rundll* and process.command_line:(*value* or *invoke* or *comspec* or *iex*))
<li><a href="#">query: (process.command_line:*\\/fullmemdmp* and (process.executable:*\\\\rdrleakdiag.exe or (process.command_line:*\\ \\/o\\ * and process.command_line:*\\ \\/p\\ *)))
<li><a href="#">query: (process.command_line:*\\/i\\:%appdata%\\\\logs.txt\\ scrobj.dll and (process.executable:*\\\\cutil.exe or winlog.event_data.description:\"microsoft\\(c\\)\\ registerserver\"))
<li><a href="#">query: (process.command_line:*\\/in\\:* and process.command_line:*\\/out\\:* and process.executable:*\\\\datasvcutil.exe)
<li><a href="#">query: (process.command_line:*\\\"\\\\system32\\\\cleanmgr.exe\\ \\/autoclean\\ \\/d\\ c\\: and process.parent.command_line:\"c\\:\\\\windows\\\\system32\\\\svchost.exe\\ \\-k\\ netsvcs\\ \\-p\\ \\-s\\ schedule\" and integritylevel:(\"high\" or \"system\"))
<li><a href="#">query: (process.command_line:*\\\\\\\\\\?\\\\globalroot\\\\device\\\\harddiskvolumeshadowcopy* and process.command_line:(*\\\\ntds.dit* or *\\\\system* or *\\\\security* or *c\\:\\\\tmp\\\\log*))
<li><a href="#">query: (process.command_line:*\\\\calc.exe\\ * or (process.executable:*\\\\calc.exe and (not (process.executable:*\\\\windows\\\\sys*))))
<li><a href="#">query: (process.command_line:*\\\\cl_mutexverifiers.ps1* and process.command_line:*runaftercancelprocess\\ *)
<li><a href="#">query: (process.command_line:*\\\\currentversion\\\\image\\ file\\ execution\\ options\\\\* and process.command_line:(*sethc.exe* or *utilman.exe* or *osk.exe* or *magnify.exe* or *narrator.exe* or *displayswitch.exe* or *atbroker.exe*))
<li><a href="#">query: (process.command_line:*\\\\harddiskvolumeshadowcopy* and process.command_line:*ystem32\\\\config\\\\sam* and process.command_line:(*copy\\-item* or *cp\\ $_.* or *cpi\\ $_.* or *copy\\ $_.* or *.file\\]\\:\\:copy\\(*))
<li><a href="#">query: (process.command_line:*\\-\\-install* and process.command_line:*\\-\\-start\\-with\\-win* and process.command_line:*\\-\\-silent*)
<li><a href="#">query: (process.command_line:*\\\\syncappvpublishingserver.vbs* and process.command_line:*;*)
<li><a href="#">query: (process.command_line:*\\\\syncappvpublishingserver.vbs* and process.command_line:*\\\"\\\\n;*)
<li><a href="#">query: (process.command_line:*\\\\sysvol\\\\* and process.command_line:*\\\\policies\\\\*)
<li><a href="#">query: (process.command_line:*\\\\windowssensor.exe* and process.command_line:*\\ \\/uninstall* and process.command_line:*\\ \\/quiet*)
<li><a href="#">query: (process.command_line:*\\-autoreconnect\\ * and process.command_line:*\\-connect\\ * and process.command_line:*\\-id\\:*)
<li><a href="#">query: (process.command_line:*\\-executionpolicy\\ * and process.command_line:(*unrestricted* or *bypass* or *remotesigned*))
<li><a href="#">query: (process.command_line:*\\-m\\ * and process.command_line:*\\-net\\ * and process.command_line:*\\-size\\ * and process.command_line:*\\-nomutex\\ * and process.command_line:*\\-p\\ \\\\\\* and process.command_line:*$*)
<li><a href="#">query: (process.command_line:*\\-noni* and process.command_line:*\\-ep* and process.command_line:*bypass* and process.command_line:*$*)
<li><a href="#">query: (process.command_line:*\\-u\\ * and process.command_line:*\\-p\\ * and process.command_line:(*\\^user\\^* or *\\^pass\\^*))
<li><a href="#">query: (process.command_line:*7za.exe* and process.command_line:*\\\\c$\\\\temp\\\\log.zip*)
<li><a href="#">query: (process.command_line:*aaaayinlm* and process.command_line:(*oicaaaayinlm* or *oijaaaayinlm*))
<li><a href="#">query: (process.command_line:*activescripteventconsumer* and process.command_line:*\\ create\\ *)
<li><a href="#">query: (process.command_line:*appvlp.exe* and process.command_line:(*cmd.exe* or *powershell.exe* or *pwsh.exe*) and process.command_line:(*.sh* or *.exe* or *.dll* or *.bin* or *.bat* or *.cmd* or *.js* or *.msh* or *.reg* or *.scr* or *.ps* or *.vb* or *.jar* or *.pl* or *.inf*))
<li><a href="#">query: (process.command_line:*appvlp.exe* and process.command_line:(*cmd.exe* or *powershell.exe*) and process.command_line:(*.sh* or *.exe* or *.dll* or *.bin* or *.bat* or *.cmd* or *.js* or *.msh* or *.reg* or *.scr* or *.ps* or *.vb* or *.jar* or *.pl* or *.inf*))
<li><a href="#">query: (process.command_line:*bash.exe* and process.command_line:*\\-c\\ *)
<li><a href="#">query: (process.command_line:*bitsadmin* and ((process.command_line:*\\/setnotifycmdline* and process.command_line:(*%comspec%* or *cmd.exe* or *regsvr32.exe*)) or (process.command_line:*\\/addfile* and process.command_line:(*http\\:* or *https\\:* or *ftp\\:* or *ftps\\:*))))
<li><a href="#">query: (process.command_line:*cl_invocation.ps1* and process.command_line:*syncinvoke*)
<li><a href="#">query: (process.command_line:*cl_mutexverifiers.ps1* and process.command_line:*runaftercancelprocess*)
<li><a href="#">query: (process.command_line:*cmd* and process.command_line:*\\/c* and process.command_line:*assoc*)
<li><a href="#">query: (process.command_line:*cmd.exe* and process.command_line:*&1* and ((process.parent.executable:(*\\\\wmiprvse.exe or *\\\\mmc.exe or *\\\\explorer.exe or *\\\\services.exe) and process.command_line:*\\/q* and process.command_line:*\\/c* and process.command_line:*\\\\\\\\127.0.0.1\\\\*) or (process.parent.command_line:(*svchost.exe\\ \\-k\\ netsvcs* or *taskeng.exe*) and process.command_line:*\\/c* and process.command_line:*windows\\\\temp\\\\*)))
<li><a href="#">query: (process.command_line:*compress\\-archive\\ * and process.command_line:*\\ \\-path\\ * and process.command_line:*\\ \\-destinationpath\\ * and process.command_line:*$env\\:temp\\\\*)
<li><a href="#">query: (process.command_line:*configsecuritypolicy.exe* and process.command_line:(*https\\:\\/\\/* or *http\\:\\/\\/* or *ftp\\:\\/\\/*))
<li><a href="#">query: (process.command_line:*conhost.exe* and process.command_line:*0xffffffff* and process.command_line:*\\-forcev1*)
<li><a href="#">query: (process.command_line:*cscript* and process.command_line:*manage\\-bde.wsf*)
<li><a href="#">query: (process.command_line:*cscript.exe* and process.command_line:*gathernetworkinfo.vbs*)
<li><a href="#">query: (process.command_line:*curl* and process.command_line:*\\ start\\ *)
<li><a href="#">query: (process.command_line:*cyzfc.dat,* and process.command_line:*pointfunctioncall)
<li><a href="#">query: (process.command_line:*diantz.exe* and process.command_line:*.cab* and process.command_line:/:[^\\\\\\\\]/)
<li><a href="#">query: (process.command_line:*diantz.exe* and process.command_line:*\\ \\\\\\* and process.command_line:*.cab*)
<li><a href="#">query: (process.command_line:*dir\\ * and process.command_line:*\\ \\/s* and process.command_line:*\\ \\/b*)
<li><a href="#">query: (process.command_line:*e\\=access&* and process.command_line:*y\\=guest&* and process.command_line:*&p\\=* and process.command_line:*&c\\=* and process.command_line:*&k\\=*)
<li><a href="#">query: (process.command_line:*elevatecmd* and process.command_line:*runassystem*)
<li><a href="#">query: (process.command_line:*enableunsafeclientmailrules* or (process.parent.executable:*\\\\outlook.exe and process.command_line:*\\\\\\\\\\* and process.command_line:*\\\\\\* and process.command_line:*.exe*))
<li><a href="#">query: (process.command_line:*eprod.ldf or process.command_line:(*\\\\ldifde.exe\\ \\-f\\ \\-n\\ * or *\\\\7za.exe\\ a\\ 1.7z\\ * or *\\\\aaaa\\\\procdump64.exe* or *\\\\aaaa\\\\netsess.exe* or *\\\\aaaa\\\\7za.exe* or *copy\\ .\\\\1.7z\\ \\\\* or *copy\\ \\\\client\\\\c$\\\\aaaa\\\\*) or process.executable:\"c\\:\\\\users\\\\public\\\\7za.exe\")
<li><a href="#">query: (process.command_line:*esentutl* and process.command_line:*\\ \\/p*)
<li><a href="#">query: (process.command_line:*explorer.exe* and process.command_line:*\\ \\/root,*)
<li><a href="#">query: (process.command_line:*extrac32.exe* and process.command_line:*.cab* and process.command_line:(*\\/c* or *\\/y* or *\\ \\\\\\*))
<li><a href="#">query: (process.command_line:*extrac32.exe* and process.command_line:*.cab* and process.command_line:/:[^\\\\\\\\]/)
<li><a href="#">query: (process.command_line:*findstr* and ((process.command_line:*\\/v* and process.command_line:*\\/l*) or (process.command_line:*\\/s* and process.command_line:*\\/i*)))
<li><a href="#">query: (process.command_line:*get\\-wmiobject* and process.command_line:*\\ win32_shadowcopy* and process.command_line:(*delete\\(\\)* or *remove\\-wmiobject*))
<li><a href="#">query: (process.command_line:*hklm\\\\system\\\\currentcontrolset\\\\control\\\\lsa* and process.command_line:*scecli\\\\0* and process.command_line:*reg\\ add*)
<li><a href="#">query: (process.command_line:*http* and ((process.executable:*\\\\wmic.exe and process.command_line:*wmic* and process.command_line:*format*) or (winlog.event_data.imphash:(\"1b1a3f43bf37b5bfe60751f2ee2f326e\" or \"37777a96245a3c74eb217308f3546f4c\" or \"9d87c9d67ce724033c0b40cc4ca1b206\") and process.command_line:*format\\:*)))
<li><a href="#">query: (process.command_line:*infdefaultinstall.exe\\ * and process.command_line:*.inf*)
<li><a href="#">query: (process.command_line:*invoke\\-athremotefxvgpudisablementcommand\\ * and process.command_line:(*\\-modulename\\ * or *\\-modulepath\\ * or *\\-scriptblock\\ * or *\\-remotefxvgpudisablementfilepath*))
<li><a href="#">query: (process.command_line:*logman\\ * and process.command_line:(*stop\\ * or *delete\\ *) and process.command_line:*eventlog\\-system*)
<li><a href="#">query: (process.command_line:*microsoft\\\\windows\\\\currentversion\\\\run* and process.command_line:*c\\:\\\\users\\\\public\\\\*)
<li><a href="#">query: (process.command_line:*mklink* and process.command_line:*harddiskvolumeshadowcopy*)
<li><a href="#">query: (process.command_line:*net\\ * and process.command_line:*localgroup* and process.command_line:*remote\\ desktop\\ users* and process.command_line:*\\/add*)
<li><a href="#">query: (process.command_line:*netsh* and ((process.command_line:*firewall\\ add\\ portopening* and process.command_line:*tcp\\ 3389*) or (process.command_line:*advfirewall\\ firewall\\ add\\ rule* and process.command_line:*action\\=allow* and process.command_line:*protocol\\=tcp* and process.command_line:*localport\\=3389*)))
<li><a href="#">query: (process.command_line:*netsh* and process.command_line:*set* and ((process.command_line:*firewall* and process.command_line:*opmode* and process.command_line:*mode\\=disable*) or (process.command_line:*advfirewall* and process.command_line:*state* and process.command_line:*off*)))
<li><a href="#">query: (process.command_line:*netsh* and process.command_line:*trace* and process.command_line:*start*)
<li><a href="#">query: (process.command_line:*netsh\\ * and process.command_line:*advfirewall\\ * and process.command_line:*firewall\\ * and process.command_line:*show\\ * and process.command_line:*rule\\ * and process.command_line:*name\\=all*)
<li><a href="#">query: (process.command_line:*netsh\\ * and process.command_line:*show\\ * and process.command_line:*firewall\\ * and process.command_line:(*config\\ * or *state\\ * or *rule\\ * or *name\\=all*))
<li><a href="#">query: (process.command_line:*netstat* or (process.command_line:*net\\ * and (process.command_line:(*\\ use or *\\ sessions) or process.command_line:(*\\ use\\ * or *\\ sessions\\ *))))
<li><a href="#">query: (process.command_line:*new\\-mailboxexport* and process.command_line:*\\ \\-mailbox\\ * and process.command_line:*\\ \\-filepath\\ \\\\\\\\127.0.0.1\\\\c$*)
<li><a href="#">query: (process.command_line:*noconsentprompt* and process.command_line:*shadow\\:*)
<li><a href="#">query: (process.command_line:*nslookup* and process.command_line:*_ldap._tcp.dc._msdcs.*)
<li><a href="#">query: (process.command_line:*powershell* and process.command_line:*.downloadfile* and process.command_line:*system.net.webclient*)
<li><a href="#">query: (process.command_line:*powershell.exe* and process.command_line:(*join*split* or *\\(\\ $shellid\\[1\\]\\+$shellid\\[13\\]\\+'x'\\)* or *\\(\\ $pshome\\[*\\]\\+$pshome\\[*\\]\\+* or *\\(\\ $env\\:public\\[13\\]\\+$env\\:public\\[5\\]\\+'x'\\)* or *\\(\\ $env\\:comspec\\[4,*,25\\]\\-join''\\)* or *\\[1,3\\]\\+'x'\\-join''\\)*))
<li><a href="#">query: (process.command_line:*process\\ call\\ create* and process.command_line:*rundll32*)
<li><a href="#">query: (process.command_line:*reg* and ((process.command_line:*add* and process.command_line:*hkcu\\\\software\\\\classes\\\\ms\\-settings\\\\shell\\\\open\\\\command* and process.command_line:*\\/ve\\ * and process.command_line:*\\/d*) or (process.command_line:*add* and process.command_line:*hkcu\\\\software\\\\classes\\\\ms\\-settings\\\\shell\\\\open\\\\command* and process.command_line:*\\/v* and process.command_line:*delegateexecute*) or (process.command_line:*delete* and process.command_line:*hkcu\\\\software\\\\classes\\\\ms\\-settings*)))
<li><a href="#">query: (process.command_line:*reg* and process.command_line:*\\ add\\ * and process.command_line:*\\\\services\\\\vss\\\\diag* and process.command_line:*\\/d\\ disabled*)
<li><a href="#">query: (process.command_line:*reg* and process.command_line:*\\ add\\ * and process.command_line:*software\\\\microsoft\\\\windows\\\\currentversion\\\\run*)
<li><a href="#">query: (process.command_line:*reg* and process.command_line:*add* and process.command_line:*\\ \\/d\\ 4* and process.command_line:*\\ \\/v\\ start* and process.command_line:(*\\\\sense\\ * or *\\\\windefend* or *\\\\msmpsvc* or *\\\\nissrv* or *\\\\wdboot\\ * or *\\\\wdnisdrv* or *\\\\wdnissvc* or *\\\\wscsvc\\ * or *\\\\securityhealthservice* or *\\\\wuauserv* or *\\\\usosvc\\ *))
<li><a href="#">query: (process.command_line:*reg* and process.command_line:*add* and process.command_line:*hklm\\\\software\\\\policies\\\\microsoft\\\\fve* and process.command_line:*\\/v* and process.command_line:*\\/f* and process.command_line:(*enablebdewithnotpm* or *useadvancedstartup* or *usetpm* or *usetpmkey* or *usetpmkeypin* or *recoverykeymessagesource* or *usetpmpin* or *recoverykeymessage*))
<li><a href="#">query: (process.command_line:*regsvr32* and process.command_line:*\\/s* and process.command_line:*\\/i* and process.command_line:*\\\\appdata\\\\roaming\\\\* and process.command_line:*.ocx*)
<li><a href="#">query: (process.command_line:*root* and ((process.executable:*\\\\certutil.exe and process.command_line:*\\-addstore*) or (process.executable:*\\\\certmgr.exe and process.command_line:*\\/add*)))
<li><a href="#">query: (process.command_line:*rundll32* and ((process.command_line:*apphelp.dll* and process.command_line:(*shimflushcache* or *#250*)) or (process.command_line:*kernel32.dll* and process.command_line:(*baseflushappcompatcache* or *#46*))))
<li><a href="#">query: (process.command_line:*rundll32* and process.command_line:*mshtml,runhtmlapplication* and process.command_line:(*javascript\\:* or *vbscript\\:*))
<li><a href="#">query: (process.command_line:*rundll32.exe* and process.command_line:(*.sys,* or *.sys\\ *))
<li><a href="#">query: (process.command_line:*rundll32.exe* and process.command_line:*.dll* and process.command_line:*startnoderelay*)
<li><a href="#">query: (process.command_line:*rundll32.exe* and process.command_line:*.dll* and process.command_line:*startw*)
<li><a href="#">query: (process.command_line:*rundll32.exe* and process.command_line:*execute* and process.command_line:*regread* and process.command_line:*window.close*)
<li><a href="#">query: (process.command_line:*rundll32.exe* and process.command_line:*installarchersvc*)
<li><a href="#">query: (process.command_line:*rundll32.exe* and process.command_line:*shell32.dll* and process.command_line:*shellexec_rundll* and process.command_line:*powershell*)
<li><a href="#">query: (process.command_line:*schtasks* and process.command_line:*\\\\application\\ experience\\\\microsoft\\ compatibility\\ appraiser*)
<li><a href="#">query: (process.command_line:*schtasks* and process.command_line:*create* and process.command_line:*wscript* and process.command_line:*e\\:vbscript*)
<li><a href="#">query: (process.command_line:*set* and process.command_line:*\\&&* and process.command_line:*mshta* and process.command_line:*vbscript\\:createobject* and process.command_line:*.run* and process.command_line:*\\(window.close\\)*)
<li><a href="#">query: (process.command_line:*setup0.exe\\ \\-p* or (process.command_line:*setup.exe* and process.command_line:(*\\-x\\:0 or *\\-x\\:1 or *\\-x\\:2)))
<li><a href="#">query: (process.command_line:*system.management.automation.amsiutils* and process.command_line:*amsiinitfailed*)
<li><a href="#">query: (process.command_line:*system.net.webclient* and (process.command_line:*.downloadfile\\(* or process.command_line:*.downloadstring\\(*))
<li><a href="#">query: (process.command_line:*tasklist* or process.executable:\"c\\:\\\\windows\\\\system32\\\\tasklist.exe\")
<li><a href="#">query: (process.command_line:*transport\\=dt_socket,address\\=* and (not (process.command_line:*address\\=127.0.0.1* or process.command_line:*address\\=localhost*)))
<li><a href="#">query: (process.command_line:*txt\\:* and ((process.command_line:*type\\ * and process.command_line:*\\ >\\ *) or (process.command_line:*makecab\\ * and process.command_line:*.cab*) or (process.command_line:*reg\\ * and process.command_line:*\\ export\\ *) or (process.command_line:*regedit\\ * and process.command_line:*\\ \\/e\\ *) or (process.command_line:*esentutl\\ * and process.command_line:*\\ \\/y\\ * and process.command_line:*\\ \\/d\\ * and process.command_line:*\\ \\/o\\ *)))
<li><a href="#">query: (process.command_line:*verb\\:sync* and process.command_line:*\\-source\\:runcommand* and process.command_line:*\\-dest\\:runcommand* and process.executable:*\\\\msdeploy.exe)
<li><a href="#">query: (process.command_line:*vssadmin\\ list\\ shadows* and process.command_line:*log.txt*)
<li><a href="#">query: (process.command_line:*winget* and process.command_line:*install* and process.command_line:(*\\-m\\ * or *\\-\\-manifest*))
<li><a href="#">query: (process.command_line:*winrm* and process.command_line:(*format\\:pretty* or *format\\:\\\"pretty\\\"* or *format\\:\\\"text\\\"* or *format\\:text*) and (not (process.executable:(c\\:\\\\windows\\\\system32\\\\* or c\\:\\\\windows\\\\syswow64\\\\*))))
<li><a href="#">query: (process.command_line:*wmic* and process.command_line:*product\\ where\\ name\\=* and process.command_line:*call\\ uninstall* and process.command_line:*\\/nointeractive* and process.command_line:(*antivirus* or *avg\\ * or *crowdstrike\\ sensor* or *dlp\\ endpoint* or *endpoint\\ detection* or *endpoint\\ protection* or *endpoint\\ security* or *endpoint\\ sensor* or *eset\\ file\\ security* or *malwarebytes* or *mcafee\\ agent* or *microsoft\\ security\\ client* or *threat\\ protection* or *virusscan* or *webroot\\ secureanywhere* or *windows\\ defender*))
<li><a href="#">query: (process.command_line:/(?i).*bitsadmin.*\\/setnotifycmdline.*(%comspec%|cmd.exe|regsvr32.exe).*/ or process.command_line:/(?i).*bitsadmin.*\\/addfile.*(http|https|ftp|ftps):.*/)
<li><a href="#">query: (process.command_line:/(?i)sc config.*binpath=.*/ or process.command_line:/(?i)sc failure.*command=.*/ or process.command_line:/(?i).*reg add.*(failurecommand|imagepath).*(\\.sh|\\.exe|\\.dll|\\.bin$|\\.bat|\\.cmd|\\.js|\\.msh$|\\.reg$|\\.scr|\\.ps|\\.vb|\\.jar|\\.pl).*/)
<li><a href="#">query: (process.command_line:/(?i)wuauclt\\.exe.*\\/updatedeploymentprovider.*\\/runhandlercomserver/ and (not (process.command_line:(*wuaueng.dll* or *updatedeploymentprovider.dll\\ \\/classid*))))
<li><a href="#">query: (process.command_line:/\\$pshome\\[\\s*\\d{1,3}\\s*\\]\\s*\\+\\s*\\$pshome\\[/ or process.command_line:/\\$shellid\\[\\s*\\d{1,3}\\s*\\]\\s*\\+\\s*\\$shellid\\[/ or process.command_line:/\\$env:public\\[\\s*\\d{1,3}\\s*\\]\\s*\\+\\s*\\$env:public\\[/ or process.command_line:/\\$env:comspec\\[(\\s*\\d{1,3}\\s*,){2}/ or process.command_line:/\\\\\\\\*mdr\\\\\\\\*\\w\\s*\\)\\.name/ or process.command_line:/\\$verbosepreference\\.tostring\\(/ or process.command_line:/\\\\\\\\string\\]\\s*\\$verbosepreference/)
<li><a href="#">query: (process.executable.text:(*\\/apt or *\\/apt\\-get) and process.command_line.text:*apt\\:\\:update\\:\\:pre\\-invoke\\:\\:\\=*)
<li><a href="#">query: (process.executable.text:(*\\/cat or *\\/head or *\\/tail or *\\/more) and (process.command_line.text:(*\\/.bash_history* or *\\/.zsh_history*) or process.command_line.text:(*_history or *.history or *zhistory)))
<li><a href="#">query: (process.executable.text:(*\\/cat or *grep or *\\/head or *\\/tail or *\\/more) and process.command_line.text:*\\ \\/etc\\/sudoers*)
<li><a href="#">query: (process.executable.text:(*\\/firewall\\-cmd or *\\/ufw or *\\/iptables or *\\/netstat or *\\/ss or *\\/ip or *\\/ifconfig or *\\/systemd\\-resolve or *\\/route) or process.command_line.text:*\\/etc\\/resolv.conf*)
<li><a href="#">query: (process.executable.text:(*\\/grep or *\\/egrep) and process.command_line.text:(*nessusd* or *td\\-agent* or *packetbeat* or *filebeat* or *auditbeat* or *osqueryd* or *cbagentd* or *falcond*))
<li><a href="#">query: (process.executable.text:(*\\/rm or *\\/shred or *\\/unlink) and process.command_line.text:(*\\/var\\/log* or *\\/var\\/spool\\/mail*))
<li><a href="#">query: (process.executable.text:(*\\/rm or *\\/unlink or *\\/shred) and (process.command_line.text:(*\\/.bash_history* or *\\/.zsh_history*) or process.command_line.text:(*_history or *.history or *zhistory)))
<li><a href="#">query: (process.executable.text:(*\\/rm or *\\/unlink or *\\/shred) and (process.command_line.text:*\\/var\\/log* or (process.command_line.text:*\\/users\\/* and process.command_line.text:*\\/library\\/logs\\/*)))
<li><a href="#">query: (process.executable.text:(*\\/service or *\\/systemctl or *\\/chkconfig) and process.command_line.text:(*stop* or *disable*))
<li><a href="#">query: (process.executable.text:(*\\/vim or *\\/rvim or *\\/vimdiff) and process.command_line.text:(*\\ \\-c\\ * or *\\ \\-\\-cmd*) and process.command_line.text:(*\\:\\!\\/* or *\\:py\\ * or *\\:lua\\ * or *\\/bin\\/sh* or *\\/bin\\/bash* or *\\/bin\\/dash* or *\\/bin\\/zsh* or *\\/bin\\/fish*))
<li><a href="#">query: (process.executable.text:(*\\/who or *\\/w or *\\/last or *\\/lsof or *\\/netstat) and (not process.parent.command_line.text:*\\/usr\\/bin\\/python* and process.parent.command_line.text:*\\/usr\\/bin\\/landscape\\-sysinfo*))
<li><a href="#">query: (process.executable.text:(*\\\\bash.exe or *\\\\cvtres.exe or *\\\\defrag.exe or *\\\\dnx.exe or *\\\\esentutl.exe or *\\\\excel.exe or *\\\\expand.exe or *\\\\explorer.exe or *\\\\find.exe or *\\\\findstr.exe or *\\\\forfiles.exe or *\\\\gpupdate.exe or *\\\\hh.exe or *\\\\iexplore.exe or *\\\\installutil.exe or *\\\\lync.exe or *\\\\makecab.exe or *\\\\mdnsresponder.exe or *\\\\monitoringhost.exe or *\\\\msbuild.exe or *\\\\mshta.exe or *\\\\msiexec.exe or *\\\\mspaint.exe or *\\\\outlook.exe or *\\\\ping.exe or *\\\\powerpnt.exe or *\\\\provtool.exe or *\\\\python.exe or *\\\\regsvr32.exe or *\\\\robocopy.exe or *\\\\runonce.exe or *\\\\sapcimc.exe or *\\\\schtasks.exe or *\\\\smartscreen.exe or *\\\\spoolsv.exe or *\\\\tstheme.exe or *\\\\userinit.exe or *\\\\vssadmin.exe or *\\\\vssvc.exe or *\\\\w3wp.exe or *\\\\winlogon.exe or *\\\\winscp.exe or *\\\\wmic.exe or *\\\\word.exe or *\\\\wscript.exe) and (not ((process.executable.text:*visual\\ studio* or sourceparentimage:*\\\\programs\\\\microsoft\\ vs\\ code\\\\*) or (process.executable.text:\"c\\:\\\\windows\\\\system32\\\\winlogon.exe\" and winlog.event_data.targetimage:(\"c\\:\\\\windows\\\\system32\\\\services.exe\" or \"c\\:\\\\windows\\\\system32\\\\wininit.exe\" or \"c\\:\\\\windows\\\\system32\\\\csrss.exe\")) or (process.executable.text:\"c\\:\\\\windows\\\\system32\\\\provtool.exe\" and targetparentprocessid:\"0\") or (process.executable.text:*\\\\git.exe and winlog.event_data.targetimage:(*\\\\git.exe or *c\\:\\\\windows\\\\system32\\\\conhost.exe)) or (process.executable.text:\"c\\:\\\\windows\\\\system32\\\\vssvc.exe\" and winlog.event_data.targetimage:\"system\") or (sourceparentimage:\"c\\:\\\\windows\\\\system32\\\\compattelrunner.exe\") or (process.executable.text:(\"c\\:\\\\windows\\\\system32\\\\schtasks.exe\" or \"c\\:\\\\windows\\\\syswow64\\\\schtasks.exe\") and winlog.event_data.targetimage:\"c\\:\\\\windows\\\\system32\\\\conhost.exe\"))))
<li><a href="#">query: (process.executable.text:(*\\\\desktop\\\\* or *\\\\temp\\\\* or *\\\\temporary\\ internet*) and (not ((process.parent.executable.text:(\"c\\:\\\\windows\\\\system32\\\\cleanmgr.exe\" or \"c\\:\\\\program\\ files\\ \\(x86\\)\\\\microsoft\\ visual\\ studio\\\\installer\\\\resources\\\\app\\\\servicehub\\\\services\\\\microsoft.visualstudio.setup.service\\\\backgrounddownload.exe\" or \"c\\:\\\\windows\\\\system32\\\\dxgiadaptercache.exe\") or process.parent.executable.text:c\\:\\\\program\\ files\\ \\(x86\\)\\\\nvidia\\ corporation\\\\*) or (process.executable.text:*setup.exe) or (process.executable.text:c\\:\\\\program\\ files\\ \\(x86\\)\\\\microsoft\\\\temp\\\\* and process.executable.text:*.tmp\\\\microsoftedgeupdate.exe))))
<li><a href="#">query: (process.executable.text:(*\\\\frpc.exe or *\\\\frps.exe) and process.command_line.text:*\\\\frpc.ini*)
<li><a href="#">query: (process.executable.text:(*\\\\goldenpac* or *\\\\karmasmb* or *\\\\kintercept* or *\\\\ntlmrelayx* or *\\\\rpcdump* or *\\\\samrdump* or *\\\\secretsdump* or *\\\\smbexec* or *\\\\smbrelayx* or *\\\\wmiexec* or *\\\\wmipersist*) or process.executable.text:(*\\\\atexec_windows.exe or *\\\\dcomexec_windows.exe or *\\\\dpapi_windows.exe or *\\\\finddelegation_windows.exe or *\\\\getadusers_windows.exe or *\\\\getnpusers_windows.exe or *\\\\getpac_windows.exe or *\\\\getst_windows.exe or *\\\\gettgt_windows.exe or *\\\\getuserspns_windows.exe or *\\\\ifmap_windows.exe or *\\\\mimikatz_windows.exe or *\\\\netview_windows.exe or *\\\\nmapanswermachine_windows.exe or *\\\\opdump_windows.exe or *\\\\psexec_windows.exe or *\\\\rdp_check_windows.exe or *\\\\sambapipe_windows.exe or *\\\\smbclient_windows.exe or *\\\\smbserver_windows.exe or *\\\\sniffer_windows.exe or *\\\\sniff_windows.exe or *\\\\split_windows.exe or *\\\\ticketer_windows.exe))
<li><a href="#">query: (process.executable.text:(*\\\\net.exe or *\\\\net1.exe) and process.command_line.text:*\\ use\\ * and process.command_line.text:*\\\\\\*\\\\*$*)
<li><a href="#">query: (process.executable.text:(*\\\\ping.exe or *\\\\arp.exe) and (process.command_line.text:*\\ 0x* or process.command_line.text:/ [0-9]{7,13}/))
<li><a href="#">query: (process.executable.text:(*\\\\powershell.exe or *\\\\powershell_ise.exe or *\\\\pwsh.exe) and process.command_line.text:(*get\\-bitstransfer* or *add\\-bitsfile*))
<li><a href="#">query: (process.executable.text:(*\\\\powershell.exe or *\\\\pwsh.exe) and (not ((sourceparentimage:\"c\\:\\\\windows\\\\system32\\\\compattelrunner.exe\"))))
<li><a href="#">query: (process.executable.text:(*\\\\powershell.exe or *\\\\pwsh.exe) and file.path.text:*.bat)
<li><a href="#">query: (process.executable.text:(*\\\\powershell.exe or *\\\\pwsh.exe) and file.path.text:*\\\\start\\ menu\\\\programs\\\\startup\\\\* and file.path.text:*.lnk)
<li><a href="#">query: (process.executable.text:(*\\\\powershell.exe or *\\\\pwsh.exe) and process.command_line.text:*add\\-pssnapin* and process.command_line.text:*get\\-recipient* and process.command_line.text:*\\-expandproperty* and process.command_line.text:*emailaddresses* and process.command_line.text:*smtpaddress* and process.command_line.text:*\\-hidetableheaders*)
<li><a href="#">query: (process.executable.text:(*\\\\powershell.exe or *\\\\pwsh.exe) and winlog.event_data.targetimage:*\\\\lsass.exe)
<li><a href="#">query: (process.executable.text:(*\\\\regsvr32.exe or *\\\\rundll32.exe or *\\\\msiexec.exe or *\\\\mshta.exe or *\\\\verclsid.exe or *\\\\msdt.exe or *\\\\control.exe or *\\\\msidb.exe) and process.parent.executable.text:(*\\\\winword.exe or *\\\\excel.exe or *\\\\powerpnt.exe or *\\\\msaccess.exe or *\\\\mspub.exe or *\\\\eqnedt32.exe or *\\\\visio.exe or *\\\\wordpad.exe or *\\\\wordview.exe))
<li><a href="#">query: (process.executable.text:(*\\\\rundll32.exe or *\\\\smss.exe or *\\\\runtimebroker.exe or *\\\\sihost.exe or *\\\\lsass.exe or *\\\\csrss.exe or *\\\\winlogon.exe or *\\\\wininit.exe) and file.path.text:(*.bat or *.vbe or *.txt or *.vbs or *.exe or *.ps1 or *.hta or *.iso))
<li><a href="#">query: (process.executable.text:(*\\\\svchost.exe or *\\\\rundll32.exe or *\\\\services.exe or *\\\\powershell.exe or *\\\\powershell_ise.exe or *\\\\pwsh.exe or *\\\\regsvr32.exe or *\\\\spoolsv.exe or *\\\\lsass.exe or *\\\\smss.exe or *\\\\csrss.exe or *\\\\conhost.exe or *\\\\wininit.exe or *\\\\lsm.exe or *\\\\winlogon.exe or *\\\\explorer.exe or *\\\\taskhost.exe or *\\\\taskmgr.exe or *\\\\sihost.exe or *\\\\runtimebroker.exe or *\\\\smartscreen.exe or *\\\\dllhost.exe or *\\\\audiodg.exe or *\\\\wlanext.exe or *\\\\dashost.exe or *\\\\schtasks.exe or *\\\\cscript.exe or *\\\\wscript.exe or *\\\\wsl.exe or *\\\\bitsadmin.exe or *\\\\atbroker.exe or *\\\\bcdedit.exe or *\\\\certutil.exe or *\\\\certreq.exe or *\\\\cmstp.exe or *\\\\consent.exe or *\\\\defrag.exe or *\\\\dism.exe or *\\\\dllhst3g.exe or *\\\\eventvwr.exe or *\\\\msiexec.exe or *\\\\runonce.exe or *\\\\winver.exe or *\\\\logonui.exe or *\\\\userinit.exe or *\\\\dwm.exe or *\\\\lsaiso.exe or *\\\\ntoskrnl.exe or *\\\\wsmprovhost.exe or *\\\\dfrgui.exe) and (not ((((process.executable.text:(c\\:\\\\windows\\\\system32\\\\* or c\\:\\\\windows\\\\syswow64\\\\* or c\\:\\\\windows\\\\winsxs\\\\*)) or (process.executable.text:*\\\\systemroot\\\\system32\\\\*) or (process.executable.text:(\"c:\\windows\\explorer.exe\" or \"c:\\program files\\powershell\\7\\pwsh.exe\")))) or ((process.executable.text:c\\:\\\\program\\ files\\\\windowsapps\\\\microsoftcorporationii.windowssubsystemforlinux* and process.executable.text:*\\\\wsl.exe)))))
<li><a href="#">query: (process.executable.text:(*\\\\users\\\\public\\\\* or *\\\\$recycle.bin* or *\\\\users\\\\all\\ users\\\\* or *\\\\users\\\\default\\\\* or *\\\\users\\\\contacts\\\\* or *\\\\users\\\\searches\\\\* or *c\\:\\\\perflogs\\\\* or *\\\\config\\\\systemprofile\\\\* or *\\\\windows\\\\fonts\\\\* or *\\\\windows\\\\ime\\\\* or *\\\\windows\\\\addins\\\\*) and process.parent.executable.text:(*\\\\services.exe or *\\\\svchost.exe))
<li><a href="#">query: (process.executable.text:(*\\\\winword.exe or *\\\\powerpnt.exe or *\\\\excel.exe or *\\\\outlook.exe) and dll.path:(*\\\\vbe7.dll or *\\\\vbeui.dll or *\\\\vbe7intl.dll))
<li><a href="#">query: (process.executable.text:(*\\\\wscript.exe or *\\\\cscript.exe or *\\\\mshta.exe or *\\\\cmstp.exe or *\\\\msxsl.exe) and dll.path:(*\\\\clr.dll or *\\\\mscoree.dll or *\\\\mscorlib.dll))
<li><a href="#">query: (process.executable.text:(*\\~1.exe* or *\\~1.bat* or *\\~1.msi* or *\\~1.vbe* or *\\~1.vbs* or *\\~1.dll* or *\\~1.ps1* or *\\~1.js* or *\\~1.hta* or *\\~2.exe* or *\\~2.bat* or *\\~2.msi* or *\\~2.vbe* or *\\~2.vbs* or *\\~2.dll* or *\\~2.ps1* or *\\~2.js* or *\\~2.hta*) and (not (process.parent.executable.text:(*\\\\webex\\\\webexhost.exe or *\\\\thor\\\\thor64.exe or *\\-installer.exe) or process.executable.text:*\\\\vcredi*)))
<li><a href="#">query: (process.executable.text:(*\\~1\\\\* or *\\~2\\\\*) and (not ((process.parent.executable.text:(\"c\\:\\\\windows\\\\system32\\\\dism.exe\" or \"c\\:\\\\windows\\\\system32\\\\cleanmgr.exe\") or process.parent.executable.text:(*\\\\webex\\\\webexhost.exe or *\\\\thor\\\\thor64.exe) or product:\"installshield\\ \\(r\\)\" or winlog.event_data.description:\"installshield\\ \\(r\\)\\ setup\\ engine\" or company:\"installshield\\ software\\ corporation\") or (process.executable.text:*\\\\appdata\\\\* and process.executable.text:*\\\\temp\\\\* or process.executable.text:(*\\~1\\\\unzip.exe or *\\~1\\\\7zg.exe)))))
<li><a href="#">query: (process.executable.text:(*windows\\\\system32\\\\physmem.sys* or *windows\\\\system32\\\\ime\\\\shared\\\\wimbootconfigurations.ini* or *windows\\\\system32\\\\ime\\\\imejp\\\\wimbootconfigurations.ini* or *windows\\\\system32\\\\ime\\\\imetc\\\\wimbootconfigurations.ini*) or (process.executable.text:(*windows\\\\system32\\\\filepath2* or *windows\\\\system32\\\\ime*) and process.command_line.text:*reg\\ add* and process.command_line.text:(*hkey_local_machine\\\\software\\\\classes\\\\clsid\\\\\\{7c857801\\-7381\\-11cf\\-884d\\-00aa004b2e24\\}\\\\inprocserver32* or *hkey_local_machine\\\\software\\\\classes\\\\clsid\\\\\\{cf4cc405\\-e2c5\\-4ddd\\-b3ce\\-5e7582d8c9fa\\}\\\\inprocserver32*)))
<li><a href="#">query: (process.executable.text:*\\/chattr and process.command_line.text:*\\ \\-i\\ *)
<li><a href="#">query: (process.executable.text:*\\/curl and process.command_line.text:(*\\ \\-a\\ * or *\\ \\-\\-user\\-agent\\ *))
<li><a href="#">query: (process.executable.text:*\\/curl and process.command_line.text:(*\\ \\-f\\ * or *\\ \\-\\-form* or *\\ \\-t\\ * or *\\ \\-\\-upload\\-file\\ * or *\\ \\-d\\ * or *\\ \\-\\-data\\ * or *\\ \\-\\-data\\-*))
<li><a href="#">query: (process.executable.text:*\\/find and process.command_line.text:(*\\-perm\\ \\-4000* or *\\-perm\\ \\-2000* or *\\-perm\\ 0777* or *\\-perm\\ \\-222* or *\\-perm\\ \\-o\\ w* or *\\-perm\\ \\-o\\ x* or *\\-perm\\ \\-u\\=s* or *\\-perm\\ \\-g\\=s*))
<li><a href="#">query: (process.executable.text:*\\/getcap and process.command_line.text:(*\\ \\/r\\ * or *\\ \\-r\\ *))
<li><a href="#">query: (process.executable.text:*\\/git and process.command_line.text:*\\ clone\\ * and process.command_line.text:(*exploit* or *vulns* or *vulnerability* or *rce* or *remotecodeexecution* or *invoke\\-* or *cve\\-* or *poc\\-* or *proofofconcept* or *proxyshell* or *log4shell* or *eternalblue* or *eternal\\-blue* or *ms17\\-*))
<li><a href="#">query: (process.executable.text:*\\/groups or (process.executable.text:(*\\/cat or *\\/head or *\\/tail or *\\/more) and process.command_line.text:*\\/etc\\/group*))
<li><a href="#">query: (process.executable.text:*\\/lastlog or process.command_line.text:*'x\\:0\\:'* or (process.executable.text:(*\\/cat or *\\/head or *\\/tail or *\\/more) and process.command_line.text:(*\\/etc\\/passwd* or *\\/etc\\/shadow* or *\\/etc\\/sudoers*)) or process.executable.text:*\\/id or (process.executable.text:*\\/lsof and process.command_line.text:*\\-u*))
<li><a href="#">query: (process.executable.text:*\\/usermod and process.command_line.text:(*\\-ag\\ root* or *\\-ag\\ sudoers*))
<li><a href="#">query: (process.executable.text:*\\:\\\\windows\\\\syswow64\\\\* and winlog.event_data.grantedaccess:\"0x1fffff\" and winlog.event_data.calltrace:unknown\\(0000000000000000\\)|unknown\\(0000000000000000\\)|*)
<li><a href="#">query: (process.executable.text:*\\\\auditpol.exe and process.command_line.text:(*disable* or *clear* or *remove* or *restore*))
<li><a href="#">query: (process.executable.text:*\\\\bcdedit.exe and process.command_line.text:(*delete* or *deletevalue* or *import* or *safeboot* or *network*))
<li><a href="#">query: (process.executable.text:*\\\\changepk.exe and process.parent.executable.text:*\\\\slui.exe and integritylevel:(\"high\" or \"system\"))
<li><a href="#">query: (process.executable.text:*\\\\clip.exe or winlog.event_data.originalfilename:\"clip.exe\")
<li><a href="#">query: (process.executable.text:*\\\\cmd.exe* and process.command_line.text:*\\ net\\ use\\ http* and process.command_line.text:*&\\ start\\ \\/b\\ * and process.command_line.text:*\\\\davwwwroot\\\\* and process.command_line.text:(*.exe\\ * or *.dll\\ * or *.bat\\ * or *.vbs\\ * or *.ps1\\ *))
<li><a href="#">query: (process.executable.text:*\\\\colorcpl.exe and (not ((file.path.text:(*.icm or *.gmmp or *.cdmp or *.camp)))))
<li><a href="#">query: (process.executable.text:*\\\\coregen.exe and (not (dll.path:(c\\:\\\\windows\\\\system32\\\\* or c\\:\\\\windows\\\\syswow64\\\\* or c\\:\\\\program\\ files\\\\microsoft\\ silverlight\\\\* or c\\:\\\\program\\ files\\ \\(x86\\)\\\\microsoft\\ silverlight\\\\*))))
<li><a href="#">query: (process.executable.text:*\\\\csexec.exe or winlog.event_data.description:\"csexec\")
<li><a href="#">query: (process.executable.text:*\\\\defendercheck.exe or winlog.event_data.description:\"defendercheck\")
<li><a href="#">query: (process.executable.text:*\\\\deviceenroller.exe and process.command_line.text:*\\/phonedeeplink*)
<li><a href="#">query: (process.executable.text:*\\\\dnscmd.exe and process.command_line.text:*\\/config* and process.command_line.text:*\\/serverlevelplugindll*)
<li><a href="#">query: (process.executable.text:*\\\\fltmc.exe and process.command_line.text:*unload* and process.command_line.text:*sys*)
<li><a href="#">query: (process.executable.text:*\\\\internet\\ explorer\\\\iexplore.exe and dll.path:*\\\\internet\\ explorer\\\\iertutil.dll)
<li><a href="#">query: (process.executable.text:*\\\\microsoft.workflow.compiler.exe or (winlog.event_data.originalfilename:\"microsoft.workflow.compiler.exe\" and process.command_line.text:*.xml*))
<li><a href="#">query: (process.executable.text:*\\\\mpcmdrun.exe and (not (process.executable.text:(c\\:\\\\program\\ files\\\\windows\\ defender\\\\* or c\\:\\\\programdata\\\\microsoft\\\\windows\\ defender\\\\platform\\\\* or c\\:\\\\windows\\\\winsxs\\\\x86_security\\-malware\\-windows\\-defender_* or c\\:\\\\program\\ files\\\\microsoft\\ security\\ client\\\\mpcmdrun.exe*))))
<li><a href="#">query: (process.executable.text:*\\\\mshta.exe and ((process.parent.executable.text:(*\\\\cmd.exe or *\\\\powershell.exe or *\\\\pwsh.exe) or process.command_line.text:(*\\\\appdata\\\\local* or *c\\:\\\\windows\\\\temp* or *c\\:\\\\users\\\\public*)) or (not ((process.executable.text:(c\\:\\\\windows\\\\system32* or c\\:\\\\windows\\\\syswow64*)) or (process.command_line.text:(*.htm* or *.hta*) and process.command_line.text:(*mshta.exe or *mshta))))))
<li><a href="#">query: (process.executable.text:*\\\\mshta.exe and process.command_line.text:(*vbscript* or *.jpg* or *.png* or *.lnk* or *.xls* or *.doc* or *.zip* or *.dll*))
<li><a href="#">query: (process.executable.text:*\\\\msiexec.exe and process.command_line.text:(*\\ \\/z\\ * or *\\ \\-z\\ *) and process.command_line.text:*.dll*)
<li><a href="#">query: (process.executable.text:*\\\\netsh.exe and ((process.command_line.text:*interface* and process.command_line.text:*portproxy* and process.command_line.text:*add* and process.command_line.text:*v4tov4*) or (process.command_line.text:*connectp* and process.command_line.text:*listena* and process.command_line.text:*c\\=*)))
<li><a href="#">query: (process.executable.text:*\\\\node.exe and process.command_line.text:(*\\ \\-e\\ * or *\\ \\-\\-eval\\ *) and process.command_line.text:*.exec\\(* and process.command_line.text:*net.socket* and process.command_line.text:*.connect* and process.command_line.text:*child_process*)
<li><a href="#">query: (process.executable.text:*\\\\pcalua.exe and process.command_line.text:*\\ \\-a*)
<li><a href="#">query: (process.executable.text:*\\\\plink.exe and (process.command_line.text:*\\:127.0.0.1\\:3389* or (process.command_line.text:*\\:3389* and process.command_line.text:(*\\ \\-p\\ 443* or *\\ \\-p\\ 22*))))
<li><a href="#">query: (process.executable.text:*\\\\policydefinitions\\\\postgresql.exe or process.command_line.text:(*csidl_system_drive\\\\temp\\\\sys.tmp* or *\\ 1>\\ \\\\\\\\127.0.0.1\\\\admin$\\\\__16*) or (process.command_line.text:*powershell\\ \\-c\\ * and process.command_line.text:*\\\\comsvcs.dll\\ minidump\\ * and process.command_line.text:*\\\\winupd.log\\ full*))
<li><a href="#">query: (process.executable.text:*\\\\powershell.exe and (not ((process.parent.executable.text:(*\\\\explorer.exe or *\\\\compattelrunner.exe) or process.parent.executable.text:\"c\\:\\\\$windows.\\~bt\\\\sources\\\\setuphost.exe\"))))
<li><a href="#">query: (process.executable.text:*\\\\powershell.exe and process.command_line.text:(*\\ \\-version\\ 2\\ * or *\\ \\-versio\\ 2\\ * or *\\ \\-versi\\ 2\\ * or *\\ \\-vers\\ 2\\ * or *\\ \\-ver\\ 2\\ * or *\\ \\-ve\\ 2\\ * or *\\ \\-v\\ 2\\ *))
<li><a href="#">query: (process.executable.text:*\\\\reg.exe and process.command_line.text:(*query* or *save* or *export*) and process.command_line.text:(*currentversion\\\\windows* or *winlogon\\\\* or *currentversion\\\\shellserviceobjectdelayload* or *currentversion\\\\run* or *currentversion\\\\policies\\\\explorer\\\\run* or *currentcontrolset\\\\services*))
<li><a href="#">query: (process.executable.text:*\\\\reg.exe and process.command_line.text:(*software\\\\microsoft\\\\windows\\ defender\\\\* or *software\\\\policies\\\\microsoft\\\\windows\\ defender\\\\*) and process.command_line.text:*\\ add\\ * and process.command_line.text:*\\ \\/d\\ 0* and process.command_line.text:(*real\\-time\\ protection* or *tamperprotection*))
<li><a href="#">query: (process.executable.text:*\\\\reg.exe and process.command_line.text:(*software\\\\microsoft\\\\windows\\ defender\\\\exclusions\\\\paths* or *software\\\\microsoft\\\\microsoft\\ antimalware\\\\exclusions\\\\paths*) and process.command_line.text:*add\\ * and process.command_line.text:*\\/t\\ * and process.command_line.text:*reg_dword\\ * and process.command_line.text:*\\/v\\ * and process.command_line.text:*\\/d\\ * and process.command_line.text:*0*)
<li><a href="#">query: (process.executable.text:*\\\\reg.exe and process.command_line.text:*\\ import\\ * and process.command_line.text:(*c\\:\\\\users\\\\* or *%temp%* or *%appdata%* or *\\\\appdata\\\\local\\\\temp\\\\* or *c\\:\\\\windows\\\\temp\\\\* or *c\\:\\\\programdata\\\\*))
<li><a href="#">query: (process.executable.text:*\\\\reg.exe and process.command_line.text:*add* and process.command_line.text:(*\\\\software\\\\microsoft\\\\windows\\\\currentversion\\\\run* or *\\\\software\\\\microsoft\\\\windows\\ nt\\\\currentversion\\\\winlogon\\\\userinit* or *\\\\software\\\\microsoft\\\\windows\\ nt\\\\currentversion\\\\winlogon\\\\shell* or *\\\\software\\\\microsoft\\\\windows\\ nt\\\\currentversion\\\\windows* or *\\\\software\\\\microsoft\\\\windows\\\\currentversion\\\\explorer\\\\user\\ shell\\ folders* or *\\\\system\\\\currentcontrolset\\\\control\\\\safeboot\\\\alternateshell*))
<li><a href="#">query: (process.executable.text:*\\\\reg.exe and process.command_line.text:*query* and process.command_line.text:*\\\\software\\\\* and process.command_line.text:*\\/v* and process.command_line.text:*svcversion*)
<li><a href="#">query: (process.executable.text:*\\\\regedit.exe and process.parent.executable.text:(*\\\\trustedinstaller.exe or *\\\\processhacker.exe))
<li><a href="#">query: (process.executable.text:*\\\\rubeus.exe or winlog.event_data.originalfilename:\"rubeus.exe\" or winlog.event_data.description:\"rubeus\" or process.command_line.text:(*\\ asreproast\\ * or *\\ dump\\ \\/service\\:krbtgt\\ * or *\\ kerberoast\\ * or *\\ createnetonly\\ \\/program\\:* or *\\ ptt\\ \\/ticket\\:* or *\\ \\/impersonateuser\\:* or *\\ renew\\ \\/ticket\\:* or *\\ asktgt\\ \\/user\\:* or *\\ harvest\\ \\/interval\\:* or *\\ s4u\\ \\/user\\:* or *\\ s4u\\ \\/ticket\\:* or *\\ hash\\ \\/password\\:*))
<li><a href="#">query: (process.executable.text:*\\\\rundll32.exe and (not ((not _exists_:process.command_line.text) or (process.command_line.text:*.dll* or process.command_line.text:\"\") or (process.parent.executable.text:*\\:\\\\program\\ files\\\\internet\\ explorer\\\\iexplore.exe and process.command_line.text:*.cpl*) or (process.parent.executable.text:*\\:\\\\windows\\\\syswow64\\\\msiexec.exe and process.parent.command_line.text:c\\:\\\\windows\\\\syswow64\\\\msiexec.exe\\ \\-embedding*) or (process.parent.executable.text:*\\:\\\\windows\\\\system32\\\\msiexec.exe and process.parent.command_line.text:c\\:\\\\windows\\\\system32\\\\msiexec.exe\\ \\-embedding*) or (process.parent.executable.text:*\\:\\\\windows\\\\system32\\\\cmd.exe and process.parent.command_line.text:*\\ c\\:\\\\program\\ files\\\\splunkuniversalforwarder\\\\*) or (process.command_line.text:*\\ \\-localserver\\ *))))
<li><a href="#">query: (process.executable.text:*\\\\safetykatz.exe or winlog.event_data.originalfilename:\"safetykatz.exe\" or winlog.event_data.description:\"safetykatz\")
<li><a href="#">query: (process.executable.text:*\\\\sc.exe and winlog.event_data.originalfilename:*sc.exe and process.command_line.text:*\\ query*)
<li><a href="#">query: (process.executable.text:*\\\\schtasks.exe and process.command_line.text:(*\\/delete* or *\\/change*) and process.command_line.text:*\\/tn* and process.command_line.text:*\\\\microsoft\\\\windows\\\\defrag\\\\scheduleddefrag*)
<li><a href="#">query: (process.executable.text:*\\\\schtasks.exe and process.command_line.text:*\\ \\/change\\ * and process.command_line.text:*\\ \\/tn\\ * and process.command_line.text:(*\\\\appdata\\\\local\\\\temp* or *\\\\appdata\\\\roaming\\\\* or *\\\\users\\\\public\\\\* or *\\\\windows\\\\temp\\\\* or *\\\\desktop\\\\* or *\\\\downloads\\\\* or *\\\\temporary\\ internet* or *c\\:\\\\programdata\\\\* or *c\\:\\\\perflogs\\\\* or *%programdata%* or *%appdata%* or *%comspec%* or *%localappdata%*) and process.command_line.text:(*regsvr32* or *rundll32* or *cmd\\ \\/c\\ * or *cmd\\ \\/k\\ * or *cmd.exe\\ \\/c\\ * or *cmd.exe\\ \\/k\\ * or *powershell* or *mshta* or *wscript* or *cscript* or *certutil* or *bitsadmin* or *bash.exe* or *bash\\ * or *scrcons* or *wmic\\ * or *wmic.exe* or *forfiles* or *scriptrunner* or *hh.exe* or *hh\\ *))
<li><a href="#">query: (process.executable.text:*\\\\schtasks.exe and process.command_line.text:*\\ \\/create\\ * and process.command_line.text:(*powershell* or *cmd\\ \\/c\\ * or *cmd\\ \\/k\\ * or *cmd.exe\\ \\/c\\ * or *cmd.exe\\ \\/k\\ *) and process.command_line.text:(*c\\:\\\\programdata\\\\* or *%programdata%*))
<li><a href="#">query: (process.executable.text:*\\\\schtasks.exe and process.command_line.text:*\\ \\/create\\ * and process.command_line.text:*\\ \\/sc\\ once\\ * and process.command_line.text:*\\\\temp\\\\*)
<li><a href="#">query: (process.executable.text:*\\\\schtasks.exe and process.command_line.text:*\\ \\/delete\\ * and process.command_line.text:*\\/tn\\ \\* and process.command_line.text:*\\ \\/f*)
<li><a href="#">query: (process.executable.text:*\\\\schtasks.exe and process.command_line.text:*\\/change* and process.command_line.text:*\\/tn* and process.command_line.text:*\\/disable* and process.command_line.text:(*microsoft\\\\windows\\\\systemrestore\\\\sr* or *microsoft\\\\windows\\\\windows\\ defender\\\\* or *microsoft\\\\windows\\\\bitlocker* or *microsoft\\\\windows\\\\windowsbackup\\\\* or *microsoft\\\\windows\\\\windowsupdate\\\\* or *microsoft\\\\windows\\\\updateorchestrator\\\\* or *windows\\\\exploitguard*))
<li><a href="#">query: (process.executable.text:*\\\\schtasks.exe and process.command_line.text:*\\/create\\ * and process.command_line.text:(*\\/tn\\ \\\"\\{* or *\\/tn\\ '\\{* or *\\/tn\\ \\{*) and process.command_line.text:(*\\}\\\"* or *\\}'* or *\\}\\ *))
<li><a href="#">query: (process.executable.text:*\\\\schtasks.exe and process.command_line.text:*\\/delete* and process.command_line.text:*\\/tn* and process.command_line.text:(*\\\\windows\\\\systemrestore\\\\sr* or *\\\\windows\\\\windows\\ defender\\\\* or *\\\\windows\\\\bitlocker* or *\\\\windows\\\\windowsbackup\\\\* or *\\\\windows\\\\windowsupdate\\\\* or *\\\\windows\\\\updateorchestrator\\\\* or *\\\\windows\\\\exploitguard*))
<li><a href="#">query: (process.executable.text:*\\\\sepremovaltoolnative_x64.exe or (process.executable.text:*\\\\catclean.exe and process.command_line.text:*\\-\\-uninstall*) or (process.executable.text:*\\\\netinstaller.exe and process.command_line.text:*\\-r*) or (process.executable.text:*\\\\wfpunins.exe and process.command_line.text:*\\/uninstall* and process.command_line.text:*\\/enterprise*))
<li><a href="#">query: (process.executable.text:*\\\\sftp.exe and process.command_line.text:(*\\ \\-d\\ ..* or *\\ \\-d\\ c\\:\\\\*))
<li><a href="#">query: (process.executable.text:*\\\\sharpevtmute.exe or winlog.event_data.description:\"sharpevtmute\" or process.command_line.text:(*\\-\\-filter\\ \\\"rule\\ * or *\\-\\-encoded\\ \\-\\-filter\\ \\\\\\\"*))
<li><a href="#">query: (process.executable.text:*\\\\sharpldapwhoami.exe or winlog.event_data.originalfilename:*sharpldapwhoami* or product:\"sharpldapwhoami\" or process.command_line.text:(*\\ \\/method\\:ntlm or *\\ \\/method\\:kerb or *\\ \\/method\\:nego or *\\ \\/m\\:nego or *\\ \\/m\\:ntlm or *\\ \\/m\\:kerb))
<li><a href="#">query: (process.executable.text:*\\\\sharpup.exe or winlog.event_data.description:\"sharpup\" or process.command_line.text:(*hijackablepaths* or *unquotedservicepath* or *processdllhijack* or *modifiableservicebinaries* or *modifiablescheduledtask* or *domaingpppassword*))
<li><a href="#">query: (process.executable.text:*\\\\svchost.exe and (file.path.text:/\\/ or file.path.text:/\\/ or file.path.text:/w/ or file.path.text:/i/ or file.path.text:/n/ or file.path.text:/d/ or file.path.text:/o/ or file.path.text:/w/ or file.path.text:/s/ or file.path.text:/\\/ or file.path.text:/\\/ or file.path.text:/s/ or file.path.text:/y/ or file.path.text:/s/ or file.path.text:/t/ or file.path.text:/e/ or file.path.text:/m/ or file.path.text:/3/ or file.path.text:/2/ or file.path.text:/\\/ or file.path.text:/\\/ or file.path.text:/[/ or file.path.text:/a/ or file.path.text:/-/ or file.path.text:/z/ or file.path.text:/a/ or file.path.text:/-/ or file.path.text:/z/ or file.path.text:/0/ or file.path.text:/-/ or file.path.text:/9/ or file.path.text:/]/ or file.path.text:/{/ or file.path.text:/8/ or file.path.text:/}/ or file.path.text:/\\/ or file.path.text:/./ or file.path.text:/t/ or file.path.text:/m/ or file.path.text:/p/ or file.path.text:/$/))
<li><a href="#">query: (process.executable.text:*\\\\svchost.exe and dll.path:*\\\\clfsw32.dll)
<li><a href="#">query: (process.executable.text:*\\\\tapinstall.exe and (not ((process.executable.text:(\"c\\:\\\\program\\ files\\\\avast\\ software\\\\secureline\\ vpn\\\\tapinstall.exe\" or \"c\\:\\\\program\\ files\\ \\(x86\\)\\\\avast\\ software\\\\secureline\\ vpn\\\\tapinstall.exe\")))))
<li><a href="#">query: (process.executable.text:*\\\\w3wp.exe and process.command_line.text:*msexchange* and file.path.text:(*.aspx or *.asp or *.ashx or *.ps1 or *.bat or *.exe or *.dll or *.vbs))
<li><a href="#">query: (process.executable.text:*\\\\w3wp.exe and process.command_line.text:*msexchange* and file.path.text:(*frontend\\\\httpproxy\\\\* or *\\\\inetpub\\\\wwwroot\\\\aspnet_client\\\\*) and file.path.text:(*.aspx or *.asp or *.ashx))
<li><a href="#">query: (process.executable.text:*\\\\wab.exe and (not (process.executable.text:(c\\:\\\\windows\\\\winsxs\\\\* or c\\:\\\\program\\ files\\\\windows\\ mail\\\\* or c\\:\\\\program\\ files\\ \\(x86\\)\\\\windows\\ mail\\\\*))))
<li><a href="#">query: (process.executable.text:*\\\\werfault.exe and winlog.event_data.targetimage:*\\\\lsass.exe and winlog.event_data.grantedaccess:\"0x1fffff\")
<li><a href="#">query: (process.executable.text:*\\\\wevtutil.exe and process.command_line.text:(*\\ qe\\ * or *\\ query\\-events\\ *) and process.command_line.text:(*microsoft\\-windows\\-terminalservices\\-localsessionmanager\\/operational* or *microsoft\\-windows\\-terminal\\-services\\-remoteconnectionmanager\\/operational*))
<li><a href="#">query: (process.executable.text:*\\\\windows\\\\system32\\\\query.exe and process.command_line.text:(*session\\ >* or *process\\ >*))
<li><a href="#">query: (process.executable.text:*\\\\wmic.exe and dll.path:(*\\\\jscript.dll or *\\\\vbscript.dll))
<li><a href="#">query: (process.executable.text:*\\\\wmiprvse.exe and dll.path:*\\\\wbem\\\\wbemcomn.dll)
<li><a href="#">query: (process.executable.text:*\\\\wsmprovhost.exe or process.parent.executable.text:*\\\\wsmprovhost.exe)
<li><a href="#">query: (process.executable.text:*\\\\wsreset.exe and integritylevel:(\"high\" or \"system\"))
<li><a href="#">query: (process.executable.text:*\\\\wusa.exe and process.command_line.text:*\\/extract\\:* and process.command_line.text:(*c\\:\\\\users\\\\public\\\\* or *\\\\desktop\\\\* or *\\\\downloads\\\\* or *\\\\appdata\\\\local\\\\temp\\\\* or *\\\\windows\\\\temp\\\\* or *\\\\perflogs\\\\*))
<li><a href="#">query: (process.executable.text:*\\\\xwizard.exe and (not (process.executable.text:c\\:\\\\windows\\\\system32\\\\*)))
<li><a href="#">query: (process.executable.text:*crontab and process.command_line.text:*\\ \\-r*)
<li><a href="#">query: (process.executable.text:*umworkerprocess.exe and (not (file.path.text:(*cachecleanup.bin or *.txt or *.log or *.cfg or *cleanup.bin))))
<li><a href="#">query: (process.executable.text:*updata.exe and file.path.text:\"c\\:\\\\windows\\\\oci.dll\")
<li><a href="#">query: (process.executable.text:*wuauclt* and (not (((destination.ip:51.10*)) or ((process.command_line.text:*\\\\updatedeploy.dll\\ \\/classid\\ *)))))
<li><a href="#">query: (process.executable.text:*xclip* and process.command_line.text:*\\-sel* and process.command_line.text:*clip* and process.command_line.text:*\\-o*)
<li><a href="#">query: (process.executable.text:\"\\/usr\\/sbin\\/firmwarepasswd\" and process.command_line.text:(*setpasswd* or *full* or *delete* or *check*))
<li><a href="#">query: (process.executable.text:\"c\\:\\\\program\\ files\\\\internet\\ explorer\\\\ieinstal.exe\" and file.path.text:c\\:\\\\users\\\\* and file.path.text:*\\\\appdata\\\\local\\\\temp\\\\* and file.path.text:*consent.exe)
<li><a href="#">query: (process.executable.text:\"system\" and file.path.text:*\\\\internet\\ explorer\\\\iertutil.dll)
<li><a href="#">query: (process.executable.text:\"system\" and file.path.text:*\\\\wbem\\\\wbemcomn.dll)
<li><a href="#">query: (process.executable.text:c\\:\\\\program\\ files\\\\windowsapps\\\\microsoft.desktopappinstaller_* and process.executable.text:*\\\\appinstaller.exe)
<li><a href="#">query: (process.executable:(*\\/firewall\\-cmd or *\\/ufw or *\\/iptables or *\\/netstat or *\\/ss or *\\/ip or *\\/ifconfig or *\\/systemd\\-resolve or *\\/route) or process.command_line:*\\/etc\\/resolv.conf*)
<li><a href="#">query: (process.executable:(*\\/python2.* or *\\/python3.*) and ((process.command_line:*import\\ pty* and process.command_line:*.spawn\\(*) or process.command_line:*from\\ pty\\ import\\ spawn*))
<li><a href="#">query: (process.executable:(*\\/rm or *\\/shred) and process.command_line:(*\\/var\\/log* or *\\/var\\/spool\\/mail*))
<li><a href="#">query: (process.executable:(*\\/whoami or *\\/ifconfig or *\\/usr\\/bin\\/ip or *\\/bin\\/uname) and (process.parent.executable:(*\\/httpd or *\\/lighttpd or *\\/nginx or *\\/apache2 or *\\/node) or (process.parent.command_line:*\\/bin\\/java* and process.parent.command_line:*tomcat*)))
<li><a href="#">query: (process.executable:(*\\:\\\\recycler\\\\* or *\\:\\\\systemvolumeinformation\\\\*) or process.executable:(c\\:\\\\windows\\\\tasks\\\\* or c\\:\\\\windows\\\\debug\\\\* or c\\:\\\\windows\\\\fonts\\\\* or c\\:\\\\windows\\\\help\\\\* or c\\:\\\\windows\\\\drivers\\\\* or c\\:\\\\windows\\\\addins\\\\* or c\\:\\\\windows\\\\cursors\\\\* or c\\:\\\\windows\\\\system32\\\\tasks\\\\*))
<li><a href="#">query: (process.executable:(*\\\\$recycle.bin\\\\* or *\\\\config\\\\systemprofile\\\\* or *\\\\intel\\\\logs\\\\* or *\\\\rsa\\\\machinekeys\\\\* or *\\\\users\\\\all\\ users\\\\* or *\\\\users\\\\default\\\\* or *\\\\users\\\\networkservice\\\\* or *\\\\users\\\\public\\\\* or *\\\\windows\\\\addins\\\\* or *\\\\windows\\\\debug\\\\* or *\\\\windows\\\\fonts\\\\* or *\\\\windows\\\\help\\\\* or *\\\\windows\\\\ime\\\\* or *\\\\windows\\\\media\\\\* or *\\\\windows\\\\repair\\\\* or *\\\\windows\\\\security\\\\* or *\\\\windows\\\\system32\\\\tasks\\\\* or *\\\\windows\\\\tasks\\\\*) or process.executable:c\\:\\\\perflogs\\\\*)
<li><a href="#">query: (process.executable:(*\\\\accesschk.exe or *\\\\accesschk64.exe or *\\\\accessenum.exe or *\\\\adexplorer.exe or *\\\\adexplorer64.exe or *\\\\adinsight.exe or *\\\\adinsight64.exe or *\\\\adrestore.exe or *\\\\adrestore64.exe or *\\\\autologon.exe or *\\\\autologon64.exe or *\\\\autoruns.exe or *\\\\autoruns64.exe or *\\\\autorunsc.exe or *\\\\autorunsc64.exe or *\\\\bginfo.exe or *\\\\bginfo64.exe or *\\\\cacheset.exe or *\\\\cacheset64.exe or *\\\\clockres.exe or *\\\\clockres64.exe or *\\\\contig.exe or *\\\\contig64.exe or *\\\\coreinfo.exe or *\\\\coreinfo64.exe or *\\\\cpustres.exe or *\\\\cpustres64.exe or *\\\\ctrl2cap.exe or *\\\\dbgview.exe or *\\\\dbgview64.exe or *\\\\desktops.exe or *\\\\desktops64.exe or *\\\\disk2vhd.exe or *\\\\disk2vhd64.exe or *\\\\diskext.exe or *\\\\diskext64.exe or *\\\\diskmon.exe or *\\\\diskmon64.exe or *\\\\diskview.exe or *\\\\diskview64.exe or *\\\\du.exe or *\\\\du64.exe or *\\\\efsdump.exe or *\\\\findlinks.exe or *\\\\findlinks64.exe or *\\\\handle.exe or *\\\\handle64.exe or *\\\\hex2dec.exe or *\\\\hex2dec64.exe or *\\\\junction.exe or *\\\\junction64.exe or *\\\\ldmdump.exe or *\\\\listdlls.exe or *\\\\listdlls64.exe or *\\\\livekd.exe or *\\\\livekd64.exe or *\\\\loadord.exe or *\\\\loadord64.exe or *\\\\loadordc.exe or *\\\\loadordc64.exe or *\\\\logonsessions.exe or *\\\\logonsessions64.exe or *\\\\movefile.exe or *\\\\movefile64.exe or *\\\\notmyfault.exe or *\\\\notmyfault64.exe or *\\\\notmyfaultc.exe or *\\\\notmyfaultc64.exe or *\\\\ntfsinfo.exe or *\\\\ntfsinfo64.exe or *\\\\pendmoves.exe or *\\\\pendmoves64.exe or *\\\\pipelist.exe or *\\\\pipelist64.exe or *\\\\portmon.exe or *\\\\procdump.exe or *\\\\procdump64.exe or *\\\\procexp.exe or *\\\\procexp64.exe or *\\\\procmon.exe or *\\\\procmon64.exe or *\\\\psexec.exe or *\\\\psexec64.exe or *\\\\psfile.exe or *\\\\psfile64.exe or *\\\\psgetsid.exe or *\\\\psgetsid64.exe or *\\\\psinfo.exe or *\\\\psinfo64.exe or *\\\\pskill.exe or *\\\\pskill64.exe or *\\\\pslist.exe or *\\\\pslist64.exe or *\\\\psloggedon.exe or *\\\\psloggedon64.exe or *\\\\psloglist.exe or *\\\\psloglist64.exe or *\\\\pspasswd.exe or *\\\\pspasswd64.exe or *\\\\psping.exe or *\\\\psping64.exe or *\\\\psservice.exe or *\\\\psservice64.exe or *\\\\psshutdown.exe or *\\\\psshutdown64.exe or *\\\\pssuspend.exe or *\\\\pssuspend64.exe or *\\\\rammap.exe or *\\\\rdcman.exe or *\\\\regdelnull.exe or *\\\\regdelnull64.exe or *\\\\regjump.exe or *\\\\ru.exe or *\\\\ru64.exe or *\\\\sdelete.exe or *\\\\sdelete64.exe or *\\\\shareenum.exe or *\\\\shareenum64.exe or *\\\\shellrunas.exe or *\\\\sigcheck.exe or *\\\\sigcheck64.exe or *\\\\streams.exe or *\\\\streams64.exe or *\\\\strings.exe or *\\\\strings64.exe or *\\\\sync.exe or *\\\\sync64.exe or *\\\\sysmon.exe or *\\\\sysmon64.exe or *\\\\tcpvcon.exe or *\\\\tcpvcon64.exe or *\\\\tcpview.exe or *\\\\tcpview64.exe or *\\\\testlimit.exe or *\\\\testlimit64.exe or *\\\\vmmap.exe or *\\\\vmmap64.exe or *\\\\volumeid.exe or *\\\\volumeid64.exe or *\\\\whois.exe or *\\\\whois64.exe or *\\\\winobj.exe or *\\\\winobj64.exe or *\\\\zoomit.exe or *\\\\zoomit64.exe) and (not ((company:(\"sysinternals\\ \\-\\ www.sysinternals.com\" or \"sysinternals\")) or (not _exists_:company))))
<li><a href="#">query: (process.executable:(*\\\\bash.exe or *\\\\cvtres.exe or *\\\\defrag.exe or *\\\\dnx.exe or *\\\\esentutl.exe or *\\\\excel.exe or *\\\\expand.exe or *\\\\explorer.exe or *\\\\find.exe or *\\\\findstr.exe or *\\\\forfiles.exe or *\\\\git.exe or *\\\\gpupdate.exe or *\\\\hh.exe or *\\\\iexplore.exe or *\\\\installutil.exe or *\\\\lync.exe or *\\\\makecab.exe or *\\\\mdnsresponder.exe or *\\\\monitoringhost.exe or *\\\\msbuild.exe or *\\\\mshta.exe or *\\\\msiexec.exe or *\\\\mspaint.exe or *\\\\outlook.exe or *\\\\ping.exe or *\\\\powerpnt.exe or *\\\\powershell.exe or *\\\\provtool.exe or *\\\\python.exe or *\\\\regsvr32.exe or *\\\\robocopy.exe or *\\\\runonce.exe or *\\\\sapcimc.exe or *\\\\schtasks.exe or *\\\\smartscreen.exe or *\\\\spoolsv.exe or *\\\\tstheme.exe or *\\\\userinit.exe or *\\\\vssadmin.exe or *\\\\vssvc.exe or *\\\\w3wp.exe or *\\\\winlogon.exe or *\\\\winscp.exe or *\\\\wmic.exe or *\\\\word.exe or *\\\\wscript.exe) and (not ((process.executable:*visual\\ studio*) or (process.executable:\"c\\:\\\\windows\\\\system32\\\\winlogon.exe\" and winlog.event_data.targetimage:(\"c\\:\\\\windows\\\\system32\\\\services.exe\" or \"c\\:\\\\windows\\\\system32\\\\wininit.exe\" or \"c\\:\\\\windows\\\\system32\\\\csrss.exe\")))))
<li><a href="#">query: (process.executable:(*\\\\bloodhound.exe* or *\\\\sharphound.exe*) or process.command_line:(*\\ \\-collectionmethod\\ all\\ * or *.exe\\ \\-c\\ all\\ \\-d\\ * or *invoke\\-bloodhound* or *get\\-bloodhounddata*) or (process.command_line:*\\ \\-jsonfolder\\ * and process.command_line:*\\ \\-zipfilename\\ *) or (process.command_line:*\\ dconly\\ * and process.command_line:*\\ \\-\\-nosavecache\\ *))
<li><a href="#">query: (process.executable:(*\\\\chrome.exe or *\\\\firefox.exe or *\\\\microsoftedge.exe or *\\\\microsoftedgecp.exe or *\\\\msedge.exe or *\\\\iexplorer.exe or *\\\\brave.exe or *\\\\opera.exe) and file.path:*.vhd*)
<li><a href="#">query: (process.executable:(*\\\\cmd.exe or *\\\\powershell.exe) and process.parent.executable:*\\\\windows\\\\installer\\\\* and process.parent.executable:*msi* and process.parent.executable:*tmp)
<li><a href="#">query: (process.executable:(*\\\\downloads\\\\* or *\\\\temporary\\ internet\\ files\\\\content.outlook\\\\* or *\\\\local\\ settings\\\\temporary\\ internet\\ files\\\\*) and winlog.event_data.targetobject:*\\\\software\\\\microsoft\\\\windows\\\\currentversion\\\\run\\\\*)
<li><a href="#">query: (process.executable:(*\\\\goldenpac* or *\\\\karmasmb* or *\\\\kintercept* or *\\\\ntlmrelayx* or *\\\\rpcdump* or *\\\\samrdump* or *\\\\secretsdump* or *\\\\smbexec* or *\\\\smbrelayx* or *\\\\wmiexec* or *\\\\wmipersist*) or process.executable:(*\\\\atexec_windows.exe or *\\\\dcomexec_windows.exe or *\\\\dpapi_windows.exe or *\\\\finddelegation_windows.exe or *\\\\getadusers_windows.exe or *\\\\getnpusers_windows.exe or *\\\\getpac_windows.exe or *\\\\getst_windows.exe or *\\\\gettgt_windows.exe or *\\\\getuserspns_windows.exe or *\\\\ifmap_windows.exe or *\\\\mimikatz_windows.exe or *\\\\netview_windows.exe or *\\\\nmapanswermachine_windows.exe or *\\\\opdump_windows.exe or *\\\\psexec_windows.exe or *\\\\rdp_check_windows.exe or *\\\\sambapipe_windows.exe or *\\\\smbclient_windows.exe or *\\\\smbserver_windows.exe or *\\\\sniffer_windows.exe or *\\\\sniff_windows.exe or *\\\\split_windows.exe or *\\\\ticketer_windows.exe))
<li><a href="#">query: (process.executable:(*\\\\msdtc.exe or *\\\\gpvc.exe) and (not (process.executable:(c\\:\\\\windows\\\\system32\\\\* or c\\:\\\\windows\\\\syswow64\\\\*))))
<li><a href="#">query: (process.executable:(*\\\\msedge.exe or *\\\\chrome.exe) and process.command_line:*\\-\\-headless* and process.command_line:*dump\\-dom* and process.command_line:*http*)
<li><a href="#">query: (process.executable:(*\\\\net.exe or *\\\\net1.exe) and process.command_line:(*\\ group* or *\\ localgroup* or *\\ user* or *\\ view* or *\\ share* or *\\ accounts* or *\\ stop\\ * or *\\ start*))
<li><a href="#">query: (process.executable:(*\\\\net.exe or *\\\\net1.exe) and process.command_line:*\\ start\\ *)
<li><a href="#">query: (process.executable:(*\\\\net.exe or *\\\\net1.exe) and process.command_line:*\\ use\\ * and process.command_line:*\\\\\\*\\\\*$*)
<li><a href="#">query: (process.executable:(*\\\\net.exe or *\\\\net1.exe) and process.command_line:*stop* and process.command_line:(*samss* or *audioendpointbuilder* or *unistoresvc_?????*))
<li><a href="#">query: (process.executable:(*\\\\net.exe or *\\\\net1.exe) and process.command_line:*user* and process.command_line:*add* and process.command_line:*expires\\:never*)
<li><a href="#">query: (process.executable:(*\\\\net.exe or *\\\\net1.exe) and process.command_line:*user* and process.command_line:*add*)
<li><a href="#">query: (process.executable:(*\\\\powerpnt.exe or *\\\\winword.exe or *\\\\excel.exe) and process.command_line:*http*)
<li><a href="#">query: (process.executable:(*\\\\powershell.exe or *\\\\powershell_ise.exe or *\\\\pwsh.exe) and process.command_line:(*get\\-bitstransfer* or *add\\-bitsfile*))
<li><a href="#">query: (process.executable:(*\\\\powershell.exe or *\\\\pwsh.exe) and ((process.command_line:(*toint* or *todecimal* or *tobyte* or *touint* or *tosingle* or *tosbyte*) and process.command_line:(*tochar* or *tostring* or *string*)) or (process.command_line:*join* and (process.command_line:*char* or process.command_line:*split*))))
<li><a href="#">query: (process.executable:(*\\\\powershell.exe or *\\\\pwsh.exe) and process.command_line:(*\\ \\-windowstyle\\ h\\ * or *\\ \\-windowstyl\\ h* or *\\ \\-windowsty\\ h* or *\\ \\-windowst\\ h* or *\\ \\-windows\\ h* or *\\ \\-windo\\ h* or *\\ \\-wind\\ h* or *\\ \\-win\\ h* or *\\ \\-wi\\ h* or *\\ \\-win\\ h\\ * or *\\ \\-win\\ hi\\ * or *\\ \\-win\\ hid\\ * or *\\ \\-win\\ hidd\\ * or *\\ \\-win\\ hidde\\ * or *\\ \\-nopr\\ * or *\\ \\-nopro\\ * or *\\ \\-noprof\\ * or *\\ \\-noprofi\\ * or *\\ \\-noprofil\\ * or *\\ \\-nonin\\ * or *\\ \\-nonint\\ * or *\\ \\-noninte\\ * or *\\ \\-noninter\\ * or *\\ \\-nonintera\\ * or *\\ \\-noninterac\\ * or *\\ \\-noninteract\\ * or *\\ \\-noninteracti\\ * or *\\ \\-noninteractiv\\ * or *\\ \\-ec\\ * or *\\ \\-encodedcomman\\ * or *\\ \\-encodedcomma\\ * or *\\ \\-encodedcomm\\ * or *\\ \\-encodedcom\\ * or *\\ \\-encodedco\\ * or *\\ \\-encodedc\\ * or *\\ \\-encoded\\ * or *\\ \\-encode\\ * or *\\ \\-encod\\ * or *\\ \\-enco\\ * or *\\ \\-en\\ * or *\\ \\-executionpolic\\ * or *\\ \\-executionpoli\\ * or *\\ \\-executionpol\\ * or *\\ \\-executionpo\\ * or *\\ \\-executionp\\ * or *\\ \\-execution\\ bypass* or *\\ \\-executio\\ bypass* or *\\ \\-executi\\ bypass* or *\\ \\-execut\\ bypass* or *\\ \\-execu\\ bypass* or *\\ \\-exec\\ bypass* or *\\ \\-exe\\ bypass* or *\\ \\-ex\\ bypass* or *\\ \\-ep\\ bypass* or *\\ \\/windowstyle\\ h\\ * or *\\ \\/windowstyl\\ h* or *\\ \\/windowsty\\ h* or *\\ \\/windowst\\ h* or *\\ \\/windows\\ h* or *\\ \\/windo\\ h* or *\\ \\/wind\\ h* or *\\ \\/win\\ h* or *\\ \\/wi\\ h* or *\\ \\/win\\ h\\ * or *\\ \\/win\\ hi\\ * or *\\ \\/win\\ hid\\ * or *\\ \\/win\\ hidd\\ * or *\\ \\/win\\ hidde\\ * or *\\ \\/nopr\\ * or *\\ \\/nopro\\ * or *\\ \\/noprof\\ * or *\\ \\/noprofi\\ * or *\\ \\/noprofil\\ * or *\\ \\/nonin\\ * or *\\ \\/nonint\\ * or *\\ \\/noninte\\ * or *\\ \\/noninter\\ * or *\\ \\/nonintera\\ * or *\\ \\/noninterac\\ * or *\\ \\/noninteract\\ * or *\\ \\/noninteracti\\ * or *\\ \\/noninteractiv\\ * or *\\ \\/ec\\ * or *\\ \\/encodedcomman\\ * or *\\ \\/encodedcomma\\ * or *\\ \\/encodedcomm\\ * or *\\ \\/encodedcom\\ * or *\\ \\/encodedco\\ * or *\\ \\/encodedc\\ * or *\\ \\/encoded\\ * or *\\ \\/encode\\ * or *\\ \\/encod\\ * or *\\ \\/enco\\ * or *\\ \\/en\\ * or *\\ \\/executionpolic\\ * or *\\ \\/executionpoli\\ * or *\\ \\/executionpol\\ * or *\\ \\/executionpo\\ * or *\\ \\/executionp\\ * or *\\ \\/execution\\ bypass* or *\\ \\/executio\\ bypass* or *\\ \\/executi\\ bypass* or *\\ \\/execut\\ bypass* or *\\ \\/execu\\ bypass* or *\\ \\/exec\\ bypass* or *\\ \\/exe\\ bypass* or *\\ \\/ex\\ bypass* or *\\ \\/ep\\ bypass*))
<li><a href="#">query: (process.executable:(*\\\\powershell.exe or *\\\\pwsh.exe) and process.command_line:(*\\-f\\ c\\:\\\\users\\\\public* or *\\-f\\ \\\"c\\:\\\\users\\\\public* or *\\-f\\ %public%* or *\\-fi\\ c\\:\\\\users\\\\public* or *\\-fi\\ \\\"c\\:\\\\users\\\\public* or *\\-fi\\ %public%* or *\\-fil\\ c\\:\\\\users\\\\public* or *\\-fil\\ \\\"c\\:\\\\users\\\\public* or *\\-fil\\ %public%* or *\\-file\\ c\\:\\\\users\\\\public* or *\\-file\\ \\\"c\\:\\\\users\\\\public* or *\\-file\\ %public%*))
<li><a href="#">query: (process.executable:(*\\\\powershell.exe or *\\\\pwsh.exe) and process.command_line:*add\\-pssnapin\\ microsoft.exchange.powershell.snapin*)
<li><a href="#">query: (process.executable:(*\\\\powershell.exe or *\\\\pwsh.exe) and process.command_line:*convertto\\-securestring*)
<li><a href="#">query: (process.executable:(*\\\\powershell.exe or *\\\\pwsh.exe) and process.command_line:*foreach* and process.command_line:*xor*)
<li><a href="#">query: (process.executable:(*\\\\powershell.exe or *\\\\pwsh.exe) and process.command_line:*new\\-object* and process.command_line:*net.webclient\\).* and process.command_line:*download* and process.command_line:(*string\\(* or *file\\(*))
<li><a href="#">query: (process.executable:(*\\\\powershell.exe or *\\\\pwsh.exe) and process.command_line:*start\\-bitstransfer*)
<li><a href="#">query: (process.executable:(*\\\\powershell.exe or *\\\\pwsh.exe) and process.parent.executable:*\\\\excel.exe and process.command_line:*dataexchange.dll*)
<li><a href="#">query: (process.executable:(*\\\\powershell.exe or *\\\\pwsh.exe) and winlog.event_data.targetimage:*\\\\rundll32.exe)
<li><a href="#">query: (process.executable:(*\\\\powershell.exe or *\\\\wmic.exe or *\\\\vssadmin.exe) and process.command_line:*shadow* and process.command_line:*create*)
<li><a href="#">query: (process.executable:(*\\\\procdump.exe or *\\\\procdump64.exe) or (process.command_line:*\\ \\-ma\\ * and process.command_line:*.exe*))
<li><a href="#">query: (process.executable:(*\\\\pypykatz.exe or *\\\\python.exe) and process.command_line:*live* and process.command_line:*registry*)
<li><a href="#">query: (process.executable:(*\\\\regsvr32.exe or *\\\\rundll32.exe or *\\\\msiexec.exe or *\\\\mshta.exe or *\\\\verclsid.exe) and process.parent.executable:*\\\\wbem\\\\wmiprvse.exe)
<li><a href="#">query: (process.executable:(*\\\\svchost.exe or *\\\\rundll32.exe or *\\\\services.exe or *\\\\powershell.exe or *\\\\regsvr32.exe or *\\\\spoolsv.exe or *\\\\lsass.exe or *\\\\smss.exe or *\\\\csrss.exe or *\\\\conhost.exe or *\\\\wininit.exe or *\\\\lsm.exe or *\\\\winlogon.exe or *\\\\explorer.exe or *\\\\taskhost.exe or *\\\\taskmgr.exe or *\\\\sihost.exe or *\\\\runtimebroker.exe or *\\\\smartscreen.exe or *\\\\dllhost.exe or *\\\\audiodg.exe or *\\\\wlanext.exe) and (not (process.executable:(c\\:\\\\windows\\\\system32\\\\* or c\\:\\\\windows\\\\system32\\\\* or c\\:\\\\windows\\\\syswow64\\\\* or c\\:\\\\windows\\\\syswow64\\\\* or c\\:\\\\windows\\\\winsxs\\\\* or c\\:\\\\windows\\\\winsxs\\\\* or c\\:\\\\avast\\!\\ sandbox*) or process.executable:*\\\\systemroot\\\\system32\\\\* or process.executable:\"c\\:\\\\windows\\\\explorer.exe\")))
<li><a href="#">query: (process.executable:(*\\\\svchost.exe or *\\\\taskhost.exe or *\\\\lsm.exe or *\\\\lsass.exe or *\\\\services.exe or *\\\\lsaiso.exe or *\\\\csrss.exe or *\\\\wininit.exe or *\\\\winlogon.exe) and (not ((process.parent.executable:(*\\\\savservice.exe or *\\\\ngen.exe) or process.parent.executable:(*\\\\system32\\\\* or *\\\\syswow64\\\\*)) or (process.parent.executable:(*\\\\windows\\ defender\\\\* or *\\\\microsoft\\ security\\ client\\\\*) and process.parent.executable:*\\\\msmpeng.exe) or (not _exists_:process.parent.executable or process.parent.executable:\"\\-\"))))
<li><a href="#">query: (process.executable:(*\\\\sysmon64.exe or *\\\\sysmon.exe) and process.command_line:*\\-u*)
<li><a href="#">query: (process.executable:(*\\\\system32\\\\cscript.exe or *\\\\system32\\\\wscript.exe or *\\\\system32\\\\mshta.exe or *\\\\winword.exe or *\\\\excel.exe) and winlog.event_data.targetimage:*\\\\syswow64\\\\* and not _exists_:winlog.event_data.startmodule)
<li><a href="#">query: (process.executable:(*\\\\tasksche.exe or *\\\\mssecsvc.exe or *\\\\taskdl.exe or *\\\\taskhsvc.exe or *\\\\taskse.exe or *\\\\111.exe or *\\\\lhdfrgui.exe or *\\\\diskpart.exe or *\\\\linuxnew.exe or *\\\\wannacry.exe) or process.executable:*wanadecryptor* or (process.command_line:*icacls* and process.command_line:*\\/grant* and process.command_line:*everyone\\:f* and process.command_line:*\\/t* and process.command_line:*\\/c* and process.command_line:*\\/q*) or (process.command_line:*bcdedit* and process.command_line:*\\/set* and process.command_line:*\\{default\\}* and process.command_line:*recoveryenabled* and process.command_line:*no*) or (process.command_line:*wbadmin* and process.command_line:*delete* and process.command_line:*catalog* and process.command_line:*\\-quiet*) or process.command_line:*@please_read_me@.txt*)
<li><a href="#">query: (process.executable:(*\\\\tasksche.exe or *\\\\mssecsvc.exe or *\\\\taskdl.exe or *\\\\taskhsvc.exe or *\\\\taskse.exe or *\\\\111.exe or *\\\\lhdfrgui.exe or *\\\\linuxnew.exe or *\\\\wannacry.exe) or process.executable:*wanadecryptor* or (process.command_line:*icacls* and process.command_line:*\\/grant* and process.command_line:*everyone\\:f* and process.command_line:*\\/t* and process.command_line:*\\/c* and process.command_line:*\\/q*) or (process.command_line:*bcdedit* and process.command_line:*\\/set* and process.command_line:*\\{default\\}* and process.command_line:*recoveryenabled* and process.command_line:*no*) or (process.command_line:*wbadmin* and process.command_line:*delete* and process.command_line:*catalog* and process.command_line:*\\-quiet*) or process.command_line:*@please_read_me@.txt*)
<li><a href="#">query: (process.executable:(*\\\\tree.com or *\\\\wmic.exe or *\\\\doskey.exe or *\\\\sc.exe) and process.parent.command_line:*\\ >\\ %temp%\\\\*)
<li><a href="#">query: (process.executable:(*\\\\users\\\\all\\ users\\\\* or *\\\\users\\\\default\\\\* or *\\\\users\\\\public\\\\* or *\\\\users\\\\contacts\\\\* or *\\\\users\\\\searches\\\\* or *\\\\config\\\\systemprofile\\\\* or *\\\\windows\\\\fonts\\\\* or *\\\\windows\\\\ime\\\\* or *\\\\windows\\\\addins\\\\*) or process.executable:*\\\\$recycle.bin or process.executable:c\\:\\\\perflogs\\\\*)
<li><a href="#">query: (process.executable:(*\\\\users\\\\public\\\\* or *\\\\$recycle.bin* or *\\\\users\\\\all\\ users\\\\* or *\\\\users\\\\default\\\\* or *\\\\users\\\\contacts\\\\* or *\\\\users\\\\searches\\\\* or *c\\:\\\\perflogs\\\\* or *\\\\config\\\\systemprofile\\\\* or *\\\\windows\\\\fonts\\\\* or *\\\\windows\\\\ime\\\\* or *\\\\windows\\\\addins\\\\*) and process.parent.executable:(*\\\\services.exe or *\\\\svchost.exe))
<li><a href="#">query: (process.executable:(*\\\\winword.exe or *\\\\powerpnt.exe or *\\\\excel.exe or *\\\\outlook.exe) and file.path:(*\\\\vbe7.dll or *\\\\vbeui.dll or *\\\\vbe7intl.dll))
<li><a href="#">query: (process.executable:(*\\\\winword.exe or *\\\\powerpnt.exe or *\\\\excel.exe or *\\\\outlook.exe) and file.path:(*\\\\wmiutils.dll or *\\\\wbemcomn.dll or *\\\\wbemprox.dll or *\\\\wbemdisp.dll))
<li><a href="#">query: (process.executable:(*\\\\winword.exe or *\\\\powerpnt.exe or *\\\\excel.exe or *\\\\outlook.exe) and file.path:*\\\\clr.dll*)
<li><a href="#">query: (process.executable:(*\\\\winword.exe or *\\\\powerpnt.exe or *\\\\excel.exe or *\\\\outlook.exe) and file.path:*\\\\dsparse.dll*)
<li><a href="#">query: (process.executable:(*\\\\winword.exe or *\\\\powerpnt.exe or *\\\\excel.exe or *\\\\outlook.exe) and file.path:*\\\\kerberos.dll)
<li><a href="#">query: (process.executable:(*\\\\winword.exe or *\\\\powerpnt.exe or *\\\\excel.exe or *\\\\outlook.exe) and file.path:c\\:\\\\windows\\\\assembly\\\\*)
<li><a href="#">query: (process.executable:(*\\\\winword.exe or *\\\\powerpnt.exe or *\\\\excel.exe or *\\\\outlook.exe) and file.path:c\\:\\\\windows\\\\microsoft.net\\\\assembly\\\\gac_msil*)
<li><a href="#">query: (process.executable:(*\\\\wscript.exe or *\\\\cscript.exe or *\\\\mshta.exe) and file.path:(*\\\\clr.dll or *\\\\mscoree.dll or *\\\\mscorlib.dll))
<li><a href="#">query: (process.executable:(*\\\\wscript.exe or *\\\\cscript.exe) and file.path:(c\\:\\\\users\\\\* or c\\:\\\\programdata*) and file.path:(*.jse or *.vbe or *.js or *.vba or *.vbs))
<li><a href="#">query: (process.executable:(*\\\\wscript.exe or *\\\\cscript.exe) and process.command_line:(*.jse* or *.vbe* or *.js* or *.vba*))
<li><a href="#">query: (process.executable:(*\\\\wwwroot\\\\* or *\\\\wmpub\\\\* or *\\\\htdocs\\\\*) and (not (process.executable:(*bin\\\\* or *\\\\tools\\\\* or *\\\\smscomponent\\\\*) and process.parent.executable:*\\\\services.exe)))
<li><a href="#">query: (process.executable:(*chrome.exe or *firefox.exe or *microsoftedge.exe or *microsoftedgecp.exe or *msedge.exe or *iexplorer.exe or *brave.exe or *opera.exe) and file.path:*.vhd*)
<li><a href="#">query: (process.executable:(*petitpotam* or *rottenpotato* or *hotpotato* or *juicypotato* or *\\\\just_dce_* or *juicy\\ potato* or *\\\\temp\\\\rot.exe* or *\\\\potato.exe* or *\\\\spoolsample.exe* or *\\\\responder.exe* or *\\\\smbrelayx* or *\\\\ntlmrelayx*) or process.command_line:(*invoke\\-tater* or *\\ smbrelay* or *\\ ntlmrelay* or *cme\\ smb\\ * or *\\ \\/ntlm\\:ntlmhash\\ * or *invoke\\-petitpotam*))
<li><a href="#">query: (process.executable:(*python.exe or *python3.exe or *python2.exe) and ((process.command_line:*import\\ pty* and process.command_line:*.spawn\\(*) or process.command_line:*from\\ pty\\ import\\ spawn*))
<li><a href="#">query: (process.executable:(*regsvr32 or *rundll32 or *msiexec or *mshta or *verclsid) and process.parent.executable:(*winword.exe or *excel.exe or *powerpnt.exe))
<li><a href="#">query: (process.executable:(*regsvr32 or *rundll32 or *msiexec or *mshta or *verclsid) and process.parent.executable:*\\\\wbem\\\\wmiprvse.exe)
<li><a href="#">query: (process.executable:(*rundll32.exe* or *cmd.exe*) and process.command_line:(*gthread\\-3.6.dll* or *\\\\windows\\\\temp\\\\tmp.bat* or *sigcmm\\-2.4.dll*))
<li><a href="#">query: (process.executable:(\"\\/bin\\/dd\" or \"\\/usr\\/bin\\/dd\") and process.command_line:*of\\=* and process.command_line:(*if\\=\\/dev\\/zero* or *if\\=\\/dev\\/null*))
<li><a href="#">query: (process.executable:(\"\\/usr\\/sbin\\/netstat\" or \"\\/sbin\\/ifconfig\" or \"\\/usr\\/sbin\\/ipconfig\" or \"\\/usr\\/libexec\\/applicationfirewall\\/socketfilterfw\" or \"\\/usr\\/sbin\\/networksetup\" or \"\\/usr\\/sbin\\/arp\") or (process.executable:\"\\/usr\\/bin\\/defaults\" and process.command_line:*read* and process.command_line:*\\/library\\/preferences\\/com.apple.alf*))
<li><a href="#">query: (process.executable:*\\/base64 and process.command_line:*\\-d*)
<li><a href="#">query: (process.executable:*\\/bin\\/bash and (not (destination.ip:(\"127.0.0.1\" or \"0.0.0.0\"))))
<li><a href="#">query: (process.executable:*\\/chmod and process.command_line:(*\\/tmp\\/* or *\\/.library\\/* or *\\/etc\\/* or *\\/opt\\/*))
<li><a href="#">query: (process.executable:*\\/crontab and process.command_line:*\\/tmp\\/*)
<li><a href="#">query: (process.executable:*\\/dscl and process.command_line:*create* and ((process.command_line:*uniqueid* and process.command_line:/([0-9]|[1-9][0-9]|[1-4][0-9]{2})/) or (process.command_line:*ishidden* and process.command_line:(*true* or *yes* or *1*))))
<li><a href="#">query: (process.executable:*\\/dscl and process.command_line:*create*)
<li><a href="#">query: (process.executable:*\\/grep and process.command_line:(*nessusd* or *td\\-agent* or *packetbeat* or *filebeat* or *auditbeat* or *osqueryd* or *cbagentd* or *falcond*))
<li><a href="#">query: (process.executable:*\\/groups or (process.executable:*\\/cat and process.command_line:*\\/etc\\/group*))
<li><a href="#">query: (process.executable:*\\/lastlog or process.command_line:*'x\\:0\\:'* or (process.executable:*\\/cat and process.command_line:(*\\/etc\\/passwd* or *\\/etc\\/sudoers*)) or process.executable:*\\/id or (process.executable:*\\/lsof and process.command_line:*\\-u*))
<li><a href="#">query: (process.executable:*\\/osascript and process.command_line:*\\-e*)
<li><a href="#">query: (process.executable:*\\/rm and (process.command_line:*\\/var\\/log* or (process.command_line:*\\/users\\/* and process.command_line:*\\/library\\/logs\\/*)))
<li><a href="#">query: (process.executable:*\\/sudo and process.command_line:*\\ tc\\ * and process.command_line:*\\ enp0s3\\ * and process.command_line:(*\\ qdisc\\ * or *\\ filter\\ *))
<li><a href="#">query: (process.executable:*\\/sudo and process.command_line:*execve_hijack*)
<li><a href="#">query: (process.executable:*\\/touch and process.command_line:(*\\-t* or *\\-acmr* or *\\-d* or *\\-r*))
<li><a href="#">query: (process.executable:*\\/xattr and process.command_line:*\\-r* and process.command_line:*com.apple.quarantine*)
<li><a href="#">query: (process.executable:*\\:\\\\windows\\\\syswow64\\\\* and winlog.event_data.grantedaccess:\"0x1fffff\" and winlog.event_data.calltrace:unknown\\(0000000000000000\\)|unknown\\(0000000000000000\\)|*)
<li><a href="#">query: (process.executable:*\\\\acccheckconsole.exe and process.command_line:*\\ \\-window\\ * and process.command_line:*.dll*)
<li><a href="#">query: (process.executable:*\\\\adfind.exe and (process.command_line:(*lockoutduration* or *lockoutthreshold* or *lockoutobservationwindow* or *maxpwdage* or *minpwdage* or *minpwdlength* or *pwdhistorylength* or *pwdproperties*) or process.command_line:*\\-sc\\ admincountdmp* or process.command_line:*\\-sc\\ exchaddresses*))
<li><a href="#">query: (process.executable:*\\\\adobe\\ creative\\ cloud\\ experience\\\\libs\\\\node.exe and (not (process.command_line:*adobe\\ creative\\ cloud\\ experience\\\\js*)))
<li><a href="#">query: (process.executable:*\\\\advanced_ip_scanner* or (process.command_line:*\\/portable* and process.command_line:*\\/lng*))
<li><a href="#">query: (process.executable:*\\\\advanced_port_scanner* or (process.command_line:*\\/portable* and process.command_line:*\\/lng*))
<li><a href="#">query: (process.executable:*\\\\advancedrun.exe or (process.command_line:*\\ \\/exefilename\\ * and process.command_line:*\\ \\/run*) or (process.command_line:*\\ \\/windowstate\\ 0* and process.command_line:*\\ \\/runas\\ * and process.command_line:*\\ \\/commandline\\ *))
<li><a href="#">query: (process.executable:*\\\\appcmd.exe and process.command_line:*install* and process.command_line:*module* and process.command_line:*\\/name\\:*)
<li><a href="#">query: (process.executable:*\\\\appcmd.exe and process.command_line:*set* and process.command_line:*config* and process.command_line:*\\/section\\:httplogging* and process.command_line:*\\/dontlog\\:true*)
<li><a href="#">query: (process.executable:*\\\\at.exe and process.command_line:*interactive*)
<li><a href="#">query: (process.executable:*\\\\attrib.exe and process.command_line:*\\ \\+s\\ *)
<li><a href="#">query: (process.executable:*\\\\auditpol.exe and process.command_line:(*disable* or *clear* or *remove* or *restore*))
<li><a href="#">query: (process.executable:*\\\\bcdedit.exe and process.command_line:(*delete* or *deletevalue* or *import* or *safeboot* or *network*))
<li><a href="#">query: (process.executable:*\\\\bginfo.exe and process.command_line:*\\/popup* and process.command_line:*\\/nolicprompt*)
<li><a href="#">query: (process.executable:*\\\\bitsadmin.exe and process.command_line:(*\\ \\/transfer\\ * or *\\ \\/create\\ * or *\\ \\/addfile\\ *) and process.command_line:(*.asax* or *.ashx* or *.asmx* or *.asp* or *.aspx* or *.bat* or *.cfm* or *.cgi* or *.chm* or *.cmd* or *.gif* or *.jpeg* or *.jpg* or *.jsp* or *.jspx* or *.png* or *.ps1* or *.psm1* or *.scf* or *.sct* or *.txt* or *.vbe* or *.vbs* or *.war* or *.wsf* or *.wsh* or *.zip* or *.rar* or *.dll*))
<li><a href="#">query: (process.executable:*\\\\bitsadmin.exe and process.command_line:(*\\ \\/transfer\\ * or *\\ \\/create\\ * or *\\ \\/addfile\\ *) and process.command_line:(*c\\:\\\\users\\\\public\\\\* or *%public%* or *\\\\desktop\\\\*))
<li><a href="#">query: (process.executable:*\\\\bitsadmin.exe and process.command_line:(*\\ \\/transfer\\ * or *\\ \\/create\\ * or *\\ \\/addfile\\ *) and process.command_line:(*c\\:\\\\windows\\\\temp\\\\* or *%temp%* or *c\\:\\\\programdata\\\\* or *%programdata%* or *\\\\appdata\\\\local\\\\* or *%appdata%*))
<li><a href="#">query: (process.executable:*\\\\bitsadmin.exe and process.command_line:(*\\ \\/transfer\\ * or *\\ \\/create\\ * or *\\ \\/addfile\\ *) and process.command_line:(*http\\:\\/\\/1* or *http\\:\\/\\/2* or *http\\:\\/\\/3* or *http\\:\\/\\/4* or *http\\:\\/\\/5* or *http\\:\\/\\/6* or *http\\:\\/\\/7* or *http\\:\\/\\/8* or *http\\:\\/\\/9* or *https\\:\\/\\/1* or *https\\:\\/\\/2* or *https\\:\\/\\/3* or *https\\:\\/\\/4* or *https\\:\\/\\/5* or *https\\:\\/\\/6* or *https\\:\\/\\/7* or *https\\:\\/\\/8* or *https\\:\\/\\/9*))
<li><a href="#">query: (process.executable:*\\\\bitsadmin.exe and process.command_line:(*\\ \\/transfer\\ * or *\\ \\/create\\ * or *\\ \\/addfile\\ *) and process.command_line:(*raw.githubusercontent.com* or *gist.githubusercontent.com* or *pastebin.com* or *cdn.discordapp.com\\/attachments\\/* or *mediafire.com* or *mega.nz* or *ddns.net* or *.paste.ee* or *.hastebin.com* or *.ghostbin.co\\/* or *ufile.io* or *storage.googleapis.com*))
<li><a href="#">query: (process.executable:*\\\\cdb.exe and process.command_line:*\\-cf*)
<li><a href="#">query: (process.executable:*\\\\certoc.exe and process.command_line:*\\-loaddll* and process.command_line:*.dll*)
<li><a href="#">query: (process.executable:*\\\\certreq.exe and process.command_line:*\\ \\-post\\ * and process.command_line:*\\ \\-config\\ * and process.command_line:*\\ http* and process.command_line:*\\ c\\:\\\\windows\\\\win.ini\\ *)
<li><a href="#">query: (process.executable:*\\\\certutil.exe and process.command_line:*\\-f* and process.command_line:*\\-encode*)
<li><a href="#">query: (process.executable:*\\\\changepk.exe and process.parent.executable:*\\\\slui.exe and integritylevel:(\"high\" or \"system\"))
<li><a href="#">query: (process.executable:*\\\\chcp.com and process.command_line:(*\\ 936 or *\\ 1258))
<li><a href="#">query: (process.executable:*\\\\chrome.exe and process.parent.executable:(*\\\\powershell.exe or *\\\\pwsh.exe) and process.command_line:*\\-\\-load\\-extension\\=* and process.command_line:*\\\\appdata\\\\local\\\\*)
<li><a href="#">query: (process.executable:*\\\\cipher.exe and process.command_line:*\\ \\/w\\:*)
<li><a href="#">query: (process.executable:*\\\\cmd.exe and file.path:(*.vhd or *.bac or *.bak or *.wbcat or *.bkf or *.set or *.win or *.dsk))
<li><a href="#">query: (process.executable:*\\\\cmd.exe and file.path:*\\\\users\\\\* and file.path:*\\\\desktop\\\\* and file.path:*.txt)
<li><a href="#">query: (process.executable:*\\\\cmd.exe and process.command_line:*\\ >\\ %userprofile%\\\\* and process.command_line:*\\ >\\ %appdata%\\\\* and process.command_line:*\\ >\\ \\\\users\\\\public\\\\* and process.command_line:*\\ >\\ c\\:\\\\users\\\\public\\\\* and process.command_line:*\\ >\\ %temp%\\\\*)
<li><a href="#">query: (process.executable:*\\\\cmd.exe and process.command_line:*\\/q* and process.command_line:*\\/c* and process.command_line:*chcp*)
<li><a href="#">query: (process.executable:*\\\\cmd.exe and process.command_line:*>*)
<li><a href="#">query: (process.executable:*\\\\cmd.exe and process.command_line:*>*\\:*)
<li><a href="#">query: (process.executable:*\\\\cmd.exe and process.command_line:*http* and process.command_line:*\\:\\/\\/* and process.command_line:*%appdata%*)
<li><a href="#">query: (process.executable:*\\\\cmd.exe and process.parent.executable:*\\\\elevation_service.exe and integritylevel:\"system\")
<li><a href="#">query: (process.executable:*\\\\cmdkey.exe and process.command_line:*\\ \\/list*)
<li><a href="#">query: (process.executable:*\\\\cmstp.exe and process.command_line:(*\\/s* or *\\/au*))
<li><a href="#">query: (process.executable:*\\\\colorcpl.exe and (not (file.path:(*.icm or *.gmmp or *.cdmp or *.camp))))
<li><a href="#">query: (process.executable:*\\\\createminidump.exe* or winlog.event_data.imphash:\"4a07f944a83e8a7c2525efa35dd30e2f\" or winlog.event_data.hashes:*imphash\\=4a07f944a83e8a7c2525efa35dd30e2f*)
<li><a href="#">query: (process.executable:*\\\\createminidump.exe* or winlog.event_data.imphash:\"4a07f944a83e8a7c2525efa35dd30e2f\")
<li><a href="#">query: (process.executable:*\\\\csc.exe and process.parent.executable:(*\\\\wscript.exe or *\\\\cscript.exe or *\\\\mshta.exe))
<li><a href="#">query: (process.executable:*\\\\cscript.exe and process.command_line:*.vbs* and process.command_line:*\\/shell*)
<li><a href="#">query: (process.executable:*\\\\cscript.exe and process.command_line:*.vbs*)
<li><a href="#">query: (process.executable:*\\\\cscript.exe and process.command_line:*\\-register* and process.command_line:(*\\\\windows\\ kits\\\\10\\\\bin\\\\10.0.22000.0\\\\x64* or *\\\\windows\\ kits\\\\10\\\\bin\\\\10.0.19041.0\\\\x64* or *\\\\windows\\ kits\\\\10\\\\bin\\\\10.0.17763.0\\\\x64*))
<li><a href="#">query: (process.executable:*\\\\cscript.exe and process.command_line:*winrm* and process.command_line:*invoke\\ create\\ wmicimv2\\/win32_* and process.command_line:*\\-r\\:http*)
<li><a href="#">query: (process.executable:*\\\\csi.exe and process.parent.executable:(*\\\\powershell.exe or *\\\\pwsh.exe or *\\\\powershell_ise.exe) and winlog.event_data.originalfilename:\"csi.exe\")
<li><a href="#">query: (process.executable:*\\\\csi.exe and process.parent.executable:*\\\\powershell.exe and winlog.event_data.originalfilename:\"csi.exe\")
<li><a href="#">query: (process.executable:*\\\\curl.exe and process.command_line:(*\\ \\-f\\ * or *\\ \\-t\\ * or *\\ \\-\\-upload\\-file\\ * or *\\ \\-d\\ * or *\\ \\-\\-data\\ *))
<li><a href="#">query: (process.executable:*\\\\curl.exe or product:\"the\\ curl\\ executable\")
<li><a href="#">query: (process.executable:*\\\\cve\\-202* or process.executable:(*\\\\poc.exe or *\\\\artifact.exe or *\\\\artifact64.exe or *\\\\artifact_protected.exe or *\\\\artifact32.exe or *\\\\artifact32big.exe or *obfuscated.exe or *obfusc.exe or *\\\\meterpreter) or process.command_line:(*inject.ps1* or *invoke\\-cve* or *pupy.ps1* or *payload.ps1* or *beacon.ps1* or *powerview.ps1* or *bypass.ps1* or *obfuscated.ps1* or *obfusc.ps1* or *obfus.ps1* or *obfs.ps1* or *evil.ps1* or *minidogz.ps1* or *_enc.ps1* or *\\\\shell.ps1* or *\\\\rshell.ps1* or *revshell.ps1* or *\\\\av.ps1* or *\\\\av_test.ps1* or *adrecon.ps1* or *mimikatz.ps1* or *\\\\powerup_* or *powerup.ps1* or *\\\\temp\\\\a.ps1* or *\\\\temp\\\\p.ps1* or *\\\\temp\\\\1.ps1* or *hound.ps1* or *encode.ps1* or *powercat.ps1*))
<li><a href="#">query: (process.executable:*\\\\dctask64.exe and (not (process.command_line:*desktopcentral_agent\\\\agent*)))
<li><a href="#">query: (process.executable:*\\\\devtoolslauncher.exe and process.command_line:*launchfordeploy*)
<li><a href="#">query: (process.executable:*\\\\diskshadow.exe and process.command_line:(*\\/s* or *\\-s*))
<li><a href="#">query: (process.executable:*\\\\ditsnap.exe or process.command_line:*ditsnap.exe*)
<li><a href="#">query: (process.executable:*\\\\dnscmd.exe and process.command_line:*\\/config* and process.command_line:*\\/serverlevelplugindll*)
<li><a href="#">query: (process.executable:*\\\\dump64.exe and ((not (process.executable:*\\\\installer\\\\feedback\\\\dump64.exe*)) or process.command_line:(*\\ \\-ma\\ * or *accpeteula*)))
<li><a href="#">query: (process.executable:*\\\\dumpminitool.exe or originalname:\"dumpminitool.exe\" or (process.command_line:*\\ \\-\\-processid\\ * and process.command_line:*\\ \\-\\-dumptype\\ full*))
<li><a href="#">query: (process.executable:*\\\\dumpstack.log or process.command_line:*\\ \\-o\\ dumpstack.log*)
<li><a href="#">query: (process.executable:*\\\\dumpstack.log or process.command_line:\"\\ \\-o\\ dumpstack.log\")
<li><a href="#">query: (process.executable:*\\\\dxcap.exe and process.command_line:*\\-c* and process.command_line:*.exe*)
<li><a href="#">query: (process.executable:*\\\\esentutl.exe and process.command_line:*\\/r\\ * and process.command_line:*\\\\windows\\\\webcache*)
<li><a href="#">query: (process.executable:*\\\\expand.exe and process.command_line:(*.cab* or *\\/f\\:* or *\\-f\\:* or *c\\:\\\\programdata\\\\* or *c\\:\\\\public\\\\* or *\\\\appdata\\\\local\\\\temp\\\\* or *\\\\appdata\\\\roaming\\\\temp\\\\*))
<li><a href="#">query: (process.executable:*\\\\explorer.exe and process.parent.executable:*\\\\cmd.exe and process.command_line:*explorer.exe*)
<li><a href="#">query: (process.executable:*\\\\findstr.exe and process.command_line:*.lnk)
<li><a href="#">query: (process.executable:*\\\\findstr.exe and process.command_line:*\\ 385201*)
<li><a href="#">query: (process.executable:*\\\\findstr.exe and process.command_line:*cpassword* and process.command_line:*\\\\sysvol\\\\* and process.command_line:*.xml*)
<li><a href="#">query: (process.executable:*\\\\fltmc.exe and process.command_line:*unload* and process.command_line:*sys*)
<li><a href="#">query: (process.executable:*\\\\fsianycpu.exe or winlog.event_data.originalfilename:\"fsianycpu.exe\" or process.executable:*\\\\fsi.exe or winlog.event_data.originalfilename:\"fsi.exe\")
<li><a href="#">query: (process.executable:*\\\\fsutil.exe and process.command_line:*behavior\\ * and process.command_line:*set\\ * and process.command_line:*symlinkevaluation*)
<li><a href="#">query: (process.executable:*\\\\gpresult.exe and process.command_line:(*\\/z* or *\\/v*))
<li><a href="#">query: (process.executable:*\\\\gup.exe and (not (process.executable:(*\\\\users\\\\*\\\\appdata\\\\local\\\\notepad\\+\\+\\\\updater\\\\gup.exe or *\\\\users\\\\*\\\\appdata\\\\roaming\\\\notepad\\+\\+\\\\updater\\\\gup.exe or *\\\\program\\ files\\\\notepad\\+\\+\\\\updater\\\\gup.exe or *\\\\program\\ files\\ \\(x86\\)\\\\notepad\\+\\+\\\\updater\\\\gup.exe))))
<li><a href="#">query: (process.executable:*\\\\hashcat.exe or (process.command_line:*\\-a\\ * and process.command_line:*\\-m\\ 1000\\ * and process.command_line:*\\-r\\ *))
<li><a href="#">query: (process.executable:*\\\\hh.exe and process.command_line:*.chm*)
<li><a href="#">query: (process.executable:*\\\\ie4uinit.exe and (not ((process.working_directory:(\"c\\:\\\\windows\\\\system32\\\\\" or \"c\\:\\\\windows\\\\syswow64\\\\\")) or (not _exists_:process.working_directory))))
<li><a href="#">query: (process.executable:*\\\\installutil.exe and process.executable:*microsoft.net\\\\framework* and process.command_line:*\\/logfile\\=\\ * and process.command_line:*\\/logtoconsole\\=false*)
<li><a href="#">query: (process.executable:*\\\\iodine.exe or process.executable:*\\\\dnscat2*)
<li><a href="#">query: (process.executable:*\\\\krbrelay.exe or originalfilename:\"krbrelay.exe\" or (process.command_line:*\\ \\-spn\\ * and process.command_line:*\\ \\-clsid\\ * and process.command_line:*\\ \\-rbcd\\ *) or (process.command_line:*shadowcred* and process.command_line:*clsid* and process.command_line:*spn*) or (process.command_line:*spn\\ * and process.command_line:*session\\ * and process.command_line:*clsid\\ *))
<li><a href="#">query: (process.executable:*\\\\krbrelayup.exe or originalfilename:\"krbrelayup.exe\" or (process.command_line:*\\ relay\\ * and process.command_line:*\\ \\-domain\\ * and process.command_line:*\\ \\-computername\\ *) or (process.command_line:*\\ krbscm\\ * and process.command_line:*\\ \\-sc\\ *) or (process.command_line:*\\ spawn\\ * and process.command_line:*\\ \\-d\\ * and process.command_line:*\\ \\-cn\\ * and process.command_line:*\\ \\-cp\\ *))
<li><a href="#">query: (process.executable:*\\\\lsass.exe and signed:\"false\")
<li><a href="#">query: (process.executable:*\\\\microsoft.workflow.compiler.exe or (winlog.event_data.originalfilename:\"microsoft.workflow.compiler.exe\" and process.command_line:*.xml*))
<li><a href="#">query: (process.executable:*\\\\mobsync.exe and (not (destination.ip:(10.* or 192.168.* or 172.16.* or 172.17.* or 172.18.* or 172.19.* or 172.20.* or 172.21.* or 172.22.* or 172.23.* or 172.24.* or 172.25.* or 172.26.* or 172.27.* or 172.28.* or 172.29.* or 172.30.* or 172.31.*) and destinationisipv6:\"false\")))
<li><a href="#">query: (process.executable:*\\\\mobsync.exe and file.path:(*.dll or *.exe))
<li><a href="#">query: (process.executable:*\\\\mofcomp.exe and (process.parent.executable:(*\\\\cmd.exe or *\\\\powershell.exe or *\\\\pwsh.exe or *\\\\wsl.exe or *\\\\wscript.exe or *\\\\cscript.exe) or process.command_line:(*\\\\appdata\\\\local\\\\temp* or *\\\\users\\\\public\\\\* or *\\\\windows\\\\temp\\\\* or *%temp%* or *%appdata%*)))
<li><a href="#">query: (process.executable:*\\\\msbuild.exe and destination.port:(\"80\" or \"443\") and winlog.event_data.initiated:\"true\")
<li><a href="#">query: (process.executable:*\\\\msdt.exe and file.path:*\\\\sdiageng.dll)
<li><a href="#">query: (process.executable:*\\\\msexchangemailboxreplication.exe and file.path:(*.aspx or *.asp))
<li><a href="#">query: (process.executable:*\\\\mshta.exe and (((process.parent.executable:(*\\\\cmd.exe or *\\\\powershell.exe) or process.command_line:(*\\\\appdata\\\\local* or *c\\:\\\\windows\\\\temp* or *c\\:\\\\users\\\\public*)) or (not (process.executable:(*c\\:\\\\windows\\\\system32* or *c\\:\\\\windows\\\\syswow64*)))) or (not (process.command_line:(*.htm* or *.hta*) and process.command_line:(*mshta.exe or *mshta)))))
<li><a href="#">query: (process.executable:*\\\\mshta.exe and process.command_line:(*vbscript* or *.jpg* or *.png* or *.lnk* or *.xls* or *.doc* or *.zip* or *.dll* or *.exe*))
<li><a href="#">query: (process.executable:*\\\\mshta.exe and process.command_line:*javascript*)
<li><a href="#">query: (process.executable:*\\\\mshta.exe and process.parent.executable:*\\\\wmiprvse.exe)
<li><a href="#">query: (process.executable:*\\\\msiexec.exe and (not (process.executable:(c\\:\\\\windows\\\\system32\\\\* or c\\:\\\\windows\\\\syswow64\\\\* or c\\:\\\\windows\\\\winsxs\\\\*))))
<li><a href="#">query: (process.executable:*\\\\msiexec.exe and file.path:c\\:\\\\program\\ files\\ \\(x86\\)\\\\microsoft\\\\edge\\\\application* and file.path:*\\\\elevation_service.exe)
<li><a href="#">query: (process.executable:*\\\\msiexec.exe and process.command_line:*\\ \\/i* and process.command_line:*\\ \\/q*)
<li><a href="#">query: (process.executable:*\\\\mstsc.exe and file.path:*\\\\microsoft\\\\windows\\\\start\\ menu\\\\programs\\\\startup\\\\*)
<li><a href="#">query: (process.executable:*\\\\ncat.exe or process.command_line:(*\\ \\-lvp\\ * or *\\ \\-l\\ \\-\\-proxy\\-type\\ http\\ * or *\\ \\-\\-exec\\ cmd.exe\\ * or *\\ \\-vnl\\ \\-\\-exec\\ *))
<li><a href="#">query: (process.executable:*\\\\netsh.exe and ((process.command_line:*interface* and process.command_line:*portproxy* and process.command_line:*add* and process.command_line:*v4tov4*) or (process.command_line:*connectp* and process.command_line:*listena* and process.command_line:*c\\=*)))
<li><a href="#">query: (process.executable:*\\\\netsh.exe and process.command_line:*add* and process.command_line:*helper*)
<li><a href="#">query: (process.executable:*\\\\netsh.exe and process.command_line:*advfirewall* and process.command_line:*firewall* and process.command_line:*set* and process.command_line:*rule* and process.command_line:*group\\=* and process.command_line:*new* and process.command_line:*enable\\=yes*)
<li><a href="#">query: (process.executable:*\\\\netsh.exe and process.command_line:*i* and process.command_line:*\\ p* and process.command_line:*\\=3389* and process.command_line:*\\ c*)
<li><a href="#">query: (process.executable:*\\\\netsh.exe and process.command_line:*wlan* and process.command_line:*\\ s* and process.command_line:*\\ p* and process.command_line:*\\ k* and process.command_line:*\\=clear*)
<li><a href="#">query: (process.executable:*\\\\nircmd.exe or (process.command_line:*\\ execmd\\ * and process.command_line:*\\ attrib\\ *) or (process.command_line:*\\ execmd\\ * and process.command_line:*\\ copy\\ *) or (process.command_line:*\\ execmd\\ * and process.command_line:*\\ del\\ * and process.command_line:*\\ \\/q\\ *))
<li><a href="#">query: (process.executable:*\\\\nltest.exe and ((process.command_line:*\\/server* and process.command_line:*\\/query*) or process.command_line:(*\\/dclist\\:* or *\\/parentdomain* or *\\/domain_trusts* or *\\/trusted_domains* or *\\/user*)))
<li><a href="#">query: (process.executable:*\\\\notepad.exe and (not (destination.port:\"9100\")))
<li><a href="#">query: (process.executable:*\\\\notepad.exe and file.path:(*\\\\samlib.dll or *\\\\winscard.dll))
<li><a href="#">query: (process.executable:*\\\\nsudo.exe and process.command_line:*\\ \\-u\\:s\\ *)
<li><a href="#">query: (process.executable:*\\\\offlinescannershell.exe and (not ((process.working_directory:\"c\\:\\\\program\\ files\\\\windows\\ defender\\\\offline\\\\\") or (not _exists_:process.working_directory))))
<li><a href="#">query: (process.executable:*\\\\openwith.exe and process.command_line:*\\/c*)
<li><a href="#">query: (process.executable:*\\\\outlook.exe and file.path:*\\\\appdata\\\\local\\\\microsoft\\\\forms\\\\*)
<li><a href="#">query: (process.executable:*\\\\pcwrun.exe and process.command_line:*..\\/*)
<li><a href="#">query: (process.executable:*\\\\ping.exe and process.command_line:*0x*)
<li><a href="#">query: (process.executable:*\\\\powershell.exe and ((((process.command_line:(*toint* or *todecimal* or *tobyte* or *touint* or *tosingle* or *tosbyte*) and process.command_line:(*tochar* or *tostring* or *string*)) or (process.command_line:*char* and process.command_line:*join*)) or (process.command_line:*split* and process.command_line:*join*)) or (process.command_line:*foreach* and process.command_line:*xor*) or process.command_line:*convertto\\-securestring*))
<li><a href="#">query: (process.executable:*\\\\powershell.exe and (not (process.parent.executable:(*\\\\explorer.exe or *\\\\compattelrunner.exe))))
<li><a href="#">query: (process.executable:*\\\\powershell.exe and file.path:*.bat)
<li><a href="#">query: (process.executable:*\\\\powershell.exe and file.path:*\\\\start\\ menu\\\\programs\\\\startup\\\\* and file.path:*.lnk)
<li><a href="#">query: (process.executable:*\\\\powershell.exe and process.command_line:(*\\ \\-windowstyle\\ h\\ * or *\\ \\-windowstyl\\ h* or *\\ \\-windowsty\\ h* or *\\ \\-windowst\\ h* or *\\ \\-windows\\ h* or *\\ \\-windo\\ h* or *\\ \\-wind\\ h* or *\\ \\-win\\ h* or *\\ \\-wi\\ h* or *\\ \\-win\\ h\\ * or *\\ \\-win\\ hi\\ * or *\\ \\-win\\ hid\\ * or *\\ \\-win\\ hidd\\ * or *\\ \\-win\\ hidde\\ * or *\\ \\-nopr\\ * or *\\ \\-nopro\\ * or *\\ \\-noprof\\ * or *\\ \\-noprofi\\ * or *\\ \\-noprofil\\ * or *\\ \\-nonin\\ * or *\\ \\-nonint\\ * or *\\ \\-noninte\\ * or *\\ \\-noninter\\ * or *\\ \\-nonintera\\ * or *\\ \\-noninterac\\ * or *\\ \\-noninteract\\ * or *\\ \\-noninteracti\\ * or *\\ \\-noninteractiv\\ * or *\\ \\-ec\\ * or *\\ \\-encodedcomman\\ * or *\\ \\-encodedcomma\\ * or *\\ \\-encodedcomm\\ * or *\\ \\-encodedcom\\ * or *\\ \\-encodedco\\ * or *\\ \\-encodedc\\ * or *\\ \\-encoded\\ * or *\\ \\-encode\\ * or *\\ \\-encod\\ * or *\\ \\-enco\\ * or *\\ \\-en\\ * or *\\ \\-executionpolic\\ * or *\\ \\-executionpoli\\ * or *\\ \\-executionpol\\ * or *\\ \\-executionpo\\ * or *\\ \\-executionp\\ * or *\\ \\-execution\\ bypass* or *\\ \\-executio\\ bypass* or *\\ \\-executi\\ bypass* or *\\ \\-execut\\ bypass* or *\\ \\-execu\\ bypass* or *\\ \\-exec\\ bypass* or *\\ \\-exe\\ bypass* or *\\ \\-ex\\ bypass* or *\\ \\-ep\\ bypass* or *\\ \\/windowstyle\\ h\\ * or *\\ \\/windowstyl\\ h* or *\\ \\/windowsty\\ h* or *\\ \\/windowst\\ h* or *\\ \\/windows\\ h* or *\\ \\/windo\\ h* or *\\ \\/wind\\ h* or *\\ \\/win\\ h* or *\\ \\/wi\\ h* or *\\ \\/win\\ h\\ * or *\\ \\/win\\ hi\\ * or *\\ \\/win\\ hid\\ * or *\\ \\/win\\ hidd\\ * or *\\ \\/win\\ hidde\\ * or *\\ \\/nopr\\ * or *\\ \\/nopro\\ * or *\\ \\/noprof\\ * or *\\ \\/noprofi\\ * or *\\ \\/noprofil\\ * or *\\ \\/nonin\\ * or *\\ \\/nonint\\ * or *\\ \\/noninte\\ * or *\\ \\/noninter\\ * or *\\ \\/nonintera\\ * or *\\ \\/noninterac\\ * or *\\ \\/noninteract\\ * or *\\ \\/noninteracti\\ * or *\\ \\/noninteractiv\\ * or *\\ \\/ec\\ * or *\\ \\/encodedcomman\\ * or *\\ \\/encodedcomma\\ * or *\\ \\/encodedcomm\\ * or *\\ \\/encodedcom\\ * or *\\ \\/encodedco\\ * or *\\ \\/encodedc\\ * or *\\ \\/encoded\\ * or *\\ \\/encode\\ * or *\\ \\/encod\\ * or *\\ \\/enco\\ * or *\\ \\/en\\ * or *\\ \\/executionpolic\\ * or *\\ \\/executionpoli\\ * or *\\ \\/executionpol\\ * or *\\ \\/executionpo\\ * or *\\ \\/executionp\\ * or *\\ \\/execution\\ bypass* or *\\ \\/executio\\ bypass* or *\\ \\/executi\\ bypass* or *\\ \\/execut\\ bypass* or *\\ \\/execu\\ bypass* or *\\ \\/exec\\ bypass* or *\\ \\/exe\\ bypass* or *\\ \\/ex\\ bypass* or *\\ \\/ep\\ bypass*))
<li><a href="#">query: (process.executable:*\\\\powershell.exe and process.command_line:(*\\ \\-windowstyle\\ h\\ * or *\\ \\-windowstyl\\ h* or *\\ \\-windowsty\\ h* or *\\ \\-windowst\\ h* or *\\ \\-windows\\ h* or *\\ \\-windo\\ h* or *\\ \\-wind\\ h* or *\\ \\-win\\ h* or *\\ \\-wi\\ h* or *\\ \\-win\\ h\\ * or *\\ \\-win\\ hi\\ * or *\\ \\-win\\ hid\\ * or *\\ \\-win\\ hidd\\ * or *\\ \\-win\\ hidde\\ * or *\\ \\-nopr\\ * or *\\ \\-nopro\\ * or *\\ \\-noprof\\ * or *\\ \\-noprofi\\ * or *\\ \\-noprofil\\ * or *\\ \\-nonin\\ * or *\\ \\-nonint\\ * or *\\ \\-noninte\\ * or *\\ \\-noninter\\ * or *\\ \\-nonintera\\ * or *\\ \\-noninterac\\ * or *\\ \\-noninteract\\ * or *\\ \\-noninteracti\\ * or *\\ \\-noninteractiv\\ * or *\\ \\-ec\\ * or *\\ \\-encodedcomman\\ * or *\\ \\-encodedcomma\\ * or *\\ \\-encodedcomm\\ * or *\\ \\-encodedcom\\ * or *\\ \\-encodedco\\ * or *\\ \\-encodedc\\ * or *\\ \\-encoded\\ * or *\\ \\-encode\\ * or *\\ \\-encod\\ * or *\\ \\-enco\\ * or *\\ \\-en\\ *))
<li><a href="#">query: (process.executable:*\\\\powershell.exe and process.command_line:*\\ hidden\\ * and process.command_line:(*agkadabzageazabtagkabgagac8adabyageabgbzagyazqbya* or *axrzywrtaw4gl3ryyw5zzmvy* or *iaaqb0ahmayqbkag0aaqbuacaalwb0ahiayqbuahmazgblahia* or *jpdhnhzg1pbiavdhjhbnnmzx* or *ygbpahqacwbhagqabqbpag4aiaavahqacgbhag4acwbmaguacg* or *yml0c2fkbwluic90cmfuc2zlc* or *agmaaab1ag4aawbfahmaaqb6agua* or *jabjaggadqbuagsaxwbzagkaegbla* or *jgnodw5rx3npem* or *qaywboahuabgbraf8acwbpahoazq* or *rjahvua19zaxpl* or *y2h1bmtfc2l6z* or *ae8algbdag8abqbwahiazqbzahmaaqbvag4a* or *katwauaemabwbtahaacgblahmacwbpag8abg* or *lplknvbxbyzxnzaw9u* or *sqbpac4aqwbvag0acabyaguacwbzagkabwbua* or *su8uq29tchjlc3npb2* or *ty5db21wcmvzc2lvb* or *ae8algbnaguabqbvahiaeqbtahqacgblageabq* or *katwauae0azqbtag8acgb5afmadabyaguayqbta* or *lplk1lbw9yevn0cmvhb* or *sqbpac4atqblag0abwbyahkauwb0ahiazqbhag0a* or *su8utwvtb3j5u3ryzwft* or *ty5nzw1vcnltdhjlyw* or *4arwblahqaqwboahuabgbra* or *5hzxrdahvua* or *aecazqb0aemaaab1ag4aaw* or *lgbhaguadabdaggadqbuagsa* or *lkdldenodw5r* or *r2v0q2h1bm* or *aegaugbfaeearabfaekatgbgae8anga0a* or *qasabsaeuaqqbeaf8asqboaeyatwa2adqa* or *riukvbrf9jtkzpnj* or *sfjfqurfsu5gtzy0* or *vabiafiarqbbaeqaxwbjae4argbpadyana* or *vehsrufex0lork82n* or *ahiazqbhahqazqbsaguabqbvahqazqbuaggacgblageaza* or *cmvhdgvszw1vdgvuahjlyw* or *macgblageadablafiazqbtag8adablafqaaabyaguayqbka* or *nyzwf0zvjlbw90zvrocmvhz* or *q3jlyxrlumvtb3rlvghyzwfk* or *qwbyaguayqb0aguaugblag0abwb0aguavaboahiazqbhagqa* or *0azqbtag0abwb2agua* or *1lbw1vdm* or *aguabqbtag8adgbla* or *bqblag0abqbvahyazq* or *bwvtbw92z* or *zw1tb3zl*))
<li><a href="#">query: (process.executable:*\\\\powershell.exe and process.command_line:*add\\-pssnapin\\ microsoft.exchange.powershell.snapin*)
<li><a href="#">query: (process.executable:*\\\\powershell.exe and process.command_line:*new\\-object* and process.command_line:*net.webclient\\).* and process.command_line:*download* and process.command_line:(*string\\(* or *file\\(*))
<li><a href="#">query: (process.executable:*\\\\powershell.exe and process.command_line:*new\\-object\\ system.net.sockets.tcpclient*)
<li><a href="#">query: (process.executable:*\\\\powershell.exe and process.command_line:*start\\-bitstransfer*)
<li><a href="#">query: (process.executable:*\\\\powershell.exe and process.command_line:/\\s-\\s*</)
<li><a href="#">query: (process.executable:*\\\\powershell.exe and process.parent.executable:*\\\\excel.exe and process.command_line:*dataexchange.dll*)
<li><a href="#">query: (process.executable:*\\\\protocolhandler.exe and process.command_line:*\\\"ms\\-word* and process.command_line:*.docx\\\"*)
<li><a href="#">query: (process.executable:*\\\\psexec.exe and process.command_line:*accepteula*)
<li><a href="#">query: (process.executable:*\\\\psexesvc.exe and user.name:nt\\ authority\\\\system*)
<li><a href="#">query: (process.executable:*\\\\psr.exe and process.command_line:*\\/start*)
<li><a href="#">query: (process.executable:*\\\\python.exe and process.command_line:*adidnsdump*)
<li><a href="#">query: (process.executable:*\\\\rar.exe and process.command_line:*\\ a\\ *)
<li><a href="#">query: (process.executable:*\\\\reg.exe and process.command_line:(*hkey_current_user\\\\control\\ panel\\\\desktop* or *hkcu\\\\control\\ panel\\\\desktop*) and process.command_line:*\\/t\\ reg_sz* and process.command_line:*\\/f* and ((process.command_line:*\\/v\\ screensaveactive* and process.command_line:*\\/d\\ 1*) or (process.command_line:*\\/v\\ screensavetimeout* and process.command_line:*\\/d\\ *) or (process.command_line:*\\/v\\ screensaverissecure* and process.command_line:*\\/d\\ 0*) or (process.command_line:*\\/v\\ scrnsave.exe* and process.command_line:*\\/d\\ * and process.command_line:*.scr*)))
<li><a href="#">query: (process.executable:*\\\\reg.exe and process.command_line:(*hklm\\\\software\\\\microsoft\\\\windows\\ defender\\\\exclusions\\\\paths\\\\* or *hklm\\\\software\\\\microsoft\\\\microsoft\\ antimalware\\\\exclusions\\\\paths*) and process.command_line:*add\\ * and process.command_line:*\\/t\\ * and process.command_line:*reg_dword\\ * and process.command_line:*\\/v\\ * and process.command_line:*\\/d\\ * and process.command_line:*0*)
<li><a href="#">query: (process.executable:*\\\\reg.exe and process.command_line:(*query* or *save* or *export*) and process.command_line:(*currentversion\\\\windows* or *currentversion\\\\runservicesonce* or *currentversion\\\\runservices* or *winlogon\\\\* or *currentversion\\\\shellserviceobjectdelayload* or *currentversion\\\\runonce* or *currentversion\\\\runonceex* or *currentversion\\\\run* or *currentversion\\\\policies\\\\explorer\\\\run* or *currentcontrolset\\\\services*))
<li><a href="#">query: (process.executable:*\\\\reg.exe and process.command_line:(*save* or *export* or *ã«â¢ave* or *eã«â£port*) and process.command_line:(*hklm* or *hkã«âªm* or *hkey_local_machine* or *hkey_ã«âªocal_machine* or *hkey_locaã«âª_machine* or *hkey_ã«âªocaã«âª_machine*) and process.command_line:(*\\\\system or *\\\\sam or *\\\\security or *\\\\ã«â¢ystem or *\\\\syã«â¢tem or *\\\\ã«â¢yã«â¢tem or *\\\\ã«â¢am or *\\\\ã«â¢ecurity))
<li><a href="#">query: (process.executable:*\\\\reg.exe and process.command_line:(*save* or *export* or *ˢave* or *eˣport*) and process.command_line:(*hklm* or *hk˪m* or *hkey_local_machine* or *hkey_˪ocal_machine* or *hkey_loca˪_machine* or *hkey_˪oca˪_machine*) and process.command_line:(*\\\\system or *\\\\sam or *\\\\security or *\\\\ˢystem or *\\\\syˢtem or *\\\\ˢyˢtem or *\\\\ˢam or *\\\\ˢecurity))
<li><a href="#">query: (process.executable:*\\\\reg.exe and process.command_line:*add* and process.command_line:(*\\\\software\\\\microsoft\\\\windows\\\\currentversion\\\\run* or *\\\\software\\\\microsoft\\\\windows\\\\currentversion\\\\runonce* or *\\\\software\\\\microsoft\\\\windows\\\\currentversion\\\\runonceex* or *\\\\software\\\\microsoft\\\\windows\\\\currentversion\\\\runservices* or *\\\\software\\\\microsoft\\\\windows\\\\currentversion\\\\runservicesonce* or *\\\\software\\\\microsoft\\\\windows\\ nt\\\\currentversion\\\\winlogon\\\\userinit* or *\\\\software\\\\microsoft\\\\windows\\ nt\\\\currentversion\\\\winlogon\\\\shell* or *\\\\software\\\\microsoft\\\\windows\\ nt\\\\currentversion\\\\windows* or *\\\\software\\\\microsoft\\\\windows\\\\currentversion\\\\explorer\\\\user\\ shell\\ folders* or *\\\\system\\\\currentcontrolset\\\\control\\\\safeboot\\\\alternateshell*))
<li><a href="#">query: (process.executable:*\\\\reg.exe and process.command_line:*add\\ * and process.command_line:*hklm\\\\system\\\\currentcontrolset\\\\services\\\\* and process.command_line:*\\/v\\ * and process.command_line:*imagepath\\ * and process.command_line:*\\/d\\ *)
<li><a href="#">query: (process.executable:*\\\\reg.exe and process.command_line:*add\\ * and process.command_line:*system\\\\currentcontrolset\\\\services\\\\* and process.command_line:*\\ imagepath\\ * and process.command_line:(*\\ \\/d\\ * or *\\ \\-d\\ *))
<li><a href="#">query: (process.executable:*\\\\reg.exe and process.command_line:*query* and process.command_line:*\\\\software\\\\* and process.command_line:*\\/v* and process.command_line:*svcversion*)
<li><a href="#">query: (process.executable:*\\\\reg.exe and process.command_line:*software\\\\microsoft\\\\cryptography* and process.command_line:*\\/v\\ * and process.command_line:*machineguid*)
<li><a href="#">query: (process.executable:*\\\\reg.exe and process.command_line:*system\\\\currentcontrolset\\\\control\\\\lsa* and process.command_line:*\\ add\\ * and process.command_line:*\\ \\/d\\ 0* and process.command_line:*\\ \\/v\\ runasppl\\ *)
<li><a href="#">query: (process.executable:*\\\\regedit.exe and process.command_line:(*\\ \\/e\\ * or *\\ \\-e\\ *) and process.command_line:(*hklm* or *hkey_local_machine*) and process.command_line:(*\\\\system or *\\\\sam or *\\\\security))
<li><a href="#">query: (process.executable:*\\\\regedit.exe and process.command_line:*\\ \\/e\\ * and process.command_line:(*hklm* or *hkey_local_machine*) and process.command_line:(*\\\\system or *\\\\sam or *\\\\security))
<li><a href="#">query: (process.executable:*\\\\regedit.exe and process.parent.executable:(*\\\\trustedinstaller.exe or *\\\\processhacker.exe))
<li><a href="#">query: (process.executable:*\\\\regini.exe and (not (process.command_line:/:[\\\\\\\\]/)))
<li><a href="#">query: (process.executable:*\\\\regini.exe and process.command_line:/:[\\\\\\\\]/)
<li><a href="#">query: (process.executable:*\\\\register\\-cimprovider.exe and process.command_line:*\\-path* and process.command_line:*dll*)
<li><a href="#">query: (process.executable:*\\\\regsvr32.exe and process.command_line:*.jpg)
<li><a href="#">query: (process.executable:*\\\\remote.exe or winlog.event_data.originalfilename:\"remote.exe\")
<li><a href="#">query: (process.executable:*\\\\replace.exe and process.command_line:(*\\/a* or *\\-a*))
<li><a href="#">query: (process.executable:*\\\\replace.exe and process.command_line:*\\/a*)
<li><a href="#">query: (process.executable:*\\\\ruby.exe and process.command_line:*\\-i\\ * and process.command_line:*\\-u\\ * and process.command_line:*\\-p\\ *)
<li><a href="#">query: (process.executable:*\\\\rundll32.exe and (not ((not _exists_:process.command_line) or (process.command_line:*.dll* or process.command_line:\"\") or (process.parent.executable:*\\:\\\\program\\ files\\\\internet\\ explorer\\\\iexplore.exe and process.command_line:*.cpl*))))
<li><a href="#">query: (process.executable:*\\\\rundll32.exe and (not ((process.working_directory:*c\\:\\\\* or process.working_directory:\"\") or (not _exists_:process.working_directory))))
<li><a href="#">query: (process.executable:*\\\\rundll32.exe and process.command_line:(*\\-sta\\ * or *ã¢â¬âlocalserver\\ *) and process.command_line:*\\{* and process.command_line:*\\}*)
<li><a href="#">query: (process.executable:*\\\\rundll32.exe and process.command_line:(*\\-sta\\ * or *–localserver\\ *) and process.command_line:*\\{* and process.command_line:*\\}*)
<li><a href="#">query: (process.executable:*\\\\rundll32.exe and process.command_line:(*zxfunction* or *remotediskxxxxx*))
<li><a href="#">query: (process.executable:*\\\\rundll32.exe and process.command_line:*c\\:\\\\windows\\\\system32\\\\davclnt.dll,davsetcookie*)
<li><a href="#">query: (process.executable:*\\\\rundll32.exe and process.command_line:*installscreensaver*)
<li><a href="#">query: (process.executable:*\\\\rundll32.exe and process.command_line:*keymgr* and process.command_line:*krshowkeymgr*)
<li><a href="#">query: (process.executable:*\\\\rundll32.exe and process.command_line:*pcwutl* and process.command_line:*launchapplication*)
<li><a href="#">query: (process.executable:*\\\\rundll32.exe and process.command_line:*shell32.dll* and process.command_line:*control_rundll* and process.command_line:(*%appdata%* or *%localappdata%* or *%temp%* or *\\\\appdata\\\\* or *\\\\temp\\\\* or *\\\\users\\\\public\\\\*))
<li><a href="#">query: (process.executable:*\\\\rundll32.exe and process.parent.executable:*\\\\cmd.exe and process.command_line:*user32.dll,* and process.command_line:*lockworkstation*)
<li><a href="#">query: (process.executable:*\\\\runonce.exe and process.parent.executable:*\\\\rundll32.exe and process.parent.command_line:*setupapi.dll* and process.parent.command_line:*installhinfsection*)
<li><a href="#">query: (process.executable:*\\\\runscripthelper.exe and process.command_line:*surfacecheck*)
<li><a href="#">query: (process.executable:*\\\\sc.exe and process.command_line:*config* and process.command_line:*binpath* and process.command_line:(*powershell* or *cmd* or *mshta* or *wscript* or *cscript* or *rundll32* or *c\\:\\\\users\\\\public* or *\\\\downloads\\\\* or *\\\\desktop\\\\* or *\\\\microsoft\\\\windows\\\\start\\ menu\\\\programs\\\\startup\\\\* or *c\\:\\\\windows\\\\temp\\\\* or *\\\\appdata\\\\local\\\\temp*))
<li><a href="#">query: (process.executable:*\\\\sc.exe and process.command_line:*config* and process.command_line:*binpath* and process.command_line:(*powershell* or *cmd*))
<li><a href="#">query: (process.executable:*\\\\sc.exe and process.command_line:*sdset* and process.command_line:*d;;* and process.command_line:(*;;;iu* or *;;;su* or *;;;ba* or *;;;sy* or *;;;wd*))
<li><a href="#">query: (process.executable:*\\\\sc.exe and process.command_line:*sdset* and process.command_line:*dclcwpdtsd*)
<li><a href="#">query: (process.executable:*\\\\schtasks.exe and process.command_line:(*\\/delete* or *\\/change*) and process.command_line:*\\/tn* and process.command_line:*\\\\microsoft\\\\windows\\\\defrag\\\\scheduleddefrag*)
<li><a href="#">query: (process.executable:*\\\\schtasks.exe and process.command_line:*\\ \\/create\\ * and process.command_line:*\\ \\/sc\\ once\\ * and process.command_line:*\\\\temp\\\\*)
<li><a href="#">query: (process.executable:*\\\\schtasks.exe and process.command_line:*\\/change* and process.command_line:*\\/tn* and process.command_line:*\\/disable* and process.command_line:*\\\\microsoft\\\\windows\\\\systemrestore\\\\sr*)
<li><a href="#">query: (process.executable:*\\\\schtasks.exe and process.command_line:*\\/change* and process.command_line:*\\/tn* and process.command_line:*\\/ru* and process.command_line:*\\/rp*)
<li><a href="#">query: (process.executable:*\\\\schtasks.exe and process.command_line:*\\/create* and process.command_line:*\\/sc* and process.command_line:*frombase64string* and process.command_line:*get\\-itemproperty* and process.command_line:(*hkcu\\:* or *hklm\\:* or *registry\\:\\:* or *hkey_*))
<li><a href="#">query: (process.executable:*\\\\schtasks.exe and winlog.event_data.originalfilename:\"schtasks.exe\" and process.command_line:*\\/change* and process.command_line:*\\/tn* and process.command_line:*\\/ru* and process.command_line:*\\/rp*)
<li><a href="#">query: (process.executable:*\\\\scrcons.exe and file.path:(*\\\\vbscript.dll or *\\\\wbemdisp.dll or *\\\\wshom.ocx or *\\\\scrrun.dll))
<li><a href="#">query: (process.executable:*\\\\selectmyparent.exe or process.command_line:(*ppid\\-spoof* or *ppid_spoof* or *spoof\\-ppid* or *spoof_ppid* or *ppidspoof* or *spoofppid* or *spoofedppid* or *\\ \\-spawnto\\ *) or winlog.event_data.originalfilename:(*ppid\\-spoof* or *ppid_spoof* or *spoof\\-ppid* or *spoof_ppid* or *ppidspoof* or *spoofppid* or *spoofedppid*) or winlog.event_data.description:\"selectmyparent\" or winlog.event_data.imphash:(\"04d974875bd225f00902b4cad9af3fbc\" or \"a782af154c9e743ddf3f3eb2b8f3d16e\" or \"89059503d7fbf470e68f7e63313da3ad\" or \"ca28337632625c8281ab8a130b3d6bad\") or winlog.event_data.hashes:(*imphash\\=04d974875bd225f00902b4cad9af3fbc* or *imphash\\=a782af154c9e743ddf3f3eb2b8f3d16e* or *imphash\\=89059503d7fbf470e68f7e63313da3ad* or *imphash\\=ca28337632625c8281ab8a130b3d6bad*))
<li><a href="#">query: (process.executable:*\\\\sepremovaltoolnative_x64.exe or (process.executable:*\\\\catclean.exe and process.command_line:*\\-\\-uninstall*) or (process.executable:*\\\\netinstaller.exe and process.command_line:*\\-r*) or (process.executable:*\\\\wfpunins.exe and process.command_line:*\\/uninstall* and process.command_line:*\\/enterprise*))
<li><a href="#">query: (process.executable:*\\\\shutdown.exe and process.command_line:(*\\/r\\ * or *\\/s\\ *))
<li><a href="#">query: (process.executable:*\\\\soundrecorder.exe and process.command_line:*\\/file*)
<li><a href="#">query: (process.executable:*\\\\splwow64.exe and process.command_line:*splwow64.exe)
<li><a href="#">query: (process.executable:*\\\\spoolsv.exe and file.path:(*\\\\windows\\\\system32\\\\spool\\\\drivers\\\\x64\\\\3\\\\* or *\\\\windows\\\\system32\\\\spool\\\\drivers\\\\x64\\\\4\\\\*) and file.path:*.dll)
<li><a href="#">query: (process.executable:*\\\\spoolsv.exe and file.path:*c\\:\\\\windows\\\\system32\\\\spool\\\\drivers\\\\x64\\\\3\\\\*)
<li><a href="#">query: (process.executable:*\\\\sqlcmd.exe and process.command_line:*select* and process.command_line:*top* and process.command_line:*\\[veeambackup\\].\\[dbo\\].\\[credentials\\]*)
<li><a href="#">query: (process.executable:*\\\\sqldumper.exe and process.command_line:(*0x0110* or *0x01100\\:40*))
<li><a href="#">query: (process.executable:*\\\\squirrel.exe and process.command_line:(*\\ \\-\\-download\\ * or *\\ \\-\\-update\\ * or *\\ \\-\\-updaterollback\\=*) and process.command_line:*http*)
<li><a href="#">query: (process.executable:*\\\\svchost.exe and (not ((process.parent.executable:(*\\\\services.exe or *\\\\msmpeng.exe or *\\\\mrt.exe or *\\\\rpcnet.exe or *\\\\ngen.exe or *\\\\tiworker.exe)) or (not _exists_:process.parent.executable) or (process.parent.executable:\"\") or (process.parent.executable:\"\\-\"))))
<li><a href="#">query: (process.executable:*\\\\svchost.exe and (not ((process.parent.executable:(*\\\\services.exe or *\\\\msmpeng.exe or *\\\\mrt.exe or *\\\\rpcnet.exe or *\\\\svchost.exe or *\\\\ngen.exe or *\\\\tiworker.exe)) or (not _exists_:process.parent.executable) or (process.parent.executable:\"\") or (process.parent.executable:\"\\-\"))))
<li><a href="#">query: (process.executable:*\\\\svchost.exe and file.path:*\\\\clfsw32.dll)
<li><a href="#">query: (process.executable:*\\\\svchost.exe and winlog.event_data.initiated:\"true\" and source.port:\"3389\" and destination.port:(\"80\" or \"443\"))
<li><a href="#">query: (process.executable:*\\\\syncappvpublishingserver.exe and process.command_line:*\\\"n;\\ *)
<li><a href="#">query: (process.executable:*\\\\sysprep.exe and process.command_line:*\\\\appdata\\\\*)
<li><a href="#">query: (process.executable:*\\\\systeminfo.exe or winlog.event_data.originalfilename:\"sysinfo.exe\")
<li><a href="#">query: (process.executable:*\\\\takeown.exe and process.command_line:*\\/f\\ * and process.command_line:*\\/r*)
<li><a href="#">query: (process.executable:*\\\\taskkill.exe and process.command_line:*\\/f* and process.command_line:*\\/im*)
<li><a href="#">query: (process.executable:*\\\\te.exe or process.parent.executable:*\\\\te.exe or winlog.event_data.originalfilename:\"\\\\te.exe\")
<li><a href="#">query: (process.executable:*\\\\vboxdrvinst.exe and process.command_line:*driver* and process.command_line:*executeinf*)
<li><a href="#">query: (process.executable:*\\\\verclsid.exe and process.command_line:*\\/c* and process.command_line:*\\/s*)
<li><a href="#">query: (process.executable:*\\\\visualuiaverifynative.exe or winlog.event_data.originalfilename:\"visualuiaverifynative.exe\")
<li><a href="#">query: (process.executable:*\\\\wermgr.exe and process.parent.executable:*\\\\rundll32.exe and process.parent.command_line:*dllregisterserver*)
<li><a href="#">query: (process.executable:*\\\\wfc.exe or winlog.event_data.originalfilename:\"wfc.exe\")
<li><a href="#">query: (process.executable:*\\\\where.exe and process.command_line:(*bookmarks* or *places.sqlite*))
<li><a href="#">query: (process.executable:*\\\\whoami.exe and process.command_line:*\\/priv*)
<li><a href="#">query: (process.executable:*\\\\whoami.exe or winlog.event_data.originalfilename:\"whoami.exe\")
<li><a href="#">query: (process.executable:*\\\\windows\\\\system32\\\\lsass.exe and process.parent.executable:*\\\\windows\\\\system32\\\\lsass.exe)
<li><a href="#">query: (process.executable:*\\\\winword.exe and process.command_line:*\\/l*)
<li><a href="#">query: (process.executable:*\\\\winword.exe and winlog.event_data.calltrace:*\\:\\\\windows\\\\microsoft.net\\\\framework64\\\\v2.* and winlog.event_data.calltrace:*unknown*)
<li><a href="#">query: (process.executable:*\\\\wmic.exe and ((process.command_line:*process* and process.command_line:*call* and process.command_line:*create\\ *) or (process.command_line:*\\ path\\ * and process.command_line:(*antivirus* or *firewall*) and process.command_line:*product* and process.command_line:*\\ get\\ *)))
<li><a href="#">query: (process.executable:*\\\\wmic.exe and file.path:(*\\\\jscript.dll or *\\\\vbscript.dll))
<li><a href="#">query: (process.executable:*\\\\wmic.exe and process.command_line:*\\ group*)
<li><a href="#">query: (process.executable:*\\\\wmic.exe and process.command_line:*\\/node\\:* and process.command_line:*service*)
<li><a href="#">query: (process.executable:*\\\\wmic.exe and process.command_line:*call\\ uninstall*)
<li><a href="#">query: (process.executable:*\\\\wsl.exe and process.command_line:(*\\ \\-e\\ * or *\\ \\-\\-exec\\ *))
<li><a href="#">query: (process.executable:*\\\\wsmprovhost.exe or process.parent.executable:*\\\\wsmprovhost.exe)
<li><a href="#">query: (process.executable:*\\\\wsreset.exe and integritylevel:(\"high\" or \"system\"))
<li><a href="#">query: (process.executable:*\\\\xordump.exe or process.command_line:(*\\ \\-process\\ lsass.exe\\ * or *\\ \\-m\\ comsvcs\\ * or *\\ \\-m\\ dbghelp\\ * or *\\ \\-m\\ dbgcore\\ *))
<li><a href="#">query: (process.executable:*\\\\xwizard.exe and (not (process.executable:c\\:\\\\windows\\\\system32\\\\*)))
<li><a href="#">query: (process.executable:*\\\\xwizard.exe and process.command_line:/{[a-fa-f0-9]{8}-[a-fa-f0-9]{4}-[a-fa-f0-9]{4}-[a-fa-f0-9]{4}-[a-fa-f0-9]{12}}/)
<li><a href="#">query: (process.executable:*bpftrace and process.command_line:*\\-\\-unsafe*)
<li><a href="#">query: (process.executable:*c\\:\\\\windows\\\\microsoft.net\\\\framework* and process.executable:*aspnet_compiler.exe*)
<li><a href="#">query: (process.executable:*cmd.exe and file.path:(*.vhd or *.bac or *.bak or *.wbcat or *.bkf or *.set or *.win or *.dsk))
<li><a href="#">query: (process.executable:*crontab and process.command_line:*\\/tmp\\/*)
<li><a href="#">query: (process.executable:*mobsync.exe and (not (destination.ip:(10.* or 192.168.* or 172.16.* or 172.17.* or 172.18.* or 172.19.* or 172.20.* or 172.21.* or 172.22.* or 172.23.* or 172.24.* or 172.25.* or 172.26.* or 172.27.* or 172.28.* or 172.29.* or 172.30.* or 172.31.*) and destinationisipv6:\"false\")))
<li><a href="#">query: (process.executable:*msdtc.exe and file.path:\"c\\:\\\\windows\\\\oci.dll\")
<li><a href="#">query: (process.executable:*pktmon.exe or winlog.event_data.originalfilename:\"pktmon.exe\")
<li><a href="#">query: (process.executable:*reg.exe and process.command_line:(*hkey_current_user\\\\control\\ panel\\\\desktop* or *hkcu\\\\control\\ panel\\\\desktop*) and process.command_line:*\\/t\\ reg_sz* and process.command_line:*\\/f* and ((process.command_line:*\\/v\\ screensaveactive* and process.command_line:*\\/d\\ 1*) or (process.command_line:*\\/v\\ screensavetimeout* and process.command_line:*\\/d\\ *) or (process.command_line:*\\/v\\ screensaverissecure* and process.command_line:*\\/d\\ 0*) or (process.command_line:*\\/v\\ scrnsave.exe* and process.command_line:*\\/d\\ * and process.command_line:*.scr*)))
<li><a href="#">query: (process.executable:*sdclt.exe and integritylevel:\"high\")
<li><a href="#">query: (process.executable:*spoolsv.exe and file.path:(*\\\\windows\\\\system32\\\\spool\\\\drivers\\\\x64\\\\3\\\\* or *\\\\windows\\\\system32\\\\spool\\\\drivers\\\\x64\\\\4\\\\*) and file.path:*.dll)
<li><a href="#">query: (process.executable:*spoolsv.exe and file.path:*c\\:\\\\windows\\\\system32\\\\spool\\\\drivers\\\\x64\\\\3\\\\*)
<li><a href="#">query: (process.executable:*ttdinject.exe or winlog.event_data.originalfilename:\"ttdinject.exe\")
<li><a href="#">query: (process.executable:*umworkerprocess.exe and (not (file.path:(*cachecleanup.bin or *.txt or *.log or *.cfg or *cleanup.bin))))
<li><a href="#">query: (process.executable:*updata.exe and file.path:\"c\\:\\\\windows\\\\oci.dll\")
<li><a href="#">query: (process.executable:*winword.exe and winlog.event_data.calltrace:*\\:\\\\windows\\\\microsoft.net\\\\framework64\\\\v2.* and winlog.event_data.calltrace:*unknown*)
<li><a href="#">query: (process.executable:*xclip* and process.command_line:(*\\-selection* or *\\-sel*) and process.command_line:(*clipboard* or *clip*) and process.command_line:*\\-o*)
<li><a href="#">query: (process.executable:\"\\/bin\\/dd\" and process.command_line:*of\\=* and process.command_line:(*if\\=\\/dev\\/zero* or *if\\=\\/dev\\/null*))
<li><a href="#">query: (process.executable:\"\\/usr\\/bin\\/base64\" and process.command_line:*\\-d*)
<li><a href="#">query: (process.executable:\"\\/usr\\/bin\\/grep\" and (process.command_line:(*nessusd* or *santad* or *cbdefense* or *falcond* or *td\\-agent* or *packetbeat* or *filebeat* or *auditbeat* or *osqueryd* or *blockblock* or *lulu*) or (process.command_line:*little* and process.command_line:*snitch*)))
<li><a href="#">query: (process.executable:\"\\/usr\\/sbin\\/firmwarepasswd\" and process.command_line:(*setpasswd* or *full* or *delete* or *check*))
<li><a href="#">query: (process.executable:\"\\/usr\\/sbin\\/osascript\" and process.command_line:*\\-e* and process.command_line:*display* and process.command_line:*dialog* and process.command_line:*answer* and process.command_line:(*admin* or *administrator* or *authenticate* or *authentication* or *credentials* or *pass* or *password* or *unlock*))
<li><a href="#">query: (process.executable:\"\\\\outlook.exe\" and file.path:*\\\\appdata\\\\local\\\\microsoft\\\\forms\\\\*)
<li><a href="#">query: (process.executable:\"\\\\winword.exe\" and ((file.path:*.cab and file.path:*\\\\windows\\\\inetcache*) or (file.path:*\\\\appdata\\\\local\\\\temp\\\\* and file.path:*.inf*)))
<li><a href="#">query: (process.executable:\"c\\:\\\\program\\ files\\\\internet\\ explorer\\\\ieinstal.exe\" and file.path:c\\:\\\\users\\\\* and file.path:*\\\\appdata\\\\local\\\\temp\\\\* and file.path:*consent.exe)
<li><a href="#">query: (process.executable:\"c\\:\\\\windows\\\\system32\\\\wbem\\\\scrcons.exe\" and process.parent.executable:\"c\\:\\\\windows\\\\system32\\\\svchost.exe\")
<li><a href="#">query: (process.executable:\"c\\:\\\\windows\\\\system32\\\\wbem\\\\wmiprvse.exe\" and file.path:*\\\\wbemcons.dll)
<li><a href="#">query: (process.executable:\"c\\:\\\\windows\\\\system32\\\\werfault.exe\" and file.path:(*\\\\lsass* or *lsass.exe*))
<li><a href="#">query: (process.executable:\"hxtsr.exe\" and (not (process.working_directory:/(?i)c:\\\\\\\\program files\\\\\\\\windowsapps\\\\\\\\microsoft\\.windowscommunicationsapps_.*\\\\\\\\hxtsr\\.exe/)))
<li><a href="#">query: (process.executable:\"hxtsr.exe\" and (not (process.working_directory:c\\:\\\\program\\ files\\\\windowsapps\\\\microsoft.windowscommunicationsapps_* and process.working_directory:*\\\\hxtsr.exe)))
<li><a href="#">query: (process.executable:\"system\" and file.path:*\\\\wbem\\\\wbemcomn.dll)
<li><a href="#">query: (process.executable:c\\:\\\\program\\ files\\\\windowsapps\\\\microsoft.desktopappinstaller_* and process.executable:*\\\\appinstaller.exe)
<li><a href="#">query: (process.parent.command_line.text:(c\\:\\\\windows\\\\system32\\\\* or c\\:\\\\windows\\\\syswow64\\\\*) and process.parent.command_line.text:*.exe and process.command_line.text:*c\\:\\\\users\\\\* and ((process.command_line.text:*\\/c* and process.command_line.text:*del* and process.command_line.text:*\\\\appdata\\\\local\\\\temp\\\\*) or (process.command_line.text:*\\/c* and process.command_line.text:*del* and process.command_line.text:*\\\\desktop\\\\*) or (process.command_line.text:*\\/c* and process.command_line.text:*type\\ nul\\ >* and process.command_line.text:*\\\\desktop\\\\*)) and process.command_line.text:*.exe)
<li><a href="#">query: (process.parent.command_line:(*regsvr32* or *rundll32* or *msiexec* or *mshta* or *verclsid*) and (process.executable:*\\\\wbem\\\\wmic.exe or process.parent.command_line:*wmic\\ *) and process.parent.executable:(*winword.exe or *excel.exe or *powerpnt.exe) and process.parent.command_line:*process* and process.parent.command_line:*create* and process.parent.command_line:*call*)
<li><a href="#">query: (process.parent.command_line:(c\\:\\\\windows\\\\system32\\\\* or c\\:\\\\windows\\\\syswow64\\\\*) and process.parent.command_line:*.exe and process.command_line:*c\\:\\\\users\\\\* and ((process.command_line:*\\/c* and process.command_line:*del* and process.command_line:*\\\\appdata\\\\local\\\\temp\\\\*) or (process.command_line:*\\/c* and process.command_line:*del* and process.command_line:*\\\\desktop\\\\*) or (process.command_line:*\\/c* and process.command_line:*type\\ nul\\ >* and process.command_line:*\\\\desktop\\\\*)) and process.command_line:*.exe)
<li><a href="#">query: (process.parent.command_line:*cmd* and process.parent.command_line:*\\/c* and process.command_line:*\\/..\\/..\\/*)
<li><a href="#">query: (process.parent.command_line:*conhost* and process.command_line:*\\/..\\/..\\/*)
<li><a href="#">query: (process.parent.command_line:\"bash\\ \\-i\" and (process.command_line:(*\\-c\\ import\\ * or *base64* or *pty.spawn*) or process.executable:(*whoami or *iptables or *\\/ncat or *\\/nc or *\\/netcat)))
<li><a href="#">query: (process.parent.executable.text:(*\\\\java.exe or *\\\\javaw.exe) and process.parent.command_line.text:*sysaidserver*)
<li><a href="#">query: (process.parent.executable.text:(*\\\\minesweeper.exe or *\\\\winver.exe or *\\\\bitsadmin.exe) or (process.parent.executable.text:(*\\\\csrss.exe or *\\\\certutil.exe or *\\\\eventvwr.exe or *\\\\calc.exe or *\\\\notepad.exe) and (not ((process.executable.text:(*\\\\werfault.exe or *\\\\wermgr.exe or *\\\\conhost.exe or *\\\\mmc.exe or *\\\\win32calc.exe or *\\\\notepad.exe)) or (not _exists_:process.executable.text)))))
<li><a href="#">query: (process.parent.executable.text:(*\\\\powershell.exe or *\\\\pwsh.exe) and process.parent.command_line.text:*\\\\windowspowershell\\\\modules\\\\pester\\\\* and process.parent.command_line.text:(*\\{\\ invoke\\-pester\\ \\-enableexit\\ ;* or *\\{\\ get\\-help\\ \\\"*))
<li><a href="#">query: (process.parent.executable.text:(*\\\\sysmon.exe or *\\\\sysmon64.exe) and (not ((process.executable.text:(\"c:\\windows\\sysmon.exe\" or \"c:\\windows\\sysmon64.exe\" or \"c:\\windows\\system32\\conhost.exe\" or \"wevtutil.exe\" or \"c:\\windows\\system32\\wevtutil.exe\" or \"c:\\windows\\system32\\werfault.exe\")) or (process.executable.text:*\\\\appdata\\\\local\\\\temp\\\\sysmon.exe))))
<li><a href="#">query: (process.parent.executable.text:*\\/script\\ editor and ((process.executable.text:(*\\/curl or *\\/bash or *\\/sh or *\\/zsh or *\\/dash or *\\/fish or *\\/osascript or *\\/mktemp or *\\/chmod or *\\/php or *\\/nohup or *\\/openssl or *\\/plutil or *\\/plistbuddy or *\\/xattr or *\\/sqlite or *\\/funzip or *\\/popen)) or (process.executable.text:(*python* or *perl*))))
<li><a href="#">query: (process.parent.executable.text:*\\\\appvlp.exe and (not (process.executable.text:(*\\\\msoasb.exe or *\\\\rundll32.exe))))
<li><a href="#">query: (process.parent.executable.text:*\\\\atlassian\\\\confluence\\\\jre\\\\bin\\\\java.exe and process.command_line.text:(*cmd\\ \\/c* or *cmd\\ \\/k* or *powershell* or *certutil* or *curl* or *whoami* or *ipconfig*))
<li><a href="#">query: (process.parent.executable.text:*\\\\conhost.exe and (not ((provider_name:\"systemtraceprovider\\-process\") or (provider_name:\"microsoft\\-windows\\-kernel\\-process\" and process.executable.text:*\\\\git.exe and process.parent.command_line.text:(*\\ show\\ \\-\\-textconv\\ * or *\\ cat\\-file\\ \\-s\\ *)) or (process.parent.command_line.text:*c\\:\\\\windows\\\\system32\\\\conhost.exe\\ 0x4* and process.command_line.text:(*\\ show\\ \\-\\-textconv\\ * or *\\ cat\\-file\\ \\-s\\ *)) or (provider_name:\"microsoft\\-windows\\-kernel\\-process\" and process.parent.command_line.text:*\\ cat\\-file\\ \\-s\\ * and process.executable.text:\"c\\:\\\\windows\\\\system32\\\\conhost.exe\") or (process.parent.command_line.text:(\\??\\\\c\\:\\\\windows\\\\system32\\\\conhost.exe\\ 0x4 or \\??\\\\c\\:\\\\windows\\\\system32\\\\conhost.exe\\ 0xffffffff\\ \\-forcev1) and process.executable.text:\"c\\:\\\\windows\\\\system32\\\\conhost.exe\") or (process.parent.command_line.text:\\??\\\\c\\:\\\\windows\\\\system32\\\\conhost.exe\\ 0xffffffff\\ \\-forcev1 and process.executable.text:\"c\\:\\\\program\\ files\\\\git\\\\mingw64\\\\bin\\\\git.exe\" and process.command_line.text:*show\\ \\-\\-textconv\\ \\:*))))
<li><a href="#">query: (process.parent.executable.text:*\\\\consent.exe and process.executable.text:*\\\\werfault.exe and integritylevel:(\"high\" or \"system\"))
<li><a href="#">query: (process.parent.executable.text:*\\\\customshellhost.exe and (not (process.executable.text:\"c\\:\\\\windows\\\\explorer.exe\")))
<li><a href="#">query: (process.parent.executable.text:*\\\\eventvwr.exe and (not (process.executable.text:*\\\\mmc.exe)))
<li><a href="#">query: (process.parent.executable.text:*\\\\ftp.exe or ((process.executable.text:*\\\\ftp.exe or winlog.event_data.originalfilename:\"ftp.exe\") and process.command_line.text:*\\-s\\:*))
<li><a href="#">query: (process.parent.executable.text:*\\\\onenote.exe and ((((winlog.event_data.originalfilename:(\"rundll32.exe\" or \"regsvr32.exe\" or \"bitsadmin.exe\" or \"certutil.exe\" or \"installutil.exe\" or \"schtasks.exe\" or \"wmic.exe\" or \"cscript.exe\" or \"wscript.exe\" or \"cmstp.exe\" or \"microsoft.workflow.compiler.exe\" or \"regasm.exe\" or \"regsvcs.exe\" or \"mshta.exe\" or \"msxsl.exe\" or \"ieexec.exe\" or \"cmd.exe\" or \"powershell.exe\" or \"hh.exe\" or \"javaw.exe\" or \"pcalua.exe\" or \"curl.exe\" or \"scriptrunner.exe\" or \"certoc.exe\" or \"workfolders.exe\" or \"odbcconf.exe\" or \"msiexec.exe\" or \"msdt.exe\")) or (process.executable.text:(*\\\\rundll32.exe or *\\\\regsvr32.exe or *\\\\bitsadmin.exe or *\\\\certutil.exe or *\\\\installutil.exe or *\\\\schtasks.exe or *\\\\wmic.exe or *\\\\cscript.exe or *\\\\wscript.exe or *\\\\cmstp.exe or *\\\\microsoft.workflow.compiler.exe or *\\\\regasm.exe or *\\\\regsvcs.exe or *\\\\mshta.exe or *\\\\msxsl.exe or *\\\\ieexec.exe or *\\\\cmd.exe or *\\\\powershell.exe or *\\\\hh.exe or *\\\\javaw.exe or *\\\\pcalua.exe or *\\\\curl.exe or *\\\\scriptrunner.exe or *\\\\certoc.exe or *\\\\workfolders.exe or *\\\\odbcconf.exe or *\\\\msiexec.exe or *\\\\msdt.exe)))) or ((process.executable.text:*\\\\explorer.exe and process.command_line.text:(*.hta* or *.vb* or *.wsh* or *.js* or *.ps* or *.scr* or *.pif* or *.bat* or *.cmd*))) or (process.executable.text:(*\\\\appdata\\\\* or *\\\\users\\\\public\\\\* or *\\\\programdata\\\\* or *\\\\windows\\\\tasks\\\\* or *\\\\windows\\\\temp\\\\* or *\\\\windows\\\\system32\\\\tasks\\\\*))))
<li><a href="#">query: (process.parent.executable.text:*\\\\pkgmgr.exe and process.executable.text:*\\\\dism.exe and integritylevel:(\"high\" or \"system\"))
<li><a href="#">query: (process.parent.executable.text:*\\\\powershell.exe and process.executable.text:*nslookup* and process.command_line.text:*\\=txt\\ *)
<li><a href="#">query: (process.parent.executable.text:*\\\\regsvr32.exe and process.executable.text:*\\\\explorer.exe)
<li><a href="#">query: (process.parent.executable.text:*\\\\sdiagnhost.exe and process.executable.text:(*\\\\powershell.exe or *\\\\pwsh.exe or *\\\\cmd.exe or *\\\\mshta.exe or *\\\\cscript.exe or *\\\\wscript.exe or *\\\\taskkill.exe or *\\\\regsvr32.exe or *\\\\rundll32.exe or *\\\\calc.exe))
<li><a href="#">query: (process.parent.executable.text:*\\\\svchost.exe and process.executable.text:(*\\\\winword.exe or *\\\\excel.exe or *\\\\powerpnt.exe or *\\\\msaccess.exe or *\\\\mspub.exe or *\\\\eqnedt32.exe or *\\\\visio.exe))
<li><a href="#">query: (process.parent.executable.text:*\\\\userinit.exe and (not ((process.command_line.text:*\\\\netlogon\\\\*) or (process.executable.text:*\\\\explorer.exe or imagefilename:\"explorer.exe\"))))
<li><a href="#">query: (process.parent.executable.text:*\\\\vsjitdebugger.exe and (not ((process.executable.text:*\\\\vsimmersiveactivatehelper*.exe or process.executable.text:*\\\\devenv.exe))))
<li><a href="#">query: (process.parent.executable.text:*\\\\w3wp.exe and (process.command_line.text:*appcmd.exe\\ add\\ module* or (process.command_line.text:*\\ system.enterpriseservices.internal.publish* and process.executable.text:*\\\\powershell.exe) or process.command_line.text:*\\ \\\\gacutil.exe\\ \\/i*))
<li><a href="#">query: (process.parent.executable.text:*c\\:\\\\program\\ files\\\\windowsapps\\\\* and ((process.executable.text:(*\\\\poweshell.exe or *\\\\pwsh.exe or *\\\\rundll32.exe or *\\\\regsvr32.exe or *\\\\mshta.exe or *\\\\cscript.exe or *\\\\wscript.exe)) or (process.command_line.text:(*cmd\\ \\/c* or *invoke\\-* or *base64*))))
<li><a href="#">query: (process.parent.executable.text:*c\\:\\\\users\\\\* and process.parent.executable.text:*\\\\appdata\\\\local\\\\temp\\\\* and process.parent.executable.text:*\\\\dismhost.exe* and integritylevel:(\"high\" or \"system\"))
<li><a href="#">query: (process.parent.executable.text:*screenconnect.clientservice.exe and process.executable.text:(*\\\\cmd.exe or *\\\\powershell.exe or *\\\\pwsh.exe))
<li><a href="#">query: (process.parent.executable.text:*updata.exe and process.command_line.text:*config* and process.command_line.text:*msdtc* and process.command_line.text:*start* and process.command_line.text:*auto*)
<li><a href="#">query: (process.parent.executable:(*\\\\powershell.exe or *\\\\cmd.exe or *\\\\mshta.exe or *\\\\cscript.exe or *\\\\wscript.exe or *\\\\wsl.exe or *\\\\rundll32.exe or *\\\\regsvr32.exe) and (process.executable:*\\\\msdt.exe or winlog.event_data.originalfilename:\"msdt.exe\"))
<li><a href="#">query: (process.parent.executable:(*\\\\powershell.exe or *\\\\pwsh.exe or *\\\\cmd.exe or *\\\\mshta.exe or *\\\\cscript.exe or *\\\\wscript.exe or *\\\\wsl.exe or *\\\\rundll32.exe or *\\\\regsvr32.exe) and (process.executable:*\\\\msdt.exe or winlog.event_data.originalfilename:\"msdt.exe\"))
<li><a href="#">query: (process.parent.executable:(*\\\\powershell.exe or *\\\\pwsh.exe) and process.executable:(*\\\\powershell.exe or *\\\\pwsh.exe) and process.command_line:*get\\-content* and process.command_line:*\\-stream*)
<li><a href="#">query: (process.parent.executable:(*\\\\powershell.exe or *\\\\pwsh.exe) and process.executable:*\\\\schtasks.exe and process.command_line:*\\/create* and process.command_line:*\\/sc* and process.command_line:*\\/tn* and process.command_line:*updater* and process.command_line:*\\/tr* and process.command_line:*powershell* and process.command_line:(*onlogon* or *daily* or *onidle* or *updater*))
<li><a href="#">query: (process.parent.executable:(*\\\\w3wp.exe or *\\\\httpd.exe or *\\\\nginx.exe or *\\\\php\\-cgi.exe or *\\\\tomcat.exe or *\\\\umworkerprocess.exe or *\\\\ws_tomcatservice.exe) and process.executable:(*\\\\cmd.exe or *\\\\sh.exe or *\\\\bash.exe or *\\\\powershell.exe or *\\\\bitsadmin.exe))
<li><a href="#">query: (process.parent.executable:(*\\\\winword.exe or *\\\\excel.exe or *\\\\powerpnt.exe or *\\\\msaccess.exe or *\\\\mspub.exe or *\\\\eqnedt32.exe or *\\\\visio.exe) and process.executable:(*\\\\windows\\\\system32\\\\* or *\\\\windows\\\\syswow64\\\\*) and process.command_line:(\"..\\/..\\/..\\/..\" or \"..\\\\..\\\\..\\\\..\" or \"..\\/\\/..\\/\\/..\\/\\/..\"))
<li><a href="#">query: (process.parent.executable:(*\\\\winword.exe or *\\\\excel.exe or *\\\\powerpnt.exe or *\\\\mspub.exe or *\\\\visio.exe or *\\\\msaccess.exe or *\\\\eqnedt32.exe) and process.executable:(*\\\\cmd.exe or *\\\\powershell.exe or *\\\\pwsh.exe or *\\\\wscript.exe or *\\\\cscript.exe or *\\\\sh.exe or *\\\\bash.exe or *\\\\scrcons.exe or *\\\\schtasks.exe or *\\\\regsvr32.exe or *\\\\hh.exe or *\\\\wmic.exe or *\\\\mshta.exe or *\\\\rundll32.exe or *\\\\msiexec.exe or *\\\\forfiles.exe or *\\\\scriptrunner.exe or *\\\\mftrace.exe or *\\\\appvlp.exe or *\\\\svchost.exe or *\\\\msbuild.exe))
<li><a href="#">query: (process.parent.executable:(*\\\\winword.exe or *\\\\excel.exe or *\\\\powerpnt.exe or *\\\\mspub.exe or *\\\\visio.exe or *\\\\outlook.exe or *\\\\msaccess.exe or *\\\\eqnedt32.exe) and process.executable:(*\\\\cmd.exe or *\\\\powershell.exe or *\\\\wscript.exe or *\\\\cscript.exe or *\\\\sh.exe or *\\\\bash.exe or *\\\\scrcons.exe or *\\\\schtasks.exe or *\\\\regsvr32.exe or *\\\\hh.exe or *\\\\wmic.exe or *\\\\mshta.exe or *\\\\rundll32.exe or *\\\\msiexec.exe or *\\\\forfiles.exe or *\\\\scriptrunner.exe or *\\\\mftrace.exe or *\\\\appvlp.exe or *\\\\svchost.exe or *\\\\msbuild.exe))
<li><a href="#">query: (process.parent.executable:*\\/java and process.command_line:(*\\/bin\\/sh* or *bash* or *dash* or *ksh* or *zsh* or *csh* or *fish* or *curl* or *wget* or *python*))
<li><a href="#">query: (process.parent.executable:*\\\\atlassian\\\\confluence\\\\jre\\\\bin\\\\java.exe and process.command_line:(*cmd\\ \\/c* or *cmd\\ \\/k* or *powershell* or *certutil* or *curl* or *whoami* or *ipconfig*))
<li><a href="#">query: (process.parent.executable:*\\\\bash and process.command_line:(*id\\ \\-gn\\ `* or *id\\ \\-gn\\ '*))
<li><a href="#">query: (process.parent.executable:*\\\\cmd.exe and process.executable:*\\\\nltest.exe and process.command_line:*\\/domain_trusts\\ \\/all_trusts*)
<li><a href="#">query: (process.parent.executable:*\\\\cmd.exe and process.parent.command_line:*.bat and process.command_line:*.bat.exe* and ((process.executable:*\\\\xcopy.exe and process.command_line:*powershell.exe*) or (process.executable:*\\\\xcopy.exe and process.command_line:*pwsh.exe*) or (process.executable:*\\\\attrib.exe and process.command_line:*\\+s* and process.command_line:*\\+h*)))
<li><a href="#">query: (process.parent.executable:*\\\\conhost.exe and (not (provider_name:\"systemtraceprovider\\-process\")))
<li><a href="#">query: (process.parent.executable:*\\\\consent.exe and process.executable:*\\\\werfault.exe and integritylevel:(\"high\" or \"system\"))
<li><a href="#">query: (process.parent.executable:*\\\\dllhost.exe and integritylevel:(\"high\" or \"system\") and process.parent.command_line:(*\\ \\/processid\\:\\{3e5fc7f9\\-9a51\\-4367\\-9063\\-a120244fbec7\\}* or *\\ \\/processid\\:\\{3e000d72\\-a845\\-4cd9\\-bd83\\-80c07c3b881f\\}* or *\\ \\/processid\\:\\{bd54c901\\-076b\\-434e\\-b6c7\\-17c531f4ab41\\}* or *\\ \\/processid\\:\\{d2e7041b\\-2927\\-42fb\\-8e9f\\-7ce93b6dc937\\}* or *\\ \\/processid\\:\\{e9495b87\\-d950\\-4ab5\\-87a5\\-ff6d70bf3e90\\}*))
<li><a href="#">query: (process.parent.executable:*\\\\edgetransport.exe and (not (process.executable:\"c\\:\\\\windows\\\\system32\\\\conhost.exe\")))
<li><a href="#">query: (process.parent.executable:*\\\\eventvwr.exe and (not (process.executable:*\\\\mmc.exe)))
<li><a href="#">query: (process.parent.executable:*\\\\hwp.exe and process.executable:*\\\\gbb.exe)
<li><a href="#">query: (process.parent.executable:*\\\\java.exe and process.executable:(*\\\\sh.exe or *\\\\bash.exe or *\\\\powershell.exe or *\\\\pwsh.exe or *\\\\schtasks.exe or *\\\\certutil.exe or *\\\\whoami.exe or *\\\\bitsadmin.exe or *\\\\wscript.exe or *\\\\cscript.exe or *\\\\scrcons.exe or *\\\\regsvr32.exe or *\\\\hh.exe or *\\\\wmic.exe or *\\\\mshta.exe or *\\\\rundll32.exe or *\\\\forfiles.exe or *\\\\scriptrunner.exe or *\\\\mftrace.exe or *\\\\appvlp.exe or *\\\\curl.exe))
<li><a href="#">query: (process.parent.executable:*\\\\java.exe and process.executable:(*\\\\sh.exe or *\\\\bash.exe or *\\\\powershell.exe or *\\\\schtasks.exe or *\\\\certutil.exe or *\\\\whoami.exe or *\\\\bitsadmin.exe or *\\\\wscript.exe or *\\\\cscript.exe or *\\\\scrcons.exe or *\\\\regsvr32.exe or *\\\\hh.exe or *\\\\wmic.exe or *\\\\mshta.exe or *\\\\rundll32.exe or *\\\\forfiles.exe or *\\\\scriptrunner.exe or *\\\\mftrace.exe or *\\\\appvlp.exe or *\\\\curl.exe))
<li><a href="#">query: (process.parent.executable:*\\\\keytool.exe and process.executable:(*\\\\cmd.exe or *\\\\sh.exe or *\\\\bash.exe or *\\\\powershell.exe or *\\\\pwsh.exe or *\\\\schtasks.exe or *\\\\certutil.exe or *\\\\whoami.exe or *\\\\bitsadmin.exe or *\\\\wscript.exe or *\\\\cscript.exe or *\\\\scrcons.exe or *\\\\regsvr32.exe or *\\\\hh.exe or *\\\\wmic.exe or *\\\\mshta.exe or *\\\\rundll32.exe or *\\\\forfiles.exe or *\\\\scriptrunner.exe or *\\\\mftrace.exe or *\\\\appvlp.exe))
<li><a href="#">query: (process.parent.executable:*\\\\keytool.exe and process.executable:(*\\\\cmd.exe or *\\\\sh.exe or *\\\\bash.exe or *\\\\powershell.exe or *\\\\schtasks.exe or *\\\\certutil.exe or *\\\\whoami.exe or *\\\\bitsadmin.exe or *\\\\wscript.exe or *\\\\cscript.exe or *\\\\scrcons.exe or *\\\\regsvr32.exe or *\\\\hh.exe or *\\\\wmic.exe or *\\\\mshta.exe or *\\\\rundll32.exe or *\\\\forfiles.exe or *\\\\scriptrunner.exe or *\\\\mftrace.exe or *\\\\appvlp.exe))
<li><a href="#">query: (process.parent.executable:*\\\\mmc.exe and (process.executable:(*\\\\cmd.exe or *\\\\powershell.exe or *\\\\pwsh.exe or *\\\\wscript.exe or *\\\\cscript.exe or *\\\\sh.exe or *\\\\bash.exe or *\\\\reg.exe or *\\\\regsvr32.exe) or process.executable:*\\\\bitsadmin*))
<li><a href="#">query: (process.parent.executable:*\\\\mmc.exe and (process.executable:(*\\\\cmd.exe or *\\\\powershell.exe or *\\\\wscript.exe or *\\\\cscript.exe or *\\\\sh.exe or *\\\\bash.exe or *\\\\reg.exe or *\\\\regsvr32.exe) or process.executable:*\\\\bitsadmin*))
<li><a href="#">query: (process.parent.executable:*\\\\mshta.exe and (process.executable:(*\\\\cmd.exe or *\\\\powershell.exe or *\\\\pwsh.exe or *\\\\wscript.exe or *\\\\cscript.exe or *\\\\sh.exe or *\\\\bash.exe or *\\\\reg.exe or *\\\\regsvr32.exe) or process.executable:*\\\\bitsadmin*))
<li><a href="#">query: (process.parent.executable:*\\\\mshta.exe and (process.executable:(*\\\\cmd.exe or *\\\\powershell.exe or *\\\\wscript.exe or *\\\\cscript.exe or *\\\\sh.exe or *\\\\bash.exe or *\\\\reg.exe or *\\\\regsvr32.exe) or process.executable:*\\\\bitsadmin*))
<li><a href="#">query: (process.parent.executable:*\\\\mshta.exe and process.executable:(*\\\\powershell.exe or *\\\\cmd.exe or *\\\\wscript.exe))
<li><a href="#">query: (process.parent.executable:*\\\\net.exe and process.executable:*\\\\net1.exe and process.command_line:*share* and process.command_line:*\\/delete*)
<li><a href="#">query: (process.parent.executable:*\\\\outlook.exe and process.executable:(*\\\\cmd.exe or *\\\\powershell.exe or *\\\\wscript.exe or *\\\\cscript.exe or *\\\\sh.exe or *\\\\bash.exe or *\\\\scrcons.exe or *\\\\schtasks.exe or *\\\\regsvr32.exe or *\\\\hh.exe or *\\\\wmic.exe or *\\\\mshta.exe or *\\\\msiexec.exe or *\\\\forfiles.exe or *\\\\scriptrunner.exe or *\\\\mftrace.exe or *\\\\appvlp.exe or *\\\\svchost.exe or *\\\\msbuild.exe))
<li><a href="#">query: (process.parent.executable:*\\\\pkgmgr.exe and process.executable:*\\\\dism.exe and integritylevel:(\"high\" or \"system\"))
<li><a href="#">query: (process.parent.executable:*\\\\powershell.exe and process.executable:*\\\\powershell.exe and process.command_line:*get\\-content* and process.command_line:*\\-stream*)
<li><a href="#">query: (process.parent.executable:*\\\\powershell.exe and process.executable:*\\\\schtasks.exe and process.command_line:*\\/create* and process.command_line:*\\/sc* and process.command_line:(*onlogon* or *daily* or *onidle* or *updater*) and process.command_line:*\\/tn* and process.command_line:*updater* and process.command_line:*\\/tr* and process.command_line:*powershell*)
<li><a href="#">query: (process.parent.executable:*\\\\regsvr32.exe and process.executable:*\\\\explorer.exe)
<li><a href="#">query: (process.parent.executable:*\\\\rundll32.exe and process.executable:*\\\\explorer.exe)
<li><a href="#">query: (process.parent.executable:*\\\\scrcons.exe and process.executable:(*\\\\svchost.exe or *\\\\dllhost.exe or *\\\\powershell.exe or *\\\\pwsh.exe or *\\\\wscript.exe or *\\\\cscript.exe or *\\\\schtasks.exe or *\\\\regsvr32.exe or *\\\\mshta.exe or *\\\\rundll32.exe or *\\\\msiexec.exe or *\\\\msbuild.exe))
<li><a href="#">query: (process.parent.executable:*\\\\scrcons.exe and process.executable:(*\\\\svchost.exe or *\\\\dllhost.exe or *\\\\powershell.exe or *\\\\wscript.exe or *\\\\cscript.exe or *\\\\schtasks.exe or *\\\\regsvr32.exe or *\\\\mshta.exe or *\\\\rundll32.exe or *\\\\msiexec.exe or *\\\\msbuild.exe))
<li><a href="#">query: (process.parent.executable:*\\\\sdiagnhost.exe and process.executable:(*\\\\powershell.exe or *\\\\cmd.exe or *\\\\mshta.exe or *\\\\cscript.exe or *\\\\wscript.exe or *\\\\taskkill.exe))
<li><a href="#">query: (process.parent.executable:*\\\\serv\\-u.exe and process.executable:(*\\\\cmd.exe or *\\\\powershell.exe or *\\\\pwsh.exe or *\\\\wscript.exe or *\\\\cscript.exe or *\\\\sh.exe or *\\\\bash.exe or *\\\\schtasks.exe or *\\\\regsvr32.exe or *\\\\wmic.exe or *\\\\mshta.exe or *\\\\rundll32.exe or *\\\\msiexec.exe or *\\\\forfiles.exe or *\\\\scriptrunner.exe))
<li><a href="#">query: (process.parent.executable:*\\\\serv\\-u.exe and process.executable:(*\\\\cmd.exe or *\\\\powershell.exe or *\\\\wscript.exe or *\\\\cscript.exe or *\\\\sh.exe or *\\\\bash.exe or *\\\\schtasks.exe or *\\\\regsvr32.exe or *\\\\wmic.exe or *\\\\mshta.exe or *\\\\rundll32.exe or *\\\\msiexec.exe or *\\\\forfiles.exe or *\\\\scriptrunner.exe))
<li><a href="#">query: (process.parent.executable:*\\\\sllauncher.exe and process.executable:*\\\\svchost.exe)
<li><a href="#">query: (process.parent.executable:*\\\\sqlservr.exe and process.executable:(*\\\\cmd.exe or *\\\\sh.exe or *\\\\bash.exe or *\\\\powershell.exe or *\\\\bitsadmin.exe))
<li><a href="#">query: (process.parent.executable:*\\\\svchost.exe and process.executable:*\\\\mmc.exe and process.command_line:*\\-embedding*)
<li><a href="#">query: (process.parent.executable:*\\\\svchost.exe and process.executable:*\\\\mshta.exe)
<li><a href="#">query: (process.parent.executable:*\\\\system32\\\\dns.exe and (not (process.executable:(*\\\\system32\\\\werfault.exe or *\\\\system32\\\\conhost.exe or *\\\\system32\\\\dnscmd.exe or *\\\\system32\\\\dns.exe))))
<li><a href="#">query: (process.parent.executable:*\\\\system32\\\\dns.exe and (not (process.executable:(*\\\\system32\\\\werfault.exe or *\\\\system32\\\\conhost.exe or *\\\\system32\\\\dnscmd.exe))))
<li><a href="#">query: (process.parent.executable:*\\\\taskmgr.exe and (not (process.executable:(*\\\\resmon.exe or *\\\\mmc.exe or *\\\\taskmgr.exe))))
<li><a href="#">query: (process.parent.executable:*\\\\vbc.exe and process.executable:*\\\\cvtres.exe)
<li><a href="#">query: (process.parent.executable:*\\\\vsjitdebugger.exe and (not ((process.executable:*\\\\vsimmersiveactivatehelper*.exe or process.executable:*\\\\devenv.exe))))
<li><a href="#">query: (process.parent.executable:*\\\\winlogon.exe and process.executable:*\\\\cmd.exe and process.command_line:(*sethc.exe* or *utilman.exe* or *osk.exe* or *magnify.exe* or *narrator.exe* or *displayswitch.exe*))
<li><a href="#">query: (process.parent.executable:*\\\\winword.exe and process.executable:*\\\\csc.exe)
<li><a href="#">query: (process.parent.executable:*\\\\winword.exe and process.executable:*\\\\fltldr.exe*)
<li><a href="#">query: (process.parent.executable:*\\\\winword.exe and process.executable:*\\\\microscmgmt.exe)
<li><a href="#">query: (process.parent.executable:*\\\\wmiprvse.exe and (process.executable:*\\\\mshta.exe or winlog.event_data.originalfilename:\"mshta.exe\"))
<li><a href="#">query: (process.parent.executable:*\\\\wsmprovhost.exe and process.executable:(*\\\\cmd.exe or *\\\\sh.exe or *\\\\bash.exe or *\\\\powershell.exe or *\\\\pwsh.exe or *\\\\wsl.exe or *\\\\schtasks.exe or *\\\\certutil.exe or *\\\\whoami.exe or *\\\\bitsadmin.exe))
<li><a href="#">query: (process.parent.executable:*\\\\wsmprovhost.exe and process.executable:(*\\\\cmd.exe or *\\\\sh.exe or *\\\\bash.exe or *\\\\powershell.exe or *\\\\schtasks.exe or *\\\\certutil.exe or *\\\\whoami.exe or *\\\\bitsadmin.exe))
<li><a href="#">query: (process.parent.executable:*\\\\wsreset.exe and (not (process.executable:*\\\\conhost.exe or winlog.event_data.originalfilename:\"conhost.exe\")))
<li><a href="#">query: (process.parent.executable:*\\\\wsreset.exe and (not (process.executable:*\\\\conhost.exe)))
<li><a href="#">query: (process.parent.executable:*c\\:\\\\users\\\\* and process.parent.executable:*\\\\appdata\\\\local\\\\temp\\\\* and process.parent.executable:*\\\\dismhost.exe* and integritylevel:(\"high\" or \"system\"))
<li><a href="#">query: (process.parent.executable:*desktopcentral_server\\\\jre\\\\bin\\\\java.exe and process.executable:(*\\\\cmd.exe or *\\\\powershell.exe or *\\\\bitsadmin.exe))
<li><a href="#">query: (process.parent.executable:*desktopcentral_server\\\\jre\\\\bin\\\\java.exe and process.executable:(*\\\\cmd.exe or *\\\\powershell.exe or *\\\\pwsh.exe or *\\\\bitsadmin.exe))
<li><a href="#">query: (process.parent.executable:*pdqdeployrunner\\-* and (process.executable:(*\\\\wscript.exe or *\\\\cscript.exe or *\\\\rundll32.exe or *\\\\regsvr32.exe or *\\\\wmic.exe or *\\\\msiexec.exe or *\\\\mshta.exe or *\\\\csc.exe or *\\\\dllhost.exe or *\\\\certutil.exe or *\\\\scriptrunner.exe or *\\\\bash.exe or *\\\\wsl.exe) or process.executable:(*c\\:\\\\users\\\\public\\\\* or *c\\:\\\\programdata\\\\* or *c\\:\\\\windows\\\\temp\\\\* or *\\\\appdata\\\\local\\\\temp*) or process.command_line:(*iex\\ * or *invoke\\-* or *downloadstring* or *http* or *\\ \\-enc\\ * or *\\ \\-encodedcommand\\ * or *frombase64string* or *\\ \\-decode\\ * or *\\ \\-w\\ hidden*)))
<li><a href="#">query: (process.parent.executable:*umworkerprocess.exe and (not (process.executable:(*wermgr.exe or *werfault.exe))))
<li><a href="#">query: (process.parent.executable:*updata.exe and process.command_line:*config* and process.command_line:*msdtc* and process.command_line:*start* and process.command_line:*auto*)
<li><a href="#">query: (process.parent.executable:\"c\\:\\\\windows\\\\explorer.exe\" and process.executable:\"c\\:\\\\windows\\\\system32\\\\cmd.exe\" and process.command_line:*powershell* and process.command_line:*.lnk*)
<li><a href="#">query: (process.parent.executable:\"c\\:\\\\windows\\\\hh.exe\" and process.executable:(*\\\\cmd.exe or *\\\\powershell.exe or *\\\\pwsh.exe or *\\\\wscript.exe or *\\\\cscript.exe or *\\\\regsvr32.exe or *\\\\wmic.exe or *\\\\rundll32.exe))
<li><a href="#">query: (process.parent.executable:\"c\\:\\\\windows\\\\hh.exe\" and process.executable:(*\\\\cmd.exe or *\\\\powershell.exe or *\\\\wscript.exe or *\\\\cscript.exe or *\\\\regsvr32.exe or *\\\\wmic.exe or *\\\\rundll32.exe))
<li><a href="#">query: (process.parent.executable:\\/opt\\/atlassian\\/confluence\\/* and process.parent.executable:*\\/java and process.command_line:(*\\/bin\\/sh* or *bash* or *dash* or *ksh* or *zsh* or *csh* or *fish* or *curl* or *wget* or *python*))
<li><a href="#">query: (process.parent.executable:c\\:\\\\users\\\\public\\\\* and process.command_line:(*powershell* or *cmd.exe\\ \\/c\\ * or *cmd\\ \\/c\\ * or *wscript.exe* or *cscript.exe* or *bitsadmin* or *certutil* or *mshta.exe*))
<li><a href="#">query: (product:(\"sysinternals\\ debugview\" or \"sysinternals\\ debugview\") and (not (winlog.event_data.originalfilename:\"dbgview.exe\" and process.executable:*\\\\dbgview.exe)))
<li><a href="#">query: (product:*mouse\\ lock* or company:*misc314* or process.command_line:*mouse\\ lock_*)
<li><a href="#">query: (product:\"uacme\" or company:(\"revol\\ corp\" or \"apt\\ 92\" or \"ug\\ north\" or \"hazardous\\ environments\" or \"cd\\ project\\ rekt\") or winlog.event_data.description:(\"uacme\\ main\\ module\" or \"pentesting\\ utility\") or winlog.event_data.originalfilename:(\"akagi.exe\" or \"akagi64.exe\") or process.executable.text:(*\\\\akagi64.exe or *\\\\akagi.exe) or winlog.event_data.hashes:(*imphash\\=767637c23bb42cd5d7397cf58b0be688* or *imphash\\=14c4e4c72ba075e9069ee67f39188ad8* or *imphash\\=3c782813d4afce07bbfc5a9772acdbdc* or *imphash\\=7d010c6bb6a3726f327f7e239166d127* or *imphash\\=89159ba4dd04e4ce5559f132a9964eb3* or *imphash\\=6f33f4a5fc42b8cec7314947bd13f30f* or *imphash\\=5834ed4291bdeb928270428ebbaf7604* or *imphash\\=5a8a8a43f25485e7ee1b201edcbc7a38* or *imphash\\=dc7d30b90b2d8abf664fbed2b1b59894* or *imphash\\=41923ea1f824fe63ea5beb84db7a3e74* or *imphash\\=3de09703c8e79ed2ca3f01074719906b*) or imphash:(\"767637c23bb42cd5d7397cf58b0be688\" or \"14c4e4c72ba075e9069ee67f39188ad8\" or \"3c782813d4afce07bbfc5a9772acdbdc\" or \"7d010c6bb6a3726f327f7e239166d127\" or \"89159ba4dd04e4ce5559f132a9964eb3\" or \"6f33f4a5fc42b8cec7314947bd13f30f\" or \"5834ed4291bdeb928270428ebbaf7604\" or \"5a8a8a43f25485e7ee1b201edcbc7a38\" or \"dc7d30b90b2d8abf664fbed2b1b59894\" or \"41923ea1f824fe63ea5beb84db7a3e74\" or \"3de09703c8e79ed2ca3f01074719906b\"))
<li><a href="#">query: (product:\"uacme\" or company:\"revol\\ corp\" or winlog.event_data.originalfilename:\"akagi.exe\")
<li><a href="#">query: (properties.message:(\"add\\ user\" or \"delete\\ user\") and winlog.event_data.status:\"success\")
<li><a href="#">query: (properties.message:(microsoft.network\\/virtualnetworkgateways\\/* or microsoft.network\\/virtualnetworks\\/*) and properties.message:(*\\/write or *\\/delete))
<li><a href="#">query: (properties.message:*add\\ user* and properties.message:*add\\ member\\ to\\ role* and winlog.event_data.status:\"success\")
<li><a href="#">query: (properties.message:\"admin\\ registered\\ security\\ info\" and winlog.event_data.status:\"admin\\ registered\\ temporary\\ access\\ pass\\ method\\ for\\ user\")
<li><a href="#">query: (properties.message:\"invite\\ external\\ user\" and winlog.event_data.status:\"failure\")
<li><a href="#">query: (properties.message:microsoft.network\\/dnszones* and properties.message:(*\\/write or *\\/delete))
<li><a href="#">query: (providername:\"wsman\" and (not (process.command_line.text:*powershell*)))
<li><a href="#">query: (resulttype:\"50057\" and resultdescription:\"user\\ account\\ is\\ disabled.\\ the\\ account\\ has\\ been\\ disabled\\ by\\ an\\ administrator.\")
<li><a href="#">query: (resulttype:\"53003\" and resultdescription:\"blocked\\ by\\ conditional\\ access\")
<li><a href="#">query: (sha1:\"e570585edc69f9074cb5e8a790708336bd45ca0f\" and (not (process.executable.text:(*\\:\\\\program\\ files\\(x86\\)\\\\* or *\\:\\\\program\\ files\\\\*))))
<li><a href="#">query: (sha1:\"e570585edc69f9074cb5e8a790708336bd45ca0f\" and (not (process.executable:(*\\:\\\\program\\ files\\(x86\\)\\\\* or *\\:\\\\program\\ files\\\\*))))
<li><a href="#">query: (status:\"success\" and authenticationrequirement:\"singlefactorauthentication\" and devicedetail.trusttype:\"\" and riskstate:\"atrisk\")
<li><a href="#">query: (targetfilename:*\\\\microsoft\\\\windows\\\\start\\ menu\\\\programs\\\\startup* and targetfilename:*.lnk.\\{0afaced1\\-e828\\-11d1\\-9187\\-b532f1e9575d\\}* and process.executable:*\\\\explorer.exe)
<li><a href="#">query: (type:\"execve\" and (((*truncate* and *-s*)) or (((*dd* and *if=*) and (not (*of=*))))))
<li><a href="#">query: (type:\"execve\" and ((*shutdown* or *reboot* or *halt* or *poweroff*) or ((*init* or *telinit*) and (*0* or *6*))))
<li><a href="#">query: (type:\"execve\" and ((a0:\"chmod\" and a1:\"777\") or (a0:\"chmod\" and a1:\"u\\+s\") or (a0:\"cp\" and a1:\"\\/bin\\/ksh\") or (a0:\"cp\" and a1:\"\\/bin\\/sh\")))
<li><a href="#">query: (type:\"execve\" and (*.bash_history* or *.zsh_history* or *.zhistory* or *.history* or *.sh_history* or *fish_history*))
<li><a href="#">query: (type:\"execve\" and (a0:\"zip\" or (a0:\"gzip\" and a1:\"\\-f\") or (a0:\"tar\" and a1:*\\-c*)))
<li><a href="#">query: (type:\"execve\" and \"grep\" and \"password\")
<li><a href="#">query: (type:\"execve\" and a0:(*chmod* or *chown*))
<li><a href="#">query: (type:\"execve\" and a0:(\"users\" or \"w\" or \"who\"))
<li><a href="#">query: (type:\"execve\" and a0:*chattr* and a1:*\\-i*)
<li><a href="#">query: (type:\"execve\" and a0:*dd* and a1:(*if\\=\\/dev\\/null* or *if\\=\\/dev\\/zero*))
<li><a href="#">query: (type:\"execve\" and a0:*systemctl* and a1:(*daemon\\-reload* or *start*))
<li><a href="#">query: (type:\"execve\" and a0:\"arecord\" and a1:\"\\-vv\" and a2:\"\\-fdat\")
<li><a href="#">query: (type:\"execve\" and a0:\"cat\" and a1:(*.jpg or *.png) and a2:*.zip)
<li><a href="#">query: (type:\"execve\" and a0:\"cp\" and a1:\"\\-i\" and a2:\"\\/bin\\/sh\" and a3:*\\/crond)
<li><a href="#">query: (type:\"execve\" and a0:\"getcap\" and a1:\"\\-r\" and a2:\"\\/\")
<li><a href="#">query: (type:\"execve\" and a0:\"steghide\" and a1:\"embed\" and a2:(\"\\-cf\" or \"\\-ef\") and a4:(\"\\-cf\" or \"\\-ef\"))
<li><a href="#">query: (type:\"execve\" and a0:\"steghide\" and a1:\"extract\" and a2:\"\\-sf\" and a3:(*.jpg or *.png))
<li><a href="#">query: (type:\"execve\" and a0:\"unzip\" and a1:(*.jpg or *.png))
<li><a href="#">query: (type:\"execve\" and a0:\"wget\" and a1:\\-\\-post\\-file\\=*)
<li><a href="#">query: (type:\"execve\" and a0:\"xclip\" and a1:(\"\\-selection\" or \"\\-sel\") and a2:(\"clipboard\" or \"clip\") and a3:\"\\-o\")
<li><a href="#">query: (type:\"execve\" and a0:\"xclip\" and a1:(\"\\-selection\" or \"\\-sel\") and a2:(\"clipboard\" or \"clip\") and a3:\"\\-t\" and a4:image\\/* and a5:\"\\-o\")
<li><a href="#">query: (type:\"execve\" and a1:\"\\-c\" and ((a0:\"tcpdump\" and a3:*\\-i*) or (a0:\"tshark\" and a3:\"\\-i\")))
<li><a href="#">query: (type:\"execve\" and a1:\"-c\" and (((a0:\"tcpdump\" and a3:*\\-i*)) or ((a0:\"tshark\" and a3:\"-i\"))))
<li><a href="#">query: (type:\"image is replaced\" and (not (process.executable.text:(*\\:\\\\program\\ files\\\\* or *\\:\\\\program\\ files\\ \\(x86\\)*) and process.executable.text:(*\\\\chrome.exe or *\\\\opera.exe or *\\\\firefox.exe or *\\\\microsoftedge.exe or *\\\\wmiadap.exe))))
<li><a href="#">query: (type:\"path\" and name:(\"\\/etc\\/syslog.conf\" or \"\\/etc\\/rsyslog.conf\" or \"\\/etc\\/syslog\\-ng\\/syslog\\-ng.conf\"))
<li><a href="#">query: (type:\"path\" and name:(\"\\/root\\/.bashrc\" or \"\\/root\\/.bash_profile\" or \"\\/root\\/.profile\" or \\/home\\/*\\/.bashrc or \\/home\\/*\\/.bash_profile or \\/home\\/*\\/.profile or \"\\/etc\\/profile\" or \"\\/etc\\/shells\" or \"\\/etc\\/bashrc\" or \"\\/etc\\/csh.cshrc\" or \"\\/etc\\/csh.login\"))
<li><a href="#">query: (type:\"path\" and name:(\"\\/sys\\/class\\/dmi\\/id\\/bios_version\" or \"\\/sys\\/class\\/dmi\\/id\\/product_name\" or \"\\/sys\\/class\\/dmi\\/id\\/chassis_vendor\" or \"\\/proc\\/scsi\\/scsi\" or \"\\/proc\\/ide\\/hd0\\/model\" or \"\\/proc\\/version\" or \\/etc\\/*version or \\/etc\\/*release or \"\\/etc\\/issue\"))
<li><a href="#">query: (type:\"path\" and name:(\\/etc\\/audit\\/* or \"\\/etc\\/libaudit.conf\" or \\/etc\\/audisp\\/*))
<li><a href="#">query: (type:\"path\" and name:\"\\/etc\\/ld.so.preload\")
<li><a href="#">query: (type:\"proctitle\" and proctitle:\"\\(null\\)\" and type:\"syscall\" and comm:\"pkexec\" and exe:\"\\/usr\\/bin\\/pkexec\")
<li><a href="#">query: (type:\"service_stop\" and unit:(\"firewalld\" or \"iptables\" or \"ufw\"))
<li><a href="#">query: (type:\"syscall\" and comm:\"insmod\" and exe:\"\\/usr\\/bin\\/kmod\")
<li><a href="#">query: (type:\"syscall\" and comm:\"split\")
<li><a href="#">query: (type:\"syscall\" and exe:(*\\/telnet or *\\/nmap or *\\/netcat or *\\/nc) and key:\"network_connect_4\")
<li><a href="#">query: (type:\"syscall\" and exe:(\\/tmp\\/* or \\/var\\/www\\/* or \\/home\\/*\\/public_html\\/* or \\/usr\\/local\\/apache2\\/* or \\/usr\\/local\\/httpd\\/* or \\/var\\/apache\\/* or \\/srv\\/www\\/* or \\/home\\/httpd\\/html\\/* or \\/srv\\/http\\/* or \\/usr\\/share\\/nginx\\/html\\/* or \\/var\\/lib\\/pgsql\\/data\\/* or \\/usr\\/local\\/mysql\\/data\\/* or \\/var\\/lib\\/mysql\\/* or \\/var\\/vsftpd\\/* or \\/etc\\/bind\\/* or \\/var\\/named\\/*))
<li><a href="#">query: (type:\"syscall\" and exe:\"\\/usr\\/bin\\/sudoedit\")
<li><a href="#">query: (type:\"syscall\" and syscall:\"execve\" and key:\"detect_execve_www\")
<li><a href="#">query: (type:\"syscall\" and syscall:\"execve\" and uid:\"0\" and cwd:\"\\/var\\/opt\\/microsoft\\/scx\\/tmp\" and comm:\"sh\")
<li><a href="#">query: (url.extension:(\"exe\" or \"vbs\" or \"bat\" or \"rar\" or \"ps1\" or \"doc\" or \"docm\" or \"xls\" or \"xlsm\" or \"pptm\" or \"rtf\" or \"hta\" or \"dll\" or \"ws\" or \"wsf\" or \"sct\" or \"zip\") and ((destination.domain:(*.country or *.stream or *.gdn or *.mom or *.xin or *.kim or *.men or *.loan or *.download or *.racing or *.online or *.science or *.ren or *.gb or *.win or *.top or *.review or *.vip or *.party or *.tech or *.xyz or *.date or *.faith or *.zip or *.cricket or *.space or *.info or *.vn or *.cm or *.am or *.cc or *.asia or *.ws or *.tk or *.biz or *.su or *.st or *.ro or *.ge or *.ms or *.pk or *.nu or *.me or *.ph or *.to or *.tt or *.name or *.tv or *.kz or *.tc or *.mobi or *.study or *.click or *.link or *.trade or *.accountant or *.cf or *.gq or *.ml or *.ga or *.pw)) or (url.domain:(*.country or *.stream or *.gdn or *.mom or *.xin or *.kim or *.men or *.loan or *.download or *.racing or *.online or *.science or *.ren or *.gb or *.win or *.top or *.review or *.vip or *.party or *.tech or *.xyz or *.date or *.faith or *.zip or *.cricket or *.space or *.info or *.vn or *.cm or *.am or *.cc or *.asia or *.ws or *.tk or *.biz or *.su or *.st or *.ro or *.ge or *.ms or *.pk or *.nu or *.me or *.ph or *.to or *.tt or *.name or *.tv or *.kz or *.tc or *.mobi or *.study or *.click or *.link or *.trade or *.accountant or *.cf or *.gq or *.ml or *.ga or *.pw))))
<li><a href="#">query: (url.extension:(\"exe\" or \"vbs\" or \"bat\" or \"rar\" or \"ps1\" or \"doc\" or \"docm\" or \"xls\" or \"xlsm\" or \"pptm\" or \"rtf\" or \"hta\" or \"dll\" or \"ws\" or \"wsf\" or \"sct\" or \"zip\") and (destination.domain:(*.hopto.org or *.no\\-ip.org or *.no\\-ip.info or *.no\\-ip.biz or *.no\\-ip.com or *.noip.com or *.ddns.name or *.myftp.org or *.myftp.biz or *.serveblog.net or *.servebeer.com or *.servemp3.com or *.serveftp.com or *.servequake.com or *.servehalflife.com or *.servehttp.com or *.servegame.com or *.servepics.com or *.myvnc.com or *.ignorelist.com or *.jkub.com or *.dlinkddns.com or *.jumpingcrab.com or *.ddns.info or *.mooo.com or *.dns\\-dns.com or *.strangled.net or *.adultdns.net or *.craftx.biz or *.ddns01.com or *.dns53.biz or *.dnsapi.info or *.dnsd.info or *.dnsdynamic.com or *.dnsdynamic.net or *.dnsget.org or *.fe100.net or *.flashserv.net or *.ftp21.net or *.http01.com or *.http80.info or *.https443.com or *.imap01.com or *.kadm5.com or *.mysq1.net or *.ns360.info or *.ntdll.net or *.ole32.com or *.proxy8080.com or *.sql01.com or *.ssh01.com or *.ssh22.net or *.tempors.com or *.tftpd.net or *.ttl60.com or *.ttl60.org or *.user32.com or *.voip01.com or *.wow64.net or *.x64.me or *.xns01.com or *.dyndns.org or *.dyndns.info or *.dyndns.tv or *.dyndns\\-at\\-home.com or *.dnsomatic.com or *.zapto.org or *.webhop.net or *.25u.com or *.slyip.net) or url.domain:(*.hopto.org or *.no\\-ip.org or *.no\\-ip.info or *.no\\-ip.biz or *.no\\-ip.com or *.noip.com or *.ddns.name or *.myftp.org or *.myftp.biz or *.serveblog.net or *.servebeer.com or *.servemp3.com or *.serveftp.com or *.servequake.com or *.servehalflife.com or *.servehttp.com or *.servegame.com or *.servepics.com or *.myvnc.com or *.ignorelist.com or *.jkub.com or *.dlinkddns.com or *.jumpingcrab.com or *.ddns.info or *.mooo.com or *.dns\\-dns.com or *.strangled.net or *.adultdns.net or *.craftx.biz or *.ddns01.com or *.dns53.biz or *.dnsapi.info or *.dnsd.info or *.dnsdynamic.com or *.dnsdynamic.net or *.dnsget.org or *.fe100.net or *.flashserv.net or *.ftp21.net or *.http01.com or *.http80.info or *.https443.com or *.imap01.com or *.kadm5.com or *.mysq1.net or *.ns360.info or *.ntdll.net or *.ole32.com or *.proxy8080.com or *.sql01.com or *.ssh01.com or *.ssh22.net or *.tempors.com or *.tftpd.net or *.ttl60.com or *.ttl60.org or *.user32.com or *.voip01.com or *.wow64.net or *.x64.me or *.xns01.com or *.dyndns.org or *.dyndns.info or *.dyndns.tv or *.dyndns\\-at\\-home.com or *.dnsomatic.com or *.zapto.org or *.webhop.net or *.25u.com or *.slyip.net)))
<li><a href="#">query: (url.extension:(\"exe\" or \"vbs\" or \"bat\" or \"rar\" or \"ps1\" or \"doc\" or \"docm\" or \"xls\" or \"xlsm\" or \"pptm\" or \"rtf\" or \"hta\" or \"dll\" or \"ws\" or \"wsf\" or \"sct\" or \"zip\") and (not ((destination.domain:(*.com or *.org or *.net or *.edu or *.gov or *.uk or *.ca or *.de or *.jp or *.fr or *.au or *.us or *.ch or *.it or *.nl or *.se or *.no or *.es)) or (url.domain:(*.com or *.org or *.net or *.edu or *.gov or *.uk or *.ca or *.de or *.jp or *.fr or *.au or *.us or *.ch or *.it or *.nl or *.se or *.no or *.es)))))
<li><a href="#">query: (url.original:(*_2f* or *_2b*) and url.original:*.avi* and url.original:*\\/images\\/*)
<li><a href="#">query: (url.original:*\\/* and url.original:*.php\\?l\\=* and url.original:*.cab and http.response.status_code:\"200\")
<li><a href="#">query: (url.original:*\\/ecp\\/default.aspx* and url.original:*__viewstategenerator\\=* and url.original:*__viewstate\\=*)
<li><a href="#">query: (url.original:*\\/oscp\\/* and (destination.domain:\"ocsp.verisign.com\" or url.domain:\"ocsp.verisign.com\"))
<li><a href="#">query: (url.original:*\\/rapi\\/filedownload?filter\\=path\\:%2f* or (url.original:*\\/pcidss\\/report* and url.original:*type\\=all_signatures* and url.original:*sig_name\\=_default_signature_*))
<li><a href="#">query: (url.original:*lang\\=\\/..\\/..\\/* and url.original:*\\/dev\\/cmdb\\/sslvpn_websession*)
<li><a href="#">query: (user.name:(*authori* or *autori*) and (winlog.event_data.originalfilename:\"whoami.exe\" or process.executable:*\\\\whoami.exe))
<li><a href="#">query: (user.name:(*authori* or *autori*) and process.executable:*\\\\whoami.exe)
<li><a href="#">query: (user.name:(nt\\ authority\\\\system* or autorite\\ nt\\\\sys*) and process.executable:*\\\\taskmgr.exe)
<li><a href="#">query: (user.name:(nt\\ authority\\\\system* or autorite\\ nt\\\\sys*) and process.executable:*\\\\tscon.exe)
<li><a href="#">query: (user.name:*trustedinstaller* and (winlog.event_data.originalfilename:\"whoami.exe\" or process.executable:*\\\\whoami.exe))
<li><a href="#">query: (user.name:*trustedinstaller* and process.executable:*\\\\whoami.exe)
<li><a href="#">query: (user.name:\"root\" and logonid:\"0\" and process.working_directory:\"\\/var\\/opt\\/microsoft\\/scx\\/tmp\" and process.command_line:*\\/bin\\/sh*)
<li><a href="#">query: (user.name:\"root\" and logonid:\"0\" and process.working_directory:\"\\/var\\/opt\\/microsoft\\/scx\\/tmp\" and process.command_line:*\\/etc\\/opt\\/microsoft\\/scx\\/conf\\/tmpdir\\/scx*)
<li><a href="#">query: (user_agent.original:(\"mozilla\\/4.0\\ \\(compatible;\\ msie\\ 6.0;windows\\ nt\\ 5.1\\)\" or \"mozilla\\/4.0\\ \\(compatible;\\ msie\\ 7.0;\\ windows\\ nt\\ 6.1;\\ wow64;\\ trident\\/4.0;\\ slcc2;\\ .net\\ clr\\ 3.0.30729;\\ .net4.0c;\\ .net4.0e\\ \\)\" or \"mozilla\\/5.0\\ \\(windows;\\ u;\\ msie\\ 7.0;\\ windows\\ nt\\ 5.2\\)\\ java\\/1.5.0_08\") or user_agent.original:*;\\ manm;\\ manm\\))
<li><a href="#">query: (user_agent.original:\"mozilla/5.0 (windows nt 10.0; win64; x64) applewebkit/537.36 (khtml, like gecko) chrome/105.0.5195.54 safari/537.36\" and http.request.method:\"post\" and http.response.status_code:\"200\" and url.original:*\\/owa\\/mastermailbox* and url.original:*\\/powershell*)
<li><a href="#">query: (user_agent.original:\"mozilla\\/5.0\\ \\(windows\\ nt\\ 6.1;\\ wow64;\\ trident\\/7.0;\\ rv\\:11.0\\)\\ like\\ gecko\" and ((http.request.method:\"get\" and url.original:\"\\/s\\/ref\\=nb_sb_noss_1\\/167\\-3294888\\-0262949\\/field\\-keywords\\=books\" and (destination.domain:\"www.amazon.com\" or url.domain:\"www.amazon.com\") and http.cookie:*\\=csm\\-hit\\=s\\-24ku11bb82rzsygj3bdk|1419899012996) or (http.request.method:\"post\" and url.original:\"\\/n4215\\/adj\\/amzn.us.sr.aps\" and (destination.domain:\"www.amazon.com\" or url.domain:\"www.amazon.com\"))))
<li><a href="#">query: (user_agent.original:\"mozilla\\/5.0\\ \\(windows\\ nt\\ 6.1;\\ wow64;\\ trident\\/7.0;\\ rv\\:11.0\\)\\ like\\ gecko\" and cs-uri:(\"\\/admin\\/get.php\" or \"\\/news.php\" or \"\\/login\\/process.php\") and http.request.method:\"post\")
<li><a href="#">query: (user_agent.original:\"mozilla\\/5.0\\ \\(windows\\ nt\\ 6.1;\\ wow64\\)\\ applewebkit\\/537.36\\ \\(khtml,\\ like\\ gecko\\)\\ chrome\\/36.0.1985.143\\ safari\\/537.36\" and (destination.domain:\"api.dropbox.com\" or url.domain:\"api.dropbox.com\"))
<li><a href="#">query: (user_agent.original:microsoft\\ bits\\/* and (not ((destination.domain:(*.com or *.net or *.org or *.scdn.co or *.sfx.ms) or url.domain:(*.com or *.net or *.org or *.scdn.co or *.sfx.ms)))))
<li><a href="#">query: (user_agent.original:microsoft\\ bits\\/* and (url.domain:(*1 or *2 or *3 or *4 or *5 or *6 or *7 or *8 or *9) or destination.domain:(*1 or *2 or *3 or *4 or *5 or *6 or *7 or *8 or *9)))
<li><a href="#">query: (user_agent.original:microsoft\\-webdav\\-miniredir\\/* and http.request.method:\"get\")
<li><a href="#">query: (useridentity.type:\"assumedrole\" and useridentity.sessioncontext.sessionissuer.type:\"role\")
<li><a href="#">query: (useridentity.type:\"root\" and (not (eventtype:\"awsserviceevent\")))
<li><a href="#">query: (winlog.channel:\"application\" and ((provider_name:\"application\\ error\" and winlog.event_id:\"1000\") or (provider_name:\"windows\\ error\\ reporting\" and winlog.event_id:\"1001\")) and (*msmpeng.exe* and *mpengine.dll*))
<li><a href="#">query: (winlog.channel:\"application\" and (*htool\\-* or *hacktool* or *asp\\/backdoor* or *jsp\\/backdoor* or *php\\/backdoor* or *backdoor.asp* or *backdoor.jsp* or *backdoor.php* or *webshell* or *portscan* or *mimikatz* or *.wincred.* or *plugx* or *korplug* or *pwdump* or *chopper* or *wmiexec* or *xscan* or *clearlog* or *aspxspy* or *ransom* or *filecoder* or *cobaltstrike*) and (not ((*keygen* or *crack* or *anti_ransomware_service.exe* or *cyber\\-protect\\-service.exe*) or (level:\"4\"))))
<li><a href="#">query: (winlog.channel:\"application\" and (provider_name:\"msiinstaller\" and winlog.event_id:(\"1040\" or \"1042\") and data:(*\\\\users\\\\public\\\\* or *\\\\perflogs\\\\* or *\\\\desktop\\\\* or *c\\:\\\\windows\\\\temp\\\\* or *\\\\\\\\\\*)) and (not ((data:*\\\\appdata\\\\local\\\\temp\\\\winget\\\\*) or (data:*c\\:\\\\windows\\\\temp\\\\updhealthtools.msi*))))
<li><a href="#">query: (winlog.channel:\"application\" and (winlog.event_id:\"1033\" and provider_name:\"msiinstaller\") and \"test\\ pkg\")
<li><a href="#">query: (winlog.channel:\"application\" and (winlog.event_id:\"4\" and provider_name:\"msexchange\\ control\\ panel\" and level:\"error\") and \"&__viewstate\\=\")
<li><a href="#">query: (winlog.channel:\"application\" and provider_name:(\"microsoft\\-windows\\-audit\\-cve\" or \"audit\\-cve\") and winlog.event_id:\"1\")
<li><a href="#">query: (winlog.channel:\"application\" and provider_name:\"microsoft-windows-softwarerestrictionpolicies\" and winlog.event_id:(\"865\" or \"866\" or \"867\" or \"868\" or \"882\"))
<li><a href="#">query: (winlog.channel:\"application\" and provider_name:\"msiinstaller\" and winlog.event_id:(\"1040\" or \"1042\") and data:*\\:\\/\\/*)
<li><a href="#">query: (winlog.channel:\"application\" and provider_name:\"msiinstaller\" and winlog.event_id:(\"11724\" or \"1034\"))
<li><a href="#">query: (winlog.channel:\"application\" and provider_name:\"mssqlserver\" and winlog.event_id:\"15457\" and data:*xp_cmdshell*)
<li><a href="#">query: (winlog.channel:\"application\" and provider_name:\"mssqlserver\" and winlog.event_id:\"33205\" and data:(*statement\\:alter\\ server\\ audit* or *statement\\:drop\\ server\\ audit*))
<li><a href="#">query: (winlog.channel:\"application\" and provider_name:\"mssqlserver\" and winlog.event_id:\"33205\" and data:*object_name\\:sp_procoption* and data:*statement\\:exec*)
<li><a href="#">query: (winlog.channel:\"application\" and provider_name:\"mssqlserver\" and winlog.event_id:\"33205\" and data:*object_name\\:sysadmin* and data:*statement\\:alter\\ server\\ role\\ \\[sysadmin\\]\\ add\\ member\\ *)
<li><a href="#">query: (winlog.channel:\"application\" and provider_name:\"mssqlserver\" and winlog.event_id:\"33205\" and data:*object_name\\:xp_cmdshell* and data:*statement\\:exec*)
<li><a href="#">query: (winlog.channel:\"application\" and winlog.event_id:\"1033\" and provider_name:\"msiinstaller\" and message:*ateraagent*)
<li><a href="#">query: (winlog.channel:\"application\" and winlog.event_id:\"1511\" and provider_name:\"microsoft\\-windows\\-user\\ profiles\\ service\")
<li><a href="#">query: (winlog.channel:\"application\" and winlog.event_id:\"524\" and provider_name:\"microsoft\\-windows\\-backup\")
<li><a href="#">query: (winlog.channel:\"dns\\ server\" and winlog.event_id:(\"150\" or \"770\"))
<li><a href="#">query: (winlog.channel:\"dns\\ server\" and winlog.event_id:\"257\" and qname:(\"asyspy256.ddns.net\" or \"hotkillmail9sddcc.ddns.net\" or \"rosaf112.ddns.net\" or \"cvdfhjh1231.myftp.biz\" or \"sz2016rose.ddns.net\" or \"dffwescwer4325.myftp.biz\" or \"cvdfhjh1231.ddns.net\"))
<li><a href="#">query: (winlog.channel:\"microsoft\\-windows\\-sysmon\\/operational\" and ((winlog.event_id:\"11\" and process.executable.text:\"system\" and file.path.text:*\\\\internet\\ explorer\\\\iertutil.dll) or (winlog.event_id:\"7\" and process.executable.text:*\\\\internet\\ explorer\\\\iexplore.exe and winlog.event_data.imageloaded:*\\\\internet\\ explorer\\\\iertutil.dll)))
<li><a href="#">query: (winlog.channel:\"microsoft\\-windows\\-sysmon\\/operational\" and winlog.event_id:(\"8\" or \"10\") and process.executable:(*\\\\powershell.exe or *\\\\pwsh.exe) and winlog.event_data.targetimage:*\\\\lsass.exe)
<li><a href="#">query: (winlog.channel:\"microsoft\\-windows\\-sysmon\\/operational\" and winlog.event_id:\"16\")
<li><a href="#">query: (winlog.channel:\"microsoft\\-windows\\-windows\\ defender\\/operational\" and (winlog.event_id:\"1121\" and winlog.event_data.path:*\\\\lsass.exe) and (not ((process.executable:c\\:\\\\windows\\\\temp\\\\asgard2\\-agent\\\\* and process.executable:(*\\\\thor64.exe or *\\\\thor.exe)) or (process.executable:(\"c\\:\\\\windows\\\\system32\\\\atiesrxx.exe\" or \"c\\:\\\\windows\\\\system32\\\\compattelrunner.exe\" or \"c\\:\\\\windows\\\\system32\\\\msiexec.exe\" or \"c\\:\\\\windows\\\\system32\\\\nvwmi64.exe\" or \"c\\:\\\\windows\\\\system32\\\\svchost.exe\" or \"c\\:\\\\windows\\\\system32\\\\taskmgr.exe\" or \"c\\:\\\\windows\\\\system32\\\\wbem\\\\wmiprvse.exe\" or \"c\\:\\\\windows\\\\syswow64\\\\msiexec.exe\")) or (process.executable:(c\\:\\\\windows\\\\system32\\\\driverstore\\\\* or c\\:\\\\windows\\\\installer\\\\* or c\\:\\\\program\\ files\\\\* or c\\:\\\\program\\ files\\ \\(x86\\)\\\\*)))))
<li><a href="#">query: (winlog.channel:\"microsoft\\-windows\\-windows\\ defender\\/operational\" and winlog.event_id:(\"1006\" or \"1116\" or \"1015\" or \"1117\"))
<li><a href="#">query: (winlog.channel:\"microsoft\\-windows\\-windows\\ defender\\/operational\" and winlog.event_id:(\"5001\" or \"5010\" or \"5012\" or \"5101\"))
<li><a href="#">query: (winlog.channel:\"microsoft\\-windows\\-windows\\ defender\\/operational\" and winlog.event_id:\"1013\" and winlog.event_data.eventtype:\"4\")
<li><a href="#">query: (winlog.channel:\"microsoft\\-windows\\-windows\\ defender\\/operational\" and winlog.event_id:\"1116\" and source_name:\"amsi\")
<li><a href="#">query: (winlog.channel:\"microsoft\\-windows\\-windows\\ defender\\/operational\" and winlog.event_id:\"1121\" and process.executable:(*\\\\wmiprvse.exe or *\\\\psexesvc.exe))
<li><a href="#">query: (winlog.channel:\"microsoft\\-windows\\-windows\\ defender\\/operational\" and winlog.event_id:\"5007\" and ((newvalue:*\\\\software\\\\microsoft\\\\windows\\ defender\\\\windows\\ defender\\ exploit\\ guard\\\\controlled\\ folder\\ access\\\\allowedapplications\\\\* and newvalue:(*\\\\users\\\\public\\\\* or *\\\\appdata\\\\local\\\\temp\\\\* or *\\\\desktop\\\\* or *\\\\perflogs\\\\* or *\\\\windows\\\\temp\\\\*)) or oldvalue:*\\\\software\\\\microsoft\\\\windows\\ defender\\\\windows\\ defender\\ exploit\\ guard\\\\controlled\\ folder\\ access\\\\protectedfolders\\\\*))
<li><a href="#">query: (winlog.channel:\"microsoft\\-windows\\-windows\\ defender\\/operational\" and winlog.event_id:\"5007\" and newvalue:*\\\\microsoft\\\\windows\\ defender\\\\exclusions*)
<li><a href="#">query: (winlog.channel:\"microsoft\\-windows\\-windows\\ defender\\/operational\" and winlog.event_id:\"5013\" and value:(*\\\\windows\\ defender\\\\disableantispyware\\ \\=\\ 0x1\\(\\) or *\\\\real\\-time\\ protection\\\\disablerealtimemonitoring\\ \\=\\ \\(current\\)))
<li><a href="#">query: (winlog.channel:\"security\" and (((winlog.event_data.samaccountname:samtheadmin\\-* and winlog.event_data.samaccountname:*$)) or ((winlog.event_data.targetusername:samtheadmin\\-* and winlog.event_data.targetusername:*$))))
<li><a href="#">query: (winlog.channel:\"security\" and ((provider_name:\"microsoft\\-windows\\-security\\-auditing\" and winlog.event_id:\"4732\") and (winlog.event_data.targetusername:administr* or winlog.event_data.targetsid:\"s\\-1\\-5\\-32\\-544\")) and (not (winlog.event_data.subjectusername:*$)))
<li><a href="#">query: (winlog.channel:\"security\" and ((winlog.event_id:(\"4625\" or \"4624\") and winlog.event_data.logontype:\"3\" and winlog.event_data.authenticationpackagename:\"ntlm\" and source.domain:/^[a-za-z0-9]{16}$/) or (not _exists_:winlog.event_data.processname and winlog.event_id:\"4776\" and workstation:/^[a-za-z0-9]{16}$/)))
<li><a href="#">query: (winlog.channel:\"security\" and ((winlog.event_id:\"4661\" and winlog.event_data.objecttype:(\"sam_user\" or \"sam_group\")) and (winlog.event_data.objectname:(*\\-512 or *\\-502 or *\\-500 or *\\-505 or *\\-519 or *\\-520 or *\\-544 or *\\-551 or *\\-555) or winlog.event_data.objectname:*admin*)) and (not (winlog.event_data.subjectusername:*$)))
<li><a href="#">query: (winlog.channel:\"security\" and ((winlog.event_id:\"4738\" and (not (winlog.event_data.allowedtodelegateto:\"\\-\" or not _exists_:winlog.event_data.allowedtodelegateto))) or (winlog.event_id:\"5136\" and (winlog.event_data.attributeldapdisplayname:\"msds\\-allowedtodelegateto\" or (winlog.event_data.objectclass:\"user\" and winlog.event_data.attributeldapdisplayname:\"serviceprincipalname\") or winlog.event_data.attributeldapdisplayname:\"msds\\-allowedtoactonbehalfofotheridentity\"))))
<li><a href="#">query: (winlog.channel:\"security\" and ((winlog.event_id:\"4742\" and winlog.event_data.serviceprincipalnames:*gc\\/*) or (winlog.event_id:\"5136\" and winlog.event_data.attributeldapdisplayname:\"serviceprincipalname\" and winlog.event_data.attributevalue:gc\\/*)))
<li><a href="#">query: (winlog.channel:\"security\" and ((winlog.event_id:\"4776\" and workstation:\"ruler\") or (winlog.event_id:(\"4624\" or \"4625\") and source.domain:\"ruler\")))
<li><a href="#">query: (winlog.channel:\"security\" and ((winlog.event_id:\"4898\" and templatecontent:(*1.3.6.1.5.5.7.3.2* or *1.3.6.1.5.2.3.4* or *1.3.6.1.4.1.311.20.2.2* or *2.5.29.37.0*) and templatecontent:*ct_flag_enrollee_supplies_subject*) or (winlog.event_id:\"4899\" and newtemplatecontent:(*1.3.6.1.5.5.7.3.2* or *1.3.6.1.5.2.3.4* or *1.3.6.1.4.1.311.20.2.2* or *2.5.29.37.0*) and newtemplatecontent:*ct_flag_enrollee_supplies_subject*)))
<li><a href="#">query: (winlog.channel:\"security\" and ((winlog.event_id:\"4898\" and templatecontent:*ct_flag_enrollee_supplies_subject*) or (winlog.event_id:\"4899\" and newtemplatecontent:*ct_flag_enrollee_supplies_subject*)))
<li><a href="#">query: (winlog.channel:\"security\" and ((winlog.event_id:\"517\" and provider_name:\"security\") or (winlog.event_id:\"1102\" and provider_name:\"microsoft\\-windows\\-eventlog\")))
<li><a href="#">query: (winlog.channel:\"security\" and ((winlog.event_id:\"6416\" and classname:\"diskdrive\") or devicedescription:\"usb\\ mass\\ storage\\ device\"))
<li><a href="#">query: (winlog.channel:\"security\" and (provider_name:\"microsoft\\-windows\\-security\\-auditing\" and winlog.event_id:\"4673\" and winlog.event_data.privilegelist:\"seloaddriverprivilege\" and service:\"\\-\") and (not (winlog.event_data.processname:(*\\\\windows\\\\system32\\\\dism.exe or *\\\\windows\\\\system32\\\\rundll32.exe or *\\\\windows\\\\system32\\\\fltmc.exe or *\\\\windows\\\\helppane.exe or *\\\\windows\\\\system32\\\\mmc.exe or *\\\\windows\\\\system32\\\\svchost.exe or *\\\\windows\\\\system32\\\\wimserv.exe or *\\\\procexp64.exe or *\\\\procexp.exe or *\\\\procmon64.exe or *\\\\procmon.exe or *\\\\google\\\\chrome\\\\application\\\\chrome.exe))))
<li><a href="#">query: (winlog.channel:\"security\" and (provider_name:\"microsoft\\-windows\\-security\\-auditing\" and winlog.event_id:\"5145\" and winlog.event_data.relativetargetname:*\\\\wbem\\\\wbemcomn.dll) and (not (winlog.event_data.subjectusername:*$)))
<li><a href="#">query: (winlog.channel:\"security\" and (provider_name:\"microsoft-windows-security-auditing\" and winlog.event_id:\"4673\" and winlog.event_data.privilegelist:\"seloaddriverprivilege\" and service:\"-\") and (not ((winlog.event_data.processname:(\"c:\\windows\\system32\\dism.exe\" or \"c:\\windows\\system32\\rundll32.exe\" or \"c:\\windows\\system32\\fltmc.exe\" or \"c:\\windows\\helppane.exe\" or \"c:\\windows\\system32\\mmc.exe\" or \"c:\\windows\\system32\\svchost.exe\" or \"c:\\windows\\system32\\wimserv.exe\" or \"c:\\windows\\system32\\runtimebroker.exe\" or \"c:\\windows\\system32\\systemsettingsbroker.exe\")) or (winlog.event_data.processname:(*\\\\procexp64.exe or *\\\\procexp.exe or *\\\\procmon64.exe or *\\\\procmon.exe or *\\\\google\\\\chrome\\\\application\\\\chrome.exe)))))
<li><a href="#">query: (winlog.channel:\"security\" and (winlog.event_data.objectname:*\\\\lsass.exe and ((winlog.event_id:\"4656\" and winlog.event_data.accessmask:(*0x40* or *0x1400* or *0x100000* or *0x1410* or *0x1010* or *0x1438* or *0x143a* or *0x1418* or *0x1f0fff* or *0x1f1fff* or *0x1f2fff* or *0x1f3fff*)) or (winlog.event_id:\"4663\" and winlog.event_data.accesslist:(*4484* or *4416*)))) and (not ((winlog.event_data.processname:(*\\\\wmiprvse.exe or *\\\\taskmgr.exe or *\\\\procexp64.exe or *\\\\procexp.exe or *\\\\lsm.exe or *\\\\csrss.exe or *\\\\wininit.exe or *\\\\vmtoolsd.exe or *\\\\minionhost.exe or *\\\\vstskmgr.exe or *\\\\thor.exe or *\\\\thor64.exe or *\\\\microsoftedgeupdate.exe or *\\\\gamingservices.exe or *\\\\svchost.exe or *\\\\msmpeng.exe or *\\\\mrt.exe or *rtkauduservice64) and winlog.event_data.processname:(c\\:\\\\windows\\\\system32\\\\* or c\\:\\\\windows\\\\syswow64\\\\* or c\\:\\\\windows\\\\sysnative\\\\* or c\\:\\\\program\\ files\\\\* or c\\:\\\\program\\ files\\ \\(x86\\)\\\\* or c\\:\\\\windows\\\\temp\\\\asgard2\\-agent\\\\* or c\\:\\\\programdata\\\\microsoft\\\\windows\\ defender\\\\platform\\\\*)) or (winlog.event_data.processname:c\\:\\\\program\\ files*) or (winlog.event_data.processname:\"c\\:\\\\windows\\\\ccm\\\\ccmexec.exe\") or (winlog.event_data.processname:\"c\\:\\\\windows\\\\system32\\\\taskhostw.exe\"))))
<li><a href="#">query: (winlog.channel:\"security\" and (winlog.event_id:(\"4624\" or \"4625\") and winlog.event_data.logontype:\"3\" and winlog.event_data.logonprocessname:\"ntlmssp\" and source.domain:\"%workstations%\" and winlog.computername:\"%workstations%\") and (not (winlog.event_data.targetusername:\"anonymous\\ logon\")))
<li><a href="#">query: (winlog.channel:\"security\" and (winlog.event_id:(\"4625\" or \"4776\") and winlog.event_data.status:(\"0xc0000072\" or \"0xc000006f\" or \"0xc0000070\" or \"0xc0000413\" or \"0xc000018c\" or \"0xc000015b\")) and (not (winlog.event_data.subjectusersid:\"s\\-1\\-0\\-0\")))
<li><a href="#">query: (winlog.channel:\"security\" and (winlog.event_id:(\"4656\" or \"4663\") and winlog.event_data.objecttype:\"key\" and winlog.event_data.objectname:\"\\\\registry\\\\machine\\\\software\\\\microsoft\\\\adhealthagent\") and (not (winlog.event_data.processname:(*microsoft.identity.health.adfs.diagnosticsagent.exe* or *microsoft.identity.health.adfs.insightsservice.exe* or *microsoft.identity.health.adfs.monitoringagent.startup.exe* or *microsoft.identity.health.adfs.pshsurrogate.exe* or *microsoft.identity.health.common.clients.resourcemonitor.exe*))))
<li><a href="#">query: (winlog.channel:\"security\" and (winlog.event_id:(\"4656\" or \"4663\") and winlog.event_data.objecttype:\"key\" and winlog.event_data.objectname:\"\\\\registry\\\\machine\\\\software\\\\microsoft\\\\microsoft\\ online\\\\reporting\\\\monitoringagent\") and (not (winlog.event_data.processname:(*microsoft.identity.health.adfs.diagnosticsagent.exe* or *microsoft.identity.health.adfs.insightsservice.exe* or *microsoft.identity.health.adfs.monitoringagent.startup.exe* or *microsoft.identity.health.adfs.pshsurrogate.exe* or *microsoft.identity.health.common.clients.resourcemonitor.exe*))))
<li><a href="#">query: (winlog.channel:\"security\" and (winlog.event_id:(\"4663\" or \"4656\") and winlog.event_data.accessmask:(\"0x40\" or \"0x1400\" or \"0x100000\" or \"0x1410\" or \"0x1010\" or \"0x1438\" or \"0x143a\" or \"0x1418\" or \"0x1f0fff\" or \"0x1f1fff\" or \"0x1f2fff\" or \"0x1f3fff\" or \"40\" or \"1400\" or \"1000\" or \"100000\" or \"1410\" or \"1010\" or \"1438\" or \"143a\" or \"1418\" or \"1f0fff\" or \"1f1fff\" or \"1f2fff\" or \"1f3fff\") and winlog.event_data.objecttype:\"process\" and winlog.event_data.objectname:*\\\\lsass.exe) and (not ((winlog.event_data.subjectusername:*$) or (winlog.event_data.processname:c\\:\\\\program\\ files*) or (winlog.event_data.processname:\"c\\:\\\\windows\\\\system32\\\\wbem\\\\wmiprvse.exe\" and winlog.event_data.accessmask:\"0x1410\"))))
<li><a href="#">query: (winlog.channel:\"security\" and (winlog.event_id:(\"4765\" or \"4766\") or ((winlog.event_id:\"4738\" and (not (winlog.event_data.sidhistory:(\"\\-\" or \"%%1793\")))) and (not (not _exists_:winlog.event_data.sidhistory)))))
<li><a href="#">query: (winlog.channel:\"security\" and (winlog.event_id:(\"528\" or \"529\" or \"4624\" or \"4625\") and winlog.event_data.logontype:\"2\" and winlog.computername:(\"%serversystems%\" or \"%domaincontrollers%\")) and (not (winlog.event_data.logonprocessname:\"advapi\" and winlog.computername:\"%workstations%\")))
<li><a href="#">query: (winlog.channel:\"security\" and (winlog.event_id:\"4624\" and ((winlog.event_data.subjectusersid:\"s\\-1\\-0\\-0\" and winlog.event_data.logontype:\"3\" and winlog.event_data.logonprocessname:\"ntlmssp\" and winlog.event_data.keylength:\"0\") or (winlog.event_data.logontype:\"9\" and winlog.event_data.logonprocessname:\"seclogo\"))) and (not (winlog.event_data.targetusername:\"anonymous\\ logon\")))
<li><a href="#">query: (winlog.channel:\"security\" and (winlog.event_id:\"4624\" and winlog.event_data.logontype:\"3\" and winlog.event_data.processname:*scrcons.exe) and (not (targetlogonid:\"0x3e7\")))
<li><a href="#">query: (winlog.channel:\"security\" and (winlog.event_id:\"4648\" and winlog.event_data.processname:(*\\\\cmd.exe or *\\\\powershell.exe or *\\\\pwsh.exe or *\\\\winrs.exe or *\\\\wmic.exe or *\\\\net.exe or *\\\\net1.exe or *\\\\reg.exe)) and (not ((targetservername:\"localhost\") or (winlog.event_data.subjectusername:*$ and winlog.event_data.targetusername:*$))))
<li><a href="#">query: (winlog.channel:\"security\" and (winlog.event_id:\"4656\" and winlog.event_data.objecttype:\"sc_manager\\ object\" and winlog.event_data.objectname:\"servicesactive\" and winlog.event_data.accessmask:\"0xf003f\") and (not (subjectlogonid:\"0x3e4\")))
<li><a href="#">query: (winlog.channel:\"security\" and (winlog.event_id:\"4662\" and winlog.event_data.accessmask:\"0x100\" and winlog.event_data.properties:(*1131f6aa\\-9c07\\-11d1\\-f79f\\-00c04fc2dcd2* or *1131f6ad\\-9c07\\-11d1\\-f79f\\-00c04fc2dcd2* or *89e95b76\\-444d\\-4c62\\-991a\\-0facbeda640c*)) and (not (winlog.event_data.subjectusername:*$ or winlog.event_data.subjectusername:msol_*)))
<li><a href="#">query: (winlog.channel:\"security\" and (winlog.event_id:\"4662\" and winlog.event_data.objecttype:*bf967aba\\-0de6\\-11d0\\-a285\\-00aa003049e2*) and (not (winlog.event_data.subjectusername:*$ or winlog.event_data.subjectusername:msol_*)))
<li><a href="#">query: (winlog.channel:\"security\" and (winlog.event_id:\"4662\" and winlog.event_data.properties:(*replicating\\ directory\\ changes\\ all* or *1131f6ad\\-9c07\\-11d1\\-f79f\\-00c04fc2dcd2* or *1131f6aa\\-9c07\\-11d1\\-f79f\\-00c04fc2dcd2* or *9923a32a\\-3607\\-11d2\\-b9be\\-0000f87a36b2* or *89e95b76\\-444d\\-4c62\\-991a\\-0facbeda640c*) and winlog.event_data.accessmask:\"0x100\") and (not ((winlog.event_data.subjectdomainname:\"window\\ manager\") or (winlog.event_data.subjectusername:(nt\\ aut* or msol_*)) or (winlog.event_data.subjectusername:*$))))
<li><a href="#">query: (winlog.channel:\"security\" and (winlog.event_id:\"4663\" and winlog.event_data.objectname:(*\\\\microsoft\\\\teams\\\\cookies* or *\\\\microsoft\\\\teams\\\\local\\ storage\\\\leveldb*)) and (not (winlog.event_data.processname:*\\\\microsoft\\\\teams\\\\current\\\\teams.exe*)))
<li><a href="#">query: (winlog.channel:\"security\" and (winlog.event_id:\"4663\" and winlog.event_data.objectserver:\"security\" and winlog.event_data.objecttype:\"file\" and winlog.event_data.objectname:\\\\device\\\\cdrom*) and (not (winlog.event_data.objectname:\"\\\\device\\\\cdrom0\\\\setup.exe\")))
<li><a href="#">query: (winlog.channel:\"security\" and (winlog.event_id:\"4674\" and winlog.event_data.objecttype:\"sc_manager\\ object\" and winlog.event_data.objectname:\"servicesactive\" and winlog.event_data.privilegelist:\"setakeownershipprivilege\") and (not (subjectlogonid:\"0x3e4\" and winlog.event_data.processname:*\\:\\\\windows\\\\system32\\\\services.exe)))
<li><a href="#">query: (winlog.channel:\"security\" and (winlog.event_id:\"4697\" and winlog.event_data.servicefilename:/^%systemroot%\\\\[a-za-z]{8}\\.exe$/ and winlog.event_data.servicename:/(^[a-za-z]{4}$)|(^[a-za-z]{8}$)|(^[a-za-z]{16}$)/ and servicestarttype:\"3\" and winlog.event_data.servicetype:\"0x10\") and (not (winlog.event_data.servicename:\"psexesvc\")))
<li><a href="#">query: (winlog.channel:\"security\" and (winlog.event_id:\"4742\" and winlog.event_data.subjectusername:\"anonymous\\ logon\" and winlog.event_data.targetusername:\"%dc\\-machine\\-name%\") and (not (winlog.event_data.passwordlastset:\"\\-\")))
<li><a href="#">query: (winlog.channel:\"security\" and (winlog.event_id:\"4768\" and winlog.event_data.targetusername:*$ and winlog.event_data.certthumbprint:*) and (not ((source.ip:\"\\:\\:1\") or (winlog.event_data.certthumbprint:\"\"))))
<li><a href="#">query: (winlog.channel:\"security\" and (winlog.event_id:\"4769\" and winlog.event_data.ticketoptions:\"0x40810000\" and winlog.event_data.ticketencryptiontype:\"0x17\") and (not (winlog.event_data.servicename:*$)))
<li><a href="#">query: (winlog.channel:\"security\" and (winlog.event_id:\"4781\" and oldtargetusername:*$*) and (not (newtargetusername:*$*)))
<li><a href="#">query: (winlog.channel:\"security\" and (winlog.event_id:\"5136\" and winlog.event_data.attributeldapdisplayname:\"ntsecuritydescriptor\" and winlog.event_data.attributevalue:(*1131f6ad\\-9c07\\-11d1\\-f79f\\-00c04fc2dcd2* or *1131f6aa\\-9c07\\-11d1\\-f79f\\-00c04fc2dcd2* or *89e95b76\\-444d\\-4c62\\-991a\\-0facbeda640c*)) and (not ((winlog.event_data.objectclass:(\"dnsnode\" or \"dnszonescope\" or \"dnszone\")))))
<li><a href="#">query: (winlog.channel:\"security\" and (winlog.event_id:\"5140\" and winlog.event_data.sharename:\"admin$\") and (not (winlog.event_data.subjectusername:*$)))
<li><a href="#">query: (winlog.channel:\"security\" and (winlog.event_id:\"5145\" and winlog.event_data.relativetargetname:*\\\\internet\\ explorer\\\\iertutil.dll) and (not (winlog.event_data.subjectusername:*$)))
<li><a href="#">query: (winlog.channel:\"security\" and (winlog.event_id:\"5145\" and winlog.event_data.relativetargetname:*\\\\winreg*) and (not (source.ip:\"%admins_workstations%\")))
<li><a href="#">query: (winlog.channel:\"security\" and (winlog.event_id:\"5145\" and winlog.event_data.sharename:*c$ and winlog.event_data.accessmask:\"0x2\") and (not (winlog.event_data.subjectusername:*$)))
<li><a href="#">query: (winlog.channel:\"security\" and (winlog.event_id:\"5145\" and winlog.event_data.sharename:\\\\\\*\\\\ipc$) and (not (winlog.event_data.relativetargetname:(\"atsvc\" or \"samr\" or \"lsarpc\" or \"lsass\" or \"winreg\" or \"netlogon\" or \"srvsvc\" or \"protected_storage\" or \"wkssvc\" or \"browser\" or \"netdfs\" or \"svcctl\" or \"spoolss\" or \"ntsvcs\" or \"lsm_api_service\" or \"hydralspipe\" or \"termsrv_api_service\" or \"msftewds\" or \"sql\\\\query\"))))
<li><a href="#">query: (winlog.channel:\"security\" and (winlog.event_id:\"5145\" and winlog.event_data.sharename:\\\\\\\\\\*\\\\ipc$ and winlog.event_data.relativetargetname:(*\\-stdin or *\\-stdout or *\\-stderr)) and (not (winlog.event_data.relativetargetname:psexesvc*)))
<li><a href="#">query: (winlog.channel:\"security\" and (winlog.event_id:\"5156\" and ((source.port:\"3389\" and destaddress:(127.* or \"\\:\\:1\")) or (destport:\"3389\" and sourceaddress:(127.* or \"\\:\\:1\")))) and (not ((application:(*\\\\thor.exe or *\\\\thor64.exe)))))
<li><a href="#">query: (winlog.channel:\"security\" and (winlog.event_id:\"5156\" and destination.port:\"88\") and (not (process.executable:(*\\\\lsass.exe or *\\\\opera.exe or *\\\\chrome.exe or *\\\\firefox.exe))))
<li><a href="#">query: (winlog.channel:\"security\" and (winlog.event_id:\"5156\" and destport:\"88\") and (not (application:(*\\\\lsass.exe or *\\\\opera.exe or *\\\\chrome.exe or *\\\\firefox.exe))))
<li><a href="#">query: (winlog.channel:\"security\" and process.command_line:*.settingcontent\\-ms* and (not (filepath:*immersivecontrolpanel*)))
<li><a href="#">query: (winlog.channel:\"security\" and process.command_line:*appvlp.exe* and process.command_line:(*cmd.exe* or *powershell.exe*) and process.command_line:(*.sh* or *.exe* or *.dll* or *.bin* or *.bat* or *.cmd* or *.js* or *.msh* or *.reg* or *.scr* or *.ps* or *.vb* or *.jar* or *.pl* or *.inf*))
<li><a href="#">query: (winlog.channel:\"security\" and provider_name:\"microsoft\\-windows\\-security\\-auditing\" and auditsourcename:\"vssaudit\" and winlog.event_id:(\"4904\" or \"4905\"))
<li><a href="#">query: (winlog.channel:\"security\" and provider_name:\"microsoft\\-windows\\-security\\-auditing\" and winlog.event_id:\"4673\" and service:\"lsaregisterlogonprocess\\(\\)\" and keywords:\"0x8010000000000000\")
<li><a href="#">query: (winlog.channel:\"security\" and provider_name:\"microsoft\\-windows\\-security\\-auditing\" and winlog.event_id:\"4697\" and winlog.event_data.servicefilename:*cmd* and winlog.event_data.servicefilename:*\\&&* and winlog.event_data.servicefilename:*clipboard\\]\\:\\:*)
<li><a href="#">query: (winlog.channel:\"security\" and provider_name:\"microsoft\\-windows\\-security\\-auditing\" and winlog.event_id:\"4720\")
<li><a href="#">query: (winlog.channel:\"security\" and provider_name:\"microsoft\\-windows\\-security\\-auditing\" and winlog.event_id:\"5145\" and winlog.event_data.relativetargetname:(*\\\\mimidrv* or *\\\\lsass* or *\\\\windows\\\\minidump\\\\* or *\\\\hiberfil* or *\\\\sqldmpr* or *\\\\sam* or *\\\\ntds.dit* or *\\\\security*))
<li><a href="#">query: (winlog.channel:\"security\" and winlog.event_data.objectname:(*winevt\\\\publishers\\\\\\{5770385f\\-c22a\\-43e0\\-bf4c\\-06f5698ffbd9\\}* or *winevt\\\\channels\\\\microsoft\\-windows\\-sysmon\\/operational*) and ((winlog.event_id:\"4657\" and winlog.event_data.objectvaluename:\"enabled\" and newvalue:\"0\") or (winlog.event_id:\"4663\" and winlog.event_data.accessmask:\"65536\")))
<li><a href="#">query: (winlog.channel:\"security\" and winlog.event_id:(\"4634\" or \"4647\"))
<li><a href="#">query: (winlog.channel:\"security\" and winlog.event_id:(\"4656\" or \"4658\" or \"4660\" or \"4663\") and winlog.event_data.objectname:*\\\\wceaux.dll)
<li><a href="#">query: (winlog.channel:\"security\" and winlog.event_id:(\"4656\" or \"4663\" or \"4658\") and winlog.event_data.objectname:(*.aaa or *.zzz))
<li><a href="#">query: (winlog.channel:\"security\" and winlog.event_id:(\"4656\" or \"4663\") and winlog.event_data.objecttype:\"key\" and winlog.event_data.objectname:(*lsa\\\\jd or *lsa\\\\gbg or *lsa\\\\skew1 or *lsa\\\\data))
<li><a href="#">query: (winlog.channel:\"security\" and winlog.event_id:(\"4657\" or \"4656\" or \"4660\" or \"4663\") and winlog.event_data.objectname:*\\\\microsoft\\\\windows\\ defender\\\\exclusions\\\\*)
<li><a href="#">query: (winlog.channel:\"security\" and winlog.event_id:(\"4657\" or \"4656\" or \"4663\") and winlog.event_data.objectname:(*\\\\software\\\\microsoft\\\\windows\\\\currentversion\\\\capabilityaccessmanager\\\\consentstore\\\\microphone\\\\nonpackaged* or *\\\\software\\\\microsoft\\\\windows\\\\currentversion\\\\capabilityaccessmanager\\\\consentstore\\\\webcam\\\\nonpackaged*))
<li><a href="#">query: (winlog.channel:\"security\" and winlog.event_id:(\"4672\" or \"4964\"))
<li><a href="#">query: (winlog.channel:\"security\" and winlog.event_id:(\"4720\" or \"4781\") and winlog.event_data.samaccountname:*$*)
<li><a href="#">query: (winlog.channel:\"security\" and winlog.event_id:(\"4728\" or \"4729\" or \"4730\" or \"633\" or \"632\" or \"634\"))
<li><a href="#">query: (winlog.channel:\"security\" and winlog.event_id:(\"4741\" or \"4743\"))
<li><a href="#">query: (winlog.channel:\"security\" and winlog.event_id:(\"5038\" or \"6281\"))
<li><a href="#">query: (winlog.channel:\"security\" and winlog.event_id:(\"675\" or \"4768\" or \"4769\" or \"4771\") and winlog.event_data.failurecode:(\"0x9\" or \"0xa\" or \"0xb\" or \"0xf\" or \"0x10\" or \"0x11\" or \"0x13\" or \"0x14\" or \"0x1a\" or \"0x1f\" or \"0x21\" or \"0x22\" or \"0x23\" or \"0x24\" or \"0x26\" or \"0x27\" or \"0x28\" or \"0x29\" or \"0x2c\" or \"0x2d\" or \"0x2e\" or \"0x2f\" or \"0x31\" or \"0x32\" or \"0x3e\" or \"0x3f\" or \"0x40\" or \"0x41\" or \"0x43\" or \"0x44\"))
<li><a href="#">query: (winlog.channel:\"security\" and winlog.event_id:\"1102\" and provider_name:\"microsoft\\-windows\\-eventlog\")
<li><a href="#">query: (winlog.channel:\"security\" and winlog.event_id:\"4611\" and winlog.event_data.logonprocessname:\"user32logonprocesss\")
<li><a href="#">query: (winlog.channel:\"security\" and winlog.event_id:\"4616\" and (not ((winlog.event_data.processname:(\"c\\:\\\\program\\ files\\\\vmware\\\\vmware\\ tools\\\\vmtoolsd.exe\" or \"c\\:\\\\windows\\\\system32\\\\vboxservice.exe\" or \"c\\:\\\\windows\\\\system32\\\\oobe\\\\msoobe.exe\")) or (winlog.event_data.processname:\"c\\:\\\\windows\\\\system32\\\\svchost.exe\" and winlog.event_data.subjectusersid:\"s\\-1\\-5\\-19\"))))
<li><a href="#">query: (winlog.channel:\"security\" and winlog.event_id:\"4624\" and winlog.event_data.logontype:\"10\" and source.ip:(\"\\:\\:1\" or \"127.0.0.1\"))
<li><a href="#">query: (winlog.channel:\"security\" and winlog.event_id:\"4624\" and winlog.event_data.logontype:\"10\" and winlog.event_data.authenticationpackagename:\"negotiate\" and winlog.event_data.targetusername:admin*)
<li><a href="#">query: (winlog.channel:\"security\" and winlog.event_id:\"4624\" and winlog.event_data.logontype:\"3\" and winlog.event_data.authenticationpackagename:\"kerberos\" and source.ip:\"127.0.0.1\" and winlog.event_data.targetusersid:s\\-1\\-5\\-21\\-* and winlog.event_data.targetusersid:*\\-500)
<li><a href="#">query: (winlog.channel:\"security\" and winlog.event_id:\"4624\" and winlog.event_data.logontype:\"3\" and winlog.event_data.targetusername:\"anonymous logon\" and source.domain:\"-\" and source.ip:(\"127.0.0.1\" or \"::1\"))
<li><a href="#">query: (winlog.channel:\"security\" and winlog.event_id:\"4624\" and winlog.event_data.logontype:\"3\" and winlog.event_data.targetusername:\"anonymous_logon\" and source.domain:\"\\-\" and source.ip:\"127.0.0.1\")
<li><a href="#">query: (winlog.channel:\"security\" and winlog.event_id:\"4624\" and winlog.event_data.logontype:\"9\" and targetoutboundusername:\"thisisnotvaliduser\")
<li><a href="#">query: (winlog.channel:\"security\" and winlog.event_id:\"4624\" and winlog.event_data.logontype:\"9\" and winlog.event_data.logonprocessname:\"seclogo\" and winlog.event_data.authenticationpackagename:\"negotiate\")
<li><a href="#">query: (winlog.channel:\"security\" and winlog.event_id:\"4624\" and winlog.event_data.logontype:\"9\")
<li><a href="#">query: (winlog.channel:\"security\" and winlog.event_id:\"4624\" and winlog.event_data.processname:*\\\\wmiprvse.exe)
<li><a href="#">query: (winlog.channel:\"security\" and winlog.event_id:\"4625\" and (not ((source.ip:*\\-*) or (source.ip:(10.* or 192.168.* or 172.16.* or 172.17.* or 172.18.* or 172.19.* or 172.20.* or 172.21.* or 172.22.* or 172.23.* or 172.24.* or 172.25.* or 172.26.* or 172.27.* or 172.28.* or 172.29.* or 172.30.* or 172.31.* or 127.* or 169.254.*)) or (((source.ip:\"::1\") or (source.ip:(fe80\\:\\:* or fc00\\:\\:*)))))))
<li><a href="#">query: (winlog.channel:\"security\" and winlog.event_id:\"4625\" and (not ((source.ip:*\\-*) or (source.ip:(10.* or 192.168.* or 172.16.* or 172.17.* or 172.18.* or 172.19.* or 172.20.* or 172.21.* or 172.22.* or 172.23.* or 172.24.* or 172.25.* or 172.26.* or 172.27.* or 172.28.* or 172.29.* or 172.30.* or 172.31.* or 127.* or 169.254.*)) or (source.ip:\"\\:\\:1\" or source.ip:(fe80\\:\\:* or fc00\\:\\:*)))))
<li><a href="#">query: (winlog.channel:\"security\" and winlog.event_id:\"4625\" and winlog.event_data.targetusername:\"aaaaaaa\")
<li><a href="#">query: (winlog.channel:\"security\" and winlog.event_id:\"4649\")
<li><a href="#">query: (winlog.channel:\"security\" and winlog.event_id:\"4656\" and winlog.event_data.objecttype:\"key\" and winlog.event_data.objectname:*\\\\sam)
<li><a href="#">query: (winlog.channel:\"security\" and winlog.event_id:\"4656\" and winlog.event_data.processname:*\\\\lsass.exe and winlog.event_data.accessmask:\"0x705\" and winlog.event_data.objecttype:\"sam_domain\")
<li><a href="#">query: (winlog.channel:\"security\" and winlog.event_id:\"4657\" and newvalue:\"0\" and (((winlog.event_data.objectname:*\\\\software\\\\microsoft\\\\.netframework and winlog.event_data.objectvaluename:\"etwenabled\")) or ((winlog.event_data.objectname:*\\\\environment* and winlog.event_data.objectvaluename:(\"complus_etwenabled\" or \"complus_etwflags\")))))
<li><a href="#">query: (winlog.channel:\"security\" and winlog.event_id:\"4657\" and winlog.event_data.objectname:*\\\\registry\\\\machine\\\\system* and winlog.event_data.objectname:*controlset* and winlog.event_data.objectname:*\\\\control\\\\lsa* and winlog.event_data.objectvaluename:(\"lmcompatibilitylevel\" or \"ntlmminclientsec\" or \"restrictsendingntlmtraffic\"))
<li><a href="#">query: (winlog.channel:\"security\" and winlog.event_id:\"4657\" and winlog.event_data.objectname:*\\\\software\\\\microsoft\\\\.netframework and winlog.event_data.objectvaluename:\"etwenabled\" and newvalue:\"0\")
<li><a href="#">query: (winlog.channel:\"security\" and winlog.event_id:\"4661\" and winlog.event_data.accessmask:\"0x2d\" and winlog.event_data.objecttype:(\"sam_user\" or \"sam_group\") and winlog.event_data.objectname:s\\-1\\-5\\-21\\-* and winlog.event_data.objectname:(*\\-500 or *\\-512))
<li><a href="#">query: (winlog.channel:\"security\" and winlog.event_id:\"4662\" and winlog.event_data.objectserver:\"ds\" and winlog.event_data.accessmask:\"0x40000\" and winlog.event_data.objecttype:(\"19195a5b\\-6da0\\-11d0\\-afd3\\-00c04fd930c9\" or \"domaindns\"))
<li><a href="#">query: (winlog.channel:\"security\" and winlog.event_id:\"4662\" and winlog.event_data.objecttype:\"secretobject\" and winlog.event_data.accessmask:\"0x2\" and winlog.event_data.objectname:*bckupkey*)
<li><a href="#">query: (winlog.channel:\"security\" and winlog.event_id:\"4662\" and winlog.event_data.objecttype:\"wmi\\ namespace\" and winlog.event_data.objectname:*subscription*)
<li><a href="#">query: (winlog.channel:\"security\" and winlog.event_id:\"4663\" and winlog.event_data.objecttype:\"file\" and accesslist:\"%%1537\" and keywords:\"0x8020000000000000\")
<li><a href="#">query: (winlog.channel:\"security\" and winlog.event_id:\"4674\" and winlog.event_data.objectserver:\"security\" and winlog.event_data.objecttype:\"file\" and winlog.event_data.objectname:\"\\\\device\\\\condrv\")
<li><a href="#">query: (winlog.channel:\"security\" and winlog.event_id:\"4689\" and winlog.event_data.processname:*nltest.exe and winlog.event_data.status:\"0x0\")
<li><a href="#">query: (winlog.channel:\"security\" and winlog.event_id:\"4692\")
<li><a href="#">query: (winlog.channel:\"security\" and winlog.event_id:\"4697\" and ((winlog.event_data.clientprocessid:\"0\") or (winlog.event_data.parentprocessid:\"0\")))
<li><a href="#">query: (winlog.channel:\"security\" and winlog.event_id:\"4697\" and ((winlog.event_data.servicefilename:*admin$* and winlog.event_data.servicefilename:*.exe*) or (winlog.event_data.servicefilename:*%comspec%* and winlog.event_data.servicefilename:*start* and winlog.event_data.servicefilename:*powershell*) or winlog.event_data.servicefilename:*powershell\\ \\-nop\\ \\-w\\ hidden\\ \\-encodedcommand* or winlog.event_data.servicefilename:(*suvyichozxctt2jqzwn0ie5ldc5xzwjjbgllbnqplkrvd25sb2fku3ryaw5nkcdodhrwoi8vmti3ljaumc4xo* or *lfwcaotmv3lu9iamvjdcbozxquv2viy2xpzw50ks5eb3dubg9hzfn0cmluzygnahr0cdovlzeyny4wljaumt* or *jrvggke5ldy1pymply3qgtmv0lldlymnsawvudckurg93bmxvywrtdhjpbmcoj2h0dha6ly8xmjcumc4wlje6*)))
<li><a href="#">query: (winlog.channel:\"security\" and winlog.event_id:\"4697\" and ((winlog.event_data.servicefilename:*cmd* and winlog.event_data.servicefilename:*\\/c* and winlog.event_data.servicefilename:*echo* and winlog.event_data.servicefilename:*\\\\pipe\\\\*) or (winlog.event_data.servicefilename:*%comspec%* and winlog.event_data.servicefilename:*\\/c* and winlog.event_data.servicefilename:*echo* and winlog.event_data.servicefilename:*\\\\pipe\\\\*) or (winlog.event_data.servicefilename:*cmd.exe* and winlog.event_data.servicefilename:*\\/c* and winlog.event_data.servicefilename:*echo* and winlog.event_data.servicefilename:*\\\\pipe\\\\*) or (winlog.event_data.servicefilename:*rundll32* and winlog.event_data.servicefilename:*.dll,a* and winlog.event_data.servicefilename:*\\/p\\:*)))
<li><a href="#">query: (winlog.channel:\"security\" and winlog.event_id:\"4697\" and (winlog.event_data.servicefilename:/\\$pshome\\[\\s*\\d{1,3}\\s*\\]\\s*\\+\\s*\\$pshome\\[/ or winlog.event_data.servicefilename:/\\$shellid\\[\\s*\\d{1,3}\\s*\\]\\s*\\+\\s*\\$shellid\\[/ or winlog.event_data.servicefilename:/\\$env:public\\[\\s*\\d{1,3}\\s*\\]\\s*\\+\\s*\\$env:public\\[/ or winlog.event_data.servicefilename:/\\$env:comspec\\[(\\s*\\d{1,3}\\s*,){2}/ or winlog.event_data.servicefilename:/\\\\*mdr\\*\\w\\s*\\)\\.name/ or winlog.event_data.servicefilename:/\\$verbosepreference\\.tostring\\(/ or winlog.event_data.servicefilename:/\\string\\]\\s*\\$verbosepreference/))
<li><a href="#">query: (winlog.channel:\"security\" and winlog.event_id:\"4697\" and winlog.event_data.servicefilename:(*fgexec* or *dumpsvc* or *cachedump* or *mimidrv* or *gsecdump* or *servpw* or *pwdump*))
<li><a href="#">query: (winlog.channel:\"security\" and winlog.event_id:\"4697\" and winlog.event_data.servicefilename:(*pcap* or *npcap* or *npf* or *nm3* or *ndiscap* or *nmnt* or *windivert* or *usbpcap* or *pktmon*))
<li><a href="#">query: (winlog.channel:\"security\" and winlog.event_id:\"4697\" and winlog.event_data.servicefilename:(*powershell* or *pwsh*))
<li><a href="#">query: (winlog.channel:\"security\" and winlog.event_id:\"4697\" and winlog.event_data.servicefilename:(*ssuservice* or *splashtopremoteservice* or *atera* or *logmein* or *lmiguardiansvc* or *teamviewer* or *rpcservice* or *rpcperformanceservice* or *basupportexpressstandaloneservice* or *basupportexpresssrvcupdater* or *gotomypc* or *monblanking* or *rmanservice* or *gotoassist* or *ammyyadmin* or *vncserver* or *parsec* or *chromoting* or *zoho* or *jumpcloud*))
<li><a href="#">query: (winlog.channel:\"security\" and winlog.event_id:\"4697\" and winlog.event_data.servicefilename:*\\&&* and winlog.event_data.servicefilename:*rundll32* and winlog.event_data.servicefilename:*shell32.dll* and winlog.event_data.servicefilename:*shellexec_rundll* and winlog.event_data.servicefilename:(*value* or *invoke* or *comspec* or *iex*))
<li><a href="#">query: (winlog.channel:\"security\" and winlog.event_id:\"4697\" and winlog.event_data.servicefilename:*\\(clipboard|i*)
<li><a href="#">query: (winlog.channel:\"security\" and winlog.event_id:\"4697\" and winlog.event_data.servicefilename:*cmd* and winlog.event_data.servicefilename:*powershell* and winlog.event_data.servicefilename:(*$\\{input\\}* or *noexit*) and winlog.event_data.servicefilename:(*\\ \\/c\\ * or *\\ \\/r\\ *))
<li><a href="#">query: (winlog.channel:\"security\" and winlog.event_id:\"4697\" and winlog.event_data.servicefilename:*mshta* and winlog.event_data.servicefilename:*vbscript\\:createobject* and winlog.event_data.servicefilename:*.run* and winlog.event_data.servicefilename:*window.close*)
<li><a href="#">query: (winlog.channel:\"security\" and winlog.event_id:\"4697\" and winlog.event_data.servicefilename:*new\\-object* and winlog.event_data.servicefilename:*text.encoding\\]\\:\\:ascii* and winlog.event_data.servicefilename:*readtoend* and winlog.event_data.servicefilename:(*system.io.compression.deflatestream* or *system.io.streamreader*))
<li><a href="#">query: (winlog.channel:\"security\" and winlog.event_id:\"4697\" and winlog.event_data.servicefilename:*rundll32.exe* and winlog.event_data.servicefilename:*shell32.dll* and winlog.event_data.servicefilename:*shellexec_rundll* and winlog.event_data.servicefilename:*powershell*)
<li><a href="#">query: (winlog.channel:\"security\" and winlog.event_id:\"4697\" and winlog.event_data.servicefilename:*set* and winlog.event_data.servicefilename:*\\&&* and winlog.event_data.servicefilename:(*environment* or *invoke* or *$\\{input\\)*))
<li><a href="#">query: (winlog.channel:\"security\" and winlog.event_id:\"4697\" and winlog.event_data.servicefilename:*tap0901*)
<li><a href="#">query: (winlog.channel:\"security\" and winlog.event_id:\"4697\" and winlog.event_data.servicefilename:/(?i).*&&set.*(\\{\\d\\}){2,}\\\\\\\"\\s+?\\-f.*&&.*cmd.*\\/c/)
<li><a href="#">query: (winlog.channel:\"security\" and winlog.event_id:\"4697\" and winlog.event_data.servicefilename:/.*cmd.{0,5}(?:\\/c|\\/r)(?:\\s|)\\\"set\\s[a-za-z]{3,6}.*(?:\\{\\d\\}){1,}\\\\\\\"\\s+?\\-f(?:.*\\)){1,}.*\\\"/)
<li><a href="#">query: (winlog.channel:\"security\" and winlog.event_id:\"4697\" and winlog.event_data.servicename:\"hybridconnectionmanager\" and winlog.event_data.servicefilename:*hybridconnectionmanager*)
<li><a href="#">query: (winlog.channel:\"security\" and winlog.event_id:\"4697\" and winlog.event_data.servicename:\"javamtsup\")
<li><a href="#">query: (winlog.channel:\"security\" and winlog.event_id:\"4698\" and winlog.event_data.taskname:(\"sc\\ scheduled\\ scan\" or \"updatmachine\"))
<li><a href="#">query: (winlog.channel:\"security\" and winlog.event_id:\"4699\" and (not ((winlog.event_data.taskname:\"\\\\microsoft\\\\windows\\\\removaltools\\\\mrt_error_hb\"))))
<li><a href="#">query: (winlog.channel:\"security\" and winlog.event_id:\"4701\" and winlog.event_data.taskname:\"\\\\microsoft\\\\windows\\\\defrag\\\\scheduleddefrag\")
<li><a href="#">query: (winlog.channel:\"security\" and winlog.event_id:\"4704\" and winlog.event_data.privilegelist:*seenabledelegationprivilege*)
<li><a href="#">query: (winlog.channel:\"security\" and winlog.event_id:\"4706\")
<li><a href="#">query: (winlog.channel:\"security\" and winlog.event_id:\"4719\" and winlog.event_data.auditpolicychanges:(*%%8448* or *%%8450*))
<li><a href="#">query: (winlog.channel:\"security\" and winlog.event_id:\"4720\" and winlog.event_data.samaccountname:*anonymous* and winlog.event_data.samaccountname:*logon*)
<li><a href="#">query: (winlog.channel:\"security\" and winlog.event_id:\"4720\" and winlog.event_data.targetusername:*$)
<li><a href="#">query: (winlog.channel:\"security\" and winlog.event_id:\"4738\" and (((winlog.event_data.newuacvalue:(*8??? or *9??? or *a??? or *b??? or *c??? or *d??? or *e??? or *f???) and (not (winlog.event_data.olduacvalue:(*8??? or *9??? or *a??? or *b??? or *c??? or *d??? or *e??? or *f???)))) or (winlog.event_data.newuacvalue:(*1???? or *3???? or *5???? or *7???? or *9???? or *b???? or *d???? or *f????) and (not (winlog.event_data.olduacvalue:(*1???? or *3???? or *5???? or *7???? or *9???? or *b???? or *d???? or *f????))))) or (winlog.event_data.newuacvalue:(*8?? or *9?? or *a?? or *b?? or *c?? or *d?? or *e?? or *f??) and (not (winlog.event_data.olduacvalue:(*8?? or *9?? or *a?? or *b?? or *c?? or *d?? or *e?? or *f??))))))
<li><a href="#">query: (winlog.channel:\"security\" and winlog.event_id:\"4794\")
<li><a href="#">query: (winlog.channel:\"security\" and winlog.event_id:\"4799\" and winlog.event_data.targetusername:administr* and callerprocessname:*\\\\checkadmin.exe)
<li><a href="#">query: (winlog.channel:\"security\" and winlog.event_id:\"4800\")
<li><a href="#">query: (winlog.channel:\"security\" and winlog.event_id:\"4825\")
<li><a href="#">query: (winlog.channel:\"security\" and winlog.event_id:\"5136\" and winlog.event_data.attributevalue:* and winlog.event_data.attributeldapdisplayname:(\"primaryinternationalisdnnumber\" or \"otherfacsimiletelephonenumber\" or \"primarytelexnumber\"))
<li><a href="#">query: (winlog.channel:\"security\" and winlog.event_id:\"5145\" and winlog.event_data.objecttype:\"file\" and winlog.event_data.relativetargetname:*\\\\desktop.ini and accesslist:(*writedata* or *delete* or *writedac* or *appenddata* or *addsubdirectory*))
<li><a href="#">query: (winlog.channel:\"security\" and winlog.event_id:\"5145\" and winlog.event_data.relativetargetname:(*.pst or *.ost or *.msg or *.nst or *.oab or *.edb or *.nsf or *.bak or *.dmp or *.kirbi or *\\\\groups.xml or *.rdp))
<li><a href="#">query: (winlog.channel:\"security\" and winlog.event_id:\"5145\" and winlog.event_data.sharename:*ipc* and winlog.event_data.relativetargetname:\"protected_storage\")
<li><a href="#">query: (winlog.channel:\"security\" and winlog.event_id:\"5145\" and winlog.event_data.sharename:\\\\\\*\\\\ipc$ and winlog.event_data.relativetargetname:\"spoolss\" and winlog.event_data.accessmask:\"0x3\" and winlog.event_data.objecttype:\"file\")
<li><a href="#">query: (winlog.channel:\"security\" and winlog.event_id:\"5145\" and winlog.event_data.sharename:\\\\\\*\\\\sysvol and winlog.event_data.relativetargetname:*scheduledtasks.xml and accesses:(*writedata* or *%%4417*))
<li><a href="#">query: (winlog.channel:\"security\" and winlog.event_id:\"5145\" and winlog.event_data.sharename:\\\\\\\\\\* and winlog.event_data.sharename:*\\\\ipc$ and winlog.event_data.relativetargetname:\"lsarpc\" and winlog.event_data.subjectusername:\"anonymous\\ logon\")
<li><a href="#">query: (winlog.channel:\"security\" and winlog.event_id:\"5145\" and winlog.event_data.sharename:\\\\\\\\\\*\\\\admin$ and winlog.event_data.relativetargetname:*system32\\\\* and winlog.event_data.relativetargetname:*.tmp*)
<li><a href="#">query: (winlog.channel:\"security\" and winlog.event_id:\"5145\" and winlog.event_data.sharename:\\\\\\\\\\*\\\\ipc$ and winlog.event_data.relativetargetname:(*remcom_stdin* or *remcom_stdout* or *remcom_stderr*))
<li><a href="#">query: (winlog.channel:\"security\" and winlog.event_id:\"5145\" and winlog.event_data.sharename:\\\\\\\\\\*\\\\ipc$ and winlog.event_data.relativetargetname:\"atsvc\" and accesses:*writedata*)
<li><a href="#">query: (winlog.channel:\"security\" and winlog.event_id:\"5145\" and winlog.event_data.sharename:\\\\\\\\\\*\\\\ipc$ and winlog.event_data.relativetargetname:\"spoolss\")
<li><a href="#">query: (winlog.channel:\"security\" and winlog.event_id:\"5145\" and winlog.event_data.sharename:\\\\\\\\\\*\\\\ipc$ and winlog.event_data.relativetargetname:\"svcctl\" and accesses:*writedata*)
<li><a href="#">query: (winlog.channel:\"security\" and winlog.event_id:\"5156\" and destport:(\"3268\" or \"3269\"))
<li><a href="#">query: (winlog.channel:\"security\" and winlog.event_id:\"5156\" and destport:(\"5985\" or \"5986\") and layerrtid:\"44\")
<li><a href="#">query: (winlog.channel:\"security\" and winlog.event_id:\"6423\")
<li><a href="#">query: (winlog.channel:\"system\" and ((provider_name:\"microsoft\\-windows\\-kerberos\\-key\\-distribution\\-center\" and winlog.event_id:(\"35\" or \"36\" or \"37\" or \"38\")) or (provider_name:\"microsoft\\-windows\\-directory\\-services\\-sam\" and winlog.event_id:(\"16990\" or \"16991\"))))
<li><a href="#">query: (winlog.channel:\"system\" and ((provider_name:\"service\\ control\\ manager\" and winlog.event_id:\"7045\") and (winlog.event_data.imagepath:(*\\ \\-w\\ hidden\\ * or *\\ \\-nop\\ * or *\\ \\-sta\\ * or *\\\\users\\\\public\\\\* or *\\\\windows\\\\temp\\\\* or *\\\\perflogs\\\\* or *\\\\\\\\.\\\\pipe* or *\\\\admin$\\\\* or *.downloadstring\\(* or *.downloadfile\\(*) or (winlog.event_data.imagepath:*\\ \\-e* and winlog.event_data.imagepath:(*\\ jab* or *\\ suvyi* or *\\ sqbfafga* or *\\ awv4i* or *\\ iab* or *\\ paa* or *\\ aqblahga*)))) and (not ((winlog.event_data.imagepath:c\\:\\\\windows\\\\temp\\\\thor10\\-remote\\\\thor64.exe*))))
<li><a href="#">query: (winlog.channel:\"system\" and ((provider_name:\"service\\ control\\ manager\" and winlog.event_id:\"7045\") and (winlog.event_data.imagepath:(*\\ \\-w\\ hidden\\ * or *\\ \\-nop\\ * or *\\ \\-sta\\ * or *\\\\users\\\\public\\\\* or *\\\\windows\\\\temp\\\\* or *\\\\perflogs\\\\* or *\\\\\\\\.\\\\pipe* or *\\\\admin$\\\\* or *c\\:\\\\temp\\\\* or *.downloadstring\\(* or *.downloadfile\\(*) or (winlog.event_data.imagepath:*\\ \\-e* and winlog.event_data.imagepath:(*\\ jab* or *\\ suvyi* or *\\ sqbfafga* or *\\ awv4i* or *\\ iab* or *\\ paa* or *\\ aqblahga*)))) and (not ((winlog.event_data.imagepath:c\\:\\\\windows\\\\temp\\\\thor10\\-remote\\\\thor64.exe*) or (winlog.event_data.imagepath:c\\:\\\\programdata\\\\microsoft\\\\windows\\ defender\\\\definition\\ updates\\\\*))))
<li><a href="#">query: (winlog.channel:\"system\" and (provider_name:\"service\\ control\\ manager\" and winlog.event_id:(\"7045\" or \"7036\")) and (winlog.event_data.servicename:(*wceservice* or *wce\\ service* or *winexesvc* or *dumpsvc* or *pwdump* or *gsecdump* or *cachedump*) or winlog.event_data.imagepath:*bypass*))
<li><a href="#">query: (winlog.channel:\"system\" and (provider_name:\"service\\ control\\ manager\" and winlog.event_id:\"7045\" and winlog.event_data.imagepath:(*\\\\appdata\\\\* or *\\\\\\\\127.0.0.1* or *\\\\\\\\localhost*)) and (not ((winlog.event_data.servicename:\"zoom\\ sharing\\ service\" and winlog.event_data.imagepath:\\\"c\\:\\\\program\\ files\\\\common\\ files\\\\zoom\\\\support\\\\cptservice.exe*))))
<li><a href="#">query: (winlog.channel:\"system\" and (provider_name:\"service\\ control\\ manager\" and winlog.event_id:\"7045\") and ((winlog.event_data.imagepath:*\\\\rutserv.exe* and winlog.event_data.imagepath:*\\-service*) or winlog.event_data.servicename:\"remote\\ utilities\\ \\-\\ host\"))
<li><a href="#">query: (winlog.channel:\"system\" and (provider_name:\"service\\ control\\ manager\" and winlog.event_id:\"7045\") and ((winlog.event_data.imagepath:*admin$* and winlog.event_data.imagepath:*.exe*) or (winlog.event_data.imagepath:*%comspec%* and winlog.event_data.imagepath:*start* and winlog.event_data.imagepath:*powershell*) or winlog.event_data.imagepath:*powershell\\ \\-nop\\ \\-w\\ hidden\\ \\-encodedcommand* or winlog.event_data.imagepath:(*suvyichozxctt2jqzwn0ie5ldc5xzwjjbgllbnqplkrvd25sb2fku3ryaw5nkcdodhrwoi8vmti3ljaumc4xo* or *lfwcaotmv3lu9iamvjdcbozxquv2viy2xpzw50ks5eb3dubg9hzfn0cmluzygnahr0cdovlzeyny4wljaumt* or *jrvggke5ldy1pymply3qgtmv0lldlymnsawvudckurg93bmxvywrtdhjpbmcoj2h0dha6ly8xmjcumc4wlje6*)))
<li><a href="#">query: (winlog.channel:\"system\" and (provider_name:\"service\\ control\\ manager\" and winlog.event_id:\"7045\") and ((winlog.event_data.imagepath:*cmd* and winlog.event_data.imagepath:*\\/c* and winlog.event_data.imagepath:*echo* and winlog.event_data.imagepath:*\\\\pipe\\\\*) or (winlog.event_data.imagepath:*%comspec%* and winlog.event_data.imagepath:*\\/c* and winlog.event_data.imagepath:*echo* and winlog.event_data.imagepath:*\\\\pipe\\\\*) or (winlog.event_data.imagepath:*cmd.exe* and winlog.event_data.imagepath:*\\/c* and winlog.event_data.imagepath:*echo* and winlog.event_data.imagepath:*\\\\pipe\\\\*) or (winlog.event_data.imagepath:*rundll32* and winlog.event_data.imagepath:*.dll,a* and winlog.event_data.imagepath:*\\/p\\:*) or winlog.event_data.imagepath:\\\\\\\\127.0.0.1\\\\admin$\\\\*))
<li><a href="#">query: (winlog.channel:\"system\" and (provider_name:\"service\\ control\\ manager\" and winlog.event_id:\"7045\") and (winlog.event_data.imagepath:*\\\\netsupport\\ manager\\\\client32.exe* or winlog.event_data.servicename:\"client32\"))
<li><a href="#">query: (winlog.channel:\"system\" and (provider_name:\"service\\ control\\ manager\" and winlog.event_id:\"7045\") and (winlog.event_data.imagepath:*pdqdeployrunner\\-* or winlog.event_data.servicename:pdqdeployrunner\\-*))
<li><a href="#">query: (winlog.channel:\"system\" and (provider_name:\"service\\ control\\ manager\" and winlog.event_id:\"7045\") and (winlog.event_data.imagepath:*pdqdeployservice.exe* or winlog.event_data.servicename:(\"pdqdeploy\" or \"pdq\\ deploy\")))
<li><a href="#">query: (winlog.channel:\"system\" and (provider_name:\"service\\ control\\ manager\" and winlog.event_id:\"7045\") and (winlog.event_data.imagepath:/^[cc]:\\\\[pp]rogram[dd]ata\\\\.{1,9}\\.exe/ or winlog.event_data.imagepath:/^[cc]:\\\\.{1,9}\\.exe/))
<li><a href="#">query: (winlog.channel:\"system\" and provider_name:\"application\\ popup\" and winlog.event_id:\"26\" and caption:\"sysmon64.exe\\ \\-\\ application\\ error\")
<li><a href="#">query: (winlog.channel:\"system\" and provider_name:\"lsasrv\" and winlog.event_id:\"6038\")
<li><a href="#">query: (winlog.channel:\"system\" and provider_name:\"microsoft\\-windows\\-kernel\\-general\" and winlog.event_id:\"16\" and \"\\\\appdata\\\\local\\\\temp\\\\sam\\-\" and \".dmp\")
<li><a href="#">query: (winlog.channel:\"system\" and provider_name:\"microsoft\\-windows\\-ntfs\" and winlog.event_id:\"98\" and devicename:*harddiskvolumeshadowcopy*)
<li><a href="#">query: (winlog.channel:\"system\" and provider_name:\"microsoft\\-windows\\-windowsupdateclient\" and winlog.event_id:(\"16\" or \"20\" or \"24\" or \"213\" or \"217\"))
<li><a href="#">query: (winlog.channel:\"system\" and provider_name:\"netlogon\" and winlog.event_id:\"5829\")
<li><a href="#">query: (winlog.channel:\"system\" and provider_name:\"ntfs\" and winlog.event_id:\"55\" and origin:\"file\\ system\\ driver\" and winlog.event_data.description:*contains\\ a\\ corrupted\\ file\\ record* and winlog.event_data.description:*the\\ name\\ of\\ the\\ file\\ is\\ \\\"\\\\\\\"*)
<li><a href="#">query: (winlog.channel:\"system\" and provider_name:\"service control manager\" and winlog.event_id:(\"7045\" or \"7036\") and winlog.event_data.servicename:(*ssuservice* or *splashtopremoteservice* or *atera* or *logmein* or *lmiguardiansvc* or *teamviewer* or *rpcservice* or *rpcperformanceservice* or *basupportexpressstandaloneservice* or *basupportexpresssrvcupdater* or *gotomypc* or *monblanking* or *rmanservice* or *gotoassist* or *ammyyadmin* or *vncserver* or *parsec* or *chromoting* or *zoho* or *jumpcloud*))
<li><a href="#">query: (winlog.channel:\"system\" and provider_name:\"service control manager\" and winlog.event_id:\"7045\" and processid:\"0\")
<li><a href="#">query: (winlog.channel:\"system\" and provider_name:\"service\\ control\\ manager\" and winlog.event_id:\"7045\" and winlog.event_data.imagepath:(*fgexec* or *dumpsvc* or *cachedump* or *mimidrv* or *gsecdump* or *servpw* or *pwdump*))
<li><a href="#">query: (winlog.channel:\"system\" and provider_name:\"service\\ control\\ manager\" and winlog.event_id:\"7045\" and winlog.event_data.imagepath:(*powershell* or *pwsh*))
<li><a href="#">query: (winlog.channel:\"system\" and provider_name:\"service\\ control\\ manager\" and winlog.event_id:\"7045\" and winlog.event_data.imagepath:*\\ \\/c\\ * and winlog.event_data.imagepath:(*powershell* or *wscript* or *cscript* or *mshta* or *rundll32*))
<li><a href="#">query: (winlog.channel:\"system\" and provider_name:\"service\\ control\\ manager\" and winlog.event_id:\"7045\" and winlog.event_data.imagepath:*\\&&* and winlog.event_data.imagepath:*rundll32* and winlog.event_data.imagepath:*shell32.dll* and winlog.event_data.imagepath:*shellexec_rundll* and winlog.event_data.imagepath:(*value* or *invoke* or *comspec* or *iex*))
<li><a href="#">query: (winlog.channel:\"system\" and provider_name:\"service\\ control\\ manager\" and winlog.event_id:\"7045\" and winlog.event_data.imagepath:*\\&&*)
<li><a href="#">query: (winlog.channel:\"system\" and provider_name:\"service\\ control\\ manager\" and winlog.event_id:\"7045\" and winlog.event_data.imagepath:*\\(clipboard|i*)
<li><a href="#">query: (winlog.channel:\"system\" and provider_name:\"service\\ control\\ manager\" and winlog.event_id:\"7045\" and winlog.event_data.imagepath:*cmd* and winlog.event_data.imagepath:*clip* and winlog.event_data.imagepath:*clipboard\\]\\:\\:*)
<li><a href="#">query: (winlog.channel:\"system\" and provider_name:\"service\\ control\\ manager\" and winlog.event_id:\"7045\" and winlog.event_data.imagepath:*mshta* and winlog.event_data.imagepath:*vbscript\\:createobject*)
<li><a href="#">query: (winlog.channel:\"system\" and provider_name:\"service\\ control\\ manager\" and winlog.event_id:\"7045\" and winlog.event_data.imagepath:*new\\-object* and winlog.event_data.imagepath:*text.encoding\\]\\:\\:ascii* and winlog.event_data.imagepath:*readtoend* and winlog.event_data.imagepath:(*\\:system.io.compression.deflatestream* or *system.io.streamreader*))
<li><a href="#">query: (winlog.channel:\"system\" and provider_name:\"service\\ control\\ manager\" and winlog.event_id:\"7045\" and winlog.event_data.imagepath:*rundll32.exe* and winlog.event_data.imagepath:*shell32.dll* and winlog.event_data.imagepath:*shellexec_rundll* and winlog.event_data.imagepath:*powershell*)
<li><a href="#">query: (winlog.channel:\"system\" and provider_name:\"service\\ control\\ manager\" and winlog.event_id:\"7045\" and winlog.event_data.imagepath:*tap0901*)
<li><a href="#">query: (winlog.channel:\"system\" and provider_name:\"service\\ control\\ manager\" and winlog.event_id:\"7045\" and winlog.event_data.imagepath:/(?i).*&&set.*(\\{\\d\\}){2,}\\\\\\\"\\s+?\\-f.*&&.*cmd.*\\/c/)
<li><a href="#">query: (winlog.channel:\"system\" and provider_name:\"service\\ control\\ manager\" and winlog.event_id:\"7045\" and winlog.event_data.imagepath:/(?i).*(set).*&&\\s?set.*(environment|invoke|\\${?input).*&&.*\"/)
<li><a href="#">query: (winlog.channel:\"system\" and provider_name:\"service\\ control\\ manager\" and winlog.event_id:\"7045\" and winlog.event_data.imagepath:/.*cmd.{0,5}(?:\\/c|\\/r)(?:\\s|)\\\"set\\s[a-za-z]{3,6}.*(?:\\{\\d\\}){1,}\\\\\\\"\\s+?\\-f(?:.*\\)){1,}.*\\\"/)
<li><a href="#">query: (winlog.channel:\"system\" and provider_name:\"service\\ control\\ manager\" and winlog.event_id:\"7045\" and winlog.event_data.imagepath:/.*cmd.{0,5}(?:\\/c|\\/r).+powershell.+(?:\\$\\{?input\\}?|noexit).+\\\"/)
<li><a href="#">query: (winlog.channel:\"system\" and provider_name:\"service\\ control\\ manager\" and winlog.event_id:\"7045\" and winlog.event_data.servicename:(\"sc\\ scheduled\\ scan\" or \"updatmachine\"))
<li><a href="#">query: (winlog.channel:\"system\" and provider_name:\"service\\ control\\ manager\" and winlog.event_id:\"7045\" and winlog.event_data.servicename:(\"srservice\" or \"ipvpn\" or \"hkmsvc\"))
<li><a href="#">query: (winlog.channel:\"system\" and provider_name:\"service\\ control\\ manager\" and winlog.event_id:\"7045\" and winlog.event_data.servicename:\"btobto\" and winlog.event_data.imagepath:*\\\\execute.bat)
<li><a href="#">query: (winlog.channel:\"system\" and provider_name:\"service\\ control\\ manager\" and winlog.event_id:\"7045\" and winlog.event_data.servicename:\"ntssrv\" and winlog.event_data.imagepath:*\\ localservice)
<li><a href="#">query: (winlog.channel:\"system\" and provider_name:\"service\\ control\\ manager\" and winlog.event_id:\"7045\" and winlog.event_data.servicename:\"werfaultsvc\")
<li><a href="#">query: (winlog.channel:\"system\" and provider_name:\"service\\ control\\ manager\" and winlog.event_id:\"7045\" and winlog.event_data.servicename:\"zznetsvc\")
<li><a href="#">query: (winlog.channel:\"system\" and provider_name:\"service\\ control\\ manager\" and winlog.event_id:\"7045\" and winlog.event_data.servicename:processhacker* and winlog.event_data.accountname:\"localsystem\")
<li><a href="#">query: (winlog.channel:\"system\" and winlog.event_data.servicename:\"psexesvc\" and ((provider_name:\"service\\ control\\ manager\" and winlog.event_id:\"7045\" and winlog.event_data.imagepath:*\\\\psexesvc.exe) or winlog.event_id:\"7036\"))
<li><a href="#">query: (winlog.channel:\"system\" and winlog.event_id:(\"1031\" or \"1032\" or \"1034\") and provider_name:\"microsoft\\-windows\\-dhcp\\-server\")
<li><a href="#">query: (winlog.channel:\"system\" and winlog.event_id:(\"56\" or \"50\") and provider_name:\"termdd\")
<li><a href="#">query: (winlog.channel:\"system\" and winlog.event_id:(\"5805\" or \"5723\") and (*kali* or *mimikatz*))
<li><a href="#">query: (winlog.channel:\"system\" and winlog.event_id:\"10001\" and param1:\"c:\\program files\\common files\\microsoft shared\\ink\\tabtip.exe\" and param2:\"2147943140\" and param3:\"{054aae20-4bea-4347-8a35-64a533254a9d}\")
<li><a href="#">query: (winlog.channel:\"system\" and winlog.event_id:\"10001\" and param1:\"c\\:\\\\program\\ files\\\\common\\ files\\\\microsoft\\ shared\\\\ink\\\\tabtip.exe\" and param2:\"2147943140\" and param3:\"\\{054aae20\\-4bea\\-4347\\-8a35\\-64a533254a9d\\}\")
<li><a href="#">query: (winlog.channel:\"system\" and winlog.event_id:\"1033\" and provider_name:\"microsoft\\-windows\\-dhcp\\-server\")
<li><a href="#">query: (winlog.channel:\"system\" and winlog.event_id:\"104\" and provider_name:\"microsoft\\-windows\\-eventlog\" and winlog.channel:(\"system\" or \"security\" or \"application\"))
<li><a href="#">query: (winlog.channel:\"system\" and winlog.event_id:\"16\" and provider_name:\"microsoft\\-windows\\-kernel\\-general\" and winlog.event_data.hivename:*\\\\appdata\\\\local\\\\temp\\\\sam* and winlog.event_data.hivename:*.dmp)
<li><a href="#">query: (winlog.channel:\"system\" and winlog.event_id:\"42\" and provider_name:\"kerberos\\-key\\-distribution\\-center\" and level:\"2\")
<li><a href="#">query: (winlog.channel:\"system\" and winlog.event_id:\"4697\" and winlog.event_data.servicefilename:(*pcap* or *npcap* or *npf* or *nm3* or *ndiscap* or *nmnt* or *windivert* or *usbpcap* or *pktmon*))
<li><a href="#">query: (winlog.channel:\"system\" and winlog.event_id:\"7036\" and provider_name:\"service\\ control\\ manager\" and param1:(\"windows\\ defender\\ antivirus\\ service\" or \"service\\ antivirus\\ microsoft\\ defender\") and param2:\"stopped\")
<li><a href="#">query: (winlog.channel:\"system\" and winlog.event_id:\"7045\" and (winlog.event_data.imagepath:/\\$pshome\\[\\s*\\d{1,3}\\s*\\]\\s*\\+\\s*\\$pshome\\[/ or winlog.event_data.imagepath:/\\$shellid\\[\\s*\\d{1,3}\\s*\\]\\s*\\+\\s*\\$shellid\\[/ or winlog.event_data.imagepath:/\\$env:public\\[\\s*\\d{1,3}\\s*\\]\\s*\\+\\s*\\$env:public\\[/ or winlog.event_data.imagepath:/\\$env:comspec\\[(\\s*\\d{1,3}\\s*,){2}/ or winlog.event_data.imagepath:/\\\\*mdr\\*\\w\\s*\\)\\.name/ or winlog.event_data.imagepath:/\\$verbosepreference\\.tostring\\(/ or winlog.event_data.imagepath:/\\string\\]\\s*\\$verbosepreference/))
<li><a href="#">query: (winlog.event_data.calltrace:/^c:\\\\\\\\windows\\\\\\\\system32\\\\\\\\ntdll\\\\.dll\\+[a-z0-9]{4,6}\\|c:\\\\\\\\windows\\\\\\\\system32\\\\\\\\kernelbase\\\\.dll\\+[a-z0-9]{4,6}\\|unknown\\([a-z0-9]{16}\\)$/ and winlog.event_data.grantedaccess:(\"0x1028\" or \"0x1fffff\"))
<li><a href="#">query: (winlog.event_data.calltrace:unknown* and (not (((winlog.event_data.targetimage:\"c:\\program files\\cylance\\desktop\\cylanceui.exe\" and process.executable.text:\"c:\\windows\\explorer.exe\")) or ((winlog.event_data.targetimage:\"c:\\program files (x86)\\microsoft\\edgeupdate\\microsoftedgeupdate.exe\" and process.executable.text:c\\:\\\\program\\ files\\ \\(x86\\)\\\\microsoft\\\\temp\\\\* and process.executable.text:*\\\\microsoftedgeupdate.exe)) or ((winlog.event_data.targetimage:*vcredist_x64.exe and process.executable.text:*vcredist_x64.exe)) or ((winlog.event_data.targetimage:\"c:\\windows\\system32\\systeminfo.exe\" and process.executable.text:*setup64.exe)) or ((winlog.event_data.targetimage:*amazonssmagentsetup.exe and process.executable.text:*amazonssmagentsetup.exe)) or ((winlog.event_data.targetimage:*c\\:\\\\program\\ files\\\\mozilla\\ firefox\\\\firefox.exe and process.executable.text:*c\\:\\\\program\\ files\\\\mozilla\\ firefox\\\\firefox.exe)) or ((winlog.event_data.targetimage:*\\\\appdata\\\\local\\\\programs\\\\microsoft\\ vs\\ code\\\\code.exe and process.executable.text:*\\\\appdata\\\\local\\\\programs\\\\microsoft\\ vs\\ code\\\\code.exe)) or ((winlog.event_data.targetimage:*c\\:\\\\program\\ files\\\\google\\\\chrome\\\\application\\\\chrome.exe and process.executable.text:*c\\:\\\\program\\ files\\\\google\\\\chrome\\\\application\\\\chrome.exe)) or ((winlog.event_data.targetimage:*c\\:\\\\program\\ files\\ \\(x86\\)\\\\google\\\\update\\\\googleupdate.exe and process.executable.text:*c\\:\\\\program\\ files\\ \\(x86\\)\\\\google\\\\update\\\\googleupdate.exe)) or ((winlog.event_data.targetimage:*\\\\appdata\\\\local\\\\microsoft\\\\teams\\\\current\\\\teams.exe and process.executable.text:*\\\\appdata\\\\local\\\\microsoft\\\\teams\\\\current\\\\teams.exe)) or ((winlog.event_data.targetimage:\"c:\\windows\\system32\\backgroundtaskhost.exe\" and process.executable.text:\"c:\\windows\\system32\\backgroundtaskhost.exe\")) or ((winlog.event_data.targetimage:\"c:\\program files (x86)\\ccleaner browser\\application\\ccleanerbrowser.exe\" and process.executable.text:\"c:\\program files (x86)\\ccleaner browser\\application\\ccleanerbrowser.exe\")) or ((winlog.event_data.targetimage:c\\:\\\\users\\\\* and winlog.event_data.targetimage:*\\\\appdata\\\\local\\\\discord\\\\* and winlog.event_data.targetimage:*\\\\discord.exe)) or ((winlog.event_data.targetimage:\"c:\\windows\\system32\\audiodg.exe\")) or ((provider_name:\"microsoft-windows-kernel-audit-api-calls\")) or ((winlog.event_data.targetimage:*\\\\evernote\\\\evernote.exe)))))
<li><a href="#">query: (winlog.event_data.description:(*failed\\ to\\ open\\ service\\ configuration\\ with\\ error* or *failed\\ to\\ connect\\ to\\ the\\ driver\\ to\\ update\\ configuration*) and (not ((winlog.event_data.description:*failed\\ to\\ open\\ service\\ configuration\\ with\\ error* and winlog.event_data.description:*last\\ error\\:\\ the\\ media\\ is\\ write\\ protected.*) or (winlog.event_data.description:(*failed\\ to\\ open\\ service\\ configuration\\ with\\ error\\ 19* or *failed\\ to\\ open\\ service\\ configuration\\ with\\ error\\ 93*)))))
<li><a href="#">query: (winlog.event_data.description:(\"java update scheduler\" or \"java(tm) update scheduler\") and (not (process.executable.text:*\\\\jusched.exe)))
<li><a href="#">query: (winlog.event_data.description:\"\\?\" and (fileversion:\"\\?\" or product:\"\\?\" or company:\"\\?\") and process.executable.text:*\\\\downloads\\\\*)
<li><a href="#">query: (winlog.event_data.description:\"\\?\" and (fileversion:\"\\?\" or product:\"\\?\" or company:\"\\?\") and process.executable:*\\\\downloads\\\\*)
<li><a href="#">query: (winlog.event_data.description:\"anydesk\" or product:\"anydesk\" or company:\"anydesk\\ software\\ gmbh\")
<li><a href="#">query: (winlog.event_data.description:\"command\\-line\\ ssh,\\ telnet,\\ and\\ rlogin\\ client\" and process.command_line.text:*\\ \\-r\\ *)
<li><a href="#">query: (winlog.event_data.description:\"command\\-line\\ ssh,\\ telnet,\\ and\\ rlogin\\ client\" and process.command_line:*\\ \\-r\\ *)
<li><a href="#">query: (winlog.event_data.description:\"goto\\ opener\" or product:\"goto\\ opener\" or company:\"logmein,\\ inc.\")
<li><a href="#">query: (winlog.event_data.description:\"lmiguardiansvc\" or product:\"lmiguardiansvc\" or company:\"logmein,\\ inc.\")
<li><a href="#">query: (winlog.event_data.description:\"python\\ core\" and (not ((process.executable.text:*python* or process.executable.text:(c\\:\\\\program\\ files\\\\* or c\\:\\\\program\\ files\\ \\(x86\\)\\\\* or c\\:\\\\programdata\\\\anaconda3\\\\*)) or (not _exists_:process.executable.text))))
<li><a href="#">query: (winlog.event_data.description:\"python\\ core\" and (not (process.executable:*python* or process.executable:(c\\:\\\\program\\ files\\\\* or c\\:\\\\program\\ files\\ \\(x86\\)\\\\*))))
<li><a href="#">query: (winlog.event_data.description:\"radmin\\ viewer\" or product:\"radmin\\ viewer\" or winlog.event_data.originalfilename:\"radmin.exe\")
<li><a href="#">query: (winlog.event_data.description:\"rsync\\ for\\ cloud\\ storage\" or (process.command_line:*\\-\\-config\\ * and process.command_line:*\\-\\-no\\-check\\-certificate\\ * and process.command_line:*\\ copy\\ *) or (process.executable:*\\\\rclone.exe and process.command_line:(*mega* or *pcloud* or *ftp* or *\\-\\-progress* or *\\-\\-ignore\\-existing* or *\\-\\-auto\\-confirm* or *\\-\\-transfers* or *\\-\\-multi\\-thread\\-streams*)))
<li><a href="#">query: (winlog.event_data.description:\"screenconnect\\ service\" or product:\"screenconnect\" or company:\"screenconnect\\ software\")
<li><a href="#">query: (winlog.event_data.description:\"web\\ browser\\ password\\ viewer\" or process.executable.text:*\\\\webbrowserpassview.exe)
<li><a href="#">query: (winlog.event_data.engineversion:(2.* or 4.* or 5.*) and winlog.event_data.hostversion:3.*)
<li><a href="#">query: (winlog.event_data.engineversion:2.* and (not (winlog.event_data.hostversion:2.*)))
<li><a href="#">query: (winlog.event_data.eventtype:\"createkey\" and winlog.event_data.targetobject:(*\\\\psexec* or *\\\\procdump* or *\\\\handle* or *\\\\livekd* or *\\\\process\\ explorer* or *\\\\psloglist* or *\\\\pspasswd* or *\\\\active\\ directory\\ explorer* or *\\\\sysinternals*) and winlog.event_data.targetobject:*\\\\eulaaccepted)
<li><a href="#">query: (winlog.event_data.eventtype:\"createkey\" and winlog.event_data.targetobject:*\\\\eulaaccepted)
<li><a href="#">query: (winlog.event_data.eventtype:\"createkey\" and winlog.event_data.targetobject:*\\\\software\\\\netwire*)
<li><a href="#">query: (winlog.event_data.eventtype:\"createkey\" and winlog.event_data.targetobject:*\\\\software\\\\sysinternals\\\\sdelete*)
<li><a href="#">query: (winlog.event_data.eventtype:\"createkey\" and winlog.event_data.targetobject:*hku\\\\* and winlog.event_data.targetobject:*classes\\\\clsid\\\\* and winlog.event_data.targetobject:*\\\\treatas*)
<li><a href="#">query: (winlog.event_data.eventtype:\"createkey\" and winlog.event_data.targetobject:*userinitmprlogonscript*)
<li><a href="#">query: (winlog.event_data.eventtype:\"deletekey\" and winlog.event_data.targetobject:(*\\{2781761e\\-28e0\\-4109\\-99fe\\-b9d127c57afe\\} or *\\{a7c452ef\\-8e9f\\-42eb\\-9f2b\\-245613ca0dc9\\}))
<li><a href="#">query: (winlog.event_data.eventtype:\"deletekey\" and winlog.event_data.targetobject:*\\\\shell\\\\open\\\\command)
<li><a href="#">query: (winlog.event_data.eventtype:\"deletekey\" and winlog.event_data.targetobject:*\\\\software\\\\microsoft\\\\windows\\ nt\\\\currentversion\\\\schedule\\\\taskcache\\\\tree\\\\* and winlog.event_data.targetobject:*index*)
<li><a href="#">query: (winlog.event_data.eventtype:\"deletevalue\" and winlog.event_data.targetobject:*software\\\\microsoft\\\\windows\\ defender\\\\windows\\ defender\\ exploit\\ guard\\\\controlled\\ folder\\ access\\\\protectedfolders*)
<li><a href="#">query: (winlog.event_data.eventtype:\"setvalue\" and (((winlog.event_data.targetobject:*classes\\\\activatableclasses\\\\package\\\\microsoft.* and winlog.event_data.targetobject:*\\\\debugpath)) or ((winlog.event_data.targetobject:*\\\\software\\\\microsoft\\\\windows\\\\currentversion\\\\packagedappxdebug\\\\microsoft.* and winlog.event_data.targetobject:*\\\\\\(default\\)))))
<li><a href="#">query: (winlog.event_data.eventtype:\"setvalue\" and ((winlog.event_data.targetobject:(*software\\\\microsoft\\\\windows\\\\currentversion\\\\policies\\\\explorer\\\\hideclock or *software\\\\microsoft\\\\windows\\\\currentversion\\\\policies\\\\explorer\\\\hidescahealth or *software\\\\microsoft\\\\windows\\\\currentversion\\\\policies\\\\explorer\\\\hidescanetwork or *software\\\\microsoft\\\\windows\\\\currentversion\\\\policies\\\\explorer\\\\hidescapower or *software\\\\microsoft\\\\windows\\\\currentversion\\\\policies\\\\explorer\\\\hidescavolume) and winlog.event_data.details:\"dword\\ \\(0x00000001\\)\") or (winlog.event_data.targetobject:(*software\\\\microsoft\\\\windows\\\\currentversion\\\\explorer\\\\advanced\\\\showinfotip or *software\\\\microsoft\\\\windows\\\\currentversion\\\\explorer\\\\advanced\\\\showcompcolor) and winlog.event_data.details:\"dword\\ \\(0x00000000\\)\")))
<li><a href="#">query: (winlog.event_data.eventtype:\"setvalue\" and ((winlog.event_data.targetobject:(*software\\\\microsoft\\\\windows\\\\currentversion\\\\policies\\\\system\\\\disableregistrytools or *software\\\\policies\\\\microsoft\\\\windows\\\\system\\\\disablecmd or *software\\\\microsoft\\\\windows\\\\currentversion\\\\policies\\\\system\\\\disabletaskmgr or *software\\\\policies\\\\microsoft\\\\windows\\\\explorer\\\\disablenotificationcenter or *software\\\\microsoft\\\\windows\\\\currentversion\\\\policies\\\\system\\\\disablechangepassword or *software\\\\microsoft\\\\windows\\\\currentversion\\\\policies\\\\system\\\\disablelockworkstation or *software\\\\microsoft\\\\windows\\\\currentversion\\\\policies\\\\explorer\\\\startmenulogoff) and winlog.event_data.details:\"dword\\ \\(0x00000001\\)\") or (winlog.event_data.targetobject:(*software\\\\microsoft\\\\windows\\\\currentversion\\\\policies\\\\system\\\\shutdownwithoutlogon or *software\\\\microsoft\\\\windows\\\\currentversion\\\\pushnotifications\\\\toastenabled or *\\\\system\\\\currentcontrolset\\\\control\\\\storage\\\\write\\ protection or *\\\\system\\\\currentcontrolset\\\\control\\\\storagedevicepolicies\\\\writeprotect) and winlog.event_data.details:\"dword\\ \\(0x00000000\\)\")))
<li><a href="#">query: (winlog.event_data.eventtype:\"setvalue\" and ((winlog.event_data.targetobject:(*software\\\\policies\\\\microsoft\\\\windows\\ nt\\\\terminal\\ services\\\\* or *\\\\control\\\\terminal\\ server\\\\*) and winlog.event_data.targetobject:*\\\\shadow and winlog.event_data.details:(\"dword\\ \\(0x00000001\\)\" or \"dword\\ \\(0x00000002\\)\" or \"dword\\ \\(0x00000003\\)\" or \"dword\\ \\(0x00000004\\)\")) or (winlog.event_data.targetobject:(*\\\\control\\\\terminal\\ server\\\\* or *software\\\\policies\\\\microsoft\\\\windows\\ nt\\\\terminal\\ services\\\\*) and winlog.event_data.targetobject:(*\\\\fallowunsolicited or *\\\\fallowunsolicitedfullcontrol) and winlog.event_data.details:\"dword\\ \\(0x00000001\\)\") or winlog.event_data.targetobject:(*\\\\services\\\\termservice\\\\parameters\\\\servicedll* or *\\\\control\\\\terminal\\ server\\\\winstations\\\\rdp\\-tcp\\\\initialprogram* or *\\\\control\\\\terminal\\ server\\\\initialprogram* or *software\\\\policies\\\\microsoft\\\\windows\\ nt\\\\terminal\\ services\\\\initialprogram*)))
<li><a href="#">query: (winlog.event_data.eventtype:\"setvalue\" and ((winlog.event_data.targetobject:(\"hklm\\\\software\\\\policies\\\\microsoft\\\\windows\\ defender\\\\real\\-time\\ protection\\\\disablebehaviormonitoring\" or \"hklm\\\\software\\\\policies\\\\microsoft\\\\windows\\ defender\\\\real\\-time\\ protection\\\\disableioavprotection\" or \"hklm\\\\software\\\\policies\\\\microsoft\\\\windows\\ defender\\\\real\\-time\\ protection\\\\disableonaccessprotection\" or \"hklm\\\\software\\\\policies\\\\microsoft\\\\windows\\ defender\\\\real\\-time\\ protection\\\\disablerealtimemonitoring\" or \"hklm\\\\software\\\\policies\\\\microsoft\\\\windows\\ defender\\\\real\\-time\\ protection\\\\disablescanonrealtimeenable\" or \"hklm\\\\software\\\\policies\\\\microsoft\\\\windows\\ defender\\\\spynet\\\\disableblockatfirstseen\") and winlog.event_data.details:\"dword\\ \\(0x00000001\\)\") or (winlog.event_data.targetobject:(\"hklm\\\\software\\\\policies\\\\microsoft\\\\windows\\ defender\\\\spynet\\\\spynetreporting\" or \"hklm\\\\software\\\\policies\\\\microsoft\\\\windows\\ defender\\\\spynet\\\\submitsamplesconsent\") and winlog.event_data.details:\"dword\\ \\(0x00000000\\)\")))
<li><a href="#">query: (winlog.event_data.eventtype:\"setvalue\" and ((winlog.event_data.targetobject:*\\\\software\\\\microsoft\\\\windows\\\\currentversion\\\\explorer\\\\advanced\\\\hidefileext and winlog.event_data.details:\"dword\\ \\(0x00000001\\)\") or (winlog.event_data.targetobject:*\\\\software\\\\microsoft\\\\windows\\\\currentversion\\\\explorer\\\\advanced\\\\hidden and winlog.event_data.details:\"dword\\ \\(0x00000002\\)\")))
<li><a href="#">query: (winlog.event_data.eventtype:\"setvalue\" and ((winlog.event_data.targetobject:*\\\\software\\\\policies\\\\microsoft\\\\edge\\\\builtindnsclientenabled and winlog.event_data.details:\"dword\\ \\(0x00000001\\)\") or (winlog.event_data.targetobject:*\\\\software\\\\google\\\\chrome\\\\dnsoverhttpsmode and winlog.event_data.details:\"secure\") or (winlog.event_data.targetobject:*\\\\software\\\\policies\\\\mozilla\\\\firefox\\\\dnsoverhttps\\\\enabled and winlog.event_data.details:\"dword\\ \\(0x00000001\\)\")))
<li><a href="#">query: (winlog.event_data.eventtype:\"setvalue\" and ((winlog.event_data.targetobject:*\\\\software\\\\policies\\\\microsoft\\\\edge\\\\builtindnsclientenabled and winlog.event_data.details:\"dword\\ \\(1\\)\") or (winlog.event_data.targetobject:*\\\\software\\\\google\\\\chrome\\\\dnsoverhttpsmode and winlog.event_data.details:\"dword\\ \\(secure\\)\") or (winlog.event_data.targetobject:*\\\\software\\\\policies\\\\mozilla\\\\firefox\\\\dnsoverhttps\\\\enabled and winlog.event_data.details:\"dword\\ \\(1\\)\")))
<li><a href="#">query: (winlog.event_data.eventtype:\"setvalue\" and ((winlog.event_data.targetobject:*\\\\word\\\\security\\\\allowdde and winlog.event_data.details:(\"dword\\ \\(0x00000001\\)\" or \"dword\\ \\(0x00000002\\)\")) or (winlog.event_data.targetobject:(*\\\\excel\\\\security\\\\disableddeserverlaunch or *\\\\excel\\\\security\\\\disableddeserverlookup) and winlog.event_data.details:\"dword\\ \\(0x00000000\\)\")))
<li><a href="#">query: (winlog.event_data.eventtype:\"setvalue\" and (winlog.event_data.targetobject:*software\\\\classes\\\\exefile\\\\shell\\\\runas\\\\command\\\\isolatedcommand or (winlog.event_data.targetobject:*software\\\\classes\\\\folder\\\\shell\\\\open\\\\command\\\\symboliclinkvalue and winlog.event_data.details:*\\-1???\\\\software\\\\classes\\\\*)))
<li><a href="#">query: (winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.details:\"dword\\ \\(0x00000001\\)\" and (winlog.event_data.targetobject:(\"hklm\\\\software\\\\policies\\\\microsoft\\\\windows\\ defender\\\\disableantispyware\" or \"hklm\\\\software\\\\policies\\\\microsoft\\\\windows\\ defender\\\\disableantivirus\") or winlog.event_data.targetobject:(\"hklm\\\\system\\\\currentcontrolset\\\\services\\\\windefend\" or \"hklm\\\\software\\\\microsoft\\\\windows\\ defender\" or \"hklm\\\\software\\\\policies\\\\microsoft\\\\windows\\ defender\")))
<li><a href="#">query: (winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:(*\\\\cor_enable_profiling or *\\\\cor_profiler))
<li><a href="#">query: (winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:(*\\\\currentcontrolset\\\\control\\\\terminal\\ server\\\\winstations\\\\rdp\\-tcp\\\\userauthentication or *\\\\currentcontrolset\\\\control\\\\terminal\\ server\\\\fdenytsconnections) and winlog.event_data.details:\"dword\\ \\(0x00000000\\)\")
<li><a href="#">query: (winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:(*\\\\keyboard\\ layout\\\\preload\\\\* or *\\\\keyboard\\ layout\\\\substitutes\\\\*) and winlog.event_data.details:(*00000429* or *00050429* or *0000042a*))
<li><a href="#">query: (winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:(*\\\\microsoft\\\\windows\\\\currentversion\\\\appmodelunlock* or *\\\\policies\\\\microsoft\\\\windows\\\\appx\\\\*) and winlog.event_data.targetobject:(*\\\\allowalltrustedapps or *\\\\allowdevelopmentwithoutdevlicense) and winlog.event_data.details:\"dword (0x00000001)\")
<li><a href="#">query: (winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:(*\\\\microsoft\\\\windows\\\\powershell\\\\modulelogging\\\\enablemodulelogging or *\\\\microsoft\\\\windows\\\\powershell\\\\scriptblocklogging\\\\enablescriptblocklogging or *\\\\microsoft\\\\windows\\\\powershell\\\\transcription\\\\enabletranscripting or *\\\\microsoft\\\\windows\\\\powershell\\\\enablescripts or *\\\\microsoft\\\\powershellcore\\\\modulelogging\\\\enablemodulelogging or *\\\\microsoft\\\\powershellcore\\\\scriptblocklogging\\\\enablescriptblocklogging or *\\\\microsoft\\\\powershellcore\\\\transcription\\\\enabletranscripting or *\\\\microsoft\\\\powershellcore\\\\enablescripts) and winlog.event_data.details:\"dword (0x00000000)\")
<li><a href="#">query: (winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:(*\\\\policies\\\\microsoft\\\\windows\\ nt\\\\systemrestore* or *\\\\microsoft\\\\windows\\ nt\\\\currentversion\\\\systemrestore*) and winlog.event_data.targetobject:(*disableconfig or *disablesr) and winlog.event_data.details:\"dword\\ \\(0x00000001\\)\")
<li><a href="#">query: (winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:(*\\\\security\\\\trusted\\ documents\\\\trustrecords or *\\\\security\\\\accessvbom or *\\\\security\\\\vbawarnings))
<li><a href="#">query: (winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:(*\\\\services\\\\dhcpserver\\\\parameters\\\\calloutdlls or *\\\\services\\\\dhcpserver\\\\parameters\\\\calloutenabled))
<li><a href="#">query: (winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:(*\\\\services\\\\termservice\\\\parameters\\\\servicedll* or *\\\\control\\\\terminal\\ server\\\\fsinglesessionperuser* or *\\\\control\\\\terminal\\ server\\\\fdenytsconnections* or *\\\\policies\\\\microsoft\\\\windows\\ nt\\\\terminal\\ services\\\\shadow* or *\\\\control\\\\terminal\\ server\\\\winstations\\\\rdp\\-tcp\\\\initialprogram*))
<li><a href="#">query: (winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:(*\\\\software\\\\microsoft\\\\htmlhelp\\ author\\\\location* or *\\\\software\\\\wow6432node\\\\microsoft\\\\htmlhelp\\ author\\\\location*))
<li><a href="#">query: (winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:(*\\\\software\\\\microsoft\\\\office\\\\* or *\\\\outlook\\\\webview\\\\*) and winlog.event_data.targetobject:*\\\\url and winlog.event_data.targetobject:(*\\\\calendar\\\\* or *\\\\inbox\\\\*))
<li><a href="#">query: (winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:(*\\\\software\\\\microsoft\\\\systemcertificates\\\\root\\\\certificates\\\\* or *\\\\software\\\\policies\\\\microsoft\\\\systemcertificates\\\\root\\\\certificates\\\\* or *\\\\software\\\\microsoft\\\\enterprisecertificates\\\\root\\\\certificates\\\\* or *\\\\software\\\\microsoft\\\\systemcertificates\\\\ca\\\\certificates\\\\* or *\\\\software\\\\policies\\\\microsoft\\\\systemcertificates\\\\ca\\\\certificates\\\\* or *\\\\software\\\\microsoft\\\\enterprisecertificates\\\\ca\\\\certificates\\\\* or *\\\\software\\\\microsoft\\\\systemcertificates\\\\authroot\\\\certificates\\\\* or *\\\\software\\\\policies\\\\microsoft\\\\systemcertificates\\\\authroot\\\\certificates\\\\* or *\\\\software\\\\microsoft\\\\enterprisecertificates\\\\authroot\\\\certificates\\\\*) and winlog.event_data.targetobject:*\\\\blob and winlog.event_data.details:\"binary\\ data\")
<li><a href="#">query: (winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:(*\\\\software\\\\microsoft\\\\windows\\\\currentversion\\\\run* or *\\\\software\\\\microsoft\\\\windows\\\\currentversion\\\\runonce*) and winlog.event_data.details:*powershell*)
<li><a href="#">query: (winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:(*\\\\software\\\\policies\\\\microsoft\\\\windowsfirewall\\\\standardprofile\\\\enablefirewall or *\\\\software\\\\policies\\\\microsoft\\\\windowsfirewall\\\\domainprofile\\\\enablefirewall) and winlog.event_data.details:\"dword\\ \\(0x00000000\\)\")
<li><a href="#">query: (winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:(*\\\\sophos\\ endpoint\\ defense\\\\tamperprotection\\\\config\\\\savenabled* or *\\\\sophos\\ endpoint\\ defense\\\\tamperprotection\\\\config\\\\sedenabled* or *\\\\sophos\\\\savservice\\\\tamperprotection\\\\enabled*) and winlog.event_data.details:\"dword\\ \\(0x00000000\\)\")
<li><a href="#">query: (winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:(*software\\\\microsoft\\\\windows\\\\currentversion\\\\policies\\\\explorer\\\\nologoff or *software\\\\microsoft\\\\windows\\\\currentversion\\\\policies\\\\explorer\\\\nodesktop or *software\\\\microsoft\\\\windows\\\\currentversion\\\\policies\\\\explorer\\\\norun or *software\\\\microsoft\\\\windows\\\\currentversion\\\\policies\\\\explorer\\\\nofind or *software\\\\microsoft\\\\windows\\\\currentversion\\\\policies\\\\explorer\\\\nocontrolpanel or *software\\\\microsoft\\\\windows\\\\currentversion\\\\policies\\\\explorer\\\\nofilemenu or *software\\\\microsoft\\\\windows\\\\currentversion\\\\policies\\\\explorer\\\\noclose or *software\\\\microsoft\\\\windows\\\\currentversion\\\\policies\\\\explorer\\\\nosettaskbar or *software\\\\microsoft\\\\windows\\\\currentversion\\\\policies\\\\explorer\\\\nopropertiesmydocuments or *software\\\\microsoft\\\\windows\\\\currentversion\\\\policies\\\\explorer\\\\notraycontextmenu) and winlog.event_data.details:\"dword\\ \\(0x00000001\\)\")
<li><a href="#">query: (winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:(\"hklm\\\\software\\\\microsoft\\\\windows\\\\currentversion\\\\explorer\\\\advanced\\\\showsuperhidden\" or \"hklm\\\\software\\\\microsoft\\\\windows\\\\currentversion\\\\explorer\\\\advanced\\\\hidden\") and winlog.event_data.details:\"dword\\ \\(0x00000000\\)\")
<li><a href="#">query: (winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:(\"hklm\\\\software\\\\microsoft\\\\windows\\\\currentversion\\\\policies\\\\system\\\\localaccounttokenfilterpolicy\" or \"hklm\\\\software\\\\microsoft\\\\windows\\\\currentversion\\\\policies\\\\system\\\\enablelinkedconnections\" or \"hklm\\\\system\\\\currentcontrolset\\\\control\\\\filesystem\\\\longpathsenabled\") and winlog.event_data.details:\"dword\\ \\(0x00000001\\)\")
<li><a href="#">query: (winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:(hkcr\\\\clsid\\\\* or hkey_classes_root\\\\clsid\\\\* or hkcu\\\\software\\\\classes\\\\clsid\\\\* or hkey_current_user\\\\software\\\\classes\\\\clsid\\\\*) and winlog.event_data.targetobject:(*\\\\inprocserver32\\\\\\(default\\) or *\\\\localserver32\\\\\\(default\\)) and winlog.event_data.details:(*\\\\users\\\\public\\\\* or *\\\\desktop\\\\* or *\\\\appdata\\\\local\\\\temp\\\\* or *\\\\downloads\\\\* or *\\\\windows\\\\temp\\\\* or *\\\\microsoft\\\\windows\\\\start\\ menu\\\\programs\\\\startup\\\\* or *\\\\system32\\\\spool\\\\drivers\\\\color\\\\* or *%temp%* or *%tmp%* or *%appdata%*))
<li><a href="#">query: (winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:*\\\\appcompatflags\\\\compatibility\\ assistant\\\\store\\\\*)
<li><a href="#">query: (winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:*\\\\currentcontrolset\\\\services\\\\wercplsupport\\\\parameters\\\\servicedll)
<li><a href="#">query: (winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:*\\\\microsoft\\\\windows\\ defender\\\\exclusions*)
<li><a href="#">query: (winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:*\\\\microsoft\\\\windows\\ nt\\\\currentversion\\\\winlogon\\\\allowmultipletssessions and winlog.event_data.details:*dword\\ \\(0x00000001\\))
<li><a href="#">query: (winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:*\\\\microsoft\\\\windows\\\\currentversion\\\\winevt\\\\channels\\\\microsoft\\-windows\\-windows\\ defender\\/operational\\\\enabled* and winlog.event_data.details:\"dword\\ \\(0x00000000\\)\")
<li><a href="#">query: (winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:*\\\\open\\\\command\\\\delegateexecute and winlog.event_data.details:\"\\(empty\\)\")
<li><a href="#">query: (winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:*\\\\policies\\\\microsoft\\\\windows\\ defender\\\\puaprotection* and winlog.event_data.details:\"dword\\ \\(0x00000000\\)\")
<li><a href="#">query: (winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:*\\\\policies\\\\microsoft\\\\windows\\\\scripteddiagnostics\\\\turnoffcheck and winlog.event_data.details:\"dword\\ \\(0x00000001\\)\")
<li><a href="#">query: (winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:*\\\\root\\\\inventoryapplicationfile\\\\winsat.exe|* and winlog.event_data.targetobject:*\\\\lowercaselongpath and winlog.event_data.details:c\\:\\\\users\\\\* and winlog.event_data.details:*\\\\appdata\\\\local\\\\temp\\\\system32\\\\winsat.exe)
<li><a href="#">query: (winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:*\\\\services\\\\* and winlog.event_data.targetobject:*\\\\imagepath and winlog.event_data.details:(*powershell* or *pwsh*))
<li><a href="#">query: (winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:*\\\\services\\\\winsock2\\\\parameters\\\\autodialdll*)
<li><a href="#">query: (winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:*\\\\software\\\\* and winlog.event_data.targetobject:*\\\\microsoft\\\\office\\\\* and winlog.event_data.targetobject:*\\\\common\\\\security* and winlog.event_data.targetobject:*\\\\macroruntimescanscope and winlog.event_data.details:\"dword\\ \\(0x00000000\\)\")
<li><a href="#">query: (winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:*\\\\software\\\\microsoft\\\\office\\\\* and winlog.event_data.targetobject:(*vbawarnings or *disableinternetfilesinpv or *disableunsafelocationsinpv or *disableattachementsinpv) and winlog.event_data.details:\"dword\\ \\(0x00000001\\)\")
<li><a href="#">query: (winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:*\\\\software\\\\microsoft\\\\windows\\ nt\\\\currentversion\\\\appcompatflags\\\\compatibility\\ assistant\\\\store\\\\c\\:\\\\program\\ files\\\\windows\\ media\\ player\\\\osk.exe and winlog.event_data.details:\"binary\\ data\")
<li><a href="#">query: (winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:*\\\\software\\\\microsoft\\\\windows\\ nt\\\\currentversion\\\\schedule\\\\taskcache\\\\tree\\\\* and winlog.event_data.targetobject:*index* and winlog.event_data.details:\"dword\\ \\(0x00000000\\)\")
<li><a href="#">query: (winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:*\\\\software\\\\microsoft\\\\windows\\ nt\\\\currentversion\\\\winlogon\\\\mpnotify*)
<li><a href="#">query: (winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:*\\\\software\\\\microsoft\\\\windows\\ nt\\\\currentversion\\\\winlogon\\\\specialaccounts\\\\userlist* and winlog.event_data.details:\"dword\\ \\(0x00000000\\)\")
<li><a href="#">query: (winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:*\\\\software\\\\microsoft\\\\windows\\ nt\\\\currentversion\\\\winlogon\\\\specialaccounts\\\\userlist\\\\* and winlog.event_data.targetobject:*$ and winlog.event_data.details:\"dword\\ \\(0x00000000\\)\")
<li><a href="#">query: (winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:*\\\\software\\\\microsoft\\\\windows\\\\currentversion\\\\app\\ paths* and winlog.event_data.targetobject:(*\\(default\\) or *path) and winlog.event_data.details:(*\\\\users\\\\public* or *\\\\appdata\\\\local\\\\temp\\\\* or *\\\\windows\\\\temp\\\\* or *\\\\desktop\\\\* or *\\\\downloads\\\\* or *%temp%* or *%tmp%* or *iex* or *invoke\\-* or *rundll32* or *regsvr32* or *mshta* or *cscript* or *wscript* or *.bat* or *.hta* or *.dll* or *.ps1*))
<li><a href="#">query: (winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:*\\\\software\\\\microsoft\\\\windows\\\\currentversion\\\\app\\ paths* and winlog.event_data.targetobject:(*\\(default\\) or *path) and winlog.event_data.details:(*\\\\users\\\\public* or *\\\\appdata\\\\local\\\\temp\\\\* or *\\\\windows\\\\temp\\\\* or *\\\\desktop\\\\* or *\\\\downloads\\\\* or *%temp%* or *iex* or *invoke\\-* or *rundll32* or *regsvr32* or *mshta* or *cscript* or *wscript* or *.bat* or *.hta* or *.dll* or *.ps1*))
<li><a href="#">query: (winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:*\\\\software\\\\microsoft\\\\windows\\\\currentversion\\\\explorer\\\\mycomputer* and winlog.event_data.targetobject:*\\(default\\))
<li><a href="#">query: (winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:*\\\\software\\\\microsoft\\\\windows\\\\currentversion\\\\internet\\ settings\\\\zonemap\\\\domains\\\\*)
<li><a href="#">query: (winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:*\\\\software\\\\microsoft\\\\windows\\\\currentversion\\\\run* and winlog.event_data.details:(*powershell* or *pwsh\\ * or *frombase64string* or *.downloadfile\\(* or *.downloadstring\\(* or *\\ \\-w\\ hidden\\ * or *\\ \\-w\\ 1\\ * or *\\-windowstyle\\ hidden* or *\\-window\\ hidden* or *\\ \\-nop\\ * or *\\ \\-encodedcommand\\ * or *\\-executionpolicy\\ bypass* or *invoke\\-expression* or *iex\\ \\(* or *invoke\\-webrequest* or *iwr\\ * or *\\ \\-noni\\ * or *\\ \\-noninteractive\\ *))
<li><a href="#">query: (winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:*\\\\software\\\\microsoft\\\\windows\\\\windows\\ error\\ reporting\\\\hangs\\\\debugger*)
<li><a href="#">query: (winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:*\\\\system\\\\currentcontrolset\\\\control\\\\contentindex\\\\language\\\\* and winlog.event_data.targetobject:(*\\\\stemmerdllpathoverride* or *\\\\wbdllpathoverride* or *\\\\stemmerclass* or *\\\\wbreakerclass*))
<li><a href="#">query: (winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:*\\\\system\\\\currentcontrolset\\\\control\\\\lsaextensionconfig\\\\lsasrv\\\\extensions*)
<li><a href="#">query: (winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:*hklm\\\\software\\\\microsoft\\\\windows\\ defender\\\\features\\\\tamperprotection* and winlog.event_data.details:\"dword\\ \\(0\\)\")
<li><a href="#">query: (winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:*hklm\\\\software\\\\microsoft\\\\windows\\ nt\\\\currentversion\\\\appcompatflags\\\\telemetrycontroller\\\\* and winlog.event_data.details:(*.sh or *.exe or *.dll or *.bin or *.bat or *.cmd or *.js or *.ps or *.vb or *.jar or *.hta or *.msi or *.vbs))
<li><a href="#">query: (winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:*hklm\\\\software\\\\policies\\\\microsoft\\\\windows\\ defender\\ security\\ center\\\\app\\ and\\ browser\\ protection\\\\disallowexploitprotectionoverride* and winlog.event_data.details:\"dword\\ \\(00000001\\)\")
<li><a href="#">query: (winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:*hklm\\\\software\\\\policies\\\\microsoft\\\\windows\\ defender\\\\puaprotection* and winlog.event_data.details:\"dword\\ \\(0x00000000\\)\")
<li><a href="#">query: (winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:*inprocserver32\\\\\\(default\\) and winlog.event_data.details:\"c:\\windows\\system32\\scrobj.dll\")
<li><a href="#">query: (winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:*inprocserver32\\\\\\(default\\) and winlog.event_data.details:\"c\\:\\\\windows\\\\system32\\\\scrobj.dll\")
<li><a href="#">query: (winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:*microsoft\\\\windows\\ nt\\\\currentversion\\\\silentprocessexit* and winlog.event_data.details:*monitorprocess*)
<li><a href="#">query: (winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:*software\\\\microsoft\\\\.netframework\\\\etwenabled and winlog.event_data.details:\"dword\\ \\(0x00000000\\)\")
<li><a href="#">query: (winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:*software\\\\microsoft\\\\windows\\ defender\\\\windows\\ defender\\ exploit\\ guard\\\\controlled\\ folder\\ access\\\\allowedapplications* and winlog.event_data.targetobject:(*\\\\users\\\\public\\\\* or *\\\\appdata\\\\local\\\\temp\\\\* or *\\\\desktop\\\\* or *\\\\perflogs\\\\* or *\\\\windows\\\\temp\\\\*))
<li><a href="#">query: (winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:*software\\\\microsoft\\\\windows\\\\currentversion\\\\policies\\\\explorer\\\\disallowrun and winlog.event_data.details:\"dword\\ \\(0x00000001\\)\")
<li><a href="#">query: (winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:*software\\\\policies\\\\microsoft\\\\windows\\ defender\\ security\\ center\\\\app\\ and\\ browser\\ protection\\\\disallowexploitprotectionoverride* and winlog.event_data.details:\"dword\\ \\(00000001\\)\")
<li><a href="#">query: (winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:*software\\\\policies\\\\microsoft\\\\windows\\ defender\\\\ux\\ configuration\\\\notification_suppress and winlog.event_data.details:\"dword\\ \\(0x00000001\\)\")
<li><a href="#">query: (winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:*system\\\\currentcontrolset\\\\control\\\\terminal\\ server\\\\fallowtogethelp and winlog.event_data.details:\"dword\\ \\(0x00000001\\)\")
<li><a href="#">query: (winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:*wdigest\\\\uselogoncredential and winlog.event_data.details:\"dword\\ \\(0x00000001\\)\")
<li><a href="#">query: (winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:*windows\\\\currentversion\\\\immersiveshell\\\\useactioncenterexperience and winlog.event_data.details:\"dword\\ \\(0x00000000\\)\")
<li><a href="#">query: (winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:\"hkcu\\\\software\\\\classes\\\\folder\\\\shell\\\\open\\\\command\\\\delegateexecute\")
<li><a href="#">query: (winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:\"hkcu\\\\software\\\\microsoft\\\\office\\\\16.0\\\\outlook\\\\security\\\\level\" and winlog.event_data.details:*0x00000001*)
<li><a href="#">query: (winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:\"hklm\\\\software\\\\microsoft\\\\windows\\\\currentversion\\\\policies\\\\system\\\\enablelua\" and winlog.event_data.details:\"dword\\ \\(0x00000000\\)\")
<li><a href="#">query: (winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:\"hklm\\\\system\\\\currentcontrolset\\\\services\\\\windefend\\\\start\" and winlog.event_data.details:\"dword\\ \\(0x00000004\\)\")
<li><a href="#">query: (winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:hkcr\\\\ms\\-msdt\\\\*)
<li><a href="#">query: (winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:hklm\\\\software\\\\microsoft\\\\windows\\ nt\\\\currentversion\\\\ports* and winlog.event_data.details:(*.dll* or *.exe* or *.bat* or *.com* or *c\\:*))
<li><a href="#">query: (winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:hklm\\\\software\\\\microsoft\\\\windows\\\\currentversion\\\\run* and winlog.event_data.details:%appdata%\\\\roaming\\\\oracle\\\\bin\\\\*)
<li><a href="#">query: (winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:hklm\\\\system\\\\currentcontrolset\\\\* and winlog.event_data.targetobject:*\\\\instances\\\\sysmon\\ instance\\\\altitude)
<li><a href="#">query: (winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:hklm\\\\system\\\\currentcontrolset\\\\services\\\\* and ((winlog.event_data.targetobject:*\\\\start and process.executable:*\\\\temp\\\\* and winlog.event_data.details:(\"dword\\ \\(0x00000000\\)\" or \"dword\\ \\(0x00000001\\)\" or \"dword\\ \\(0x00000002\\)\")) or (winlog.event_data.targetobject:*\\\\imagepath and winlog.event_data.details:*\\\\temp\\\\*)))
<li><a href="#">query: (winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:hklm\\\\system\\\\currentcontrolset\\\\services\\\\* and winlog.event_data.targetobject:*\\\\parameters\\\\servicedll)
<li><a href="#">query: (winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:hklm\\\\system\\\\currentcontrolset\\\\services\\\\lanmanserver\\\\parameters\\\\* and winlog.event_data.targetobject:(*autosharewks or *autoshareserver) and winlog.event_data.details:\"dword\\ \\(0x00000000\\)\")
<li><a href="#">query: (winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:hklm\\\\system\\\\currentcontrolset\\\\services\\\\sharedaccess\\\\parameters\\\\firewallpolicy\\\\* and winlog.event_data.targetobject:*\\\\enablefirewall and winlog.event_data.details:\"dword\\ \\(0x00000000\\)\")
<li><a href="#">query: (winlog.event_data.hashes:(*md5\\=9ab9f3b75a2eb87fafb1b7361be9dfb3* or *md5\\=c832a4313ff082258240b61b88efa025* or *sha1\\=fe10018af723986db50701c8532df5ed98b17c39* or *sha1\\=1f1ce28c10453acbc9d3844b4604c59c0ab0ad46* or *sha256\\=31f4cfb4c71da44120752721103a16512444c13c2ac2d857a7e6f13cb679b427* or *sha256\\=cfc5c585dd4e592dd1a08887ded28b92d9a5820587b6f4f8fa4f56d60289259b*) or md5:(\"9ab9f3b75a2eb87fafb1b7361be9dfb3\" or \"c832a4313ff082258240b61b88efa025\") or sha1:(\"fe10018af723986db50701c8532df5ed98b17c39\" or \"1f1ce28c10453acbc9d3844b4604c59c0ab0ad46\") or sha256:(\"31f4cfb4c71da44120752721103a16512444c13c2ac2d857a7e6f13cb679b427\" or \"cfc5c585dd4e592dd1a08887ded28b92d9a5820587b6f4f8fa4f56d60289259b\"))
<li><a href="#">query: (winlog.event_data.hashes:(*md5\\=9ab9f3b75a2eb87fafb1b7361be9dfb3* or *sha1\\=fe10018af723986db50701c8532df5ed98b17c39* or *sha256\\=31f4cfb4c71da44120752721103a16512444c13c2ac2d857a7e6f13cb679b427*) or md5:\"9ab9f3b75a2eb87fafb1b7361be9dfb3\" or sha1:\"fe10018af723986db50701c8532df5ed98b17c39\" or sha256:\"31f4cfb4c71da44120752721103a16512444c13c2ac2d857a7e6f13cb679b427\")
<li><a href="#">query: (winlog.event_data.hashes:(*sha256\\=f05b1ee9e2f6ab704b8919d5071becbce6f9d0f9d0ba32a460c41d5272134abe* or *sha1\\=b89a8eef5aeae806af5ba212a8068845cafdab6f* or *md5\\=b941c8364308990ee4cc6eadf7214e0f*) or sha256:\"f05b1ee9e2f6ab704b8919d5071becbce6f9d0f9d0ba32a460c41d5272134abe\" or sha1:\"b89a8eef5aeae806af5ba212a8068845cafdab6f\" or md5:\"b941c8364308990ee4cc6eadf7214e0f\")
<li><a href="#">query: (winlog.event_data.hashes:*6834b1b94e49701d77ccb3c0895e1afd* and (not (process.executable:*\\\\dctask64.exe)))
<li><a href="#">query: (winlog.event_data.hashes:*imphash\\=* and (not (winlog.event_data.hashes:*imphash\\=00000000000000000000000000000000*)))
<li><a href="#">query: (winlog.event_data.hashes:*imphash\\=330768a4f172e10acb6287b87289d83b* or winlog.event_data.imphash:\"330768a4f172e10acb6287b87289d83b\")
<li><a href="#">query: (winlog.event_data.initiated:\"true\" and destination.domain:(*.github.com or *.githubusercontent.com) and process.executable:c\\:\\\\windows\\\\*)
<li><a href="#">query: (winlog.event_data.initiated:\"true\" and destination.domain:(*dl.dropboxusercontent.com or *.pastebin.com or *.githubusercontent.com or *cdn.discordapp.com\\/attachments\\/ or *mediafire.com or *mega.nz or *ddns.net or *.paste.ee or *.hastebin.com\\/raw\\/ or *.ghostbin.co\\/ or *ufile.io) and process.executable:(c\\:\\\\windows\\\\* or c\\:\\\\users\\\\public\\\\*))
<li><a href="#">query: (winlog.event_data.initiated:\"true\" and destination.domain:(*dl.dropboxusercontent.com or *.pastebin.com or *.githubusercontent.com) and process.executable:c\\:\\\\windows\\\\*)
<li><a href="#">query: (winlog.event_data.initiated:\"true\" and destination.domain:*api.mega.co.nz)
<li><a href="#">query: (winlog.event_data.initiated:\"true\" and destination.domain:\"ovz1.j19544519.pr46m.vps.myjino.ru\")
<li><a href="#">query: (winlog.event_data.initiated:\"true\" and process.executable.text:(*\\\\wscript.exe or *\\\\cscript.exe))
<li><a href="#">query: (winlog.event_data.initiated:\"true\" and process.executable:*\\\\imewdbld.exe)
<li><a href="#">query: (winlog.event_data.initiated:\"true\" and process.executable:*\\\\msiexec.exe)
<li><a href="#">query: (winlog.event_data.initiated:\"true\" and process.executable:*python*)
<li><a href="#">query: (winlog.event_data.originalfilename:(\"cmd.exe\" or \"conhost.exe\" or \"powershell.exe\" or \"powershell_ise.exe\" or \"psexec.exe\" or \"psexec.c\" or \"cscript.exe\" or \"wscript.exe\" or \"mshta.exe\" or \"regsvr32.exe\" or \"wmic.exe\" or \"certutil.exe\" or \"rundll32.exe\" or \"cmstp.exe\" or \"msiexec.exe\" or \"7z.exe\" or \"winrar.exe\" or \"wevtutil.exe\" or \"net.exe\" or \"net1.exe\" or \"netsh.exe\") and (not (process.executable:(*\\\\cmd.exe or *\\\\conhost.exe or *\\\\powershell.exe or *\\\\powershell_ise.exe or *\\\\psexec.exe or *\\\\psexec64.exe or *\\\\cscript.exe or *\\\\wscript.exe or *\\\\mshta.exe or *\\\\regsvr32.exe or *\\\\wmic.exe or *\\\\certutil.exe or *\\\\rundll32.exe or *\\\\cmstp.exe or *\\\\msiexec.exe or *\\\\7z.exe or *\\\\winrar.exe or *\\\\wevtutil.exe or *\\\\net.exe or *\\\\net1.exe or *\\\\netsh.exe))))
<li><a href="#">query: (winlog.event_data.originalfilename:(\"cmd.exe\" or \"conhost.exe\" or \"powershell.exe\" or \"pwsh.dll\" or \"powershell_ise.exe\" or \"psexec.exe\" or \"psexec.c\" or \"cscript.exe\" or \"wscript.exe\" or \"mshta.exe\" or \"regsvr32.exe\" or \"wmic.exe\" or \"certutil.exe\" or \"rundll32.exe\" or \"cmstp.exe\" or \"msiexec.exe\" or \"7z.exe\" or \"winrar.exe\" or \"wevtutil.exe\" or \"net.exe\" or \"net1.exe\" or \"netsh.exe\" or \"installutil.exe\") and (not (process.executable.text:(*\\\\cmd.exe or *\\\\conhost.exe or *\\\\powershell.exe or *\\\\pwsh.exe or *\\\\powershell_ise.exe or *\\\\psexec.exe or *\\\\psexec64.exe or *\\\\cscript.exe or *\\\\wscript.exe or *\\\\mshta.exe or *\\\\regsvr32.exe or *\\\\wmic.exe or *\\\\certutil.exe or *\\\\rundll32.exe or *\\\\cmstp.exe or *\\\\msiexec.exe or *\\\\7z.exe or *\\\\winrar.exe or *\\\\wevtutil.exe or *\\\\net.exe or *\\\\net1.exe or *\\\\netsh.exe or *\\\\installutil.exe))))
<li><a href="#">query: (winlog.event_data.originalfilename:(\"powershell.exe\" or \"powershell_ise.exe\" or \"psexec.exe\" or \"psexec.c\" or \"cscript.exe\" or \"wscript.exe\" or \"mshta.exe\" or \"regsvr32.exe\" or \"wmic.exe\" or \"certutil.exe\" or \"rundll32.exe\" or \"cmstp.exe\" or \"msiexec.exe\") and (not (process.executable:(*\\\\powershell.exe or *\\\\powershell_ise.exe or *\\\\psexec.exe or *\\\\psexec64.exe or *\\\\cscript.exe or *\\\\wscript.exe or *\\\\mshta.exe or *\\\\regsvr32.exe or *\\\\wmic.exe or *\\\\certutil.exe or *\\\\rundll32.exe or *\\\\cmstp.exe or *\\\\msiexec.exe))))
<li><a href="#">query: (winlog.event_data.originalfilename:(\"powershell.exe\" or \"pwsh.dll\" or \"powershell_ise.exe\" or \"psexec.exe\" or \"psexec.c\" or \"cscript.exe\" or \"wscript.exe\" or \"mshta.exe\" or \"regsvr32.exe\" or \"wmic.exe\" or \"certutil.exe\" or \"rundll32.exe\" or \"cmstp.exe\" or \"msiexec.exe\") and (not (process.executable:(*\\\\powershell.exe or *\\\\pwsh.exe or *\\\\powershell_ise.exe or *\\\\psexec.exe or *\\\\psexec64.exe or *\\\\cscript.exe or *\\\\wscript.exe or *\\\\mshta.exe or *\\\\regsvr32.exe or *\\\\wmic.exe or *\\\\certutil.exe or *\\\\rundll32.exe or *\\\\cmstp.exe or *\\\\msiexec.exe))))
<li><a href="#">query: (winlog.event_data.originalfilename:\"advancedrun.exe\" or (process.command_line:*\\ \\/exefilename\\ * and process.command_line:*\\ \\/run*) or (process.command_line:*\\ \\/windowstate\\ 0* and process.command_line:*\\ \\/runas\\ * and process.command_line:*\\ \\/commandline\\ *))
<li><a href="#">query: (winlog.event_data.originalfilename:\"browsercore.exe\" and (not ((process.executable:*\\\\browsercore.exe))))
<li><a href="#">query: (winlog.event_data.originalfilename:\"dirlister.exe\" or process.executable.text:*\\\\dirlister.exe)
<li><a href="#">query: (winlog.event_data.originalfilename:\"ftp.exe\" and (not (process.executable.text:*\\\\ftp.exe)))
<li><a href="#">query: (winlog.event_data.originalfilename:\"mpcmdrun.exe\" and process.command_line.text:*\\ \\-removedefinitions* and process.command_line.text:*\\ \\-all*)
<li><a href="#">query: (winlog.event_data.originalfilename:\"mpcmdrun.exe\" and process.command_line:*\\ \\-removedefinitions* and process.command_line:*\\ \\-all*)
<li><a href="#">query: (winlog.event_data.originalfilename:\"msdt.exe\" and (not ((process.executable:*\\\\msdt.exe))))
<li><a href="#">query: (winlog.event_data.originalfilename:\"psservice.exe\" or process.executable:(*\\\\psservice.exe or *\\\\psservice64.exe))
<li><a href="#">query: (winlog.event_data.originalfilename:\"rdrleakdiag.exe\" and process.command_line.text:*fullmemdmp*)
<li><a href="#">query: (winlog.event_data.originalfilename:\"rdrleakdiag.exe\" and process.command_line:*fullmemdmp*)
<li><a href="#">query: (winlog.event_data.originalfilename:\"sdelete.exe\" and (not (process.command_line.text:(*\\ \\-h* or *\\ \\-c* or *\\ \\-z* or *\\ \\/\\?*))))
<li><a href="#">query: (winlog.event_data.originalfilename:\"sdelete.exe\" and (not (process.command_line:(*\\ \\-h* or *\\ \\-c* or *\\ \\-z* or *\\ \\/?*))))
<li><a href="#">query: (winlog.event_data.originalfilename:\"sdelete.exe\" and (not (process.executable.text:(*\\\\sdelete.exe or *\\\\sdelete64.exe))))
<li><a href="#">query: (winlog.event_data.originalfilename:\"sharpview.exe\" or process.command_line:(*get\\-domaingpouserlocalgroupmapping* or *find\\-gpolocation* or *get\\-domaingpocomputerlocalgroupmapping* or *find\\-gpocomputeradmin* or *get\\-domainobjectacl* or *get\\-objectacl* or *add\\-domainobjectacl* or *add\\-objectacl* or *remove\\-domainobjectacl* or *get\\-regloggedon* or *get\\-loggedonlocal* or *get\\-netrdpsession* or *test\\-adminaccess* or *invoke\\-checklocaladminaccess* or *get\\-wmiprocess* or *get\\-netprocess* or *get\\-wmiregproxy* or *get\\-proxy* or *get\\-wmireglastloggedon* or *get\\-lastloggedon* or *get\\-wmiregcachedrdpconnection* or *get\\-cachedrdpconnection* or *get\\-wmiregmounteddrive* or *get\\-registrymounteddrive* or *find\\-interestingdomainacl* or *invoke\\-aclscanner* or *get\\-netshare* or *get\\-netloggedon* or *get\\-netlocalgroup* or *get\\-netlocalgroupmember* or *get\\-netsession* or *get\\-pathacl* or *convertfrom\\-uacvalue* or *get\\-principalcontext* or *new\\-domaingroup* or *new\\-domainuser* or *add\\-domaingroupmember* or *set\\-domainuserpassword* or *invoke\\-kerberoast* or *export\\-powerviewcsv* or *find\\-localadminaccess* or *find\\-domainlocalgroupmember* or *find\\-domainshare* or *find\\-domainuserevent* or *find\\-domainprocess* or *find\\-domainuserlocation* or *find\\-interestingfile* or *find\\-interestingdomainsharefile* or *find\\-domainobjectpropertyoutlier* or *testmethod* or *get\\-domain* or *get\\-netdomain* or *get\\-domaincomputer* or *get\\-netcomputer* or *get\\-domaincontroller* or *get\\-netdomaincontroller* or *get\\-domainfileserver* or *get\\-netfileserver* or *convert\\-adname* or *get\\-domainobject* or *get\\-adobject* or *get\\-domainuser* or *get\\-netuser* or *get\\-domaingroup* or *get\\-netgroup* or *get\\-domaindfsshare* or *get\\-dfsshare* or *get\\-domaindnsrecord* or *get\\-dnsrecord* or *get\\-domaindnszone* or *get\\-dnszone* or *get\\-domainforeigngroupmember* or *find\\-foreigngroup* or *get\\-domainforeignuser* or *find\\-foreignuser* or *convertfrom\\-sid* or *convert\\-sidtoname* or *get\\-domaingroupmember* or *get\\-netgroupmember* or *get\\-domainmanagedsecuritygroup* or *find\\-managedsecuritygroups* or *get\\-domainou* or *get\\-netou* or *get\\-domainsid* or *get\\-forest* or *get\\-netforest* or *get\\-foresttrust* or *get\\-netforesttrust* or *get\\-domaintrust* or *get\\-netdomaintrust* or *get\\-forestdomain* or *get\\-netforestdomain* or *get\\-domainsite* or *get\\-netsite* or *get\\-domainsubnet* or *get\\-netsubnet* or *get\\-domaintrustmapping* or *invoke\\-mapdomaintrust* or *get\\-forestglobalcatalog* or *get\\-netforestcatalog* or *get\\-domainuserevent* or *get\\-userevent* or *get\\-domainguidmap* or *get\\-guidmap* or *resolve\\-ipaddress* or *get\\-ipaddress* or *convertto\\-sid* or *invoke\\-userimpersonation* or *invoke\\-reverttoself* or *get\\-domainspnticket* or *request\\-spnticket* or *get\\-netcomputersitename* or *get\\-sitename* or *get\\-domaingpo* or *get\\-netgpo* or *set\\-domainobject* or *set\\-adobject* or *add\\-remoteconnection* or *remove\\-remoteconnection* or *get\\-inicontent* or *get\\-gpttmpl* or *get\\-groupsxml* or *get\\-domainpolicydata* or *get\\-domainpolicy* or *get\\-domaingpolocalgroup* or *get\\-netgpogroup*))
<li><a href="#">query: (winlog.event_data.originalfilename:\"sharpview.exe\" or process.executable.text:*\\\\sharpview.exe or process.command_line.text:(*get\\-domaingpouserlocalgroupmapping* or *find\\-gpolocation* or *get\\-domaingpocomputerlocalgroupmapping* or *find\\-gpocomputeradmin* or *get\\-domainobjectacl* or *add\\-domainobjectacl* or *add\\-objectacl* or *remove\\-domainobjectacl* or *get\\-regloggedon* or *get\\-loggedonlocal* or *get\\-netrdpsession* or *test\\-adminaccess* or *invoke\\-checklocaladminaccess* or *get\\-wmiprocess* or *get\\-netprocess* or *get\\-wmiregproxy* or *get\\-wmireglastloggedon* or *get\\-lastloggedon* or *get\\-wmiregcachedrdpconnection* or *get\\-cachedrdpconnection* or *get\\-wmiregmounteddrive* or *get\\-registrymounteddrive* or *find\\-interestingdomainacl* or *invoke\\-aclscanner* or *get\\-netshare* or *get\\-netloggedon* or *get\\-netlocalgroup* or *get\\-netlocalgroupmember* or *get\\-netsession* or *get\\-pathacl* or *convertfrom\\-uacvalue* or *get\\-principalcontext* or *new\\-domaingroup* or *new\\-domainuser* or *add\\-domaingroupmember* or *set\\-domainuserpassword* or *invoke\\-kerberoast* or *export\\-powerviewcsv* or *find\\-localadminaccess* or *find\\-domainlocalgroupmember* or *find\\-domainshare* or *find\\-domainuserevent* or *find\\-domainprocess* or *find\\-domainuserlocation* or *find\\-interestingfile* or *find\\-interestingdomainsharefile* or *find\\-domainobjectpropertyoutlier* or *get\\-netdomain* or *get\\-domaincomputer* or *get\\-netcomputer* or *get\\-domaincontroller* or *get\\-netdomaincontroller* or *get\\-domainfileserver* or *get\\-netfileserver* or *convert\\-adname* or *get\\-domainobject* or *get\\-adobject* or *get\\-domainuser* or *get\\-netuser* or *get\\-domaingroup* or *get\\-domaindfsshare* or *get\\-dfsshare* or *get\\-domaindnsrecord* or *get\\-domainforeigngroupmember* or *find\\-foreigngroup* or *get\\-domainforeignuser* or *find\\-foreignuser* or *convertfrom\\-sid* or *convert\\-sidtoname* or *get\\-domaingroupmember* or *get\\-netgroupmember* or *get\\-domainmanagedsecuritygroup* or *find\\-managedsecuritygroups* or *get\\-domainou* or *get\\-netou* or *get\\-domainsid* or *get\\-netforest* or *get\\-foresttrust* or *get\\-netforesttrust* or *get\\-domaintrust* or *get\\-netdomaintrust* or *get\\-forestdomain* or *get\\-netforestdomain* or *get\\-domainsite* or *get\\-netsite* or *get\\-domainsubnet* or *get\\-netsubnet* or *get\\-domaintrustmapping* or *invoke\\-mapdomaintrust* or *get\\-forestglobalcatalog* or *get\\-netforestcatalog* or *get\\-domainuserevent* or *get\\-domainguidmap* or *resolve\\-ipaddress* or *convertto\\-sid* or *invoke\\-userimpersonation* or *get\\-domainspnticket* or *request\\-spnticket* or *get\\-netcomputersitename* or *get\\-domaingpo* or *get\\-netgpo* or *set\\-domainobject* or *add\\-remoteconnection* or *remove\\-remoteconnection* or *get\\-gpttmpl* or *get\\-groupsxml* or *get\\-domainpolicydata* or *get\\-domainpolicy* or *get\\-domaingpolocalgroup* or *get\\-netgpogroup* or *invoke\\-sharefinder*))
<li><a href="#">query: (winlog.event_data.originalfilename:\"trufflesnout.exe\" or process.executable.text:*\\\\trufflesnout.exe)
<li><a href="#">query: (winlog.event_data.originalfilename:\"whoami.exe\" and (not (process.executable.text:*\\\\whoami.exe)))
<li><a href="#">query: (winlog.event_data.originalfilename:\"whoami.exe\" and (not (process.executable:*\\\\whoami.exe)))
<li><a href="#">query: (winlog.event_data.signature:(htool* or hktl* or securitytool* or atk\\/*) or winlog.event_data.signature:*hacktool*)
<li><a href="#">query: (winlog.event_data.startmodule:*\\\\kernel32.dll and startfunction:\"loadlibrarya\")
<li><a href="#">query: (winlog.event_data.status:\"success\" and (not (location:*<countries\\ you\\ do\\ operate\\ out\\ of\\ e,g\\ gb,\\ use\\ or\\ for\\ mulitple>*)))
<li><a href="#">query: (winlog.event_data.status:\"success\" and appid:\"insert\\ application\\ id\\ use\\ or\\ for\\ multiple\" and authenticationrequirement:\"singlefactorauthentication\")
<li><a href="#">query: (winlog.event_data.status:\"success\" and authenticationrequirement:\"singlefactorauthentication\")
<li><a href="#">query: (winlog.event_data.status:\"success\" and count:\"<10%\")
<li><a href="#">query: (winlog.event_data.targetimage:(*\\\\mspaint.exe or *\\\\calc.exe or *\\\\notepad.exe or *\\\\sethc.exe or *\\\\write.exe or *\\\\wordpad.exe or *\\\\explorer.exe) and (not ((startfunction:\"etwpnotificationthread\") or (process.executable.text:(c\\:\\\\program\\ files\\\\* or c\\:\\\\program\\ files\\ \\(x86\\)\\\\*)))))
<li><a href="#">query: (winlog.event_data.targetimage:(*\\\\spoolsv.exe or *\\\\notepad.exe) and (not (process.executable.text:*\\\\csrss.exe or process.executable.text:*unknown\\ process* or startfunction:\"etwpnotificationthread\")))
<li><a href="#">query: (winlog.event_data.targetimage:*\\\\lsass.exe and process.executable.text:\"c\\:\\\\windows\\\\system32\\\\rundll32.exe\" and winlog.event_data.calltrace:*comsvcs.dll*)
<li><a href="#">query: (winlog.event_data.targetimage:*\\\\lsass.exe and process.executable:(*\\\\trolleyexpress.exe or *\\\\processdump.exe or *\\\\dump64.exe) and winlog.event_data.grantedaccess:(*10 or *30 or *50 or *70 or *90 or *b0 or *d0 or *f0 or *18 or *38 or *58 or *78 or *98 or *b8 or *d8 or *f8 or *1a or *3a or *5a or *7a or *9a or *ba or *da or *fa or *0x14c2 or *ff))
<li><a href="#">query: (winlog.event_data.targetimage:*\\\\lsass.exe and process.executable:*dump* and winlog.event_data.grantedaccess:(*10 or *30 or *50 or *70 or *90 or *b0 or *d0 or *f0 or *18 or *38 or *58 or *78 or *98 or *b8 or *d8 or *f8 or *1a or *3a or *5a or *7a or *9a or *ba or *da or *fa or *0x14c2 or *ff))
<li><a href="#">query: (winlog.event_data.targetimage:*\\\\lsass.exe and process.executable:\"c\\:\\\\windows\\\\system32\\\\rundll32.exe\" and winlog.event_data.calltrace:*comsvcs.dll*)
<li><a href="#">query: (winlog.event_data.targetimage:*\\\\lsass.exe and process.executable:\"c\\:\\\\windows\\\\system32\\\\wsmprovhost.exe\")
<li><a href="#">query: (winlog.event_data.targetimage:*\\\\lsass.exe and winlog.event_data.calltrace:*c\\:\\\\windows\\\\system32\\\\ntdll.dll\\+* and winlog.event_data.calltrace:*|c\\:\\\\windows\\\\system32\\\\kernelbase.dll\\+* and winlog.event_data.calltrace:*_ctypes.pyd\\+* and winlog.event_data.calltrace:*python27.dll\\+* and winlog.event_data.grantedaccess:\"0x1fffff\")
<li><a href="#">query: (winlog.event_data.targetimage:*\\\\lsass.exe and winlog.event_data.calltrace:*c\\:\\\\windows\\\\system32\\\\ntdll.dll\\+* and winlog.event_data.calltrace:*c\\:\\\\windows\\\\system32\\\\kernelbase.dll\\+* and winlog.event_data.calltrace:*libffi\\-7.dll* and winlog.event_data.calltrace:*_ctypes.pyd\\+* and winlog.event_data.calltrace:*python3*.dll\\+* and winlog.event_data.grantedaccess:\"0x1fffff\")
<li><a href="#">query: (winlog.event_data.targetimage:*\\\\lsass.exe and winlog.event_data.grantedaccess:(*0x1038* or *0x40* or *0x1438* or *0x143a*) and winlog.event_data.calltrace:(*dbghelp.dll* or *dbgcore.dll* or *ntdll.dll*))
<li><a href="#">query: (winlog.event_data.targetimage:*\\\\lsass.exe and winlog.event_data.startmodule:\"\")
<li><a href="#">query: (winlog.event_data.targetimage:*\\\\windows\\\\system32\\\\svchost.exe and winlog.event_data.grantedaccess:\"0x1f3fff\" and winlog.event_data.calltrace:*unknown*)
<li><a href="#">query: (winlog.event_data.targetobject:(*\\\\currentcontrolset\\\\services\\\\ntds\\\\directoryserviceextpt* or *\\\\currentcontrolset\\\\services\\\\ntds\\\\lsadbextpt*) and (not ((process.executable:\"c\\:\\\\windows\\\\system32\\\\lsass.exe\" and winlog.event_data.details:(\"%%systemroot%%\\\\system32\\\\ntdsa.dll\" or \"%%systemroot%%\\\\system32\\\\lsadb.dll\")))))
<li><a href="#">query: (winlog.event_data.targetobject:(*\\\\fdenytsconnections or *\\\\fsinglesessionperuser or *\\\\userauthentication) and winlog.event_data.details:\"dword\\ \\(0x00000000\\)\")
<li><a href="#">query: (winlog.event_data.targetobject:(*\\\\software\\\\microsoft\\\\office\\\\* or *\\\\outlook\\\\webview\\\\*) and winlog.event_data.targetobject:*\\\\url and winlog.event_data.targetobject:(*\\\\calendar\\\\* or *\\\\inbox\\\\*))
<li><a href="#">query: (winlog.event_data.targetobject:(*clsid\\\\\\{cf4cc405\\-e2c5\\-4ddd\\-b3ce\\-5e7582d8c9fa\\}\\\\inprocserver32\\\\\\(default\\) or *clsid\\\\\\{7c857801\\-7381\\-11cf\\-884d\\-00aa004b2e24\\}\\\\inprocserver32\\\\\\(default\\)) and (not (winlog.event_data.details:(*system32\\\\wbem\\\\wmiutils.dll or *system32\\\\wbem\\\\wbemsvc.dll))))
<li><a href="#">query: (winlog.event_data.targetobject:(*software\\\\microsoft\\\\office\\\\* or *\\\\outlook\\\\today\\\\*) and ((winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:*stamp and winlog.event_data.details:\"dword\\ \\(0x00000001\\)\") or winlog.event_data.targetobject:*userdefinedurl))
<li><a href="#">query: (winlog.event_data.targetobject:(*software\\\\microsoft\\\\windows\\ nt\\\\currentversion\\\\accessibility\\\\ats* or *software\\\\microsoft\\\\windows\\ nt\\\\currentversion\\\\accessibility\\\\configuration*) and (not (process.executable.text:\"c\\:\\\\windows\\\\system32\\\\atbroker.exe\" and winlog.event_data.targetobject:*\\\\microsoft\\\\windows\\ nt\\\\currentversion\\\\accessibility\\\\configuration* and winlog.event_data.details:\"\\(empty\\)\")))
<li><a href="#">query: (winlog.event_data.targetobject:(\"hklm\\\\hardware\\\\\\{804423c2\\-f490\\-4ac3\\-bfa5\\-13dede63a71a\\}\" or \"hklm\\\\hardware\\\\\\{a5124af5\\-df23\\-49bf\\-b0ed\\-a18ed3dea027\\}\" or \"hklm\\\\hardware\\\\\\{2db80286\\-1784\\-48b5\\-a751\\-b6ed1f490303\\}\") or winlog.event_data.targetobject:hklm\\\\system\\\\setup\\\\printresponsor\\\\*)
<li><a href="#">query: (winlog.event_data.targetobject:(\"hklm\\\\system\\\\currentcontrolset\\\\control\\\\lsa\\\\security\\ packages\" or \"hklm\\\\system\\\\currentcontrolset\\\\control\\\\lsa\\\\osconfig\\\\security\\ packages\") and (not (process.executable:\"c\\:\\\\windows\\\\system32\\\\msiexec.exe\" or process.executable:\"c\\:\\\\windows\\\\syswow64\\\\msiexec.exe\")))
<li><a href="#">query: (winlog.event_data.targetobject:*\\\\control\\ panel\\\\desktop\\\\scrnsave.exe and (not (process.executable:(*\\\\rundll32.exe or *\\\\explorer.exe))))
<li><a href="#">query: (winlog.event_data.targetobject:*\\\\environment\\\\windir and winlog.event_data.details:*&rem* and winlog.event_data.eventtype:\"setvalue\")
<li><a href="#">query: (winlog.event_data.targetobject:*\\\\microsoft\\\\windows\\ nt\\\\currentversion\\\\* and ((winlog.event_data.targetobject:*\\\\image\\ file\\ execution\\ options\\\\* and winlog.event_data.targetobject:*\\\\globalflag*) or (winlog.event_data.targetobject:*silentprocessexit\\\\* and winlog.event_data.targetobject:*\\\\reportingmode*) or (winlog.event_data.targetobject:*silentprocessexit\\\\* and winlog.event_data.targetobject:*\\\\monitorprocess*)))
<li><a href="#">query: (winlog.event_data.targetobject:*\\\\microsoft\\\\windows\\ nt\\\\currentversion\\\\* and winlog.event_data.targetobject:*\\\\image\\ file\\ execution\\ options\\\\* and winlog.event_data.targetobject:*\\\\globalflag* and winlog.event_data.targetobject:*\\\\microsoft\\\\windows\\ nt\\\\currentversion\\\\* and winlog.event_data.targetobject:*\\\\silentprocessexit\\\\* and winlog.event_data.targetobject:(*\\\\reportingmode* or *\\\\monitorprocess*))
<li><a href="#">query: (winlog.event_data.targetobject:*\\\\sam\\\\sam\\\\domains\\\\account\\\\users\\\\names\\\\* and winlog.event_data.targetobject:*$ and process.executable.text:*\\\\lsass.exe)
<li><a href="#">query: (winlog.event_data.targetobject:*\\\\services\\\\hybridconnectionmanager* or (winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.details:*microsoft.hybridconnectionmanager.listener.exe*))
<li><a href="#">query: (winlog.event_data.targetobject:*\\\\software\\\\appdatalow\\\\software\\\\microsoft\\\\* and (not (winlog.event_data.targetobject:(*\\\\software\\\\appdatalow\\\\software\\\\microsoft\\\\internet\\ explorer\\\\* or *\\\\software\\\\appdatalow\\\\software\\\\microsoft\\\\repservice\\\\* or *\\\\software\\\\appdatalow\\\\software\\\\microsoft\\\\ime\\\\* or *\\\\software\\\\appdatalow\\\\software\\\\microsoft\\\\edge\\\\*))))
<li><a href="#">query: (winlog.event_data.targetobject:*\\\\software\\\\microsoft\\\\office\\\\* and winlog.event_data.targetobject:*\\\\outlook\\\\security\\\\* and winlog.event_data.eventtype:\"setvalue\")
<li><a href="#">query: (winlog.event_data.targetobject:*\\\\software\\\\microsoft\\\\windows\\ nt\\\\currentversion* and ((winlog.event_data.targetobject:*\\\\image\\ file\\ execution\\ options\\\\* and winlog.event_data.targetobject:*\\\\globalflag*) or (winlog.event_data.targetobject:*silentprocessexit\\\\* and winlog.event_data.targetobject:*\\\\reportingmode*) or (winlog.event_data.targetobject:*silentprocessexit\\\\* and winlog.event_data.targetobject:*\\\\monitorprocess*)))
<li><a href="#">query: (winlog.event_data.targetobject:*\\\\software\\\\microsoft\\\\windows\\ nt\\\\currentversion\\\\winlogon\\\\notify\\\\logon and winlog.event_data.details:*.dll and winlog.event_data.eventtype:\"setvalue\")
<li><a href="#">query: (winlog.event_data.targetobject:*\\\\software\\\\microsoft\\\\windows\\\\currentversion\\\\capabilityaccessmanager\\\\consentstore\\\\* and winlog.event_data.targetobject:*\\\\nonpackaged* and winlog.event_data.targetobject:(*microphone* or *webcam*) and winlog.event_data.targetobject:(*\\:#windows#temp#* or *\\:#$recycle.bin#* or *\\:#temp#* or *\\:#users#public#* or *\\:#users#default#* or *\\:#users#desktop#*))
<li><a href="#">query: (winlog.event_data.targetobject:*classes\\\\.* and winlog.event_data.details:\"exefile\" and winlog.event_data.eventtype:\"setvalue\")
<li><a href="#">query: (winlog.event_data.targetobject:*shell\\\\open\\\\command\\\\* and winlog.event_data.details:*powershell* and winlog.event_data.details:*\\-command* and winlog.event_data.eventtype:\"setvalue\")
<li><a href="#">query: (winlog.event_data.targetobject:*software\\\\classes\\\\exefile\\\\shell\\\\runas\\\\command\\\\isolatedcommand or (winlog.event_data.eventtype:\"setvalue\" and winlog.event_data.targetobject:*software\\\\classes\\\\folder\\\\shell\\\\open\\\\command\\\\symboliclinkvalue and winlog.event_data.details:*\\-1???\\\\software\\\\classes\\\\*))
<li><a href="#">query: (winlog.event_data.targetobject:*software\\\\microsoft\\\\windows\\ nt\\\\currentversion\\\\accessibility\\\\ats* or winlog.event_data.targetobject:*software\\\\microsoft\\\\windows\\ nt\\\\currentversion\\\\accessibility\\\\configuration*)
<li><a href="#">query: (winlog.event_data.targetobject:*system\\\\* and winlog.event_data.targetobject:*controlset* and winlog.event_data.targetobject:*\\\\control\\\\lsa* and winlog.event_data.targetobject:(*\\\\lmcompatibilitylevel or *\\\\ntlmminclientsec or *\\\\restrictsendingntlmtraffic))
<li><a href="#">query: (winlog.event_data.targetobject:*system\\\\currentcontrolset\\\\control\\\\crashcontrol* and winlog.event_data.details:\"dword\\ \\(0x00000000\\)\")
<li><a href="#">query: (winlog.event_data.targetobject:\"hkcu\\\\software\\\\classes\\\\clsid\\\\\\{e08a0f4b\\-1f65\\-4d4d\\-9a09\\-bd4625b9c5a1\\}\\\\model\" or (winlog.event_data.targetobject:(hkcu\\\\software\\\\app\\\\* or hklm\\\\software\\\\app\\\\*) and winlog.event_data.targetobject:(*appxbf13d4ea2945444d8b13e2121cb6b663\\\\* or *appx70162486c7554f7f80f481985d67586d\\\\* or *appx37cc7fdccd644b4f85f4b22d5a3f105a\\\\*) and winlog.event_data.targetobject:(*application or *defaulticon)) or (winlog.event_data.targetobject:hkcu\\\\* and winlog.event_data.targetobject:(*classes\\\\appxc52346ec40fb4061ad96be0e6cb7d16a\\\\* or *classes\\\\appx3bbba44c6cae4d9695755183472171e2\\\\* or *classes\\\\clsid\\\\\\{e3517e26\\-8e93\\-458d\\-a6df\\-8030bc80528b\\}\\\\* or *classes\\\\clsid\\\\\\{e08a0f4b\\-1f65\\-4d4d\\-9a09\\-bd4625b9c5a1\\}\\\\model*)))
<li><a href="#">query: (winlog.event_data.targetobject:\"hklm\\\\system\\\\currentcontrolset\\\\control\\\\session\\ manager\\\\appcertdlls\" or newname:\"hklm\\\\system\\\\curentcontrolset\\\\control\\\\session\\ manager\\\\appcertdlls\")
<li><a href="#">query: (winlog.event_data.targetobject:\"hklm\\system\\currentcontrolset\\services\\fax\\objectname\" and (not (winlog.event_data.details:*networkservice*)))
<li><a href="#">query: (winlog.event_data.targetobject:hkcu\\\\* and winlog.event_data.targetobject:*\\\\mscfile\\\\shell\\\\open\\\\command)
<li><a href="#">query: (winlog.event_data.targetobject:hklm\\\\sam\\\\sam\\\\domains\\\\account\\\\users\\\\names\\\\* and winlog.event_data.targetobject:*$ and process.executable:*lsass.exe)
<li><a href="#">query: (winlog.event_id:(\"11\" or \"12\") and imagename:(*\\\\users\\\\public\\\\* or *\\\\perflogs\\\\* or *\\\\desktop\\\\* or *\\\\downloads\\\\* or *\\\\appdata\\\\local\\\\temp\\\\* or *c\\:\\\\windows\\\\temp\\\\*))
<li><a href="#">query: (winlog.event_id:(\"11\" or \"12\") and processpath:(*\\\\mpcmdrun.exe or *\\\\nissrv.exe))
<li><a href="#">query: (winlog.event_id:(\"12\" or \"13\") and winlog.event_data.targetobject:*system\\\\* and winlog.event_data.targetobject:*\\\\services\\\\localnetservice)
<li><a href="#">query: (winlog.event_id:(\"2006\" or \"2033\") and (not ((modifyingapplication:\"c\\:\\\\windows\\\\system32\\\\svchost.exe\" or modifyingapplication:(c\\:\\\\program\\ files\\\\* or c\\:\\\\program\\ files\\ \\(x86\\)\\\\*)) or (modifyingapplication:c\\:\\\\programdata\\\\microsoft\\\\windows\\ defender\\\\platform\\\\* and modifyingapplication:*\\\\msmpeng.exe))))
<li><a href="#">query: (winlog.event_id:(\"400\" or \"401\") and packagefullname:*3669e262\\-ec02\\-4e9d\\-bcb4\\-3d008b4afac9*)
<li><a href="#">query: (winlog.event_id:(\"40300\" or \"40301\" or \"40302\") and (*hybridconnection* or *sb\\:\\/\\/* or *servicebus.windows.net* or *hybridconnectionmanage*))
<li><a href="#">query: (winlog.event_id:(\"6\" or \"8\") and (*cmdlet\\ failed.\\ cmdlet\\ get\\-app,\\ * or *task\\ get\\-app\\ throwing\\ unhandled\\ exception\\:\\ system.invalidcastexception\\:*))
<li><a href="#">query: (winlog.event_id:\"12\" and processpath:(*\\\\mpcmdrun.exe or *\\\\nissrv.exe))
<li><a href="#">query: (winlog.event_id:\"16403\" and (not (remotename:(*.com* or *.azureedge.net* or *.sfx.ms* or *download.mozilla.org*))))
<li><a href="#">query: (winlog.event_id:\"16403\" and localname:(*c\\:\\\\users\\\\public\\\\* or *%public%* or *\\\\desktop\\\\* or *c\\:\\\\perflogs\\\\*))
<li><a href="#">query: (winlog.event_id:\"16403\" and remotename:(*raw.githubusercontent.com* or *gist.githubusercontent.com* or *pastebin.com* or *cdn.discordapp.com\\/attachments\\/* or *mediafire.com* or *mega.nz* or *ddns.net* or *.paste.ee* or *.hastebin.com* or *.ghostbin.co\\/* or *ufile.io* or *storage.googleapis.com*))
<li><a href="#">query: (winlog.event_id:\"2004\" and (not ((action:\"2\") or (applicationpath:(c\\:\\\\program\\ files\\\\* or c\\:\\\\program\\ files\\ \\(x86\\)\\\\*) or modifyingapplication:\"c\\:\\\\windows\\\\system32\\\\oobe\\\\setup.exe\" or modifyingapplication:c\\:\\\\windows\\\\winsxs\\\\* or modifyingapplication:(\"c\\:\\\\windows\\\\syswow64\\\\msiexec.exe\" or \"c\\:\\\\windows\\\\system32\\\\svchost.exe\" or \"c\\:\\\\windows\\\\system32\\\\dllhost.exe\" or \"c\\:\\\\program\\ files\\\\windows\\ defender\\\\msmpeng.exe\")) or (modifyingapplication:c\\:\\\\programdata\\\\microsoft\\\\windows\\ defender\\\\platform\\\\* and modifyingapplication:*\\\\msmpeng.exe))))
<li><a href="#">query: (winlog.event_id:\"2005\" and (not ((modifyingapplication:(c\\:\\\\program\\ files\\ \\(x86\\)\\\\* or c\\:\\\\program\\ files\\\\*)))))
<li><a href="#">query: (winlog.event_id:\"21\" and address:*16777216*)
<li><a href="#">query: (winlog.event_id:\"257\" and qname:(\"asyspy256.ddns.net\" or \"hotkillmail9sddcc.ddns.net\" or \"rosaf112.ddns.net\" or \"cvdfhjh1231.myftp.biz\" or \"sz2016rose.ddns.net\" or \"dffwescwer4325.myftp.biz\" or \"cvdfhjh1231.ddns.net\"))
<li><a href="#">query: (winlog.event_id:\"3\" and processpath:(*\\\\powershell.exe or *\\\\pwsh.exe))
<li><a href="#">query: (winlog.event_id:\"3\" and processpath:*\\\\bitsadmin.exe)
<li><a href="#">query: (winlog.event_id:\"3033\" and (not ((filenamebuffer:*\\\\program\\ files\\\\dtrace\\\\dtrace.dll and processnamebuffer:*\\\\windows\\\\system32\\\\svchost.exe and requestedpolicy:\"12\" and validatedpolicy:\"1\") or (filenamebuffer:*\\\\windows\\\\system32\\\\driverstore\\\\filerepository\\\\* and filenamebuffer:*\\\\igd10iumd64.dll and requestedpolicy:\"7\" and validatedpolicy:\"1\") or (filenamebuffer:*\\\\windows\\\\system32\\\\nvspcap64.dll and processnamebuffer:(*\\\\appdata\\\\local\\\\keybase\\\\gui\\\\keybase.exe or *\\\\microsoft\\\\teams\\\\stage\\\\teams.exe) and requestedpolicy:\"8\" and validatedpolicy:\"1\") or (filenamebuffer:*\\\\program\\ files\\\\bonjour\\\\mdnsnsp.dll and processnamebuffer:(*\\\\windows\\\\system32\\\\svchost.exe or *\\\\windows\\\\system32\\\\sihclient.exe) and requestedpolicy:(\"8\" or \"12\") and validatedpolicy:\"1\") or (filenamebuffer:*\\\\microsoft\\ office\\\\root\\\\vfs\\\\programfilescommonx64\\\\microsoft\\ shared\\\\office* and filenamebuffer:*\\\\msoxmlmf.dll and requestedpolicy:\"7\" and validatedpolicy:\"1\") or (filenamebuffer:*\\\\windows\\\\system32\\\\nvspcap64.dll and processnamebuffer:*\\\\appdata\\\\local\\\\slack\\\\app\\-* and processnamebuffer:*\\\\slack.exe and requestedpolicy:\"8\" and validatedpolicy:\"1\") or (filenamebuffer:(*\\\\mozilla\\ firefox\\\\mozavcodec.dll or *\\\\mozilla\\ firefox\\\\mozavutil.dll) and processnamebuffer:*\\\\mozilla\\ firefox\\\\firefox.exe and requestedpolicy:\"8\") or (filenamebuffer:(*\\\\program\\ files\\\\avast\\ software\\\\avast\\\\aswamsi.dll or *\\\\program\\ files\\ \\(x86\\)\\\\avast\\ software\\\\avast\\\\aswamsi.dll) and processnamebuffer:(*\\\\windows\\\\system32\\\\sihclient.exe or *\\\\windows\\\\system32\\\\svchost.exe or *\\\\windows\\ defender\\\\mpcmdrun.exe) and requestedpolicy:(\"8\" or \"12\") and validatedpolicy:\"1\") or (filenamebuffer:(*\\\\stdole.dll or *\\\\msdatasrc.dll) and processnamebuffer:*\\\\mscorsvw.exe and processnamebuffer:*\\\\windows\\\\microsoft.net\\\\* and requestedpolicy:\"8\" and validatedpolicy:\"2\"))))
<li><a href="#">query: (winlog.event_id:\"31017\" and username:\"\" and servername:\\\\1*)
<li><a href="#">query: (winlog.event_id:\"316\" and (*unidrv.dll,\\ kernelbase.dll,\\ * or *\\ 123\\ * or *\\ 1234\\ * or *mimispool*))
<li><a href="#">query: (winlog.event_id:\"4\" and process:\"sshd\" and payload:server\\ listening\\ on\\ *)
<li><a href="#">query: (winlog.event_id:\"401\" and errorcode:\"0x80073cff\")
<li><a href="#">query: (winlog.event_id:\"6\" and \"install\\-transportagent\")
<li><a href="#">query: (winlog.event_id:\"7045\" and winlog.event_data.servicename:\"krbscm\")
<li><a href="#">query: (winlog.event_id:\"854\" and (not ((winlog.event_data.path:(*c\\:\\\\program\\ files\\\\windowsapps\\\\* or *c\\:\\\\program\\ files\\ \\(x86\\)\\\\* or *c\\:\\\\windows\\\\systemapps\\\\* or *c\\:\\\\windows\\\\printdialog\\\\* or *c\\:\\\\windows\\\\immersivecontrolpanel\\\\* or *x\\-windowsupdate\\:\\/\\/* or *file\\:\\/\\/\\/c\\:\\/program%20files*)) or (winlog.event_data.path:(*https\\:\\/\\/statics.teams.cdn.office.net\\/* or *microsoft.com*)))))
<li><a href="#">query: (winlog.event_id:\"854\" and winlog.event_data.path:(*c\\:\\\\users\\\\public\\\\* or *\\/users\\/public\\/* or *c\\:\\\\perflogs\\\\* or *c\\:\\/perflogs\\/* or *\\\\desktop\\\\* or *\\/desktop\\/* or *\\\\downloads\\\\* or *\\/downloads\\/* or *c\\:\\\\windows\\\\temp\\\\* or *c\\:\\/windows\\/temp\\/* or *\\\\appddata\\\\local\\\\temp\\\\* or *\\/appddata\\/local\\/temp\\/*))
<li><a href="#">query: (winlog.event_id:\"854\" and winlog.event_data.path:(*transfer.sh* or *raw.githubusercontent.com* or *gist.githubusercontent.com* or *pastebin.com* or *cdn.discordapp.com\\/attachments\\/* or *mediafire.com* or *mega.nz* or *ddns.net* or *.paste.ee* or *.hastebin.com* or *.ghostbin.co\\/* or *ufile.io* or *storage.googleapis.com* or *anonfiles.com* or *send.exploit.in* or *privatlab.net* or *privatlab.com* or *sendspace.com*))
<li><a href="#">query: (winlog.provider_name:\"microsoft\\-windows\\-driverframeworks\\-usermode\\/operational\" and winlog.event_id:(\"2003\" or \"2100\" or \"2102\"))
<li><a href="#">query: (winlog.provider_name:\"microsoft\\-windows\\-ntlm\\/operational\" and winlog.event_id:\"8001\" and targetname:termsrv*)
<li><a href="#">query: (winlog.provider_name:\"microsoft\\-windows\\-ntlm\\/operational\" and winlog.event_id:\"8002\" and process.executable:*)
<li><a href="#">query: (winlog.provider_name:\"microsoft\\-windows\\-ntlm\\/operational\" and winlog.event_id:\"8004\" and source.domain:(\"rdesktop\" or \"remmina\" or \"freerdp\" or \"windows7\" or \"windows8\" or \"windows2012\" or \"windows2016\" or \"windows2019\"))
<li><a href="#">query: \"\\(2\\ users\\ now\\ present\\)\
<li><a href="#">query: \"\\/etc\\/ld.so.preload\
<li><a href="#">query: \"__pthread_tpp_change_priority\\:\\ assertion\\ `new_prio\\ \\=\\=\\ \\-1\\ \\||\\ \\(new_prio\\ >\\=\\ fifo_min_prio\\ \\&&\\ new_prio\\ <\\=\\ fifo_max_prio\\)\
<li><a href="#">query: \"error\\:\\ buffer_get_ret\\:\\ trying\\ to\\ get\\ more\\ bytes\\ 1907\\ than\\ in\\ buffer\\ 308\\ \\[preauth\\]\
<li><a href="#">query: \"exit\\ signal\\ segmentation\\ fault\
<li><a href="#">query: \"exited\\ on\\ signal\\ 6\\ \\(core\\ dumped\\)\
<li><a href="#">query: \"install\\-transportagent\
<li><a href="#">query: \"microsoft.authorization\\/roleassignments\\/write\
<li><a href="#">query: \"syncappvpublishingserver.exe\
<li><a href="#">query: \"that\\ did\\ not\\ meet\\ the\\ microsoft\\ signing\\ level\\ requirements\
<li><a href="#">query: activitydisplayname:\"set\\ federation\\ settings\\ on\\ domain\
<li><a href="#">query: company:\"cube0x0\
<li><a href="#">query: consentcontext.isadminconsent:\"false\
<li><a href="#">query: contextinfo:(*powercat\\ * or *powercat.ps1*)
<li><a href="#">query: contextinfo:*get\\-nettcpconnection*
<li><a href="#">query: contextinfo:*reset\\-computermachinepassword*
<li><a href="#">query: contextinfo:*syncappvpublishingserver.exe*
<li><a href="#">query: cs-uri-query:(*..\\/..\\/..\\/..\\/..\\/etc\\/passwd* or *..\\/..\\/..\\/..\\/windows\\/* or *..\\/..\\/..\\/..\\/..\\/lib\\/password*)
<li><a href="#">query: cs-uri-query:(*\\/console\\/images\\/%252e%252e%252fconsole.portal* or *\\/console\\/css\\/%2e*)
<li><a href="#">query: cs-uri-query:(*\\/help\\/admin\\-guide\\/reports\\/reportgenerate.jsp* or *\\/restapi\\/logoncustomization* or *\\/restapi\\/connection*)
<li><a href="#">query: cs-uri-query:(*\\/help\\/admin\\-guide\\/reports\\/reportgenerate.jsp* or *\\/servletapi\\/..\\/restapi\\/logoncustomization* or *\\/servletapi\\/..\\/restapi\\/connection*)
<li><a href="#">query: cs-uri-query:(*\\=c\\:\\/users* or *\\=c\\:\\/program%20files* or *\\=c\\:\\/windows* or *\\=c%3a%5cusers* or *\\=c%3a%5cprogram%20files* or *\\=c%3a%5cwindows*)
<li><a href="#">query: cs-uri-query:*/config/keystore/*.js*
<li><a href="#">query: cs-uri-query:*?/dana/html5acc/guacamole/*
<li><a href="#">query: cs-uri-query:*?doas\\=`*
<li><a href="#">query: cs-uri-query:*\\/manager\\/controllers\\/default\\/resource\\/tvs.php?class_key\\=..\\/..\\/..\\/..\\/..\\/..\\/..\\/..\\/..\\/..\\/windows\\/win.ini%00*
<li><a href="#">query: cs-uri-query:*\\/manager\\/files?path\\=etc\\/lists\\/..\\/..\\/..\\/..\\/..*
<li><a href="#">query: cs-uri-query:*\\/saas\\/t\\/_\\/;\\/*
<li><a href="#">query: cs-user-agent:(*wfuzz\\/* or *wpscan\\ v* or *recon\\-ng\\/v* or *gis\\ \\-\\ appsec\\ team\\ \\-\\ project\\ vision*)
<li><a href="#">query: destination.domain:(*tunnel.us.ngrok.com* or *tunnel.eu.ngrok.com* or *tunnel.ap.ngrok.com* or *tunnel.au.ngrok.com* or *tunnel.sa.ngrok.com* or *tunnel.jp.ngrok.com* or *tunnel.in.ngrok.com*)
<li><a href="#">query: destination.domain:(\"pool.minexmr.com\" or \"fr.minexmr.com\" or \"de.minexmr.com\" or \"sg.minexmr.com\" or \"ca.minexmr.com\" or \"us\\-west.minexmr.com\" or \"pool.supportxmr.com\" or \"mine.c3pool.com\" or \"xmr\\-eu1.nanopool.org\" or \"xmr\\-eu2.nanopool.org\" or \"xmr\\-us\\-east1.nanopool.org\" or \"xmr\\-us\\-west1.nanopool.org\" or \"xmr\\-asia1.nanopool.org\" or \"xmr\\-jp1.nanopool.org\" or \"xmr\\-au1.nanopool.org\" or \"xmr.2miners.com\" or \"xmr.hashcity.org\" or \"xmr.f2pool.com\" or \"xmrpool.eu\" or \"pool.hashvault.pro\" or \"moneroocean.stream\" or \"monerocean.stream\")
<li><a href="#">query: destination.domain:\"ovz1.j19544519.pr46m.vps.myjino.ru\
<li><a href="#">query: destination.port:(\"8080\" or \"21\" or \"80\" or \"23\" or \"50000\" or \"1521\" or \"27017\" or \"1433\" or \"11211\" or \"3306\" or \"15672\" or \"5900\" or \"5901\" or \"5902\" or \"5903\" or \"5904\")
<li><a href="#">query: destination:(*v3jpdgvqcm9jzxnztwvtb3j5* or *dyaxrluhjvy2vzc01lbw9ye* or *xcml0zvbyb2nlc3nnzw1vcn* or *vghpcybwcm9ncmftignhbm5vdcbizsbydw4gaw4gre9tig1vzg* or *roaxmgchjvz3jhbsbjyw5ub3qgymugcnvuigluierpuybtb2rl* or *uaglzihbyb2dyyw0gy2fubm90igjlihj1bibpbibet1mgbw9kz* or *vghpcybwcm9ncmftig11c3qgymugcnvuihvuzgvyifdpbjmy* or *roaxmgchjvz3jhbsbtdxn0igjlihj1bib1bmrlcibxaw4zm* or *uaglzihbyb2dyyw0gbxvzdcbizsbydw4gdw5kzxigv2lumz*)
<li><a href="#">query: displaymessage:\"max\\ sign\\ in\\ attempts\\ exceeded\
<li><a href="#">query: displaymessage:\"user\\ attempted\\ unauthorized\\ access\\ to\\ app\
<li><a href="#">query: dll.path:(*\\\\adv64drv.sys or *\\\\agent64.sys or *\\\\alsysio64.sys or *\\\\amifldrv64.sys or *\\\\asio.sys or *\\\\asio64.sys or *\\\\asmmap64.sys or *\\\\asrautochkupddrv.sys or *\\\\asrdrv10.sys or *\\\\asrdrv101.sys or *\\\\asribdrv.sys or *\\\\asromgdrv.sys or *\\\\asrrapidstartdrv.sys or *\\\\asrsmartconnectdrv.sys or *\\\\asupio.sys or *\\\\atillk64.sys or *\\\\bs_def64.sys or *\\\\citmdrv_amd64.sys or *\\\\citmdrv_ia64.sys or *\\\\cpuz_x64.sys or *\\\\cpuz141.sys or *\\\\dbutil_2_3.sys or *\\\\dh_kernel_10.sys or *\\\\dh_kernel.sys or *\\\\gdrv.sys or *\\\\glckio2.sys or *\\\\hostnt.sys or *\\\\hwrwdrv.sys or *\\\\inpoutx64.sys or *\\\\iomem64.sys or *\\\\mhyprot2.sys or *\\\\msio64.sys or *\\\\msrhook.sys or *\\\\ntiolib.sys or *\\\\openlibsys.sys or *\\\\se64a.sys or *\\\\smep_capcom.sys or *\\\\smep_namco.sys or *\\\\sysinfo.sys or *\\\\vproeventmonitor.sys or *\\\\wcpu.sys or *\\\\winiodrv.sys or *\\\\winring0.sys or *\\\\physmem.sys or *\\\\procexp152.sys or *\\\\viraglt64.sys or *\\\\vboxdrv.sys or *\\\\rwdrv.sys or *\\\\speedfan.sys or *\\\\kprocesshacker.sys or *\\\\sandra.sys or *\\\\elbycdio.sys or *\\\\goad.sys or *\\\\aswsnx.sys or *\\\\sandbox.sys or *\\\\nicm.sys or *\\\\nscm.sys or *\\\\ncpl.sys or *\\\\elrawdsk.sys or *\\\\dbutildrv2.sys or *\\\\bs_rcio64.sys or *\\\\mhyprot.sys or *\\\\enetechio64.sys or *\\\\amp.sys or *\\\\eneio64.sys or *\\\\atszio.sys or *\\\\naldrv.sys or *\\\\directio32.sys or *\\\\directio64.sys or *\\\\asupio64.sys or *\\\\asrdrv102.sys or *\\\\asrdrv103.sys or *\\\\bsmemx64.sys or *\\\\bsmixp64.sys or *\\\\bsmix64.sys or *\\\\bs_flash64.sys or *\\\\bs_hwmio64_w10.sys or *\\\\bs_hwmio64.sys or *\\\\bs_i2c64.sys or *\\\\gvcidrv64.sys or *\\\\hwos2ec10x64.sys or *\\\\hwos2ec7x64.sys or *\\\\nbiolib_x64.sys or *\\\\nchgbios2x64.sys or *\\\\ntiolib_x64.sys or *\\\\phlashnt.sys or *\\\\phymemx64.sys or *\\\\ucorew64.sys or *\\\\winflash64.sys or *\\\\winring0x64.sys or *\\\\dbk64.sys or *\\\\mtcbsv64.sys or *\\\\nvflash.sys or *\\\\nvflsh64.sys or *\\\\phymem64.sys or *\\\\rtkio64.sys or *\\\\rtkiow10x64.sys or *\\\\rtkiow8x64.sys or *\\\\segwindrvx64.sys or *\\\\superbmc.sys or *\\\\semav6msr.sys or *\\\\piddrv64.sys or *\\\\bs_i2cio.sys or *\\\\rtkio.sys or *\\\\amdryzenmasterdriver.sys or *\\\\lha.sys or *\\\\kevp64.sys or *\\\\bsmi.sys or *\\\\tmcomm.sys or *\\\\cpuz.sys or *\\\\iqvw64.sys or *\\\\iqvw32.sys or *\\\\vmdrv.sys or *\\\\hpportiox64.sys or *\\\\amdpowerprofiler.sys or *\\\\corsairllaccess64.sys or *\\\\rtcore64.sys or *\\\\libnicm.sys or *\\\\procexp.sys or *\\\\viragt.sys or *\\\\viragt64.sys or *\\\\asrdrv106.sys or *\\\\zamguard64.sys or *\\\\zam64.sys or *\\\\fidpcidrv64.sys or *\\\\msio32.sys or *\\\\winio64.sys or *\\\\capcom.sys or *\\\\iomap64.sys or *\\\\atszio64.sys or *\\\\aswvmm.sys or *\\\\fairplaykd.sys or *\\\\pgldqpoc.sys or *\\\\iqvw64e.sys or *\\\\monitor_win10_x64.sys or *\\\\srvnetbus.sys or *\\\\mslo64.sys or *\\\\pcdsrvc_x64.pkms or *\\\\krpocesshacker.sys or *\\\\hwinfo64a.sys or *\\\\rzpnk.sys or *\\\\magdrvamd64.sys or *\\\\driver7\\-x64.sys or *\\\\driver7\\-x86\\-withoutdbg.sys or *\\\\driver7\\-x86.sys or *\\\\gmer.sys or *\\\\pcadrvx64.sys or *\\\\clfs.sys or *\\\\activehealth.sys or *\\\\cam_v3.sys or *\\\\gamefire.sys or *\\\\openhardwaremonitor.sys or *\\\\openhardwaremonitorlib.sys or *\\\\openhardwaremonitorreport.sys or *\\\\smartdashboard.sys or *\\\\systemgauge.sys or *\\\\systemgaugex7.sys or *\\\\videonovaservercontrollerservice.sys or *\\\\ellp_service.sys or *\\\\hardwareproviders.sys or *\\\\ohm.sys or *\\\\sensorsview32_64.sys or *\\\\touchpointanalyticsclient.sys or *\\\\cqg5jf.sys or *\\\\hcdrdh.sys or *\\\\ncdgdn.sys or *\\\\vltz19.sys)
<li><a href="#">query: dll.path:(*\\\\adv64drv.sys or *\\\\agent64.sys or *\\\\alsysio64.sys or *\\\\amifldrv64.sys or *\\\\asio.sys or *\\\\asio64.sys or *\\\\asmmap64.sys or *\\\\asrautochkupddrv.sys or *\\\\asrdrv10.sys or *\\\\asrdrv101.sys or *\\\\asribdrv.sys or *\\\\asromgdrv.sys or *\\\\asrrapidstartdrv.sys or *\\\\asrsmartconnectdrv.sys or *\\\\asupio.sys or *\\\\atillk64.sys or *\\\\bs_def64.sys or *\\\\citmdrv_amd64.sys or *\\\\citmdrv_ia64.sys or *\\\\cpuz_x64.sys or *\\\\cpuz141.sys or *\\\\dbutil_2_3.sys or *\\\\dh_kernel_10.sys or *\\\\dh_kernel.sys or *\\\\gdrv.sys or *\\\\glckio2.sys or *\\\\hostnt.sys or *\\\\hwrwdrv.sys or *\\\\inpoutx64.sys or *\\\\iomem64.sys or *\\\\mhyprot2.sys or *\\\\msio64.sys or *\\\\msrhook.sys or *\\\\ntiolib.sys or *\\\\openlibsys.sys or *\\\\se64a.sys or *\\\\smep_capcom.sys or *\\\\smep_namco.sys or *\\\\sysinfo.sys or *\\\\vproeventmonitor.sys or *\\\\wcpu.sys or *\\\\winiodrv.sys or *\\\\winring0.sys or *\\\\physmem.sys or *\\\\procexp152.sys or *\\\\viraglt64.sys or *\\\\vboxdrv.sys or *\\\\rwdrv.sys or *\\\\speedfan.sys or *\\\\kprocesshacker.sys or *\\\\sandra.sys or *\\\\elbycdio.sys or *\\\\goad.sys or *\\\\aswsnx.sys or *\\\\sandbox.sys or *\\\\nicm.sys or *\\\\nscm.sys or *\\\\ncpl.sys or *\\\\elrawdsk.sys or *\\\\dbutildrv2.sys or *\\\\bs_rcio64.sys or *\\\\mhyprot.sys or *\\\\enetechio64.sys or *\\\\amp.sys or *\\\\eneio64.sys or *\\\\atszio.sys or *\\\\naldrv.sys or *\\\\directio32.sys or *\\\\directio64.sys or *\\\\asupio64.sys or *\\\\asrdrv102.sys or *\\\\asrdrv103.sys or *\\\\bsmemx64.sys or *\\\\bsmixp64.sys or *\\\\bsmix64.sys or *\\\\bs_flash64.sys or *\\\\bs_hwmio64_w10.sys or *\\\\bs_hwmio64.sys or *\\\\bs_i2c64.sys or *\\\\gvcidrv64.sys or *\\\\hwos2ec10x64.sys or *\\\\hwos2ec7x64.sys or *\\\\nbiolib_x64.sys or *\\\\nchgbios2x64.sys or *\\\\ntiolib_x64.sys or *\\\\phlashnt.sys or *\\\\phymemx64.sys or *\\\\ucorew64.sys or *\\\\winflash64.sys or *\\\\winring0x64.sys or *\\\\dbk64.sys or *\\\\mtcbsv64.sys or *\\\\nvflash.sys or *\\\\nvflsh64.sys or *\\\\phymem64.sys or *\\\\rtkio64.sys or *\\\\rtkiow10x64.sys or *\\\\rtkiow8x64.sys or *\\\\segwindrvx64.sys or *\\\\superbmc.sys or *\\\\semav6msr.sys or *\\\\piddrv64.sys or *\\\\bs_i2cio.sys or *\\\\rtkio.sys or *\\\\amdryzenmasterdriver.sys or *\\\\lha.sys or *\\\\kevp64.sys or *\\\\bsmi.sys or *\\\\tmcomm.sys or *\\\\cpuz.sys or *\\\\iqvw64.sys or *\\\\vmdrv.sys or *\\\\hpportiox64.sys or *\\\\amdpowerprofiler.sys or *\\\\corsairllaccess64.sys or *\\\\rtcore64.sys or *\\\\libnicm.sys or *\\\\procexp.sys or *\\\\viragt.sys or *\\\\viragt64.sys or *\\\\asrdrv106.sys or *\\\\zamguard64.sys or *\\\\zam64.sys or *\\\\fidpcidrv64.sys or *\\\\msio32.sys or *\\\\winio64.sys or *\\\\capcom.sys or *\\\\iomap64.sys or *\\\\atszio64.sys or *\\\\aswvmm.sys or *\\\\fairplaykd.sys or *\\\\pgldqpoc.sys or *\\\\iqvw64e.sys or *\\\\monitor_win10_x64.sys or *\\\\srvnetbus.sys or *\\\\mslo64.sys or *\\\\pcdsrvc_x64.pkms or *\\\\krpocesshacker.sys or *\\\\hwinfo64a.sys or *\\\\rzpnk.sys or *\\\\magdrvamd64.sys or *\\\\driver7\\-x64.sys or *\\\\driver7\\-x86\\-withoutdbg.sys or *\\\\driver7\\-x86.sys or *\\\\gmer.sys or *\\\\pcadrvx64.sys or *\\\\clfs.sys or *\\\\activehealth.sys or *\\\\cam_v3.sys or *\\\\gamefire.sys or *\\\\openhardwaremonitor.sys or *\\\\openhardwaremonitorlib.sys or *\\\\openhardwaremonitorreport.sys or *\\\\smartdashboard.sys or *\\\\systemgauge.sys or *\\\\systemgaugex7.sys or *\\\\videonovaservercontrollerservice.sys or *\\\\ellp_service.sys or *\\\\hardwareproviders.sys or *\\\\ohm.sys or *\\\\sensorsview32_64.sys or *\\\\touchpointanalyticsclient.sys)
<li><a href="#">query: dll.path:(*\\\\ttdrecord.dll or *\\\\ttdwriter.dll or *\\\\ttdloader.dll)
<li><a href="#">query: dll.path:(*powershell* or *pwsh*)
<li><a href="#">query: dll.path:*\\\\appdata\\\\local\\\\temp\\\\ba9ea7344a4a5f591d6e5dc32a13494b\\\\*
<li><a href="#">query: dns.question.name:(*.interact.sh* or *.oast.pro* or *.oast.live* or *.oast.site* or *.oast.online* or *.oast.fun* or *.oast.me* or *.burpcollaborator.net* or *.oastify.com* or *.canarytokens.com* or *.requestbin.net* or *.dnslog.cn*)
<li><a href="#">query: dns.question.name:(*pool.minexmr.com* or *fr.minexmr.com* or *de.minexmr.com* or *sg.minexmr.com* or *ca.minexmr.com* or *us\\-west.minexmr.com* or *pool.supportxmr.com* or *mine.c3pool.com* or *xmr\\-eu1.nanopool.org* or *xmr\\-eu2.nanopool.org* or *xmr\\-us\\-east1.nanopool.org* or *xmr\\-us\\-west1.nanopool.org* or *xmr\\-asia1.nanopool.org* or *xmr\\-jp1.nanopool.org* or *xmr\\-au1.nanopool.org* or *xmr.2miners.com* or *xmr.hashcity.org* or *xmr.f2pool.com* or *xmrpool.eu* or *pool.hashvault.pro*)
<li><a href="#">query: dns.question.name:(\"ifferfsodp9ifjaposdfjhgosurijfaewrwergwea.testing\" or \"ifferfsodp9ifjaposdfjhgosurijfaewrwergwea.test\" or \"ifferfsodp9ifjaposdfjhgosurijfaewrwergwea.com\" or \"ayylmaotjhsstasdfasdfasdfasdfasdfasdfasdf.com\" or \"iuqssfsodp9ifjaposdfjhgosurijfaewrwergwea.com\")
<li><a href="#">query: dns.question.name:*.ammyy.com
<li><a href="#">query: dns.question.name:*.anonfiles.com*
<li><a href="#">query: dns.question.name:*.getgo.com
<li><a href="#">query: dns.question.name:*.logmein.com
<li><a href="#">query: dns.question.name:*.onion*
<li><a href="#">query: dns.question.name:*\\=\\=.*
<li><a href="#">query: dns.question.name:*userstorage.mega.co.nz*
<li><a href="#">query: dns.question.name:\"api.telegram.org\
<li><a href="#">query: dns.question.name:\"ovz1.j19544519.pr46m.vps.myjino.ru\
<li><a href="#">query: dns.question.type:\"null\
<li><a href="#">query: dns.question.type:\"txt\
<li><a href="#">query: eventname:(\"archivefindings\" or \"createfindingsfilter\" or \"deletemember\" or \"disassociatefrommasteraccount\" or \"disassociatemember\" or \"disablemacie\" or \"disableorganizationadminaccount\" or \"updatefindingsfilter\" or \"updatemaciesession\" or \"updatemembersession\" or \"updateclassificationjob\")
<li><a href="#">query: eventtype:(\"application.lifecycle.update\" or \"application.lifecycle.delete\")
<li><a href="#">query: eventtype:(\"application.policy.sign_on.update\" or \"application.policy.sign_on.rule.delete\")
<li><a href="#">query: eventtype:(\"group.privilege.grant\" or \"user.account.privilege.grant\")
<li><a href="#">query: eventtype:(\"policy.lifecycle.update\" or \"policy.lifecycle.delete\")
<li><a href="#">query: eventtype:(\"policy.rule.update\" or \"policy.rule.delete\")
<li><a href="#">query: eventtype:(\"user.mfa.factor.deactivate\" or \"user.mfa.factor.reset_all\")
<li><a href="#">query: eventtype:(\"zone.deactivate\" or \"zone.delete\")
<li><a href="#">query: eventtype:\"security.threat.detected\
<li><a href="#">query: eventtype:\"system.api_token.create\
<li><a href="#">query: eventtype:\"system.api_token.revoke\
<li><a href="#">query: file.name:(*\\\\lsadump* or *\\\\cachedump* or *\\\\wceservicepipe*)
<li><a href="#">query: file.name:(*\\\\pipe\\\\* or *\\\\pipe\\\\srvsvc*)
<li><a href="#">query: file.name:(\"\\\\atctl\" or \"\\\\userpipe\" or \"\\\\iehelper\" or \"\\\\sdlrpc\" or \"\\\\comnap\")
<li><a href="#">query: file.name:(\"\\\\isapi_http\" or \"\\\\isapi_dg\" or \"\\\\isapi_dg2\" or \"\\\\sdlrpc\" or \"\\\\ahexec\" or \"\\\\winsession\" or \"\\\\lsassw\" or \"\\\\46a676ab7f179e511e30dd2dc41bd388\" or \"\\\\9f81f59bc58452127884ce513865ed20\" or \"\\\\e710f28d59aa529d6792ca6ff0ca1b34\" or \"\\\\rpchlp_3\" or \"\\\\namepipe_morewindows\" or \"\\\\pcheap_reuse\" or \"\\\\gruntsvc\" or \"\\\\583da945\\-62af\\-10e8\\-4902\\-a8f205c72b2e\" or \"\\\\bizkaz\" or \"\\\\svcctl\" or \\\\posh* or \"\\\\jaccdpqnvbrrxlaf\" or \"\\\\csexecsvc\" or \"\\\\6e7645c4\\-32c5\\-4fe3\\-aabf\\-e94c2f4370e7\" or \"\\\\adschemerpc\" or \"\\\\anonymouspipe\" or \"\\\\bc367\" or \"\\\\bc31a7\" or \"\\\\testpipe\" or \"\\\\dce_3d\")
<li><a href="#">query: file.name:(\"\\\\isapi_http\" or \"\\\\isapi_dg\" or \"\\\\isapi_dg2\" or \"\\\\sdlrpc\" or \"\\\\ahexec\" or \"\\\\winsession\" or \"\\\\lsassw\" or \"\\\\46a676ab7f179e511e30dd2dc41bd388\" or \"\\\\9f81f59bc58452127884ce513865ed20\" or \"\\\\e710f28d59aa529d6792ca6ff0ca1b34\" or \"\\\\rpchlp_3\" or \"\\\\namepipe_morewindows\" or \"\\\\pcheap_reuse\" or \"\\\\gruntsvc\" or \"\\\\583da945\\-62af\\-10e8\\-4902\\-a8f205c72b2e\" or \"\\\\bizkaz\" or \"\\\\svcctl\" or \\\\posh* or \"\\\\jaccdpqnvbrrxlaf\" or \"\\\\csexecsvc\" or \"\\\\6e7645c4\\-32c5\\-4fe3\\-aabf\\-e94c2f4370e7\" or \"\\\\adschemerpc\" or \"\\\\anonymouspipe\" or \"\\\\bc367\" or \"\\\\bc31a7\" or \"\\\\testpipe\")
<li><a href="#">query: file.name:(psexec* or paexec* or remcom* or csexec*)
<li><a href="#">query: file.name:*thisispipe*
<li><a href="#">query: file.name:\"\\\\psexesvc\
<li><a href="#">query: file.name:\\\\pshost*
<li><a href="#">query: file.path.text:(*\\\\gthread\\-3.6.dll or *\\\\sigcmm\\-2.4.dll or *\\\\windows\\\\temp\\\\tmp.bat)
<li><a href="#">query: file.path.text:(*\\\\microsoft.powershell_profile.ps1 or *\\\\windowspowershell\\\\profile.ps1 or *\\\\powershell\\\\profile.ps1 or *\\\\windows\\\\system32\\\\windowspowershell\\\\v1.0\\\\profile.ps1 or *\\\\program\\ files\\\\powershell\\\\7\\\\profile.ps1)
<li><a href="#">query: file.path.text:(*\\\\usagelogs\\\\cmstp.exe.log or *\\\\usagelogs\\\\cscript.exe.log or *\\\\usagelogs\\\\mshta.exe.log or *\\\\usagelogs\\\\msxsl.exe.log or *\\\\usagelogs\\\\regsvr32.exe.log or *\\\\usagelogs\\\\rundll32.exe.log or *\\\\usagelogs\\\\svchost.exe.log or *\\\\usagelogs\\\\wscript.exe.log or *\\\\usagelogs\\\\wmic.exe.log)
<li><a href="#">query: file.path.text:(*c\\:\\\\windows\\\\system32\\\\physmem.sys* or *c\\:\\\\windows\\\\system32\\\\ime\\\\imejp\\\\imjpueact.dll* or *c\\:\\\\windows\\\\system32\\\\ime\\\\imetc\\\\imtcprot.dll* or *c\\:\\\\windows\\\\system32\\\\ime\\\\shared\\\\imecpmeid.dll* or *c\\:\\\\windows\\\\system32\\\\config\\\\spp\\\\servicestate\\\\recovery\\\\pac.dat* or *c\\:\\\\windows\\\\system32\\\\config\\\\cy\\-gb\\\\setup\\\\skb\\\\inputmethod\\\\tuptask.dat* or *c\\:\\\\windows\\\\system32\\\\config\\\\config\\\\startwus.dat* or *c\\:\\\\windows\\\\system32\\\\ime\\\\shared\\\\wimbootconfigurations.ini* or *c\\:\\\\windows\\\\system32\\\\ime\\\\imejp\\\\wimbootconfigurations.ini* or *c\\:\\\\windows\\\\system32\\\\ime\\\\imetc\\\\wimbootconfigurations.ini*)
<li><a href="#">query: file.path.text:*\\/etc\\/doas.conf
<li><a href="#">query: file.path.text:*\\\\appdata\\\\local\\\\temp\\\\advanced\\ ip\\ scanner\\ 2*
<li><a href="#">query: file.path.text:*\\\\appdata\\\\local\\\\temp\\\\ba9ea7344a4a5f591d6e5dc32a13494b\\\\*
<li><a href="#">query: file.path.text:*\\\\microsoft.vscode_profile.ps1
<li><a href="#">query: file.path.text:*\\\\microsoft\\\\outlook\\\\vbaproject.otm
<li><a href="#">query: file.path.text:*\\\\psexesvc.exe
<li><a href="#">query: file.path.text:*ebpfbackdoor
<li><a href="#">query: file.path.text:\"/tmp/rootlog\
<li><a href="#">query: file.path.text:\"c\\:\\\\windows\\\\system32\\\\drivers\\\\moriyastreamwatchmen.sys\
<li><a href="#">query: file.path.text:\"c\\:\\\\windows\\\\temp\\\\dumpert.dmp\
<li><a href="#">query: file.path.text:\\/etc\\/sudoers.d\\/*
<li><a href="#">query: file.path:(*.aaa or *.zzz)
<li><a href="#">query: file.path:(*\\\\all.cab or *.ntds.cleartext)
<li><a href="#">query: file.path:(*\\\\appdata\\\\local\\\\microsoft\\\\cache134.dat or *\\\\appdata\\\\local\\\\microsoft\\\\explorersync.db)
<li><a href="#">query: file.path:(*\\\\invoke\\-dllinjection.ps1 or *\\\\invoke\\-wmicommand.ps1 or *\\\\get\\-gpppassword.ps1 or *\\\\get\\-keystrokes.ps1 or *\\\\get\\-vaultcredential.ps1 or *\\\\invoke\\-credentialinjection.ps1 or *\\\\invoke\\-mimikatz.ps1 or *\\\\invoke\\-ninjacopy.ps1 or *\\\\invoke\\-tokenmanipulation.ps1 or *\\\\out\\-minidump.ps1 or *\\\\volumeshadowcopytools.ps1 or *\\\\invoke\\-reflectivepeinjection.ps1 or *\\\\get\\-timedscreenshot.ps1 or *\\\\invoke\\-userhunter.ps1 or *\\\\find\\-gpolocation.ps1 or *\\\\invoke\\-aclscanner.ps1 or *\\\\invoke\\-downgradeaccount.ps1 or *\\\\get\\-serviceunquoted.ps1 or *\\\\get\\-servicefilepermission.ps1 or *\\\\get\\-servicepermission.ps1 or *\\\\invoke\\-serviceabuse.ps1 or *\\\\install\\-servicebinary.ps1 or *\\\\get\\-regautologon.ps1 or *\\\\get\\-vulnautorun.ps1 or *\\\\get\\-vulnschtask.ps1 or *\\\\get\\-unattendedinstallfile.ps1 or *\\\\get\\-webconfig.ps1 or *\\\\get\\-applicationhost.ps1 or *\\\\get\\-regalwaysinstallelevated.ps1 or *\\\\get\\-unconstrained.ps1 or *\\\\add\\-regbackdoor.ps1 or *\\\\add\\-scrnsavebackdoor.ps1 or *\\\\gupt\\-backdoor.ps1 or *\\\\invoke\\-adsbackdoor.ps1 or *\\\\enabled\\-duplicatetoken.ps1 or *\\\\invoke\\-psuacme.ps1 or *\\\\remove\\-update.ps1 or *\\\\check\\-vm.ps1 or *\\\\get\\-lsasecret.ps1 or *\\\\get\\-passhashes.ps1 or *\\\\show\\-targetscreen.ps1 or *\\\\port\\-scan.ps1 or *\\\\invoke\\-poshrathttp.ps1 or *\\\\invoke\\-powershelltcp.ps1 or *\\\\invoke\\-powershellwmi.ps1 or *\\\\add\\-exfiltration.ps1 or *\\\\add\\-persistence.ps1 or *\\\\do\\-exfiltration.ps1 or *\\\\start\\-captureserver.ps1 or *\\\\invoke\\-shellcode.ps1 or *\\\\get\\-chromedump.ps1 or *\\\\get\\-clipboardcontents.ps1 or *\\\\get\\-foxdump.ps1 or *\\\\get\\-indexeditem.ps1 or *\\\\get\\-screenshot.ps1 or *\\\\invoke\\-inveigh.ps1 or *\\\\invoke\\-netripper.ps1 or *\\\\invoke\\-egresscheck.ps1 or *\\\\invoke\\-postexfil.ps1 or *\\\\invoke\\-psinject.ps1 or *\\\\invoke\\-runas.ps1 or *\\\\mailraider.ps1 or *\\\\new\\-honeyhash.ps1 or *\\\\set\\-macattribute.ps1 or *\\\\invoke\\-dcsync.ps1 or *\\\\invoke\\-powerdump.ps1 or *\\\\exploit\\-jboss.ps1 or *\\\\invoke\\-thunderstruck.ps1 or *\\\\invoke\\-voicetroll.ps1 or *\\\\set\\-wallpaper.ps1 or *\\\\invoke\\-inveighrelay.ps1 or *\\\\invoke\\-psexec.ps1 or *\\\\invoke\\-sshcommand.ps1 or *\\\\get\\-securitypackages.ps1 or *\\\\install\\-ssp.ps1 or *\\\\invoke\\-backdoorlnk.ps1 or *\\\\powerbreach.ps1 or *\\\\get\\-sitelistpassword.ps1 or *\\\\get\\-system.ps1 or *\\\\invoke\\-bypassuac.ps1 or *\\\\invoke\\-tater.ps1 or *\\\\invoke\\-wscriptbypassuac.ps1 or *\\\\powerup.ps1 or *\\\\powerview.ps1 or *\\\\get\\-rickastley.ps1 or *\\\\find\\-fruit.ps1 or *\\\\http\\-login.ps1 or *\\\\find\\-trusteddocuments.ps1 or *\\\\invoke\\-paranoia.ps1 or *\\\\invoke\\-winenum.ps1 or *\\\\invoke\\-arpscan.ps1 or *\\\\invoke\\-portscan.ps1 or *\\\\invoke\\-reversednslookup.ps1 or *\\\\invoke\\-smbscanner.ps1 or *\\\\invoke\\-mimikittenz.ps1)
<li><a href="#">query: file.path:(*\\\\nppspy.txt or *\\\\nppspy.dll)
<li><a href="#">query: file.path:(*\\\\ttdrecord.dll or *\\\\ttdwriter.dll or *\\\\ttdloader.dll)
<li><a href="#">query: file.path:(*c\\:\\\\windows\\\\system32\\\\physmem.sys* or *c\\:\\\\windows\\\\system32\\\\ime\\\\imejp\\\\imjpueact.dll* or *c\\:\\\\windows\\\\system32\\\\ime\\\\imetc\\\\imtcprot.dll* or *c\\:\\\\windows\\\\system32\\\\ime\\\\shared\\\\imecpmeid.dll* or *c\\:\\\\windows\\\\system32\\\\config\\\\spp\\\\servicestate\\\\recovery\\\\pac.dat* or *c\\:\\\\windows\\\\system32\\\\config\\\\cy\\-gb\\\\setup\\\\skb\\\\inputmethod\\\\tuptask.dat* or *c\\:\\\\windows\\\\system32\\\\config\\\\config\\\\startwus.dat* or *c\\:\\\\windows\\\\system32\\\\ime\\\\shared\\\\wimbootconfigurations.ini* or *c\\:\\\\windows\\\\system32\\\\ime\\\\imejp\\\\wimbootconfigurations.ini* or *c\\:\\\\windows\\\\system32\\\\ime\\\\imetc\\\\wimbootconfigurations.ini*)
<li><a href="#">query: file.path:(*fgexec* or *dumpsvc* or *cachedump* or *mimidrv* or *gsecdump* or *servpw* or *pwdump*)
<li><a href="#">query: file.path:(*gthread\\-3.6.dll* or *sigcmm\\-2.4.dll* or *\\\\windows\\\\temp\\\\tmp.bat*)
<li><a href="#">query: file.path:(\"c\\:\\\\windows\\\\system32\\\\config\\\\systemprofile\\\\appdata\\\\roaming\\\\microsoft\\\\windows\\\\powershell\\\\psreadline\\\\consolehost_history.txt\" or \"c\\:\\\\windows\\\\system32\\\\config\\\\systemprofile\\\\appdata\\\\local\\\\microsoft\\\\windows\\\\powershell\\\\startupprofiledata\\-interactive\")
<li><a href="#">query: file.path:*.kirbi
<li><a href="#">query: file.path:*.pfx
<li><a href="#">query: file.path:*\\/etc\\/doas.conf
<li><a href="#">query: file.path:*\\\\appdata\\\\local\\\\temp\\\\advanced\\ ip\\ scanner\\ 2*
<li><a href="#">query: file.path:*\\\\appdata\\\\local\\\\temp\\\\ba9ea7344a4a5f591d6e5dc32a13494b\\\\*
<li><a href="#">query: file.path:*\\\\appdata\\\\local\\\\temp\\\\logmeininc\\\\gotoassist\\ remote\\ support\\ expert\\\\*
<li><a href="#">query: file.path:*\\\\bin\\\\screenconnect.*
<li><a href="#">query: file.path:*\\\\lsass.dmp
<li><a href="#">query: file.path:*\\\\manageengine\\\\supportcenterplus\\\\bin\\\\msiexec.exe
<li><a href="#">query: file.path:*\\\\microsoft\\\\outlook\\\\vbaproject.otm
<li><a href="#">query: file.path:*\\\\psexesvc.exe
<li><a href="#">query: file.path:*\\\\teamviewer_desktop.exe
<li><a href="#">query: file.path:*\\\\temp\\\\debug.bin
<li><a href="#">query: file.path:*\\\\unattend.xml
<li><a href="#">query: file.path:*c\\:\\\\windows\\\\system32\\\\spool\\\\drivers\\\\x64\\\\3\\\\old\\\\1\\\\123*
<li><a href="#">query: file.path:*ds7002.lnk*
<li><a href="#">query: file.path:*ebpfbackdoor
<li><a href="#">query: file.path:*mimilsa.log
<li><a href="#">query: file.path:*programdata\\\\microsoft\\\\windows\\\\start\\ menu\\\\programs\\\\startup*
<li><a href="#">query: file.path:\"\\/tmp\\/rootlog\
<li><a href="#">query: file.path:\"c\\:\\\\program.exe\
<li><a href="#">query: file.path:\"c\\:\\\\windows\\\\system32\\\\drivers\\\\moriyastreamwatchmen.sys\
<li><a href="#">query: file.path:\"c\\:\\\\windows\\\\system32\\\\wpbbin.exe\
<li><a href="#">query: file.path:\"c\\:\\\\windows\\\\temp\\\\dumpert.dmp\
<li><a href="#">query: file.path:\\/etc\\/sudoers.d\\/*
<li><a href="#">query: gcp.audit.method_name:(*.serviceaccounts.disable or *.serviceaccounts.delete)
<li><a href="#">query: gcp.audit.method_name:(*.serviceaccounts.patch or *.serviceaccounts.create or *.serviceaccounts.update or *.serviceaccounts.enable or *.serviceaccounts.undelete)
<li><a href="#">query: gcp.audit.method_name:(\"cloudsql.instances.create\" or \"cloudsql.instances.delete\" or \"cloudsql.users.update\" or \"cloudsql.users.delete\")
<li><a href="#">query: gcp.audit.method_name:(\"compute.vpntunnels.insert\" or \"compute.vpntunnels.delete\")
<li><a href="#">query: gcp.audit.method_name:(\"dns.managedzones.delete\" or \"dns.managedzones.update\" or \"dns.managedzones.patch\")
<li><a href="#">query: gcp.audit.method_name:(\"storage.buckets.delete\" or \"storage.buckets.insert\" or \"storage.buckets.update\" or \"storage.buckets.patch\")
<li><a href="#">query: gcp.audit.method_name:(\"storage.buckets.list\" or \"storage.buckets.listchannels\")
<li><a href="#">query: gcp.audit.method_name:(io.k8s.api.batch.v*.job or io.k8s.api.batch.v*.cronjob)
<li><a href="#">query: gcp.audit.method_name:(io.k8s.authorization.rbac.v*.clusterrolebindings.create or io.k8s.authorization.rbac.v*.rolebindings.create or io.k8s.authorization.rbac.v*.clusterrolebindings.patch or io.k8s.authorization.rbac.v*.rolebindings.patch or io.k8s.authorization.rbac.v*.clusterrolebindings.update or io.k8s.authorization.rbac.v*.rolebindings.update or io.k8s.authorization.rbac.v*.clusterrolebindings.delete or io.k8s.authorization.rbac.v*.rolebindings.delete)
<li><a href="#">query: gcp.audit.method_name:(io.k8s.core.v*.secrets.create or io.k8s.core.v*.secrets.update or io.k8s.core.v*.secrets.patch or io.k8s.core.v*.secrets.delete)
<li><a href="#">query: gcp.audit.method_name:(v*.compute.firewalls.delete or v*.compute.firewalls.patch or v*.compute.firewalls.update or v*.compute.firewalls.insert)
<li><a href="#">query: gcp.audit.method_name:(v*.compute.packetmirrorings.get or v*.compute.packetmirrorings.delete or v*.compute.packetmirrorings.insert or v*.compute.packetmirrorings.patch or v*.compute.packetmirrorings.list or v*.compute.packetmirrorings.aggregatedlist)
<li><a href="#">query: gcp.audit.method_name:\"projects.content.reidentify\
<li><a href="#">query: host.scan.vuln:(\"10693\" or \"11507\" or \"11633\" or \"11804\" or \"11821\" or \"11847\" or \"11867\" or \"11931\" or \"11935\" or \"11950\" or \"12541\" or \"12558\" or \"12559\" or \"12560\" or \"12562\" or \"12563\" or \"12565\" or \"12587\" or \"12590\" or \"12599\" or \"12702\" or \"12705\" or \"12706\" or \"12907\" or \"12928\" or \"12929\" or \"13053\" or \"13178\" or \"13200\" or \"13218\" or \"13241\" or \"13253\" or \"13274\" or \"13296\" or \"13301\" or \"13327\" or \"13373\" or \"13374\" or \"13409\" or \"13530\" or \"13532\" or \"20065\" or \"20073\" or \"20081\" or \"27202\" or \"27358\" or \"38702\" or \"38719\" or \"42045\" or \"42417\" or \"43029\" or \"43220\" or \"43221\" or \"43222\" or \"43223\" or \"43225\" or \"43246\" or \"43431\" or \"43484\" or \"86857\" or \"87098\" or \"87106\")
<li><a href="#">query: powershell.file.script_block_text:(*.creationtime\\ \\=* or *.lastwritetime\\ \\=* or *.lastaccesstime\\ \\=* or *\\[io.file\\]\\:\\:setcreationtime* or *\\[io.file\\]\\:\\:setlastaccesstime* or *\\[io.file\\]\\:\\:setlastwritetime*)
<li><a href="#">query: powershell.file.script_block_text:(*\\[system.environment\\]\\:\\:username* or *$env\\:username* or *\\[system.security.principal.windowsidentity\\]\\:\\:getcurrent\\(\\)*)
<li><a href="#">query: powershell.file.script_block_text:(*add\\-aadint* or *convertto\\-aadint* or *disable\\-aadint* or *enable\\-aadint* or *export\\-aadint* or *get\\-aadint* or *grant\\-aadint* or *install\\-aadint* or *invoke\\-aadint* or *join\\-aadint* or *new\\-aadint* or *open\\-aadint* or *read\\-aadint* or *register\\-aadint* or *remove\\-aadint* or *restore\\-aadint* or *search\\-aadint* or *send\\-aadint* or *set\\-aadint* or *start\\-aadint* or *update\\-aadint*)
<li><a href="#">query: powershell.file.script_block_text:(*add\\-constraineddelegationbackdoor* or *copy\\-vss* or *create\\-multiplesessions* or *datatoencode* or *dns_txt_pwnage* or *do\\-exfiltration\\-dns* or *download_execute* or *download\\-execute\\-ps* or *downloadandextractfromremoteregistry* or *dumpcerts* or *dumpcreds* or *dumphashes* or *enable\\-duplicatetoken* or *enable\\-duplication* or *execute\\-command\\-mssql* or *execute\\-dnstxt\\-code* or *execute\\-ontime* or *exetotext* or *exfill* or *exfiloption* or *fakedc* or *firebuster* or *firelistener* or *get\\-information* or *get\\-passhints* or *get\\-web\\-credentials* or *get\\-webcredentials* or *get\\-wlan\\-keys* or *http\\-backdoor* or *invoke\\-amsibypass* or *invoke\\-bruteforce* or *invoke\\-credentialsphish* or *invoke\\-decode* or *invoke\\-encode* or *invoke\\-interceptor* or *invoke\\-jsratregsvr* or *invoke\\-jsratrundll* or *invoke\\-mimikatzwdigestdowngrade* or *invoke\\-networkrelay* or *invoke\\-powershellicmp* or *invoke\\-powershelludp* or *invoke\\-prasadhak* or *invoke\\-psgcat* or *invoke\\-psgcatagent* or *invoke\\-sessiongopher* or *invoke\\-ssidexfil* or *loggedkeys* or *nishang* or *notallnamespaces* or *out\\-chm* or *out\\-dnstxt* or *out\\-hta* or *out\\-rundllcommand* or *out\\-scf* or *out\\-sct* or *out\\-shortcut* or *out\\-webquery* or *out\\-word* or *parse_keys* or *password\\-list* or *powerpreter* or *remove\\-persistence* or *remove\\-poshrat* or *remove\\-update* or *run\\-exeonremote* or *set\\-dcshadowpermissions* or *set\\-remotepsremoting* or *set\\-remotewmi* or *shellcode32* or *shellcode64* or *stringtobase64* or *texttoexe*)
<li><a href="#">query: powershell.file.script_block_text:(*add\\-domaingroupmember* or *add\\-domainobjectacl* or *add\\-objectacl* or *add\\-remoteconnection* or *convert\\-adname* or *convertfrom\\-uacvalue* or *convert\\-nametosid* or *convertto\\-sid* or *export\\-powerviewcsv* or *find\\-domainlocalgroupmember* or *find\\-domainobjectpropertyoutlier* or *find\\-domainprocess* or *find\\-domainshare* or *find\\-domainuserevent* or *find\\-domainuserlocation* or *find\\-foreigngroup* or *find\\-foreignuser* or *find\\-gpocomputeradmin* or *find\\-gpolocation* or *find\\-interestingdomain* or *find\\-interestingfile* or *find\\-localadminaccess* or *find\\-managedsecuritygroups* or *get\\-adobject* or *get\\-cachedrdpconnection* or *get\\-dfsshare* or *get\\-dnsrecord* or *get\\-dnszone* or *get\\-domain* or *get\\-forest* or *get\\-ipaddress* or *get\\-lastloggedon* or *get\\-loggedonlocal* or *get\\-netcomputer* or *get\\-netdomain* or *get\\-netfileserver* or *get\\-netforest* or *get\\-netgpo* or *get\\-netgroup* or *get\\-netlocalgroup* or *get\\-netloggedon* or *get\\-netou* or *get\\-netprocess* or *get\\-netrdpsession* or *get\\-netsession* or *get\\-netshare* or *get\\-netsite* or *get\\-netsubnet* or *get\\-netuser* or *get\\-objectacl* or *get\\-pathacl* or *get\\-proxy* or *get\\-registrymounteddrive* or *get\\-regloggedon* or *get\\-sitename* or *get\\-userevent* or *get\\-wmiprocess* or *get\\-wmireg* or *invoke\\-aclscanner* or *invoke\\-checklocaladminaccess* or *invoke\\-enumeratelocaladmin* or *invoke\\-eventhunter* or *invoke\\-filefinder* or *invoke\\-kerberoast* or *invoke\\-mapdomaintrust* or *invoke\\-processhunter* or *invoke\\-reverttoself* or *invoke\\-sharefinder* or *invoke\\-userhunter* or *invoke\\-userimpersonation* or *new\\-domaingroup* or *new\\-domainuser* or *remove\\-remoteconnection* or *request\\-spnticket* or *resolve\\-ipaddress* or *set\\-adobject* or *set\\-domainobject* or *set\\-domainuserpassword* or *test\\-adminaccess*)
<li><a href="#">query: powershell.file.script_block_text:(*adjusttokenprivileges* or *image_nt_optional_hdr64_magic* or *microsoft.win32.unsafenativemethods* or *readprocessmemory.invoke* or *se_privilege_enabled* or *lsa_unicode_string* or *minidumpwritedump* or *page_execute_read* or *security_delegation* or *token_adjust_privileges* or *token_all_access* or *token_assign_primary* or *token_duplicate* or *token_elevation* or *token_impersonate* or *token_information_class* or *token_privileges* or *token_query* or *
<li><a href="#">query: powershell.file.script_block_text:(*disable\\-localuser* or *enable\\-localuser* or *get\\-localuser* or *set\\-localuser* or *new\\-localuser* or *rename\\-localuser* or *remove\\-localuser*)
<li><a href="#">query: powershell.file.script_block_text:(*function\\ get\\-adrexcelcomob* or *adrecon\\-report.xlsx*)
<li><a href="#">query: powershell.file.script_block_text:(*get\\-inbox.ps1* or *microsoft.office.interop.outlook* or *microsoft.office.interop.outlook.oldefaultfolders* or *\\-comobject\\ outlook.application*)
<li><a href="#">query: powershell.file.script_block_text:(*get\\-wmiobject* or *gwmi*)
<li><a href="#">query: powershell.file.script_block_text:(*import\\-module\\ \\\"$env\\:temp\\\\* or *import\\-module\\ '$env\\:temp\\\\* or *import\\-module\\ $env\\:temp\\\\* or *import\\-module\\ \\\"$env\\:appdata\\\\* or *import\\-module\\ '$env\\:appdata\\\\* or *import\\-module\\ $env\\:appdata\\\\* or *import\\-module\\ c\\:\\\\users\\\\public\\\\* or *ipmo\\ \\\"$env\\:temp\\\\* or *ipmo\\ '$env\\:temp\\\\* or *ipmo\\ $env\\:temp\\\\* or *ipmo\\ \\\"$env\\:appdata\\\\* or *ipmo\\ '$env\\:appdata\\\\* or *ipmo\\ $env\\:appdata\\\\* or *ipmo\\ c\\:\\\\users\\\\public\\\\*)
<li><a href="#">query: powershell.file.script_block_text:(*invoke\\-smbautobrute* or *invoke\\-gpolinks* or *invoke\\-potato*)
<li><a href="#">query: powershell.file.script_block_text:(*new\\-vm* or *set\\-vmfirmware* or *start\\-vm*)
<li><a href="#">query: powershell.file.script_block_text:(*remove\\-smbshare* or *remove\\-fileshare*)
<li><a href="#">query: powershell.file.script_block_text:(*set\\-alias\\ * or *new\\-alias\\ *)
<li><a href="#">query: powershell.file.script_block_text:(*system.directoryservices.protocols.ldapdirectoryidentifier* or *system.net.networkcredential* or *system.directoryservices.protocols.ldapconnection*)
<li><a href="#">query: powershell.file.script_block_text:(*system.reflection.assembly.load\\($* or *\\[system.reflection.assembly\\]\\:\\:load\\($* or *\\[reflection.assembly\\]\\:\\:load\\($* or *system.reflection.assemblyname* or *reflection.emit.assemblybuilderaccess* or *runtime.interopservices.dllimportattribute* or *suspendthread* or *rundll32* or *invoke\\-wmimethod* or *http\\:\\/\\/127.0.0.1*)
<li><a href="#">query: powershell.file.script_block_text:(*system.reflection.assembly.load\\($* or *\\[system.reflection.assembly\\]\\:\\:load\\($* or *\\[reflection.assembly\\]\\:\\:load\\($* or *system.reflection.assemblyname* or *reflection.emit.assemblybuilderaccess* or *runtime.interopservices.dllimportattribute* or *suspendthread* or *rundll32*)
<li><a href="#">query: powershell.file.script_block_text:(*wmimplant* or *\\ change_user\\ * or *\\ gen_cli\\ * or *\\ command_exec\\ * or *\\ disable_wdigest\\ * or *\\ disable_winrm\\ * or *\\ enable_wdigest\\ * or *\\ enable_winrm\\ * or *\\ registry_mod\\ * or *\\ remote_posh\\ * or *\\ sched_job\\ * or *\\ service_mod\\ * or *\\ process_kill\\ * or *\\ active_users\\ * or *\\ basic_info\\ * or *\\ power_off\\ * or *\\ vacant_system\\ * or *\\ logon_events\\ *)
<li><a href="#">query: powershell.file.script_block_text:(*x509enrollment.cbinaryconverter* or *884e2002\\-217d\\-11da\\-b2a4\\-000e7bbb2b09*)
<li><a href="#">query: powershell.file.script_block_text:*.copyfromscreen*
<li><a href="#">query: powershell.file.script_block_text:*\\[windows.input.keyboard\\]\\:\\:iskeydown\\(\\[system.windows.input.key\\]\\:\\:*
<li><a href="#">query: powershell.file.script_block_text:*enable\\-psremoting\\ *
<li><a href="#">query: powershell.file.script_block_text:*export\\-pfxcertificate*
<li><a href="#">query: powershell.file.script_block_text:*get\\-addefaultdomainpasswordpolicy*
<li><a href="#">query: powershell.file.script_block_text:*get\\-gpo*
<li><a href="#">query: powershell.file.script_block_text:*get\\-process*
<li><a href="#">query: powershell.file.script_block_text:*get\\-process\\ lsass*
<li><a href="#">query: powershell.file.script_block_text:*get\\-smbshare*
<li><a href="#">query: powershell.file.script_block_text:*invoke\\-azurehound*
<li><a href="#">query: powershell.file.script_block_text:*invoke\\-nightmare*
<li><a href="#">query: powershell.file.script_block_text:*new\\-localuser*
<li><a href="#">query: powershell.file.script_block_text:*promptforcredential*
<li><a href="#">query: powershell.file.script_block_text:*ps\\ attack\\!\\!\\!*
<li><a href="#">query: powershell.file.script_block_text:*start\\-dnscat2*
<li><a href="#">query: powershell.file.script_block_text:*syncappvpublishingserver.exe*
<li><a href="#">query: powershell.file.script_block_text:*system.directoryservices.accountmanagement*
<li><a href="#">query: powershell.file.script_block_text:*system.identitymodel.tokens.kerberosrequestorsecuritytoken*
<li><a href="#">query: powershell.file.script_block_text:*win32_pnpentity*
<li><a href="#">query: powershell.file.script_block_text:/(?i).*&&set.*(\\{\\d\\}){2,}\\\\\\\"\\s+?\\-f.*&&.*cmd.*\\/c/
<li><a href="#">query: powershell.file.script_block_text:/(?i).*(set).*&&\\s?set.*(environment|invoke|\\${?input).*&&.*\"/
<li><a href="#">query: powershell.file.script_block_text:/(?i).*?echo.*clip.*&&.*(clipboard|i`?n`?v`?o`?k`?e`?).*/
<li><a href="#">query: powershell.file.script_block_text:/.*cmd.{0,5}(?:\\/c|\\/r)(?:\\s|)\\\"set\\s[a-za-z]{3,6}.*(?:\\{\\d\\}){1,}\\\\\\\"\\s+?\\-f(?:.*\\)){1,}.*\\\"/
<li><a href="#">query: powershell.file.script_block_text:/.*cmd.{0,5}(?:\\/c|\\/r).+clip(?:\\.exe)?.{0,4}&&.+clipboard]::\\(\\s\\\\\\\"\\{\\d\\}.+\\-f.+\\\"/
<li><a href="#">query: powershell.file.script_block_text:/.*cmd.{0,5}(?:\\/c|\\/r).+powershell.+(?:\\$\\{?input\\}?|noexit).+\\\"/
<li><a href="#">query: process.command_line.text:(*.downloadstring\\(* or *.downloadfile\\(* or *invoke\\-webrequest\\ * or *iwr\\ *)
<li><a href="#">query: process.command_line.text:(*\\ \\-accepteula* or *\\ \\/accepteula*)
<li><a href="#">query: process.command_line.text:(*\\^\\^* or *,;,* or *%comspec\\:\\~* or *\\ s\\^et\\ * or *\\ s\\^e\\^t\\ * or *\\ se\\^t\\ *)
<li><a href="#">query: process.command_line.text:(*\\~1.* or *\\~2.*)
<li><a href="#">query: process.command_line.text:(*checkadmin.exe\\ 127.0.0.1\\ \\-all* or *netsh\\ advfirewall\\ firewall\\ add\\ rule\\ name\\=powershell\\ dir\\=in* or *cmd\\ \\/c\\ powershell.exe\\ \\-ep\\ bypass\\ \\-file\\ c\\:\\\\s.ps1* or *\\/tn\\ win32times\\ \\/f* or *create\\ win32times\\ binpath\\=* or *\\\\c$\\\\windows\\\\system32\\\\devmgr.dll* or *\\ \\-exec\\ bypass\\ \\-enc\\ jgag* or *type\\ *keepass\\\\keepass.config.xml* or *iie.exe\\ iie.txt* or *reg\\ query\\ hkey_current_user\\\\software\\\\*\\\\putty\\\\sessions\\\\*)
<li><a href="#">query: process.command_line.text:(*domainlist* or *trustdmp* or *dcmodes* or *adinfo* or *\\ dclist\\ * or *computer_pwdnotreqd* or *objectcategory\\=* or *\\-subnets\\ \\-f* or *name\\=\\\"domain\\ admins\\\"* or *\\-sc\\ u\\:* or *domainncs* or *dompol* or *\\ oudmp\\ * or *subnetdmp* or *gpodmp* or *fspdmp* or *users_noexpire* or *computers_active* or *computers_pwdnotreqd*)
<li><a href="#">query: process.command_line.text:(*eyj0exaioi* or *\\ eyj0ex* or *\\ \\\"eyj0ex\\\"* or *\\ 'eyj0ex'*)
<li><a href="#">query: process.command_line.text:(*get\\-process\\ lsas* or *ps\\ lsas* or *gps\\ lsas*)
<li><a href="#">query: process.command_line.text:(*if\\(0\\)\\{\\{\\{0\\}\\}\\}'\\ \\-f\\ $\\(0\\ \\-as\\ \\[char\\]\\)\\ \\+* or *#<null>*)
<li><a href="#">query: process.command_line.text:(*import\\-module\\ \\\"$env\\:temp\\\\* or *import\\-module\\ '$env\\:temp\\\\* or *import\\-module\\ $env\\:temp\\\\* or *import\\-module\\ \\\"$env\\:appdata\\\\* or *import\\-module\\ '$env\\:appdata\\\\* or *import\\-module\\ $env\\:appdata\\\\* or *import\\-module\\ c\\:\\\\users\\\\public\\\\* or *ipmo\\ \\\"$env\\:temp\\\\* or *ipmo\\ '$env\\:temp\\\\* or *ipmo\\ $env\\:temp\\\\* or *ipmo\\ \\\"$env\\:appdata\\\\* or *ipmo\\ '$env\\:appdata\\\\* or *ipmo\\ $env\\:appdata\\\\* or *ipmo\\ c\\:\\\\users\\\\public\\\\*)
<li><a href="#">query: process.command_line.text:(*invoke\\-webrequest* or *iwr\\ * or *wget\\ * or *curl\\ * or *net.webclient* or *start\\-bitstransfer* or *resume\\-bitstransfer* or *\\[system.net.webrequest\\]\\:\\:create* or *invoke\\-restmethod* or *winhttp.winhttprequest*)
<li><a href="#">query: process.command_line.text:(*invoke\\-webrequest* or *iwr\\ * or *wget\\ * or *curl\\ * or *net.webclient* or *start\\-bitstransfer*)
<li><a href="#">query: process.command_line.text:(*iyevymlul2jhc2* or *iyevymlul2rhc2* or *iyevymlul3pza* or *iyevymlul2zpc2* or *iyevymlul3no*)
<li><a href="#">query: process.command_line.text:(*rm\\ \\/var\\/log\\/syslog* or *rm\\ \\-r\\ \\/var\\/log\\/syslog* or *rm\\ \\-f\\ \\/var\\/log\\/syslog* or *rm\\ \\-rf\\ \\/var\\/log\\/syslog* or *unlink\\ \\/var\\/log\\/syslog* or *unlink\\ \\-r\\ \\/var\\/log\\/syslog* or *unlink\\ \\-f\\ \\/var\\/log\\/syslog* or *unlink\\ \\-rf\\ \\/var\\/log\\/syslog* or *mv\\ \\/var\\/log\\/syslog* or *\\ >\\/var\\/log\\/syslog* or *\\ >\\ \\/var\\/log\\/syslog*)
<li><a href="#">query: process.command_line.text:(*system.management.automation.amsiutils* or *amsiinitfailed*)
<li><a href="#">query: process.command_line.text:(*x509enrollment.cbinaryconverter* or *884e2002\\-217d\\-11da\\-b2a4\\-000e7bbb2b09*)
<li><a href="#">query: process.command_line.text:(net\\ use\\ \\\\\\\\%domaincontroller%\\\\c$\\ \\\"p@ssw0rd\\\"\\ * or dir\\ c\\:\\\\*.doc*\\ \\/s or dir\\ %temp%\\\\*.exe)
<li><a href="#">query: process.command_line.text:*\\(wchar\\)0x*
<li><a href="#">query: process.command_line.text:*\\\\software\\\\microsoft\\\\windows\\\\currentversion\\\\explorer\\\\typedpaths*
<li><a href="#">query: process.command_line.text:*install\\-transportagent*
<li><a href="#">query: process.command_line.text:\"rundll32.exe\
<li><a href="#">query: process.command_line.text:c\\:\\\\windows\\\\sysnative\\\\*
<li><a href="#">query: process.command_line:(*.bash_history* or *.zsh_history* or *.zhistory* or *.history* or *.sh_history* or *fish_history*)
<li><a href="#">query: process.command_line:(*\\ \\/am51* or *\\ \\/password*)
<li><a href="#">query: process.command_line:(*\\ \\-\\-cpu\\-priority\\=* or *\\-\\-donate\\-level\\=0* or *\\ \\-o\\ pool.* or *\\ \\-\\-nicehash* or *\\ \\-\\-algo\\=rx\\/0\\ * or *stratum\\+tcp\\:\\/\\/* or *stratum\\+udp\\:\\/\\/* or *ls1kb25hdgutbgv2zww9* or *0tzg9uyxrllwxldmvsp* or *tlwrvbmf0zs1szxzlbd* or *c3ryyxr1bst0y3a6ly* or *n0cmf0dw0rdgnwoi8v* or *zdhjhdhvtk3rjcdovl* or *c3ryyxr1bst1zha6ly* or *n0cmf0dw0rdwrwoi8v* or *zdhjhdhvtk3vkcdovl*)
<li><a href="#">query: process.command_line:(*\\ \\-\\-cpu\\-priority\\=* or *\\-\\-donate\\-level\\=0* or *\\ \\-o\\ pool.* or *\\ \\-\\-nicehash* or *\\ \\-\\-algo\\=rx\\/0\\ * or *stratum\\+tcp\\:\\/\\/* or *stratum\\+udp\\:\\/\\/* or *sh\\ \\-c\\ \\/sbin\\/modprobe\\ msr\\ allow_writes\\=on* or *ls1kb25hdgutbgv2zww9* or *0tzg9uyxrllwxldmvsp* or *tlwrvbmf0zs1szxzlbd* or *c3ryyxr1bst0y3a6ly* or *n0cmf0dw0rdgnwoi8v* or *zdhjhdhvtk3rjcdovl* or *c3ryyxr1bst1zha6ly* or *n0cmf0dw0rdwrwoi8v* or *zdhjhdhvtk3vkcdovl*)
<li><a href="#">query: process.command_line:(*\\ \\-e*\\ paa* or *jablag4adga6ahuacwblahiacabyag8azgbpagwazq* or *qazqbuahyaogb1ahmazqbyahaacgbvagyaaqbsagua* or *kaguabgb2adoadqbzaguacgbwahiabwbmagkababla* or *igaoaccakganackaowaka* or *iakaanacoajwapadsaja* or *iacgajwaqaccakqa7acqa* or *jabgagwaeabyaggaywbmagq* or *pqakaguabgb2adoadablag0acaaracga* or *0ajablag4adga6ahqazqbtahaakwaoa* or *9acqazqbuahyaogb0aguabqbwacsaka*)
<li><a href="#">query: process.command_line:(*\\ \\-nop\\ \\-noni\\ \\-w\\ hidden\\ \\-c\\ $x\\=$\\(\\(gp\\ hkcu\\:software\\\\microsoft\\\\windows\\ update\\).update\\)* or *\\ \\-nop\\ \\-noni\\ \\-c\\ $x\\=$\\(\\(gp\\ hkcu\\:software\\\\microsoft\\\\windows\\ update\\).update\\);*)
<li><a href="#">query: process.command_line:(*\\ \\-nop\\ \\-sta\\ \\-noni\\ \\-w\\ hidden\\ \\-enc\\ * or *\\ \\-nop\\ \\-sta\\ \\-w\\ 1\\ \\-enc\\ * or *\\ \\-nop\\ \\-noni\\ \\-w\\ hidden\\ \\-enc\\ * or *\\ \\-nop\\ \\-sta\\ \\-w\\ 1\\ \\-enc* or *\\ \\-enc\\ \\ sqb* or *\\ \\-nop\\ \\-exec\\ bypass\\ \\-encodedcommand\\ *)
<li><a href="#">query: process.command_line:(*\\ asreproast\\ * or *\\ dump\\ \\/service\\:krbtgt\\ * or *\\ kerberoast\\ * or *\\ createnetonly\\ \\/program\\:* or *\\ ptt\\ \\/ticket\\:* or *\\ \\/impersonateuser\\:* or *\\ renew\\ \\/ticket\\:* or *\\ asktgt\\ \\/user\\:* or *\\ harvest\\ \\/interval\\:* or *\\ s4u\\ \\/user\\:* or *\\ s4u\\ \\/ticket\\:* or *\\ hash\\ \\/password\\:*)
<li><a href="#">query: process.command_line:(*\\/logon\\:none* or *\\/system\\:none* or *\\/sam\\:none* or *\\/privilege\\:none* or *\\/object\\:none* or *\\/process\\:none* or *\\/policy\\:none*)
<li><a href="#">query: process.command_line:(*\\\\msdt.exe* or *\\\\installutil.exe* or *\\\\regsvcs.exe* or *\\\\regasm.exe* or *\\\\msbuild.exe* or *\\\\ieexec.exe*)
<li><a href="#">query: process.command_line:(*\\-property\\ dword\\ \\-name\\ disablefirstruncustomize\\ \\-value\\ 2\\ \\-force* or *\\-property\\ string\\ \\-name\\ check_associations\\ \\-value* or *\\-property\\ dword\\ \\-name\\ ieharden\\ \\-value\\ 0\\ \\-force*)
<li><a href="#">query: process.command_line:(*>\\ \\\\\\\\127.0.0.1\\\\admin$* or *>\\ \\\\\\\\localhost\\\\admin$*)
<li><a href="#">query: process.command_line:(*â* or *€* or *£* or *¯* or *®* or *µ* or *¶*)
<li><a href="#">query: process.command_line:(*ã£â¢* or *ã¢ââ¬* or *ã¢â£* or *ã¢â¯* or *ã¢â®* or *ã¢âµ* or *ã¢â¶*)
<li><a href="#">query: process.command_line:(*arp.exe* or *at.exe* or *attrib.exe* or *cscript.exe* or *dsquery.exe* or *hostname.exe* or *ipconfig.exe* or *mimikatz.exe* or *nbtstat.exe* or *net.exe* or *netsh.exe* or *nslookup.exe* or *ping.exe* or *quser.exe* or *qwinsta.exe* or *reg.exe* or *runas.exe* or *sc.exe* or *schtasks.exe* or *ssh.exe* or *systeminfo.exe* or *taskkill.exe* or *telnet.exe* or *tracert.exe* or *wscript.exe* or *xcopy.exe* or *pscp.exe* or *copy.exe* or *robocopy.exe* or *certutil.exe* or *vssadmin.exe* or *powershell.exe* or *pwsh.exe* or *wevtutil.exe* or *psexec.exe* or *bcedit.exe* or *wbadmin.exe* or *icacls.exe* or *diskpart.exe*)
<li><a href="#">query: process.command_line:(*arp.exe* or *at.exe* or *attrib.exe* or *cscript.exe* or *dsquery.exe* or *hostname.exe* or *ipconfig.exe* or *mimikatz.exe* or *nbtstat.exe* or *net.exe* or *netsh.exe* or *nslookup.exe* or *ping.exe* or *quser.exe* or *qwinsta.exe* or *reg.exe* or *runas.exe* or *sc.exe* or *schtasks.exe* or *ssh.exe* or *systeminfo.exe* or *taskkill.exe* or *telnet.exe* or *tracert.exe* or *wscript.exe* or *xcopy.exe* or *pscp.exe* or *copy.exe* or *robocopy.exe* or *certutil.exe* or *vssadmin.exe* or *powershell.exe* or *wevtutil.exe* or *psexec.exe* or *bcedit.exe* or *wbadmin.exe* or *icacls.exe* or *diskpart.exe*)
<li><a href="#">query: process.command_line:(*checkadmin.exe\\ 127.0.0.1\\ \\-all* or *netsh\\ advfirewall\\ firewall\\ add\\ rule\\ name\\=powershell\\ dir\\=in* or *cmd\\ \\/c\\ powershell.exe\\ \\-ep\\ bypass\\ \\-file\\ c\\:\\\\s.ps1* or *\\/tn\\ win32times\\ \\/f* or *create\\ win32times\\ binpath\\=* or *\\\\c$\\\\windows\\\\system32\\\\devmgr.dll* or *\\ \\-exec\\ bypass\\ \\-enc\\ jgag* or *type\\ *keepass\\\\keepass.config.xml* or *iie.exe\\ iie.txt* or *reg\\ query\\ hkey_current_user\\\\software\\\\*\\\\putty\\\\sessions\\\\*)
<li><a href="#">query: process.command_line:(*domainlist* or *trustdmp* or *dcmodes* or *adinfo* or *\\ dclist\\ * or *computer_pwdnotreqd* or *objectcategory\\=* or *\\-subnets\\ \\-f* or *name\\=\\\"domain\\ admins\\\"* or *\\-sc\\ u\\:* or *domainncs* or *dompol* or *\\ oudmp\\ * or *subnetdmp* or *gpodmp* or *fspdmp* or *users_noexpire* or *computers_active*)
<li><a href="#">query: process.command_line:(*grpconv.exe\\ \\-o* or *grpconv\\ \\-o*)
<li><a href="#">query: process.command_line:(*h\\^t\\^t\\^p* or *h\\\"t\\\"t\\\"p*)
<li><a href="#">query: process.command_line:(*iex\\ \\(\\(new\\-object\\ net.webclient\\).downloadstring* or *iex\\ \\(new\\-object\\ net.webclient\\).downloadstring* or *iex\\(\\(new\\-object\\ net.webclient\\).downloadstring* or *iex\\(new\\-object\\ net.webclient\\).downloadstring* or *\\ \\-command\\ \\(new\\-object\\ system.net.webclient\\).downloadfile\\(* or *\\ \\-c\\ \\(new\\-object\\ system.net.webclient\\).downloadfile\\(*)
<li><a href="#">query: process.command_line:(*invoke\\-webrequest* or *iwr\\ * or *wget\\ * or *curl\\ * or *net.webclient* or *start\\-bitstransfer*)
<li><a href="#">query: process.command_line:(*ipconfig\\ \\/all* or *netsh\\ interface\\ show\\ interface* or *arp\\ \\-a* or *nbtstat\\ \\-n* or *net\\ config* or *route\\ print*)
<li><a href="#">query: process.command_line:(*ipconfig\\ \\/all* or *netsh\\ interface\\ show\\ interface* or *arp\\ \\-a* or *nbtstat\\ \\-n* or *net\\ config*)
<li><a href="#">query: process.command_line:(*net\\ group\\ \\\"domain\\ admins\\\"* or *net\\ localgroup\\ administrators* or *net\\ group\\ \\\"enterprise\\ admins\\\"* or *net\\ accounts\\ \\/do*)
<li><a href="#">query: process.command_line:(*ojpgcm9tqmfzzty0u3ryaw5n* or *o6rnjvbujhc2u2nfn0cmluz* or *6okzyb21cyxnlnjrtdhjpbm*)
<li><a href="#">query: process.command_line:(*powercat\\ * or *powercat.ps1*)
<li><a href="#">query: process.command_line:(*printnightmare.gentilkiwi.com* or *\\ \\/user\\:gentilguest\\ * or *kiwi\\ legit\\ printer*)
<li><a href="#">query: process.command_line:(*rm\\ \\/var\\/log\\/syslog* or *rm\\ \\-r\\ \\/var\\/log\\/syslog* or *rm\\ \\-f\\ \\/var\\/log\\/syslog* or *rm\\ \\-rf\\ \\/var\\/log\\/syslog* or *mv\\ \\/var\\/log\\/syslog* or *\\ >\\/var\\/log\\/syslog* or *\\ >\\ \\/var\\/log\\/syslog*)
<li><a href="#">query: process.command_line:(*shutdown\\ \\/r\\ \\/f\\ \\/t\\ 00* or *net\\ stop\\ superbackupman*)
<li><a href="#">query: process.command_line:(*sqbuahyabwbragualqbcagwabwbvagqasabvahuabgbka* or *kabgb2ag8aawblac0aqgbsag8abwbkaegabwb1ag4aza* or *jag4adgbvagsazqataeiababvag8azabiag8adqbuagqa* or *sqbuahyabwbragualqbnagkabqbpagsayqb0ahoa* or *kabgb2ag8aawblac0atqbpag0aaqbrageadab6a* or *jag4adgbvagsazqatae0aaqbtagkaawbhahqaeg* or *sqbuahyabwbragualqbxae0asqbfahgazqbja* or *kabgb2ag8aawblac0avwbnaekarqb4aguayw* or *jag4adgbvagsazqatafcatqbjaeuaeablagma*)
<li><a href="#">query: process.command_line:(*suvyichb* or *lfwcaow* or *jrvggkf* or *awv4ichb* or *llecaow* or *pzxggkf* or *awv4ichozx* or *llecaotmv3* or *pzxggke5ld* or *suvyichozx* or *lfwcaotmv3* or *jrvggke5ld*)
<li><a href="#">query: process.command_line:(*tvqqaamaaaaeaaaa* or *tvpqaaiaaaaeaa8a* or *tvqaaaeaaaaeabaa* or *tvoaaaaaaaaaaaaa* or *tvptaqeaaaaeaaaa*)
<li><a href="#">query: process.command_line:(*type\\ %windir%\\\\system32\\\\ntdll.dll* or *type\\ %systemroot%\\\\system32\\\\ntdll.dll* or *type\\ c\\:\\\\windows\\\\system32\\\\ntdll.dll* or *\\\\ntdll.dll\\ >\\ \\\\\\\\.\\\\pipe\\\\\\*)
<li><a href="#">query: process.command_line:(*vwbpag4amwayaf8auwboageazabvahcaywbvahaaeqagahwaiabgag8acgbfageaywboac0atwbiagoazqbjahqa* or *caaqbuadmamgbfafmaaabhagqabwb3agmabwbwahkaiab8acaargbvahiarqbhagmaaaatae8aygbqaguaywb0a* or *xagkabgazadiaxwbtaggayqbkag8adwbjag8acab5acaafaagaeyabwbyaeuayqbjaggalqbpagiaagblagmada*)
<li><a href="#">query: process.command_line:(*wwbsaguazgbsaguaywb0agkabwbuac4aqqbzahmazqbtagiabab5af0aoga6aewabwbhagqaka* or *saugblagyabablagmadabpag8abgauaeeacwbzaguabqbiagwaeqbdadoaogbmag8ayqbkacga* or *bafiazqbmagwazqbjahqaaqbvag4algbbahmacwblag0aygbsahkaxqa6adoatabvageazaaoa*)
<li><a href="#">query: process.command_line:(*xcopy*\\\\system32\\\\* or *cmd.exe*\\/c*copy*\\\\system32\\\\*)
<li><a href="#">query: process.command_line:(\"net\\ group\\ \\\"domain\\ admins\\\"\\ \\/dom\" or \"net\\ localgroup\\ administrators\" or \"net\\ group\\ \\\"enterprise\\ admins\\\"\\ \\/dom\" or \"net\\ accounts\\ \\/dom\")
<li><a href="#">query: process.command_line:(\"reg\\ query\\ \\\"hkey_current_user\\\\software\\\\microsoft\\\\terminal\\ server\\ client\\\\default\\\"\" or powershell.exe\\ mshta.exe\\ http* or \"cmd.exe\\ \\/c\\ taskkill\\ \\/im\\ cmd.exe\")
<li><a href="#">query: process.command_line:(\"vssadmin.exe\\ delete\\ shadows\" or \"vssadmin\\ create\\ shadow\\ \\/for\\=c\\:\" or copy\\ \\\\?\\\\globalroot\\\\device\\\\*\\\\windows\\\\ntds\\\\ntds.dit or copy\\ \\\\?\\\\globalroot\\\\device\\\\*\\\\config\\\\sam or \"vssadmin\\ delete\\ shadows\\ \\/for\\=c\\:\" or \"reg\\ save\\ hklm\\\\system\\ \" or esentutl.exe\\ \\/y\\ \\/vss\\ *\\\\ntds.dit* or esentutl.exe\\ \\/y\\ \\/vss\\ *\\\\sam or esentutl.exe\\ \\/y\\ \\/vss\\ *\\\\system)
<li><a href="#">query: process.command_line:(net\\ use\\ \\\\%domaincontroller%\\\\c$\\ \\\"p@ssw0rd\\\"\\ * or dir\\ c\\:\\\\*.doc*\\ \\/s or dir\\ %temp%\\\\*.exe)
<li><a href="#">query: process.command_line:*.exe\\ whoami*
<li><a href="#">query: process.command_line:*\\ \\/dest\\:rdp\\-tcp\\:*
<li><a href="#">query: process.command_line:*\\ \\/injectrunning\\ *
<li><a href="#">query: process.command_line:*\\ \\-accepteula*
<li><a href="#">query: process.command_line:*\\ echo\\ eeee\\ >\\ *
<li><a href="#">query: process.command_line:*\\ runassystem\\ *
<li><a href="#">query: process.command_line:*\\(wchar\\)0x*
<li><a href="#">query: process.command_line:*\\:\\:frombase64string\\(*
<li><a href="#">query: process.command_line:*\\-i\\ sm\\-tgytutrc\\ \\-s*
<li><a href="#">query: process.command_line:*abccccccccccccccccccccccccccccccccccccccccccccccc*
<li><a href="#">query: process.command_line:*complus_etwenabled\\=0*
<li><a href="#">query: process.command_line:*copy\\ \\\\\\\\\\?\\\\globalroot\\\\device\\\\harddiskvolumeshadowcopy*
<li><a href="#">query: process.command_line:*extexport.exe*
<li><a href="#">query: process.command_line:*get\\-nettcpconnection*
<li><a href="#">query: process.command_line:*get\\-process\\ lsass*
<li><a href="#">query: process.command_line:*install\\-transportagent*
<li><a href="#">query: process.command_line:*loaddll\\ \\-a\\ *
<li><a href="#">query: process.command_line:*sc\\ query*
<li><a href="#">query: process.command_line:*start\\ \\/min\\ msedge*
<li><a href="#">query: process.command_line:*windowsaudiodevice\\-powershell\\-cmdlet*
<li><a href="#">query: process.command_line:/(?i).*&&.*rundll32.*shell32\\.dll.*shellexec_rundll.*(value|invoke|comspec|iex).*\"/
<li><a href="#">query: process.command_line:/(?i).*&&set.*(\\{\\d\\}){2,}\\\\\\\"\\s+?\\-f.*&&.*cmd.*\\/c/
<li><a href="#">query: process.command_line:/(?i).*(echo|copy|type|file createnew|cacls).*c:\\\\\\\\windows\\\\\\\\fonts\\\\\\\\.*(.sh|.exe|.dll|.bin|.bat|.cmd|.js|.msh|.reg|.scr|.ps|.vb|.jar|.pl|.inf|.cpl|.hta|.msi|.vbs).*/
<li><a href="#">query: process.command_line:/(?i).*(set).*&&\\s?set.*(environment|invoke|\\${?input).*&&.*\"/
<li><a href="#">query: process.command_line:/(?i).*(set).*(&&).*(mshta).*(vbscript:createobject).*(\\.run).*\\(window\\.close\\).*\"/
<li><a href="#">query: process.command_line:/(?i).*?echo.*clip.*&&.*(clipboard|i`?n`?v`?o`?k`?e`?).*/
<li><a href="#">query: process.command_line:/(?i).*new-object.*(?:system\\.io\\.compression\\.deflatestream|system\\.io\\.streamreader).*text\\.encoding\\]::ascii.*readtoend/
<li><a href="#">query: process.command_line:/(?i).*reg add.*hklm\\\\\\\\system\\\\\\\\currentcontrolset\\\\\\\\control.*(storage|storagedevicepolicies).*write protection.*0.*/
<li><a href="#">query: process.command_line:/(?i).*rundll32(?:\\.exe)?(?:\\s+)?shell32\\.dll.*shellexec_rundll.*powershell.*\\\"/
<li><a href="#">query: process.command_line:/(?i).*schtasks.*(-|\\/)r.*\\\\\\\\application experience\\\\\\\\microsoft compatibility appraiser.*/
<li><a href="#">query: process.command_line:/.*cmd.{0,5}(?:\\/c|\\/r)(?:\\s|)\\\"set\\s[a-za-z]{3,6}.*(?:\\{\\d\\}){1,}\\\\\\\"\\s+?\\-f(?:.*\\)){1,}.*\\\"/
<li><a href="#">query: process.command_line:/.*cmd.{0,5}(?:\\/c|\\/r).+clip(?:\\.exe)?.{0,4}&&.+clipboard]::\\(\\s\\\\\\\"\\{\\d\\}.+\\-f.+\\\"/
<li><a href="#">query: process.command_line:/.*cmd.{0,5}(?:\\/c|\\/r).+powershell.+(?:\\$\\{?input\\}?|noexit).+\\\"/
<li><a href="#">query: process.command_line:\"c\\:\\\\windows\\\\psexesvc.exe\
<li><a href="#">query: process.command_line:\"copy\\ \\/y\\ c\\:\\\\windows\\\\system32\\\\cmd.exe\\ c\\:\\\\windows\\\\system32\\\\sethc.exe\
<li><a href="#">query: process.command_line:\"ps.exe\\ \\-accepteula\
<li><a href="#">query: process.command_line:\"rundll32.exe\
<li><a href="#">query: process.executable.text:(*\\/rm or *\\/shred or *\\/unlink)
<li><a href="#">query: process.executable.text:(*\\/sqlmap or *\\/teamserver or *\\/aircrack\\-ng or *\\/john or *\\/setoolkit or *\\/wpscan or *\\/hydra or *\\/nikto)
<li><a href="#">query: process.executable.text:(*\\/who or *\\/w or *\\/last or *\\/lsof or *\\/netstat)
<li><a href="#">query: process.executable.text:*\\/curl
<li><a href="#">query: process.executable.text:*\\/groupdel
<li><a href="#">query: process.executable.text:*\\/userdel
<li><a href="#">query: process.executable.text:*\\\\devicecredentialdeployment.exe
<li><a href="#">query: process.executable.text:*\\\\regsvr32.exe
<li><a href="#">query: process.executable.text:*\\\\scrcons.exe
<li><a href="#">query: process.executable.text:*\\\\temporary\\ internet\\ files\\\\content.outlook\\\\*
<li><a href="#">query: process.executable.text:\"c\\:\\\\windows\\\\adfs\\\\version.dll\
<li><a href="#">query: process.executable:(*.doc.exe or *.docx.exe or *.xls.exe or *.xlsx.exe or *.ppt.exe or *.pptx.exe or *.rtf.exe or *.pdf.exe or *.txt.exe or *\\ \\ \\ \\ \\ \\ .exe or *______.exe)
<li><a href="#">query: process.executable:(*\\/at or *\\/atd)
<li><a href="#">query: process.executable:(*\\/ps or *\\/top)
<li><a href="#">query: process.executable:(*\\/rm or *\\/shred)
<li><a href="#">query: process.executable:(*\\/shutdown or *\\/reboot or *\\/halt)
<li><a href="#">query: process.executable:(*\\/tcpdump or *\\/tshark)
<li><a href="#">query: process.executable:(*\\/uname or *\\/hostname or *\\/uptime or *\\/lspci or *\\/dmidecode or *\\/lscpu or *\\/lsmod)
<li><a href="#">query: process.executable:(*\\/update\\-ca\\-certificates or *\\/update\\-ca\\-trust)
<li><a href="#">query: process.executable:(*\\/who or *\\/w or *\\/last or *\\/lsof or *\\/netstat)
<li><a href="#">query: process.executable:(*\\\\plink.exe or *\\\\socat.exe or *\\\\stunnel.exe or *\\\\httptunnel.exe)
<li><a href="#">query: process.executable:(*\\\\tor.exe or *\\\\tor\\ browser\\\\browser\\\\firefox.exe)
<li><a href="#">query: process.executable:(\"\\/usr\\/bin\\/who\" or \"\\/usr\\/bin\\/w\" or \"\\/usr\\/bin\\/last\" or \"\\/usr\\/sbin\\/lsof\" or \"\\/usr\\/sbin\\/netstat\")
<li><a href="#">query: process.executable:*.zip\\\\*
<li><a href="#">query: process.executable:*\\/doas
<li><a href="#">query: process.executable:*\\/nohup
<li><a href="#">query: process.executable:*\\/split
<li><a href="#">query: process.executable:*\\\\crackmapexec.exe
<li><a href="#">query: process.executable:*\\\\dnx.exe
<li><a href="#">query: process.executable:*\\\\eqnedt32.exe
<li><a href="#">query: process.executable:*\\\\finger.exe
<li><a href="#">query: process.executable:*\\\\hostname.exe
<li><a href="#">query: process.executable:*\\\\ilasm.exe
<li><a href="#">query: process.executable:*\\\\ntdsutil.exe
<li><a href="#">query: process.executable:*\\\\ntvdm.exe
<li><a href="#">query: process.executable:*\\\\regedit.exe
<li><a href="#">query: process.executable:*\\\\regsvr32.exe
<li><a href="#">query: process.executable:*\\\\scrcons.exe
<li><a href="#">query: process.executable:*\\\\syncappvpublishingserver.exe
<li><a href="#">query: process.executable:*\\\\systeminfo.exe
<li><a href="#">query: process.executable:*\\\\tapinstall.exe
<li><a href="#">query: process.executable:*\\\\temporary\\ internet\\ files\\\\content.outlook\\\\*
<li><a href="#">query: process.executable:*\\\\ttdinject.exe
<li><a href="#">query: process.executable:*\\\\whoami.exe
<li><a href="#">query: process.executable:*c\\:\\\\windows\\ \\\\system32\\\\*
<li><a href="#">query: process.executable:*rasdial.exe
<li><a href="#">query: process.executable:*wuauclt*
<li><a href="#">query: process.executable:\"\\/usr\\/sbin\\/screencapture\
<li><a href="#">query: process.executable:\"c\\:\\\\windows\\\\adfs\\\\version.dll\
<li><a href="#">query: process.executable:\"c\\:\\\\windows\\\\system32\\\\wbem\\\\scrcons.exe\
<li><a href="#">query: process.executable:\"c\\:\\\\windows\\\\system32\\\\wpbbin.exe\
<li><a href="#">query: process.parent.command_line.text:(*.doc.lnk* or *.docx.lnk* or *.xls.lnk* or *.xlsx.lnk* or *.ppt.lnk* or *.pptx.lnk* or *.rtf.lnk* or *.pdf.lnk* or *.txt.lnk*)
<li><a href="#">query: process.parent.command_line:c\\:\\\\windows\\\\system32\\\\svchost.exe\\ \\-k\\ rpcss*
<li><a href="#">query: process.parent.executable.text:*\\\\defaultpack.exe
<li><a href="#">query: process.parent.executable.text:*\\\\runexehelper.exe
<li><a href="#">query: process.parent.executable.text:*\\\\sigverif.exe
<li><a href="#">query: process.parent.executable.text:*\\\\tttracer.exe
<li><a href="#">query: process.parent.executable.text:\"c:\\windows\\system32\\openssh\\sshd.exe\
<li><a href="#">query: process.parent.executable:(*\\\\pcalua.exe or *\\\\forfiles.exe)
<li><a href="#">query: process.parent.executable:*\\\\cmstp.exe
<li><a href="#">query: process.parent.executable:*\\\\edgetransport.exe
<li><a href="#">query: process.parent.executable:*\\\\eqnedt32.exe
<li><a href="#">query: process.parent.executable:*\\\\fodhelper.exe
<li><a href="#">query: process.parent.executable:*\\\\pcwrun.exe
<li><a href="#">query: process.parent.executable:*\\\\sdclt.exe
<li><a href="#">query: process.parent.executable:*\\\\tttracer.exe
<li><a href="#">query: process.parent.executable:*\\\\wsreset.exe
<li><a href="#">query: properties.message:(\"delete\\ application\" or \"hard\\ delete\\ application\")
<li><a href="#">query: properties.message:(\"delete\\ device\" or \"delete\\ device\\ configuration\" or \"update\\ device\" or \"update\\ device\\ configuration\")
<li><a href="#">query: properties.message:(\"device\\ no\\ longer\\ compliant\" or \"device\\ no\\ longer\\ managed\")
<li><a href="#">query: properties.message:(\"microsoft.containerregistry\\/registries\\/write\" or \"microsoft.containerregistry\\/registries\\/delete\")
<li><a href="#">query: properties.message:(\"microsoft.keyvault\\/vaults\\/keys\\/update\\/action\" or \"microsoft.keyvault\\/vaults\\/keys\\/create\" or \"microsoft.keyvault\\/vaults\\/keys\\/create\\/action\" or \"microsoft.keyvault\\/vaults\\/keys\\/import\\/action\" or \"microsoft.keyvault\\/vaults\\/keys\\/recover\\/action\" or \"microsoft.keyvault\\/vaults\\/keys\\/restore\\/action\" or \"microsoft.keyvault\\/vaults\\/keys\\/delete\" or \"microsoft.keyvault\\/vaults\\/keys\\/backup\\/action\" or \"microsoft.keyvault\\/vaults\\/keys\\/purge\\/action\")
<li><a href="#">query: properties.message:(\"microsoft.keyvault\\/vaults\\/secrets\\/write\" or \"microsoft.keyvault\\/vaults\\/secrets\\/delete\" or \"microsoft.keyvault\\/vaults\\/secrets\\/backup\\/action\" or \"microsoft.keyvault\\/vaults\\/secrets\\/purge\\/action\" or \"microsoft.keyvault\\/vaults\\/secrets\\/update\\/action\" or \"microsoft.keyvault\\/vaults\\/secrets\\/recover\\/action\" or \"microsoft.keyvault\\/vaults\\/secrets\\/restore\\/action\" or \"microsoft.keyvault\\/vaults\\/secrets\\/setsecret\\/action\")
<li><a href="#">query: properties.message:(\"microsoft.keyvault\\/vaults\\/write\" or \"microsoft.keyvault\\/vaults\\/delete\" or \"microsoft.keyvault\\/vaults\\/deploy\\/action\" or \"microsoft.keyvault\\/vaults\\/accesspolicies\\/write\")
<li><a href="#">query: properties.message:(\"microsoft.kubernetes\\/connectedclusters\\/configmaps\\/write\" or \"microsoft.kubernetes\\/connectedclusters\\/configmaps\\/delete\" or \"microsoft.kubernetes\\/connectedclusters\\/secrets\\/write\" or \"microsoft.kubernetes\\/connectedclusters\\/secrets\\/delete\")
<li><a href="#">query: properties.message:(\"microsoft.kubernetes\\/connectedclusters\\/networking.k8s.io\\/networkpolicies\\/write\" or \"microsoft.kubernetes\\/connectedclusters\\/networking.k8s.io\\/networkpolicies\\/delete\" or \"microsoft.kubernetes\\/connectedclusters\\/extensions\\/networkpolicies\\/write\" or \"microsoft.kubernetes\\/connectedclusters\\/extensions\\/networkpolicies\\/delete\")
<li><a href="#">query: properties.message:(\"microsoft.kubernetes\\/connectedclusters\\/rbac.authorization.k8s.io\\/clusterrolebindings\\/write\" or \"microsoft.kubernetes\\/connectedclusters\\/rbac.authorization.k8s.io\\/clusterrolebindings\\/delete\" or \"microsoft.kubernetes\\/connectedclusters\\/rbac.authorization.k8s.io\\/rolebindings\\/write\" or \"microsoft.kubernetes\\/connectedclusters\\/rbac.authorization.k8s.io\\/rolebindings\\/delete\")
<li><a href="#">query: properties.message:(\"microsoft.kubernetes\\/connectedclusters\\/rbac.authorization.k8s.io\\/roles\\/write\" or \"microsoft.kubernetes\\/connectedclusters\\/rbac.authorization.k8s.io\\/roles\\/delete\" or \"microsoft.kubernetes\\/connectedclusters\\/rbac.authorization.k8s.io\\/roles\\/bind\\/action\" or \"microsoft.kubernetes\\/connectedclusters\\/rbac.authorization.k8s.io\\/roles\\/escalate\\/action\" or \"microsoft.kubernetes\\/connectedclusters\\/rbac.authorization.k8s.io\\/clusterroles\\/write\" or \"microsoft.kubernetes\\/connectedclusters\\/rbac.authorization.k8s.io\\/clusterroles\\/delete\" or \"microsoft.kubernetes\\/connectedclusters\\/rbac.authorization.k8s.io\\/clusterroles\\/bind\\/action\" or \"microsoft.kubernetes\\/connectedclusters\\/rbac.authorization.k8s.io\\/clusterroles\\/escalate\\/action\")
<li><a href="#">query: properties.message:(\"microsoft.kubernetes\\/connectedclusters\\/serviceaccounts\\/write\" or \"microsoft.kubernetes\\/connectedclusters\\/serviceaccounts\\/delete\" or \"microsoft.kubernetes\\/connectedclusters\\/serviceaccounts\\/impersonate\\/action\")
<li><a href="#">query: properties.message:(\"microsoft.kubernetes\\/connectedclusters\\/write\" or \"microsoft.kubernetes\\/connectedclusters\\/delete\")
<li><a href="#">query: properties.message:(\"microsoft.network\\/applicationgateways\\/write\" or \"microsoft.network\\/applicationgateways\\/delete\")
<li><a href="#">query: properties.message:(\"microsoft.network\\/applicationsecuritygroups\\/write\" or \"microsoft.network\\/applicationsecuritygroups\\/delete\")
<li><a href="#">query: properties.message:(\"microsoft.network\\/azurefirewalls\\/applicationrulecollections\\/write\" or \"microsoft.network\\/azurefirewalls\\/applicationrulecollections\\/delete\" or \"microsoft.network\\/azurefirewalls\\/natrulecollections\\/write\" or \"microsoft.network\\/azurefirewalls\\/natrulecollections\\/delete\" or \"microsoft.network\\/azurefirewalls\\/networkrulecollections\\/write\" or \"microsoft.network\\/azurefirewalls\\/networkrulecollections\\/delete\")
<li><a href="#">query: properties.message:(\"microsoft.network\\/azurefirewalls\\/write\" or \"microsoft.network\\/azurefirewalls\\/delete\")
<li><a href="#">query: properties.message:(\"microsoft.network\\/firewallpolicies\\/rulecollectiongroups\\/write\" or \"microsoft.network\\/firewallpolicies\\/rulecollectiongroups\\/delete\" or \"microsoft.network\\/firewallpolicies\\/rulegroups\\/write\" or \"microsoft.network\\/firewallpolicies\\/rulegroups\\/delete\")
<li><a href="#">query: properties.message:(\"microsoft.network\\/firewallpolicies\\/write\" or \"microsoft.network\\/firewallpolicies\\/join\\/action\" or \"microsoft.network\\/firewallpolicies\\/certificates\\/action\" or \"microsoft.network\\/firewallpolicies\\/delete\")
<li><a href="#">query: properties.message:(\"microsoft.network\\/networkinterfaces\\/tapconfigurations\\/write\" or \"microsoft.network\\/networkinterfaces\\/tapconfigurations\\/delete\" or \"microsoft.network\\/networkinterfaces\\/write\" or \"microsoft.network\\/networkinterfaces\\/join\\/action\" or \"microsoft.network\\/networkinterfaces\\/delete\" or \"microsoft.network\\/networkvirtualappliances\\/delete\" or \"microsoft.network\\/networkvirtualappliances\\/write\" or \"microsoft.network\\/virtualhubs\\/delete\" or \"microsoft.network\\/virtualhubs\\/write\" or \"microsoft.network\\/virtualrouters\\/write\" or \"microsoft.network\\/virtualrouters\\/delete\")
<li><a href="#">query: properties.message:(\"microsoft.network\\/networksecuritygroups\\/write\" or \"microsoft.network\\/networksecuritygroups\\/delete\" or \"microsoft.network\\/networksecuritygroups\\/securityrules\\/write\" or \"microsoft.network\\/networksecuritygroups\\/securityrules\\/delete\" or \"microsoft.network\\/networksecuritygroups\\/join\\/action\" or \"microsoft.network\\/networksecuritygroups\\/providers\\/microsoft.insights\\/diagnosticsettings\\/write\")
<li><a href="#">query: properties.message:(\"microsoft.network\\/p2svpngateways\\/write\" or \"microsoft.network\\/p2svpngateways\\/delete\" or \"microsoft.network\\/p2svpngateways\\/reset\\/action\" or \"microsoft.network\\/p2svpngateways\\/generatevpnprofile\\/action\" or \"microsoft.network\\/p2svpngateways\\/disconnectp2svpnconnections\\/action\" or \"microsoft.network\\/p2svpngateways\\/providers\\/microsoft.insights\\/diagnosticsettings\\/write\")
<li><a href="#">query: properties.message:(\"microsoft.network\\/vpngateways\\/vpnconnections\\/write\" or \"microsoft.network\\/vpngateways\\/vpnconnections\\/delete\")
<li><a href="#">query: properties.message:(\"remove\\ eligible\\ member\\ \\(permanent\\)\" or \"remove\\ eligible\\ member\\ \\(eligible\\)\")
<li><a href="#">query: properties.message:(\"remove\\ owner\\ from\\ service\\ principal\" or \"remove\\ owner\\ from\\ application\")
<li><a href="#">query: properties.message:(\"update\\ application\" or \"update\\ service\\ principal\")
<li><a href="#">query: properties.message:(\"update\\ application\\-certificates\\ and\\ secrets\\ management\" or \"update\\ service\\ principal\\/update\\ application\")
<li><a href="#">query: properties.message:\"add\\ app\\ role\\ assignment\\ to\\ service\\ principal\
<li><a href="#">query: properties.message:\"add\\ conditional\\ access\\ policy\
<li><a href="#">query: properties.message:\"add\\ delegated\\ permission\\ grant\
<li><a href="#">query: properties.message:\"add\\ owner\\ to\\ application\
<li><a href="#">query: properties.message:\"add\\ service\\ principal\
<li><a href="#">query: properties.message:\"device\\ code\
<li><a href="#">query: properties.message:\"disable\\ pim\\ alert\
<li><a href="#">query: properties.message:\"microsoft.authorization\\/elevateaccess\\/action\
<li><a href="#">query: properties.message:\"microsoft.kubernetes\\/connectedclusters\\/events.k8s.io\\/events\\/delete\
<li><a href="#">query: properties.message:\"microsoft.kubernetes\\/connectedclusters\\/pods\\/delete\
<li><a href="#">query: properties.message:\"microsoft.portal\\/consoles\\/write\
<li><a href="#">query: properties.message:\"microsoft.security\\/alertssuppressionrules\\/write\
<li><a href="#">query: properties.message:\"remove\\ member\\ from\\ group\
<li><a href="#">query: properties.message:\"remove\\ service\\ principal\
<li><a href="#">query: properties.message:\"request\\ approved\\/denied\
<li><a href="#">query: properties.message:\"ropc\
<li><a href="#">query: properties.message:\"update\\ application\\ \\-\\ certificates\\ and\\ secrets\\ management\
<li><a href="#">query: properties.message:\"update\\ application\\ sucess\\-\\ property\\ name\\ appaddress\
<li><a href="#">query: properties.message:\"update\\ role\\ setting\\ in\\ pim\
<li><a href="#">query: scriptblocklogging:(*if\\(0\\)\\{\\{\\{0\\}\\}\\}'\\ \\-f\\ $\\(0\\ \\-as\\ \\[char\\]\\)\\ \\+* or *#<null>*)
<li><a href="#">query: sha1:(\"53a44c2396d15c3a03723fa5e5db54cafd527635\" or \"9c5e496921e3bc882dc40694f1dcc3746a75db19\" or \"aeb573accfd95758550cf30bf04f389a92922844\" or \"79ef78a797403a4ed1a616c68e07fff868a8650a\" or \"4f6f38b4cec35e895d91c052b1f5a83d665c2196\" or \"1e8c2cac2e4ce7cbd33c3858eb2e24531cb8a84d\" or \"e841a63e47361a572db9a7334af459ddca11347a\" or \"c28f606df28a9bc8df75a4d5e5837fc5522dd34d\" or \"2e94b305d6812a9f96e6781c888e48c7fb157b6b\" or \"dd44133716b8a241957b912fa6a02efde3ce3025\" or \"8793bf166cb89eb55f0593404e4e933ab605e803\" or \"a39b57032dbb2335499a51e13470a7cd5d86b138\" or \"41cc2b15c662bc001c0eb92f6cc222934f0beeea\" or \"d209430d6af54792371174e70e27dd11d3def7a7\" or \"1c6452026c56efd2c94cea7e0f671eb55515edb0\" or \"c6b41d3afdcdcaf9f442bbe772f5da871801fd5a\" or \"4923d460e22fbbf165bbbaba168e5a46b8157d9f\" or \"f201504bd96e81d0d350c3a8332593ee1c9e09de\" or \"ddd2db1127632a2a52943a2fe516a2e7d05d70d2\")
<li><a href="#">query: url.original:(*.paste.ee\\/r\\/* or *.pastebin.com\\/raw\\/* or *.hastebin.com\\/raw\\/* or *.ghostbin.co\\/paste\\/*\\/raw\\/*)
<li><a href="#">query: url.original:(*\\/..\\/vpns\\/* or *\\/vpns\\/cfg\\/smb.conf or *\\/vpns\\/portal\\/scripts\\/*.pl*)
<li><a href="#">query: url.original:(*get\\~\\~\\~allbrowser* or *get\\~\\~\\~hardwareinfo* or *take\\~\\~recordcall* or *reset\\~\\~\\~allcommand*)
<li><a href="#">query: url.original:*.class
<li><a href="#">query: url.original:*?\\/dana\\/html5acc\\/guacamole\\/*
<li><a href="#">query: url.original:*\\/asp.asp\\?ui\\=*
<li><a href="#">query: url.original:*\\/index\\/index.php\\?h\\=*
<li><a href="#">query: url.original:*\\/list\\/suc\\?name\\=*
<li><a href="#">query: url.original:*\\/pwndrop\\/*
<li><a href="#">query: url.original:*momyshark\\?key\\=*
<li><a href="#">query: user:(#\\-* or #*4294967295)
<li><a href="#">query: user_agent.original:(*\\(hydra\\)* or *\\ arachni\\/* or *\\ bfac\\ * or *\\ brutus\\ * or *\\ cgichk\\ * or *core\\-project\\/1.0* or *\\ crimscanner\\/* or *datacha0s* or *dirbuster* or *domino\\ hunter* or *dotdotpwn* or *fhscan\\ core* or *floodgate* or *get\\-minimal* or *gootkit\\ auto\\-rooter\\ scanner* or *grendel\\-scan* or *\\ inspath\\ * or *internet\\ ninja* or *jaascois* or *\\ zmeu\\ * or *masscan* or *\\ metis\\ * or *morfeus\\ fucking\\ scanner* or *n\\-stealth* or *nsauditor* or *pmafind* or *security\\ scan* or *springenwerk* or *teh\\ forest\\ lobster* or *toata\\ dragostea* or *\\ vega\\/* or *voideye* or *webshag* or *webvulnscan* or *\\ whcc\\/* or *\\ havij* or *absinthe* or *bsqlbf* or *mysqloit* or *pangolin* or *sql\\ power\\ injector* or *sqlmap* or *sqlninja* or *uil2pn* or *ruler* or *mozilla\\/5.0\\ \\(windows;\\ u;\\ windows\\ nt\\ 5.1;\\ pt\\-pt;\\ rv\\:1.9.1.2\\)\\ gecko\\/20090729\\ firefox\\/3.5.2\\ \\(.net\\ clr\\ 3.5.30729\\)*)
<li><a href="#">query: user_agent.original:(*\\= or *tw96awxsy)
<li><a href="#">query: user_agent.original:(\"mozilla\\/5.0\\ \\(windows\\ nt\\ 6.1;\\ wow64;\\ rv\\:53.0\\)\\ gecko\\/20100101\\ chrome\\ \\/53.0\" or \"mozilla\\/4.0\\ \\(compatible;\\ msie\\ 8.0;\\ windows\\ nt\\ 5.1\\)\" or \"mozilla\\/4.0\\ \\(compatible;\\ msie\\ 7.0;\\ windows\\ nt\\ 5.1;\\ trident\\/4.0\\)\" or \"mozilla\\/4.0\\ \\(compatible;\\ msie\\ 6.0;\\ windows\\ nt\\ 5.0;\\ .net\\ clr\\ \\ 1.1.4322\\)\" or \"httpbrowser\\/1.0\" or *<|>* or \"nsis_inetc\\ \\(mozilla\\)\" or \"wget\\/1.9\\+cvs\\-stable\\ \\(red\\ hat\\ modified\\)\" or \"mozilla\\/4.0\\ \\(compatible;\\ msie\\ 8.0;\\ windows\\ nt\\ 6.1;\\ trident\\/4.0;\\ .net\\ clr\\ 1.1.4322\\)\" or *zeroup* or mozilla\\/5.0\\ \\(windows\\ nt\\ 5.1\\ ;\\ v.* or *\\ adlib\\/* or *\\ tiny or *\\ bgroom\\ * or *\\ changhuatong or *\\ choltbagent or \"mozilla\\/5.0\\ wininet\" or \"rookie\\/1.0\" or \"m\" or \"mozilla\\/4.0\\ \\(compatible;\\ msie\\ 8.0;\\ windows\\ nt\\ 5.1;\\ trident\\/4.0\\)\" or \"mozilla\\/4.0\\ \\(compatible;msie\\ 7.0;windows\\ nt\\ 6.0\\)\" or \"backdoorbot\" or \"mozilla\\/5.0\\ \\(windows;\\ u;\\ windows\\ nt\\ 5.1;\\ en\\-us;\\ rv\\:1.9.2.3\\)\\ gecko\\/20100401\\ firefox\\/3.6.1\\ \\(.net\\ clr\\ 3.5.30731\\)\" or \"opera\\/8.81\\ \\(windows\\ nt\\ 6.0;\\ u;\\ en\\)\" or \"mozilla\\/5.0\\ \\(windows;\\ u;\\ windows\\ nt\\ 5.1;\\ en\\-us;\\ rv\\:1.9.2.3\\)\\ gecko\\/20100401\\ firefox\\/3.6.1\\ \\(.net\\ clr\\ 3.5.30729\\)\" or \"opera\" or \"mozilla\\/4.0\\ \\(compatible;\\ msie\\ 5.0;\\ windows\\ 98\\)\" or \"mozilla\\/4.0\\ \\(compatible;\\ msie\\ 5.01;\\ windows\\ nt\\ 5.0\\)\" or \"msie\" or *\\(charon;\\ inferno\\) or \"mozilla\\/4.0\\ \\(compatible;\\ msie\\ 8.0;\\ windows\\ nt\\ 5.1;\\ trident\\/5.0\\)\" or \"mozilla\\/4.0\\ \\(compatible;\\ msie\\ 6.1;\\ windows\\ nt\\)\" or \"mozilla\\/4.0\\(compatible;\\ msie\\ 6.0;\\ windows\\ nt\\ 5.1\\)\" or \"mozilla\\/5.0\\ \\(windows\\ nt\\ 10.0;\\ win64;\\ x64\\)\" or \"mozilla\\/4.0\\ \\(compatible;\\ msie\\ 8.0;\\ windows\\ nt\\ 10.0;\\ win64;\\ x64\\)\" or \"mozilla\\/4.0\\ \\(compatible;\\ msie\\ 8.0;\\ windows\\ nt\\ 6.1;\\ win64;\\ x64\\)\" or \"mozilla\\/4.0\\ \\(compatible;\\ msie\\ 7.0;\\ windows\\ nt\\ 6.2;\\ wow64;\\ trident\\/7.0;\\ .net4.0c;\\ .net4.0e;\\ infopath.3\\)\" or *\\ pxyscand* or *\\ asd or *\\ mdms or \"sample\" or \"nocase\" or \"moxilla\" or win32\\ * or *microsoft\\ internet\\ explorer* or agent\\ * or \"autoit\" or \"iczeliondownload\" or \"mozilla\\/4.0\\ \\(compatible;\\ msie\\ 9.0;\\ windows\\ nt\\ 10.0;\\ .net4.0c;\\ .net4.0e;\\ tablet\\ pc\\ 2.0\\)\" or \"record\" or \"mozzzzzzzzzzz\" or \"mozilla\\/5.0\\ \\(windows\\ nt\\ 10.0;\\ win64;\\ x64;\\ rv\\:76.0\\)\\ gecko\\/20100101\\ firefox\\/76.0\" or \"havana\\/0.1\")
<li><a href="#">query: user_agent.original:(\"sjzj\\ \\(compatible;\\ msie\\ 6.0;\\ win32\\)\" or \"mozilla\\/5.0\\ \\(windows\\ nt\\ 6.;\\ wow64;\\ rv\\:20.0\\)\\ gecko\\/20100101\\ firefox\\/20.0\" or \"user\\-agent\\:\\ mozilla\\/4.0\\ \\(compatible;\\ msie\\ 8.0;\\ windows\\ nt\\ 6.1;\\ trident\\/4.0;\\ slcc\" or \"mozilla\\/4.0\\ \\(compatible;\\ msie\\ 7.4;\\ win32;32\\-bit\\)\" or \"webclient\" or \"mozilla\\/5.0\\ \\(windows;\\ u;\\ windows\\ nt\\ 5.1;\\ zh\\-en;\\ rv\\:1.7.12\\)\\ gecko\\/200\" or \"mozilla\\/4.0\\ \\(compatible;\\ msi\\ 6.0;\" or \"mozilla\\/5.0\\ \\(windows\\ nt\\ 6.3;\\ wow64;\\ rv\\:28.0\\)\\ gecko\\/20100101\\ firefox\\/28.0\" or \"mozilla\\/5.0\\ \\(windows\\ nt\\ 6.2;\\ wow64;\\ rv\\:20.0\\)\\ gecko\\/20100101\\ firefox\\/\" or \"mozilla\\/5.0\\ \\(windows\\ nt\\ 6.;\\ wow64;\\ rv\\:20.0\\)\\ gecko\\/20100101\\ firefox\\/2\" or \"mozilla\\/4.0\" or \"netscape\" or \"mozilla\\/5.0\\ \\(windows;\\ u;\\ windows\\ nt\\ 5.1;\\ zh\\-en;\\ rv\\:1.7.12\\)\\ gecko\\/20100719\\ firefox\\/1.0.7\" or \"mozilla\\/5.0\\ \\(windows;\\ u;\\ windows\\ nt\\ 5.1;\\ en\\-us;\\ rv\\:1.9.2.13\\)\\ firefox\\/3.6.13\\ gtb7.1\" or \"mozilla\\/5.0\\ \\(compatible;\\ msie\\ 9.0;\\ windows\\ nt\\ 6.1;\\ wow64;\\ trident\\/5.0\\)\" or \"mozilla\\/4.0\\ \\(compatible;\\ msie\\ 8.0;\\ windows\\ nt\\ 6.1;\\ wow64;\\ trident\\/4.0;\\ slcc2;\\ .netclr\\ 2.0.50727\\)\" or \"mozilla\\/4.0\\ \\(compatible;\\ msie\\ 8.0;\\ windows\\ nt\\ 6.0;\\ sv1\\)\" or \"mozilla\\/4.0\\ \\(compatible;\\ msie\\ 11.0;\\ windows\\ nt\\ 6.1;\\ sv1\\)\" or \"mozilla\\/4.0\\ \\(compatible;\\ msie\\ 8.0;\\ win32\\)\" or \"mozilla\\ v5.1\\ \\(windows\\ nt\\ 6.1;\\ rv\\:6.0.1\\)\\ gecko\\/20100101\\ firefox\\/6.0.1\" or \"mozilla\\/6.1\\ \\(compatible;\\ msie\\ 9.0;\\ windows\\ nt\\ 5.3;\\ trident\\/5.0\\)\" or \"mozilla\\/4.0\\ \\(compatible;\\ msie\\ 6.0;\\ windows\\ nt\\ 5.1;\\ sv1;\\ .net\\ clr\\ 1.1.4322;\\ .net\\ clr\\ 2.0.50727;\\ .net\\ clr\\ 3.0.04506.30;\\ .net\\ clr\\ 3.0.04506.648;\\ infopath.1\\)\" or \"mozilla\\/5.0\\ \\(windows\\ nt\\ 6.1;\\ wow64\\)\\ winhttp\\/1.6.3.8\\ \\(winhttp\\/5.1\\)\\ like\\ gecko\" or mozilla\\ v5.1\\ * or \"msie\\ 8.0\" or \"mozilla\\/4.0\\ \\(compatible;\\ msie\\ 7.0;\\ windows\\ nt\\ 6.1;\\ slcc2;\\ .net\\ clr\\ 2.0.50727;\\ .net\\ clr\\ 3.5.30729;\\ .net\\ clr\\ 3.0.30729;\\ media\\ center\\ pc\\ 6.0;\\ .net4.0c;\\ .net4.0e;\\ infopath.2\\)\" or \"mozilla\\/4.0\\ \\(compatible;\\ rms\\)\" or \"mozilla\\/4.0\\ \\(compatible;\\ msie\\ 6.0;\\ dyngate\\)\" or \"o\\/9.27\\ \\(w;\\ u;\\ z\\)\" or mozilla\\/5.0\\ \\(compatible;\\ msie\\ 9.0;\\ windows\\ nt\\ 6.0;\\ trident\\/5.0;\\ \\ trident\\/5.0* or mozilla\\/5.0\\ \\(windows\\ nt\\ 9;\\ * or \"hots\\ scot\" or \"mozilla\\/5.0\\ \\(compatible;\\ msie\\ 10.0;\\ windows\\ nt\\)\" or \"mozilla\\/5.0\\ \\(windows\\ nt\\ 6.1;\\ wow64\\)\\ chrome\\/28.0.1500.95\\ safari\\/537.36\" or \"mozilla\\/5.0\\ \\(windows\\ nt\\ 6.2;\\ win32;\\ rv\\:47.0\\)\" or \"mozilla\\/4.0\\ \\(compatible;\\ msie\\ 6.0;\\ windows\\ nt\\ 5.1;sv1;\" or \"mozilla\\/5.0\\ \\(x11;\\ linux\\ i686;\\ rv\\:22.0\\)\\ firefox\\/22.0\" or \"mozilla\\/5.0\\ chrome\\/72.0.3626.109\\ safari\\/537.36\" or \"mozilla\\/5.0\\ \\(windows\\ nt\\ 10.0;\\ win64;\\ x64;\\ rv\\:fts_06\\)\\ gecko\\/22.36.35.06\\ firefox\\/2.0\" or \"mozilla\\/5.0\\ \\(windows\\ nt\\ 10.0;\\ win64;\\ x64\\)\\ applewebkit\\/537.36\\ \\(khtml,\\ like\\ gecko\\)\\ chrome\\/102.0.5005.63\\ safari\\/537.36\\ edg\\/100.0.1185.39\" or \"mozilla\\/4.0\\ \\(compatible;\\ msie\\ 7.0;\\ windows\\ nt\\ 6.1;\\ wow64;\\ trident\\/4.0;\\ slcc2;\\ .net\\ clr\\ 2.0.50727;\\ .net\\ clr\\ 3.5.30729;\\ .net\\ clr\\ 3.0.30729;\\ infopath.3;\\ .net4.0c;\\ .net4.0e\\)\")
<li><a href="#">query: user_agent.original:(internet\\ explorer\\ * or \"mozilla\\/4.0\\ \\(compatible;\\ msie\\ 6.0;\\ windows\\ nt\\ 5.1;\\ sv1;\\ infopath.2\\)\" or \"mozilla\\/4.0\\ \\(compatible;\\
<li><a href="#">query: user_agent.original:(xmrig\\ * or ccminer*)
<li><a href="#">query: user_agent.original:*\\ windowspowershell\\/*
<li><a href="#">query: user_agent.original:\"\
<li><a href="#">query: user_agent.original:rclone\\/v*
<li><a href="#">query: winlog.event_data.calltrace:*cmlua.dll*
<li><a href="#">query: winlog.event_data.calltrace:*editionupgrademanagerobj.dll*
<li><a href="#">query: winlog.event_data.calltrace:unknown*
<li><a href="#">query: winlog.event_data.description:*st2stager*
<li><a href="#">query: winlog.event_data.hashes:*09d278f9de118ef09163c6140255c690*
<li><a href="#">query: winlog.event_data.originalfilename:\"clip.exe\
<li><a href="#">query: winlog.event_data.originalfilename:\"nmap.exe\
<li><a href="#">query: winlog.event_data.signature:(*dumpcreds* or *mimikatz* or *pwcrack* or *htool\\/wce* or *pswtool* or *pwdump* or *securitytool* or *pshlspy* or *rubeus* or *kekeo* or *lsassdump* or *outflank* or *dumplsass* or *sharpdump*)
<li><a href="#">query: winlog.event_data.signature:(*metetool* or *mpreter* or *meterpreter* or *
<li><a href="#">query: winlog.event_data.signature:(*ransom* or *filecoder* or *ryuk* or *cryptor* or *crypter* or *destructor* or *teslacrypt* or *locker* or *tescrypt* or *cryptes* or *krypt* or *gandcrab* or *ryzerlo* or *blackworm* or *phobos*)
<li><a href="#">query: winlog.event_data.startaddress:(*0b80 or *0c7c or *0c88)
<li><a href="#">query: winlog.event_data.targetimage:(*\\\\mspaint.exe or *\\\\calc.exe or *\\\\notepad.exe or *\\\\sethc.exe or *\\\\write.exe or *\\\\wordpad.exe)
<li><a href="#">query: winlog.event_data.targetimage:*\\\\keepass.exe
<li><a href="#">query: winlog.event_data.targetobject:(*\\\\cor_enable_profiling or *\\\\cor_profiler)
<li><a href="#">query: winlog.event_data.targetobject:(*\\\\currentcontrolset\\\\services\\\\ntds\\\\directoryserviceextpt* or *\\\\currentcontrolset\\\\services\\\\ntds\\\\lsadbextpt*)
<li><a href="#">query: winlog.event_data.targetobject:(*\\\\security\\\\trusted\\ documents\\\\trustrecords or *\\\\security\\\\accessvbom or *\\\\security\\\\vbawarnings)
<li><a href="#">query: winlog.event_data.targetobject:(*\\\\services\\\\dhcpserver\\\\parameters\\\\calloutdlls or *\\\\services\\\\dhcpserver\\\\parameters\\\\calloutenabled)
<li><a href="#">query: winlog.event_data.targetobject:(*\\\\services\\\\termservice\\\\parameters\\\\servicedll* or *\\\\control\\\\terminal\\ server\\\\fsinglesessionperuser* or *\\\\control\\\\terminal\\ server\\\\fdenytsconnections* or *\\\\policies\\\\microsoft\\\\windows\\ nt\\\\terminal\\ services\\\\shadow* or *\\\\control\\\\terminal\\ server\\\\winstations\\\\rdp\\-tcp\\\\initialprogram*)
<li><a href="#">query: winlog.event_data.targetobject:(*\\\\software\\\\microsoft\\\\windows\\ nt\\\\currentversion\\\\image\\ file\\ execution\\ options\\\\sethc.exe\\\\debugger or *\\\\software\\\\microsoft\\\\windows\\ nt\\\\currentversion\\\\image\\ file\\ execution\\ options\\\\utilman.exe\\\\debugger or *\\\\software\\\\microsoft\\\\windows\\ nt\\\\currentversion\\\\image\\ file\\ execution\\ options\\\\osk.exe\\\\debugger or *\\\\software\\\\microsoft\\\\windows\\ nt\\\\currentversion\\\\image\\ file\\ execution\\ options\\\\magnify.exe\\\\debugger or *\\\\software\\\\microsoft\\\\windows\\ nt\\\\currentversion\\\\image\\ file\\ execution\\ options\\\\narrator.exe\\\\debugger or *\\\\software\\\\microsoft\\\\windows\\ nt\\\\currentversion\\\\image\\ file\\ execution\\ options\\\\displayswitch.exe\\\\debugger)
<li><a href="#">query: winlog.event_data.targetobject:(*software\\\\microsoft\\\\windows\\\\currentversion\\\\ume or *software\\\\microsoft\\\\windows\\\\currentversion\\\\ut)
<li><a href="#">query: winlog.event_data.targetobject:(\"hkcu\\\\software\\\\microsoft\\\\office\\ test\\\\special\\\\perf\" or \"hklm\\\\software\\\\microsoft\\\\office\\ test\\\\special\\\\perf\")
<li><a href="#">query: winlog.event_data.targetobject:*\\\\appcompatflags\\\\compatibility\\ assistant\\\\store\\\\*
<li><a href="#">query: winlog.event_data.targetobject:*\\\\appx82a6gwre4fdg3bt635tn5ctqjf8msdd2\\\\shell\\\\open\\\\command
<li><a href="#">query: winlog.event_data.targetobject:*\\\\cmmgr32.exe*
<li><a href="#">query: winlog.event_data.targetobject:*\\\\currentcontrolset\\\\services\\\\wercplsupport\\\\parameters\\\\servicedll
<li><a href="#">query: winlog.event_data.targetobject:*\\\\eulaaccepted
<li><a href="#">query: winlog.event_data.targetobject:*\\\\iscredguardenabled
<li><a href="#">query: winlog.event_data.targetobject:*\\\\services\\\\dns\\\\parameters\\\\serverlevelplugindll
<li><a href="#">query: winlog.event_data.targetobject:*\\\\software\\\\netwire*
<li><a href="#">query: winlog.event_data.targetobject:*\\\\software\\\\sysinternals\\\\sdelete*
<li><a href="#">query: winlog.event_data.targetobject:*\\\\system\\\\currentcontrolset\\\\services\\\\null\\\\instance*
<li><a href="#">query: winlog.event_data.targetobject:*hklm\\\\software\\\\microsoft\\\\htmlhelp\\\\data*
<li><a href="#">query: winlog.event_data.targetobject:*microsoft\\\\windows\\ nt\\\\currentversion\\\\silentprocessexit\\\\lsass.exe*
<li><a href="#">query: winlog.event_data.targetobject:*services\\\\wceservice\\\\start*
<li><a href="#">query: winlog.event_data.targetobject:*software\\\\microsoft\\\\windows\\\\currentversion\\\\run\\\\backup\\ mgr
<li><a href="#">query: winlog.event_data.targetobject:*trustrecords*
<li><a href="#">query: winlog.event_data.targetobject:*userinitmprlogonscript*
<li><a href="#">query: winlog.event_data.targetobject:\"hkcu\\\\software\\\\classes\\\\folder\\\\shell\\\\open\\\\command\\\\delegateexecute\
<li><a href="#">query: winlog.event_data.targetobject:\"hkcu\\\\software\\\\microsoft\\\\windows\\\\currentversion\\\\run\\\\ntkd\
<li><a href="#">query: winlog.event_data.targetobject:\"hklm\\\\system\\\\currentcontrolset\\\\services\\\\portproxy\\\\v4tov4\\\\tcp\
<li><a href="#">query: winlog.event_id:(\"19\" or \"20\" or \"21\")
<li><a href="#">query: winlog.event_id:(\"2002\" or \"2003\" or \"2008\")
<li><a href="#">query: winlog.event_id:(\"441\" or \"442\" or \"453\" or \"454\")
<li><a href="#">query: winlog.event_id:(\"8004\" or \"8007\")
<li><a href="#">search: ' $ssa_input = | from read_ssa_enriched_events() | eval device=ucast(map_get(input_event, "dest_device_id"), "string", null), user=ucast(map_get(input_event, "dest_user_id"), "string", null), timestamp=parse_long(ucast(map_get(input_event, "_time"), "string", null)), process_name=lower(ucast(map_get(input_event, "process_name"), "string", null)), process_path=lower(ucast(map_get(input_event, "process_path"), "string", null)), event_id=ucast(map_get(input_event, "event_id"), "string", null); $cond_1 = | from $ssa_input | where process_name="bitsadmin.exe" or process_name="certoc.exe" or process_name="certreq.exe" or process_name="certutil.exe" or process_name="cmdkey.exe" or process_name="cmdl32.exe" or process_name="cmstp.exe" or process_name="configsecuritypolicy.exe" or process_name="control.exe" or process_name="cscript.exe" or process_name="datasvcutil.exe" or process_name="desktopimgdownldr.exe" or process_name="dfsvc.exe" or process_name="diantz.exe" or process_name="diskshadow.exe" or process_name="dllhost.exe" or process_name="dnscmd.exe" or process_name="esentutl.exe" or process_name="eventvwr.exe" or process_name="expand.exe" or process_name="extexport.exe" or process_name="extrac32.exe" or process_name="findstr.exe" or process_name="finger.exe" or process_name="fltmc.exe" or process_name="forfiles.exe" or process_name="ftp.exe" or process_name="gfxdownloadwrapper.exe" or process_name="gpscript.exe" or process_name="imewdbld.exe" or process_name="ie4uinit.exe" or process_name="ieexec.exe" or process_name="ilasm.exe" or process_name="infdefaultinstall.exe" or process_name="makecab.exe" or process_name="mavinject.exe" or process_name="microsoft.workflow.compiler.exe" or process_name="mmc.exe" or process_name="msconfig.exe" or process_name="msdt.exe" or process_name="mshta.exe" or process_name="msiexec.exe" or process_name="netsh.exe" or process_name="odbcconf.exe" or process_name="offlinescannershell.exe" or process_name="pcalua.exe" or process_name="pcwrun.exe" or process_name="pktmon.exe" or process_name="pnputil.exe" or process_name="presentationhost.exe" or process_name="print.exe" or process_name="printbrm.exe" or process_name="psr.exe" or process_name="rasautou.exe" or process_name="reg.exe" or process_name="regini.exe" or process_name="register-cimprovider.exe" or process_name="regsvr32.exe" or process_name="replace.exe" or process_name="rpcping.exe" or process_name="rundll32.exe" or process_name="runonce.exe" or process_name="runscripthelper.exe" or process_name="sc.exe" or process_name="schtasks.exe" or process_name="scriptrunner.exe" or process_name="settingsynchost.exe" or process_name="syncappvpublishingserver.exe" or process_name="ttdinject.exe" or process_name="tttracer.exe" or process_name="vbc.exe" or process_name="verclsid.exe" or process_name="wab.exe" or process_name="wlrmdr.exe" or process_name="wmic.exe" or process_name="workfolders.exe" or process_name="wscript.exe" or process_name="wsreset.exe" or process_name="wuauclt.exe" or process_name="xwizard.exe"; | from $cond_1 | where match_regex(process_path, /(?i)\\windows\\system32/)=false and match_regex(process_path, /(?i)\\windows\\syswow64/)=false and match_regex(process_path, /(?i)\\windows\\adws/)=false and match_regex(process_path, /(?i)\\windows\\networkcontroller/)=false and match_regex(process_path, /(?i)\\windows\\systemapps/)=false and match_regex(process_path, /(?i)\\winsxs/)=false and match_regex(process_path, /(?i)\\microsoft.net/)=false | eval start_time=timestamp, end_time=timestamp, entities=mvappend(device, user), body=create_map(["event_id", event_id, "process_path", process_path, "process_name", process_name]) | into write_ssa_detected_events();'
<li><a href="#">search: ' $ssa_input = | from read_ssa_enriched_events() | eval device=ucast(map_get(input_event, "dest_device_id"), "string", null), user=ucast(map_get(input_event, "dest_user_id"), "string", null), timestamp=parse_long(ucast(map_get(input_event, "_time"), "string", null)), process_name=lower(ucast(map_get(input_event, "process_name"), "string", null)), process_path=lower(ucast(map_get(input_event, "process_path"), "string", null)), event_id=ucast(map_get(input_event, "event_id"), "string", null); $cond_1 = | from $ssa_input | where process_name="msbuild.exe" or process_name="comsvcconfig.exe" or process_name="dfsradmin.exe" or process_name="dfsvc.exe" or process_name="microsoft.workflow.compiler.exe" or process_name="smsvchost.exe" or process_name="wsatconfig.exe" or process_name="addinprocess.exe" or process_name="addinprocess32.exe" or process_name="addinutil.exe" or process_name="aspnet_compiler.exe" or process_name="aspnet_regbrowsers.exe" or process_name="aspnet_regsql.exe" or process_name="caspol.exe" or process_name="datasvcutil.exe" or process_name="edmgen.exe" or process_name="installutil.exe" or process_name="jsc.exe" or process_name="ngentask.exe" or process_name="regasm.exe" or process_name="regsvcs.exe" or process_name="sdnbr.exe" or process_name="acu.exe" or process_name="appvstreamingux.exe" or process_name="dsac.exe" or process_name="lbfoadmin.exe" or process_name="microsoft.uev.synccontroller.exe" or process_name="mtedit.exe" or process_name="scriptrunner.exe" or process_name="servermanager.exe" or process_name="stordiag.exe" or process_name="tzsync.exe" or process_name="uevagentpolicygenerator.exe" or process_name="uevappmonitor.exe" or process_name="uevtemplatebaselinegenerator.exe" or process_name="uevtemplateconfigitemgenerator.exe" or process_name="powershell_ise.exe" or process_name="iediagcmd.exe" or process_name="xbox.tcui.exe" or process_name="microsoft.activedirectory.webservices.exe" or process_name="iisual.exe" or process_name="filehistory.exe" or process_name="secureassessmentbrowser.exe"; | from $cond_1 | where match_regex(process_path, /(?i)\\windows\\system32/)=false and match_regex(process_path, /(?i)\\windows\\syswow64/)=false and match_regex(process_path, /(?i)\\windows\\adws/)=false and match_regex(process_path, /(?i)\\windows\\networkcontroller/)=false and match_regex(process_path, /(?i)\\windows\\systemapps/)=false and match_regex(process_path, /(?i)\\winsxs/)=false and match_regex(process_path, /(?i)\\microsoft.net/)=false | eval start_time=timestamp, end_time=timestamp, entities=mvappend(device, user), body=create_map(["event_id", event_id, "process_path", process_path, "process_name", process_name]) | into write_ssa_detected_events();'
<li><a href="#">search: ' `azure_audit` operationname.localizedvalue="create or update an azure automation account" status.value=succeeded | dedup object | stats values(object) by _time, caller, claims.ipaddr, resourcegroupname, object_path | `azure_automation_account_created_filter`'
<li><a href="#">search: ' `azure_audit` operationname.localizedvalue="create or update an azure automation runbook" object!=azureautomationtutorial* status.value=succeeded | dedup object | stats values(object) by _time, caller, claims.ipaddr, resourcegroupname, object_path | `azure_automation_runbook_created_filter`'
<li><a href="#">search: ' `azure_audit` operationname.localizedvalue="create or update an azure automation webhook" status.value=succeeded | stats values(object) by _time, caller, claims.ipaddr, resourcegroupname, object_path | `azure_runbook_webhook_created_filter`'
<li><a href="#">search: ' `azuread` "body.operationname"="add member to role" | rename body.properties.* as * | rename targetresources{}.userprincipalname as userprincipalname | rename initiatedby.user.userprincipalname as initiatedby | rename targetresources{}.modifiedproperties{}.newvalue as roles | eval role=mvindex(roles,1) | lookup privileged_azure_ad_roles azureadrole as role output isprvilegedadrole
<li><a href="#">search: ' `azuread` (body.operationname="enable account" or body.operationname="reset password (by admin)" or body.operationname="update user") | transaction body.properties.targetresources{}.userprincipalname startswith=(body.operationname="enable account") endswith=(body.operationname="reset password (by admin)") maxspan=2m | rename body.properties.* as * | rename targetresources{}.userprincipalname as userprincipalname | rename initiatedby.user.userprincipalname as initiatedby | stats values(body.operationname) values(initiatedby) by _time, userprincipalname, result | `azure_ad_user_enabled_and_password_reset_filter`'
<li><a href="#">search: ' `azuread` body.category= signinlogs body.properties.status.errorcode=50126 body.properties.authenticationdetails{}.succeeded= false | rename body.properties.* as * | bucket span=5m _time | stats dc(userprincipalname) as unique_accounts values(userprincipalname) as tried_accounts by _time, ipaddress | where unique_accounts > 30 | `azure_ad_multiple_users_failing_to_authenticate_from_ip_filter`'
<li><a href="#">search: ' `azuread` body.category=auditlogs body.operationname="update application*certificates and secrets management " | rename body.* as * | rename properties.* as * | rename targetresources{}.* as * | stats values(displayname) by _time, initiatedby.user.userprincipalname, modifiedproperties{}.newvalue | `azure_ad_service_principal_new_client_credentials_filter`'
<li><a href="#">search: ' `azuread` body.category=signinlogs body.properties.authenticationdetails{}.succeeded=true body.properties.appdisplayname="azure active directory powershell" | rename body.properties.* as * | stats values(userprincipalname) by _time, ipaddress, appdisplayname, useragent | `azure_ad_successful_powershell_authentication_filter`'
<li><a href="#">search: ' `azuread` body.category=signinlogs body.properties.authenticationrequirement=singlefactorauthentication body.properties.authenticationdetails{}.succeeded=true | rename body.properties.* as * | stats values(userprincipalname) by _time, ipaddress, appdisplayname, authenticationrequirement | `azure_ad_successful_single_factor_authentication_filter`'
<li><a href="#">search: ' `azuread` body.category=signinlogs body.properties.status.errorcode=500121 | rename body.properties.* as * | bucket span=10m _time | stats dc(_raw) as mfa_prompts values(userprincipalname) by userprincipalname, status.additionaldetails, appdisplayname, useragent, _time | where mfa_prompts > 10 | `azure_ad_multiple_failed_mfa_requests_for_user_filter`'
<li><a href="#">search: ' `azuread` body.category=signinlogs body.properties.status.errorcode=500121 | rename body.properties.* as * | stats values(userprincipalname) by _time, ipaddress, status.additionaldetails, appdisplayname, useragent | `azure_ad_authentication_failed_during_mfa_challenge_filter`'
<li><a href="#">search: ' `azuread` body.category=signinlogs body.properties.status.errorcode=50126 body.properties.authenticationdetails{}.succeeded= false | rename body.properties.* as * | bucket span=5m _time | stats dc(userprincipalname) as unique_accounts values(userprincipalname) as tried_accounts by _time, ipaddress | eventstats avg(unique_accounts) as ip_avg , stdev(unique_accounts) as ip_std by ipaddress | eval upperbound=(ip_avg+ip_std*3) | eval isoutlier=if(unique_accounts > 10 and unique_accounts >= upperbound, 1, 0) | where isoutlier = 1 | `azure_ad_unusual_number_of_failed_authentications_from_ip_filter`'
<li><a href="#">search: ' `azuread` body.category=userriskevents body.properties.risklevel=high | rename body.properties.* as * | stats values(userprincipalname) by _time, ipaddress, activity, risklevel, riskeventtype, additionalinfo | `azure_active_directory_high_risk_sign_in_filter`'
<li><a href="#">search: ' `azuread` body.operationname="add owner to application" | rename body.properties.* as * | rename initiatedby.user.userprincipalname as initiatedby | rename targetresources{}.userprincipalname as newowner | rename targetresources{}.modifiedproperties{}.newvalue as displayname | eval displayname = mvindex(displayname,1) | where initiatedby!=newowner | stats values(displayname) by _time, initiatedby, result, body.operationname, newowner | `azure_ad_service_principal_owner_added_filter`'
<li><a href="#">search: ' `azuread` body.operationname="add unverified domain" "body.properties.result"=success | rename body.properties.* as * | rename body.calleripaddress as calleripaddress | rename initiatedby.user.userprincipalname as initiatedby | rename targetresources{}.displayname as domain | stats values(domain) by _time, initiatedby, result, body.operationname, calleripaddress | `azure_ad_new_custom_domain_added_filter`'
<li><a href="#">search: ' `azuread` body.operationname="set domain authentication" "body.properties.result"=success | rename body.properties.* as * | rename body.calleripaddress as calleripaddress | rename initiatedby.user.userprincipalname as initiatedby | rename targetresources{}.displayname as domain | stats values(domain) by _time, initiatedby, result, body.operationname, calleripaddress | `azure_ad_new_federated_domain_added_filter`'
<li><a href="#">search: ' `azuread` body.operationname="update user" body.properties.targetresources{}.modifiedproperties{}.displayname=sourceanchor | rename body.properties.* as * | rename targetresources{}.userprincipalname as userprincipalname | rename initiatedby.user.userprincipalname as initiatedby | rename body.calleripaddress as calleripaddress | rename targetresources{}.modifiedproperties{}.newvalue as modifiedproperties | stats values(userprincipalname) values(modifiedproperties) by _time, initiatedby, calleripaddress, result, body.operationname | `azure_ad_user_immutableid_attribute_updated_filter`'
<li><a href="#">search: ' `cloudtrail` eventname = updateloginprofile useragent !=console.amazonaws.com errorcode = success | eval match=if(match(useridentity.username,requestparameters.username), 1,0) | search match=0 | stats count min(_time) as firsttime max(_time) as lasttime by requestparameters.username src eventname eventsource aws_account_id errorcode useragent eventid awsregion useridentity.username user_arn | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `aws_updateloginprofile_filter`'
<li><a href="#">search: ' `gws_reports_admin` command=unenroll_user_from_strong_auth | stats values(user) by _time, command, actor.email, status | `gcp_multi_factor_authentication_disabled_filter`'
<li><a href="#">search: ' `gws_reports_login` event.name=login_failure `gws_login_mfa_methods` | bucket span=5m _time | stats dc(_raw) as mfa_prompts values(user) by src_ip, login_challenge_method, _time | where mfa_prompts >= 10 | `gcp_multiple_failed_mfa_requests_for_user_filter`'
<li><a href="#">search: ' `gws_reports_login` event.name=login_failure `gws_login_mfa_methods` | stats values(user) by _time, src_ip, login_challenge_method | `gcp_authentication_failed_during_mfa_challenge_filter`'
<li><a href="#">search: ' `gws_reports_login` event.name=login_success not `gws_login_mfa_methods` | stats values(user) by _time, src_ip, login_challenge_method | `gcp_successful_single_factor_authentication_filter`'
<li><a href="#">search: ' `powershell` eventcode=4104 (message = "*get-adcomputer*" and message = "*trustedfordelegation*") | stats count min(_time) as firsttime max(_time) as lasttime by eventcode message computername user | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `windows_get_adcomputer_unconstrained_delegation_discovery_filter`'
<li><a href="#">search: ' `powershell` eventcode=4104 (scriptblocktext = "*get-aduser*" and scriptblocktext="*4194304*") | stats count min(_time) as firsttime max(_time) as lasttime by opcode computer userid eventcode scriptblocktext | `security_content_ctime(firsttime)` | `disabled_kerberos_pre_authentication_discovery_with_get_aduser_filter`'
<li><a href="#">search: ' `powershell` eventcode=4104 (scriptblocktext = "*get-domainuser*" and scriptblocktext="*preauthnotrequired*") | stats count min(_time) as firsttime max(_time) as lasttime by opcode computer userid eventcode scriptblocktext | `security_content_ctime(firsttime)` | `disabled_kerberos_pre_authentication_discovery_with_powerview_filter`'
<li><a href="#">search: ' `sysmon` eventcode=10 targetimage=c:\\windows\\system32\\winlogon.exe (grantedaccess=0x1f3fff) (sourceimage!=c:\\windows\\system32\\svchost.exe and sourceimage!=c:\\windows\\system32\\lsass.exe and sourceimage!=c:\\windows\\system32\\logonui.exe and sourceimage!=c:\\windows\\system32\\smss.exe and sourceimage!=c:\\windows\\system32\\wbem\\wmiprvse.exe) | stats count min(_time) as firsttime max(_time) as lasttime by computer, sourceimage, sourceprocessid, targetimage, targetprocessid, eventcode, grantedaccess | rename computer as dest | `security_content_ctime(firsttime)`| `security_content_ctime(lasttime)` | `rubeus_kerberos_ticket_exports_through_winlogon_access_filter`'
<li><a href="#">search: ' `wineventlog_security` (eventcode=4781 old_account_name="*$" new_account_name!="*$") or (eventcode=4768 account_name!="*$") | eval renamedcomputeraccount = coalesce(new_account_name, mvindex(account_name,0)) | transaction renamedcomputeraccount startswith=(eventcode=4781) endswith=(eventcode=4768) | eval short_lived=case((duration<2),"true") | search short_lived = true | table _time, computername, eventcode, account_name,renamedcomputeraccount, short_lived |`suspicious_ticket_granting_ticket_request_filter`'
<li><a href="#">search: ' `wineventlog_security` eventcode=4624 logon_type=3 account_name!="*$" | eval source_account = mvindex(account_name, 1) | bucket span=2m _time | stats dc(computername) as unique_targets values(computername) as target_hosts by _time, source_network_address, source_account | eventstats avg(unique_targets) as comp_avg , stdev(unique_targets) as comp_std by source_network_address, source_account | eval upperbound=(comp_avg+comp_std*3) | eval isoutlier=if(unique_targets >10 and unique_targets >= upperbound, 1, 0) | `unusual_number_of_remote_endpoint_authentication_events_filter`'
<li><a href="#">search: ' `wineventlog_security` eventcode=4625 logon_type=2 caller_process_name!="-" | bucket span=2m _time | eval source_account = mvindex(account_name, 0) | eval destination_account = mvindex(account_name, 1) | stats dc(destination_account) as unique_accounts values(account_name) as tried_accounts by _time, caller_process_name, source_account, computername | eventstats avg(unique_accounts) as comp_avg , stdev(unique_accounts) as comp_std by caller_process_name, source_account, computername | eval upperbound=(comp_avg+comp_std*3) | eval isoutlier=if(unique_accounts > 10 and unique_accounts >= upperbound, 1, 0) | search isoutlier=1 | `multiple_users_failing_to_authenticate_from_process_filter` '
<li><a href="#">search: ' `wineventlog_security` eventcode=4625 logon_type=3 source_network_address!="-" | bucket span=2m _time | eval destination_account = mvindex(account_name, 1) | stats dc(destination_account) as unique_accounts values(destination_account) as tried_accounts by _time, source_network_address, computername | eventstats avg(unique_accounts) as comp_avg , stdev(unique_accounts) as comp_std by source_network_address, computername | eval upperbound=(comp_avg+comp_std*3) | eval isoutlier=if(unique_accounts > 10 and unique_accounts >= upperbound, 1, 0) | search isoutlier=1 | `multiple_users_remotely_failing_to_authenticate_from_host_filter` '
<li><a href="#">search: ' `wineventlog_security` eventcode=4648 | bucket span=2m _time | eval source_account = mvindex(account_name, 0) | eval destination_account = mvindex(account_name, 1) | search source_account != "*$" source_account !="-" destination_account !="*$" | stats dc(destination_account) as unique_accounts values(destination_account) as tried_account by _time, computername, source_account | eventstats avg(unique_accounts) as comp_avg , stdev(unique_accounts) as comp_std by computername | eval upperbound=(comp_avg+comp_std*3) | eval isoutlier=if(unique_accounts > 10 and unique_accounts >= upperbound, 1, 0) | search isoutlier=1 | `windows_users_authenticate_using_explicit_credentials_filter` '
<li><a href="#">search: ' `wineventlog_security` eventcode=4698 | xmlkv message | lookup ut_shannon_lookup word as task_name | where ut_shannon > 3 | table _time, dest, task_name, ut_shannon, command, author, enabled, hidden | `randomly_generated_scheduled_task_name_filter`'
<li><a href="#">search: ' `wineventlog_security` eventcode=4698 or eventcode=4699 | xmlkv message | transaction task_name startswith=(eventcode=4698) endswith=(eventcode=4699) | eval short_lived=case((duration<30),"true") | search short_lived = true | table _time, computername, account_name, command, task_name, short_lived | `short_lived_scheduled_task_filter` '
<li><a href="#">search: ' `wineventlog_security` eventcode=4738 msadchangedattributes="*don''t require preauth'' - enabled*" | table eventcode, account_name, security_id, msadchangedattributes | `kerberos_pre_authentication_flag_disabled_in_useraccountcontrol_filter`'
<li><a href="#">search: ' `wineventlog_security` eventcode=4768 result_code=0x6 account_name!="*$" | bucket span=2m _time | stats dc(account_name) as unique_accounts values(account_name) as tried_accounts by _time, client_address | eventstats avg(unique_accounts) as comp_avg , stdev(unique_accounts) as comp_std by client_address | eval upperbound=(comp_avg+comp_std*3) | eval isoutlier=if(unique_accounts > 10 and unique_accounts >= upperbound, 1, 0) | search isoutlier=1 | `kerberos_user_enumeration_filter`'
<li><a href="#">search: ' `wineventlog_security` eventcode=4768 ticket_encryption_type=0x17 account_name!=*$ | `kerberos_tgt_request_using_rc4_encryption_filter` '
<li><a href="#">search: ' `wineventlog_security` eventcode=4769 | eval issuspicious = if(lower(service_name) = lower(mvindex(split(account_name,"@"),0)+"$"),1,0) | where issuspicious = 1 | table _time, client_address, account_name, service_name, failure_code, issuspicious | `suspicious_kerberos_service_ticket_request_filter`'
<li><a href="#">search: ' `wineventlog_security` eventcode=4769 service_name!="*$" ticket_encryption_type=0x17 | bucket span=2m _time | stats dc(service_name) as unique_services values(service_name) as requested_services by _time, client_address | eventstats avg(unique_services) as comp_avg , stdev(unique_services) as comp_std by client_address | eval upperbound=(comp_avg+comp_std*3) | eval isoutlier=if(unique_services > 2 and unique_services >= upperbound, 1, 0) | search isoutlier=1 | `unusual_number_of_kerberos_service_tickets_requested_filter`'
<li><a href="#">search: ' `wineventlog_security` eventcode=4769 service_name="*$" (ticket_options=0x40810000 or ticket_options=0x40800000 or ticket_options=0x40810010) ticket_encryption_type=0x17 | stats count min(_time) as firsttime max(_time) as lasttime by dest, service, service_id, ticket_encryption_type, ticket_options | `security_content_ctime(lasttime)` | `security_content_ctime(firsttime)` | `kerberos_service_ticket_request_using_rc4_encryption_filter`'
<li><a href="#">search: ' `wineventlog_security` eventcode=4769 service_name="*$" account_name!="*$*" | bucket span=2m _time | stats dc(service_name) as unique_targets values(service_name) as host_targets by _time, client_address, account_name | eventstats avg(unique_targets) as comp_avg , stdev(unique_targets) as comp_std by client_address, account_name | eval upperbound=(comp_avg+comp_std*3) | eval isoutlier=if(unique_targets >10 and unique_targets >= upperbound, 1, 0) | `unusual_number_of_computer_service_tickets_requested_filter`'
<li><a href="#">search: ' `wineventlog_security` eventcode=4776 logon_account!="*$" 0xc0000064 action=failure | bucket span=2m _time | stats dc(logon_account) as unique_accounts values(logon_account) as tried_accounts by _time, source_workstation | eventstats avg(unique_accounts) as comp_avg , stdev(unique_accounts) as comp_std by source_workstation | eval upperbound=(comp_avg+comp_std*3) | eval isoutlier=if(unique_accounts > 10 and unique_accounts >= upperbound, 1, 0) | search isoutlier=1 | `multiple_invalid_users_failing_to_authenticate_from_host_using_ntlm_filter`'
<li><a href="#">search: ' `wineventlog_security` eventcode=4776 logon_account!="*$" 0xc000006a action=failure | bucket span=2m _time | stats dc(logon_account) as unique_accounts values(logon_account) as tried_accounts by _time, source_workstation | eventstats avg(unique_accounts) as comp_avg , stdev(unique_accounts) as comp_std by source_workstation | eval upperbound=(comp_avg+comp_std*3) | eval isoutlier=if(unique_accounts > 10 and unique_accounts >= upperbound, 1, 0) | search isoutlier=1 | `multiple_users_failing_to_authenticate_from_host_using_ntlm_filter`'
<li><a href="#">search: ' `wineventlog_system` eventcode=7045 | eval l_service_file_name=lower(service_file_name) | regex l_service_file_name="powershell[.\s]|powershell_ise[.\s]|pwsh[.\s]|psexec[.\s]" | regex l_service_file_name="-nop[rofile\s]+|-w[indowstyle]*\s+hid[den]*|-noe[xit\s]+|-enc[odedcommand\s]+" | stats count min(_time) as firsttime max(_time) as lasttime by eventcode service_file_name service_name service_start_type service_type service_account user | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `malicious_powershell_executed_as_a_service_filter`'
<li><a href="#">search: ' `wineventlog_system` eventcode=7045 | lookup ut_shannon_lookup word as service_name | where ut_shannon > 3 | table eventcode computername service_name ut_shannon service_start_type service_type service_file_name | `randomly_generated_windows_service_name_filter` '
<li><a href="#">search: ' `wineventlog_system` eventcode=7045 service_file_name = "*.exe" not (service_file_name in ("*:\\windows\\*", "*:\\program file*", "*:\\programdata\\*", "*%systemroot%\\*")) | stats count min(_time) as firsttime max(_time) as lasttime by eventcode service_file_name service_name service_start_type service_type | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `windows_service_created_with_suspicious_service_path_filter`'
<li><a href="#">search: ' | from read_ssa_enriched_events() | eval _time=map_get(input_event, "_time"), eventcode=map_get(input_event, "event_code"), ticketoptions=map_get(input_event, "ticket_options"), ticketencryptiontype=map_get(input_event, "ticket_encryption_type"), servicename=map_get(input_event, "service_name"), serviceid=map_get(input_event, "service_id"), dest_user_id=ucast(map_get(input_event, "dest_user_id"), "string", null), dest_device_id=ucast(map_get(input_event, "dest_device_id"), "string", null), event_id=ucast(map_get(input_event, "event_id"), "string", null) | where eventcode="4769" and ticketoptions="0x40810000" and ticketencryptiontype="0x17" | first_time_event input_columns=["eventcode","ticketoptions","ticketencryptiontype","servicename","serviceid"] | where first_time_eventcode_ticketoptions_ticketencryptiontype_servicename_serviceid | eval start_time=_time, end_time=_time | eval body=create_map(["event_id", event_id, "eventcode", eventcode, "servicename", servicename, "ticketoptions", ticketoptions, "ticketencryptiontype", ticketencryptiontype]), entities = mvappend(ucast(map_get(input_event, "dest_user_id"), "string", null), ucast(map_get(input_event, "dest_device_id"), "string", null)) | select start_time, end_time, entities, body | into write_ssa_detected_events();'
<li><a href="#">search: ' | from read_ssa_enriched_events() | eval device=ucast(map_get(input_event, "dest_device_id"), "string", null), process_name=lower(ucast(map_get(input_event, "process_name"), "string", null)), timestamp=parse_long(ucast(map_get(input_event, "_time"), "string", null)) | where process_name=="regsvcs.exe" or process_name=="ftp.exe" or process_name=="dfsvc.exe" or process_name=="rasautou.exe" or process_name=="schtasks.exe" or process_name=="xwizard.exe" or process_name=="findstr.exe" or process_name=="esentutl.exe" or process_name=="cscript.exe" or process_name=="reg.exe" or process_name=="csc.exe" or process_name=="atbroker.exe" or process_name=="print.exe" or process_name=="pcwrun.exe" or process_name=="vbc.exe" or process_name=="rpcping.exe" or process_name=="wsreset.exe" or process_name=="ilasm.exe" or process_name=="certutil.exe" or process_name=="replace.exe" or process_name=="mshta.exe" or process_name=="bitsadmin.exe" or process_name=="wscript.exe" or process_name=="ieexec.exe" or process_name=="cmd.exe" or process_name=="microsoft.workflow.compiler.exe" or process_name=="runscripthelper.exe" or process_name=="makecab.exe" or process_name=="forfiles.exe" or process_name=="desktopimgdownldr.exe" or process_name=="control.exe" or process_name=="msbuild.exe" or process_name=="register-cimprovider.exe" or process_name=="tttracer.exe" or process_name=="ie4uinit.exe" or process_name=="sc.exe" or process_name=="bash.exe" or process_name=="hh.exe" or process_name=="cmstp.exe" or process_name=="mmc.exe" or process_name=="jsc.exe" or process_name=="scriptrunner.exe" or process_name=="odbcconf.exe" or process_name=="extexport.exe" or process_name=="msdt.exe" or process_name=="diskshadow.exe" or process_name=="extrac32.exe" or process_name=="eventvwr.exe" or process_name=="mavinject.exe" or process_name=="regasm.exe" or process_name=="gpscript.exe" or process_name=="rundll32.exe" or process_name=="regsvr32.exe" or process_name=="regedit.exe" or process_name=="msiexec.exe" or process_name=="gfxdownloadwrapper.exe" or process_name=="presentationhost.exe" or process_name=="regini.exe" or process_name=="wmic.exe" or process_name=="runonce.exe" or process_name=="syncappvpublishingserver.exe" or process_name=="verclsid.exe" or process_name=="psr.exe" or process_name=="infdefaultinstall.exe" or process_name=="explorer.exe" or process_name=="expand.exe" or process_name=="installutil.exe" or process_name=="netsh.exe" or process_name=="wab.exe" or process_name=="dnscmd.exe" or process_name=="at.exe" or process_name=="pcalua.exe" or process_name=="cmdkey.exe" or process_name=="msconfig.exe" | stats count(process_name) as lolbas_counter by device,span(timestamp, 300s) | eval lolbas_counter=lolbas_counter*1.0 | rename window_end as timestamp | adaptive_threshold algorithm="quantile" value="lolbas_counter" entity="device" window=2419200000l | where label and quantile>0.99 | eval start_time = window_start, end_time = timestamp, entities = mvappend(device), body=create_map(["lolbas_counter", lolbas_counter, "quantile", quantile, "device", device]) | into write_ssa_detected_events();'
<li><a href="#">search: ' | from read_ssa_enriched_events() | eval timestamp=parse_long(ucast(map_get(input_event, "_time"), "string", null)) | eval process_name=lower(ucast(map_get(input_event, "process_name"), "string", null)), cmd_line=ucast(map_get(input_event, "process"), "string", null), dest_user_id=ucast(map_get(input_event, "dest_user_id"), "string", null), dest_device_id=ucast(map_get(input_event, "dest_device_id"), "string", null), event_id=ucast(map_get(input_event, "event_id"), "string", null) | where process_name="cmd.exe" or process_name="reg.exe" | where cmd_line != null and match_regex(cmd_line, /(?i)save\s+/)=true and ( match_regex(cmd_line, /(?i)hklm\\security/)=true or match_regex(cmd_line, /(?i)hklm\\sam/)=true or match_regex(cmd_line, /(?i)hklm\\system/)=true or match_regex(cmd_line, /(?i)hkey_local_machine\\security/)=true or match_regex(cmd_line, /(?i)hkey_local_machine\\sam/)=true or match_regex(cmd_line, /(?i)hkey_local_machine\\system/)=true ) | eval start_time = timestamp, end_time = timestamp, entities = mvappend(dest_device_id, dest_user_id), body=create_map(["event_id", event_id, "cmd_line", cmd_line, "process_name", process_name]) | into write_ssa_detected_events(); '
<li><a href="#">search: ' | from read_ssa_enriched_events() | eval timestamp=parse_long(ucast(map_get(input_event, "_time"), "string", null)), cmd_line=ucast(map_get(input_event, "process"), "string", null), process_name=ucast(map_get(input_event, "process_name"), "string", null), process_path=ucast(map_get(input_event, "process_path"), "string", null), event_id=ucast(map_get(input_event, "event_id"), "string", null) | where cmd_line != null and process_name != null and process_path != null and match_regex(process_name, /(?i)cachedump\d{0,2}.exe/)=true and match_regex(process_path, /(?i)\\temp/)=true and match_regex(cmd_line, /(?i)\-v/)=true | eval start_time = timestamp, end_time = timestamp, entities = mvappend( ucast(map_get(input_event, "dest_user_id"), "string", null), ucast(map_get(input_event, "dest_device_id"), "string", null)), body=create_map(["event_id", event_id, "cmd_line", cmd_line, "process_name", process_name]) | into write_ssa_detected_events();'
<li><a href="#">search: ' from read_ssa_enriched_events() | eval device=ucast(map_get(input_event, "dest_device_id"), "string", null), user=ucast(map_get(input_event, "dest_user_id"), "string", null), timestamp=parse_long(ucast(map_get(input_event, "_time"), "string", null)), process_name=lower(ucast(map_get(input_event, "process_name"), "string", null)), cmd_line=lower(ucast(map_get(input_event, "process"), "string", null)), process_path=lower(ucast(map_get(input_event, "process_path"), "string", null)), event_id=ucast(map_get(input_event, "event_id"), "string", null) | where process_name is not null and process_name="mpcmdrun.exe" | where process_path is not null and match_regex(process_path, /(?i)\\microsoft\\windows defender\\platform/)=false and match_regex(process_path, /(?i)\\windows defender/)=false | eval start_time=timestamp, end_time=timestamp, entities=mvappend(device, user), body=create_map(["event_id", event_id, "process_path", process_path, "process_name", process_name, "cmd_line", cmd_line]) | into write_ssa_detected_events(); '
<li><a href="#">search: "`gws_reports_login` event.type = login event.name = login_failure | bucket span=5m _time | stats count dc(user) as unique_accounts values(user) as tried_accounts values(authentication_method) as authentication_method earliest(_time) as firsttime latest(_time) as lasttime by _time event.name src app id.applicationname | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | where unique_accounts > 20 | `gcp_multiple_users_failing_to_authenticate_from_ip_filter`"
<li><a href="#">search: "`gws_reports_login` event.type = login event.name = login_failure| bucket span=5m _time | stats dc(user_name) as unique_accounts values(user_name) as tried_accounts values(authentication_method) as authentication_method by _time, src | eventstats avg(unique_accounts) as ip_avg , stdev(unique_accounts) as ip_std by _time | eval upperbound=(ip_avg+ip_std*3) | eval isoutlier=if(unique_accounts > 10 and unique_accounts >= upperbound, 1, 0) | where isoutlier =1| `gcp_unusual_number_of_failed_authentications_from_ip_filter`"
<li><a href="#">search: "| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time)\ \ as lasttime from datamodel=endpoint.processes where `process_powershell` by processes.user\ \ processes.process_name processes.process processes.parent_process_name processes.original_file_name\ \ processes.dest processes.process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)`\ \ | `security_content_ctime(lasttime)` | where match(process,\"(?i)[\\-|\\/|\u2013\ |\u2014|\u2015]e(nc*o*d*e*d*c*o*m*m*a*n*d*)*\\s+[^-]\") | `malicious_powershell_process___encoded_command_filter`"
<li><a href="#">search: "| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time)\ \ as lasttime from datamodel=endpoint.processes where `process_powershell` by processes.user\ \ processes.process_name processes.process processes.parent_process_name processes.original_file_name\ \ processes.dest processes.process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)`\ \ | `security_content_ctime(lasttime)` | where match(process,\"(?i)[\\-|\\/|\u2013\ |\u2014|\u2015]w(in*d*o*w*s*t*y*l*e*)*\\s+[^-]\") | `powershell___connect_to_internet_with_hidden_window_filter`"
<li><a href="#">search: '(`sysmon` eventcode=7 imageloaded=*solarwinds.orion.core.businesslayer.dll) or (`sysmon` eventcode=22 queryname=*avsvmcloud.com) | eventstats dc(eventcode) as dc_events | where dc_events=2 | stats min(_time) as firsttime max(_time) as lasttime values(imageloaded) as imageloaded values(queryname) as queryname by host | rename host as dest | `security_content_ctime(firsttime)`| `security_content_ctime(lasttime)` | `sunburst_correlation_dll_and_network_event_filter` '
<li><a href="#">search: (`sysmon` or tag=process) eventcode=11 process_id!=4 file_path=*system\ volume\ information* | stats count min(_time) as firsttime max(_time) as lasttime by dest, image, file_path | `security_content_ctime(firsttime)`| `security_content_ctime(lasttime)` | `suspicious_writes_to_system_volume_information_filter`
<li><a href="#">search: (`wineventlog_security` eventcode=1100) | stats count min(_time) as firsttime max(_time) as lasttime by dest message eventcode | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `suspicious_event_log_service_behavior_filter`
<li><a href="#">search: (`wineventlog_security` eventcode=1102) or (`wineventlog_system` eventcode=104) | stats count min(_time) as firsttime max(_time) as lasttime by dest message eventcode | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `windows_event_log_cleared_filter`
<li><a href="#">search: '`aws_cloudwatchlogs_eks` "user.username"="system:anonymous" useragent!="aws security scanner" | rename sourceips{} as src_ip | stats count min(_time) as firsttime max(_time) as lasttime values(responsestatus.reason) values(source) as cluster_name values(responsestatus.code) values(useragent) as http_user_agent values(verb) values(requesturi) by src_ip user.username user.groups{} | `security_content_ctime(lasttime)` | `security_content_ctime(firsttime)` |`amazon_eks_kubernetes_cluster_scan_detection_filter` '
<li><a href="#">search: '`aws_cloudwatchlogs_eks` "user.username"="system:anonymous" verb=list objectref.resource=pods requesturi="/api/v1/pods" | rename source as cluster_name sourceips{} as src_ip | stats count min(_time) as firsttime max(_time) as lasttime values(responsestatus.reason) values(responsestatus.code) values(useragent) values(verb) values(requesturi) by src_ip cluster_name user.username user.groups{} | `security_content_ctime(lasttime)` | `security_content_ctime(firsttime)` | `amazon_eks_kubernetes_pod_scan_detection_filter` '
<li><a href="#">search: '`aws_cloudwatchlogs_eks` asia useridentity.type=iamuser| spath eventname | search eventname=getsessiontoken | table sourceipaddress eventtime useridentity.arn username useragent user_type status region | `aws_detect_sts_get_session_token_abuse_filter`'
<li><a href="#">search: '`aws_cloudwatchlogs_eks` attach policy| spath requestparameters.policyarn | table sourceipaddress user_access_key useridentity.arn useridentity.sessioncontext.sessionissuer.arn eventname errorcode errormessage status action requestparameters.policyarn useridentity.sessioncontext.attributes.mfaauthenticated useridentity.sessioncontext.attributes.creationdate | `aws_detect_attach_to_role_policy_filter`'
<li><a href="#">search: '`aws_cloudwatchlogs_eks` createaccesskey | spath eventname | search eventname=createaccesskey "useridentity.type"=iamuser | table sourceipaddress username useridentity.type useragent action status responseelements.accesskey.createdate responseelements.accesskey.status responseelements.accesskey.accesskeyid |`aws_detect_permanent_key_creation_filter`'
<li><a href="#">search: '`aws_cloudwatchlogs_eks` event_name=createrole action=created useridentity.type=assumedrole requestparameters.
<li><a href="#">search: '`aws_s3_accesslogs` http_status=200 [search `aws_s3_accesslogs` http_status=200 | stats earliest(_time) as firsttime latest(_time) as lasttime by bucket_name remote_ip | inputlookup append=t previously_seen_s3_access_from_remote_ip.csv | stats min(firsttime) as firsttime, max(lasttime) as lasttime by bucket_name remote_ip | outputlookup previously_seen_s3_access_from_remote_ip.csv | eval newip=if(firsttime >= relative_time(now(), "-70m@m"), 1, 0) | where newip=1 | `security_content_ctime(firsttime)`| `security_content_ctime(lasttime)` | table bucket_name remote_ip]| iplocation remote_ip |rename remote_ip as src_ip | table _time bucket_name src_ip city country operation request_uri | `detect_s3_access_from_a_new_ip_filter`'
<li><a href="#">search: '`azuread` "body.operationname"="add member to role" "body.properties.targetresources{}.modifiedproperties{}.newvalue"="\"global administrator\"" | rename body.properties.* as * | rename targetresources{}.userprincipalname as userprincipalname | rename initiatedby.user.userprincipalname as initiatedby | stats values(userprincipalname) by _time, initiatedby, result, body.operationname | `azure_ad_global_administrator_role_assigned_filter`'
<li><a href="#">search: '`azuread` "body.operationname"="add service principal" "body.properties.initiatedby.user.id"=* | rename body.properties.* as * | rename targetresources{}.displayname as displayname | rename initiatedby.user.userprincipalname as initiatedby | rename targetresources{}.type as type | stats values(displayname) by _time, type, initiatedby, result, body.operationname | `azure_ad_service_principal_created_filter`'
<li><a href="#">search: '`azuread` "body.operationname"="invite external user" | rename body.properties.* as * | rename targetresources{}.userprincipalname as userprincipalname | rename initiatedby.user.userprincipalname as initiatedby | rename targetresources{}.type as type | stats values(userprincipalname) by _time, type, initiatedby, result, body.operationname | `azure_ad_external_guest_user_invited_filter`'
<li><a href="#">search: '`azuread` body.category=auditlogs body.operationname="disable strong authentication" | rename body.properties.* as * | rename targetresources{}.userprincipalname as userprincipalname | rename targetresources{}.type as type | rename initiatedby.user.userprincipalname as initiatedby | stats values(userprincipalname) by _time, type, body.operationname, initiatedby, result | `azure_ad_multi_factor_authentication_disabled_filter`'
<li><a href="#">search: '`circleci` | rename vcs.committer_name as user vcs.subject as commit_message vcs.url as url workflows.* as * | stats values(job_name) as job_names by workflow_id workflow_name user commit_message url branch | lookup mandatory_job_for_workflow workflow_name outputnew job_name as mandatory_job | search mandatory_job=* | eval mandatory_job_executed=if(like(job_names, "%".mandatory_job."%"), 1, 0) | where mandatory_job_executed=0 | eval phase="build" | rex field=url "(?<repository>[^\/]*\/[^\/]*)$" | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `circle_ci_disable_security_job_filter`'
<li><a href="#">search: '`circleci` | rename workflows.job_id as job_id | join job_id [ | search `circleci` | stats values(name) as step_names count by job_id job_name ] | stats count by step_names job_id job_name vcs.committer_name vcs.subject vcs.url owners{} | rename vcs.* as * , owners{} as user | lookup mandatory_step_for_job job_name outputnew step_name as mandatory_step | search mandatory_step=* | eval mandatory_step_executed=if(like(step_names, "%".mandatory_step."%"), 1, 0) | where mandatory_step_executed=0 | rex field=url "(?<repository>[^\/]*\/[^\/]*)$" | eval phase="build" | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `circle_ci_disable_security_step_filter`'
<li><a href="#">search: '`cisco_networks` (facility="mirror" mnemonic="eth_span_session_up") or (facility="span" mnemonic="session_up") or (facility="span" mnemonic="pktcap_start") or (mnemonic="cfglog_loggedcmd" command="monitor session*") | stats min(_time) as firsttime max(_time) as lasttime count by host facility mnemonic | `security_content_ctime(firsttime)`|`security_content_ctime(lasttime)` | `detect_traffic_mirroring_filter`'
<li><a href="#">search: '`cisco_networks` (facility="pm" mnemonic="err_disable" disable_cause="psecure-violation") or (facility="port_security" mnemonic="psecure_violation" or mnemonic="psecure_violation_vlan") | eval src_interface=src_int_prefix_long+src_int_suffix | stats min(_time) as firsttime max(_time) as lasttime values(disable_cause) as disable_cause values(src_mac) as src_mac values(src_vlan) as src_vlan values(action) as action count by host src_interface | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `detect_port_security_violation_filter`'
<li><a href="#">search: '`cisco_networks` facility="dhcp_snooping" mnemonic="dhcp_snooping_untrusted_port" | stats min(_time) as firsttime max(_time) as lasttime count values(message_type) as message_type values(src_mac) as src_mac by host | `security_content_ctime(firsttime)`|`security_content_ctime(lasttime)`| `detect_rogue_dhcp_server_filter`'
<li><a href="#">search: '`cisco_networks` facility="pm" mnemonic="err_disable" disable_cause="arp-inspection" | eval src_interface=src_int_prefix_long+src_int_suffix | stats min(_time) as firsttime max(_time) as lasttime count by host src_interface | `security_content_ctime(firsttime)`|`security_content_ctime(lasttime)`| `detect_arp_poisoning_filter`'
<li><a href="#">search: '`cisco_networks` facility="sisf" mnemonic in ("ip_theft","mac_theft","mac_and_ip_theft","pak_drop") | eval src_interface=src_int_prefix_long+src_int_suffix | eval dest_interface=dest_int_prefix_long+dest_int_suffix | stats min(_time) as firsttime max(_time) as lasttime values(src_mac) as src_mac values(src_vlan) as src_vlan values(mnemonic) as mnemonic values(vendor_explanation) as vendor_explanation values(src_ip) as src_ip values(dest_ip) as dest_ip values(dest_interface) as dest_interface values(action) as action count by host src_interface | table host src_interface dest_interface src_mac src_ip dest_ip src_vlan mnemonic vendor_explanation action count | `security_content_ctime(firsttime)` |`security_content_ctime(lasttime)` | `detect_ipv6_network_infrastructure_threats_filter`'
<li><a href="#">search: '`cloudtrail` (eventname=run* or eventname=create*) | iplocation sourceipaddress | search city=* [search `cloudtrail` (eventname=run* or eventname=create*) | iplocation sourceipaddress | search city=* | stats earliest(_time) as firsttime, latest(_time) as lasttime by sourceipaddress, city, region, country | inputlookup append=t previously_seen_provisioning_activity_src.csv | stats min(firsttime) as firsttime max(lasttime) as lasttime by sourceipaddress, city, region, country | outputlookup previously_seen_provisioning_activity_src.csv | stats min(firsttime) as firsttime max(lasttime) as lasttime by city | eval newcity=if(firsttime >= relative_time(now(), "-70m@m"), 1, 0) | where newcity=1 | table city] | spath output=user useridentity.arn | rename sourceipaddress as src_ip | table _time, user, src_ip, city, eventname, errorcode | `aws_cloud_provisioning_from_previously_unseen_city_filter`'
<li><a href="#">search: '`cloudtrail` (eventname=run* or eventname=create*) | iplocation sourceipaddress | search country=* [search `cloudtrail` (eventname=run* or eventname=create*) | iplocation sourceipaddress | search country=* | stats earliest(_time) as firsttime, latest(_time) as lasttime by sourceipaddress, city, region, country | inputlookup append=t previously_seen_provisioning_activity_src.csv | stats min(firsttime) as firsttime max(lasttime) as lasttime by sourceipaddress, city, region, country | outputlookup previously_seen_provisioning_activity_src.csv | stats min(firsttime) as firsttime max(lasttime) as lasttime by country | eval newcountry=if(firsttime >= relative_time(now(), "-70m@m"), 1, 0) | where newcountry=1 | table country] | spath output=user useridentity.arn | rename sourceipaddress as src_ip | table _time, user, src_ip, country, eventname, errorcode | `aws_cloud_provisioning_from_previously_unseen_country_filter`'
<li><a href="#">search: '`cloudtrail` (eventname=run* or eventname=create*) | iplocation sourceipaddress | search region=* [search `cloudtrail` (eventname=run* or eventname=create*) | iplocation sourceipaddress | search region=* | stats earliest(_time) as firsttime, latest(_time) as lasttime by sourceipaddress, city, region, country | inputlookup append=t previously_seen_provisioning_activity_src.csv | stats min(firsttime) as firsttime max(lasttime) as lasttime by sourceipaddress, city, region, country | outputlookup previously_seen_provisioning_activity_src.csv | stats min(firsttime) as firsttime max(lasttime) as lasttime by region | eval newregion=if(firsttime >= relative_time(now(), "-70m@m"), 1, 0) | where newregion=1 | table region] | spath output=user useridentity.arn | rename sourceipaddress as src_ip | table _time, user, src_ip, region, eventname, errorcode | `aws_cloud_provisioning_from_previously_unseen_region_filter`'
<li><a href="#">search: '`cloudtrail` `ec2_modification_api_calls` [search `cloudtrail` `ec2_modification_api_calls` errorcode=success | stats earliest(_time) as firsttime latest(_time) as lasttime by useridentity.arn | rename useridentity.arn as arn | inputlookup append=t previously_seen_ec2_modifications_by_user | stats min(firsttime) as firsttime, max(lasttime) as lasttime by arn | outputlookup previously_seen_ec2_modifications_by_user | eval newuser=if(firsttime >= relative_time(now(), "-70m@m"), 1, 0) | where newuser=1 | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | rename arn as useridentity.arn | table useridentity.arn] | spath output=dest responseelements.instancesset.items{}.instanceid | spath output=user useridentity.arn | table _time, user, dest | `ec2_instance_modified_with_previously_unseen_user_filter`'
<li><a href="#">search: '`cloudtrail` `network_acl_events` [search `cloudtrail` `network_acl_events` | spath output=arn path=useridentity.arn | stats count as apicalls by arn | inputlookup network_acl_activity_baseline append=t | fields - latestcount | stats values(*) as * by arn | rename apicalls as latestcount | eval newavgapicalls=avgapicalls + (latestcount-avgapicalls)/720 | eval newstdevapicalls=sqrt(((pow(stdevapicalls, 2)*719 + (latestcount-newavgapicalls)*(latestcount-avgapicalls))/720)) | eval avgapicalls=coalesce(newavgapicalls, avgapicalls), stdevapicalls=coalesce(newstdevapicalls, stdevapicalls), numdatapoints=if(isnull(latestcount), numdatapoints, numdatapoints+1) | table arn, latestcount, numdatapoints, avgapicalls, stdevapicalls | outputlookup network_acl_activity_baseline | eval datapointthreshold = 15, deviationthreshold = 3 | eval isspike=if((latestcount > avgapicalls+deviationthreshold*stdevapicalls) and numdatapoints > datapointthreshold, 1, 0) | where isspike=1 | rename arn as useridentity.arn | table useridentity.arn] | spath output=user useridentity.arn | stats values(eventname) as eventnames, count as numberofapicalls, dc(eventname) as uniqueapiscalled by user | `detect_spike_in_network_acl_activity_filter`'
<li><a href="#">search: '`cloudtrail` `security_group_api_calls` [search `cloudtrail` `security_group_api_calls` | spath output=arn path=useridentity.arn | stats count as apicalls by arn | inputlookup security_group_activity_baseline append=t | fields - latestcount | stats values(*) as * by arn | rename apicalls as latestcount | eval newavgapicalls=avgapicalls + (latestcount-avgapicalls)/720 | eval newstdevapicalls=sqrt(((pow(stdevapicalls, 2)*719 + (latestcount-newavgapicalls)*(latestcount-avgapicalls))/720)) | eval avgapicalls=coalesce(newavgapicalls, avgapicalls), stdevapicalls=coalesce(newstdevapicalls, stdevapicalls), numdatapoints=if(isnull(latestcount), numdatapoints, numdatapoints+1) | table arn, latestcount, numdatapoints, avgapicalls, stdevapicalls | outputlookup security_group_activity_baseline | eval datapointthreshold = 15, deviationthreshold = 3 | eval isspike=if((latestcount > avgapicalls+deviationthreshold*stdevapicalls) and numdatapoints > datapointthreshold, 1, 0) | where isspike=1 | rename arn as useridentity.arn | table useridentity.arn] | spath output=user useridentity.arn | stats values(eventname) as eventnames, count as numberofapicalls, dc(eventname) as uniqueapiscalled by user | `detect_spike_in_security_group_activity_filter`'
<li><a href="#">search: '`cloudtrail` earliest=-1h startinstances | stats earliest(_time) as earliest latest(_time) as latest by awsregion | inputlookup append=t previously_seen_aws_regions.csv | stats min(earliest) as earliest max(latest) as latest by awsregion | outputlookup previously_seen_aws_regions.csv | eval regionstatus=if(earliest >= relative_time(now(),"-1d@d"), "instance started in a new region","previously seen region") | `security_content_ctime(earliest)` | `security_content_ctime(latest)` | where regionstatus="instance started in a new region" | `ec2_instance_started_in_previously_unseen_region_filter`'
<li><a href="#">search: '`cloudtrail` errorcode=success | rename username as identity | search not [| inputlookup identity_lookup_expanded | fields identity] | search not [| inputlookup aws_service_accounts | fields identity] | rename identity as user | stats count min(_time) as firsttime max(_time) as lasttime values(eventname) as eventname by user | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `detect_aws_api_activities_from_unapproved_accounts_filter`'
<li><a href="#">search: '`cloudtrail` eventname= consolelogin errorcode=success "additionaleventdata.mfaused"=no | stats count min(_time) as firsttime max(_time) as lasttime by src eventname eventsource aws_account_id errorcode additionaleventdata.mfaused useragent eventid awsregion user_name useridentity.arn | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `aws_successful_single_factor_authentication_filter`'
<li><a href="#">search: '`cloudtrail` eventname=consolelogin | rename useridentity.arn as user | stats earliest(_time) as firsttime latest(_time) as lasttime by user | inputlookup append=t previously_seen_users_console_logins_cloudtrail | stats min(firsttime) as firsttime max(lasttime) as lasttime by user | eval userstatus=if(firsttime >= relative_time(now(), "-70m@m"), "first time logging into aws console","previously seen user") | `security_content_ctime(firsttime)`|`security_content_ctime(lasttime)`| where userstatus ="first time logging into aws console" | `detect_new_user_aws_console_login_filter`'
<li><a href="#">search: '`cloudtrail` eventname=consolelogin action=failure | bucket span=10m _time | stats dc(_raw) as unique_accounts values(user_name) as tried_accounts by _time, src_ip | eventstats avg(unique_accounts) as ip_avg , stdev(unique_accounts) as ip_std by _time | eval upperbound=(ip_avg+ip_std*3) | eval isoutlier=if(unique_accounts > 10 and unique_accounts >= upperbound, 1, 0) | where isoutlier = 1 |`aws_unusual_number_of_failed_authentications_from_ip_filter`'
<li><a href="#">search: '`cloudtrail` eventname=deletebucket [search `cloudtrail` eventname=deletebucket | spath output=arn path=useridentity.arn | stats count as apicalls by arn | inputlookup s3_deletion_baseline append=t | fields - latestcount | stats values(*) as * by arn | rename apicalls as latestcount | eval newavgapicalls=avgapicalls + (latestcount-avgapicalls)/720 | eval newstdevapicalls=sqrt(((pow(stdevapicalls, 2)*719 + (latestcount-newavgapicalls)*(latestcount-avgapicalls))/720)) | eval avgapicalls=coalesce(newavgapicalls, avgapicalls), stdevapicalls=coalesce(newstdevapicalls, stdevapicalls), numdatapoints=if(isnull(latestcount), numdatapoints, numdatapoints+1) | table arn, latestcount, numdatapoints, avgapicalls, stdevapicalls | outputlookup s3_deletion_baseline | eval datapointthreshold = 15, deviationthreshold = 3 | eval isspike=if((latestcount > avgapicalls+deviationthreshold*stdevapicalls) and numdatapoints > datapointthreshold, 1, 0) | where isspike=1 | rename arn as useridentity.arn | table useridentity.arn] | spath output=user useridentity.arn | spath output=bucketname path=requestparameters.bucketname | stats values(bucketname) as bucketname, count as numberofapicalls, dc(eventname) as uniqueapiscalled by user | `detect_spike_in_s3_bucket_deletion_filter`'
<li><a href="#">search: '`cloudtrail` eventname=modifysnapshotattribute | rename requestparameters.createvolumepermission.add.items{}.userid as requested_account_id | search requested_account_id != null | eval match=if(requested_account_id==aws_account_id,"match","no match") | table _time user_arn src_ip requestparameters.attributetype requested_account_id aws_account_id match vendor_region user_agent | where match = "no match" | `detect_shared_ec2_snapshot_filter` '
<li><a href="#">search: '`cloudtrail` eventname=runinstances [search `cloudtrail` eventname=runinstances errorcode=success | stats earliest(_time) as firsttime latest(_time) as lasttime by useridentity.arn | rename useridentity.arn as arn | inputlookup append=t previously_seen_ec2_launches_by_user.csv | stats min(firsttime) as firsttime, max(lasttime) as lasttime by arn | outputlookup previously_seen_ec2_launches_by_user.csv | eval newuser=if(firsttime >= relative_time(now(), "-70m@m"), 1, 0) | where newuser=1 | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | rename arn as useridentity.arn | table useridentity.arn] | rename requestparameters.instancetype as instancetype, responseelements.instancesset.items{}.instanceid as dest, useridentity.arn as user | table _time, user, dest, instancetype | `ec2_instance_started_with_previously_unseen_user_filter`'
<li><a href="#">search: '`cloudtrail` eventname=runinstances errorcode=success `abnormally_high_aws_instances_launched_by_user___mltk_filter` | bucket span=10m _time | stats count as instances_launched by _time src_user | apply ec2_excessive_runinstances_v1 | rename "isoutlier(instances_launched)" as isoutlier | where isoutlier=1'
<li><a href="#">search: '`cloudtrail` eventname=runinstances errorcode=success | bucket span=10m _time | stats count as instances_launched by _time username | eventstats avg(instances_launched) as total_launched_avg, stdev(instances_launched) as total_launched_stdev | eval threshold_value = 4 | eval isoutlier=if(instances_launched > total_launched_avg+(total_launched_stdev * threshold_value), 1, 0) | search isoutlier=1 and _time >= relative_time(now(), "-10m@m") | eval num_standard_deviations_away = round(abs(instances_launched - total_launched_avg) / total_launched_stdev, 2) | table _time, username, instances_launched, num_standard_deviations_away, total_launched_avg, total_launched_stdev | `abnormally_high_aws_instances_launched_by_user_filter`'
<li><a href="#">search: '`cloudtrail` eventname=setdefaultpolicyversion eventsource = iam.amazonaws.com | stats count min(_time) as firsttime max(_time) as lasttime values(requestparameters.policyarn) as policy_arn by src requestparameters.versionid eventname eventsource aws_account_id errorcode useragent eventid awsregion useridentity.principalid user_arn | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `aws_setdefaultpolicyversion_filter`'
<li><a href="#">search: '`cloudtrail` eventname=terminateinstances errorcode=success `abnormally_high_aws_instances_terminated_by_user___mltk_filter` | bucket span=10m _time | stats count as instances_terminated by _time src_user | apply ec2_excessive_terminateinstances_v1 | rename "isoutlier(instances_terminated)" as isoutlier | where isoutlier=1'
<li><a href="#">search: '`cloudtrail` eventname=terminateinstances errorcode=success | bucket span=10m _time | stats count as instances_terminated by _time username | eventstats avg(instances_terminated) as total_terminations_avg, stdev(instances_terminated) as total_terminations_stdev | eval threshold_value = 4 | eval isoutlier=if(instances_terminated > total_terminations_avg+(total_terminations_stdev * threshold_value), 1, 0) | search isoutlier=1 and _time >= relative_time(now(), "-10m@m")| eval num_standard_deviations_away = round(abs(instances_terminated - total_terminations_avg) / total_terminations_stdev, 2) |table _time, username, instances_terminated, num_standard_deviations_away, total_terminations_avg, total_terminations_stdev | `abnormally_high_aws_instances_terminated_by_user_filter`'
<li><a href="#">search: '`cloudtrail` eventname=updatesamlprovider | stats count min(_time) as firsttime max(_time) as lasttime by eventtype eventname requestparameters.samlproviderarn useridentity.sessioncontext.sessionissuer.arn sourceipaddress useridentity.accesskeyid useridentity.principalid | `security_content_ctime(firsttime)`| `security_content_ctime(lasttime)` |`aws_saml_update_identity_provider_filter`'
<li><a href="#">search: '`cloudtrail` eventsource="s3.amazonaws.com" (useragent="[aws-cli*" or useragent=aws-cli* ) eventname=putbucketacl or requestparameters.accesscontrollist.x-amz-grant-read-acp in ("*authenticatedusers","*allusers") or requestparameters.accesscontrollist.x-amz-grant-write in ("*authenticatedusers","*allusers") or requestparameters.accesscontrollist.x-amz-grant-write-acp in ("*authenticatedusers","*allusers") or requestparameters.accesscontrollist.x-amz-grant-full-control in ("*authenticatedusers","*allusers") | rename requestparameters.bucketname as bucketname | fillnull | stats count min(_time) as firsttime max(_time) as lasttime by useridentity.username useridentity.principalid useragent bucketname requestparameters.accesscontrollist.x-amz-grant-read requestparameters.accesscontrollist.x-amz-grant-read-acp requestparameters.accesscontrollist.x-amz-grant-write requestparameters.accesscontrollist.x-amz-grant-write-acp requestparameters.accesscontrollist.x-amz-grant-full-control | `security_content_ctime(firsttime)`| `security_content_ctime(lasttime)` | `detect_new_open_s3_buckets_over_aws_cli_filter` '
<li><a href="#">search: '`cloudtrail` eventsource=s3.amazonaws.com eventname=putbucketacl | rex field=_raw "(?<json_field>{.+})" | spath input=json_field output=grantees path=requestparameters.accesscontrolpolicy.accesscontrollist.grant{} | search grantees=* | mvexpand grantees | spath input=grantees output=uri path=grantee.uri | spath input=grantees output=permission path=permission | search uri in ("","") | search permission in ("read","read_acp","write","write_acp","full_control") | rename requestparameters.bucketname as bucketname | stats count min(_time) as firsttime max(_time) as lasttime by user_arn useridentity.principalid useragent uri permission bucketname | `security_content_ctime(firsttime)`| `security_content_ctime(lasttime)` | `detect_new_open_s3_buckets_filter` '
<li><a href="#">search: '`cloudtrail` eventtype=awsapicall [search `cloudtrail` eventtype=awsapicall | spath output=arn path=useridentity.arn | stats count as apicalls by arn | inputlookup api_call_by_user_baseline append=t | fields - latestcount | stats values(*) as * by arn | rename apicalls as latestcount | eval newavgapicalls=avgapicalls + (latestcount-avgapicalls)/720 | eval newstdevapicalls=sqrt(((pow(stdevapicalls, 2)*719 + (latestcount-newavgapicalls)*(latestcount-avgapicalls))/720)) | eval avgapicalls=coalesce(newavgapicalls, avgapicalls), stdevapicalls=coalesce(newstdevapicalls, stdevapicalls), numdatapoints=if(isnull(latestcount), numdatapoints, numdatapoints+1) | table arn, latestcount, numdatapoints, avgapicalls, stdevapicalls | outputlookup api_call_by_user_baseline | eval datapointthreshold = 15, deviationthreshold = 3 | eval isspike=if((latestcount > avgapicalls+deviationthreshold*stdevapicalls) and numdatapoints > datapointthreshold, 1, 0) | where isspike=1 | rename arn as useridentity.arn | table useridentity.arn] | spath output=user useridentity.arn | stats values(eventname) as eventname, count as numberofapicalls, dc(eventname) as uniqueapiscalled by user | `detect_spike_in_aws_api_activity_filter`'
<li><a href="#">search: '`cloudtrail` eventtype=awsapicall errorcode=success useridentity.type=assumedrole [search `cloudtrail` eventtype=awsapicall errorcode=success useridentity.type=assumedrole | stats earliest(_time) as earliest latest(_time) as latest by username eventname | inputlookup append=t previously_seen_api_calls_from_user_roles | stats min(earliest) as earliest, max(latest) as latest by username eventname | outputlookup previously_seen_api_calls_from_user_roles| eval newapicallfromuserrole=if(earliest>=relative_time(now(), "-70m@m"), 1, 0) | where newapicallfromuserrole=1 | `security_content_ctime(earliest)` | `security_content_ctime(latest)` | table eventname username] |rename username as user| stats values(eventname) earliest(_time) as earliest latest(_time) as latest by user | `security_content_ctime(earliest)` | `security_content_ctime(latest)` | `detect_new_api_calls_from_user_roles_filter`'
<li><a href="#">search: '`cloudtrail` user_type=assumedrole useridentity.sessioncontext.sessionissuer.type=role | table sourceipaddress useridentity.arn user_agent user_access_key status action requestparameters.rolename responseelements.role.rolename responseelements.role.createdate | `aws_detect_sts_assume_role_abuse_filter`'
<li><a href="#">search: '`exchange` c_uri="*//autodiscover*" cs_uri_query="*powershell*" cs_method="post" | stats count min(_time) as firsttime max(_time) as lasttime by dest, cs_uri_query, cs_method, c_uri | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `exchange_powershell_abuse_via_ssrf_filter`'
<li><a href="#">search: '`f5_bigip_rogue` | regex _raw="(hsqldb;|.*\\.\\.;.*)" | search `detect_f5_tmui_rce_cve_2020_5902_filter`'
<li><a href="#">search: '`github` alert.id=* action=create | rename repository.full_name as repository, repository.html_url as repository_url sender.login as user | stats min(_time) as firsttime max(_time) as lasttime by action alert.affected_package_name alert.affected_range alert.created_at alert.external_identifier alert.external_reference alert.fixed_in alert.severity repository repository_url user | eval phase="code" | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `github_dependabot_alert_filter`'
<li><a href="#">search: '`github` branches{}.name = main or branches{}.name = develop | stats count min(_time) as firsttime max(_time) as lasttime by commit.author.html_url commit.commit.author.email commit.author.login commit.commit.message repository.pushed_at commit.commit.committer.date | eval phase="code" | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `github_commit_in_develop_filter`'
<li><a href="#">search: '`github` branches{}.name = main or branches{}.name = master | stats count min(_time) as firsttime max(_time) as lasttime by commit.commit.author.email commit.author.login commit.commit.message repository.pushed_at commit.commit.committer.date repository.full_name | rename commit.author.login as user, repository.full_name as repository | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `github_commit_changes_in_master_filter`'
<li><a href="#">search: '`github` check_suite.pull_requests{}.id=* | stats count by check_suite.head_commit.author.name repository.full_name check_suite.pull_requests{}.head.ref check_suite.head_commit.message | rename check_suite.head_commit.author.name as user repository.full_name as repository check_suite.pull_requests{}.head.ref as ref_head check_suite.head_commit.message as commit_message | search not `github_known_users` | eval phase="code" | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `github_pull_request_from_unknown_user_filter`'
<li><a href="#">search: '`github` workflow_run.event=push or workflow_run.event=pull_request | stats values(workflow_run.name) as workflow_run.name by workflow_run.head_commit.id workflow_run.event workflow_run.head_branch workflow_run.head_commit.author.email workflow_run.head_commit.author.name workflow_run.head_commit.message workflow_run.head_commit.timestamp workflow_run.head_repository.full_name workflow_run.head_repository.owner.id workflow_run.head_repository.owner.login workflow_run.head_repository.owner.type | rename workflow_run.head_commit.author.name as user, workflow_run.head_commit.author.email as user_email, workflow_run.head_repository.full_name as repository, workflow_run.head_branch as branch | search not workflow_run.name=*security-testing* | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `github_actions_disable_security_workflow_filter`'
<li><a href="#">search: '`google_gcp_pubsub_message` | multikv | rename sc_status_ as status | rename cs_object_ as bucket_name | rename c_ip_ as remote_ip | rename cs_uri_ as request_uri | rename cs_method_ as operation | search status="\"200\"" | stats earliest(_time) as firsttime latest(_time) as lasttime by bucket_name remote_ip operation request_uri | table firsttime, lasttime, bucket_name, remote_ip, operation, request_uri | inputlookup append=t previously_seen_gcp_storage_access_from_remote_ip | stats min(firsttime) as firsttime, max(lasttime) as lasttime by bucket_name remote_ip operation request_uri | outputlookup previously_seen_gcp_storage_access_from_remote_ip | eval newip=if(firsttime >= relative_time(now(),"-70m@m"), 1, 0) | where newip=1 | eval first_time=strftime(firsttime,"%m/%d/%y %h:%m:%s") | eval last_time=strftime(lasttime,"%m/%d/%y %h:%m:%s") | table first_time last_time bucket_name remote_ip operation request_uri | `detect_gcp_storage_access_from_a_new_ip_filter`'
<li><a href="#">search: '`google_gcp_pubsub_message` category=kube-audit |spath input=properties.log |search responsestatus.code=401 |table sourceips{} useragent verb requesturi responsestatus.reason properties.pod | `gcp_kubernetes_cluster_pod_scan_detection_filter`'
<li><a href="#">search: '`google_gcp_pubsub_message` data.protopayload.authorizationinfo{}.permission=iam.serviceaccounts.getaccesstoken or iam.serviceaccounts.setiampolicy or iam.serviceaccounts.actas or dataflow.jobs.create or composer.environments.create or dataproc.clusters.create |table data.protopayload.requestmetadata.callerip data.protopayload.authenticationinfo.principalemail data.protopayload.authorizationinfo{}.permission data.protopayload.response.bindings{}.members{} data.resource.labels.project_id | `gcp_detect_high_risk_permissions_by_resource_and_account_filter`'
<li><a href="#">search: '`google_gcp_pubsub_message` data.protopayload.request.function.timeout=539s | table src src_user data.resource.labels.project_id data.protopayload.request.function.serviceaccountemail data.protopayload.authorizationinfo{}.permission data.protopayload.request.location http_user_agent | `gcp_detect_gcploit_framework_filter`'
<li><a href="#">search: '`google_gcp_pubsub_message` data.protopayload.request.policy.bindings{}.role=roles/owner or roles/editor or roles/iam.serviceaccountuser or roles/iam.serviceaccountadmin or roles/iam.serviceaccounttokencreator or roles/dataflow.developer or roles/dataflow.admin or roles/composer.admin or roles/dataproc.admin or roles/dataproc.editor | table data.resource.type data.protopayload.authenticationinfo.principalemail data.protopayload.authorizationinfo{}.permission data.protopayload.authorizationinfo{}.resource data.protopayload.response.bindings{}.role data.protopayload.response.bindings{}.members{} | `gcp_detect_accounts_with_high_risk_roles_by_project_filter`'
<li><a href="#">search: '`google_gcp_pubsub_message` data.protopayload.requestmetadata.callerip!=127.0.0.1 data.protopayload.requestmetadata.callerip!=::1 "data.labels.authorization.k8s.io/decision"=forbid "data.protopayload.status.message"=permission_denied data.protopayload.authenticationinfo.principalemail="system:anonymous" | rename data.protopayload.requestmetadata.callerip as src_ip | stats count min(_time) as firsttime max(_time) as lasttime values(data.protopayload.methodname) as method_name values(data.protopayload.resourcename) as resource_name values(data.protopayload.requestmetadata.callersupplieduseragent) as http_user_agent by src_ip data.resource.labels.cluster_name | rename data.resource.labels.cluster_name as cluster_name| `security_content_ctime(lasttime)` | `security_content_ctime(firsttime)` | `gcp_kubernetes_cluster_scan_detection_filter` '
<li><a href="#">search: '`google_gcp_pubsub_message` data.resource.type=gcs_bucket data.protopayload.methodname=storage.setiampermissions | spath output=action path=data.protopayload.servicedata.policydelta.bindingdeltas{}.action | spath output=user path=data.protopayload.authenticationinfo.principalemail | spath output=location path=data.protopayload.resourcelocation.currentlocations{} | spath output=src path=data.protopayload.requestmetadata.callerip | spath output=bucketname path=data.protopayload.resourcename | spath output=role path=data.protopayload.servicedata.policydelta.bindingdeltas{}.role | spath output=member path=data.protopayload.servicedata.policydelta.bindingdeltas{}.member | search (member=allusers and action=add) | table _time, bucketname, src, user, location, action, role, member | search `detect_new_open_gcp_storage_buckets_filter`'
<li><a href="#">search: '`google_gcp_pubsub_message` type.googleapis.com/google.cloud.audit.auditlog |table protopayload.@type protopayload.status.details{}.@type protopayload.status.details{}.violations{}.callerip protopayload.status.details{}.violations{}.type protopayload.status.message | `gcp_detect_oauth_token_abuse_filter`'
<li><a href="#">search: '`gsuite_calendar` |bin span=5m _time |rename parameters.* as * |search target_calendar_id!=null email="*yourdomain.com"| stats count values(target_calendar_id) values(event_title) values(event_guest) by email _time | where count >100| `gsuite_suspicious_calendar_invite_filter`'
<li><a href="#">search: '`gsuite_drive` name=change_user_access | rename parameters.* as * | search email = "*@yourdomain.com" target_user != "*@yourdomain.com" | stats count values(owner) as owner values(target_user) as target values(doc_type) as doc_type values(doc_title) as doc_title dc(target_user) as distinct_target by src_ip email | where distinct_target > 50 | `gdrive_suspicious_file_sharing_filter`'
<li><a href="#">search: '`gsuite_drive` not (email in("", "null")) | rex field=parameters.owner "[^@]+@(?<src_domain>[^@]+)" | rex field=email "[^@]+@(?<dest_domain>[^@]+)" | where src_domain = "internal_test_email.com" and not dest_domain = "internal_test_email.com" | eval phase="plan" | eval severity="low" | stats values(parameters.doc_title) as doc_title, values(parameters.doc_type) as doc_types, values(email) as dst_email_list, values(parameters.visibility) as visibility, values(parameters.doc_id) as doc_id, count min(_time) as firsttime max(_time) as lasttime by parameters.owner ip_address phase severity | rename parameters.owner as user ip_address as src_ip | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `gsuite_drive_share_in_external_email_filter`'
<li><a href="#">search: '`gsuite_drive` parameters.owner_is_team_drive=false "parameters.doc_title" in ("*dhl*", "* ups *", "*delivery*", "*parcel*", "*label*", "*invoice*", "*postal*", "*fedex*", "* usps *", "* express *", "*shipment*", "*banking/tax*","*shipment*", "*new order*") parameters.doc_type in ("document","pdf", "msexcel", "msword", "spreadsheet", "presentation") | rex field=parameters.owner "[^@]+@(?<source_domain>[^@]+)" | rex field=parameters.target_user "[^@]+@(?<dest_domain>[^@]+)" | where not source_domain="internal_test_email.com" and dest_domain="internal_test_email.com" | eval phase="plan" | eval severity="low" | stats count min(_time) as firsttime max(_time) as lasttime by email parameters.owner parameters.target_user parameters.doc_title parameters.doc_type phase severity | rename parameters.target_user as user | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `gsuite_suspicious_shared_file_name_filter`'
<li><a href="#">search: '`gsuite_gmail` "attachment{}.file_extension_type" in ("pl", "py", "rb", "sh", "bat", "exe", "dll", "cpl", "com", "js", "vbs", "ps1", "reg","swf", "cmd", "go") | eval phase="plan" | eval severity="medium" | stats count min(_time) as firsttime max(_time) as lasttime values(attachment{}.file_extension_type) as email_attachments, values(attachment{}.sha256) as attachment_sha256, values(payload_size) as payload_size by destination{}.service num_message_attachments subject destination{}.address source.address phase severity | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `gsuite_email_suspicious_attachment_filter`'
<li><a href="#">search: '`gsuite_gmail` "link_domain{}" in ("*pastebin.com*", "*discord*", "*telegram*","t.me") | rex field=source.from_header_address "[^@]+@(?<source_domain>[^@]+)" | rex field=destination{}.address "[^@]+@(?<dest_domain>[^@]+)" | where not source_domain="internal_test_email.com" and dest_domain="internal_test_email.com" | eval phase="plan" | eval severity="low" |stats values(link_domain{}) as link_domains min(_time) as firsttime max(_time) as lasttime count by is_spam source.address source.from_header_address subject destination{}.address phase severity | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `gsuite_email_with_known_abuse_web_service_link_filter`'
<li><a href="#">search: '`gsuite_gmail` num_message_attachments > 0 | rex field=source.from_header_address "[^@]+@(?<source_domain>[^@]+)" | rex field=destination{}.address "[^@]+@(?<dest_domain>[^@]+)" | where source_domain="internal_test_email.com" and not dest_domain="internal_test_email.com" | eval phase="plan" | eval severity="low" | stats values(subject) as subject, values(source.from_header_address) as src_domain_list, count as numevents, dc(source.from_header_address) as numsrcaddresses, min(_time) as firsttime max(_time) as lasttime by dest_domain phase severity | where numsrcaddresses < 20 |sort - numsrcaddresses | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `gsuite_outbound_email_with_attachment_to_external_domain_filter`'
<li><a href="#">search: '`gsuite_gmail` num_message_attachments > 0 subject in ("*dhl*", "* ups *", "*delivery*", "*parcel*", "*label*", "*invoice*", "*postal*", "* fedex *", "* usps *", "* express *", "*shipment*", "*banking/tax*","*shipment*", "*new order*") attachment{}.file_extension_type in ("doc", "docx", "xls", "xlsx", "ppt", "pptx", "pdf", "zip", "rar", "html","htm","hta") | rex field=source.from_header_address "[^@]+@(?<source_domain>[^@]+)" | rex field=destination{}.address "[^@]+@(?<dest_domain>[^@]+)" | where not source_domain="internal_test_email.com" and dest_domain="internal_test_email.com" | eval phase="plan" | eval severity="medium" | stats count min(_time) as firsttime max(_time) as lasttime values(attachment{}.file_extension_type) as email_attachments, values(attachment{}.sha256) as attachment_sha256, values(payload_size) as payload_size by destination{}.service num_message_attachments subject destination{}.address source.address phase severity | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `gsuite_email_suspicious_subject_with_attachment_filter`'
<li><a href="#">search: '`iis_get_webglobalmodule` | stats count min(_time) as firsttime max(_time) as lasttime by host name image | rename host as dest | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `windows_iis_components_get_webglobalmodule_module_query_filter`'
<li><a href="#">search: '`iis_operational_logs` eventcode=29 | stats count min(_time) as firsttime max(_time) as lasttime by opcode eventcode computername message | rename computername as dest | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `windows_iis_components_new_module_added_filter`'
<li><a href="#">search: '`kube_objects_events` object.message in ("pulling image *kube-hunter*", "pulling image *kube-bench*", "pulling image *kube-recon*", "pulling image *kube-recon*") | rename object.* as * | rename involvedobject.* as * | rename source.host as host | eval phase="operate" | eval severity="high" | stats min(_time) as firsttime max(_time) as lasttime count by host, name, namespace, kind, reason, message, phase, severity | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `kubernetes_scanner_image_pulling_filter`'
<li><a href="#">search: '`kubernetes_azure` category=kube-audit | spath input=properties.log | search responsestatus.code=401 | table sourceips{} useragent verb requesturi responsestatus.reason |`kubernetes_azure_scan_fingerprint_filter`'
<li><a href="#">search: '`kubernetes_container_controller` | rex field=_raw "^(?<remote_addr>\s+)\s+-\s+-\s+\[(?<time_local>[^\]]*)\]\s\"(?<request>[^\"]*)\"\s(?<status>\s*)\s(?<body_bytes_sent>\s*)\s\"(?<http_referer>[^\"]*)\"\s\"(?<http_user_agent>[^\"]*)\"\s(?<request_length>\s*)\s(?<request_time>\s*)\s\[(?<proxy_upstream_name>[^\]]*)\]\s\[(?<proxy_alternative_upstream_name>[^\]]*)\]\s(?<upstream_addr>\s*)\s(?<upstream_response_length>\s*)\s(?<upstream_response_time>\s*)\s(?<upstream_status>\s*)\s(?<req_id>\s*)" | lookup local_file_inclusion_paths local_file_inclusion_paths as request output lfi_path | search lfi_path=yes | rename remote_addr as src_ip, upstream_status as status, proxy_upstream_name as proxy | rex field=request "^(?<http_method>\s+)\s(?<url>\s+)\s" | eval phase="operate" | eval severity="high" | stats count min(_time) as firsttime max(_time) as lasttime by src_ip, status, url, http_method, host, http_user_agent, proxy, phase, severity | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `kubernetes_nginx_ingress_lfi_filter`'
<li><a href="#">search: '`kubernetes_container_controller` | rex field=_raw "^(?<remote_addr>\s+)\s+-\s+-\s+\[(?<time_local>[^\]]*)\]\s\"(?<request>[^\"]*)\"\s(?<status>\s*)\s(?<body_bytes_sent>\s*)\s\"(?<http_referer>[^\"]*)\"\s\"(?<http_user_agent>[^\"]*)\"\s(?<request_length>\s*)\s(?<request_time>\s*)\s\[(?<proxy_upstream_name>[^\]]*)\]\s\[(?<proxy_alternative_upstream_name>[^\]]*)\]\s(?<upstream_addr>\s*)\s(?<upstream_response_length>\s*)\s(?<upstream_response_time>\s*)\s(?<upstream_status>\s*)\s(?<req_id>\s*)" | rex field=request "^(?<http_method>\s+)?\s(?<url>\s+)\s" | rex field=url "(?<dest_ip>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})" | search dest_ip=* | rename remote_addr as src_ip, upstream_status as status, proxy_upstream_name as proxy | eval phase="operate" | eval severity="medium" | stats count min(_time) as firsttime max(_time) as lasttime by src_ip, dest_ip status, url, http_method, host, http_user_agent, proxy, phase, severity | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `kubernetes_nginx_ingress_rfi_filter`'
<li><a href="#">search: '`linux_hosts` | search "sudoedit -s \\" | `detect_baron_samedit_cve_2021_3156_filter`'
<li><a href="#">search: '`linux_hosts` | search sudoedit segfault | stats count min(_time) as firsttime max(_time) as lasttime by host | search count > 5 | `detect_baron_samedit_cve_2021_3156_segfault_filter`'
<li><a href="#">search: '`msexchange_management` eventcode=1 message in ("*new-mailboxexportrequest*", "*new-managementroleassignment*", "*new-mailboxsearch*", "*get-recipient*", "*search-mailbox*") | stats count min(_time) as firsttime max(_time) as lasttime by host message | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | rename host as dest | `windows_msexchange_management_mailbox_cmdlet_usage_filter`'
<li><a href="#">search: '`o365_management_activity` category=threatmanagement name="ediscovery search started or exported" | stats count earliest(_time) as firsttime latest(_time) as lasttime by source severity alertentityid operation name |`security_content_ctime(firsttime)` |`security_content_ctime(lasttime)` | `o365_pst_export_alert_filter`'
<li><a href="#">search: '`o365_management_activity` operation="disable strong authentication." | stats count earliest(_time) as firsttime latest(_time) as lasttime by usertype operation userid resultstatus object | rename usertype as user_type, operation as action, userid as src_user, object as user, resultstatus as result | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `o365_disable_mfa_filter`'
<li><a href="#">search: '`o365_management_activity` operation="set company information." modifiedproperties{}.name=strongauthenticationpolicy | rex max_match=100 field=modifiedproperties{}.newvalue "(?<ip_addresses_new_added>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}\/\d{1,2})" | rex max_match=100 field=modifiedproperties{}.oldvalue "(?<ip_addresses_old>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}\/\d{1,2})" | eval ip_addresses_old=if(isnotnull(ip_addresses_old),ip_addresses_old,"0") | mvexpand ip_addresses_new_added | where isnull(mvfind(ip_addresses_old,ip_addresses_new_added)) |stats count min(_time) as firsttime max(_time) as lasttime values(ip_addresses_old) as ip_addresses_old by user ip_addresses_new_added operation workload vendor_account status user_id action | `security_content_ctime(firsttime)`| `security_content_ctime(lasttime)`| `o365_bypass_mfa_via_trusted_ip_filter`'
<li><a href="#">search: '`o365_management_activity` operation=add-mailboxpermission | spath input=parameters | rename user as src_user, identity as dest_user | search accessrights=fullaccess or accessrights=sendas or accessrights=sendonbehalf | stats count earliest(_time) as firsttime latest(_time) as lasttime by user src_user dest_user operation accessrights |`security_content_ctime(firsttime)` |`security_content_ctime(lasttime)` |`o365_suspicious_rights_delegation_filter`'
<li><a href="#">search: '`o365_management_activity` operation=set-mailbox | spath input=parameters | rename identity as src_user | search forwardingaddress=* | stats dc(src_user) as count_src_user earliest(_time) as firsttime latest(_time) as lasttime values(src_user) as src_user values(user) as user by forwardingaddress | where count_src_user > 1 |`security_content_ctime(firsttime)` |`security_content_ctime(lasttime)` |`o365_suspicious_admin_email_forwarding_filter`'
<li><a href="#">search: '`o365_management_activity` operation=set-mailbox | spath input=parameters | rename identity as src_user | search forwardingsmtpaddress=* | stats dc(src_user) as count_src_user earliest(_time) as firsttime latest(_time) as lasttime values(src_user) as src_user values(user) as user by forwardingsmtpaddress | where count_src_user > 1 |`security_content_ctime(firsttime)` |`security_content_ctime(lasttime)` |`o365_suspicious_user_email_forwarding_filter`'
<li><a href="#">search: '`o365_management_activity` operation=userloginfailed record_type=azureactivedirectorystslogon app=azureactivedirectory | stats count dc(user) as accounts_locked values(user) as user values(logonerror) as logonerror values(authentication_method) as authentication_method values(signature) as signature values(useragent) as useragent by src_ip record_type operation app | search accounts_locked >= 5| `high_number_of_login_failures_from_a_single_source_filter`'
<li><a href="#">search: '`o365_management_activity` workload=azureactivedirectory logonerror=ssoartifactinvalidorexpired | stats count min(_time) as firsttime max(_time) as lasttime by logonerror actoripaddress useragent userid | where count > 5 | `security_content_ctime(firsttime)`| `security_content_ctime(lasttime)` | `o365_excessive_sso_logon_errors_filter`'
<li><a href="#">search: '`o365_management_activity` workload=azureactivedirectory operation="add app role assignment grant to user." | stats count min(_time) as firsttime max(_time) as lasttime values(actor{}.id) as actor.id values(actor{}.type) as actor.type by actoripaddress dest resultstatus | `security_content_ctime(firsttime)`| `security_content_ctime(lasttime)` | `o365_add_app_role_assignment_grant_user_filter`'
<li><a href="#">search: '`o365_management_activity` workload=azureactivedirectory operation="add service principal credentials." | stats min(_time) as firsttime max(_time) as lasttime values(actor{}.id) as actor.id values(modifiedproperties{}.name) as modifiedproperties.name values(modifiedproperties{}.newvalue) as modifiedproperties.newvalue values(target{}.id) as target.id by actoripaddress operation | `security_content_ctime(firsttime)`| `security_content_ctime(lasttime)` | `o365_added_service_principal_filter`'
<li><a href="#">search: '`o365_management_activity` workload=azureactivedirectory userauthenticationmethod=* status=failure | stats count earliest(_time) as firsttime latest(_time) as lasttime values(userauthenticationmethod) as userauthenticationmethod values(useragent) as useragent values(status) as status values(src_ip) as src_ip by user | where count > 10 | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `o365_excessive_authentication_failures_alert_filter`'
<li><a href="#">search: '`o365_management_activity` workload=exchange operation="add-federateddomain" | stats count min(_time) as firsttime max(_time) as lasttime values(parameters{}.value) as parameters.value by objectid operation organizationname originatingserver userid userkey | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `o365_new_federated_domain_added_filter`'
<li><a href="#">search: '`okta` displaymessage="user login to okta" client.geographicalcontext.city!=null | stats min(_time) as firsttime max(_time) as lasttime dc(client.geographicalcontext.city) as locations values(client.geographicalcontext.city) as cities values(client.geographicalcontext.state) as states by user | `security_content_ctime(firsttime)`| `security_content_ctime(lasttime)` | `okta_user_logins_from_multiple_cities_filter` | search locations > 1'
<li><a href="#">search: '`okta` eventtype in (security.threat.detected, security.internal.threat.detected) | rename client.geographicalcontext.country as country, client.geographicalcontext.state as state, client.geographicalcontext.city as city | stats values(src_ip) count by signature eventtype displaymessage client.device city state country user_agent outcome.reason outcome.result severity | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `okta_threatinsight_threat_detected_filter`'
<li><a href="#">search: '`okta` eventtype in (user.account.lock.limit,user.account.lock) | rename client.geographicalcontext.country as country, client.geographicalcontext.state as state, client.geographicalcontext.city as city | stats count min(_time) as firsttime max(_time) as lasttime values(src_user) by displaymessage, country, state, city, src_ip | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `okta_account_lockout_events_filter`'
<li><a href="#">search: '`okta` eventtype=app.generic.unauth_app_access_attempt | stats min(_time) as firsttime max(_time) as lasttime values(app) as apps count by src_user, result ,displaymessage, src_ip | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `okta_failed_sso_attempts_filter` '
<li><a href="#">search: '`okta` eventtype=system.api_token.create | stats count min(_time) as firsttime max(_time) as lasttime values(displaymessage) by src_user src_ip eventtype status | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `okta_new_api_token_created_filter`'
<li><a href="#">search: '`okta` eventtype=system.email.new_device_notification.sent_message displaymessage="send user new device notification email" | stats count min(_time) as firsttime max(_time) as lasttime values(displaymessage) by user eventtype client.useragent.rawuseragent client.useragent.browser client.geographicalcontext.city client.geographicalcontext.country | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `okta_new_device_enrolled_on_account_filter`'
<li><a href="#">search: '`okta` eventtype=system.push.send_factor_verify_push or ((legacyeventtype=core.user.factor.attempt_success) and (debugcontext.debugdata.factor=okta_verify_push)) or ((legacyeventtype=core.user.factor.attempt_fail) and (debugcontext.debugdata.factor=okta_verify_push)) | stats count(eval(legacyeventtype="core.user.factor.attempt_success")) as successes count(eval(legacyeventtype="core.user.factor.attempt_fail")) as failures count(eval(eventtype="system.push.send_factor_verify_push")) as pushes by authenticationcontext.externalsessionid,user,_time | stats latest(_time) as lasttime earliest(_time) as firsttime sum(successes) as successes sum(failures) as failures sum(pushes) as pushes by authenticationcontext.externalsessionid,user | eval seconds=lasttime-firsttime | eval lasttime=strftime(lasttime, "%c") | search (pushes>1) | eval totalattempts=successes+failures | eval finding="normal authentication pattern" | eval finding=if(failures==pushes and pushes>1,"authentication attempts not successful because multiple pushes denied",finding) | eval finding=if(totalattempts==0,"multiple pushes sent and ignored",finding) | eval finding=if(successes>0 and pushes>3,"probably should investigate. multiple pushes sent, eventual successful authentication!",finding) | where seconds<600 and finding="multiple pushes sent, eventual successful authentication!" and totalattempts > 5 | sort - pushes, totalattempts | `okta_mfa_exhaustion_hunt_filter`'
<li><a href="#">search: '`okta` eventtype=user.account.lock | stats count min(_time) as firsttime max(_time) as lasttime values(displaymessage) by src_user src_ip eventtype status | where count >=3 | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)`| `okta_account_locked_out_filter`'
<li><a href="#">search: '`okta` eventtype=user.account.report_suspicious_activity_by_enduser | stats count min(_time) as firsttime max(_time) as lasttime values(displaymessage) by user eventtype client.useragent.rawuseragent client.useragent.browser client.geographicalcontext.city client.geographicalcontext.country | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `okta_suspicious_activity_reported_filter`'
<li><a href="#">search: '`okta` outcome.reason="user rejected okta push verify" or (debugcontext.debugdata.factor="okta_verify_push" outcome.result=failure legacyeventtype="core.user.factor.attempt_fail" "target{}.detailentry.methodtypeused"="get a push notification") | bin _time as bin_time span=10m | eval user=coalesce(actor.alternateid,user), user=mvindex(split(user, "@"), 0), event_time = _time | stats earliest(event_time) as event_time, min(_time) as firsttime max(_time) as lasttime values(client.ipaddress) as client.ipaddress, values(outcome.reason) as outcome, values(src_ip) as src_ip, values(client.useragent.rawuseragent) as user_agent, values(eventtype) as eventtype, values(outcome.result) as action, values(legacyeventtype) as legacyeventtype values(index) as idx, values(sourcetype) as st count by bin_time user host | rename bin_time as timewindow | convert ctime(*timewindow) ctime(firsttime) ctime(lasttime) | where count >= 2 | `okta_two_or_more_rejected_okta_pushes_filter`'
<li><a href="#">search: '`okta` outcome.reason=invalid_credentials | rename client.geographicalcontext.country as country, client.geographicalcontext.state as state, client.geographicalcontext.city as city | stats min(_time) as firsttime max(_time) as lasttime dc(src_user) as distinct_users values(src_user) as users by src_ip, displaymessage, outcome.reason, country, state, city | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | search distinct_users > 5| `multiple_okta_users_with_invalid_credentials_from_the_same_ip_filter` '
<li><a href="#">search: '`osquery_process` "columns.cmdline"="*launchagents*" or "columns.cmdline"="*runatload*" or "columns.cmdline"="*true*" | `suspicious_plistbuddy_usage_via_osquery_filter`'
<li><a href="#">search: '`osquery_process` | search "columns.cmdline"="sudoedit -s \\*" | `detect_baron_samedit_cve_2021_3156_via_osquery_filter`'
<li><a href="#">search: '`osquery` name=es_process_events columns.cmdline in ("find*", "crontab*", "screencapture*", "openssl*", "curl*", "wget*", "killall*", "funzip*") | rename columns.* as * | stats min(_time) as firsttime max(_time) as lasttime values(cmdline) as cmdline, values(pid) as pid, values(parent) as parent, values(path) as path, values(signing_id) as signing_id, dc(path) as dc_path by username host | rename username as user, cmdline as process, path as process_path | where dc_path > 3 | `security_content_ctime(firsttime)`| `security_content_ctime(lasttime)` | `macos_lolbin_filter`'
<li><a href="#">search: '`osquery` name=es_process_events columns.path=/usr/bin/plutil | rename columns.* as * | stats count min(_time) as firsttime max(_time) as lasttime by username host cmdline pid path parent signing_id | rename username as user, cmdline as process, path as process_path | `security_content_ctime(firsttime)`| `security_content_ctime(lasttime)` | `macos_plutil_filter`'
<li><a href="#">search: '`powershell` eventcode=4104 (message = "*[adsisearcher]*" and message = "*(objectcategory=group)*" and message = "*findall()*") | stats count min(_time) as firsttime max(_time) as lasttime by eventcode message computername user | `security_content_ctime(firsttime)` | `domain_group_discovery_with_adsisearcher_filter`'
<li><a href="#">search: '`powershell` eventcode=4104 (message = "*add-mppreference *" or message = "*set-mppreference *") and message = "*-exclusion*" | stats count min(_time) as firsttime max(_time) as lasttime by eventcode message computername user | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `powershell_windows_defender_exclusion_commands_filter`'
<li><a href="#">search: '`powershell` eventcode=4104 (message = "*get-domaincomputer*" or message = "*get-netcomputer*") and (message = "*-trustedtoauth*") | stats count min(_time) as firsttime max(_time) as lasttime by eventcode message computername user | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `windows_powerview_constrained_delegation_discovery_filter`'
<li><a href="#">search: '`powershell` eventcode=4104 (message = "*get-domaincomputer*" or message = "*get-netcomputer*") and (message = "*-unconstrained*") | stats count min(_time) as firsttime max(_time) as lasttime by eventcode message computername user | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `windows_powerview_unconstrained_delegation_discovery_filter`'
<li><a href="#">search: '`powershell` eventcode=4104 (message = "*get-domaingroupmember*") and message in ("*domain admins*","*enterprise admins*", "*schema admins*", "*account operators*" , "*server operators*", "*protected users*", "*dns admins*") | stats count min(_time) as firsttime max(_time) as lasttime by eventcode message computername user | `security_content_ctime(firsttime)` | `elevated_group_discovery_with_powerview_filter`'
<li><a href="#">search: '`powershell` eventcode=4104 (scriptblocktext = "*$env:username*" or scriptblocktext = "*[system.environment]::username*") | stats count min(_time) as firsttime max(_time) as lasttime by eventcode scriptblocktext computer user_id | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `user_discovery_with_env_vars_powershell_script_block_filter`'
<li><a href="#">search: '`powershell` eventcode=4104 (scriptblocktext = "*get-adcomputer*") | stats count min(_time) as firsttime max(_time) as lasttime by opcode computer userid eventcode scriptblocktext | `security_content_ctime(firsttime)` | `getadcomputer_with_powershell_script_block_filter`'
<li><a href="#">search: '`powershell` eventcode=4104 (scriptblocktext = "*get-domaincomputer*") | stats count min(_time) as firsttime max(_time) as lasttime by opcode computer userid eventcode scriptblocktext | `security_content_ctime(firsttime)` | `getdomaincomputer_with_powershell_script_block_filter`'
<li><a href="#">search: '`powershell` eventcode=4104 (scriptblocktext = "*get-domaincontroller*") | stats count min(_time) as firsttime max(_time) as lasttime by opcode computer userid eventcode scriptblocktext | `security_content_ctime(firsttime)` | `getdomaincontroller_with_powershell_script_block_filter`'
<li><a href="#">search: '`powershell` eventcode=4104 (scriptblocktext = "*get-domaingroup*") | stats count min(_time) as firsttime max(_time) as lasttime by opcode computer userid eventcode scriptblocktext | `security_content_ctime(firsttime)` | `getdomaingroup_with_powershell_script_block_filter`'
<li><a href="#">search: '`powershell` eventcode=4104 (scriptblocktext = "*get-localuser*") | stats count min(_time) as firsttime max(_time) as lasttime by eventcode scriptblocktext computer user_id | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `getlocaluser_with_powershell_script_block_filter`'
<li><a href="#">search: '`powershell` eventcode=4104 (scriptblocktext = "*get-nettcpconnection*") | stats count min(_time) as firsttime max(_time) as lasttime by opcode computer userid eventcode scriptblocktext | `security_content_ctime(firsttime)` | `getnettcpconnection_with_powershell_script_block_filter`'
<li><a href="#">search: '`powershell` eventcode=4104 (scriptblocktext = "*select*" or scriptblocktext = "*wmic*") and (scriptblocktext = "*antivirusproduct*" or scriptblocktext = "*antispywareproduct*") | stats count min(_time) as firsttime max(_time) as lasttime by eventcode scriptblocktext computer user_id | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `recon_avproduct_through_pwh_or_wmi_filter`'
<li><a href="#">search: '`powershell` eventcode=4104 (scriptblocktext = "*set-adaccountcontrol*" and scriptblocktext="*doesnotrequirepreauth:$true*") | stats count min(_time) as firsttime max(_time) as lasttime by eventcode scriptblocktext computer user_id | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `kerberos_pre_authentication_flag_disabled_with_powershell_filter`'
<li><a href="#">search: '`powershell` eventcode=4104 (scriptblocktext =*get-netuser* or scriptblocktext=*get-domainuser*) scriptblocktext= *-spn* | stats count min(_time) as firsttime max(_time) as lasttime by eventcode scriptblocktext computer | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)`| `windows_powerview_spn_discovery_filter`'
<li><a href="#">search: '`powershell` eventcode=4104 (scriptblocktext= "*select*" or scriptblocktext= "*get-wmiobject*") and (scriptblocktext= "*win32_bios*" or scriptblocktext= "*win32_operatingsystem*" or scriptblocktext= "*win32_processor*" or scriptblocktext= "*win32_computersystem*" or scriptblocktext= "*win32_pnpentity*" or scriptblocktext= "*win32_shadowcopy*" or scriptblocktext= "*win32_diskdrive*" or scriptblocktext= "*win32_physicalmemory*") | stats count min(_time) as firsttime max(_time) as lasttime by eventcode scriptblocktext computer userid | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `recon_using_wmi_class_filter`'
<li><a href="#">search: '`powershell` eventcode=4104 (scriptblocktext="*document.application.shellexecute*" or scriptblocktext="*document.activeview.executeshellcommand*") | stats count min(_time) as firsttime max(_time) as lasttime by eventcode scriptblocktext computer user_id | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `remote_process_instantiation_via_dcom_and_powershell_script_block_filter`'
<li><a href="#">search: '`powershell` eventcode=4104 (scriptblocktext="*enter-pssession*" and scriptblocktext="*-computername*") | stats count min(_time) as firsttime max(_time) as lasttime by eventcode scriptblocktext computer user_id | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `interactive_session_on_remote_endpoint_with_powershell_filter`'
<li><a href="#">search: '`powershell` eventcode=4104 (scriptblocktext="*get-wmiobject*" and scriptblocktext="*win32_useraccount*") | stats count min(_time) as firsttime max(_time) as lasttime by eventcode scriptblocktext computer userid | `security_content_ctime(firsttime)` | `getwmiobject_user_account_with_powershell_script_block_filter`'
<li><a href="#">search: '`powershell` eventcode=4104 (scriptblocktext="*invoke-command*" and scriptblocktext="*-computername*") | stats count min(_time) as firsttime max(_time) as lasttime by eventcode scriptblocktext computer user_id | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `remote_process_instantiation_via_winrm_and_powershell_script_block_filter`'
<li><a href="#">search: '`powershell` eventcode=4104 (scriptblocktext=*get-wmiobject* and scriptblocktext="*namespace root\\directory\\ldap*" and scriptblocktext="*class ds_computer*") | stats count min(_time) as firsttime max(_time) as lasttime by opcode computer userid eventcode scriptblocktext | `security_content_ctime(firsttime)` | `getwmiobject_ds_computer_with_powershell_script_block_filter`'
<li><a href="#">search: '`powershell` eventcode=4104 (scriptblocktext=*get-wmiobject* and scriptblocktext="*namespace root\\directory\\ldap*" and scriptblocktext="*class ds_group*") | stats count min(_time) as firsttime max(_time) as lasttime by opcode computer userid eventcode scriptblocktext | `security_content_ctime(firsttime)` | `getwmiobject_ds_group_with_powershell_script_block_filter`'
<li><a href="#">search: '`powershell` eventcode=4104 (scriptblocktext=*system.net.webclient* and scriptblocktext=*frombase64string*) | stats count min(_time) as firsttime max(_time) as lasttime by opcode computer userid eventcode scriptblocktext | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `detect_empire_with_powershell_script_block_logging_filter`'
<li><a href="#">search: '`powershell` eventcode=4104 message = "*firewall*" message = "*inbound*" message = "*allow*" message = "*-localport*" | stats count min(_time) as firsttime max(_time) as lasttime by eventcode message computername user | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `allow_inbound_traffic_in_firewall_rule_filter`'
<li><a href="#">search: '`powershell` eventcode=4104 message in ("*copy*","*[system.io.file]::copy*") and message in ("*system32\\config\\sam*", "*system32\\config\\system*","*system32\\config\\security*") | stats count min(_time) as firsttime max(_time) as lasttime by opcode computername user eventcode message | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `detect_copy_of_shadowcopy_with_script_block_logging_filter`'
<li><a href="#">search: '`powershell` eventcode=4104 scriptblocktext = "*[adsisearcher]*" scriptblocktext = "*.searchroot*" scriptblocktext = "*.gplink*" | stats count min(_time) as firsttime max(_time) as lasttime by eventcode scriptblocktext computer user_id | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `windows_root_domain_linked_policies_discovery_filter`'
<li><a href="#">search: '`powershell` eventcode=4104 scriptblocktext = "*[adsisearcher]*" scriptblocktext = "*objectcategory=organizationalunit*" scriptblocktext = "*findall()*" | stats count min(_time) as firsttime max(_time) as lasttime by eventcode scriptblocktext computer user_id | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `windows_linked_policies_in_adsi_discovery_filter`'
<li><a href="#">search: '`powershell` eventcode=4104 scriptblocktext = "*[adsisearcher]*" scriptblocktext = "*objectcategory=user*" scriptblocktext = "*.findall()*" | stats count min(_time) as firsttime max(_time) as lasttime by eventcode computer scriptblocktext userid | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `adsisearcher_account_discovery_filter`'
<li><a href="#">search: '`powershell` eventcode=4104 scriptblocktext = "*[system.security.principal.windowsidentity]*" scriptblocktext = "*getcurrent()*" | stats count min(_time) as firsttime max(_time) as lasttime by eventcode scriptblocktext computer user_id | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `getcurrent_user_with_powershell_script_block_filter`'
<li><a href="#">search: '`powershell` eventcode=4104 scriptblocktext = "*adsisearcher*" and scriptblocktext = "*objectcategory=computer*" and scriptblocktext in ("*findall()*","*findone()*") | stats count min(_time) as firsttime max(_time) as lasttime by eventcode scriptblocktext computer userid | `security_content_ctime(firsttime)` | `remote_system_discovery_with_adsisearcher_filter`'
<li><a href="#">search: '`powershell` eventcode=4104 scriptblocktext = "*createinstance([type]::gettypefromclsid*" | stats count min(_time) as firsttime max(_time) as lasttime by eventcode scriptblocktext computer user_id | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `powershell_execute_com_object_filter`'
<li><a href="#">search: '`powershell` eventcode=4104 scriptblocktext = "*enable-windowsoptionalfeature*" scriptblocktext = "*smb1protocol*" | stats count min(_time) as firsttime max(_time) as lasttime by eventcode scriptblocktext computer userid | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `powershell_enable_smb1protocol_feature_filter`'
<li><a href="#">search: '`powershell` eventcode=4104 scriptblocktext = "*get-adgroup*" | stats count min(_time) as firsttime max(_time) as lasttime by eventcode scriptblocktext computer user_id | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `getadgroup_with_powershell_script_block_filter`'
<li><a href="#">search: '`powershell` eventcode=4104 scriptblocktext = "*get-aduser*" scriptblocktext = "*-filter*" | stats count min(_time) as firsttime max(_time) as lasttime by eventcode scriptblocktext computer userid | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `get_aduser_with_powershell_script_block_filter`'
<li><a href="#">search: '`powershell` eventcode=4104 scriptblocktext = "*get-clipboard*" | stats count min(_time) as firsttime max(_time) as lasttime by eventcode scriptblocktext computer user_id | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `windows_clipboard_data_via_get_clipboard_filter`'
<li><a href="#">search: '`powershell` eventcode=4104 scriptblocktext = "*get-domaintrust*" | stats count min(_time) as firsttime max(_time) as lasttime by opcode computer userid eventcode scriptblocktext | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `get_domaintrust_with_powershell_script_block_filter`'
<li><a href="#">search: '`powershell` eventcode=4104 scriptblocktext = "*get-domainuser*" | stats count min(_time) as firsttime max(_time) as lasttime by eventcode scriptblocktext computer userid | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `get_domainuser_with_powershell_script_block_filter`'
<li><a href="#">search: '`powershell` eventcode=4104 scriptblocktext = "*get-foresttrust*" | stats count min(_time) as firsttime max(_time) as lasttime by eventcode scriptblocktext computer user_id | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `get_foresttrust_with_powershell_script_block_filter`'
<li><a href="#">search: '`powershell` eventcode=4104 scriptblocktext = "*get-localgroup*" | stats count min(_time) as firsttime max(_time) as lasttime by opcode computer userid eventcode scriptblocktext | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `powershell_get_localgroup_discovery_with_script_block_logging_filter`'
<li><a href="#">search: '`powershell` eventcode=4104 scriptblocktext = "*get-wmiobject*" and scriptblocktext = "*win32_group*" | stats count min(_time) as firsttime max(_time) as lasttime by eventcode scriptblocktext computer user_id | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `get_wmiobject_group_discovery_with_script_block_logging_filter`'
<li><a href="#">search: '`powershell` eventcode=4104 scriptblocktext = "*get-wmiobject*" scriptblocktext = "*ds_user*" scriptblocktext = "*-namespace*" scriptblocktext = "*root\\directory\\ldap*" | stats count min(_time) as firsttime max(_time) as lasttime by opcode computer userid eventcode scriptblocktext | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `getwmiobject_ds_user_with_powershell_script_block_filter`'
<li><a href="#">search: '`powershell` eventcode=4104 scriptblocktext = "*io.compression.*" or scriptblocktext = "*io.streamreader*" or scriptblocktext = "*]::decompress*" | stats count min(_time) as firsttime max(_time) as lasttime by eventcode scriptblocktext computer userid | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `powershell_processing_stream_of_data_filter`'
<li><a href="#">search: '`powershell` eventcode=4104 scriptblocktext = "*rmdir *" and scriptblocktext = "*\\microsoft\\windows defender*" | stats count min(_time) as firsttime max(_time) as lasttime by opcode computer userid eventcode scriptblocktext | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `powershell_remove_windows_defender_directory_filter` '
<li><a href="#">search: '`powershell` eventcode=4104 scriptblocktext = "*software\\classes\\clsid\\*\\inprocserver32*" | stats count min(_time) as firsttime max(_time) as lasttime by eventcode scriptblocktext computer userid | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `powershell_com_hijacking_inprocserver32_modification_filter`'
<li><a href="#">search: '`powershell` eventcode=4104 scriptblocktext = "*threading.mutex*" | stats count min(_time) as firsttime max(_time) as lasttime by eventcode scriptblocktext computer userid | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `powershell_creating_thread_mutex_filter`'
<li><a href="#">search: '`powershell` eventcode=4104 scriptblocktext = *new-object* scriptblocktext = *io.memorystream* | stats count min(_time) as firsttime max(_time) as lasttime by eventcode scriptblocktext computer user_id | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `powershell_using_memory_as_backing_store_filter`'
<li><a href="#">search: '`powershell` eventcode=4104 scriptblocktext = *system.management.automation.amsi* | stats count min(_time) as firsttime max(_time) as lasttime by eventcode scriptblocktext computer user_id | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `unloading_amsi_via_reflection_filter`'
<li><a href="#">search: '`powershell` eventcode=4104 scriptblocktext ="*get-addefaultdomainpasswordpolicy*" | stats count min(_time) as firsttime max(_time) as lasttime by eventcode scriptblocktext computer user_id | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `get_addefaultdomainpasswordpolicy_with_powershell_script_block_filter`'
<li><a href="#">search: '`powershell` eventcode=4104 scriptblocktext ="*get-domainpolicy*" | stats count min(_time) as firsttime max(_time) as lasttime by opcode computer userid eventcode scriptblocktext | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `get_domainpolicy_with_powershell_script_block_filter`'
<li><a href="#">search: '`powershell` eventcode=4104 scriptblocktext in ("*[system.reflection.assembly]::load(*","*[reflection.assembly]*", "*reflection.assembly*") | stats count min(_time) as firsttime max(_time) as lasttime by opcode computer userid eventcode scriptblocktext | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `powershell_loading_dotnet_into_memory_via_reflection_filter`'
<li><a href="#">search: '`powershell` eventcode=4104 scriptblocktext in ("*invoke-globalo365mailsearch*", "*invoke-globalmailsearch*", "*invoke-selfsearch*", "*invoke-passwordsprayowa*", "*invoke-passwordsprayews*","*invoke-domainharvestowa*", "*invoke-usernameharvestowa*","*invoke-openinboxfinder*","*invoke-injectgeventapi*","*invoke-injectgevent*","*invoke-searchgmail*", "*invoke-monitorcredsniper*", "*invoke-addgmailrule*","*invoke-passwordsprayeas*","*invoke-usernameharvesteas*") | stats count min(_time) as firsttime max(_time) as lasttime by opcode computer userid eventcode scriptblocktext | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `mailsniper_invoke_functions_filter`'
<li><a href="#">search: '`powershell` eventcode=4104 scriptblocktext in ("*msf.powershell*","*msf.powershell.meterpreter*","*msf.powershell.meterpreter.kiwi*","*msf.powershell.meterpreter.transport*") | stats count min(_time) as firsttime max(_time) as lasttime by eventcode scriptblocktext computer user_id | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `powershell_load_module_in_meterpreter_filter`'
<li><a href="#">search: '`powershell` eventcode=4104 scriptblocktext in ("*new-mailboxexportrequest*", "*new-managementroleassignment*", "*new-mailboxsearch*", "*get-recipient*", "search-mailbox") | stats count min(_time) as firsttime max(_time) as lasttime by opcode computer userid eventcode scriptblocktext| `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `exchange_powershell_module_usage_filter`'
<li><a href="#">search: '`powershell` eventcode=4104 scriptblocktext in (*get-netdomaintrust*, *get-netforesttrust*, *get-addomain*, *get-adgroupmember*, *get-domainuser*) | stats count min(_time) as firsttime max(_time) as lasttime by computer eventcode scriptblocktext | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `powershell_domain_enumeration_filter`'
<li><a href="#">search: '`powershell` eventcode=4104 scriptblocktext in (*mimikatz*, *-dumpcr*, *sekurlsa::pth*, *kerberos::ptt*, *kerberos::golden*) | stats count min(_time) as firsttime max(_time) as lasttime by opcode computer userid eventcode scriptblocktext | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `detect_mimikatz_with_powershell_script_block_logging_filter`'
<li><a href="#">search: '`powershell` eventcode=4104 scriptblocktext in("*get-webconfigurationproperty*","*set-itemproperty*") and scriptblocktext in ("*httplogging*","*logfile.enabled*") and scriptblocktext in ("*dontlog*", "*false*") | stats count min(_time) as firsttime max(_time) as lasttime by eventcode scriptblocktext computer user_id | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `windows_powershell_disable_http_logging_filter`'
<li><a href="#">search: '`powershell` eventcode=4104 scriptblocktext in("*new-webglobalmodule*","*enable-webglobalmodule*","*set-webglobalmodule*") | stats count min(_time) as firsttime max(_time) as lasttime by eventcode scriptblocktext computer user_id | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `windows_powershell_iis_components_webglobalmodule_usage_filter`'
<li><a href="#">search: '`powershell` eventcode=4104 scriptblocktext= "* win32_pnpentity *" scriptblocktext= "*select*" scriptblocktext= "*where*" scriptblocktext = "*pnpclass*" scriptblocktext in ("*image*", "*camera*") | stats count min(_time) as firsttime max(_time) as lasttime by eventcode scriptblocktext computer userid | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `windows_gather_victim_host_information_camera_filter`'
<li><a href="#">search: '`powershell` eventcode=4104 scriptblocktext= "*select*" and (scriptblocktext="*win32_process*" or scriptblocktext="*win32_service*") | stats count min(_time) as firsttime max(_time) as lasttime by eventcode scriptblocktext computer userid | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `wmi_recon_running_process_or_services_filter`'
<li><a href="#">search: '`powershell` eventcode=4104 scriptblocktext= "*shadowcopy*" (scriptblocktext = "*delete*" or scriptblocktext = "*remove*") | stats count min(_time) as firsttime max(_time) as lasttime by opcode computer userid eventcode scriptblocktext | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `delete_shadowcopy_with_powershell_filter`'
<li><a href="#">search: '`powershell` eventcode=4104 scriptblocktext="*get-aduserresultantpasswordpolicy*" | stats count min(_time) as firsttime max(_time) as lasttime by opcode computer userid eventcode scriptblocktext | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `get_aduserresultantpasswordpolicy_with_powershell_script_block_filter`'
<li><a href="#">search: '`powershell` eventcode=4104 scriptblocktext="*import-module applocker*" scriptblocktext="*set-applockerpolicy *" scriptblocktext="* -xmlpolicy *" | stats count min(_time) as firsttime max(_time) as lasttime by eventcode scriptblocktext computer user_id | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `windows_powershell_import_applocker_policy_filter`'
<li><a href="#">search: '`powershell` eventcode=4104 scriptblocktext="*invoke-wmimethod*" and (scriptblocktext="*-cn*" or scriptblocktext="*-computername*") and scriptblocktext="*-class win32_process*" and scriptblocktext="*-name create*" | stats count min(_time) as firsttime max(_time) as lasttime by eventcode scriptblocktext computer userid| `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `remote_process_instantiation_via_wmi_and_powershell_script_block_filter`'
<li><a href="#">search: '`powershell` eventcode=4104 scriptblocktext="*kerberosrequestorsecuritytoken*" | stats count min(_time) as firsttime max(_time) as lasttime by scriptblocktext opcode computer userid eventcode | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `serviceprincipalnames_discovery_with_powershell_filter`'
<li><a href="#">search: '`powershell` eventcode=4104 scriptblocktext=*frombase64string* | stats count min(_time) as firsttime max(_time) as lasttime by eventcode scriptblocktext computer userid | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `powershell_fileless_script_contains_base64_encoded_content_filter`'
<li><a href="#">search: '`powershell` eventcode=4104 scriptblocktext=*get-domainspnticket* | stats count min(_time) as firsttime max(_time) as lasttime by eventcode scriptblocktext computer | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `windows_powerview_kerberos_service_ticket_request_filter`'
<li><a href="#">search: '`powershell` eventcode=4104 scriptblocktext=*getprocaddress* | stats count min(_time) as firsttime max(_time) as lasttime by opcode computer userid eventcode scriptblocktext | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `powershell_fileless_process_injection_via_getprocaddress_filter`'
<li><a href="#">search: '`printservice` ((errorcode="0x45a" (eventcode="808" or eventcode="4909")) or ("the print spooler failed to load a plug-in module" or "\\drivers\\x64\\")) | stats count min(_time) as firsttime max(_time) as lasttime by opcode eventcode computername message | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `print_spooler_failed_to_load_a_plug_in_filter`'
<li><a href="#">search: '`printservice` eventcode=316 category = "adding a printer driver" message = "*kernelbase.dll,*" message = "*unidrv.dll,*" message = "*.dll.*" | stats count min(_time) as firsttime max(_time) as lasttime by opcode eventcode computername message | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `print_spooler_adding_a_printer_driver_filter`'
<li><a href="#">search: '`risk_index` | fillnull | stats sum(risk_score) as risk_score values(source) as signals values(repository) as repository by user | sort - risk_score | where risk_score > 80 | `correlation_by_user_and_risk_filter`'
<li><a href="#">search: '`risk_index` | fillnull | stats sum(risk_score) as risk_score values(source) as signals values(user) as user by repository | sort - risk_score | where risk_score > 80 | `correlation_by_repository_and_risk_filter`'
<li><a href="#">search: '`splunkd_ui` uri_path=*/data/ui/views/* or uri_path=*saved/searches/* | dedup uri_path | eval url=urldecode("uri_path")| rex field=url "\/saved\/searches\/(?<name>[^\/]*)" | rex field=url "\/data\/ui\/views\/(?<name1>[^\/]*)" | eval name=name."( saved search )",name1=name1."( dashboard )" | eval name=coalesce(name,name1) | eval status=case(match(status,"2\d+"),"success",match(status,"3\d+"),"redirection",match(status,"4\d+") or match(status,"5\d+"),"error") | stats list(name) as dashboard_title,list(method) as http_method,list(status) as status_code,list(status) as status by user | rename user as user | `splunk_code_injection_via_custom_dashboard_leading_to_rce_filter`'
<li><a href="#">search: '`stream_dns` | spath "query_type{}" | search "query_type{}" in (sig,key) | spath protocol_stack | search protocol_stack="ip:tcp:dns" | append [search `stream_tcp` bytes_out>65000] | `detect_windows_dns_sigred_via_splunk_stream_filter` | stats count by flow_id | where count>1 | fields - count'
<li><a href="#">search: '`stream_http` http_content_type=text* | rex field=cookie "form_key=(?<session_id>\w+)" | streamstats window=2 current=1 range(_time) as timedelta by session_id | where timedelta>0 |stats count stdev(timedelta) as clickspeedstddev avg(timedelta) as clickspeedavg by session_id | where count>5 and (clickspeedstddev<.5 or clickspeedavg<.5) | `web_fraud___anomalous_user_clickspeed_filter`'
<li><a href="#">search: '`stream_http` http_content_type=text* uri="/magento2/customer/account/loginpost/" | rex field=cookie "form_key=(?<sessionid>\w+)" | rex field=form_data "login\[username\]=(?<username>[^&|^$]+)" | search username=* | rex field=username "@(?<email_domain>.*)" | stats dc(username) as uniqueusernames list(username) as src_user by email_domain | where uniqueusernames> 25 | `web_fraud___account_harvesting_filter`'
<li><a href="#">search: '`stream_http` http_method in ("post") | stats values(form_data) as http_request_body min(_time) as firsttime max(_time) as lasttime count by http_method http_user_agent uri_path url bytes_in bytes_out | search http_request_body in ("*class.module.classloader.resources.context.parent.pipeline.first.filedateformat=_*", "*class.module.classloader.resources.context.parent.pipeline.first.pattern*","*suffix=.jsp*") | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `web_spring4shell_http_request_class_module_filter`'
<li><a href="#">search: '`stream_http` http_method=post |eval archive_hdr1=substr(form_data,1,2) | eval archive_hdr2 = substr(form_data,1,4) |stats values(form_data) as http_request_body min(_time) as firsttime max(_time) as lasttime count by http_method http_user_agent uri_path url bytes_in bytes_out archive_hdr1 archive_hdr2 |where count >20 and (archive_hdr1 = "7z" or archive_hdr1 = "pk" or archive_hdr2="rar!") | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `multiple_archive_files_http_post_traffic_filter`'
<li><a href="#">search: '`stream_http` http_method=post form_data in ("*wermgr.exe*","*svchost.exe*", "*name=\"proclist\"*","*ipconfig*", "*name=\"sysinfo\"*", "*net view*") |stats values(form_data) as http_request_body min(_time) as firsttime max(_time) as lasttime count by http_method http_user_agent uri_path url bytes_in bytes_out | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `plain_http_post_exfiltrated_data_filter`'
<li><a href="#">search: '`sysmon` eventcode = 1 process_name = "nslookup.exe" | bucket _time span=1m | stats count as numnslookup by computer, _time | eventstats avg(numnslookup) as avgnslookup, stdev(numnslookup) as stdnslookup, count as numslots by computer | eval upperthreshold=(avgnslookup + stdnslookup *3) | eval isoutlier=if(numnslookup > 20 and numnslookup >= upperthreshold, 1, 0) | search isoutlier=1 | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `excessive_usage_of_nslookup_app_filter`'
<li><a href="#">search: '`sysmon` eventcode = 1 process_name = "sc.exe" | bucket _time span=15m | stats values(process) as process count as numscexe by computer, _time | eventstats avg(numscexe) as avgscexe, stdev(numscexe) as stdscexe, count as numslots by computer | eval upperthreshold=(avgscexe + stdscexe *3) | eval isoutlier=if(avgscexe > 5 and avgscexe >= upperthreshold, 1, 0) | search isoutlier=1 | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `excessive_usage_of_sc_service_utility_filter`'
<li><a href="#">search: '`sysmon` eventcode = 8 parent_process_name in ("powershell_ise.exe", "powershell.exe") targetimage in ("*\\svchost.exe","*\\csrss.exe" "*\\gpupdate.exe", "*\\explorer.exe","*\\services.exe","*\\winlogon.exe","*\\smss.exe","*\\wininit.exe","*\\userinit.exe","*\\spoolsv.exe","*\\taskhost.exe") | stats min(_time) as firsttime max(_time) as lasttime count by sourceimage process_name sourceprocessid sourceprocessguid targetimage targetprocessid newthreadid startaddress computer eventcode | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `powershell_remote_thread_to_known_windows_process_filter`'
<li><a href="#">search: '`sysmon` eventcode =13 (targetobject= "*\\control panel\\desktop\\wallpaper" and image != "*\\explorer.exe") or (targetobject= "*\\control panel\\desktop\\wallpaper" and details = "*\\temp\\*") | stats count min(_time) as firsttime max(_time) as lasttime by eventcode image targetobject details computer process_guid process_id user_id | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `modification_of_wallpaper_filter`'
<li><a href="#">search: '`sysmon` eventcode =22 process_name = wermgr.exe queryname in ("*wtfismyip.com", "*checkip.amazonaws.com", "*ipecho.net", "*ipinfo.io", "*api.ipify.org", "*icanhazip.com", "*ip.anysrc.com","*api.ip.sb", "ident.me", "www.myexternalip.com", "*zen.spamhaus.org", "*cbl.abuseat.org", "*b.barracudacentral.org","*dnsbl-1.uceprotect.net", "*spam.dnsbl.sorbs.net") | stats min(_time) as firsttime max(_time) as lasttime count by image process_name processid queryname querystatus queryresults computer eventcode | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `wermgr_process_connecting_to_ip_check_web_services_filter`'
<li><a href="#">search: '`sysmon` eventcode =7 image in ("*\\wscript.exe", "*\\cscript.exe") imageloaded in ("*\\fastprox.dll", "*\\wbemdisp.dll", "*\\wbemprox.dll", "*\\wbemsvc.dll" , "*\\wmiutils.dll", "*\\wbemcomn.dll") | stats min(_time) as firsttime max(_time) as lasttime count by image eventcode process_name processid processguid computer imageloaded | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `ms_scripting_process_loading_wmi_module_filter`'
<li><a href="#">search: '`sysmon` eventcode =7 image in ("*\\wscript.exe", "*\\cscript.exe") imageloaded in ("*\\wldap32.dll", "*\\adsldp.dll", "*\\adsldpc.dll") | stats min(_time) as firsttime max(_time) as lasttime count by image eventcode process_name processid processguid computer imageloaded | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `ms_scripting_process_loading_ldap_module_filter`'
<li><a href="#">search: '`sysmon` eventcode in (17, 18) eventtype in ( "createpipe", "connectpipe") image in ("*\\calc.exe", "*\\notepad.exe", "*\\rdpclip.exe", "*\\explorer.exe", "*\\wermgr.exe", "*\\ping.exe", "*\\onedrivesetup.exe", "*\\dxdiag.exe", "*\\mobsync.exe", "*\\msra.exe", "*\\xwizard.exe") | regex pipename="^\\\{[0-9a-fa-f]{8}-[0-9a-fa-f]{4}-[0-9a-fa-f]{4}-[0-9a-fa-f]{4}-[0-9a-fa-f]{8}" | stats min(_time) as firsttime max(_time) as lasttime count by image eventtype processguid processid pipename securityid eventcode computer userid | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `windows_app_layer_protocol_qakbot_namedpipe_filter`'
<li><a href="#">search: '`sysmon` eventcode in (17, 18) eventtype in ( "createpipe", "connectpipe") pipename in ("\\rmanfusservernotify32", "\\rmanfuscallbacknotify32", "\\rmsprint*") | stats min(_time) as firsttime max(_time) as lasttime count by image eventtype processid pipename computer userid | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `windows_application_layer_protocol_rms_radmin_tool_namedpipe_filter`'
<li><a href="#">search: '`sysmon` eventcode in (17, 18) image= "*\\wermgr.exe" eventtype in ( "createpipe", "connectpipe") | stats min(_time) as firsttime max(_time) as lasttime count by image eventtype processguid processid pipename securityid eventcode computer userid | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `windows_app_layer_protocol_wermgr_connect_to_namedpipe_filter`'
<li><a href="#">search: '`sysmon` eventcode in (17,18) pipename="\\pipe\\*lacesomepipe" | stats min(_time) as firsttime max(_time) as lasttime count by computer user_id eventcode pipename signature image process_id | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `trickbot_named_pipe_filter`'
<li><a href="#">search: '`sysmon` eventcode= 11 (targetfilename = "*\\passff.tar" or targetfilename = "*\\cookie.tar") |stats count min(_time) as firsttime max(_time) as lasttime by targetfilename eventcode process_id process_name computer | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `icedid_exfiltrated_archived_file_creation_filter`'
<li><a href="#">search: '`sysmon` eventcode= 11 targetfilename = "*\\license.dat" and (targetfilename="*\\appdata\\*" or targetfilename="*\\programdata\\*") |stats count min(_time) as firsttime max(_time) as lasttime by targetfilename eventcode process_id process_name computer | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `drop_icedid_license_dat_filter`'
<li><a href="#">search: '`sysmon` eventcode= 15 process_name = "telegram.exe" targetfilename = "*:zone.identifier" |stats count min(_time) as firsttime max(_time) as lasttime by computer eventcode image process_id targetfilename hash | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `download_files_using_telegram_filter`'
<li><a href="#">search: '`sysmon` eventcode=1 commandline = "* /c *" commandline = "* del*" image = "*\\cmd.exe" | eval result = if(like(process,"%".parent_process."%"), "found", "not found") | stats min(_time) as firsttime max(_time) as lasttime count by computer user parentimage parentcommandline image commandline eventcode processid result | where result = "found" | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `process_deleting_its_process_file_path_filter`'
<li><a href="#">search: '`sysmon` eventcode=10 sourceimage = "*\\spoolsv.exe" calltrace = "*\\windows\\system32\\spool\\drivers\\x64\\*" targetimage in ("*\\rundll32.exe", "*\\spoolsv.exe") grantedaccess = 0x1fffff | stats count min(_time) as firsttime max(_time) as lasttime by computer sourceimage targetimage grantedaccess calltrace eventcode processid| `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `spoolsv_suspicious_process_access_filter`'
<li><a href="#">search: '`sysmon` eventcode=10 sourceimage = "*\\wmiprvse.exe" grantedaccess in ("0x1478", "0x1fffff") | stats count min(_time) as firsttime max(_time) as lasttime by sourceimage targetimage sourceprocessguid targetprocessguid sourceprocessid targetprocessid grantedaccess calltrace computer | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `windows_wmi_impersonate_token_filter`'
<li><a href="#">search: '`sysmon` eventcode=10 targetimage in("*\\system32\\winlogon.exe*", "*\\syswow64\\winlogon.exe*") and grantedaccess = 0x1040 and not (sourceimage in("c:\\windows\\*", "c:\\program file*", "%systemroot%\\*")) | stats count min(_time) as firsttime max(_time) as lasttime by sourceimage targetimage sourceprocessguid targetprocessguid sourceprocessid targetprocessid grantedaccess calltrace | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `windows_access_token_winlogon_duplicate_handle_in_uncommon_path_filter`'
<li><a href="#">search: '`sysmon` eventcode=10 targetimage in("*\\system32\\winlogon.exe*", "*\\syswow64\\winlogon.exe*") grantedaccess = 0x1040 | stats count min(_time) as firsttime max(_time) as lasttime by sourceimage targetimage sourceprocessguid targetprocessguid sourceprocessid targetprocessid grantedaccess calltrace computer user_id | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `windows_access_token_manipulation_winlogon_duplicate_token_handle_filter`'
<li><a href="#">search: '`sysmon` eventcode=10 targetimage=*\\lsass.exe grantedaccess in ("0x01000", "0x1010", "0x1038", "0x40", "0x1400", "0x1fffff", "0x1410", "0x143a", "0x1438", "0x1000") calltrace in ("*dbgcore.dll*", "*dbghelp.dll*", "*ntdll.dll*", "*kernelbase.dll*", "*kernel32.dll*") not sourceuser in ("nt authority\\system", "nt authority\\network service")| stats count min(_time) as firsttime max(_time) as lasttime by, computer, sourceimage, grantedaccess, targetimage, sourceprocessid, sourceuser, targetuser | rename computer as dest | `security_content_ctime(firsttime)`|`security_content_ctime(lasttime)` | `windows_possible_credential_dumping_filter`'
<li><a href="#">search: '`sysmon` eventcode=10 targetimage=*lsass.exe (grantedaccess=0x1010 or grantedaccess=0x1410) | stats count min(_time) as firsttime max(_time) as lasttime by computer, sourceimage, sourceprocessid, targetimage, targetprocessid, eventcode, grantedaccess | rename computer as dest | `security_content_ctime(firsttime)`| `security_content_ctime(lasttime)` | `detect_credential_dumping_through_lsass_access_filter` '
<li><a href="#">search: '`sysmon` eventcode=10 targetimage=*lsass.exe | stats count min(_time) as firsttime max(_time) as lasttime by computer, targetimage, grantedaccess, sourceimage, sourceprocessid, sourceuser, targetuser | rename computer as dest | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `windows_hunting_system_account_targeting_lsass_filter`'
<li><a href="#">search: '`sysmon` eventcode=10 targetimage=*lsass.exe calltrace=*dbgcore.dll* or calltrace=*dbghelp.dll* | stats count min(_time) as firsttime max(_time) as lasttime by computer, targetimage, targetprocessid, sourceimage, sourceprocessid | rename computer as dest | `security_content_ctime(firsttime)`| `security_content_ctime(lasttime)` | `access_lsass_memory_for_dump_creation_filter` '
<li><a href="#">search: '`sysmon` eventcode=10 targetimage=*lsass.exe grantedaccess = 0x1 | stats count min(_time) as firsttime max(_time) as lasttime by sourceimage, targetimage, targetprocessid, sourceprocessid, grantedaccess calltrace, computer | rename computer as dest | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `windows_terminating_lsass_process_filter`'
<li><a href="#">search: '`sysmon` eventcode=10 targetimage=*lsass.exe not (sourceuser="nt authority\\*") | stats count min(_time) as firsttime max(_time) as lasttime by computer, targetimage, grantedaccess, sourceimage, sourceprocessid, sourceuser, targetuser | rename computer as dest | `security_content_ctime(firsttime)`| `security_content_ctime(lasttime)` | `windows_non_system_account_targeting_lsass_filter`'
<li><a href="#">search: '`sysmon` eventcode=11 (targetfilename = "*\\sqlite32.dll" or targetfilename = "*\\sqlite64.dll") (targetfilename = "*\\temp\\*") |stats count min(_time) as firsttime max(_time) as lasttime by process_name targetfilename eventcode processid image | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `sqlite_module_in_temp_folder_filter`'
<li><a href="#">search: '`sysmon` eventcode=11 file_name in ("*\.txt","*\.html","*\.hta") |bin _time span=10s | stats min(_time) as firsttime max(_time) as lasttime dc(targetfilename) as unique_readme_path_count values(targetfilename) as list_of_readme_path by computer image file_name | where unique_readme_path_count >= 15 | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `ransomware_notes_bulk_creation_filter`'
<li><a href="#">search: '`sysmon` eventcode=11 process_name = "wermgr.exe" targetfilename = "*.exe" | stats min(_time) as firsttime max(_time) as lasttime count by image targetfilename process_name dest eventcode processid | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `wermgr_process_create_executable_file_filter`'
<li><a href="#">search: '`sysmon` eventcode=11 process_name="rundll32.exe" targetfilename in ("*.exe", "*.dll",) | stats count min(_time) as firsttime max(_time) as lasttime by image targetfilename processguid dest user_id | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `rundll32_process_creating_exe_dll_files_filter`'
<li><a href="#">search: '`sysmon` eventcode=11 targetfilename = "*\\windows\\schcache\\*" targetfilename = "*.sch*" not (image in ("*\\windows\\system32\\mmc.exe")) |stats count min(_time) as firsttime max(_time) as lasttime by image targetfilename eventcode process_id process_name computer | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `schcache_change_by_app_connect_and_create_adsi_object_filter`'
<li><a href="#">search: '`sysmon` eventcode=21 | rename host as dest | table _time, dest, user, operation, eventtype, query, consumer, filter | `wmi_permanent_event_subscription___sysmon_filter`'
<li><a href="#">search: '`sysmon` eventcode=22 process_name="rundll32.exe" | stats count min(_time) as firsttime max(_time) as lasttime by image queryname querystatus processid computer | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `rundll32_dnsquery_filter`'
<li><a href="#">search: '`sysmon` eventcode=22 queryname in ("*.torproject.org", "www.theonionrouter.com") | stats count min(_time) as firsttime max(_time) as lasttime by image queryname querystatus processid computer | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `windows_multi_hop_proxy_tor_website_query_filter`'
<li><a href="#">search: '`sysmon` eventcode=22 queryname in ("*discord*") image != "*\\appdata\\local\\discord\\*" and image != "*\\program files*" and image != "discord.exe" | stats count min(_time) as firsttime max(_time) as lasttime by image queryname querystatus process_name queryresults computer | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `suspicious_process_with_discord_dns_query_filter`'
<li><a href="#">search: '`sysmon` eventcode=22 queryname in ("*pastebin*", "*discord*", "*telegram*", "*t.me*") process_name in ("cmd.exe", "*powershell*", "pwsh.exe", "wscript.exe", "cscript.exe") | stats count min(_time) as firsttime max(_time) as lasttime by image queryname querystatus process_name queryresults computer | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `suspicious_process_dns_query_known_abuse_web_services_filter`'
<li><a href="#">search: '`sysmon` eventcode=22 queryname in ("*wtfismyip.com", "*checkip.amazonaws.com", "*ipecho.net", "*ipinfo.io", "*api.ipify.org", "*icanhazip.com", "*ip.anysrc.com","*api.ip.sb", "ident.me", "www.myexternalip.com", "*zen.spamhaus.org", "*cbl.abuseat.org", "*b.barracudacentral.org", "*dnsbl-1.uceprotect.net", "*spam.dnsbl.sorbs.net", "*iplogger.org*", "*ip-api.com*") | stats min(_time) as firsttime max(_time) as lasttime count by image processid queryname querystatus queryresults computer eventcode | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `windows_gather_victim_network_info_through_ip_check_web_services_filter`'
<li><a href="#">search: '`sysmon` eventcode=23 targetfilename = "*\\programdata\\microsoft\\windows defender*" | stats values(targetfilename) as deleted_files min(_time) as firsttime max(_time) as lasttime count by user eventcode image processid computer |where count >=50 | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `excessive_file_deletion_in_windefender_folder_filter`'
<li><a href="#">search: '`sysmon` eventcode=23 targetfilename in ("*.cmd", "*.ini","*.gif", "*.jpg", "*.jpeg", "*.db", "*.ps1", "*.doc*", "*.xls*", "*.ppt*", "*.bmp","*.zip", "*.rar", "*.7z", "*.chm", "*.png", "*.log", "*.vbs", "*.js", "*.vhd", "*.bak", "*.wbcat", "*.bkf" , "*.backup*", "*.dsk", "*.win") | stats values(targetfilename) as deleted_files min(_time) as firsttime max(_time) as lasttime count by computer user eventcode image processid |where count >=100 | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `windows_high_file_deletion_frequency_filter`'
<li><a href="#">search: '`sysmon` eventcode=3 not(image in("*\\program files*", "*\\thunderbird.exe","*\\outlook.exe")) (destinationportname="smtp" or destinationport=25 or destinationport=587) | stats count min(_time) as firsttime max(_time) as lasttime by image destinationport destinationportname destinationhostname sourcehostname sourceport sourceportname protocol destinationip computer user | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `windows_mail_protocol_in_non_common_process_path_filter`'
<li><a href="#">search: '`sysmon` eventcode=3 not(image in("*\\program files*", "*\\windows\\system32\\*","*\\windows\\syswow64\\*")) (destinationportname="ftp" or destinationport=21) | stats count min(_time) as firsttime max(_time) as lasttime by image destinationport destinationportname destinationhostname destinationip sourceport sourceportname protocol sourcehostname computer user | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `windows_file_transfer_protocol_in_non_common_process_path_filter`'
<li><a href="#">search: '`sysmon` eventcode=5 |bin _time span=3s |stats values(image) as proc_terminated min(_time) as firsttime max(_time) as lasttime count by _time computer eventcode processid | where count >= 15 | `security_content_ctime(firsttime)`| `security_content_ctime(lasttime)` | `high_process_termination_frequency_filter`'
<li><a href="#">search: '`sysmon` eventcode=5 process_name in ("pservicecontrol.exe", "pservice_ppd.exe") | stats min(_time) as firsttime max(_time) as lasttime count by process_name process process_path process_guid process_id eventcode dest user_id | `security_content_ctime(firsttime)`| `security_content_ctime(lasttime)` | `windows_processes_killed_by_industroyer2_malware_filter`'
<li><a href="#">search: '`sysmon` eventcode=6 | stats min(_time) as firsttime max(_time) as lasttime values(imageloaded) count by computer signed signature service_signature_verified service_signature_exists hashes | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `windows_drivers_loaded_by_signature_filter`'
<li><a href="#">search: '`sysmon` eventcode=6 imageloaded = "*.sys" not (imageloaded in("*\\windows\\inf","*\\windows\\system32\\drivers\\*", "*\\windows\\system32\\driverstore\\filerepository\\*")) | stats min(_time) as firsttime max(_time) as lasttime count by computer imageloaded hashes imphash signature signed | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `suspicious_driver_loaded_path_filter`'
<li><a href="#">search: '`sysmon` eventcode=6 signature="noriyuki miyazaki" or imageloaded= "*\\winring0x64.sys" | stats min(_time) as firsttime max(_time) as lasttime count by computer imageloaded hashes imphash signature signed | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `xmrig_driver_loaded_filter`'
<li><a href="#">search: '`sysmon` eventcode=7 (imageloaded = "*\\credui.dll" and originalfilename = "credui.dll") or (imageloaded = "*\\wincredui.dll" and originalfilename = "wincredui.dll") and not(image in("*\\windows\\explorer.exe", "*\\windows\\system32\\*", "*\\windows\\syswow64\\*", "*:\\program files*")) | stats count min(_time) as firsttime max(_time) as lasttime by image imageloaded originalfilename computer eventcode signed processid processguid | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `windows_input_capture_using_credential_ui_dll_filter`'
<li><a href="#">search: '`sysmon` eventcode=7 (imageloaded = "*\\dynwrapx.dll" or originalfilename = "dynwrapx.dll" or product = "dynamicwrapperx") | stats count min(_time) as firsttime max(_time) as lasttime by image imageloaded originalfilename product process_name computer eventcode signed processid | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `loading_of_dynwrapx_module_filter`'
<li><a href="#">search: '`sysmon` eventcode=7 (imageloaded = "*\\samlib.dll" and originalfilename = "samlib.dll") or (imageloaded = "*\\samcli.dll" and originalfilename = "samcli.dll") and not (image in("c:\\windows\\*", "c:\\program file*", "%systemroot%\\*")) | stats count min(_time) as firsttime max(_time) as lasttime by image imageloaded process_name computer eventcode signed processid | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `windows_gather_victim_identity_sam_info_filter`'
<li><a href="#">search: '`sysmon` eventcode=7 | stats values(imageloaded) as imageloaded values(processid) as processid by computer, image | search imageloaded=*winscard.dll imageloaded=*cryptdll.dll imageloaded=*hid.dll imageloaded=*samlib.dll imageloaded=*vaultcli.dll | rename computer as dest | `security_content_ctime(firsttime)`| `security_content_ctime(lasttime)` | `detect_mimikatz_using_loaded_images_filter`'
<li><a href="#">search: '`sysmon` eventcode=7 |bin _time span=30s | eval brc4_anomalyloadeddll=case(originalfilename=="credui.dll", 1, originalfilename=="dbghelp.dll", 1, originalfilename=="samcli.dll", 1, originalfilename=="winhttp.dll", 1, 1=1, 0) | eval brc4_loadeddllpath=case(match(imageloaded, "credui.dll"), 1, match(imageloaded, "dbghelp.dll"), 1, match(imageloaded, "samcli.dll"), 1, match(imageloaded, "winhttp.dll"), 1, 1=1, 0) | stats count min(_time) as firsttime max(_time) as lasttime values(imageloaded) as imageloaded values(originalfilename) as originalfilename dc(imageloaded) as imageloadedcount by image brc4_loadeddllpath brc4_anomalyloadeddll computer eventcode signed | where imageloadedcount == 4 and (brc4_loadeddllpath == 1 or brc4_anomalyloadeddll == 1) | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `windows_remote_access_software_brc4_loaded_dll_filter`'
<li><a href="#">search: '`sysmon` eventcode=7 image = "*\calc.exe" and not (image in ("*:\\windows\\system32\\*", "*:\\windows\\syswow64\\*")) and not(imageloaded in("*:\\windows\\system32\\*", "*:\\windows\\syswow64\\*", "*:\\windows\\winsxs\\*")) | stats count min(_time) as firsttime max(_time) as lasttime by image imageloaded originalfilename product process_name computer eventcode signed processid | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `windows_dll_side_loading_in_calc_filter`'
<li><a href="#">search: '`sysmon` eventcode=7 image ="*\\spoolsv.exe" imageloaded="*\\windows\\system32\\spool\\drivers\\x64\\*" imageloaded = "*.dll" | stats dc(imageloaded) as countimgloaded values(imageloaded) as imgloaded count min(_time) as firsttime max(_time) as lasttime by image computer processid eventcode | where countimgloaded >= 3 | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `spoolsv_suspicious_loaded_modules_filter`'
<li><a href="#">search: '`sysmon` eventcode=7 imageloaded = "*.dll" image = "*\\mmc.exe" signed=false company != "microsoft corporation" | stats count min(_time) as firsttime max(_time) as lasttime by image imageloaded signed processid originalfilename computer eventcode company | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `uac_bypass_mmc_load_unsigned_dll_filter`'
<li><a href="#">search: '`sysmon` eventcode=7 imageloaded = "*\\version.dll" and (signed = "false" or not(imageloaded in("*\\windows\\system32*", "*\\windows\\syswow64\\*"))) | stats count min(_time) as firsttime max(_time) as lasttime by image imageloaded process_name computer eventcode signed processid | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `windows_hijack_execution_flow_version_dll_side_load_filter`'
<li><a href="#">search: '`sysmon` eventcode=7 imageloaded in ("*\\cmlua.dll", "*\\cmstplua.dll", "*\\cmluautil.dll") not(process_name in("cmstp.exe", "cmmgr32.exe")) not(image in("*\\windows\\*", "*\\program files*")) | stats count min(_time) as firsttime max(_time) as lasttime by image imageloaded process_name computer eventcode signed processid | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `cmlua_or_cmstplua_uac_bypass_filter`'
<li><a href="#">search: '`sysmon` eventcode=7 imageloaded in ("*\\fastprox.dll", "*\\wbemprox.dll", "*\\wbemcomn.dll") not (process_name in ("wmiprvse.exe", "wmiapsrv.exe", "unsecapp.exe")) not(image in("*\\windows\\*","*\\program files*", "*\\wbem\\*")) | stats count min(_time) as firsttime max(_time) as lasttime by image imageloaded process_name computer eventcode signed processid hashes imphash | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `wbemprox_com_object_execution_filter`'
<li><a href="#">search: '`sysmon` eventcode=7 imageloaded="*\\colorui.dll" process_name != "colorcpl.exe" not(image in("*\\windows\\*", "*\\program files*")) | stats count min(_time) as firsttime max(_time) as lasttime by image imageloaded process_name computer eventcode signed processid | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `uac_bypass_with_colorui_com_object_filter`'
<li><a href="#">search: '`sysmon` eventcode=7 imageloaded="*\\msi.dll" not (image in ("*\\system32\\*","*\\syswow64\\*","*\\windows\\*", "*\\winsxs\\*")) | stats count min(_time) as firsttime max(_time) as lasttime by image imageloaded process_name computer eventcode processid | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `msi_module_loaded_by_non_system_binary_filter`'
<li><a href="#">search: '`sysmon` eventcode=7 not (process_path in ("*\\system32\\*", "*\\syswow64\\*","*\\winsxs\\*")) | lookup hijacklibs library as process_name output islibrary | search islibrary = true | rename computer as dest process_name as imageloaded process_path as module_path | stats values(parent_process_name) count by _time dest imageloaded module_path | `windows_dll_search_order_hijacking_hunt_with_sysmon_filter`'
<li><a href="#">search: '`sysmon` eventcode=7 parent_process_name in ("winword.exe", "excel.exe", "powerpnt.exe") imageloaded = "*\\taskschd.dll" | stats min(_time) as firsttime max(_time) as lasttime values(imageloaded) as allimageloaded count by computer eventcode image parent_process_name processid processguid | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `office_document_creating_schedule_task_filter`'
<li><a href="#">search: '`sysmon` eventcode=7 parent_process_name in ("winword.exe", "excel.exe", "powerpnt.exe") imageloaded in ("*\\vbe7intl.dll","*\\vbe7.dll", "*\\vbeui.dll") | stats min(_time) as firsttime max(_time) as lasttime values(imageloaded) as allimageloaded count by computer eventcode image process_name processid processguid | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `office_document_executing_macro_code_filter`'
<li><a href="#">search: '`sysmon` eventcode=7 parent_process_name=installutil.exe imageloaded in ("*\\samlib.dll", "*\\vaultcli.dll") | stats count min(_time) as firsttime max(_time) as lasttime by computer, parent_process_name, imageloaded, originalfilename, processid | rename computer as dest | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `windows_installutil_credential_theft_filter`'
<li><a href="#">search: '`sysmon` eventcode=8 sourceimage = "*\\rundll32.exe" targetimage = "*.exe" | stats count min(_time) as firsttime max(_time) as lasttime by sourceimage targetimage targetprocessid sourceprocessid startaddress eventcode computer | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `rundll32_create_remote_thread_to_a_process_filter`'
<li><a href="#">search: '`sysmon` eventcode=8 sourceimage = "*\\rundll32.exe" targetimage in ("*\\firefox.exe", "*\\chrome.exe", "*\\iexplore.exe","*\\microsoftedgecp.exe") | stats count min(_time) as firsttime max(_time) as lasttime by sourceimage targetimage targetprocessid sourceprocessid startaddress eventcode computer | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `rundll32_createremotethread_in_browser_filter`'
<li><a href="#">search: '`sysmon` eventcode=8 sourceimage = "*\\wermgr.exe" targetimage in ("*\\firefox.exe", "*\\chrome.exe", "*\\iexplore.exe","*\\microsoftedgecp.exe") | stats count min(_time) as firsttime max(_time) as lasttime by sourceimage targetimage sourceprocessguid sourceprocessid startaddress startfunction targetprocessguid targetprocessid eventcode computer | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `windows_process_injection_of_wermgr_to_known_browser_filter`'
<li><a href="#">search: '`sysmon` eventcode=8 targetimage = "*.exe" and not(sourceimage in("c:\\windows\\*", "c:\\program file*", "%systemroot%\\*")) | stats count min(_time) as firsttime max(_time) as lasttime by sourceimage targetimage signature targetprocessguid sourceprocessguid targetprocessid sourceprocessid startaddress eventcode computer | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `windows_process_injection_with_public_source_path_filter`'
<li><a href="#">search: '`sysmon` eventcode=8 targetimage in ("*\\cmd.exe", "*\\powershell*") | stats count min(_time) as firsttime max(_time) as lasttime by targetimage targetprocessid sourceprocessid eventcode startaddress sourceimage computer | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `create_remote_thread_in_shell_application_filter`'
<li><a href="#">search: '`sysmon` eventcode=8 targetimage in ("*\\taskmgr.exe", "*\\calc.exe", "*\\notepad.exe", "*\\rdpclip.exe", "*\\explorer.exe", "*\\wermgr.exe", "*\\ping.exe", "*\\onedrivesetup.exe", "*\\dxdiag.exe", "*\\mobsync.exe", "*\\msra.exe", "*\\xwizard.exe") | stats count min(_time) as firsttime max(_time) as lasttime by targetimage targetprocessid sourceprocessid eventcode startaddress sourceimage computer | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `windows_process_injection_remote_thread_filter`'
<li><a href="#">search: '`sysmon` eventcode=9 device = \\device\\harddisk0\\dr0 not (image in("*\\windows\\system32\\*", "*\\windows\\syswow64\\*")) | stats count min(_time) as firsttime max(_time) as lasttime by computer image device processguid processid event
<li><a href="#">search: '`sysmon` eventcode=9 device = \\device\\harddiskvolume* not (image in("*\\windows\\system32\\*", "*\\windows\\syswow64\\*")) | stats count min(_time) as firsttime max(_time) as lasttime by image device processguid processid event
<li><a href="#">search: '`sysmon` eventid=11 process_name=spoolsv.exe file_path="*\\spool\\drivers\\x64\\*" file_name=*.dll | stats count min(_time) as firsttime max(_time) as lasttime by dest, userid, process_name, file_path, file_name, targetfilename, process_id | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `spoolsv_writing_a_dll___sysmon_filter`'
<li><a href="#">search: '`sysmon` eventid=11 process_name=taskmgr.exe targetfilename=*lsass*.dmp | stats count min(_time) as firsttime max(_time) as lasttime by computer, object_category, process_name, targetfilename | rename computer as dest | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `creation_of_lsass_dump_with_taskmgr_filter`'
<li><a href="#">search: '`sysmon` eventid=17 or eventid=18 pipename in (\\msagent_*, \\dsernamepipe*, \\srvsvc_*, \\postex_*, \\status_*, \\msse-*, \\spoolss_*, \\win_svc*, \\ntsvcs*, \\winsock*, \\uia_pipe*) | stats count min(_time) as firsttime max(_time) as lasttime by computer, process_name, process_id process_path, pipename | rename computer as dest | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `cobalt_strike_named_pipes_filter`'
<li><a href="#">search: '`sysmon` eventid=20 | stats count min(_time) as firsttime max(_time) as lasttime by computer user destination | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `detect_wmi_event_subscription_persistence_filter`'
<li><a href="#">search: '`sysmon` eventid=3 dest_ip!=10.0.0.0/12 dest_ip!=172.16.0.0/12 dest_ip!=192.168.0.0/16 process_name=regasm.exe | rename computer as dest | stats count min(_time) as firsttime max(_time) as lasttime by dest, user, process_name, src_ip, dest_ip | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `detect_regasm_with_network_connection_filter`'
<li><a href="#">search: '`sysmon` eventid=3 dest_ip!=10.0.0.0/12 dest_ip!=172.16.0.0/12 dest_ip!=192.168.0.0/16 process_name=regsvcs.exe | rename computer as dest | stats count min(_time) as firsttime max(_time) as lasttime by dest, user, process_name, src_ip, dest_ip | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `detect_regsvcs_with_network_connection_filter`'
<li><a href="#">search: '`sysmon` eventid=7 image=*lsass.exe signed=false | stats count min(_time) as firsttime max(_time) as lasttime by computer, image, imageloaded, signed, sha1 | rename computer as dest | `security_content_ctime(firsttime)`| `security_content_ctime(lasttime)` | `unsigned_image_loaded_by_lsass_filter` '
<li><a href="#">search: '`sysmon` eventid=7 parent_process_name in ("winword.exe","excel.exe","powerpnt.exe","mspub.exe","visio.exe","wordpad.exe","wordview.exe") imageloaded in ("*\\mshtml.dll", "*\\microsoft.mshtml.dll","*\\ie.interop.mshtml.dll","*\\mshtmldac.dll","*\\mshtmlded.dll","*\\mshtmlder.dll") | stats count min(_time) as firsttime max(_time) as lasttime by computer, process_name, imageloaded, originalfilename, processguid | rename computer as dest | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `mshtml_module_load_in_office_product_filter`'
<li><a href="#">search: '`sysmon` eventid=8 targetimage=*lsass.exe | stats count min(_time) as firsttime max(_time) as lasttime by computer, eventcode, targetimage, targetprocessid | rename computer as dest | `security_content_ctime(firsttime)`| `security_content_ctime(lasttime)` | `create_remote_thread_into_lsass_filter`'
<li><a href="#">search: '`sysmon` originalfilename=procdump process_name!=procdump*.exe eventid=1 (commandline=*-ma* or commandline=*-mm*) commandline=*lsass* | rename computer as dest | stats count min(_time) as firsttime max(_time) as lasttime by dest, parent_process_name, process_name, originalfilename, commandline | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `dump_lsass_via_procdump_rename_filter`'
<li><a href="#">search: '`wineventlog_application` eventcode=2282 | stats count min(_time) as firsttime max(_time) as lasttime by eventcode dest name moduledll | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `windows_iis_components_module_failed_to_load_filter`'
<li><a href="#">search: '`wineventlog_application` eventcode=3000 | rename param1 as "process" param2 as "exit_code" | stats count min(_time) as firsttime max(_time) as lasttime by process exit_code dest | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `windows_event_triggered_image_file_execution_options_injection_filter`'
<li><a href="#">search: '`wineventlog_security` (eventcode=4663) process_name!=*\\dllhost.exe object_name in ("*\\windows\\system32\\config\\sam*","*\\windows\\system32\\config\\system*","*\\windows\\system32\\config\\security*") | stats values(accesses) count by process_name object_name dest user | `sam_database_file_access_attempt_filter`'
<li><a href="#">search: '`wineventlog_security` account_name="anonymous logon" eventcode=5145 relative_target_name=lsarpc | stats count min(_time) as firsttime max(_time) as lasttime by dest, security_id, share_name, source_address, accesses, message | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `petitpotam_network_share_access_request_filter`'
<li><a href="#">search: '`wineventlog_security` eventcode=4624 (logon_type=3 logon_process=ntlmssp workstationname=workstation not accountname="anonymous logon") or (logon_type=9 logon_process=seclogo) | fillnull | stats count min(_time) as firsttime max(_time) as lasttime by eventcode, logon_type, workstationname, user, dest | `security_content_ctime(firsttime)`| `security_content_ctime(lasttime)` | `detect_activity_related_to_pass_the_hash_attacks_filter` '
<li><a href="#">search: '`wineventlog_security` eventcode=4624 logon_type=3 authentication_package=kerberos action=success src_ip=127.0.0.1 | stats count min(_time) as firsttime max(_time) as lasttime by dest, subject, action, security_id, user, account_name, src_ip | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `windows_kerberos_local_successful_logon_filter`'
<li><a href="#">search: '`wineventlog_security` eventcode=4624 or eventcode=4742 targetusername="anonymous logon" logontype=3 | stats count values(host) as host, values(targetdomainname) as domain, values(user) as user | `detect_computer_changed_with_anonymous_account_filter`'
<li><a href="#">search: '`wineventlog_security` eventcode=4663 not (process_name in ("*\\chrome.exe", "*\\explorer.exe", "*sql*")) object_name="*\\google\\chrome\\user data\\default*" | stats count min(_time) as firsttime max(_time) as lasttime by object_name object_type process_name access_mask accesses process_id eventcode dest user | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `non_chrome_process_accessing_chrome_default_dir_filter`'
<li><a href="#">search: '`wineventlog_security` eventcode=4663 not (process_name in ("*\\firefox.exe", "*\\explorer.exe", "*sql*")) object_name="*\\appdata\\roaming\\mozilla\\firefox\\profiles*" | stats count min(_time) as firsttime max(_time) as lasttime by object_name object_type process_name access_mask accesses process_id eventcode dest user | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `non_firefox_process_access_firefox_profile_dir_filter`'
<li><a href="#">search: '`wineventlog_security` eventcode=4698 | xmlkv message | search command in ("*\\users\\public\\*", "*\\programdata\\*", "*\\temp\\*", "*\\windows\\tasks\\*", "*\\appdata\\*", "*\\perflogs\\*") | stats count min(_time) as firsttime max(_time) as lasttime by dest, task_name, command, author, enabled, hidden | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `winevent_scheduled_task_created_within_public_path_filter`'
<li><a href="#">search: '`wineventlog_security` eventcode=4698 | xmlkv message | search command in ("*powershell.exe*", "*wscript.exe*", "*cscript.exe*", "*cmd.exe*", "*sh.exe*", "*ksh.exe*", "*zsh.exe*", "*bash.exe*", "*scrcons.exe*", "*pwsh.exe*") | stats count min(_time) as firsttime max(_time) as lasttime by dest, task_name, command, author, enabled, hidden | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `winevent_scheduled_task_created_to_spawn_shell_filter`'
<li><a href="#">search: '`wineventlog_security` eventcode=4698 | xmlkv message | search command in ("*rundll32*") | stats count min(_time) as firsttime max(_time) as lasttime by dest, task_name, command, author, enabled, hidden, arguments | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `schedule_task_with_rundll32_command_trigger_filter`'
<li><a href="#">search: '`wineventlog_security` eventcode=4698 | xmlkv message | search hidden = true | stats count min(_time) as firsttime max(_time) as lasttime by task_name, command, author, hidden, dest | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `windows_hidden_schedule_task_settings_filter`'
<li><a href="#">search: '`wineventlog_security` eventcode=4698 | xmlkv message| search arguments in ("*http*") | stats count min(_time) as firsttime max(_time) as lasttime by dest, task_name, command, author, enabled, hidden, arguments | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `schedule_task_with_http_command_arguments_filter`'
<li><a href="#">search: '`wineventlog_security` eventcode=4703 enabledprivilegelist = "*sedebugprivilege*" and not(processname in ("*\\program file*", "*\\system32\\lsass.exe*", "*\\syswow64\\lsass.exe*", "*\\syswow64\\svchost.exe*", "*\\system32\\svchost.exe*")) | stats count min(_time) as firsttime max(_time) as lasttime by computer processname processid subjectdomainname subjectusername subjectusersid targetusername targetlogonid targetdomainname enabledprivilegelist action | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `windows_access_token_manipulation_sedebugprivilege_filter`'
<li><a href="#">search: '`wineventlog_security` eventcode=4720 or (eventcode=4732 group_name=administrators) | transaction member_id connected=false maxspan=180m | rename member_id as user | stats count min(_time) as firsttime max(_time) as lasttime by user dest | `security_content_ctime(firsttime)`| `security_content_ctime(lasttime)` | `detect_new_local_admin_account_filter`'
<li><a href="#">search: '`wineventlog_security` eventcode=4741 msadchangedattributes in ("*host/*","*restrictedkrbhost/*") and new_uac_value=0x80 | eval effecting_account=mvindex(security_id,1) | eval new_computer_account_name=mvindex(security_id,0) | stats count min(_time) as firsttime max(_time) as lasttime values(eventcode),values(account_domain),values(security_id), values(effecting_account), values(new_computer_account_name),values(sam_account_name),values(dns_host_name),values(msadchangedattributes) by dest logon_id subject | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `windows_computer_account_with_spn_filter`'
<li><a href="#">search: '`wineventlog_security` eventcode=4741 user_type=computer subject_account_domain!="nt authority" message=*restrictedkrbhost* | stats count min(_time) as firsttime max(_time) as lasttime by dest, subject, action ,src_user, user, account_name, subject_account_name,subject_account_domain | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `windows_computer_account_created_by_computer_account_filter`'
<li><a href="#">search: '`wineventlog_security` eventcode=4768 account_name!="*$" result_code=0x12 | bucket span=2m _time | stats dc(account_name) as unique_accounts values(account_name) as tried_accounts by _time, client_address | eventstats avg(unique_accounts) as comp_avg , stdev(unique_accounts) as comp_std by client_address | eval upperbound=(comp_avg+comp_std*3) | eval isoutlier=if(unique_accounts > 10 and unique_accounts >= upperbound, 1, 0) | search isoutlier=1 | `windows_disabled_users_failing_to_authenticate_kerberos_filter` '
<li><a href="#">search: '`wineventlog_security` eventcode=4768 account_name="*$" src_ip!="::1" | stats count min(_time) as firsttime max(_time) as lasttime by dest, subject, action, supplied_realm_name, user, account_name, src_ip | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `windows_computer_account_requesting_kerberos_ticket_filter`'
<li><a href="#">search: '`wineventlog_security` eventcode=4768 client_address!="::1" certificate_thumbprint!="" account_name=*$ | stats count min(_time) as firsttime max(_time) as lasttime by dest, account_name, client_address, action, message | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `petitpotam_suspicious_kerberos_tgt_request_filter`'
<li><a href="#">search: '`wineventlog_security` eventcode=4768 result_code=0x6 account_name!="*$" | bucket span=2m _time | stats dc(account_name) as unique_accounts values(account_name) as tried_accounts by _time, client_address | eventstats avg(unique_accounts) as comp_avg , stdev(unique_accounts) as comp_std by client_address | eval upperbound=(comp_avg+comp_std*3) | eval isoutlier=if(unique_accounts > 10 and unique_accounts >= upperbound, 1, 0) | search isoutlier=1 | `windows_invalid_users_failed_authentication_via_kerberos_filter` '
<li><a href="#">search: '`wineventlog_security` eventcode=4769 service_name!="*$" (ticket_options=0x40810000 or ticket_options=0x40800000 or ticket_options=0x40810010) ticket_encryption_type=0x17 | stats count min(_time) as firsttime max(_time) as lasttime by dest, service, service_id, ticket_encryption_type, ticket_options | `security_content_ctime(lasttime)` | `security_content_ctime(firsttime)` | `kerberoasting_spn_request_with_rc4_encryption_filter`'
<li><a href="#">search: '`wineventlog_security` eventcode=4771 failure_code=0x18 account_name!="*$" | bucket span=2m _time | stats dc(account_name) as unique_accounts values(account_name) as tried_accounts by _time, client_address | eventstats avg(unique_accounts) as comp_avg , stdev(unique_accounts) as comp_std by client_address | eval upperbound=(comp_avg+comp_std*3) | eval isoutlier=if(unique_accounts > 10 and unique_accounts >= upperbound, 1, 0) | search isoutlier=1 | `multiple_users_failing_to_authenticate_from_host_using_kerberos_filter`'
<li><a href="#">search: '`wineventlog_security` eventcode=4781 old_account_name="*$" new_account_name!="*$" | table _time, computername, account_name, old_account_name, new_account_name | `suspicious_computer_account_name_change_filter`'
<li><a href="#">search: '`wineventlog_security` eventcode=4798 process_name = "*\\telegram.exe" | stats count min(_time) as firsttime max(_time) as lasttime by computername eventcode process_name process_id account_name account_domain logon_id security_id message | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `enumerate_users_local_group_using_telegram_filter`'
<li><a href="#">search: '`wineventlog_security` eventcode=5145 relative_target_name in ("*.doc","*.docx","*.xls","*.xlsx","*.ppt","*.pptx","*.log","*.txt","*.db","*.7z","*.zip","*.rar","*.tar","*.gz","*.jpg","*.gif","*.png","*.bmp","*.pdf","*.rtf","*.key") object_type=file share_name in ("\\\\*\\c$","\\\\*\\ipc$","\\\\*\\admin$") access_mask= "0x2" | bucket _time span=5m | stats values(relative_target_name) as valrelativetargetname, values(share_name) as valsharename, values(object_type) as valobjecttype, values(access_mask) as valaccessmask, values(src_port) as valsrcport, values(source_address) as valsrcaddress count as numsharename by dest, _time, eventcode, user | eventstats avg(numsharename) as avgsharename, stdev(numsharename) as stdsharename, count as numslots by dest, _time, eventcode, user | eval upperthreshold=(avgsharename + stdsharename *3) | eval isoutlier=if(avgsharename > 20 and avgsharename >= upperthreshold, 1, 0) | search isoutlier=1 | `high_frequency_copy_of_files_in_network_share_filter`'
<li><a href="#">search: '`wineventlog_security` eventcode=5145 relative_target_name in ("*.exe","*.dll") object_type=file share_name in ("\\\\*\\c$","\\\\*\\ipc$","\\\\*\\admin$") access_mask= "0x2" | stats min(_time) as firsttime max(_time) as lasttime count by eventcode share_name relative_target_name object_type access_mask user src_port source_address | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `executable_file_written_in_administrative_smb_share_filter`'
<li><a href="#">search: '`wineventlog_security` signature_id=4703 process_name=*powershell.exe | rex field=message "enabled privileges:\s+(?<privs>\w+)\s+disabled privileges:" | where privs="sedebugprivilege" | stats count min(_time) as firsttime max(_time) as lasttime by dest, process_name, privs, process_id, message | rename privs as "enabled privilege" | rename process_name as process | `security_content_ctime(firsttime)`| `security_content_ctime(lasttime)` | `detect_mimikatz_via_powershell_and_eventcode_4703_filter`'
<li><a href="#">search: '`wineventlog_system` eventcode=7036 | rex field=message "the (?<service>[-\(\)\s\w]+) service entered the (?<state>\w+) state" | where state="running" | lookup previously_seen_running_windows_services service as service output firsttimeseen | where isnull(firsttimeseen) or firsttimeseen > relative_time(now(), `previously_seen_windows_services_window`) | table _time dest service | `first_time_seen_running_windows_service_filter`'
<li><a href="#">search: '`wineventlog_system` eventcode=7036 message in ("*volume shadow copy*","*vss*", "*backup*", "*sophos*", "*sql*", "*memtas*", "*mepocs*", "*veeam*", "*svc$*") message="*service entered the stopped state*" | stats count min(_time) as firsttime max(_time) as lasttime by eventcode message dest type | `security_content_ctime(lasttime)` | `security_content_ctime(firsttime)` | `known_services_killed_by_ransomware_filter`'
<li><a href="#">search: '`wineventlog_system` eventcode=7040 message = "*service was changed from demand start to disabled." | stats count min(_time) as firsttime max(_time) as lasttime by computername eventcode message user sid service service_name | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `windows_event_for_service_disabled_filter`'
<li><a href="#">search: '`wineventlog_system` eventcode=7040 message = "*service was changed from demand start to disabled." | stats count values(message) as messagelist dc(message) as messagecount min(_time) as firsttime max(_time) as lasttime by computername eventcode user sid | where messagecount >=10 | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `windows_excessive_disabled_services_event_filter`'
<li><a href="#">search: '`wineventlog_system` eventcode=7045 service_file_name = "*\.exe" not (service_file_name in ("c:\\windows\\*", "c:\\program file*", "c:\\programdata\\*", "%systemroot%\\*")) | stats count min(_time) as firsttime max(_time) as lasttime by computername eventcode service_file_name service_name service_start_type service_type | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `windows_service_created_within_public_path_filter`'
<li><a href="#">search: '`wineventlog_system` eventcode=7045 service_name in ("krbscm") | stats count min(_time) as firsttime max(_time) as lasttime by eventcode service_file_name service_name service_start_type service_type | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `windows_krbrelayup_service_creation_filter`'
<li><a href="#">search: '`wineventlog_system` eventcode=7045 service_name in ("securitycenteribm", "wincheckdrvs") | stats count min(_time) as firsttime max(_time) as lasttime by eventcode service_file_name service_name service_start_type service_type | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `clop_ransomware_known_service_name_filter`'
<li><a href="#">search: '`wineventlog_system` eventcode=7045 service_type="kernel mode driver" not (service_file_name in ("*\\windows\\*", "*\\program file*", "*\\systemroot\\*","%systemroot%*", "system32\*")) | stats count min(_time) as firsttime max(_time) as lasttime by computername eventcode service_file_name service_name service_start_type service_type | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `windows_driver_load_non_standard_path_filter`'
<li><a href="#">search: '`wineventlog_task_scheduler` eventcode in ("200","201") | rename computername as dest | stats count min(_time) as firsttime max(_time) as lasttime by message dest eventcode category | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `winevent_windows_task_scheduler_event_action_started_filter`'
<li><a href="#">search: '`wmi` eventcode=5860 temporary | rex field=message "notificationquery =\s+(?<query>[^;|^$]+)" | search query!="select * from win32_processstarttrace where processname = ''wsmprovhost.exe''" and query!="select * from __instanceoperationevent where targetinstance isa ''antivirusproduct'' or targetinstance isa ''firewallproduct'' or targetinstance isa ''antispywareproduct''" | stats count min(_time) as firsttime max(_time) as lasttime by computername, query | `security_content_ctime(firsttime)`| `security_content_ctime(lasttime)` | `wmi_temporary_event_subscription_filter`'
<li><a href="#">search: '`wmi` eventcode=5861 binding | rex field=message "consumer =\s+(?<consumer>[^;|^$]+)" | search consumer!="nteventlogeventconsumer=\"scm event log consumer\"" | stats count min(_time) as firsttime max(_time) as lasttime by computername, consumer, message | `security_content_ctime(firsttime)`| `security_content_ctime(lasttime)` | rename computername as dest | `wmi_permanent_event_subscription_filter`'
<li><a href="#">search: '`zeek_rpc` operation in (netrserverpasswordset2,netrserverreqchallenge,netrserverauthenticate3) | bin span=5m _time | stats values(operation) dc(operation) as opscount count(eval(operation=="netrserverreqchallenge")) as challenge count(eval(operation=="netrserverauthenticate3")) as authcount count(eval(operation=="netrserverpasswordset2")) as passcount count as totalcount by _time,src_ip,dest_ip | search opscount=3 authcount>4 passcount>0 | search `detect_zerologon_via_zeek_filter`'
<li><a href="#">search: '`zeek_ssl` | rex field=server_name "(?<snicat>(list|ls|size|ld|cb|cd|ex|alive|exit|where|finito)-[a-za-z0-9]{16}\.)" | stats count by src_ip dest_ip server_name snicat | where count>0 | table src_ip dest_ip server_name snicat | `detect_snicat_sni_exfiltration_filter`'
<li><a href="#">search: '`zeek_x509` | rex field=san.email{} "\@(?<domain_detected>xn--.*)" | rex field=san.other_fields{} "\@(?<domain_detected>xn--.*)" | stats values(domain_detected) by basic_constraints.ca source host | `zeek_x509_certificate_with_punycode_filter`'
<li><a href="#">search: '| from datamodel identity_management.all_identities | eval empstatus=case((now()-startdate)<604800, "accounts created in last week") | search empstatus="accounts created in last week"| `security_content_ctime(enddate)` | `security_content_ctime(startdate)`| table identity empstatus enddate startdate | `identify_new_user_accounts_filter`'
<li><a href="#">search: '| from datamodel web.web | eval jndi=if(match(_raw, "(\{|%7b)[jjnnddii]{4}:"),4,0) | eval jndi_fastmatch=if(match(_raw, "[jjnnddii]{4}"),2,0) | eval jndi_proto=if(match(_raw,"(?i)jndi:(ldap[s]?|rmi|dns|nis|iiop|corba|nds|http|https):"),5,0) | eval all_match = if(match(_raw, "(?i)(%(25){0,}20|\s)*(%(25){0,}24|\$)(%(25){0,}20|\s)*(%(25){0,}7b|{)(%(25){0,}20|\s)*(%(25){0,}(6a|4a)|j)(%(25){0,}(6e|4e)|n)(%(25){0,}(64|44)|d)(%(25){0,}(69|49)|i)(%(25){0,}20|\s)*(%(25){0,}3a|:)[\w\%]+(%(25){1,}3a|:)(%(25){1,}2f|\/)[^\n]+"),5,0) | eval env_var = if(match(_raw, "env:") or match(_raw, "env:aws_access_key_id") or match(_raw, "env:aws_secret_access_key"),5,0) | eval uridetect = if(match(_raw, "(?i)basic\/command\/base64|basic\/reverseshell|basic\/tomcatmemshell|basic\/jbossmemshell|basic\/webspherememshell|basic\/springmemshell|basic\/command|deserialization\/commonscollectionsk|deserialization\/commonsbeanutils|deserialization\/jre8u20\/tomcatmemshell|deserialization\/cve_2020_2555\/weblogicmemshell|tomcatbypass|groovybypass|webspherebypass"),4,0) | eval keywords = if(match(_raw,"(?i)\$\{ctx\:loginid\}|\$\{map\:type\}|\$\{filename\}|\$\{date\:mm-dd-yyyy\}|\$\{docker\:containerid\}|\$\{docker\:containername\}|\$\{docker\:imagename\}|\$\{env\:user\}|\$\{event\:marker\}|\$\{mdc\:userid\}|\$\{java\:runtime\}|\$\{java\:vm\}|\$\{java\:os\}|\$\{jndi\:logging/context-name\}|\$\{hostname\}|\$\{docker\:containerid\}|\$\{k8s\:accountname\}|\$\{k8s\:clustername\}|\$\{k8s\:containerid\}|\$\{k8s\:containername\}|\$\{k8s\:host\}|\$\{k8s\:labels.app\}|\$\{k8s\:labels.podtemplatehash\}|\$\{k8s\:masterurl\}|\$\{k8s\:namespaceid\}|\$\{k8s\:namespacename\}|\$\{k8s\:podid\}|\$\{k8s\:podip\}|\$\{k8s\:podname\}|\$\{k8s\:imageid\}|\$\{k8s\:imagename\}|\$\{log4j\:configlocation\}|\$\{log4j\:configparentlocation\}|\$\{spring\:spring.application.name\}|\$\{main\:mystring\}|\$\{main\:0\}|\$\{main\:1\}|\$\{main\:2\}|\$\{main\:3\}|\$\{main\:4\}|\$\{main\:bar\}|\$\{name\}|\$\{marker\}|\$\{marker\:name\}|\$\{spring\:profiles.active[0]|\$\{sys\:logpath\}|\$\{web\:rootdir\}|\$\{sys\:user.name\}"),4,0) | eval obf = if(match(_raw, "(\$|%24)[^ /]*({|%7b)[^ /]*(j|%6a)[^ /]*(n|%6e)[^ /]*(d|%64)[^ /]*(i|%69)[^ /]*(:|%3a)[^ /]*(:|%3a)[^ /]*(/|%2f)"),5,0) | eval lookups = if(match(_raw, "(?i)({|%7b)(main|sys|k8s|spring|lower|upper|env|date|sd)"),4,0) | addtotals fieldname=score, jndi, jndi_proto, env_var, uridetect, all_match, jndi_fastmatch, keywords, obf, lookups | where score > 2 | stats values(score) by jndi, jndi_proto, env_var, uridetect, all_match, jndi_fastmatch, keywords, lookups, obf, _raw | `hunting_for_log4shell_filter`'
<li><a href="#">search: '| from datamodel web.web | regex _raw="[jjnnddii]{4}(\:|\%3a|\/|\%2f)\w+(\:\/\/|\%3a\%2f\%2f)(\$\{.*?\}(\.)?)?" | fillnull | stats count by action, category, dest, dest_port, http_content_type, http_method, http_referrer, http_user_agent, site, src, url, url_domain, user | `log4shell_jndi_payload_injection_attempt_filter`'
<li><a href="#">search: '| from datamodel web.web | rex field=_raw max_match=0 "[jjnnddii]{4}(\:|\%3a|\/|\%2f)(?<proto>\w+)(\:\/\/|\%3a\%2f\%2f)(\$\{.*?\}(\.)?)?(?<affected_host>[a-za-z0-9\.\-\_\$]+)" | join affected_host type=inner [| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=network_traffic.all_traffic by all_traffic.dest | `drop_dm_object_name(all_traffic)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | rename dest as affected_host] | fillnull | stats count by action, category, dest, dest_port, http_content_type, http_method, http_referrer, http_user_agent, site, src, url, url_domain, user | `log4shell_jndi_payload_injection_with_outbound_connection_filter`'
<li><a href="#">search: '| from read_ssa_enriched_events() | eval _datamodels=ucast(map_get(input_event, "_datamodels"), "collection<string>", []), body={} | eval timestamp=parse_long(ucast(map_get(input_event, "_time"), "string", null)), cmd_line=lower(ucast(map_get(input_event, "process"), "string", null)), process_name=lower(ucast(map_get(input_event, "process_name"), "string", null)), process_path=ucast(map_get(input_event, "process_path"), "string", null), parent_process_name=ucast(map_get(input_event, "parent_process_name"), "string", null), event_id=ucast(map_get(input_event, "event_id"), "string", null) | where cmd_line is not null and like(cmd_line, "%disabled%") and like(cmd_line, "%config%") and process_name="sc.exe" | eval start_time=timestamp, end_time=timestamp, entities=mvappend(ucast(map_get(input_event, "dest_user_id"), "string", null), ucast(map_get(input_event, "dest_device_id"), "string", null)), body=create_map(["event_id", event_id, "cmd_line", cmd_line, "process_name", process_name, "parent_process_name", parent_process_name, "process_path", process_path]) | into write_ssa_detected_events();'
<li><a href="#">search: '| from read_ssa_enriched_events() | eval device=ucast(map_get(input_event, "dest_device_id"), "string", null), auth_type=ucast(map_get(input_event, "authentication_type"), "string", null), timestamp=parse_long(ucast(map_get(input_event, "_time"), "string", null)), src_user=ucast(map_get(input_event, "dest_user_original_artifact"), "string", null), signature_id=ucast(map_get(input_event, "eventcode"), "string", null) | where signature_id="4624" | where auth_type="2" or auth_type="11" | where not (src_user="system") and not (src_user="anonymous logon") | stats estdc(src_user) as user_counter by device, span(timestamp, 600s, 300s) | where user_counter>=2 | rename window_end as timestamp | eval start_time=window_start, end_time=timestamp, entities=mvappend(device), body=create_map(["user_counter", user_counter, "device", device]) | into write_ssa_detected_events();'
<li><a href="#">search: '| from read_ssa_enriched_events() | eval device=ucast(map_get(input_event, "dest_device_id"), "string", null), user=ucast(map_get(input_event, "dest_user_id"), "string", null), timestamp=parse_long(ucast(map_get(input_event, "_time"), "string", null)), process_name=lower(ucast(map_get(input_event, "process_name"), "string", null)), process_path=lower(ucast(map_get(input_event, "process_path"), "string", null)), event_id=ucast(map_get(input_event, "event_id"), "string", null)| where process_name is not null and process_name="acccheckconsole.exe"| where process_path is not null and match_regex(process_path, /(?i)\\program files (x86)\\windows kits\\10\\bin\\10.0.22000.0\\arm64\\accchecker/)=false | eval start_time=timestamp,end_time=timestamp, entities=mvappend(device, user), body=create_map(["event_id", event_id, "process_path", process_path, "process_name", process_name]) | into write_ssa_detected_events();'
<li><a href="#">search: '| from read_ssa_enriched_events() | eval device=ucast(map_get(input_event, "dest_device_id"), "string", null), user=ucast(map_get(input_event, "dest_user_id"), "string", null), timestamp=parse_long(ucast(map_get(input_event, "_time"), "string", null)), process_name=lower(ucast(map_get(input_event, "process_name"), "string", null)), process_path=lower(ucast(map_get(input_event, "process_path"), "string", null)), event_id=ucast(map_get(input_event, "event_id"), "string", null)| where process_name is not null and process_name="adplus.exe"| where process_path is not null and match_regex(process_path, /(?i)\\program files (x86)\\windows kits\\10\\debuggers\\x86/)=false | eval start_time=timestamp,end_time=timestamp, entities=mvappend(device, user), body=create_map(["event_id", event_id, "process_path", process_path, "process_name", process_name]) | into write_ssa_detected_events();'
<li><a href="#">search: '| from read_ssa_enriched_events() | eval device=ucast(map_get(input_event, "dest_device_id"), "string", null), user=ucast(map_get(input_event, "dest_user_id"), "string", null), timestamp=parse_long(ucast(map_get(input_event, "_time"), "string", null)), process_name=lower(ucast(map_get(input_event, "process_name"), "string", null)), process_path=lower(ucast(map_get(input_event, "process_path"), "string", null)), event_id=ucast(map_get(input_event, "event_id"), "string", null)| where process_name is not null and process_name="advpack.dll"| where process_path is not null and match_regex(process_path, /(?i)\\windows\\syswow64/)=false | eval start_time=timestamp,end_time=timestamp, entities=mvappend(device, user), body=create_map(["event_id", event_id, "process_path", process_path, "process_name", process_name]) | into write_ssa_detected_events();'
<li><a href="#">search: '| from read_ssa_enriched_events() | eval device=ucast(map_get(input_event, "dest_device_id"), "string", null), user=ucast(map_get(input_event, "dest_user_id"), "string", null), timestamp=parse_long(ucast(map_get(input_event, "_time"), "string", null)), process_name=lower(ucast(map_get(input_event, "process_name"), "string", null)), process_path=lower(ucast(map_get(input_event, "process_path"), "string", null)), event_id=ucast(map_get(input_event, "event_id"), "string", null)| where process_name is not null and process_name="agentexecutor.exe"| where process_path is not null and match_regex(process_path, /(?i)\\program files (x86)/)=false | eval start_time=timestamp,end_time=timestamp, entities=mvappend(device, user), body=create_map(["event_id", event_id, "process_path", process_path, "process_name", process_name]) | into write_ssa_detected_events();'
<li><a href="#">search: '| from read_ssa_enriched_events() | eval device=ucast(map_get(input_event, "dest_device_id"), "string", null), user=ucast(map_get(input_event, "dest_user_id"), "string", null), timestamp=parse_long(ucast(map_get(input_event, "_time"), "string", null)), process_name=lower(ucast(map_get(input_event, "process_name"), "string", null)), process_path=lower(ucast(map_get(input_event, "process_path"), "string", null)), event_id=ucast(map_get(input_event, "event_id"), "string", null)| where process_name is not null and process_name="appinstaller.exe"| where process_path is not null and match_regex(process_path, /(?i)\\program files\\windowsapps\\microsoft.desktopappinstaller_1.11.2521.0_x64__8wekyb3d8bbwe/)=false | eval start_time=timestamp,end_time=timestamp, entities=mvappend(device, user), body=create_map(["event_id", event_id, "process_path", process_path, "process_name", process_name]) | into write_ssa_detected_events();'
<li><a href="#">search: '| from read_ssa_enriched_events() | eval device=ucast(map_get(input_event, "dest_device_id"), "string", null), user=ucast(map_get(input_event, "dest_user_id"), "string", null), timestamp=parse_long(ucast(map_get(input_event, "_time"), "string", null)), process_name=lower(ucast(map_get(input_event, "process_name"), "string", null)), process_path=lower(ucast(map_get(input_event, "process_path"), "string", null)), event_id=ucast(map_get(input_event, "event_id"), "string", null)| where process_name is not null and process_name="appvlp.exe"| where process_path is not null and match_regex(process_path, /(?i)\\program files (x86)\\microsoft office\\root\\client/)=false | eval start_time=timestamp,end_time=timestamp, entities=mvappend(device, user), body=create_map(["event_id", event_id, "process_path", process_path, "process_name", process_name]) | into write_ssa_detected_events();'
<li><a href="#">search: '| from read_ssa_enriched_events() | eval device=ucast(map_get(input_event, "dest_device_id"), "string", null), user=ucast(map_get(input_event, "dest_user_id"), "string", null), timestamp=parse_long(ucast(map_get(input_event, "_time"), "string", null)), process_name=lower(ucast(map_get(input_event, "process_name"), "string", null)), process_path=lower(ucast(map_get(input_event, "process_path"), "string", null)), event_id=ucast(map_get(input_event, "event_id"), "string", null)| where process_name is not null and process_name="aspnet_compiler.exe"| where process_path is not null and match_regex(process_path, /(?i)\\windows\\microsoft.net\\framework64\\v4.0.30319/)=false | eval start_time=timestamp,end_time=timestamp, entities=mvappend(device, user), body=create_map(["event_id", event_id, "process_path", process_path, "process_name", process_name]) | into write_ssa_detected_events();'
<li><a href="#">search: '| from read_ssa_enriched_events() | eval device=ucast(map_get(input_event, "dest_device_id"), "string", null), user=ucast(map_get(input_event, "dest_user_id"), "string", null), timestamp=parse_long(ucast(map_get(input_event, "_time"), "string", null)), process_name=lower(ucast(map_get(input_event, "process_name"), "string", null)), process_path=lower(ucast(map_get(input_event, "process_path"), "string", null)), event_id=ucast(map_get(input_event, "event_id"), "string", null)| where process_name is not null and process_name="at.exe"| where process_path is not null and match_regex(process_path, /(?i)\\windows\\syswow64/)=false | eval start_time=timestamp,end_time=timestamp, entities=mvappend(device, user), body=create_map(["event_id", event_id, "process_path", process_path, "process_name", process_name]) | into write_ssa_detected_events();'
<li><a href="#">search: '| from read_ssa_enriched_events() | eval device=ucast(map_get(input_event, "dest_device_id"), "string", null), user=ucast(map_get(input_event, "dest_user_id"), "string", null), timestamp=parse_long(ucast(map_get(input_event, "_time"), "string", null)), process_name=lower(ucast(map_get(input_event, "process_name"), "string", null)), process_path=lower(ucast(map_get(input_event, "process_path"), "string", null)), event_id=ucast(map_get(input_event, "event_id"), "string", null)| where process_name is not null and process_name="atbroker.exe"| where process_path is not null and match_regex(process_path, /(?i)\\windows\\syswow64/)=false | eval start_time=timestamp,end_time=timestamp, entities=mvappend(device, user), body=create_map(["event_id", event_id, "process_path", process_path, "process_name", process_name]) | into write_ssa_detected_events();'
<li><a href="#">search: '| from read_ssa_enriched_events() | eval sourcetype = ucast(map_get(input_event, "sourcetype"), "string", null) | eval timestamp = parse_long(ucast(map_get(input_event, "_time"), "string", null)) | where sourcetype == "pan:traffic" | eval src_device_scope =ucast(map_get(input_event, "src_device_scope"), "string", null) | eval dest_device_scope=ucast(map_get(input_event, "dest_device_scope"), "string", null) | where src_device_scope is not null and dest_device_scope is not null | eval dest_device = ucast(map_get(input_event, "dest_device_ips"), "collection<string>", [])[0] | where dest_device is not null and dest_device_scope == "internal" | eval src_device = ucast(map_get(input_event, "src_device_ips"), "collection<string>", [])[0] | where src_device is not null and src_device_scope == "internal" | eval bytes_in = ucast(map_get(input_event, "bytes_in"), "integer", 0) | eval download_bytes = cast(bytes_in, "double") | eval tenant = ucast(map_get(input_event, "_tenant"), "string", null) | eval event_id = ucast(map_get(input_event, "event_id"), "string", null) | adaptive_threshold algorithm="quantile" value="download_bytes" entity="dest_device" window=86400000l | where label and quantile>0.99999 | eval end_time = timestamp | eval start_time = end_time - 86400000 | eval body = create_map(["event_id", event_id, "tenant", tenant]) | eval entities=mvappend(dest_device) | into write_ssa_detected_events();'
<li><a href="#">search: '| from read_ssa_enriched_events() | eval tenant=ucast(map_get(input_event, "_tenant"), "string", null), machine=ucast(map_get(input_event, "dest_device_id"), "string", null), process_name=lower(ucast(map_get(input_event, "process_name"), "string", null)), timestamp=parse_long(ucast(map_get(input_event, "_time"), "string", null)), process=lower(ucast(map_get(input_event, "process"), "string", null)), event_id=ucast(map_get(input_event, "event_id"), "string", null) | where process is not null and process_name is not null and process_name like "%rundll32.exe%" and match_regex(process, /(?i)minidump\s+/)=true and match_regex(process, /(?i)comsvcs.dll\s+/)=true | eval start_time = timestamp, end_time = timestamp, entities = mvappend(machine), body=create_map(["event_id", event_id, "process_name", process_name, "process", process]) | into write_ssa_detected_events();'
<li><a href="#">search: '| from read_ssa_enriched_events() | eval timestamp=parse_long(ucast(map_get(input_event, "_time"), "string", null)) | eval action=ucast(map_get(input_event, "action"), "string", null), process=ucast(map_get(input_event, "process"), "string", null), file_name=ucast(map_get(input_event, "file_name"), "string", null), file_path=ucast(map_get(input_event, "file_path"), "string", null), dest_user_id=ucast(map_get(input_event, "dest_user_id"), "string", null), dest_device_id=ucast(map_get(input_event, "dest_device_id"), "string", null) | where "endpoint_filesystem" in(_datamodels) | where action="created" | where like(file_name, "%.doc%") or like(file_name, "%.xls%") or like(file_name, "%.ppt%") | stats count(file_name) as count by dest_user_id, dest_device_id, span(timestamp, 10m) | where count > 20 | eval start_time=window_start, end_time=window_end, entities=mvappend(dest_user_id, dest_device_id), body=create_map(["count", count]) | into write_ssa_detected_events();'
<li><a href="#">search: '| from read_ssa_enriched_events() | eval timestamp=parse_long(ucast(map_get(input_event, "_time"), "string", null)) | eval action=ucast(map_get(input_event, "action"), "string", null), process=ucast(map_get(input_event, "process"), "string", null), file_name=ucast(map_get(input_event, "file_name"), "string", null), file_path=ucast(map_get(input_event, "file_path"), "string", null), dest_user_id=ucast(map_get(input_event, "dest_user_id"), "string", null), dest_device_id=ucast(map_get(input_event, "dest_device_id"), "string", null) | where "endpoint_filesystem" in(_datamodels) | where action="deleted" | where like(file_name, "%.cmd") or like(file_name, "%.ini") or like(file_name, "%.gif") or like(file_name, "%.jpg") or like(file_name, "%.jpeg") or like(file_name, "%.db") or like(file_name, "%.doc%") or like(file_name, "%.ps1") or like(file_name, "%.xls%") or like(file_name, "%.ppt%") or like(file_name, "%.bmp") or like(file_name, "%.zip") or like(file_name, "%.rar") or like(file_name, "%.7z") or like(file_name, "%.chm") or like(file_name, "%.png") or like(file_name, "%.log") or like(file_name, "%.vbs") or like(file_name, "%.js") | stats count(file_name) as count by dest_user_id, dest_device_id, span(timestamp, 10m) | where count > 20 | eval start_time=window_start, end_time=window_end, entities=mvappend(dest_user_id, dest_device_id), body=create_map(["count", count]) | into write_ssa_detected_events();'
<li><a href="#">search: '| from read_ssa_enriched_events() | eval timestamp=parse_long(ucast(map_get(input_event, "_time"), "string", null)) | eval dest_user_id=ucast(map_get(input_event, "dest_user_id"), "string", null), dest_device_id=ucast(map_get(input_event, "dest_device_id"), "string", null), process_name=ucast(map_get(input_event, "process_name"), "string", null), cmd_line=ucast(map_get(input_event, "process"), "string", null), cmd_line_norm=lower(cmd_line), cmd_line_norm=replace(cmd_line_norm, /[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}/, "guid"), cmd_line_norm=replace(cmd_line_norm, /(?<=\s)+\\[^:]*(?=\\.*\.\w{3}(\s|$)+)/, "\\path"), /* replaces " \\something\\something\\command.ext" => "path\\command.ext" */ cmd_line_norm=replace(cmd_line_norm, /\w:\\[^:]*(?=\\.*\.\w{3}(\s|$)+)/, "\\path"), /* replaces "c:\\something\\something\\command.ext" => "path\\command.ext" */ cmd_line_norm=replace(cmd_line_norm, /\d+/, "n"), event_id=ucast(map_get(input_event, "event_id"), "string", null) | where process_name="cmd.exe" and match_regex(ucast(cmd_line, "string", ""), /.* \/[cc] .*/)=true | select process_name, cmd_line, cmd_line_norm, timestamp, dest_device_id, dest_user_id | first_time_event input_columns=["cmd_line_norm"] | where first_time_cmd_line_norm | eval start_time = timestamp, end_time = timestamp, entities = mvappend(dest_device_id, dest_user_id), body=create_map(["event_id", event_id, "cmd_line", cmd_line, "process_name", process_name]) | into write_ssa_detected_events();'
<li><a href="#">search: '| from read_ssa_enriched_events() | eval timestamp=parse_long(ucast(map_get(input_event, "_time"), "string", null)) | eval parent_process=lower(ucast(map_get(input_event, "parent_process_name"), "string", null)), parent_process_name=mvindex(split(parent_process, "\\"), -1), process_name=lower(ucast(map_get(input_event, "process_name"), "string", null)), cmd_line=ucast(map_get(input_event, "process"), "string", null), dest_user_id=ucast(map_get(input_event, "dest_user_id"), "string", null), dest_device_id=ucast(map_get(input_event, "dest_device_id"), "string", null), event_id=ucast(map_get(input_event, "event_id"), "string", null) | where parent_process_name!=null | select parent_process_name, process_name, cmd_line, timestamp, dest_device_id, dest_user_id | conditional_anomaly conditional="parent_process_name" target="process_name" | where (process_name="powershell.exe" or process_name="regsvcs.exe" or process_name="ftp.exe" or process_name="dfsvc.exe" or process_name="rasautou.exe" or process_name="schtasks.exe" or process_name="xwizard.exe" or process_name="findstr.exe" or process_name="esentutl.exe" or process_name="cscript.exe" or process_name="reg.exe" or process_name="csc.exe" or process_name="atbroker.exe" or process_name="print.exe" or process_name="pcwrun.exe" or process_name="vbc.exe" or process_name="rpcping.exe" or process_name="wsreset.exe" or process_name="ilasm.exe" or process_name="certutil.exe" or process_name="replace.exe" or process_name="mshta.exe" or process_name="bitsadmin.exe" or process_name="wscript.exe" or process_name="ieexec.exe" or process_name="cmd.exe" or process_name="microsoft.workflow.compiler.exe" or process_name="runscripthelper.exe" or process_name="makecab.exe" or process_name="forfiles.exe" or process_name="desktopimgdownldr.exe" or process_name="control.exe" or process_name="msbuild.exe" or process_name="register-cimprovider.exe" or process_name="tttracer.exe" or process_name="ie4uinit.exe" or process_name="sc.exe" or process_name="bash.exe" or process_name="hh.exe" or process_name="cmstp.exe" or process_name="mmc.exe" or process_name="jsc.exe" or process_name="scriptrunner.exe" or process_name="odbcconf.exe" or process_name="extexport.exe" or process_name="msdt.exe" or process_name="diskshadow.exe" or process_name="extrac32.exe" or process_name="eventvwr.exe" or process_name="mavinject.exe" or process_name="regasm.exe" or process_name="gpscript.exe" or process_name="rundll32.exe" or process_name="regsvr32.exe" or process_name="regedit.exe" or process_name="msiexec.exe" or process_name="gfxdownloadwrapper.exe" or process_name="presentationhost.exe" or process_name="regini.exe" or process_name="wmic.exe" or process_name="runonce.exe" or process_name="syncappvpublishingserver.exe" or process_name="verclsid.exe" or process_name="psr.exe" or process_name="infdefaultinstall.exe" or process_name="explorer.exe" or process_name="expand.exe" or process_name="installutil.exe" or process_name="netsh.exe" or process_name="wab.exe" or process_name="dnscmd.exe" or process_name="at.exe" or process_name="pcalua.exe" or process_name="cmdkey.exe" or process_name="msconfig.exe") | eval input = (-1)*log(output) | adaptive_threshold algorithm="gaussian" threshold=0.001 window=604800000l | where label and input > mean | eval start_time = timestamp, end_time = timestamp, entities = mvappend(dest_device_id, dest_user_id), body = create_map(["process_name", process_name, "parent_process_name", parent_process_name, "input", input, "mean", mean, "variance", variance, "output", output, "cmd_line", cmd_line]) | into write_ssa_detected_events();'
<li><a href="#">search: '| from read_ssa_enriched_events() | eval timestamp=parse_long(ucast(map_get(input_event, "_time"), "string", null)) | eval process_name = ucast(map_get(input_event, "process_name"), "string", null), parent_process_name = lower(ucast(input_event.parent_process_name, "string", null)), cmd_line = lower(ucast(map_get(input_event, "process"),"string", null)), dest_user_id=ucast(map_get(input_event, "dest_user_id"), "string", null), dest_device_id=ucast(map_get(input_event, "dest_device_id"), "string", null), event_id=ucast(map_get(input_event,"event_id"), "string", null) | where process_name="cmd.exe" | rex field=parent_process_name "(?<parentbasefilename>[^\\\\]+)$" | where parentbasefilename="winword.exe" or parentbasefilename="excel.exe" or parentbasefilename="outlook.exe" or parentbasefilename="powerpnt.exe" or parentbasefilename="visio.exe" or parentbasefilename="mspub.exe" or parentbasefilename="acrobat.exe" or parentbasefilename="acrord32.exe" or parentbasefilename="iexplore.exe" or parentbasefilename="opera.exe" or parentbasefilename="firefox.exe" or (parentbasefilename="java.exe" and (parent_process_name is not null and match_regex(parent_process_name, /(?i)patch1-hotfix1a/)=false)) or parentbasefilename="powershell.exe" or (parentbasefilename="chrome.exe" and (cmd_line is null or (cmd_line is not null and match_regex(cmd_line, /(?i)chrome-extension/)=false))) | eval start_time=timestamp, end_time=timestamp, entities=mvappend(dest_device_id, dest_user_id), body=create_map(["event_id", event_id, "process_name", process_name, "parent_process_name", parent_process_name, "cmd_line", cmd_line, "parentbasefilename", parentbasefilename]) | into write_ssa_detected_events()'
<li><a href="#">search: '| from read_ssa_enriched_events() | eval timestamp=parse_long(ucast(map_get(input_event, "_time"), "string", null)), cmd_line=lower(ucast(map_get(input_event, "process"), "string", null)), process_name=lower(ucast(map_get(input_event, "process_name"), "string", null)), process_path=ucast(map_get(input_event, "process_path"), "string", null), parent_process_name=lower(ucast(map_get(input_event, "parent_process_name"), "string", null)), event_id=ucast(map_get(input_event, "event_id"), "string", null) | where cmd_line is not null and process_name is not null and parent_process_name is not null | where (like(parent_process_name, "%\\\\winword.exe") or like(parent_process_name, "%\\\\excel.exe") or like(parent_process_name, "%\\\\powerpnt.exe") or like(parent_process_name, "%\\\\mspub.exe") or like(parent_process_name, "%\\\\visio.exe")) and (process_name="wscript.exe" or process_name="cscript.exe") | eval start_time=timestamp, end_time=timestamp, entities=mvappend(ucast(map_get(input_event, "dest_user_id"), "string", null), ucast(map_get(input_event, "dest_device_id"), "string", null)), body=create_map(["event_id", event_id, "cmd_line", cmd_line, "process_name", process_name, "parent_process_name", parent_process_name, "process_path", process_path]) | into write_ssa_detected_events();'
<li><a href="#">search: '| from read_ssa_enriched_events() | eval timestamp=parse_long(ucast(map_get(input_event, "_time"), "string", null)), cmd_line=lower(ucast(map_get(input_event, "process"), "string", null)), process_name=lower(ucast(map_get(input_event, "process_name"), "string", null)), process_path=ucast(map_get(input_event, "process_path"), "string", null), parent_process_name=lower(ucast(map_get(input_event, "parent_process_name"), "string", null)), event_id=ucast(map_get(input_event, "event_id"), "string", null) | where cmd_line is not null and process_name is not null and parent_process_name is not null | where like(parent_process_name, "%\\\\mshta.exe") and (process_name="powershell.exe" or process_name="cmd.exe" or process_name="scrcons.exe" or process_name="colorcpl.exe" or process_name="msbuild.exe" or process_name="microsoft.workflow.compiler.exe" or process_name="searchprotocolhost.exe" or process_name="cscript.exe" or process_name="wscript.exe") | eval start_time=timestamp, end_time=timestamp, entities=mvappend(ucast(map_get(input_event, "dest_user_id"), "string", null), ucast(map_get(input_event, "dest_device_id"), "string", null)), body=create_map(["event_id", event_id, "cmd_line", cmd_line, "process_name", process_name, "parent_process_name", parent_process_name, "process_path", process_path]) | into write_ssa_detected_events();'
<li><a href="#">search: '| from read_ssa_enriched_events() | eval timestamp=parse_long(ucast(map_get(input_event, "_time"), "string", null)), cmd_line=lower(ucast(map_get(input_event, "process"), "string", null)), process_name=lower(ucast(map_get(input_event, "process_name"), "string", null)), process_path=ucast(map_get(input_event, "process_path"), "string", null), parent_process_name=lower(ucast(map_get(input_event, "parent_process_name"), "string", null)), event_id=ucast(map_get(input_event, "event_id"), "string", null) | where cmd_line is not null and process_name is not null and parent_process_name is not null | where parent_process_name like "%wmiprvse.exe%" and process_name="msbuild.exe" | eval start_time=timestamp, end_time=timestamp, entities=mvappend(ucast(map_get(input_event, "dest_user_id"), "string", null), ucast(map_get(input_event, "dest_device_id"), "string", null)), body=create_map(["event_id", event_id, "cmd_line", cmd_line, "process_name", process_name, "parent_process_name", parent_process_name, "process_path", process_path]) | into write_ssa_detected_events();'
<li><a href="#">search: '| from read_ssa_enriched_events() | eval timestamp=parse_long(ucast(map_get(input_event, "_time"), "string", null)), cmd_line=lower(ucast(map_get(input_event, "process"), "string", null)), process_name=lower(ucast(map_get(input_event, "process_name"), "string", null)), process_path=ucast(map_get(input_event, "process_path"), "string", null), parent_process_name=ucast(map_get(input_event, "parent_process_name"), "string", null), event_id=ucast(map_get(input_event, "event_id"), "string", null) | where (cmd_line is not null and process_name is not null) | where process_name="wbadmin.exe" | where like (cmd_line, "%delete%") or like (cmd_line, "%catalog%") or like (cmd_line, "%systemstatebackup%") | eval start_time=timestamp, end_time=timestamp, entities=mvappend(ucast(map_get(input_event, "dest_user_id"), "string", null), ucast(map_get(input_event, "dest_device_id"), "string", null)), body=create_map(["event_id", event_id, "cmd_line", cmd_line, "process_name", process_name, "parent_process_name", parent_process_name, "process_path", process_path]) | into write_ssa_detected_events();'
<li><a href="#">search: '| from read_ssa_enriched_events() | eval timestamp=parse_long(ucast(map_get(input_event, "_time"), "string", null)), cmd_line=lower(ucast(map_get(input_event, "process"), "string", null)), process_name=lower(ucast(map_get(input_event, "process_name"), "string", null)), process_path=ucast(map_get(input_event, "process_path"), "string", null), parent_process_name=ucast(map_get(input_event, "parent_process_name"), "string", null), event_id=ucast(map_get(input_event, "event_id"), "string", null) | where cmd_line is not null and like(cmd_line, "%/active:no%") and like(cmd_line, "%user%") and (process_name="net1.exe" or process_name="net.exe") | eval start_time=timestamp, end_time=timestamp, entities=mvappend(ucast(map_get(input_event, "dest_user_id"), "string", null), ucast(map_get(input_event, "dest_device_id"), "string", null)), body=create_map(["event_id", event_id, "cmd_line", cmd_line, "process_name", process_name, "parent_process_name", parent_process_name, "process_path", process_path]) | into write_ssa_detected_events();'
<li><a href="#">search: '| from read_ssa_enriched_events() | eval timestamp=parse_long(ucast(map_get(input_event, "_time"), "string", null)), cmd_line=lower(ucast(map_get(input_event, "process"), "string", null)), process_name=lower(ucast(map_get(input_event, "process_name"), "string", null)), process_path=ucast(map_get(input_event, "process_path"), "string", null), parent_process_name=ucast(map_get(input_event, "parent_process_name"), "string", null), event_id=ucast(map_get(input_event, "event_id"), "string", null) | where cmd_line is not null and like(cmd_line, "%/w:%") and process_name="cipher.exe" | eval start_time=timestamp, end_time=timestamp, entities=mvappend(ucast(map_get(input_event, "dest_user_id"), "string", null), ucast(map_get(input_event, "dest_device_id"), "string", null)), body=create_map(["event_id", event_id, "cmd_line", cmd_line, "process_name", process_name, "parent_process_name", parent_process_name, "process_path", process_path]) | into write_ssa_detected_events();'
<li><a href="#">search: '| from read_ssa_enriched_events() | eval timestamp=parse_long(ucast(map_get(input_event, "_time"), "string", null)), cmd_line=lower(ucast(map_get(input_event, "process"), "string", null)), process_name=lower(ucast(map_get(input_event, "process_name"), "string", null)), process_path=ucast(map_get(input_event, "process_path"), "string", null), parent_process_name=ucast(map_get(input_event, "parent_process_name"), "string", null), event_id=ucast(map_get(input_event, "event_id"), "string", null) | where cmd_line is not null and like(cmd_line, "%delete%") and process_name = "sc.exe" | eval start_time=timestamp, end_time=timestamp, entities=mvappend(ucast(map_get(input_event, "dest_user_id"), "string", null), ucast(map_get(input_event, "dest_device_id"), "string", null)), body=create_map(["event_id", event_id, "cmd_line", cmd_line, "process_name", process_name, "parent_process_name", parent_process_name, "process_path", process_path]) | into write_ssa_detected_events();'
<li><a href="#">search: '| from read_ssa_enriched_events() | eval timestamp=parse_long(ucast(map_get(input_event, "_time"), "string", null)), cmd_line=lower(ucast(map_get(input_event, "process"), "string", null)), process_name=lower(ucast(map_get(input_event, "process_name"), "string", null)), process_path=ucast(map_get(input_event, "process_path"), "string", null), parent_process_name=ucast(map_get(input_event, "parent_process_name"), "string", null), event_id=ucast(map_get(input_event, "event_id"), "string", null) | where cmd_line is not null and like(cmd_line, "%resize%") and like(cmd_line, "%shadowstorage%") and like(cmd_line, "%maxsize%") and process_name="vssadmin.exe" | eval start_time=timestamp, end_time=timestamp, entities=mvappend(ucast(map_get(input_event, "dest_user_id"), "string", null), ucast(map_get(input_event, "dest_device_id"), "string", null)), body=create_map(["event_id", event_id, "cmd_line", cmd_line, "process_name", process_name, "parent_process_name", parent_process_name, "process_path", process_path]) | into write_ssa_detected_events();'
<li><a href="#">search: '| from read_ssa_enriched_events() | eval timestamp=parse_long(ucast(map_get(input_event, "_time"), "string", null)), cmd_line=lower(ucast(map_get(input_event, "process"), "string", null)), process_name=lower(ucast(map_get(input_event, "process_name"), "string", null)), process_path=ucast(map_get(input_event, "process_path"), "string", null), parent_process_name=ucast(map_get(input_event, "parent_process_name"), "string", null), event_id=ucast(map_get(input_event, "event_id"), "string", null) | where cmd_line is not null and match_regex(cmd_line, /\+h/)=true and process_name="attrib.exe" | eval start_time=timestamp, end_time=timestamp, entities=mvappend(ucast(map_get(input_event, "dest_user_id"), "string", null), ucast(map_get(input_event, "dest_device_id"), "string", null)), body=create_map(["event_id", event_id, "cmd_line", cmd_line, "process_name", process_name, "parent_process_name", parent_process_name, "process_path", process_path]) | into write_ssa_detected_events();'
<li><a href="#">search: '| from read_ssa_enriched_events() | eval timestamp=parse_long(ucast(map_get(input_event, "_time"), "string", null)), cmd_line=lower(ucast(map_get(input_event, "process"), "string", null)), process_name=lower(ucast(map_get(input_event, "process_name"), "string", null)), process_path=ucast(map_get(input_event, "process_path"), "string", null), parent_process_name=ucast(map_get(input_event, "parent_process_name"), "string", null), event_id=ucast(map_get(input_event, "event_id"), "string", null) | where cmd_line is not null and process_name is not null | where (like (cmd_line, "%get-aduser%") and like (cmd_line, "%4194304%")) | eval start_time=timestamp, end_time=timestamp, entities=mvappend(ucast(map_get(input_event, "dest_user_id"), "string", null), ucast(map_get(input_event, "dest_device_id"), "string", null)), body=create_map(["event_id", event_id, "cmd_line", cmd_line, "process_name", process_name, "parent_process_name", parent_process_name, "process_path", process_path]) | into write_ssa_detected_events();'
<li><a href="#">search: '| from read_ssa_enriched_events() | eval timestamp=parse_long(ucast(map_get(input_event, "_time"), "string", null)), cmd_line=lower(ucast(map_get(input_event, "process"), "string", null)), process_name=lower(ucast(map_get(input_event, "process_name"), "string", null)), process_path=ucast(map_get(input_event, "process_path"), "string", null), parent_process_name=ucast(map_get(input_event, "parent_process_name"), "string", null), event_id=ucast(map_get(input_event, "event_id"), "string", null) | where cmd_line is not null and process_name is not null | where (like (cmd_line, "%get-domainuser%") and like (cmd_line, "%preauthnotrequired%")) | eval start_time=timestamp, end_time=timestamp, entities=mvappend(ucast(map_get(input_event, "dest_user_id"), "string", null), ucast(map_get(input_event, "dest_device_id"), "string", null)), body=create_map(["event_id", event_id, "cmd_line", cmd_line, "process_name", process_name, "parent_process_name", parent_process_name, "process_path", process_path]) | into write_ssa_detected_events();'
<li><a href="#">search: '| from read_ssa_enriched_events() | eval timestamp=parse_long(ucast(map_get(input_event, "_time"), "string", null)), cmd_line=lower(ucast(map_get(input_event, "process"), "string", null)), process_name=lower(ucast(map_get(input_event, "process_name"), "string", null)), process_path=ucast(map_get(input_event, "process_path"), "string", null), parent_process_name=ucast(map_get(input_event, "parent_process_name"), "string", null), event_id=ucast(map_get(input_event, "event_id"), "string", null) | where cmd_line is not null and process_name is not null | where (like (cmd_line, "%new-mailboxexportrequest%") or like (cmd_line, "%new-managementroleassignment%") or like (cmd_line, "%new-mailboxsearch%") or like (cmd_line,"%get-recipient%")) | eval start_time=timestamp, end_time=timestamp, entities=mvappend(ucast(map_get(input_event, "dest_user_id"), "string", null), ucast(map_get(input_event, "dest_device_id"), "string", null)), body=create_map(["event_id", event_id, "cmd_line", cmd_line, "process_name", process_name, "parent_process_name", parent_process_name, "process_path", process_path]) | into write_ssa_detected_events();'
<li><a href="#">search: '| from read_ssa_enriched_events() | eval timestamp=parse_long(ucast(map_get(input_event, "_time"), "string", null)), cmd_line=lower(ucast(map_get(input_event, "process"), "string", null)), process_name=lower(ucast(map_get(input_event, "process_name"), "string", null)), process_path=ucast(map_get(input_event, "process_path"), "string", null), parent_process_name=ucast(map_get(input_event, "parent_process_name"), "string", null), event_id=ucast(map_get(input_event, "event_id"), "string", null) | where cmd_line is not null and process_name is not null | where process_name="explorer.exe" and (like (cmd_line, "%") or like (cmd_line, "%")) and not (like(parent_process_name, "userinit.exe") or like(parent_process_name, "svchost.exe")) | eval start_time=timestamp, end_time=timestamp, entities=mvappend(ucast(map_get(input_event, "dest_user_id"), "string", null), ucast(map_get(input_event, "dest_device_id"), "string", null)), body=create_map(["event_id", event_id, "cmd_line", cmd_line, "process_name", process_name, "parent_process_name", parent_process_name, "process_path", process_path]) | into write_ssa_detected_events();'
<li><a href="#">search: '| from read_ssa_enriched_events() | eval timestamp=parse_long(ucast(map_get(input_event, "_time"), "string", null)), cmd_line=lower(ucast(map_get(input_event, "process"), "string", null)), process_name=lower(ucast(map_get(input_event, "process_name"), "string", null)), process_path=ucast(map_get(input_event, "process_path"), "string", null), parent_process_name=ucast(map_get(input_event, "parent_process_name"), "string", null), event_id=ucast(map_get(input_event, "event_id"), "string", null) | where cmd_line is not null and process_name is not null | where process_name="mshta.exe" and (like (cmd_line, "%") or like (cmd_line, "%")) | eval start_time=timestamp, end_time=timestamp, entities=mvappend(ucast(map_get(input_event, "dest_user_id"), "string", null), ucast(map_get(input_event, "dest_device_id"), "string", null)), body=create_map(["event_id", event_id, "cmd_line", cmd_line, "process_name", process_name, "parent_process_name", parent_process_name, "process_path", process_path]) | into write_ssa_detected_events();'
<li><a href="#">search: '| from read_ssa_enriched_events() | eval timestamp=parse_long(ucast(map_get(input_event, "_time"), "string", null)), cmd_line=lower(ucast(map_get(input_event, "process"), "string", null)), process_name=lower(ucast(map_get(input_event, "process_name"), "string", null)), process_path=ucast(map_get(input_event, "process_path"), "string", null), parent_process_name=ucast(map_get(input_event, "parent_process_name"), "string", null), event_id=ucast(map_get(input_event, "event_id"), "string", null) | where cmd_line is not null and process_name is not null | where process_name="mshta.exe" and (like (cmd_line, "%vbscript%") or like (cmd_line, "%javascript%") or like (cmd_line, "%about%")) | eval start_time=timestamp, end_time=timestamp, entities=mvappend(ucast(map_get(input_event, "dest_user_id"), "string", null), ucast(map_get(input_event, "dest_device_id"), "string", null)), body=create_map(["event_id", event_id, "cmd_line", cmd_line, "process_name", process_name, "parent_process_name", parent_process_name, "process_path", process_path]) | into write_ssa_detected_events();'
<li><a href="#">search: '| from read_ssa_enriched_events() | eval timestamp=parse_long(ucast(map_get(input_event, "_time"), "string", null)), cmd_line=lower(ucast(map_get(input_event, "process"), "string", null)), process_name=lower(ucast(map_get(input_event, "process_name"), "string", null)), process_path=ucast(map_get(input_event, "process_path"), "string", null), parent_process_name=ucast(map_get(input_event, "parent_process_name"), "string", null), event_id=ucast(map_get(input_event, "event_id"), "string", null) | where cmd_line is not null and process_name is not null | where process_name="pwsh.exe" or process_name="pwsh.exe" or process_name="sqlps.exe" or process_name="sqltoolsps.exe" or process_name="powershell.exe" or process_name="powershell_ise.exe" | where (like (cmd_line, "%downloadfile%")) | eval start_time=timestamp, end_time=timestamp, entities=mvappend(ucast(map_get(input_event, "dest_user_id"), "string", null), ucast(map_get(input_event, "dest_device_id"), "string", null)), body=create_map(["event_id", event_id, "cmd_line", cmd_line, "process_name", process_name, "parent_process_name", parent_process_name, "process_path", process_path]) | into write_ssa_detected_events();'
<li><a href="#">search: '| from read_ssa_enriched_events() | eval timestamp=parse_long(ucast(map_get(input_event, "_time"), "string", null)), cmd_line=lower(ucast(map_get(input_event, "process"), "string", null)), process_name=lower(ucast(map_get(input_event, "process_name"), "string", null)), process_path=ucast(map_get(input_event, "process_path"), "string", null), parent_process_name=ucast(map_get(input_event, "parent_process_name"), "string", null), event_id=ucast(map_get(input_event, "event_id"), "string", null) | where cmd_line is not null and process_name is not null | where process_name="pwsh.exe" or process_name="pwsh.exe" or process_name="sqlps.exe" or process_name="sqltoolsps.exe" or process_name="powershell.exe" or process_name="powershell_ise.exe" | where (like (cmd_line, "%start-bitstransfer%")) | eval start_time=timestamp, end_time=timestamp, entities=mvappend(ucast(map_get(input_event, "dest_user_id"), "string", null), ucast(map_get(input_event, "dest_device_id"), "string", null)), body=create_map(["event_id", event_id, "cmd_line", cmd_line, "process_name", process_name, "parent_process_name", parent_process_name, "process_path", process_path]) | into write_ssa_detected_events();'
<li><a href="#">search: '| from read_ssa_enriched_events() | eval timestamp=parse_long(ucast(map_get(input_event, "_time"), "string", null)), cmd_line=lower(ucast(map_get(input_event, "process"), "string", null)), process_name=lower(ucast(map_get(input_event, "process_name"), "string", null)), process_path=ucast(map_get(input_event, "process_path"), "string", null), parent_process_name=ucast(map_get(input_event, "parent_process_name"), "string", null), event_id=ucast(map_get(input_event, "event_id"), "string", null) | where cmd_line is not null and process_name is not null | where process_name="rundll32.exe" and (like (cmd_line, "%vbscript%") or like (cmd_line, "%javascript%") or like (cmd_line, "%about%")) | eval start_time=timestamp, end_time=timestamp, entities=mvappend(ucast(map_get(input_event, "dest_user_id"), "string", null), ucast(map_get(input_event, "dest_device_id"), "string", null)), body=create_map(["event_id", event_id, "cmd_line", cmd_line, "process_name", process_name, "parent_process_name", parent_process_name, "process_path", process_path]) | into write_ssa_detected_events();'
<li><a href="#">search: '| from read_ssa_enriched_events() | eval timestamp=parse_long(ucast(map_get(input_event, "_time"), "string", null)), cmd_line=lower(ucast(map_get(input_event, "process"), "string", null)), process_name=lower(ucast(map_get(input_event, "process_name"), "string", null)), process_path=ucast(map_get(input_event, "process_path"), "string", null), parent_process_name=ucast(map_get(input_event, "parent_process_name"), "string", null), event_id=ucast(map_get(input_event, "event_id"), "string", null) | where cmd_line is not null and process_name is not null and (process_name="procdump.exe" or process_name="procdump64.exe") and (like (cmd_line, "%-mm %") or like (cmd_line, "%-ma %")) and like (cmd_line, "%lsass%") | eval start_time=timestamp, end_time=timestamp, entities=mvappend(ucast(map_get(input_event, "dest_user_id"), "string", null), ucast(map_get(input_event, "dest_device_id"), "string", null)), body=create_map(["event_id", event_id, "cmd_line", cmd_line, "process_name", process_name, "parent_process_name", parent_process_name, "process_path", process_path]) | into write_ssa_detected_events();'
<li><a href="#">search: '| from read_ssa_enriched_events() | eval timestamp=parse_long(ucast(map_get(input_event, "_time"), "string", null)), cmd_line=lower(ucast(map_get(input_event, "process"), "string", null)), process_name=lower(ucast(map_get(input_event, "process_name"), "string", null)), process_path=ucast(map_get(input_event, "process_path"), "string", null), parent_process_name=ucast(map_get(input_event, "parent_process_name"), "string", null), event_id=ucast(map_get(input_event, "event_id"), "string", null) | where cmd_line is not null and process_name is not null and parent_process_name is not null | where (parent_process_name like "%wscript.exe" or parent_process_name like "%cscript.exe%") and process_name="msbuild.exe" | eval start_time=timestamp, end_time=timestamp, entities=mvappend(ucast(map_get(input_event, "dest_user_id"), "string", null), ucast(map_get(input_event, "dest_device_id"), "string", null)), body=create_map(["event_id", event_id, "cmd_line", cmd_line, "process_name", process_name, "parent_process_name", parent_process_name, "process_path", process_path]) | into write_ssa_detected_events();'
<li><a href="#">search: '| from read_ssa_enriched_events() | eval timestamp=parse_long(ucast(map_get(input_event, "_time"), "string", null)), cmd_line=lower(ucast(map_get(input_event, "process"), "string", null)), process_name=lower(ucast(map_get(input_event, "process_name"), "string", null)), process_path=ucast(map_get(input_event, "process_path"), "string", null), parent_process_name=ucast(map_get(input_event, "parent_process_name"), "string", null), event_id=ucast(map_get(input_event, "event_id"), "string", null) | where cmd_line is not null and process_name is not null and process_name="bcdedit.exe" and (like (cmd_line, "%recoveryenabled%") and like (cmd_line, "%no%")) | eval start_time=timestamp, end_time=timestamp, entities=mvappend(ucast(map_get(input_event, "dest_user_id"), "string", null), ucast(map_get(input_event, "dest_device_id"), "string", null)), body=create_map(["event_id", event_id, "cmd_line", cmd_line, "process_name", process_name, "parent_process_name", parent_process_name, "process_path", process_path]) | into write_ssa_detected_events();'
<li><a href="#">search: '| from read_ssa_enriched_events() | eval timestamp=parse_long(ucast(map_get(input_event, "_time"), "string", null)), cmd_line=lower(ucast(map_get(input_event, "process"), "string", null)), process_name=lower(ucast(map_get(input_event, "process_name"), "string", null)), process_path=ucast(map_get(input_event, "process_path"), "string", null), parent_process_name=ucast(map_get(input_event, "parent_process_name"), "string", null), event_id=ucast(map_get(input_event, "event_id"), "string", null) | where cmd_line is not null and process_name is not null and process_name="fsutil.exe" and (like (cmd_line, "%setzerodata%")) | eval start_time=timestamp, end_time=timestamp, entities=mvappend(ucast(map_get(input_event, "dest_user_id"), "string", null), ucast(map_get(input_event, "dest_device_id"), "string", null)), body=create_map(["event_id", event_id, "cmd_line", cmd_line, "process_name", process_name, "parent_process_name", parent_process_name, "process_path", process_path]) | into write_ssa_detected_events();'
<li><a href="#">search: '| from read_ssa_enriched_events() | eval timestamp=parse_long(ucast(map_get(input_event, "_time"), "string", null)), cmd_line=lower(ucast(map_get(input_event, "process"), "string", null)), process_name=lower(ucast(map_get(input_event, "process_name"), "string", null)), process_path=ucast(map_get(input_event, "process_path"), "string", null), parent_process_name=ucast(map_get(input_event, "parent_process_name"), "string", null), event_id=ucast(map_get(input_event, "event_id"), "string", null) | where cmd_line is not null and process_name is not null and process_name="hh.exe" and (like (cmd_line, "%") or like (cmd_line, "%"))| eval start_time=timestamp, end_time=timestamp, entities=mvappend(ucast(map_get(input_event, "dest_user_id"), "string", null), ucast(map_get(input_event, "dest_device_id"), "string", null)), body=create_map(["event_id", event_id, "cmd_line", cmd_line, "process_name", process_name, "parent_process_name", parent_process_name, "process_path", process_path]) | into write_ssa_detected_events();'
<li><a href="#">search: '| from read_ssa_enriched_events() | eval timestamp=parse_long(ucast(map_get(input_event, "_time"), "string", null)), cmd_line=lower(ucast(map_get(input_event, "process"), "string", null)), process_name=lower(ucast(map_get(input_event, "process_name"), "string", null)), process_path=ucast(map_get(input_event, "process_path"), "string", null), parent_process_name=ucast(map_get(input_event, "parent_process_name"), "string", null), event_id=ucast(map_get(input_event, "event_id"), "string", null) | where cmd_line is not null and process_name is not null and process_name="hh.exe" and (like (cmd_line, "%its:%") or like (cmd_line, "%mk:@msitstore:%"))| eval start_time=timestamp, end_time=timestamp, entities=mvappend(ucast(map_get(input_event, "dest_user_id"), "string", null), ucast(map_get(input_event, "dest_device_id"), "string", null)), body=create_map(["event_id", event_id, "cmd_line", cmd_line, "process_name", process_name, "parent_process_name", parent_process_name, "process_path", process_path]) | into write_ssa_detected_events();'
<li><a href="#">search: '| from read_ssa_enriched_events() | eval timestamp=parse_long(ucast(map_get(input_event, "_time"), "string", null)), cmd_line=lower(ucast(map_get(input_event, "process"), "string", null)), process_name=lower(ucast(map_get(input_event, "process_name"), "string", null)), process_path=ucast(map_get(input_event, "process_path"), "string", null), parent_process_name=ucast(map_get(input_event, "parent_process_name"), "string", null), event_id=ucast(map_get(input_event, "event_id"), "string", null) | where cmd_line is not null and process_name is not null and process_name="hh.exe" and like (cmd_line, "%-decompile%")| eval start_time=timestamp, end_time=timestamp, entities=mvappend(ucast(map_get(input_event, "dest_user_id"), "string", null), ucast(map_get(input_event, "dest_device_id"), "string", null)), body=create_map(["event_id", event_id, "cmd_line", cmd_line, "process_name", process_name, "parent_process_name", parent_process_name, "process_path", process_path]) | into write_ssa_detected_events();'
<li><a href="#">search: '| from read_ssa_enriched_events() | eval timestamp=parse_long(ucast(map_get(input_event, "_time"), "string", null)), cmd_line=lower(ucast(map_get(input_event, "process"), "string", null)), process_name=lower(ucast(map_get(input_event, "process_name"), "string", null)), process_path=ucast(map_get(input_event, "process_path"), "string", null), parent_process_name=ucast(map_get(input_event, "parent_process_name"), "string", null), event_id=ucast(map_get(input_event, "event_id"), "string", null) | where cmd_line is not null and process_name is not null and process_name="msdt.exe" and (like (cmd_line, "%msdt%") or like (cmd_line, "%ms-msdt:%") or like (cmd_line, "%ms-msdt:/id%") or like (cmd_line, "%ms-msdt:-id%") or like (cmd_line, "%ms-msdt:/id%")) and (like (cmd_line, "%it_browseforfile=%") or like (cmd_line, "%it_rebrowseforfile=%") or like (cmd_line, "%.xml%")) and like (cmd_line, "%pcwdiagnostic%") | eval start_time=timestamp, end_time=timestamp, entities=mvappend(ucast(map_get(input_event, "dest_user_id"), "string", null), ucast(map_get(input_event, "dest_device_id"), "string", null)), body=create_map(["event_id", event_id, "cmd_line", cmd_line, "process_name", process_name, "parent_process_name", parent_process_name, "process_path", process_path]) | into write_ssa_detected_events();'
<li><a href="#">search: '| from read_ssa_enriched_events() | eval timestamp=parse_long(ucast(map_get(input_event, "_time"), "string", null)), cmd_line=lower(ucast(map_get(input_event, "process"), "string", null)), process_name=lower(ucast(map_get(input_event, "process_name"), "string", null)), process_path=ucast(map_get(input_event, "process_path"), "string", null), parent_process_name=ucast(map_get(input_event, "parent_process_name"), "string", null), event_id=ucast(map_get(input_event, "event_id"), "string", null) | where cmd_line is not null and process_name is not null and process_name="msiexec.exe" and (like (cmd_line, "%") or like (cmd_line, "%")) | eval start_time=timestamp, end_time=timestamp, entities=mvappend(ucast(map_get(input_event, "dest_user_id"), "string", null), ucast(map_get(input_event, "dest_device_id"), "string", null)), body=create_map(["event_id", event_id, "cmd_line", cmd_line, "process_name", process_name, "parent_process_name", parent_process_name, "process_path", process_path]) | into write_ssa_detected_events();'
<li><a href="#">search: '| from read_ssa_enriched_events() | eval timestamp=parse_long(ucast(map_get(input_event, "_time"), "string", null)), cmd_line=lower(ucast(map_get(input_event, "process"), "string", null)), process_name=lower(ucast(map_get(input_event, "process_name"), "string", null)), process_path=ucast(map_get(input_event, "process_path"), "string", null), parent_process_name=ucast(map_get(input_event, "parent_process_name"), "string", null), event_id=ucast(map_get(input_event, "event_id"), "string", null) | where cmd_line is not null and process_name is not null and process_name="msiexec.exe" and (like (cmd_line, "%/y %") or like (cmd_line, "%-y %")) | eval start_time=timestamp, end_time=timestamp, entities=mvappend(ucast(map_get(input_event, "dest_user_id"), "string", null), ucast(map_get(input_event, "dest_device_id"), "string", null)), body=create_map(["event_id", event_id, "cmd_line", cmd_line, "process_name", process_name, "parent_process_name", parent_process_name, "process_path", process_path]) | into write_ssa_detected_events();'
<li><a href="#">search: '| from read_ssa_enriched_events() | eval timestamp=parse_long(ucast(map_get(input_event, "_time"), "string", null)), cmd_line=lower(ucast(map_get(input_event, "process"), "string", null)), process_name=lower(ucast(map_get(input_event, "process_name"), "string", null)), process_path=ucast(map_get(input_event, "process_path"), "string", null), parent_process_name=ucast(map_get(input_event, "parent_process_name"), "string", null), event_id=ucast(map_get(input_event, "event_id"), "string", null) | where cmd_line is not null and process_name is not null and process_name="msiexec.exe" and (like (cmd_line, "%/z %") or like (cmd_line, "%-z %")) | eval start_time=timestamp, end_time=timestamp, entities=mvappend(ucast(map_get(input_event, "dest_user_id"), "string", null), ucast(map_get(input_event, "dest_device_id"), "string", null)), body=create_map(["event_id", event_id, "cmd_line", cmd_line, "process_name", process_name, "parent_process_name", parent_process_name, "process_path", process_path]) | into write_ssa_detected_events();'
<li><a href="#">search: '| from read_ssa_enriched_events() | eval timestamp=parse_long(ucast(map_get(input_event, "_time"), "string", null)), cmd_line=lower(ucast(map_get(input_event, "process"), "string", null)), process_name=lower(ucast(map_get(input_event, "process_name"), "string", null)), process_path=ucast(map_get(input_event, "process_path"), "string", null), parent_process_name=ucast(map_get(input_event, "parent_process_name"), "string", null), event_id=ucast(map_get(input_event, "event_id"), "string", null) | where cmd_line is not null and process_name is not null and process_name="ntdsutil.exe" and (like (cmd_line, "%ntds%") and like (cmd_line, "%create%")) | eval start_time=timestamp, end_time=timestamp, entities=mvappend(ucast(map_get(input_event, "dest_user_id"), "string", null), ucast(map_get(input_event, "dest_device_id"), "string", null)), body=create_map(["event_id", event_id, "cmd_line", cmd_line, "process_name", process_name, "parent_process_name", parent_process_name, "process_path", process_path]) | into write_ssa_detected_events();'
<li><a href="#">search: '| from read_ssa_enriched_events() | eval timestamp=parse_long(ucast(map_get(input_event, "_time"), "string", null)), cmd_line=lower(ucast(map_get(input_event, "process"), "string", null)), process_name=lower(ucast(map_get(input_event, "process_name"), "string", null)), process_path=ucast(map_get(input_event, "process_path"), "string", null), parent_process_name=ucast(map_get(input_event, "parent_process_name"), "string", null), event_id=ucast(map_get(input_event, "event_id"), "string", null) | where cmd_line is not null and process_name is not null and process_name="odbcconf.exe" and (like (cmd_line, "%-f %") or like (cmd_line, "%/f %")) and like (cmd_line, "%.rsp%") | eval start_time=timestamp, end_time=timestamp, entities=mvappend(ucast(map_get(input_event, "dest_user_id"), "string", null), ucast(map_get(input_event, "dest_device_id"), "string", null)), body=create_map(["event_id", event_id, "cmd_line", cmd_line, "process_name", process_name, "parent_process_name", parent_process_name, "process_path", process_path]) | into write_ssa_detected_events();'
<li><a href="#">search: '| from read_ssa_enriched_events() | eval timestamp=parse_long(ucast(map_get(input_event, "_time"), "string", null)), cmd_line=ucast(map_get(input_event, "process"), "string", null), process_name=ucast(map_get(input_event, "process_name"), "string", null), process_path=ucast(map_get(input_event, "process_path"), "string", null), parent_process_name=ucast(map_get(input_event, "parent_process_name"), "string", null), event_id=ucast(map_get(input_event, "event_id"), "string", null) | where cmd_line is not null and match_regex(cmd_line, /(?i)deny/)=true and (process_name="cacls.exe" or process_name="xcacls.exe" or process_name="icacls.exe") | eval start_time=timestamp, end_time=timestamp, entities=mvappend(ucast(map_get(input_event, "dest_user_id"), "string", null), ucast(map_get(input_event, "dest_device_id"), "string", null)), body=create_map(["event_id", event_id, "cmd_line", cmd_line, "process_name", process_name, "parent_process_name", parent_process_name, "process_path", process_path]) | into write_ssa_detected_events();'
<li><a href="#">search: '| from read_ssa_enriched_events() | eval timestamp=parse_long(ucast(map_get(input_event, "_time"), "string", null)), cmd_line=ucast(map_get(input_event, "process"), "string", null), process_name=ucast(map_get(input_event, "process_name"), "string", null), process_path=ucast(map_get(input_event, "process_path"), "string", null), parent_process_name=ucast(map_get(input_event, "parent_process_name"), "string", null), event_id=ucast(map_get(input_event, "event_id"), "string", null) | where cmd_line is not null and match_regex(cmd_line, /(?i)grant/)=true and (process_name="cacls.exe" or process_name="xcacls.exe" or process_name="icacls.exe") | eval start_time=timestamp, end_time=timestamp, entities=mvappend(ucast(map_get(input_event, "dest_user_id"), "string", null), ucast(map_get(input_event, "dest_device_id"), "string", null)), body=create_map(["event_id", event_id, "cmd_line", cmd_line, "process_name", process_name, "parent_process_name", parent_process_name, "process_path", process_path]) | into write_ssa_detected_events();'
<li><a href="#">search: '| from read_ssa_enriched_events() | eval timestamp=parse_long(ucast(map_get(input_event, "_time"), "string", null)), dest_port=map_get(input_event, "dest_port"), event_id=ucast(map_get(input_event, "event_id"), "string", null), dest_ip=ucast(map_get(input_event, "dest_device_ips"), "collection<string>", [])[0] | where dest_port=389 or dest_port=1389 or dest_port=636 | where not (cidrmatch(ip: dest_ip, cidr_range: "10.0.0.0/8") or cidrmatch(ip: dest_ip, cidr_range: "192.168.0.0/16") or cidrmatch(ip: dest_ip, cidr_range: "172.16.0.0/12")) | eval start_time=timestamp, end_time=timestamp, entities=mvappend(ucast(map_get(input_event, "dest_user_id"), "string", null), ucast(map_get(input_event, "dest_device_id"), "string", null)), body=create_map(["event_id", event_id, "dest_port", dest_port, "dest_ip", dest_ip]) | into write_ssa_detected_events();'
<li><a href="#">search: '| from read_ssa_enriched_events() | eval timestamp=parse_long(ucast(map_get(input_event, "_time"), "string", null)), process=lower(ucast(map_get(input_event, "process"), "string", null)), process_name=lower(ucast(map_get(input_event, "process_name"), "string", null)), process_path=ucast(map_get(input_event, "process_path"), "string", null), parent_process_name=ucast(map_get(input_event, "parent_process_name"), "string", null), event_id=ucast(map_get(input_event, "event_id"), "string", null) | where process is not null and process_name is not null | where process_name="pwsh.exe" or process_name="pwsh.exe" or process_name="sqlps.exe" or process_name="sqltoolsps.exe" or process_name="powershell.exe" or process_name="powershell_ise.exe" | where match_regex(process, /(?i)[\-|\/]w(in*d*o*w*s*t*y*l*e*)*\s+[^-]/)=true | eval start_time=timestamp, end_time=timestamp, entities=mvappend(ucast(map_get(input_event, "dest_user_id"), "string", null), ucast(map_get(input_event, "dest_device_id"), "string", null)), body=create_map(["event_id", event_id, "process", process, "process_name", process_name, "parent_process_name", parent_process_name, "process_path", process_path]) | into write_ssa_detected_events();'
<li><a href="#">search: '| from read_ssa_enriched_events() | eval timestamp=parse_long(ucast(map_get(input_event, "_time"), "string", null)), process=lower(ucast(map_get(input_event, "process"), "string", null)), process_name=lower(ucast(map_get(input_event, "process_name"), "string", null)), process_path=ucast(map_get(input_event, "process_path"), "string",null), parent_process_name=ucast(map_get(input_event, "parent_process_name"), "string",null), event_id=ucast(map_get(input_event, "event_id"), "string", null) | where process is not null and like(process, "%/delete%") and like(process, "%user%") and (process_name="net1.exe" or process_name="net.exe") | eval start_time=timestamp, end_time=timestamp, entities=mvappend(ucast(map_get(input_event, "dest_user_id"), "string", null), ucast(map_get(input_event, "dest_device_id"), "string", null)), body=create_map(["event_id", event_id, "process", process, "process_name", process_name, "parent_process_name", parent_process_name, "process_path", process_path]) | into write_ssa_detected_events();'
<li><a href="#">search: '| from read_ssa_enriched_events() | eval timestamp=parse_long(ucast(map_get(input_event, "_time"), "string", null)), process=ucast(map_get(input_event, "process"), "string", null), process_name=ucast(map_get(input_event, "process_name"), "string", null), process_path=ucast(map_get(input_event, "process_path"), "string", null), parent_process_name=ucast(map_get(input_event, "parent_process_name"), "string", null), event_id=ucast(map_get(input_event, "event_id"), "string", null) | where process is not null and not like(process, "%:\\windows\\qg\\servicenow%") and like(process, "%/g%") | where (match_regex(process, /(?i)everyone:/)=true or match_regex(process, /(?i)system:/)=true or match_regex(process, /(?i)s-1-1-0:/)=true) | where (process_name="cacls.exe" or process_name="xcacls.exe" or process_name="icacls.exe") | eval start_time=timestamp, end_time=timestamp, entities=mvappend(ucast(map_get(input_event, "dest_user_id"), "string", null), ucast(map_get(input_event, "dest_device_id"), "string", null)), body=create_map(["event_id", event_id, "process", process, "process_name", process_name, "parent_process_name", parent_process_name, "process_path", process_path]) | into write_ssa_detected_events();'
<li><a href="#">search: '| from read_ssa_enriched_events() | eval timestamp=parse_long(ucast(map_get(input_event,"_time"), "string", null)), cmd_line=lower(ucast(map_get(input_event, "process"), "string", null)), process_name=lower(ucast(map_get(input_event, "process_name"), "string", null)), process_path=ucast(map_get(input_event, "process_path"), "string", null), parent_process_name=ucast(map_get(input_event, "parent_process_name"), "string", null), parent_cmd_line=ucast(map_get(input_event, "parent_process"), "string", null), event_id=ucast(map_get(input_event, "event_id"), "string", null) | where cmd_line is not null and process_name is not null and like(process_name, "%sdelete%") and (like (cmd_line, "%-c %") or like (cmd_line, "%-f %")or like (cmd_line, "%-p %") or like (cmd_line, "%-r %") or like (cmd_line, "%-q %") or like (cmd_line, "%-s %") or like (cmd_line, "%-z %") or like (cmd_line, "%/accepteula%") or like (cmd_line, "%-nobanner%")or like (cmd_line, "%.doc%")or like (cmd_line, "%.xls%") or like (cmd_line, "%.ppt%")or like (cmd_line, "%.rtf%") or like (cmd_line, "%.pdf%") or like (cmd_line, "%.key%")or like (cmd_line, "%.log%") or like (cmd_line, "%.txt%") or like (cmd_line, "%.jpg%") or like (cmd_line, "%.png%") or like (cmd_line, "%.gif%") or like (cmd_line, "%.bmp%") or like (cmd_line, "%.7z%") or like (cmd_line, "%.zip%") or like (cmd_line, "%.rar%") or like (cmd_line, "%.tar%") or like (cmd_line, "%.gz%") or like (cmd_line, "%.xls%")) | eval start_time=timestamp, end_time=timestamp, entities=mvappend(ucast(map_get(input_event, "dest_user_id"), "string", null), ucast(map_get(input_event, "dest_device_id"), "string", null)), body=create_map(["event_id", event_id, "cmd_line", cmd_line, "process_name", process_name, "process_path", process_path, "parent_process_name", parent_process_name, "parent_cmd_line", parent_cmd_line]) | into write_ssa_detected_events();'
<li><a href="#">search: '| from read_ssa_enriched_events() | eval timestamp=parse_long(ucast(map_get(input_event,"_time"), "string", null)), process=lower(ucast(map_get(input_event, "process"), "string", null)), process_name=lower(ucast(map_get(input_event, "process_name"), "string", null)), process_path=ucast(map_get(input_event, "process_path"), "string", null), parent_process_name=ucast(map_get(input_event, "parent_process_name"), "string", null), parent_process=ucast(map_get(input_event, "parent_process"), "string", null), event_id=ucast(map_get(input_event, "event_id"), "string", null) | where process_name is not null and parent_process_name is not null | where like(process_name, "7z%") or process_name="winrar.exe" or like(process_name, "winzip%") | where like(parent_process_name, "%cmd.exe") or like(parent_process_name, "%powershell.exe") | eval start_time=timestamp, end_time=timestamp, entities=mvappend(ucast(map_get(input_event, "dest_user_id"), "string", null), ucast(map_get(input_event, "dest_device_id"), "string", null)), body=create_map(["event_id", event_id, "process_name", process_name, "parent_process_name", parent_process_name, "process_path", process_path]) | into write_ssa_detected_events();'
<li><a href="#">search: '| from read_ssa_enriched_events() | eval timestamp=parse_long(ucast(map_get(input_event,"_time"), "string", null)), registry_path=lower(ucast(map_get(input_event, "registry_path"), "string", null)), registry_key_name=lower(ucast(map_get(input_event, "registry_key_name"), "string", null)), registry_value_data=ucast(map_get(input_event, "registry_value_data"), "string", null), process_guid=ucast(map_get(input_event, "process_guid"), "string", null), event_id=ucast(map_get(input_event, "event_id"), "string", null) | where like(registry_path, "%\\policies\\microsoft\\windows defender%") and registry_key_name="disableantivirus" and registry_value_data="(0x00000001)" | eval start_time=timestamp, end_time=timestamp, entities=mvappend(ucast(map_get(input_event, "dest_user_id"), "string", null), ucast(map_get(input_event, "dest_device_id"), "string", null)), body=create_map( [ "event_id", event_id, "registry_path", registry_path, "registry_key_name", registry_key_name, "process_guid", process_guid,"registry_value_data",registry_value_data]) | into write_ssa_detected_events();'
<li><a href="#">search: '| from read_ssa_enriched_events() | where "authentication" in(_datamodels) | eval timestamp=parse_long(ucast(map_get(input_event, "_time"), "string", null)), dest_user= lower(ucast(map_get(input_event, "dest_user_primary_artifact"), "string", null)), dest_user_id= ucast(map_get(input_event, "dest_user_id"), "string", null), origin_device_id= ucast(map_get(input_event, "origin_device_id"), "string", null), signature_id= lower(ucast(map_get(input_event, "signature_id"), "string", null)), authentication_method= lower(ucast(map_get(input_event, "authentication_method"), "string", null)), event_id=ucast(map_get(input_event, "event_id"), "string", null) | where signature_id = "4624" and (authentication_method="ntlmssp" or authentication_method="kerberos") and dest_user_id != null and origin_device_id != null | eval iskerberos=if(authentication_method == "kerberos", 1, 0), isntlm=if(authentication_method == "ntlmssp", 1, 0), timentlm=if(isntlm > 0, timestamp, null) | stats sum(iskerberos) as totalkerberos, sum(isntlm) as totalntlm, min(timestamp) as starttime, min(timentlm) as startntlmtime, max(timestamp) as endtime, max(timentlm) as endntlmtime by dest_user_id, dest_user, origin_device_id, span(timestamp, 86400s) | where not dest_user="-" and totalkerberos > 0 and totalntlm > 0 and endtime - starttime > 1800000 and (totalkerberos > 10 * totalntlm and totalkerberos > 50) and (endtime - starttime) > 3 * (endntlmtime - startntlmtime) | eval start_time=startntlmtime, end_time=endntlmtime, entities=mvappend(dest_user_id, origin_device_id), body=create_map(["event_id", event_id, "total_kerberos", totalkerberos, "total_ntlm", totalntlm, "analysis_start_time", starttime, "analysis_end_time", endtime, "detection_start_time", startntlmtime, "detection_end_time", endntlmtime]) | into write_ssa_detected_events();'
<li><a href="#">search: '| from read_ssa_enriched_events() | where "authentication" in(_datamodels) | eval timestamp=parse_long(ucast(map_get(input_event, "_time"), "string", null)), dest_user=lower(ucast(map_get(input_event, "dest_user_primary_artifact"), "string", null)), dest_user_id= ucast(map_get(input_event, "dest_user_id"), "string", null), dest_device_id= ucast(map_get(input_event, "dest_device_id"), "string", null), signature_id= lower(ucast(map_get(input_event, "signature_id"), "string", null)), authentication_method= lower(ucast(map_get(input_event, "authentication_method"), "string", null)), event_id=ucast(map_get(input_event, "event_id"), "string", null) | where signature_id = "4624" and (authentication_method="ntlmssp" or authentication_method="kerberos") and dest_user_id != null and dest_device_id != null | eval iskerberos=if(authentication_method == "kerberos", 1, 0), isntlm=if(authentication_method == "ntlmssp", 1, 0), timentlm=if(isntlm > 0, timestamp, null) | stats sum(iskerberos) as totalkerberos, sum(isntlm) as totalntlm, min(timestamp) as starttime, min(timentlm) as startntlmtime, max(timestamp) as endtime, max(timentlm) as endntlmtime by dest_user_id, dest_user, dest_device_id, span(timestamp, 86400s) | where not dest_user="-" and totalkerberos > 0 and totalntlm > 0 and endtime - starttime > 1800000 and (totalkerberos > 10 * totalntlm and totalkerberos > 50) and (endtime - starttime) > 3 * (endntlmtime - startntlmtime) | eval start_time=ucast(startntlmtime, "long", null), end_time=ucast(endntlmtime, "long", null), entities=mvappend(dest_user_id, dest_device_id), body=create_map(["event_id", event_id, "total_kerberos", totalkerberos, "total_ntlm", totalntlm, "analysis_start_time", starttime, "analysis_end_time", endtime, "pth_start_time", startntlmtime, "pth_end_time", endntlmtime]) | into write_ssa_detected_events();'
<li><a href="#">search: '| from read_ssa_enriched_events() | where "endpoint_processes" in(_datamodels) | eval timestamp=parse_long(ucast(map_get(input_event, "_time"), "string", null)), cmd_line=lower(ucast(map_get(input_event, "process"), "string", null)), process_name=lower(ucast(map_get(input_event, "process_name"), "string", null)), process_path=ucast(map_get(input_event, "process_path"), "string", null), parent_process_name=ucast(map_get(input_event, "parent_process_name"), "string", null), event_id=ucast(map_get(input_event, "event_id"), "string", null) | where cmd_line is not null and process_name is not null and process_name="diskshadow.exe" and (like (cmd_line, "%-s%") or like (cmd_line, "%/s%")) | eval start_time=timestamp, end_time=timestamp, entities=mvappend(ucast(map_get(input_event, "dest_user_id"), "string", null), ucast(map_get(input_event, "dest_device_id"), "string", null)) | eval body=create_map(["event_id", event_id, "cmd_line", cmd_line, "process_name", process_name, "parent_process_name", parent_process_name, "process_path", process_path]) | into write_ssa_detected_events();'
<li><a href="#">search: '| from read_ssa_enriched_events() | where "endpoint_processes" in(_datamodels) | eval timestamp=parse_long(ucast(map_get(input_event, "_time"), "string", null)), cmd_line=lower(ucast(map_get(input_event, "process"), "string", null)), process_name=ucast(map_get(input_event, "process_name"), "string", null), process_path=ucast(map_get(input_event, "process_path"), "string", null), parent_process_name=ucast(map_get(input_event, "parent_process_name"), "string", null), event_id=ucast(map_get(input_event, "event_id"), "string", null) | where cmd_line is not null and process_name is not null and process_name="reg.exe" and like (cmd_line, "%inprocserver32%") | eval start_time=timestamp, end_time=timestamp, entities=mvappend(ucast(map_get(input_event, "dest_user_id"), "string", null), ucast(map_get(input_event, "dest_device_id"), "string", null)) | eval body=create_map(["event_id", event_id, "cmd_line", cmd_line, "process_name", process_name, "parent_process_name", parent_process_name, "process_path", process_path]) | into write_ssa_detected_events();'
<li><a href="#">search: '| from read_ssa_enriched_events() | where "endpoint_processes" in(_datamodels) | eval timestamp=parse_long(ucast(map_get(input_event, "_time"), "string", null)), cmd_line=ucast(map_get(input_event, "process"), "string", null), process_name=ucast(map_get(input_event, "process_name"), "string", null), process_path=ucast(map_get(input_event, "process_path"), "string", null), parent_process_name=ucast(map_get(input_event, "parent_process_name"), "string", null), event_id=ucast(map_get(input_event, "event_id"), "string", null) | where cmd_line is not null and like(cmd_line, "% cl %") and (match_regex(cmd_line, /(?i)security/)=true or match_regex(cmd_line, /(?i)system/)=true or match_regex(cmd_line, /(?i)sysmon/)=true or match_regex(cmd_line, /(?i)application/)=true or match_regex(cmd_line, /(?i)setup/)=true or match_regex(cmd_line, /(?i)powershell/)=true) and process_name="wevtutil.exe" | eval start_time=timestamp, end_time=timestamp, entities=mvappend(ucast(map_get(input_event, "dest_user_id"), "string", null), ucast(map_get(input_event, "dest_device_id"), "string", null)) | eval body=create_map(["event_id", event_id, "cmd_line", cmd_line, "process_name", process_name, "parent_process_name", parent_process_name, "process_path", process_path]) | into write_ssa_detected_events();'
<li><a href="#">search: '| from read_ssa_enriched_events() | where "endpoint_processes" in(_datamodels) | eval timestamp=parse_long(ucast(map_get(input_event, "_time"), "string", null)), cmd_line=ucast(map_get(input_event, "process"), "string", null), process_name=ucast(map_get(input_event, "process_name"), "string", null), process_path=ucast(map_get(input_event, "process_path"), "string", null), parent_process_name=ucast(map_get(input_event, "parent_process_name"), "string", null), event_id=ucast(map_get(input_event, "event_id"), "string", null) | where cmd_line is not null and like(cmd_line, "% sl %") and like(cmd_line, "%/e:false%") and process_name="wevtutil.exe" | eval start_time=timestamp, end_time=timestamp, entities=mvappend(ucast(map_get(input_event, "dest_user_id"), "string", null), ucast(map_get(input_event, "dest_device_id"), "string", null)) | eval body=create_map(["event_id", event_id, "cmd_line", cmd_line, "process_name", process_name, "parent_process_name", parent_process_name, "process_path", process_path]) | into write_ssa_detected_events();'
<li><a href="#">search: '| from read_ssa_enriched_events() | where "endpoint_processes" in(_datamodels) | eval timestamp=parse_long(ucast(map_get(input_event, "_time"), "string", null)), cmd_line=ucast(map_get(input_event, "process"), "string", null), process_name=ucast(map_get(input_event, "process_name"), "string", null), process_path=ucast(map_get(input_event, "process_path"), "string", null), parent_process_name=ucast(map_get(input_event, "parent_process_name"), "string", null), event_id=ucast(map_get(input_event, "event_id"), "string", null) | where cmd_line is not null and process_name is not null and process_name="bitsadmin.exe" and (like (cmd_line, "%create%") or like (cmd_line, "%addfile%")or like (cmd_line, "%setnotifyflags%") or like (cmd_line, "%setnotifycmdline%") or like (cmd_line, "%setminretrydelay%") or like (cmd_line, "%setcustomheaders%") or like (cmd_line, "%resume%")) | eval start_time=timestamp, end_time=timestamp, entities=mvappend(ucast(map_get(input_event, "dest_user_id"), "string", null), ucast(map_get(input_event, "dest_device_id"), "string", null)) | eval body=create_map(["event_id", event_id, "cmd_line", cmd_line, "process_name", process_name, "parent_process_name", parent_process_name, "process_path", process_path]) | into write_ssa_detected_events();'
<li><a href="#">search: '| from read_ssa_enriched_events() | where "endpoint_processes" in(_datamodels) | eval timestamp=parse_long(ucast(map_get(input_event, "_time"), "string", null)), cmd_line=ucast(map_get(input_event, "process"), "string", null), process_name=ucast(map_get(input_event, "process_name"), "string", null), process_path=ucast(map_get(input_event, "process_path"), "string", null), parent_process_name=ucast(map_get(input_event, "parent_process_name"), "string", null), event_id=ucast(map_get(input_event, "event_id"), "string", null) | where cmd_line is not null and process_name is not null and process_name="bitsadmin.exe" and (like (cmd_line, "%transfer%")) | eval start_time=timestamp, end_time=timestamp, entities=mvappend(ucast(map_get(input_event, "dest_user_id"), "string", null), ucast(map_get(input_event, "dest_device_id"), "string", null)) | eval body=create_map(["event_id", event_id, "cmd_line", cmd_line, "process_name", process_name, "parent_process_name", parent_process_name, "process_path", process_path]) | into write_ssa_detected_events();'
<li><a href="#">search: '| from read_ssa_enriched_events() | where "endpoint_processes" in(_datamodels) | eval timestamp=parse_long(ucast(map_get(input_event, "_time"), "string", null)), cmd_line=ucast(map_get(input_event, "process"), "string", null), process_name=ucast(map_get(input_event, "process_name"), "string", null), process_path=ucast(map_get(input_event, "process_path"), "string", null), parent_process_name=ucast(map_get(input_event, "parent_process_name"), "string", null), event_id=ucast(map_get(input_event, "event_id"), "string", null) | where cmd_line is not null and process_name is not null and process_name="certutil.exe" and (like (cmd_line, "%decode%")) | eval start_time=timestamp, end_time=timestamp, entities=mvappend(ucast(map_get(input_event, "dest_user_id"), "string", null), ucast(map_get(input_event, "dest_device_id"), "string", null)) | eval body=create_map(["event_id", event_id, "cmd_line", cmd_line, "process_name", process_name, "parent_process_name", parent_process_name, "process_path", process_path]) | into write_ssa_detected_events();'
<li><a href="#">search: '| from read_ssa_enriched_events() | where "endpoint_processes" in(_datamodels) | eval timestamp=parse_long(ucast(map_get(input_event, "_time"), "string", null)), cmd_line=ucast(map_get(input_event, "process"), "string", null), process_name=ucast(map_get(input_event, "process_name"), "string", null), process_path=ucast(map_get(input_event, "process_path"), "string", null), parent_process_name=ucast(map_get(input_event, "parent_process_name"), "string", null), event_id=ucast(map_get(input_event, "event_id"), "string", null) | where cmd_line is not null and process_name is not null and process_name="certutil.exe" and (like (cmd_line, "%urlcache%") and like (cmd_line, "%split%")) or (like (cmd_line, "%urlcache%")) | eval start_time=timestamp, end_time=timestamp, entities=mvappend(ucast(map_get(input_event, "dest_user_id"), "string", null), ucast(map_get(input_event, "dest_device_id"), "string", null)) | eval body=create_map(["event_id", event_id, "cmd_line", cmd_line, "process_name", process_name, "parent_process_name", parent_process_name, "process_path", process_path]) | into write_ssa_detected_events();'
<li><a href="#">search: '| from read_ssa_enriched_events() | where "endpoint_processes" in(_datamodels) | eval timestamp=parse_long(ucast(map_get(input_event, "_time"), "string", null)), cmd_line=ucast(map_get(input_event, "process"), "string", null), process_name=ucast(map_get(input_event, "process_name"), "string", null), process_path=ucast(map_get(input_event, "process_path"), "string", null), parent_process_name=ucast(map_get(input_event, "parent_process_name"), "string", null), event_id=ucast(map_get(input_event, "event_id"), "string", null) | where cmd_line is not null and process_name is not null and process_name="certutil.exe" and (like (cmd_line, "%verifyctl%") and like (cmd_line, "%split%")) or (like (cmd_line, "%verifyctl%")) | eval start_time=timestamp, end_time=timestamp, entities=mvappend(ucast(map_get(input_event, "dest_user_id"), "string", null), ucast(map_get(input_event, "dest_device_id"), "string", null)) | eval body=create_map(["event_id", event_id, "cmd_line", cmd_line, "process_name", process_name, "parent_process_name", parent_process_name, "process_path", process_path]) | into write_ssa_detected_events();'
<li><a href="#">search: '| from read_ssa_enriched_events() | where "endpoint_processes" in(_datamodels) | eval timestamp=parse_long(ucast(map_get(input_event, "_time"), "string", null)), cmd_line=ucast(map_get(input_event, "process"), "string", null), process_name=ucast(map_get(input_event, "process_name"), "string", null), process_path=ucast(map_get(input_event, "process_path"), "string", null), parent_process_name=ucast(map_get(input_event, "parent_process_name"), "string", null), event_id=ucast(map_get(input_event, "event_id"), "string", null) | where cmd_line is not null and process_name is not null and process_name="curl.exe" and (like (cmd_line, "%-t %") or like (cmd_line, "%--upload-file %")or like (cmd_line, "%-d %") or like (cmd_line, "%--data %") or like (cmd_line, "%-f %")) | eval start_time=timestamp, end_time=timestamp, entities=mvappend(ucast(map_get(input_event, "dest_user_id"), "string", null), ucast(map_get(input_event, "dest_device_id"), "string", null)) | eval body=create_map(["event_id", event_id, "cmd_line", cmd_line, "process_name", process_name, "parent_process_name", parent_process_name, "process_path", process_path]) | into write_ssa_detected_events();'
<li><a href="#">search: '| from read_ssa_enriched_events() | where "endpoint_processes" in(_datamodels) | eval timestamp=parse_long(ucast(map_get(input_event, "_time"), "string", null)), cmd_line=ucast(map_get(input_event, "process"), "string", null), process_name=ucast(map_get(input_event, "process_name"), "string", null), process_path=ucast(map_get(input_event, "process_path"), "string", null), parent_process_name=ucast(map_get(input_event, "parent_process_name"), "string", null), event_id=ucast(map_get(input_event, "event_id"), "string", null) | where cmd_line is not null and process_name is not null and process_name="nslookup.exe" and (like (cmd_line, "%-querytype=%") or like (cmd_line, "%-qt=%") or like (cmd_line, "%-q=%") or like (cmd_line, "%-type=%") or like (cmd_line, "%-retry=%")) | eval start_time=timestamp, end_time=timestamp, entities=mvappend(ucast(map_get(input_event, "dest_user_id"), "string", null), ucast(map_get(input_event, "dest_device_id"), "string", null)) | eval body=create_map(["event_id", event_id, "cmd_line", cmd_line, "process_name", process_name, "parent_process_name", parent_process_name, "process_path", process_path]) | into write_ssa_detected_events();'
<li><a href="#">search: '| from read_ssa_enriched_events() | where "endpoint_processes" in(_datamodels) | eval timestamp=parse_long(ucast(map_get(input_event, "_time"), "string", null)), cmd_line=ucast(map_get(input_event, "process"), "string", null), process_name=ucast(map_get(input_event, "process_name"), "string", null), process_path=ucast(map_get(input_event, "process_path"), "string", null), parent_process_name=ucast(map_get(input_event, "parent_process_name"), "string", null), event_id=ucast(map_get(input_event, "event_id"), "string", null) | where cmd_line is not null and process_name is not null and process_name="rasautou.exe" and (like (cmd_line, "%-d %") and like (cmd_line, "%-p %")) | eval start_time=timestamp, end_time=timestamp, entities=mvappend(ucast(map_get(input_event, "dest_user_id"), "string", null), ucast(map_get(input_event, "dest_device_id"), "string", null)) | eval body=create_map(["event_id", event_id, "cmd_line", cmd_line, "process_name", process_name, "parent_process_name", parent_process_name, "process_path", process_path]) | into write_ssa_detected_events();'
<li><a href="#">search: '| from read_ssa_enriched_events() | where "endpoint_processes" in(_datamodels) | eval timestamp=parse_long(ucast(map_get(input_event, "_time"), "string", null)), cmd_line=ucast(map_get(input_event, "process"), "string", null), process_name=ucast(map_get(input_event, "process_name"), "string", null), process_path=ucast(map_get(input_event, "process_path"), "string", null), parent_process_name=ucast(map_get(input_event, "parent_process_name"), "string", null), event_id=ucast(map_get(input_event, "event_id"), "string", null) | where cmd_line is not null and process_name is not null and process_name="rclone.exe" and (like (cmd_line, "%copy%") or like (cmd_line, "%mega%")or like (cmd_line, "%pcloud%") or like (cmd_line, "%ftp%") or like (cmd_line, "%--config%") or like (cmd_line, "%--progress%") or like (cmd_line, "%--no-check-certificate%") or like (cmd_line, "%--ignore-existing%") or like (cmd_line, "%--auto-confirm%") or like (cmd_line, "%--transfers%") or like (cmd_line, "%--multi-thread-streams%")) | eval start_time=timestamp, end_time=timestamp, entities=mvappend(ucast(map_get(input_event, "dest_user_id"), "string", null), ucast(map_get(input_event, "dest_device_id"), "string", null)) | eval body=create_map(["event_id", event_id, "cmd_line", cmd_line, "process_name", process_name, "parent_process_name", parent_process_name, "process_path", process_path]) | into write_ssa_detected_events();'
<li><a href="#">search: '| from read_ssa_enriched_events() | where "endpoint_registry" in (_datamodels) | eval timestamp=parse_long(ucast(map_get(input_event, "_time"), "string", null)), registry_path=lower(ucast(map_get(input_event, "registry_path"), "string", null)), registry_hive=lower(ucast(map_get(input_event, "registry_hive"), "string", null)), registry_value_name=lower(ucast(map_get(input_event, "registry_value_name"), "string", null)), registry_key_name=lower(ucast(map_get(input_event, "parent_process_name"), "string", null)), registry_value_type=lower(ucast(map_get(input_event, "registry_value_type"), "string", null)), registry_value_data=lower(ucast(map_get(input_event, "registry_value_data"), "string", null)), process_guid=lower(ucast(map_get(input_event, "process_guid"), "string", null)) | where registry_path is not null and (like (registry_path, "%mscfile\\\\shell\\\\open\\\\command%")) | eval start_time=timestamp, end_time=timestamp, entities=mvappend(ucast(map_get(input_event, "dest_user_id"), "string", null), ucast(map_get(input_event, "dest_device_id"), "string", null)) | eval body=create_map(["registry_path", registry_path, "registry_hive", registry_hive, "registry_value_name", registry_value_name, "registry_key_name", registry_key_name, "registry_value_type", registry_value_type, "registry_value_data", registry_value_data, "process_guid", process_guid]) | into write_ssa_detected_events();'
<li><a href="#">search: '| from read_ssa_enriched_events() | where "endpoint_registry" in (_datamodels) | eval timestamp=parse_long(ucast(map_get(input_event, "_time"), "string", null)), registry_path=lower(ucast(map_get(input_event, "registry_path"), "string", null)), registry_hive=lower(ucast(map_get(input_event, "registry_hive"), "string", null)), registry_value_name=lower(ucast(map_get(input_event, "registry_value_name"), "string", null)), registry_key_name=lower(ucast(map_get(input_event, "registry_key_name"), "string", null)), registry_value_type=lower(ucast(map_get(input_event, "registry_value_type"), "string", null)), registry_value_data=lower(ucast(map_get(input_event, "registry_value_data"), "string", null)), process_guid=lower(ucast(map_get(input_event, "process_guid"), "string", null)) | where registry_path is not null and registry_value_name is not null and like (registry_path, "%\\\\appx82a6gwre4fdg3bt635tn5ctqjf8msdd2\\\\shell\\\\open\\\\command%") and (registry_value_name="(default)" or registry_value_name="delegateexecute") | eval start_time=timestamp, end_time=timestamp, entities=mvappend(ucast(map_get(input_event, "dest_user_id"), "string", null), ucast(map_get(input_event, "dest_device_id"), "string", null)) | eval body=create_map(["registry_path", registry_path, "registry_hive", registry_hive, "registry_value_name", registry_value_name, "registry_key_name", registry_key_name, "registry_value_type", registry_value_type, "registry_value_data", registry_value_data, "process_guid", process_guid]) | into write_ssa_detected_events(); '
<li><a href="#">search: '| inputlookup discovered_dns_records | rename answer as discovered_answer | join domain[|tstats `security_content_summariesonly` count values(dns.record_type) as type, values(dns.answer) as current_answer values(dns.src) as src from datamodel=network_resolution where dns.message_type=response dns.answer!="unknown" dns.answer!="" by dns.query | rename dns.query as query | where query!="unknown" | rex field=query "(?<domain>\w+\.\w+?)(?:$|/)"] | makemv delim=" " answer | makemv delim=" " type | sort -count | table count,src,domain,type,query,current_answer,discovered_answer | makemv current_answer | mvexpand current_answer | makemv discovered_answer | eval n=mvfind(discovered_answer, current_answer) | where isnull(n) | `dns_record_changed_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count dc(registry_value_name) as registry_value_name_count from datamodel=endpoint.registry where registry.registry_path="*\\software\\microsoft\\*" and registry.registry_value_data = "binary data" by _time span=1m registry.dest registry.user registry.registry_path registry.registry_value_name registry.registry_value_data registry.process_guid registry.process_id registry.registry_key_name | `drop_dm_object_name(registry)` | rename process_guid as proc_guid | eval registry_key_name_len = len(registry_key_name) | eval registry_value_name_len = len(registry_value_name) | regex registry_value_name="^[0-9a-fa-f]{8}" | where registry_key_name_len < 80 and registry_value_name_len == 8 | join proc_guid, _time [| tstats `security_content_summariesonly` count from datamodel=endpoint.processes where processes.process_name in ("explorer.exe", "wermgr.exe","dxdiag.exe", "onedrivesetup.exe", "mobsync.exe", "msra.exe", "xwizard.exe") by _time span=1m processes.process_id processes.process_name processes.process processes.dest processes.parent_process_name processes.parent_process processes.process_guid processes.process_path | `drop_dm_object_name(processes)` | rename process_guid as proc_guid | fields _time dest user parent_process_name parent_process process_name process_path process proc_guid registry_path registry_value_name registry_value_data process_id registry_key_name registry_value_name_count] | stats min(_time) as firsttime max(_time) as lasttime values(registry_value_name) as registry_value_name dc(registry_value_name) as registry_value_name_count by process_path registry_key_name registry_value_data proc_guid registry_key_name_len registry_value_name_len | where registry_value_name_count >= 5 | `windows_modify_registry_qakbot_binary_data_registry_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count earliest(_time) as firsttime latest(_time) as lasttime values(all_traffic.action) values(all_traffic.bytes) from datamodel=network_traffic where all_traffic.action !=blocked all_traffic.dest_category !=internal (all_traffic.protocol=icmp or all_traffic.transport=icmp) all_traffic.bytes > 1000 by all_traffic.src_ip all_traffic.dest_ip | `drop_dm_object_name("all_traffic")` | search ( dest_ip!=10.0.0.0/8 and dest_ip!=172.16.0.0/12 and dest_ip!=192.168.0.0/16) | `security_content_ctime(firsttime)`|`security_content_ctime(lasttime)` | `detect_large_outbound_icmp_packets_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count earliest(_time) as firsttime, latest(_time) as lasttime values(all_changes.object) as dest from datamodel=change where all_changes.action=created by all_changes.user all_changes.vendor_region | `drop_dm_object_name("all_changes")` | lookup previously_seen_cloud_compute_creations_by_user user as user outputnew firsttimeseen, enough_data | eventstats max(enough_data) as enough_data | where enough_data=1 | eval firsttimeseenuser=min(firsttimeseen) | where isnull(firsttimeseenuser) or firsttimeseenuser > relative_time(now(), "-24h@h") | table firsttime, user, dest, count vendor_region | `security_content_ctime(firsttime)` | `cloud_compute_instance_created_by_previously_unseen_user_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count earliest(_time) as firsttime, latest(_time) as lasttime values(all_changes.object_id) as object_id values(all_changes.command) as command from datamodel=change where all_changes.action=modified all_changes.change_type=ec2 all_changes.status=success by all_changes.user | `drop_dm_object_name("all_changes")` | lookup previously_seen_cloud_instance_modifications_by_user user as user outputnew firsttimeseen, enough_data | eventstats max(enough_data) as enough_data | where enough_data=1 | eval firsttimeseenuser=min(firsttimeseen) | where isnull(firsttimeseenuser) or firsttimeseenuser > relative_time(now(), "-24h@h") | table firsttime user command object_id count | `security_content_ctime(firsttime)` | `cloud_instance_modified_by_previously_unseen_user_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count from datamodel=endpoint.filesystem where filesystem.file_path in ("*\\system32\\drivers\\*", "*\\syswow64\\drivers\\*") by _time span=5m filesystem.dest filesystem.user filesystem.file_name filesystem.file_path filesystem.process_guid filesystem.file_create_time | `drop_dm_object_name(filesystem)` | rex field="file_name" "\.(?<extension>[^\.]*$)" | where isnull(extension) | join process_guid [| tstats `security_content_summariesonly` count from datamodel=endpoint.processes by _time span=5m processes.process_name processes.dest processes.process_guid processes.user | `drop_dm_object_name(processes)`] | stats count min(_time) as firsttime max(_time) as lasttime by dest process_name process_guid file_name file_path file_create_time user | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `windows_file_without_extension_in_critical_folder_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count from datamodel=endpoint.processes by _time processes.process_id processes.process_name processes.dest processes.process_guid processes.user | `drop_dm_object_name(processes)` | join process_guid [| tstats `security_content_summariesonly` count from datamodel=endpoint.filesystem where filesystem.file_name="dynwrapx.dll" by _time filesystem.dest filesystem.file_create_time filesystem.file_name filesystem.file_path filesystem.process_guid filesystem.user | `drop_dm_object_name(filesystem)` | fields _time process_guid file_path file_name file_create_time user dest process_name] | stats count min(_time) as firsttime max(_time) as lasttime by dest process_name process_guid file_name file_path file_create_time user | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `process_writing_dynamicwrapperx_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count from datamodel=endpoint.processes by _time processes.process_id processes.process_name processes.dest processes.process_guid processes.user | `drop_dm_object_name(processes)` | join process_guid [| tstats `security_content_summariesonly` count from datamodel=endpoint.registry where registry.registry_path= "*\\clsid\\{89565275-a714-4a43-912e-978b935edccc}\\inprocserver32\\(default)" by registry.registry_path registry.registry_key_name registry.registry_value_name registry.dest registry.process_guid registry.user | `drop_dm_object_name(registry)` | fields _time dest registry_path registry_key_name registry_value_name process_name process_path process process_guid user] | stats count min(_time) as firsttime max(_time) as lasttime by dest, process_name registry_path registry_key_name registry_value_name user | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `malicious_inprocserver32_modification_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count from datamodel=endpoint.processes where (processes.process_name="java.exe" or processes.process_name=javaw.exe or processes.process_name=javaw.exe) by _time processes.process_id processes.process_name processes.dest processes.process_path processes.process processes.parent_process_name | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | join process_id [| tstats `security_content_summariesonly` count from datamodel=network_traffic.all_traffic where (all_traffic.dest_port= 389 or all_traffic.dest_port= 636 or all_traffic.dest_port = 1389 or all_traffic.dest_port = 1099 ) by all_traffic.process_id all_traffic.dest all_traffic.dest_port | `drop_dm_object_name(all_traffic)` | rename dest as connection_to_cnc] | table _time dest parent_process_name process_name process_path process connection_to_cnc dest_port| `outbound_network_connection_from_java_using_default_ports_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count from datamodel=endpoint.processes where `process_dllhost` by _time span=1h processes.process_id processes.process_name processes.dest processes.process_path processes.process processes.parent_process_name | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | regex process="(?i)(dllhost\.exe.{0,4}$)" | `suspicious_dllhost_no_command_line_arguments_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count from datamodel=endpoint.processes where `process_gpupdate` by _time span=1h processes.process_id processes.process_name processes.dest processes.process_path processes.process processes.parent_process_name | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | regex process="(?i)(gpupdate\.exe.{0,4}$)" | `suspicious_gpupdate_no_command_line_arguments_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count from datamodel=endpoint.processes where `process_installutil` by _time span=1h processes.process_id processes.process_name processes.dest processes.process_path processes.process processes.parent_process_name processes.original_file_name | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | join process_id [| tstats `security_content_summariesonly` count from datamodel=network_traffic.all_traffic where all_traffic.dest_port != 0 by all_traffic.process_id all_traffic.dest all_traffic.dest_port | `drop_dm_object_name(all_traffic)` | rename dest as c2 ] | table _time dest parent_process_name process_name process_path process process_id dest_port c2 | `windows_installutil_remote_network_connection_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count from datamodel=endpoint.processes where `process_installutil` processes.process in ("*/u*", "*uninstall*") by _time span=1h processes.process_id processes.process_name processes.dest processes.process_path processes.process processes.parent_process_name | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | join process_id [| tstats `security_content_summariesonly` count from datamodel=network_traffic.all_traffic where all_traffic.dest_port != 0 by all_traffic.process_id all_traffic.dest all_traffic.dest_port | `drop_dm_object_name(all_traffic)` | rename dest as c2 ] | table _time dest parent_process_name process_name process_path process process_id dest_port c2 | `windows_installutil_uninstall_option_with_network_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count from datamodel=endpoint.processes where `process_msiexec` by _time processes.process_id processes.process_name processes.dest processes.process_path processes.process processes.parent_process_name | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | join process_id [| tstats `security_content_summariesonly` count from datamodel=network_traffic.all_traffic where all_traffic.dest_port in ("80","443") by all_traffic.process_id all_traffic.dest all_traffic.dest_port all_traffic.dest_ip | `drop_dm_object_name(all_traffic)` ] | table _time dest parent_process_name process_name process_path process process_id dest_port dest_ip | `windows_msiexec_with_network_connections_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count from datamodel=endpoint.processes where `process_regasm` by _time span=1h processes.process_id processes.process_name processes.dest processes.process_path processes.process processes.parent_process_name | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | regex process="(?i)(regasm\.exe.{0,4}$)" | `detect_regasm_with_no_command_line_arguments_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count from datamodel=endpoint.processes where `process_regsvcs` by _time span=1h processes.process_id processes.process_name processes.dest processes.process_path processes.process processes.parent_process_name | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | regex process="(?i)(regsvcs\.exe.{0,4}$)"| `detect_regsvcs_with_no_command_line_arguments_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count from datamodel=endpoint.processes where `process_rundll32` by _time span=1h processes.process_id processes.process_name processes.dest processes.process_path processes.process processes.parent_process_name | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | regex process="(?i)(rundll32\.exe.{0,4}$)" | `suspicious_rundll32_no_command_line_arguments_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count from datamodel=endpoint.processes where `process_rundll32` by _time span=1h processes.process_id processes.process_name processes.dest processes.process_path processes.process processes.parent_process_name processes.original_file_name | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | regex process="(?i)(rundll32\.exe.{0,4}$)" | join process_id [| tstats `security_content_summariesonly` count from datamodel=network_traffic.all_traffic where all_traffic.dest_port != 0 by all_traffic.process_id all_traffic.dest all_traffic.dest_port | `drop_dm_object_name(all_traffic)` | rename dest as c2 ] | table _time dest parent_process_name process_name process_path process process_id dest_port c2 | `rundll32_with_no_command_line_arguments_with_network_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count from datamodel=endpoint.processes where processes.process = "*echo*" and processes.process in("*/etc/at.allow", "*/etc/at.deny") by processes.dest processes.user processes.parent_process_name processes.process_name processes.process processes.process_id processes.parent_process_id processes.process_guid | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `linux_possible_append_command_to_at_allow_config_file_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count from datamodel=endpoint.processes where processes.process = "*echo*" and processes.process in("*/etc/cron*", "*/var/spool/cron/*", "*/etc/anacrontab*") by processes.dest processes.user processes.parent_process_name processes.process_name processes.process processes.process_id processes.parent_process_id processes.process_guid | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `linux_possible_append_cronjob_entry_on_existing_cronjob_file_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count from datamodel=endpoint.processes where processes.process_name in ("at", "atd") or processes.parent_process_name in ("at", "atd") by processes.dest processes.user processes.parent_process_name processes.process_name processes.process processes.process_id processes.parent_process_id processes.process_guid | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `linux_at_application_execution_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count from datamodel=endpoint.processes where processes.process_name in ("java","java.exe", "javaw.exe") by _time processes.process_id processes.process_name processes.dest processes.process_guid processes.user | `drop_dm_object_name(processes)` | join process_guid [| tstats `security_content_summariesonly` count from datamodel=endpoint.filesystem where filesystem.file_name="*.jsp*" by _time filesystem.dest filesystem.file_create_time filesystem.file_name filesystem.file_path filesystem.process_guid filesystem.user | `drop_dm_object_name(filesystem)` | fields _time process_guid file_path file_name file_create_time user dest process_name] | stats count min(_time) as firsttime max(_time) as lasttime by dest process_name process_guid file_name file_path file_create_time user | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `java_writing_jsp_file_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count from datamodel=endpoint.processes where processes.process_name in ("useradd", "adduser") or processes.process in ("*useradd *", "*adduser *") by processes.dest processes.user processes.parent_process_name processes.process_name processes.process processes.process_id processes.parent_process_id processes.process_guid | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `linux_add_user_account_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count from datamodel=endpoint.processes where processes.process_name in ("winword.exe","excel.exe","powerpnt.exe","mspub.exe","visio.exe","wordpad.exe","wordview.exe") by _time span=1h processes.process_id processes.process_name processes.process processes.dest processes.process_guid | `drop_dm_object_name(processes)` |rename process_guid as proc_guid | join proc_guid, _time [ | tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.filesystem where filesystem.file_name in ("*.inf","*.cab") by _time span=1h filesystem.dest filesystem.file_create_time filesystem.file_name filesystem.file_path filesystem.process_guid | `drop_dm_object_name(filesystem)` |rename process_guid as proc_guid | fields _time dest file_create_time file_name file_path process_name process_path process proc_guid] | dedup file_create_time | table dest, process_name, process, file_create_time, file_name, file_path, proc_guid | `office_product_writing_cab_or_inf_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count from datamodel=endpoint.processes where processes.process_name in ("winword.exe","excel.exe","powerpnt.exe","mspub.exe","visio.exe","wordpad.exe","wordview.exe") by _time span=1h processes.process_id processes.process_name processes.process processes.dest processes.process_guid | `drop_dm_object_name(processes)` |rename process_guid as proc_guid |join proc_guid, _time [| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.filesystem where filesystem.file_name in ("*.exe","*.dll","*.pif","*.scr","*.js","*.vbs","*.vbe","*.ps1") by _time span=1h filesystem.dest filesystem.file_create_time filesystem.file_name filesystem.process_guid filesystem.file_path | `drop_dm_object_name(filesystem)` | rename process_guid as proc_guid | fields _time dest file_create_time file_name file_path process_name process_path process proc_guid] | dedup file_create_time | table dest, process_name, process, file_create_time, file_name, file_path, proc_guid | `office_application_drop_executable_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count from datamodel=endpoint.processes where processes.process_name!=lsass.exe by _time processes.process_id processes.process_name processes.dest processes.process_path processes.process processes.parent_process_name | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | join process_id [| tstats `security_content_summariesonly` count from datamodel=network_traffic.all_traffic where all_traffic.dest_port = 88 by all_traffic.process_id all_traffic.dest all_traffic.dest_port | `drop_dm_object_name(all_traffic)` ] | table _time dest parent_process_name process_name process_path process process_id dest_port | `unknown_process_using_the_kerberos_protocol_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count from datamodel=endpoint.processes where processes.process_name=* by _time span=1h processes.process_id processes.process_name processes.dest | `drop_dm_object_name(processes)` | join process_guid, _time [| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.filesystem where filesystem.file_path in ("*\\system32\\*", "*\\syswow64\\*") filesystem.file_name="*.bat" by _time span=1h filesystem.dest filesystem.file_create_time filesystem.file_name filesystem.file_path | `drop_dm_object_name(filesystem)` | fields _time dest file_create_time file_name file_path process_name process_path process] | dedup file_create_time | table dest, file_create_time, file_name, file_path, process_name | `batch_file_write_to_system32_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count from datamodel=endpoint.processes where processes.process_name=*.exe processes.process_path="*\\appdata\\roaming\\*" by _time span=1h processes.process_id processes.process_name processes.process processes.dest processes.process_guid | `drop_dm_object_name(processes)` |rename process_guid as proc_guid | join proc_guid, _time [ | tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.filesystem where filesystem.file_name in ("*.wav") filesystem.file_path = "*\\appdata\\roaming\\*" by _time span=1h filesystem.dest filesystem.file_create_time filesystem.file_name filesystem.file_path filesystem.process_guid | `drop_dm_object_name(filesystem)` |rename process_guid as proc_guid | fields file_name file_path process_name process_path process dest file_create_time _time proc_guid] | `suspicious_wav_file_in_appdata_folder_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count from datamodel=endpoint.processes where processes.process_name=*.exe processes.process_path="*\\appdata\\roaming\\*" by _time span=1h processes.process_id processes.process_name processes.process processes.dest processes.process_guid | `drop_dm_object_name(processes)` |rename process_guid as proc_guid |join proc_guid, _time [| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.filesystem where filesystem.file_name in ("*.png","*.jpg","*.bmp","*.gif","*.tiff") filesystem.file_path= "*\\appdata\\roaming\\*" by _time span=1h filesystem.dest filesystem.file_create_time filesystem.file_name filesystem.file_path filesystem.process_guid | `drop_dm_object_name(filesystem)` |rename process_guid as proc_guid | fields _time dest file_create_time file_name file_path process_name process_path process proc_guid] | `suspicious_image_creation_in_appdata_folder_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count from datamodel=endpoint.processes where processes.process_name=dllhost.exe by _time span=1h processes.process_id processes.process_name processes.dest processes.process_path processes.process processes.parent_process_name | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | regex process="(?i)(dllhost\.exe.{0,4}$)" | join process_id [| tstats `security_content_summariesonly` count from datamodel=network_traffic.all_traffic where all_traffic.dest_port != 0 by all_traffic.process_id all_traffic.dest all_traffic.dest_port | `drop_dm_object_name(all_traffic)` | rename dest as c2 ] | table _time dest parent_process_name process_name process_path process process_id dest_port c2 | `dllhost_with_no_command_line_arguments_with_network_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count from datamodel=endpoint.processes where processes.process_name=gpupdate.exe by _time span=1h processes.process_id processes.process_name processes.dest processes.process_path processes.process processes.parent_process_name | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | regex process="(?i)(gpupdate\.exe.{0,4}$)"| join process_id [| tstats `security_content_summariesonly` count from datamodel=network_traffic.all_traffic where all_traffic.dest_port != 0 by all_traffic.process_id all_traffic.dest all_traffic.dest_port | `drop_dm_object_name(all_traffic)` | rename dest as c2 ] | table _time dest parent_process_name process_name process_path process process_id dest_port c2 | `gpupdate_with_no_command_line_arguments_with_network_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count from datamodel=endpoint.processes where processes.process_name=msexchangemailboxreplication.exe by _time span=1h processes.process_id processes.process_name processes.process_guid processes.dest | `drop_dm_object_name(processes)` | join process_guid, _time [| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.filesystem where filesystem.file_path in ("*\\httpproxy\\owa\\auth\\*", "*\\inetpub\\wwwroot\\aspnet_client\\*", "*\\httpproxy\\oab\\*") filesystem.file_name="*.aspx" by _time span=1h filesystem.dest filesystem.file_create_time filesystem.file_name filesystem.file_path | `drop_dm_object_name(filesystem)` | fields _time dest file_create_time file_name file_path process_name process_path process process_guid] | dedup file_create_time | table dest file_create_time, file_name, file_path, process_name | `ms_exchange_mailbox_replication_service_writing_active_server_pages_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count from datamodel=endpoint.processes where processes.process_name=pkexec by _time processes.dest processes.process_id processes.parent_process_name processes.process_name processes.process processes.process_path | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | regex process="(^.{1}$)" | `linux_pkexec_privilege_escalation_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count from datamodel=endpoint.processes where processes.process_name=searchprotocolhost.exe by _time span=1h processes.process_id processes.process_name processes.dest processes.process_path processes.process processes.parent_process_name | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | regex process="(?i)(searchprotocolhost\.exe.{0,4}$)" | `suspicious_searchprotocolhost_no_command_line_arguments_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count from datamodel=endpoint.processes where processes.process_name=searchprotocolhost.exe by _time span=1h processes.process_id processes.process_name processes.dest processes.process_path processes.process processes.parent_process_name | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | regex process="(?i)(searchprotocolhost\.exe.{0,4}$)" | join process_id [| tstats `security_content_summariesonly` count from datamodel=network_traffic.all_traffic where all_traffic.dest_port != 0 by all_traffic.process_id all_traffic.dest all_traffic.dest_port | `drop_dm_object_name(all_traffic)` | rename dest as c2 ] | table _time dest parent_process_name process_name process_path process process_id dest_port c2 | `searchprotocolhost_with_no_command_line_with_network_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count from datamodel=endpoint.processes where processes.process_name=spoolsv.exe by _time processes.process_id processes.process_name processes.dest | `drop_dm_object_name(processes)` | join process_guid, _time [| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.filesystem where filesystem.file_path="*\\spool\\drivers\\x64\\*" filesystem.file_name="*.dll" by _time filesystem.dest filesystem.file_create_time filesystem.file_name filesystem.file_path | `drop_dm_object_name(filesystem)` | fields _time dest file_create_time file_name file_path process_name process_path process] | dedup file_create_time | table dest file_create_time, file_name, file_path, process_name | `spoolsv_writing_a_dll_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count from datamodel=endpoint.processes where processes.process_name=system by _time span=1h processes.process_id processes.process_name processes.dest | `drop_dm_object_name(processes)` | join process_guid, _time [| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.filesystem where filesystem.file_path in ("*\\httpproxy\\owa\\auth\\*", "*\\inetpub\\wwwroot\\aspnet_client\\*", "*\\httpproxy\\oab\\*") filesystem.file_name in( "*.aspx", "*.ashx") by _time span=1h filesystem.dest filesystem.file_create_time filesystem.file_name filesystem.file_path | `drop_dm_object_name(filesystem)` | fields _time dest file_create_time file_name file_path process_name process_path process] | dedup file_create_time | table dest file_create_time, file_name, file_path, process_name | `detect_exchange_web_shell_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count from datamodel=endpoint.processes where processes.process_path !="*\\windows\\explorer.exe" by _time span=1h processes.process_id processes.process_name processes.process processes.dest processes.process_guid processes.original_file_name | `drop_dm_object_name(processes)` |rename process_guid as proc_guid | join proc_guid, _time [ | tstats `security_content_summariesonly` count from datamodel=endpoint.filesystem where filesystem.file_path = "*\\appdata\\roaming\\microsoft\\windows\\themes\\transcodedwallpaper" by _time span=1h filesystem.dest filesystem.file_create_time filesystem.file_name filesystem.file_path filesystem.process_guid | `drop_dm_object_name(filesystem)` |rename process_guid as proc_guid | fields file_name file_path process_name process_path process dest file_create_time _time proc_guid] | `windows_defacement_modify_transcodedwallpaper_file_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count from datamodel=endpoint.registry where (registry.registry_key_name=*\\software\\remcos*) by _time span=1h registry.dest registry.user registry.registry_path registry.registry_value_name registry.registry_value_data registry.process_guid | `drop_dm_object_name(registry)` |rename process_guid as proc_guid |join proc_guid, _time [| tstats `security_content_summariesonly` count from datamodel=endpoint.processes by _time span=1h processes.process_id processes.process_name processes.process processes.dest processes.parent_process_name processes.parent_process processes.process_guid | `drop_dm_object_name(processes)` |rename process_guid as proc_guid | fields _time dest user parent_process_name parent_process process_name process_path process proc_guid registry_path registry_value_name registry_value_data] | table _time dest user parent_process_name parent_process process_name process_path process proc_guid registry_path registry_value_name registry_value_data |`remcos_client_registry_install_entry_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count from datamodel=endpoint.registry where (registry.registry_path= "*\\software\\microsoft\\windows\\currentversion\\explorer\\advanced\\hidden" or registry.registry_path= "*\\software\\microsoft\\windows\\currentversion\\explorer\\advanced\\hidefileext" registry.registry_value_data = "0x00000001") or (registry.registry_path= "*\\software\\microsoft\\windows\\currentversion\\explorer\\advanced\\showsuperhidden" registry.registry_value_data = "0x00000000") by _time span=1h registry.dest registry.user registry.registry_path registry.registry_value_name registry.registry_value_data registry.process_guid | `drop_dm_object_name(registry)` |rename process_guid as proc_guid |join proc_guid, _time [| tstats `security_content_summariesonly` count from datamodel=endpoint.processes by _time span=1h processes.process_id processes.process_name processes.process processes.dest processes.parent_process_name processes.parent_process processes.process_guid | `drop_dm_object_name(processes)` |rename process_guid as proc_guid | fields _time dest user parent_process_name parent_process process_name process_path process proc_guid registry_path registry_value_name registry_value_data] | table _time dest user parent_process_name parent_process process_name process_path process proc_guid registry_path registry_value_name registry_value_data | `disable_show_hidden_files_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count from datamodel=endpoint.registry where (registry.registry_path= "*\\software\\microsoft\\windows\\currentversion\\policies\\system\\shutdownwithoutlogon" registry.registry_value_data = "0x00000000") or (registry.registry_path="*\\software\\microsoft\\windows\\currentversion\\policies\\explorer\\noclose" registry.registry_value_data = "0x00000001") by _time span=1h registry.dest registry.user registry.registry_path registry.registry_value_name registry.registry_value_data registry.process_guid | `drop_dm_object_name(registry)` |rename process_guid as proc_guid |join proc_guid, _time [| tstats `security_content_summariesonly` count from datamodel=endpoint.processes by _time span=1h processes.process_id processes.process_name processes.process processes.dest processes.parent_process_name processes.parent_process processes.process_guid | `drop_dm_object_name(processes)` |rename process_guid as proc_guid | fields _time dest user parent_process_name parent_process process_name process_path process proc_guid registry_path registry_value_name registry_value_data] | table _time dest user parent_process_name parent_process process_name process_path process proc_guid registry_path registry_value_name registry_value_data | `windows_disable_shutdown_button_through_registry_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count from datamodel=endpoint.registry where (registry.registry_path="*\\currentcontrolset\\control\\crashcontrol\\crashdumpenabled") and registry.registry_value_data="0x00000000" by _time span=1h registry.dest registry.user registry.registry_path registry.registry_value_name registry.registry_value_data registry.process_guid registry.registry_key_name | `drop_dm_object_name(registry)` |join process_guid [| tstats `security_content_summariesonly` count from datamodel=endpoint.processes by _time span=1h processes.process_id processes.process_name processes.process processes.dest processes.parent_process_name processes.parent_process processes.process_guid | `drop_dm_object_name(processes)` | fields _time dest user parent_process_name parent_process process_name process_path process process_guid registry_path registry_value_name registry_value_data registry_key_name] | table _time dest user parent_process_name parent_process process_name process_path process process_guid registry_path registry_value_name registry_value_data registry_key_name | `windows_disable_memory_crash_dump_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count from datamodel=endpoint.registry where (registry.registry_path="*\\software\\wow6432node\\facebook_assistant\\*" or registry.registry_path="*\\software\\wow6432node\\blacklivesmatter*") by _time span=1h registry.dest registry.user registry.registry_path registry.registry_value_name registry.registry_value_data registry.process_guid | `drop_dm_object_name(registry)` |rename process_guid as proc_guid |join proc_guid, _time [| tstats `security_content_summariesonly` count from datamodel=endpoint.processes by _time span=1h processes.process_id processes.process_name processes.process processes.dest processes.parent_process_name processes.parent_process processes.process_guid | `drop_dm_object_name(processes)` |rename process_guid as proc_guid | fields _time dest user parent_process_name parent_process process_name process_path process proc_guid registry_path registry_value_name registry_value_data] | table _time dest user parent_process_name parent_process process_name process_path process proc_guid registry_path registry_value_name registry_value_data | `revil_registry_entry_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count from datamodel=endpoint.registry where (registry.registry_path="*microsoft\\windows nt\\currentversion\\image file execution options*") and (registry.registry_value_name=globalflag or registry.registry_value_name=debugger) by _time span=1h registry.dest registry.user registry.registry_path registry.registry_value_name registry.registry_value_data registry.process_guid registry.registry_key_name | `drop_dm_object_name(registry)` |rename process_guid as proc_guid |join proc_guid, _time [| tstats `security_content_summariesonly` count from datamodel=endpoint.processes by _time span=1h processes.process_id processes.process_name processes.process processes.dest processes.parent_process_name processes.parent_process processes.process_guid | `drop_dm_object_name(processes)` |rename process_guid as proc_guid | fields _time dest user parent_process_name parent_process process_name process_path process proc_guid registry_path registry_value_name registry_value_data registry_key_name] | table _time dest user parent_process_name parent_process process_name process_path process proc_guid registry_path registry_value_name registry_value_data registry_key_name | `registry_keys_used_for_privilege_escalation_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count from datamodel=endpoint.registry where registry.action=deleted by _time span=1h registry.dest registry.user registry.registry_path registry.registry_value_name registry.registry_key_name registry.process_guid registry.registry_value_data registry.action | `drop_dm_object_name(registry)` |rename process_guid as proc_guid |join proc_guid, _time [| tstats `security_content_summariesonly` count from datamodel=endpoint.processes where not (processes.process_path in ("*\\windows\\*", "*\\program files*")) by _time span=1h processes.process_id processes.process_name processes.process processes.dest processes.parent_process_name processes.parent_process processes.process_path processes.process_guid | `drop_dm_object_name(processes)` |rename process_guid as proc_guid | fields _time dest user parent_process_name parent_process process_name process_path process proc_guid registry_path registry_value_name registry_value_data registry_key_name action] | table _time parent_process_name parent_process process_name process_path process proc_guid registry_path registry_value_name registry_value_data registry_key_name action dest user | `windows_deleted_registry_by_a_non_critical_process_file_path_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count from datamodel=endpoint.registry where registry.action=modified and registry.registry_path="*currentcontrolset\\control\\print\\monitors*" by _time span=1h registry.dest registry.user registry.registry_path registry.registry_value_name registry.process_guid registry.registry_key_name registry.registry_value_data | `drop_dm_object_name(registry)` |rename process_guid as proc_guid |join proc_guid, _time [| tstats `security_content_summariesonly` count from datamodel=endpoint.processes by _time span=1h processes.process_id processes.process_name processes.process processes.dest processes.parent_process_name processes.parent_process processes.process_guid | `drop_dm_object_name(processes)` |rename process_guid as proc_guid | fields _time dest user parent_process_name parent_process process_name process_path process proc_guid registry_path registry_value_name registry_value_data registry_key_name] | table _time dest user parent_process_name parent_process process_name process_path process proc_guid registry_path registry_value_name registry_value_data registry_key_name | `monitor_registry_keys_for_print_monitors_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count from datamodel=endpoint.registry where registry.registry_path = "*\\microsoft\\windows defender\\spynet*" registry.registry_value_name = disableblockatfirstseen registry.registry_value_data = 0x00000001 by _time span=1h registry.dest registry.user registry.registry_path registry.registry_value_name registry.registry_value_data registry.process_guid | `drop_dm_object_name(registry)` |rename process_guid as proc_guid |join proc_guid, _time [| tstats `security_content_summariesonly` count from datamodel=endpoint.processes by _time span=1h processes.process_id processes.process_name processes.process processes.dest processes.parent_process_name processes.parent_process processes.process_guid | `drop_dm_object_name(processes)` |rename process_guid as proc_guid | fields _time dest user parent_process_name parent_process process_name process_path process proc_guid registry_path registry_value_name registry_value_data] | table _time dest user parent_process_name parent_process process_name process_path process proc_guid registry_path registry_value_name registry_value_data | `disable_defender_blockatfirstseen_feature_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count from datamodel=endpoint.registry where registry.registry_path = "*\\microsoft\\windows defender\\spynet*" registry.registry_value_name = spynetreporting registry.registry_value_data = 0x00000000 by _time span=1h registry.dest registry.user registry.registry_path registry.registry_value_name registry.registry_value_data registry.process_guid | `drop_dm_object_name(registry)` |rename process_guid as proc_guid |join proc_guid, _time [| tstats `security_content_summariesonly` count from datamodel=endpoint.processes by _time span=1h processes.process_id processes.process_name processes.process processes.dest processes.parent_process_name processes.parent_process processes.process_guid | `drop_dm_object_name(processes)` |rename process_guid as proc_guid | fields _time dest user parent_process_name parent_process process_name process_path process proc_guid registry_path registry_value_name registry_value_data] | table _time dest user parent_process_name parent_process process_name process_path process proc_guid registry_path registry_value_name registry_value_data | `disable_defender_spynet_reporting_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count from datamodel=endpoint.registry where registry.registry_path = "*\\microsoft\\windows defender\\spynet*" registry.registry_value_name = submitsamplesconsent registry.registry_value_data = 0x00000000 by _time span=1h registry.dest registry.user registry.registry_path registry.registry_value_name registry.registry_value_data registry.process_guid | `drop_dm_object_name(registry)` |rename process_guid as proc_guid |join proc_guid, _time [| tstats `security_content_summariesonly` count from datamodel=endpoint.processes by _time span=1h processes.process_id processes.process_name processes.process processes.dest processes.parent_process_name processes.parent_process processes.process_guid | `drop_dm_object_name(processes)` |rename process_guid as proc_guid | fields _time dest user parent_process_name parent_process process_name process_path process proc_guid registry_path registry_value_name registry_value_data] | table _time dest user parent_process_name parent_process process_name process_path process proc_guid registry_path registry_value_name registry_value_data | `disable_defender_submit_samples_consent_feature_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count from datamodel=endpoint.registry where registry.registry_path = "*\\microsoft\\windows\\currentversion\\explorer\\advanced*" and registry.registry_value_name in("showcompcolor", "showinfotip") by _time span=1h registry.dest registry.user registry.registry_path registry.registry_value_name registry.registry_value_data registry.process_guid | `drop_dm_object_name(registry)` |rename process_guid as proc_guid |join proc_guid, _time [| tstats `security_content_summariesonly` count from datamodel=endpoint.processes by _time span=1h processes.process_id processes.process_name processes.process processes.dest processes.parent_process_name processes.parent_process processes.process_guid | `drop_dm_object_name(processes)` |rename process_guid as proc_guid | fields _time dest user parent_process_name parent_process process_name process_path process proc_guid registry_path registry_value_name registry_value_data] | table _time dest user parent_process_name parent_process process_name process_path process proc_guid registry_path registry_value_name registry_value_data | `windows_modify_show_compress_color_and_info_tip_registry_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count from datamodel=endpoint.registry where registry.registry_path = "*\\policies\\microsoft\\windows defender\\mpengine*" registry.registry_value_name = mpenablepus registry.registry_value_data = 0x00000000 by _time span=1h registry.dest registry.user registry.registry_path registry.registry_value_name registry.registry_value_data registry.process_guid | `drop_dm_object_name(registry)` |rename process_guid as proc_guid |join proc_guid, _time [| tstats `security_content_summariesonly` count from datamodel=endpoint.processes by _time span=1h processes.process_id processes.process_name processes.process processes.dest processes.parent_process_name processes.parent_process processes.process_guid | `drop_dm_object_name(processes)` |rename process_guid as proc_guid | fields _time dest user parent_process_name parent_process process_name process_path process proc_guid registry_path registry_value_name registry_value_data] | table _time dest user parent_process_name parent_process process_name process_path process proc_guid registry_path registry_value_name registry_value_data | `disable_defender_mpengine_registry_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count from datamodel=endpoint.registry where registry.registry_path = "*\\system\\currentcontrolset\\services\\*" and (registry.registry_path in("*wdboot*", "*wdfilter*", "*wdnisdrv*", "*wdnissvc*","*windefend*", "*securityhealthservice*")) and registry.registry_value_name = start registry.registry_value_data = 0x00000004 by _time span=1h registry.dest registry.user registry.registry_path registry.registry_value_name registry.registry_value_data registry.process_guid | `drop_dm_object_name(registry)` |rename process_guid as proc_guid |join proc_guid, _time [| tstats `security_content_summariesonly` count from datamodel=endpoint.processes by _time span=1h processes.process_id processes.process_name processes.process processes.dest processes.parent_process_name processes.parent_process processes.process_guid | `drop_dm_object_name(processes)` |rename process_guid as proc_guid | fields _time dest user parent_process_name parent_process process_name process_path process proc_guid registry_path registry_value_name registry_value_data] | table _time dest user parent_process_name parent_process process_name process_path process proc_guid registry_path registry_value_name registry_value_data | `disabling_defender_services_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count from datamodel=endpoint.registry where registry.registry_path = "*microsoft\\windows defender\\reporting*" registry.registry_value_name = disableenhancednotifications registry.registry_value_data = 0x00000001 by _time span=1h registry.dest registry.user registry.registry_path registry.registry_value_name registry.registry_value_data registry.process_guid | `drop_dm_object_name(registry)` |rename process_guid as proc_guid |join proc_guid, _time [| tstats `security_content_summariesonly` count from datamodel=endpoint.processes by _time span=1h processes.process_id processes.process_name processes.process processes.dest processes.parent_process_name processes.parent_process processes.process_guid | `drop_dm_object_name(processes)` |rename process_guid as proc_guid | fields _time dest user parent_process_name parent_process process_name process_path process proc_guid registry_path registry_value_name registry_value_data] | table _time dest user parent_process_name parent_process process_name process_path process proc_guid registry_path registry_value_name registry_value_data | `disable_defender_enhanced_notification_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count from datamodel=endpoint.registry where registry.registry_path in ("*\\certificates\\*") and registry.registry_value_name="blob" by _time span=1h registry.dest registry.user registry.registry_path registry.registry_value_name registry.process_guid registry.registry_key_name registry.registry_value_data | `drop_dm_object_name(registry)` | join process_guid _time [| tstats `security_content_summariesonly` count from datamodel=endpoint.processes by _time span=1h processes.process_id processes.process_name processes.process processes.dest processes.process_guid | `drop_dm_object_name(processes)`] | table _time dest user process_name process process_guid registry_path registry_value_name registry_value_data registry_key_name | `windows_registry_certificate_added_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count from datamodel=endpoint.registry where registry.registry_path in ("*\\schedule\\taskcache\\tree\\*") registry.user="system" registry.registry_value_name="sd" (registry.action=deleted or registry.action=modified) by _time registry.dest registry.process_guid registry.user registry.registry_path registry.registry_value_name registry.registry_key_name registry.registry_value_data registry.status registry.action | `drop_dm_object_name(registry)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `windows_registry_delete_task_sd_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count from datamodel=endpoint.registry where registry.registry_path in ("*system\\currentcontrolset\\control\\safeboot\\minimal\\*","*system\\currentcontrolset\\control\\safeboot\\network\\*") by _time span=1h registry.dest registry.user registry.registry_path registry.registry_value_name registry.process_guid registry.registry_key_name registry.registry_value_data | `drop_dm_object_name(registry)` | join process_guid _time [| tstats `security_content_summariesonly` count from datamodel=endpoint.processes by _time span=1h processes.process_id processes.process_name processes.process processes.dest processes.process_guid | `drop_dm_object_name(processes)`] | table _time dest user process_name process process_guid registry_path registry_value_name registry_value_data registry_key_name | `windows_registry_modification_for_safe_mode_persistence_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count from datamodel=endpoint.registry where registry.registry_path= "*\\appx82a6gwre4fdg3bt635tn5ctqjf8msdd2\\shell\\open\\command*" and (registry.registry_value_name = "(default)" or registry.registry_value_name = "delegateexecute") by _time span=1h registry.dest registry.user registry.registry_path registry.registry_value_name registry.registry_value_data registry.process_guid registry.registry_key_name | `drop_dm_object_name(registry)` |rename process_guid as proc_guid |join proc_guid, _time [| tstats `security_content_summariesonly` count from datamodel=endpoint.processes by _time span=1h processes.process_id processes.process_name processes.process processes.dest processes.parent_process_name processes.parent_process processes.process_guid | `drop_dm_object_name(processes)` |rename process_guid as proc_guid | fields _time dest user parent_process_name parent_process process_name process_path process proc_guid registry_path registry_value_name registry_value_data registry_key_name] | table _time dest user parent_process_name parent_process process_name process_path process proc_guid registry_path registry_value_name registry_value_data registry_key_name | `wsreset_uac_bypass_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count from datamodel=endpoint.registry where registry.registry_path= "*\\environment\\windir" registry.registry_value_data = "*.exe*" by _time span=1h registry.dest registry.user registry.registry_path registry.registry_value_name registry.registry_value_data registry.process_guid registry.registry_key_name | `drop_dm_object_name(registry)` |rename process_guid as proc_guid |join proc_guid, _time [| tstats `security_content_summariesonly` count from datamodel=endpoint.processes by _time span=1h processes.process_id processes.process_name processes.process processes.dest processes.parent_process_name processes.parent_process processes.process_guid | `drop_dm_object_name(processes)` |rename process_guid as proc_guid | fields _time dest user parent_process_name parent_process process_name process_path process proc_guid registry_path registry_value_name registry_value_data registry_key_name] | table _time dest user parent_process_name parent_process process_name process_path process proc_guid registry_path registry_value_name registry_value_data registry_key_name | `silentcleanup_uac_bypass_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count from datamodel=endpoint.registry where registry.registry_path= "*\\microsoft\\windows\\currentversion\\policies\\system*" registry.registry_value_name = consentpromptbehavioradmin registry.registry_value_data = "0x00000000" by _time span=1h registry.dest registry.user registry.registry_path registry.registry_value_name registry.process_guid registry.registry_key_name registry.registry_value_data | `drop_dm_object_name(registry)` |rename process_guid as proc_guid |join proc_guid, _time [| tstats `security_content_summariesonly` count from datamodel=endpoint.processes by _time span=1h processes.process_id processes.process_name processes.process processes.dest processes.parent_process_name processes.parent_process processes.process_guid | `drop_dm_object_name(processes)` |rename process_guid as proc_guid | fields _time dest user parent_process_name parent_process process_name process_path process proc_guid registry_path registry_value_name registry_value_data registry_key_name] | table _time dest user parent_process_name parent_process process_name process_path process proc_guid registry_path registry_value_name registry_value_data registry_key_name | `allow_operation_with_consent_admin_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count from datamodel=endpoint.registry where registry.registry_path= "*\\software\\microsoft\\.netframework\\etwenabled" registry.registry_value_data = "0x00000000" by _time span=1h registry.dest registry.user registry.registry_path registry.registry_value_name registry.registry_value_data registry.process_guid | `drop_dm_object_name(registry)` |rename process_guid as proc_guid |join proc_guid, _time [| tstats `security_content_summariesonly` count from datamodel=endpoint.processes by _time span=1h processes.process_id processes.process_name processes.process processes.dest processes.parent_process_name processes.parent_process processes.process_guid | `drop_dm_object_name(processes)` |rename process_guid as proc_guid | fields _time dest user parent_process_name parent_process process_name process_path process proc_guid registry_path registry_value_name registry_value_data] | table _time dest user parent_process_name parent_process process_name process_path process proc_guid registry_path registry_value_name registry_value_data | `disable_etw_through_registry_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count from datamodel=endpoint.registry where registry.registry_path= "*\\software\\microsoft\\windows nt\\currentversion\\systemrestore\\disablesr" or registry.registry_path= "*\\software\\microsoft\\windows nt\\currentversion\\systemrestore\\disableconfig" or registry.registry_path= "*\\software\\policies\\microsoft\\windows nt\\systemrestore\\disablesr" or registry.registry_path= "*\\software\\policies\\microsoft\\windows nt\\systemrestore\\disableconfig" registry.registry_value_data = "0x00000001" by _time span=1h registry.dest registry.user registry.registry_path registry.registry_value_name registry.registry_key_name registry.process_guid registry.registry_value_data | `drop_dm_object_name(registry)` |rename process_guid as proc_guid |join proc_guid, _time [| tstats `security_content_summariesonly` count from datamodel=endpoint.processes by _time span=1h processes.process_id processes.process_name processes.process processes.dest processes.parent_process_name processes.parent_process processes.process_guid | `drop_dm_object_name(processes)` |rename process_guid as proc_guid | fields _time dest user parent_process_name parent_process process_name process_path process proc_guid registry_path registry_value_name registry_value_data registry_key_name] | table _time dest user parent_process_name parent_process process_name process_path process proc_guid registry_path registry_value_name registry_value_data registry_key_name | `disabling_systemrestore_in_registry_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count from datamodel=endpoint.registry where registry.registry_path= "*\\software\\microsoft\\windows\\currentversion\\policies\\explorer\\*" or registry.registry_path= "*\\software\\microsoft\\windows\\currentversion\\policies\\system\\*" registry.registry_value_name in ("nodesktop", "nofind", "nocontrolpanel", "nofilemenu", "nosettaskbar", "notraycontextmenu", "taskbarlockall", "nothemestab","nopropertiesmydocuments","novisualstylechoice","nocolorchoice","nopropertiesmydocuments") registry.registry_value_data = "0x00000001" by _time span=1h registry.dest registry.user registry.registry_path registry.registry_value_name registry.registry_value_data registry.process_guid | `drop_dm_object_name(registry)` |rename process_guid as proc_guid |join proc_guid, _time [| tstats `security_content_summariesonly` count from datamodel=endpoint.processes by _time span=1h processes.process_id processes.process_name processes.process processes.dest processes.parent_process_name processes.parent_process processes.process_guid | `drop_dm_object_name(processes)` |rename process_guid as proc_guid | fields _time dest user parent_process_name parent_process process_name process_path process proc_guid registry_path registry_value_name registry_value_data] | table _time dest user parent_process_name parent_process process_name process_path process proc_guid registry_path registry_value_name registry_value_data | `windows_disable_windows_group_policy_features_through_registry_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count from datamodel=endpoint.registry where registry.registry_path= "*\\software\\microsoft\\windows\\currentversion\\policies\\explorer\\*" registry.registry_value_name in ("hideclock", "hidescahealth", "hidescanetwork", "hidescapower", "hidescavolume") registry.registry_value_data = "0x00000001" by _time span=1h registry.dest registry.user registry.registry_path registry.registry_value_name registry.registry_value_data registry.process_guid | `drop_dm_object_name(registry)` |rename process_guid as proc_guid |join proc_guid, _time [| tstats `security_content_summariesonly` count from datamodel=endpoint.processes by _time span=1h processes.process_id processes.process_name processes.process processes.dest processes.parent_process_name processes.parent_process processes.process_guid | `drop_dm_object_name(processes)` |rename process_guid as proc_guid | fields _time dest user parent_process_name parent_process process_name process_path process proc_guid registry_path registry_value_name registry_value_data] | table _time dest user parent_process_name parent_process process_name process_path process proc_guid registry_path registry_value_name registry_value_data | `windows_hide_notification_features_through_registry_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count from datamodel=endpoint.registry where registry.registry_path= "*\\software\\microsoft\\windows\\currentversion\\policies\\explorer\\*" registry.registry_value_name in ("nologoff", "startmenulogoff") registry.registry_value_data = "0x00000001" by _time span=1h registry.dest registry.user registry.registry_path registry.registry_value_name registry.registry_value_data registry.process_guid | `drop_dm_object_name(registry)` |rename process_guid as proc_guid |join proc_guid, _time [| tstats `security_content_summariesonly` count from datamodel=endpoint.processes by _time span=1h processes.process_id processes.process_name processes.process processes.dest processes.parent_process_name processes.parent_process processes.process_guid | `drop_dm_object_name(processes)` |rename process_guid as proc_guid | fields _time dest user parent_process_name parent_process process_name process_path process proc_guid registry_path registry_value_name registry_value_data] | table _time dest user parent_process_name parent_process process_name process_path process proc_guid registry_path registry_value_name registry_value_data | `windows_disable_logoff_button_through_registry_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count from datamodel=endpoint.registry where registry.registry_path= "*\\software\\microsoft\\windows\\currentversion\\policies\\explorer\\nocontrolpanel" registry.registry_value_data = "0x00000001" by _time span=1h registry.dest registry.user registry.registry_path registry.registry_value_name registry.registry_key_name registry.process_guid registry.registry_value_data | `drop_dm_object_name(registry)` |rename process_guid as proc_guid |join proc_guid, _time [| tstats `security_content_summariesonly` count from datamodel=endpoint.processes by _time span=1h processes.process_id processes.process_name processes.process processes.dest processes.parent_process_name processes.parent_process processes.process_guid | `drop_dm_object_name(processes)` |rename process_guid as proc_guid | fields _time dest user parent_process_name parent_process process_name process_path process proc_guid registry_path registry_value_name registry_value_data registry_key_name] | table _time dest user parent_process_name parent_process process_name process_path process proc_guid registry_path registry_value_name registry_value_data registry_key_name | `disabling_controlpanel_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count from datamodel=endpoint.registry where registry.registry_path= "*\\software\\microsoft\\windows\\currentversion\\policies\\explorer\\nofolderoptions" registry.registry_value_data = "0x00000001" by _time span=1h registry.dest registry.user registry.registry_path registry.registry_value_name registry.registry_key_name registry.process_guid registry.registry_value_data | `drop_dm_object_name(registry)` |rename process_guid as proc_guid |join proc_guid, _time [| tstats `security_content_summariesonly` count from datamodel=endpoint.processes by _time span=1h processes.process_id processes.process_name processes.process processes.dest processes.parent_process_name processes.parent_process processes.process_guid | `drop_dm_object_name(processes)` |rename process_guid as proc_guid | fields _time dest user parent_process_name parent_process process_name process_path process proc_guid registry_path registry_value_name registry_value_data registry_key_name] | table _time dest user parent_process_name parent_process process_name process_path process proc_guid registry_path registry_value_name registry_value_data registry_key_name | `disabling_folderoptions_windows_feature_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count from datamodel=endpoint.registry where registry.registry_path= "*\\software\\microsoft\\windows\\currentversion\\policies\\explorer\\norun" registry.registry_value_data = "0x00000001" by _time span=1h registry.dest registry.user registry.registry_path registry.registry_value_name registry.registry_key_name registry.process_guid registry.registry_value_data | `drop_dm_object_name(registry)` |rename process_guid as proc_guid |join proc_guid, _time [| tstats `security_content_summariesonly` count from datamodel=endpoint.processes by _time span=1h processes.process_id processes.process_name processes.process processes.dest processes.parent_process_name processes.parent_process processes.process_guid | `drop_dm_object_name(processes)` |rename process_guid as proc_guid | fields _time dest user parent_process_name parent_process process_name process_path process proc_guid registry_path registry_value_name registry_value_data registry_key_name] | table _time dest user parent_process_name parent_process process_name process_path process proc_guid registry_path registry_value_name registry_value_data registry_key_name | `disabling_norun_windows_app_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count from datamodel=endpoint.registry where registry.registry_path= "*\\software\\microsoft\\windows\\currentversion\\policies\\system\\disablechangepassword" registry.registry_value_data = "0x00000001" by _time span=1h registry.dest registry.user registry.registry_path registry.registry_value_name registry.registry_value_data registry.process_guid | `drop_dm_object_name(registry)` |rename process_guid as proc_guid |join proc_guid, _time [| tstats `security_content_summariesonly` count from datamodel=endpoint.processes by _time span=1h processes.process_id processes.process_name processes.process processes.dest processes.parent_process_name processes.parent_process processes.process_guid | `drop_dm_object_name(processes)` |rename process_guid as proc_guid | fields _time dest user parent_process_name parent_process process_name process_path process proc_guid registry_path registry_value_name registry_value_data] | table _time dest user parent_process_name parent_process process_name process_path process proc_guid registry_path registry_value_name registry_value_data | `windows_disable_change_password_through_registry_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count from datamodel=endpoint.registry where registry.registry_path= "*\\software\\microsoft\\windows\\currentversion\\policies\\system\\disablelockworkstation" registry.registry_value_data = "0x00000001" by _time span=1h registry.dest registry.user registry.registry_path registry.registry_value_name registry.registry_value_data registry.process_guid | `drop_dm_object_name(registry)` |rename process_guid as proc_guid |join proc_guid, _time [| tstats `security_content_summariesonly` count from datamodel=endpoint.processes by _time span=1h processes.process_id processes.process_name processes.process processes.dest processes.parent_process_name processes.parent_process processes.process_guid | `drop_dm_object_name(processes)` |rename process_guid as proc_guid | fields _time dest user parent_process_name parent_process process_name process_path process proc_guid registry_path registry_value_name registry_value_data] | table _time dest user parent_process_name parent_process process_name process_path process proc_guid registry_path registry_value_name registry_value_data | `windows_disable_lock_workstation_feature_through_registry_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count from datamodel=endpoint.registry where registry.registry_path= "*\\software\\microsoft\\windows\\currentversion\\policies\\system\\disableregistrytools" registry.registry_value_data = "0x00000001" by _time span=1h registry.dest registry.user registry.registry_path registry.registry_value_name registry.registry_value_data registry.process_guid | `drop_dm_object_name(registry)` |rename process_guid as proc_guid |join proc_guid, _time [| tstats `security_content_summariesonly` count from datamodel=endpoint.processes by _time span=1h processes.process_id processes.process_name processes.process processes.dest processes.parent_process_name processes.parent_process processes.process_guid | `drop_dm_object_name(processes)` |rename process_guid as proc_guid | fields _time dest user parent_process_name parent_process process_name process_path process proc_guid registry_path registry_value_name registry_value_data] | table _time dest user parent_process_name parent_process process_name process_path process proc_guid registry_path registry_value_name registry_value_data | `disable_registry_tool_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count from datamodel=endpoint.registry where registry.registry_path= "*\\software\\microsoft\\windows\\currentversion\\policies\\system\\disabletaskmgr" registry.registry_value_data = "0x00000001" by _time span=1h registry.dest registry.user registry.registry_path registry.registry_value_name registry.registry_key_name registry.process_guid registry.registry_value_data | `drop_dm_object_name(registry)` |rename process_guid as proc_guid |join proc_guid, _time [| tstats `security_content_summariesonly` count from datamodel=endpoint.processes by _time span=1h processes.process_id processes.process_name processes.process processes.dest processes.parent_process_name processes.parent_process processes.process_guid | `drop_dm_object_name(processes)` |rename process_guid as proc_guid | fields _time dest user parent_process_name parent_process process_name process_path process proc_guid registry_path registry_value_name registry_value_data registry_key_name] | table _time dest user parent_process_name parent_process process_name process_path process proc_guid registry_path registry_value_name registry_value_data registry_key_name | `disabling_task_manager_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count from datamodel=endpoint.registry where registry.registry_path= "*\\software\\policies\\microsoft\\windows defender\\real-time protection\\disablebehaviormonitoring" or registry.registry_path= "*\\software\\policies\\microsoft\\windows defender\\real-time protection\\disableonaccessprotection" or registry.registry_path= "*\\software\\policies\\microsoft\\windows defender\\real-time protection\\disablescanonrealtimeenable" or registry.registry_path= "*\\software\\microsoft\\windows defender\\real-time protection\\disablerealtimemonitoring" or registry.registry_path= "*\\real-time protection\\disableintrusionpreventionsystem" or registry.registry_path= "*\\real-time protection\\disableioavprotection" or registry.registry_path= "*\\real-time protection\\disablescriptscanning" and registry.registry_value_data = "0x00000001" by _time span=1h registry.dest registry.user registry.registry_path registry.registry_value_name registry.registry_value_data registry.process_guid | `drop_dm_object_name(registry)` |rename process_guid as proc_guid |join proc_guid, _time [| tstats `security_content_summariesonly` count from datamodel=endpoint.processes by _time span=1h processes.process_id processes.process_name processes.process processes.dest processes.parent_process_name processes.parent_process processes.process_guid | `drop_dm_object_name(processes)` |rename process_guid as proc_guid | fields _time dest user parent_process_name parent_process process_name process_path process proc_guid registry_path registry_value_name registry_value_data] | table _time dest user parent_process_name parent_process process_name process_path process proc_guid registry_path registry_value_name registry_value_data | `disable_windows_behavior_monitoring_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count from datamodel=endpoint.registry where registry.registry_path= "*\\software\\policies\\microsoft\\windows\\system\\disablecmd" registry.registry_value_data = "0x00000001" by _time span=1h registry.dest registry.user registry.registry_path registry.registry_value_name registry.registry_key_name registry.process_guid registry.registry_value_data | `drop_dm_object_name(registry)` |rename process_guid as proc_guid |join proc_guid, _time [| tstats `security_content_summariesonly` count from datamodel=endpoint.processes by _time span=1h processes.process_id processes.process_name processes.process processes.dest processes.parent_process_name processes.parent_process processes.process_guid | `drop_dm_object_name(processes)` |rename process_guid as proc_guid | fields _time dest user parent_process_name parent_process process_name process_path process proc_guid registry_path registry_value_name registry_value_data registry_key_name] | table _time dest user parent_process_name parent_process process_name process_path process proc_guid registry_path registry_value_name registry_value_data registry_key_name | `disabling_cmd_application_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count from datamodel=endpoint.registry where registry.registry_path= "*\\system\\currentcontrolset\\services\\sharedaccess\\parameters\\firewallpolicy\\firewallrules\\*" registry.registry_value_data = "*|action=allow|*" registry.registry_value_data = "*|dir=in|*" registry.registry_value_data = "*|lport=*" by _time span=1h registry.dest registry.user registry.registry_path registry.registry_value_name registry.process_guid registry.registry_key_name registry.registry_value_data | `drop_dm_object_name(registry)` |rename process_guid as proc_guid |join proc_guid, _time [| tstats `security_content_summariesonly` count from datamodel=endpoint.processes by _time span=1h processes.process_id processes.process_name processes.process processes.dest processes.parent_process_name processes.parent_process processes.process_guid | `drop_dm_object_name(processes)` |rename process_guid as proc_guid | fields _time dest user parent_process_name parent_process process_name process_path process proc_guid registry_path registry_value_name registry_value_data registry_key_name] | table _time dest user parent_process_name parent_process process_name process_path process proc_guid registry_path registry_value_name registry_value_data registry_key_name | `allow_inbound_traffic_by_firewall_rule_registry_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count from datamodel=endpoint.registry where registry.registry_path= "*hklm\\software\\microsoft\\windows\\currentversion\\explorer\\smartscreenenabled" registry.registry_value_data= "off" by _time span=1h registry.dest registry.user registry.registry_path registry.registry_value_name registry.registry_value_data registry.process_guid | `drop_dm_object_name(registry)` |rename process_guid as proc_guid |join proc_guid, _time [| tstats `security_content_summariesonly` count from datamodel=endpoint.processes by _time span=1h processes.process_id processes.process_name processes.process processes.dest processes.parent_process_name processes.parent_process processes.process_guid | `drop_dm_object_name(processes)` |rename process_guid as proc_guid | fields _time dest user parent_process_name parent_process process_name process_path process proc_guid registry_path registry_value_name registry_value_data] | table _time dest user parent_process_name parent_process process_name process_path process proc_guid registry_path registry_value_name registry_value_data | `disable_windows_smartscreen_protection_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count from datamodel=endpoint.registry where registry.registry_path= "*software\\microsoft\\windows nt\\currentversion\\winlogon*" and registry.registry_value_name= defaultpassword or registry.registry_value_name= defaultusername by _time span=1h registry.dest registry.user registry.registry_path registry.registry_value_name registry.process_guid registry.registry_value_data registry.registry_key_name | `drop_dm_object_name(registry)` |rename process_guid as proc_guid |join proc_guid, _time [| tstats `security_content_summariesonly` count from datamodel=endpoint.processes by _time span=1h processes.process_id processes.process_name processes.process processes.dest processes.parent_process_name processes.parent_process processes.process_guid | `drop_dm_object_name(processes)` |rename process_guid as proc_guid | fields _time dest user parent_process_name parent_process process_name process_path process proc_guid registry_path registry_value_name registry_value_data registry_key_name] | table _time dest user parent_process_name parent_process process_name process_path process proc_guid registry_path registry_value_name registry_value_data registry_key_name | `add_defaultuser_and_password_in_registry_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count from datamodel=endpoint.registry where registry.registry_path="*\\control\\minint\\*" by _time span=1h registry.dest registry.user registry.registry_path registry.registry_value_name registry.registry_value_data registry.process_guid | `drop_dm_object_name(registry)` |rename process_guid as proc_guid |join proc_guid, _time [| tstats `security_content_summariesonly` count from datamodel=endpoint.processes by _time span=1h processes.process_id processes.process_name processes.process processes.dest processes.parent_process_name processes.parent_process processes.process_guid | `drop_dm_object_name(processes)` |rename process_guid as proc_guid | fields _time dest user parent_process_name parent_process process_name process_path process proc_guid registry_path registry_value_name registry_value_data] | table _time dest user parent_process_name parent_process process_name process_path process proc_guid registry_path registry_value_name registry_value_data | `disable_security_logs_using_minint_registry_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count from datamodel=endpoint.registry where registry.registry_path="*\\windows nt\\currentversion\\image file execution options\\*" and registry.registry_value_data= "hotkey disabled" and registry.registry_value_name = "debugger" by _time span=1h registry.dest registry.user registry.registry_path registry.registry_value_name registry.registry_key_name registry.process_guid registry.registry_value_data | `drop_dm_object_name(registry)` |rename process_guid as proc_guid |join proc_guid, _time [| tstats `security_content_summariesonly` count from datamodel=endpoint.processes by _time span=1h processes.process_id processes.process_name processes.process processes.dest processes.parent_process_name processes.parent_process processes.process_guid | `drop_dm_object_name(processes)` |rename process_guid as proc_guid | fields _time dest user parent_process_name parent_process process_name process_path process proc_guid registry_path registry_value_name registry_value_data registry_key_name] | table _time dest user parent_process_name parent_process process_name process_path process proc_guid registry_path registry_value_name registry_value_data registry_key_name | `disable_windows_app_hotkeys_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count from datamodel=endpoint.registry where registry.registry_path=*currentversion\\appcompatflags\\custom* or registry.registry_path=*currentversion\\appcompatflags\\installedsdb* by _time span=1h registry.dest registry.user registry.registry_path registry.registry_value_name registry.registry_value_data registry.process_guid | `drop_dm_object_name(registry)` |rename process_guid as proc_guid |join proc_guid, _time [| tstats `security_content_summariesonly` count from datamodel=endpoint.processes by _time span=1h processes.process_id processes.process_name processes.process processes.dest processes.parent_process_name processes.parent_process processes.process_guid | `drop_dm_object_name(processes)` |rename process_guid as proc_guid | fields _time dest user parent_process_name parent_process process_name process_path process proc_guid registry_path registry_value_name registry_value_data] | table _time dest user parent_process_name parent_process process_name process_path process proc_guid registry_path registry_value_name registry_value_data | `registry_keys_for_creating_shim_databases_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count from datamodel=endpoint.registry where registry.registry_value_name= "disablenotificationcenter" registry.registry_value_data = "0x00000001" by _time span=1h registry.dest registry.user registry.registry_path registry.registry_value_name registry.registry_key_name registry.process_guid registry.registry_value_data | `drop_dm_object_name(registry)` |rename process_guid as proc_guid |join proc_guid, _time [| tstats `security_content_summariesonly` count from datamodel=endpoint.processes by _time span=1h processes.process_id processes.process_name processes.process processes.dest processes.parent_process_name processes.parent_process processes.process_guid | `drop_dm_object_name(processes)` |rename process_guid as proc_guid | fields _time dest user parent_process_name parent_process process_name process_path process proc_guid registry_path registry_value_name registry_value_data registry_key_name] | table _time dest user parent_process_name parent_process process_name process_path process proc_guid registry_path registry_value_name registry_value_data registry_key_name | `windows_disable_notification_center_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count from datamodel=endpoint.registry where registry.registry_value_name= "stubpath" registry.registry_path = "*\\software\\microsoft\\active setup\\installed components*" by _time span=1h registry.dest registry.user registry.registry_path registry.registry_value_name registry.registry_value_data registry.process_guid | `drop_dm_object_name(registry)` |rename process_guid as proc_guid |join proc_guid, _time [| tstats `security_content_summariesonly` count from datamodel=endpoint.processes by _time span=1h processes.process_id processes.process_name processes.process processes.dest processes.parent_process_name processes.parent_process processes.process_guid | `drop_dm_object_name(processes)` |rename process_guid as proc_guid | fields _time dest user parent_process_name parent_process process_name process_path process proc_guid registry_path registry_value_name registry_value_data] | table _time dest user parent_process_name parent_process process_name process_path process proc_guid registry_path registry_value_name registry_value_data | `active_setup_registry_autostart_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count from datamodel=network_resolution where dns.dest_category != dns_server and dns.src_category != dns_server by dns.src dns.dest | `drop_dm_object_name("dns")` | `dns_query_requests_resolved_by_unauthorized_dns_servers_filter` '
<li><a href="#">search: '| tstats `security_content_summariesonly` count from datamodel=network_resolution where dns.query_type in (sig,key) by dns.flow_id | rename dns.flow_id as flow_id | append [| tstats `security_content_summariesonly` count from datamodel=network_traffic where all_traffic.bytes_in>65000 by all_traffic.flow_id | rename all_traffic.flow_id as flow_id] | `detect_windows_dns_sigred_via_zeek_filter` | stats count by flow_id | where count>1 | fields - count '
<li><a href="#">search: '| tstats `security_content_summariesonly` count from datamodel=network_resolution where nodename=dns "dns.message_type"="query" "dns.record_type"="any" by "dns.dest" | `drop_dm_object_name("dns")` | where count>200 | `large_volume_of_dns_any_queries_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count from datamodel=network_resolution where nodename=dns "dns.reply_code"!="no error" "dns.reply_code"!="noerror" dns.reply_code!="unknown" not "dns.query"="*.arpa" "dns.query"="*.*" by "dns.src" "dns.query" "dns.reply_code" | `drop_dm_object_name("dns")` | lookup cim_corporate_web_domain_lookup domain as query output domain | where isnull(domain) | lookup update=true alexa_lookup_by_str domain as query output rank | where isnull(rank) | eventstats max(count) as mc by src reply_code | eval mode_query=if(count=mc, query, null()) | stats sum(count) as count values(mode_query) as query values(mc) as max_query_count by src reply_code | where count>50 | `get_asset(src)` | `excessive_dns_failures_filter` '
<li><a href="#">search: '| tstats `security_content_summariesonly` count from datamodel=network_resolution where not dns.message_type in("pointer","ptr") by dns.query | `drop_dm_object_name("dns")` | eval tlds=split(query,".") | eval tld=mvindex(tlds,-1) | eval tld_len=len(tld) | search tld_len<=24 | eval query_length = len(query) | table query query_length record_type count | eventstats stdev(query_length) as stdev avg(query_length) as avg p50(query_length) as p50| where query_length>(avg+stdev*2) | eval z_score=(query_length-avg)/stdev | `dns_query_length_with_high_standard_deviation_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count from datamodel=network_traffic where all_traffic.dest_port=139 or all_traffic.dest_port=445 or all_traffic.app=smb by _time span=1h, all_traffic.src | `drop_dm_object_name("all_traffic")` | eventstats max(_time) as maxtime | stats count as num_data_samples max(eval(if(_time >= relative_time(maxtime, "-70m@m"), count, null))) as count avg(eval(if(_time<relative_time(maxtime, "-70m@m"), count, null))) as avg stdev(eval(if(_time<relative_time(maxtime, "-70m@m"), count, null))) as stdev by src | eval upperbound=(avg+stdev*2), isoutlier=if(count > upperbound and num_data_samples >=50, 1, 0) | where isoutlier=1 | table src count | `smb_traffic_spike_filter` '
<li><a href="#">search: '| tstats `security_content_summariesonly` count from datamodel=web where web.dest_category=web_server and (web.url_length > 1024 or web.http_user_agent_length > 200) by web.src web.dest web.url web.url_length web.http_user_agent | `drop_dm_object_name("web")` | eval url=lower(url) | eval num_sql_cmds=mvcount(split(url, "alter%20table")) + mvcount(split(url, "between")) + mvcount(split(url, "create%20table")) + mvcount(split(url, "create%20database")) + mvcount(split(url, "create%20index")) + mvcount(split(url, "create%20view")) + mvcount(split(url, "delete")) + mvcount(split(url, "drop%20database")) + mvcount(split(url, "drop%20index")) + mvcount(split(url, "drop%20table")) + mvcount(split(url, "exists")) + mvcount(split(url, "exec")) + mvcount(split(url, "group%20by")) + mvcount(split(url, "having")) + mvcount(split(url, "insert%20into")) + mvcount(split(url, "inner%20join")) + mvcount(split(url, "left%20join")) + mvcount(split(url, "right%20join")) + mvcount(split(url, "full%20join")) + mvcount(split(url, "select")) + mvcount(split(url, "distinct")) + mvcount(split(url, "select%20top")) + mvcount(split(url, "union")) + mvcount(split(url, "xp_cmdshell")) - 24 | where num_sql_cmds > 3 | `sql_injection_with_long_urls_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count from datamodel=web.web where web.url=*logoimagehandler.ashx*codes* or web.url=*logoimagehandler.ashx*clazz* or web.url=*logoimagehandler.ashx*method* or web.url=*logoimagehandler.ashx*args* by web.src web.dest web.url web.vendor_product web.user web.http_user_agent _time span=1s | `supernova_webshell_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel="endpoint.processes" by processes.parent_process_name processes.process_name processes.process processes.user processes.dest | `drop_dm_object_name(processes)` | where len(process) > 200 | `potentially_malicious_code_on_cmdline_tokenize_score` | apply unusual_commandline_detection | eval score=''predicted(unusual_cmdline_logits)'', process=orig_process | fields - unusual_cmdline* predicted(unusual_cmdline_logits) orig_process | where score > 0.5 | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `potentially_malicious_code_on_commandline_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=certificates.all_certificates by all_certificates.ssl.ssl_issuer_email_domain all_certificates.ssl.ssl_issuer all_certificates.ssl.ssl_subject_email all_certificates.ssl.dest all_certificates.ssl.src all_certificates.ssl.sourcetype all_certificates.ssl.ssl_subject_email_domain | `drop_dm_object_name("all_certificates.ssl")` | eval punycode=if(like(ssl_issuer_email_domain,"%xn--%"),1,0) | where punycode=1 | cyberchef infield="ssl_issuer_email_domain" outfield="convertedpuny" jsonrecipe="[{"op":"from punycode","args":[true]}]" | table ssl_issuer_email_domain convertedpuny ssl_issuer ssl_subject_email dest src sourcetype ssl_subject_email_domain | `ssl_certificates_with_punycode_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=change.all_changes where all_changes.result="*locked out*" by all_changes.user all_changes.result |`drop_dm_object_name("all_changes")` |`drop_dm_object_name("account_management")`| `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | search count > 5 | `detect_excessive_user_account_lockouts_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=email where all_email.file_name="*" by all_email.src_user, all_email.file_name all_email.message_id | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `drop_dm_object_name("all_email")` | `suspicious_email_attachments` | `suspicious_email_attachment_extensions_filter` '
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.filesystem where "filesystem.file_path"=c:\\*ryuk* by "filesystem.dest", "filesystem.user", "filesystem.file_path" | `drop_dm_object_name(filesystem)` | `security_content_ctime(lasttime)` | `security_content_ctime(firsttime)` | `ryuk_test_files_detected_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.filesystem where filesystem.action=deleted and filesystem.file_path in ("/etc/ssh/*", "~/.ssh/*") by _time span=1h filesystem.file_name filesystem.file_path filesystem.dest filesystem.process_guid filesystem.action | `drop_dm_object_name(filesystem)` |rename process_guid as proc_guid |join proc_guid, _time [ | tstats `security_content_summariesonly` count from datamodel=endpoint.processes where processes.parent_process_name != unknown by _time span=1h processes.process_id processes.process_name processes.process processes.dest processes.parent_process_name processes.parent_process processes.process_path processes.process_guid | `drop_dm_object_name(processes)` |rename process_guid as proc_guid | fields _time dest user parent_process_name parent_process process_name process_path process proc_guid registry_path registry_value_name registry_value_data registry_key_name action] | table process_name process proc_guid file_name file_path action _time parent_process_name parent_process process_path dest user | `linux_account_manipulation_of_ssh_config_and_keys_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.filesystem where filesystem.action=deleted filesystem.file_path = "/etc/ssl/certs/*" filesystem.file_path in ("*.pem", "*.crt") by _time span=1h filesystem.file_name filesystem.file_path filesystem.dest filesystem.process_guid filesystem.action | `drop_dm_object_name(filesystem)` |rename process_guid as proc_guid |join proc_guid, _time [ | tstats `security_content_summariesonly` count from datamodel=endpoint.processes where processes.parent_process_name != unknown by _time span=1h processes.process_id processes.process_name processes.process processes.dest processes.parent_process_name processes.parent_process processes.process_path processes.process_guid | `drop_dm_object_name(processes)` |rename process_guid as proc_guid | fields _time dest user parent_process_name parent_process process_name process_path process proc_guid registry_path registry_value_name registry_value_data registry_key_name action] | table process_name process proc_guid file_name file_path action _time parent_process_name parent_process process_path dest user | `linux_deletion_of_ssl_certificate_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.filesystem where filesystem.action=deleted filesystem.file_path ="/etc/cron.*" by _time span=1h filesystem.file_name filesystem.file_path filesystem.dest filesystem.process_guid filesystem.action | `drop_dm_object_name(filesystem)` |rename process_guid as proc_guid |join proc_guid, _time [ | tstats `security_content_summariesonly` count from datamodel=endpoint.processes where processes.parent_process_name != unknown by _time span=1h processes.process_id processes.process_name processes.process processes.dest processes.parent_process_name processes.parent_process processes.process_path processes.process_guid | `drop_dm_object_name(processes)` |rename process_guid as proc_guid | fields _time dest user parent_process_name parent_process process_name process_path process proc_guid registry_path registry_value_name registry_value_data registry_key_name action] | table process_name process proc_guid file_name file_path action _time parent_process_name parent_process process_path dest user | `linux_deletion_of_cron_jobs_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.filesystem where filesystem.action=deleted filesystem.file_path in ( "/etc/init.d/*") by _time span=1h filesystem.file_name filesystem.file_path filesystem.dest filesystem.process_guid filesystem.action | `drop_dm_object_name(filesystem)` |rename process_guid as proc_guid |join proc_guid, _time [ | tstats `security_content_summariesonly` count from datamodel=endpoint.processes where processes.parent_process_name != unknown by _time span=1h processes.process_id processes.process_name processes.process processes.dest processes.parent_process_name processes.parent_process processes.process_path processes.process_guid | `drop_dm_object_name(processes)` |rename process_guid as proc_guid | fields _time dest user parent_process_name parent_process process_name process_path process proc_guid registry_path registry_value_name registry_value_data registry_key_name action] | table process_name process proc_guid file_name file_path action _time parent_process_name parent_process process_path dest user | `linux_deletion_of_init_daemon_script_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.filesystem where filesystem.action=deleted filesystem.file_path in ( "/etc/systemd/*", "/usr/lib/systemd/*") filesystem.file_path = "*.service" by _time span=1h filesystem.file_name filesystem.file_path filesystem.dest filesystem.process_guid filesystem.action | `drop_dm_object_name(filesystem)` |rename process_guid as proc_guid |join proc_guid, _time [ | tstats `security_content_summariesonly` count from datamodel=endpoint.processes where processes.parent_process_name != unknown by _time span=1h processes.process_id processes.process_name processes.process processes.dest processes.parent_process_name processes.parent_process processes.process_path processes.process_guid | `drop_dm_object_name(processes)` |rename process_guid as proc_guid | fields _time dest user parent_process_name parent_process process_name process_path process proc_guid registry_path registry_value_name registry_value_data registry_key_name action] | table process_name process proc_guid file_name file_path action _time parent_process_name parent_process process_path dest user | `linux_deletion_of_services_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.filesystem where filesystem.file_name = *.service filesystem.file_path in ("*/etc/systemd/system*", "*/lib/systemd/system*", "*/usr/lib/systemd/system*", "*/run/systemd/system*", "*~/.config/systemd/*", "*~/.local/share/systemd/*","*/etc/systemd/user*", "*/lib/systemd/user*", "*/usr/lib/systemd/user*", "*/run/systemd/user*") by filesystem.dest filesystem.file_create_time filesystem.file_name filesystem.process_guid filesystem.file_path | `drop_dm_object_name(filesystem)` | `security_content_ctime(lasttime)` | `security_content_ctime(firsttime)` | `linux_service_file_created_in_systemd_directory_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.filesystem where filesystem.file_name in ("*-azurecollection.zip", "*-azprivroleadminrights.json", "*-azglobaladminrights.json", "*-azcloudappadmins.json", "*-azapplicationadmins.json") by filesystem.file_create_time filesystem.process_id filesystem.file_name filesystem.file_path filesystem.dest | `drop_dm_object_name(filesystem)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `detect_azurehound_file_modifications_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.filesystem where filesystem.file_name in ("*bloodhound.zip", "*_computers.json", "*_gpos.json", "*_domains.json", "*_users.json", "*_groups.json", "*_ous.json", "*_containers.json") by filesystem.file_create_time filesystem.process_id filesystem.file_name filesystem.file_path filesystem.dest | `drop_dm_object_name(filesystem)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `detect_sharphound_file_modifications_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.filesystem where filesystem.file_name="*.lnk" and (filesystem.file_path="c:\\user\\*" or filesystem.file_path="*\\temp\\*") by _time span=1h filesystem.process_guid filesystem.file_name filesystem.file_path filesystem.file_hash filesystem.user | `drop_dm_object_name(filesystem)` | rename process_guid as lnk_guid | join lnk_guid, _time [| tstats `security_content_summariesonly` count from datamodel=endpoint.processes where processes.process_name=* by _time span=1h processes.parent_process_guid processes.process_id processes.process_name processes.dest processes.process_path processes.process | `drop_dm_object_name(processes)` | rename parent_process_guid as lnk_guid | fields _time lnk_guid process_id dest process_name process_path process] | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | table firsttime, lasttime, lnk_guid, process_id, user, dest, file_name, file_path, process_name, process, process_path, file_hash | `process_creating_lnk_file_in_suspicious_location_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.filesystem where filesystem.file_name="*.sys*" by _time span=1h filesystem.dest filesystem.file_create_time filesystem.file_name filesystem.file_path filesystem.file_hash | `drop_dm_object_name(filesystem)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)`| `windows_system_file_on_disk_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.filesystem where filesystem.file_path in ("*/.ssh*") by filesystem.dest filesystem.file_name filesystem.process_guid filesystem.file_path | `drop_dm_object_name(filesystem)` | `security_content_ctime(lasttime)` | `security_content_ctime(firsttime)` | `linux_possible_ssh_key_file_creation_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.filesystem where filesystem.file_path in ("*/etc/at.allow", "*/etc/at.deny") by filesystem.dest filesystem.file_create_time filesystem.file_name filesystem.process_guid filesystem.file_path | `drop_dm_object_name(filesystem)` | `security_content_ctime(lasttime)` | `security_content_ctime(firsttime)` | `linux_at_allow_config_file_creation_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.filesystem where filesystem.file_path in ("*/etc/cron*", "*/var/spool/cron/*") by filesystem.dest filesystem.file_create_time filesystem.file_name filesystem.process_guid filesystem.file_path | `drop_dm_object_name(filesystem)` | `security_content_ctime(lasttime)` | `security_content_ctime(firsttime)` | `linux_add_files_in_known_crontab_directories_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.filesystem where filesystem.file_path in ("*/etc/doas.conf") by filesystem.dest filesystem.file_create_time filesystem.file_name filesystem.process_guid filesystem.file_path | `drop_dm_object_name(filesystem)` | `security_content_ctime(lasttime)` | `security_content_ctime(firsttime)` | `linux_doas_conf_file_creation_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.filesystem where filesystem.file_path in ("*/etc/init.d/*", "*/etc/rc.d/*", "*/sbin/init.d/*", "*/etc/rc.local*") by filesystem.dest filesystem.file_name filesystem.process_guid filesystem.file_path | `drop_dm_object_name(filesystem)` | `security_content_ctime(lasttime)` | `security_content_ctime(firsttime)` | `linux_file_creation_in_init_boot_directory_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.filesystem where filesystem.file_path in ("*/etc/profile.d/*") by filesystem.dest filesystem.file_create_time filesystem.file_name filesystem.process_guid filesystem.file_path | `drop_dm_object_name(filesystem)` | `security_content_ctime(lasttime)` | `security_content_ctime(firsttime)` | `linux_file_creation_in_profile_directory_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.filesystem where filesystem.file_path in ("*/kernel/drivers/*") by filesystem.dest filesystem.file_name filesystem.process_guid filesystem.file_path | `drop_dm_object_name(filesystem)` | `security_content_ctime(lasttime)` | `security_content_ctime(firsttime)` | `linux_file_created_in_kernel_driver_directory_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.filesystem where filesystem.file_path in ("*\\microsoft\\windows\\recent\\*") filesystem.file_name in ("*.iso.lnk", "*.img.lnk", "*.vhd.lnk", "*vhdx.lnk") by filesystem.file_create_time filesystem.process_id filesystem.file_name filesystem.file_path filesystem.dest | `drop_dm_object_name(filesystem)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `windows_iso_lnk_file_creation_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.filesystem where filesystem.file_path in ("*sudoers.tmp*") by filesystem.dest filesystem.file_name filesystem.process_guid filesystem.file_path | `drop_dm_object_name(filesystem)` | `security_content_ctime(lasttime)` | `security_content_ctime(firsttime)` | `linux_sudoers_tmp_file_creation_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes by _time span=1h processes.user processes.process_id processes.process_name processes.process processes.process_path processes.dest processes.parent_process_name processes.parent_process processes.process_guid | `drop_dm_object_name(processes)` | join process_guid [ | tstats `security_content_summariesonly` count from datamodel=endpoint.registry where (registry.registry_path = "*\\policies\\microsoft\\windows defender*" registry.registry_value_name in ("disableantispyware","disableantivirus") registry.registry_value_data = 0x00000001) by _time span=1h registry.registry_path registry.registry_key_name registry.registry_value_name registry.registry_value_data registry.process_guid | `drop_dm_object_name(registry)`] | fields firsttime lasttime dest user parent_process_name parent_process process_name process_path process registry_key_name registry_path registry_value_name registry_value_data process_guid | where isnotnull(registry_value_data) | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `disable_defender_antivirus_registry_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes by processes.dest processes.user processes.parent_process processes.process_name processes.process processes.original_file_name processes.process_path processes.process_id processes.parent_process_id | `drop_dm_object_name("processes")` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `is_nirsoft_software` | `windows_nirsoft_utilities_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes by processes.dest processes.user processes.process processes.process_name | `security_content_ctime(firsttime)`| `security_content_ctime(lasttime)` | `drop_dm_object_name(processes)` | `uncommon_processes` |`uncommon_processes_on_endpoint_filter` '
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes by processes.dest, processes.user, processes.process, processes.process_name | `drop_dm_object_name(processes)` | `security_content_ctime(lasttime)` | `security_content_ctime(firsttime)` | eval process_name_length = len(process_name), endexe = if(substr(process_name, -4) == ".exe", 1, 0) | search process_name_length=5 and endexe=1 | table count, firsttime, lasttime, dest, user, process, process_name | `single_letter_process_on_endpoint_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes by processes.original_file_name processes.process_id processes.parent_process_id processes.process_hash processes.dest processes.user processes.parent_process processes.process_name processes.process | `drop_dm_object_name("processes")` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | eval count_of_pattern1 = (mvcount(split(process,"/.."))-1) | eval count_of_pattern2 = (mvcount(split(process,"\.."))-1) | eval count_of_pattern3 = (mvcount(split(process,"\\.."))-1) | eval count_of_pattern4 = (mvcount(split(process,"//.."))-1) | search count_of_pattern1 > 1 or count_of_pattern2 > 1 or count_of_pattern3 > 1 or count_of_pattern4 > 1 | `windows_command_and_scripting_interpreter_hunting_path_traversal_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where ("processes.process_name"="net*.exe" "processes.process"="*stop \"samss\"*") by "processes.dest", "processes.user", "processes.process" | `drop_dm_object_name(processes)` | `security_content_ctime(lasttime)` | `security_content_ctime(firsttime)` | `windows_security_account_manager_stopped_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where (processes.original_file_name=7z*.exe and processes.process_name!=7z*.exe) by processes.dest processes.user processes.parent_process_name processes.process_name processes.process processes.process_id processes.parent_process_id processes.original_file_name | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `detect_renamed_7_zip_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where (processes.original_file_name=rclone.exe and processes.process_name!=rclone.exe) by processes.dest processes.user processes.parent_process_name processes.process_name processes.process processes.process_id processes.parent_process_id processes.original_file_name | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `detect_renamed_rclone_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where (processes.parent_process_name = "calc.exe") and processes.process_name != "win32calc.exe" by processes.parent_process processes.process_name processes.process_id processes.process_guid processes.process processes.user processes.dest | `drop_dm_object_name("processes")` | `security_content_ctime(firsttime)` |`security_content_ctime(lasttime)` | `windows_dll_side_loading_process_child_of_calc_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where (processes.parent_process_name = "cscript.exe" and processes.parent_process = "*//e:jscript*") or (processes.process_name = "cscript.exe" and processes.process = "*//e:jscript*") by processes.parent_process_name processes.parent_process processes.process_name processes.process_id processes.process processes.dest processes.user | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `jscript_execution_using_cscript_app_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where (processes.parent_process_name = "winword.exe" or processes.parent_process_name = "excel.exe" or processes.parent_process_name = "powerpnt.exe" or processes.parent_process_name = "outlook.exe") `process_regsvr32` by processes.parent_process_name processes.parent_process processes.process_name processes.original_file_name processes.process processes.process_id processes.process_guid processes.user processes.dest | `drop_dm_object_name("processes")` | `security_content_ctime(firsttime)` |`security_content_ctime(lasttime)` | `office_application_spawn_regsvr32_process_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where (processes.parent_process_name = "winword.exe" or processes.parent_process_name = "excel.exe" or processes.parent_process_name = "powerpnt.exe") and `process_rundll32` by processes.parent_process processes.process_name processes.process_id processes.process_guid processes.process processes.user processes.dest | `drop_dm_object_name("processes")` | `security_content_ctime(firsttime)` |`security_content_ctime(lasttime)` | `office_application_spawn_rundll32_process_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where (processes.parent_process_name = "winword.exe" or processes.parent_process_name= "excel.exe" or processes.parent_process_name = "powerpnt.exe") `process_cmd` by processes.parent_process processes.process_name processes.process processes.process_id processes.process_guid processes.user processes.dest processes.original_file_name | `drop_dm_object_name("processes")` | `security_content_ctime(firsttime)` |`security_content_ctime(lasttime)` | `office_product_spawn_cmd_process_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where (processes.parent_process_name = "wscript.exe" and processes.parent_process = "*//e:vbscript*") or (processes.process_name = "wscript.exe" and processes.process = "*//e:vbscript*") by processes.parent_process_name processes.parent_process processes.process_name processes.process_id processes.process processes.dest processes.user | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `vbscript_execution_using_wscript_app_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where (processes.parent_process_name in ("cmd.exe", "powershell.exe") processes.process_name=mofcomp.exe) or (processes.process_name=mofcomp.exe processes.process in ("*\\appdata\\local\\*","*\\users\\public\\*", "*\\windows\\temp\\*")) by processes.dest processes.user processes.parent_process_name processes.process_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `windows_mof_event_triggered_execution_via_wmi_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where (processes.parent_process_name=mmc.exe) (processes.process_name in ("regsvcs.exe", "ftp.exe", "offlinescannershell.exe", "rasautou.exe", "schtasks.exe", "xwizard.exe", "dllhost.exe", "pnputil.exe", "atbroker.exe", "pcwrun.exe", "ttdinject.exe","mshta.exe", "bitsadmin.exe", "certoc.exe", "ieexec.exe", "microsoft.workflow.compiler.exe", "runscripthelper.exe", "forfiles.exe", "msbuild.exe", "register-cimprovider.exe", "tttracer.exe", "ie4uinit.exe", "bash.exe", "hh.exe", "settingsynchost.exe", "cmstp.exe", "mmc.exe", "stordiag.exe", "scriptrunner.exe", "odbcconf.exe", "extexport.exe", "msdt.exe", "workfolders.exe", "diskshadow.exe", "mavinject.exe", "regasm.exe", "gpscript.exe", "rundll32.exe", "regsvr32.exe", "msiexec.exe", "wuauclt.exe", "presentationhost.exe", "wmic.exe", "runonce.exe", "syncappvpublishingserver.exe", "verclsid.exe", "infdefaultinstall.exe", "explorer.exe", "installutil.exe", "netsh.exe", "wab.exe", "dnscmd.exe", "at.exe", "pcalua.exe", "msconfig.exe")) by processes.dest processes.user processes.parent_process processes.process_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `mmc_lolbas_execution_process_spawn_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where (processes.parent_process_name=services.exe) (processes.process_name in ("regsvcs.exe", "ftp.exe", "offlinescannershell.exe", "rasautou.exe", "schtasks.exe", "xwizard.exe", "dllhost.exe", "pnputil.exe", "atbroker.exe", "pcwrun.exe", "ttdinject.exe","mshta.exe", "bitsadmin.exe", "certoc.exe", "ieexec.exe", "microsoft.workflow.compiler.exe", "runscripthelper.exe", "forfiles.exe", "msbuild.exe", "register-cimprovider.exe", "tttracer.exe", "ie4uinit.exe", "bash.exe", "hh.exe", "settingsynchost.exe", "cmstp.exe", "mmc.exe", "stordiag.exe", "scriptrunner.exe", "odbcconf.exe", "extexport.exe", "msdt.exe", "workfolders.exe", "diskshadow.exe", "mavinject.exe", "regasm.exe", "gpscript.exe", "rundll32.exe", "regsvr32.exe", "msiexec.exe", "wuauclt.exe", "presentationhost.exe", "wmic.exe", "runonce.exe", "syncappvpublishingserver.exe", "verclsid.exe", "infdefaultinstall.exe", "explorer.exe", "installutil.exe", "netsh.exe", "wab.exe", "dnscmd.exe", "at.exe", "pcalua.exe", "msconfig.exe")) by processes.dest processes.user processes.parent_process processes.process_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `services_lolbas_execution_process_spawn_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where (processes.parent_process_name=svchost.exe) (processes.process_name in ("regsvcs.exe", "ftp.exe", "offlinescannershell.exe", "rasautou.exe", "schtasks.exe", "xwizard.exe", "pnputil.exe", "atbroker.exe", "pcwrun.exe", "ttdinject.exe","mshta.exe", "bitsadmin.exe", "certoc.exe", "ieexec.exe", "microsoft.workflow.compiler.exe", "runscripthelper.exe", "forfiles.exe", "msbuild.exe", "register-cimprovider.exe", "tttracer.exe", "ie4uinit.exe", "bash.exe", "hh.exe", "settingsynchost.exe", "cmstp.exe", "stordiag.exe", "scriptrunner.exe", "odbcconf.exe", "extexport.exe", "msdt.exe", "workfolders.exe", "diskshadow.exe", "mavinject.exe", "regasm.exe", "gpscript.exe", "regsvr32.exe", "msiexec.exe", "wuauclt.exe", "presentationhost.exe", "wmic.exe", "runonce.exe", "syncappvpublishingserver.exe", "verclsid.exe", "infdefaultinstall.exe", "installutil.exe", "netsh.exe", "wab.exe", "dnscmd.exe", "at.exe", "pcalua.exe", "msconfig.exe")) by processes.dest processes.user processes.parent_process processes.process_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `svchost_lolbas_execution_process_spawn_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where (processes.parent_process_name=wmiprvse.exe or processes.parent_process_name=services.exe or processes.parent_process_name=svchost.exe or processes.parent_process_name=wsmprovhost.exe or processes.parent_process_name=mmc.exe) (processes.process_name=powershell.exe or (processes.process_name=cmd.exe and processes.process=*powershell.exe*) or processes.process_name=pwsh.exe or (processes.process_name=cmd.exe and processes.process=*pwsh.exe*)) by processes.dest processes.user processes.parent_process processes.process_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `possible_lateral_movement_powershell_spawn_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where (processes.parent_process_name=wmiprvse.exe) (processes.process_name in ("regsvcs.exe", "ftp.exe", "offlinescannershell.exe", "rasautou.exe", "schtasks.exe", "xwizard.exe", "dllhost.exe", "pnputil.exe", "atbroker.exe", "pcwrun.exe", "ttdinject.exe","mshta.exe", "bitsadmin.exe", "certoc.exe", "ieexec.exe", "microsoft.workflow.compiler.exe", "runscripthelper.exe", "forfiles.exe", "msbuild.exe", "register-cimprovider.exe", "tttracer.exe", "ie4uinit.exe", "bash.exe", "hh.exe", "settingsynchost.exe", "cmstp.exe", "mmc.exe", "stordiag.exe", "scriptrunner.exe", "odbcconf.exe", "extexport.exe", "msdt.exe", "workfolders.exe", "diskshadow.exe", "mavinject.exe", "regasm.exe", "gpscript.exe", "rundll32.exe", "regsvr32.exe", "msiexec.exe", "wuauclt.exe", "presentationhost.exe", "wmic.exe", "runonce.exe", "syncappvpublishingserver.exe", "verclsid.exe", "infdefaultinstall.exe", "explorer.exe", "installutil.exe", "netsh.exe", "wab.exe", "dnscmd.exe", "at.exe", "pcalua.exe", "msconfig.exe")) by processes.dest processes.user processes.parent_process processes.process_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `wmiprsve_lolbas_execution_process_spawn_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where (processes.parent_process_name=wsmprovhost.exe) (processes.process_name in ("regsvcs.exe", "ftp.exe", "offlinescannershell.exe", "rasautou.exe", "schtasks.exe", "xwizard.exe", "dllhost.exe", "pnputil.exe", "atbroker.exe", "pcwrun.exe", "ttdinject.exe","mshta.exe", "bitsadmin.exe", "certoc.exe", "ieexec.exe", "microsoft.workflow.compiler.exe", "runscripthelper.exe", "forfiles.exe", "msbuild.exe", "register-cimprovider.exe", "tttracer.exe", "ie4uinit.exe", "bash.exe", "hh.exe", "settingsynchost.exe", "cmstp.exe", "mmc.exe", "stordiag.exe", "scriptrunner.exe", "odbcconf.exe", "extexport.exe", "msdt.exe", "workfolders.exe", "diskshadow.exe", "mavinject.exe", "regasm.exe", "gpscript.exe", "rundll32.exe", "regsvr32.exe", "msiexec.exe", "wuauclt.exe", "presentationhost.exe", "wmic.exe", "runonce.exe", "syncappvpublishingserver.exe", "verclsid.exe", "infdefaultinstall.exe", "explorer.exe", "installutil.exe", "netsh.exe", "wab.exe", "dnscmd.exe", "at.exe", "pcalua.exe", "msconfig.exe")) by processes.dest processes.user processes.parent_process processes.process_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)`| `wsmprovhost_lolbas_execution_process_spawn_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where (processes.process = "*/c* \\\\127.0.0.1\\*" or processes.process= "*/c* 2>&1") by processes.dest processes.user processes.parent_process_name processes.process_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)`| `security_content_ctime(lasttime)` | `impacket_lateral_movement_commandline_parameters_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where (processes.process = "*add-mppreference *" or processes.process = "*set-mppreference *") and processes.process="*-exclusion*" by processes.dest processes.user processes.parent_process processes.parent_process_name processes.process_name processes.original_file_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `add_or_set_windows_defender_exclusion_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where (processes.process = "*ptt /ticket*" or processes.process = "* monitor /interval*" or processes.process ="* asktgt* /user:*" or processes.process ="* asktgs* /service:*" or processes.process ="* golden* /user:*" or processes.process ="* silver* /service:*" or processes.process ="* kerberoast*" or processes.process ="* asreproast*" or processes.process = "* renew* /ticket:*" or processes.process = "* brute* /password:*" or processes.process = "* brute* /passwords:*" or processes.process ="* harvest*") by processes.dest processes.user processes.parent_process processes.process_name processes.process processes.process_id processes.parent_process_id processes.parent_process_name | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `rubeus_command_line_parameters_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where (processes.process = "*sekurlsa::tickets /export*" or processes.process = "*kerberos::ptt*") by processes.dest processes.user processes.parent_process processes.process_name processes.process processes.process_id processes.parent_process_id processes.parent_process_name | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `mimikatz_passtheticket_commandline_parameters_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where (processes.process_name = "ipconfig.exe" or processes.process_name = "systeminfo.exe" or processes.process_name = "net.exe" or processes.process_name = "net1.exe" or processes.process_name = "arp.exe" or processes.process_name = "nslookup.exe" or processes.process_name = "route.exe" or processes.process_name = "netstat.exe" or processes.process_name = "whoami.exe") and not (processes.parent_process_name = "cmd.exe" or processes.parent_process_name = "powershell*" or processes.parent_process_name="pwsh.exe" or processes.parent_process_name = "explorer.exe") by processes.parent_process_name processes.parent_process processes.process_name processes.original_file_name processes.process_id processes.process processes.dest processes.user | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `cmdline_tool_not_executed_in_cmd_shell_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where (processes.process_name = "nslookup.exe" or processes.original_file_name = "nslookup.exe") and processes.process = "*_ldap._tcp.dc._msdcs*" by processes.parent_process processes.parent_process_name processes.process_name processes.process_id processes.process_guid processes.process processes.user processes.dest processes.parent_process_id processes.original_file_name | `drop_dm_object_name("processes")` | `security_content_ctime(firsttime)` |`security_content_ctime(lasttime)` | `windows_system_discovery_using_ldap_nslookup_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where (processes.process_name = chmod or processes.process = "*chmod *") and processes.process in("* g+s *", "* u+s *", "* 4777 *", "* 4577 *") by processes.dest processes.user processes.parent_process_name processes.process_name processes.process processes.process_id processes.parent_process_id processes.process_guid | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `linux_setuid_using_chmod_utility_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where (processes.process_name = chown or processes.process = "*chown *") and processes.process = "* root *" by processes.dest processes.user processes.parent_process_name processes.process_name processes.process processes.process_id processes.parent_process_id processes.process_guid | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `linux_change_file_owner_to_root_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where (processes.process_name = schtasks.exe or processes.original_file_name=schtasks.exe) (processes.process="*/create*" and processes.process="*/s*") by processes.process_name processes.process processes.parent_process_name processes.dest processes.user | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `schtasks_scheduling_job_on_remote_system_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where (processes.process_name = setcap or processes.process = "*setcap *") and processes.process in ("* cap_setuid=ep *", "* cap_setuid+ep *", "* cap_net_bind_service+p *", "* cap_net_raw+ep *", "* cap_dac_read_search+ep *") by processes.dest processes.user processes.parent_process_name processes.process_name processes.process processes.process_id processes.parent_process_id processes.process_guid | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `linux_setuid_using_setcap_utility_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where (processes.process_name in ("systemctl", "service") or processes.process in ("*systemctl *", "*service *")) processes.process in ("* start *", "* enable *") by processes.dest processes.user processes.parent_process_name processes.process_name processes.process processes.process_id processes.parent_process_id processes.process_guid | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `linux_service_started_or_enabled_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where (processes.process_name in ("systemctl", "service") or processes.process in ("*systemctl *", "*service *")) processes.process in ("*restart*", "*reload*", "*reenable*") by processes.dest processes.user processes.parent_process_name processes.process_name processes.process processes.process_id processes.parent_process_id processes.process_guid | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `linux_service_restarted_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where (processes.process_name in("nano","vim.basic") or processes.process in ("*nano *", "*vi *", "*vim *")) and processes.process in("*/etc/cron*", "*/var/spool/cron/*", "*/etc/anacrontab*") by processes.dest processes.user processes.parent_process_name processes.process_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `linux_possible_cronjob_modification_with_editor_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where (processes.process_name!=psexec.exe or processes.process_name!=psexec64.exe) and processes.original_file_name=psexec.c by processes.dest processes.user processes.parent_process_name processes.process_name processes.process processes.process_id processes.parent_process_id processes.original_file_name | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `detect_renamed_psexec_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where (processes.process_name="arp.exe") (processes.process=*-a*) by processes.dest processes.user processes.parent_process processes.process_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `network_connection_discovery_with_arp_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where (processes.process_name="cmd.exe" or processes.process_name="powershell*") and processes.process = "*get-addefaultdomainpasswordpolicy*" by processes.dest processes.user processes.parent_process processes.process_name processes.process processes.process_id processes.parent_process_id processes.parent_process_name | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `get_addefaultdomainpasswordpolicy_with_powershell_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where (processes.process_name="cmd.exe" or processes.process_name="powershell*") and processes.process = "*get-aduser*" and processes.process = "*-filter*" by processes.dest processes.user processes.parent_process processes.process_name processes.process processes.process_id processes.parent_process_id processes.parent_process_name | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `get_aduser_with_powershell_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where (processes.process_name="cmd.exe" or processes.process_name="powershell*") and processes.process = "*get-aduserresultantpasswordpolicy*" by processes.dest processes.user processes.parent_process processes.process_name processes.process processes.process_id processes.parent_process_id processes.parent_process_name | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `get_aduserresultantpasswordpolicy_with_powershell_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where (processes.process_name="cmd.exe" or processes.process_name="powershell*") and processes.process = "*get-domainpolicy*" by processes.dest processes.user processes.parent_process processes.process_name processes.process processes.process_id processes.parent_process_id processes.parent_process_name | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `get_domainpolicy_with_powershell_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where (processes.process_name="cmd.exe" or processes.process_name="powershell*") and processes.process = "*get-domainuser*" by processes.dest processes.user processes.parent_process processes.process_name processes.process processes.process_id processes.parent_process_id processes.parent_process_name | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `get_domainuser_with_powershell_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where (processes.process_name="cmd.exe" or processes.process_name="powershell*") and processes.process = "*get-wmiobject*" and processes.process = "*ds_user*" and processes.process = "*root\\directory\\ldap*" and processes.process = "*-namespace*" by processes.dest processes.user processes.parent_process processes.process_name processes.process processes.process_id processes.parent_process_id processes.parent_process_name | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `getwmiobject_ds_user_with_powershell_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where (processes.process_name="dcrypt.exe" or processes.original_file_name=dcinst.exe) by processes.dest processes.user processes.parent_process_name processes.process_name processes.original_file_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `windows_diskcryptor_usage_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where (processes.process_name="dsquery.exe") (processes.process="*computer*") by processes.dest processes.user processes.parent_process processes.process_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `remote_system_discovery_with_dsquery_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where (processes.process_name="dsquery.exe") (processes.process="*group*") by processes.dest processes.user processes.parent_process processes.process_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `domain_group_discovery_with_dsquery_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where (processes.process_name="net.exe" or processes.process_name="net1.exe") (processes.process="*domain computers*" and processes.process=*/do*) or (processes.process="*view*" and processes.process=*/do*) by processes.dest processes.user processes.parent_process processes.process_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `remote_system_discovery_with_net_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where (processes.process_name="net.exe" or processes.process_name="net1.exe") (processes.process="*group*" and processes.process="*/do*") (processes.process="*domain admins*" or processes.process="*enterprise admins*" or processes.process="*schema admins*" or processes.process="*account operators*" or processes.process="*server operators*" or processes.process="*protected users*" or processes.process="*dns admins*") by processes.dest processes.user processes.parent_process processes.process_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `elevated_group_discovery_with_net_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where (processes.process_name="net.exe" or processes.process_name="net1.exe") (processes.process=*group* and processes.process=*/do*) by processes.dest processes.user processes.parent_process processes.process_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `domain_group_discovery_with_net_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where (processes.process_name="net.exe" or processes.process_name="net1.exe") (processes.process=*use*) by processes.dest processes.user processes.parent_process processes.process_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `network_connection_discovery_with_net_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where (processes.process_name="net.exe" or processes.process_name="net1.exe") and processes.process = "*accounts*" and processes.process = "*/domain*" by processes.dest processes.user processes.parent_process processes.process_name processes.process processes.process_id processes.parent_process_id processes.parent_process_name | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `password_policy_discovery_with_net_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where (processes.process_name="netstat.exe") (processes.process=*-a*) by processes.dest processes.user processes.parent_process processes.process_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `network_connection_discovery_with_netstat_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where (processes.process_name="nltest.exe") (processes.process="*/dclist:*" or processes.process="*/dsgetdc:*") by processes.dest processes.user processes.parent_process processes.process_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `domain_controller_discovery_with_nltest_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where (processes.process_name="powershell.exe") (processes.process="*$env:username*" or processes.process="*[system.environment]::username*") by processes.dest processes.user processes.parent_process processes.process_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `user_discovery_with_env_vars_powershell_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where (processes.process_name="powershell.exe") (processes.process=*get-adcomputer*) by processes.dest processes.user processes.parent_process processes.process_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `getadcomputer_with_powershell_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where (processes.process_name="powershell.exe") (processes.process=*get-adgroup*) by processes.dest processes.user processes.parent_process processes.process_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `getadgroup_with_powershell_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where (processes.process_name="powershell.exe") (processes.process=*get-domaincomputer*) by processes.dest processes.user processes.parent_process processes.process_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `getdomaincomputer_with_powershell_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where (processes.process_name="powershell.exe") (processes.process=*get-domaincontroller*) by processes.dest processes.user processes.parent_process processes.process_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `getdomaincontroller_with_powershell_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where (processes.process_name="powershell.exe") (processes.process=*get-domaingroup*) by processes.dest processes.user processes.parent_process processes.process_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `getdomaingroup_with_powershell_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where (processes.process_name="powershell.exe") (processes.process=*get-localuser*) by processes.dest processes.user processes.parent_process processes.process_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `getlocaluser_with_powershell_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where (processes.process_name="powershell.exe") (processes.process=*get-nettcpconnection*) by processes.dest processes.user processes.parent_process processes.process_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `getnettcpconnection_with_powershell_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where (processes.process_name="powershell.exe") (processes.process=*get-wmiobject* and processes.process="*namespace root\\directory\\ldap*" and processes.process="*class ds_computer*") by processes.dest processes.user processes.parent_process processes.process_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `getwmiobject_ds_computer_with_powershell_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where (processes.process_name="powershell.exe") (processes.process=*get-wmiobject* and processes.process="*namespace root\\directory\\ldap*" and processes.process="*class ds_group*") by processes.dest processes.user processes.parent_process processes.process_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `getwmiobject_ds_group_with_powershell_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where (processes.process_name="powershell.exe") (processes.process=*get-wmiobject* and processes.process=*win32_useraccount*) by processes.dest processes.user processes.parent_process processes.process_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `getwmiobject_user_account_with_powershell_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where (processes.process_name="powershell.exe") (processes.process=*system.security.principal.windowsidentity* or processes.process=*getcurrent()*) by processes.dest processes.user processes.parent_process processes.process_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `getcurrent_user_with_powershell_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where (processes.process_name="query.exe") (processes.process=*user*) by processes.dest processes.user processes.parent_process processes.process_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `system_user_discovery_with_query_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where (processes.process_name="whoami.exe") by processes.dest processes.user processes.parent_process processes.process_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `system_user_discovery_with_whoami_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where (processes.process_name="wmic.exe") (processes.process="" or processes.process="*domaincontrolleraddress*") by processes.dest processes.user processes.parent_process processes.process_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `domain_controller_discovery_with_wmic_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where (processes.process_name="wmic.exe") (processes.process=*/namespace:\\\\root\\directory\\ldap* and processes.process=*ds_computer* and processes.process="*get ds_samaccountname*") by processes.dest processes.user processes.parent_process processes.process_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `remote_system_discovery_with_wmic_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where (processes.process_name="wmic.exe") (processes.process=*/namespace:\\\\root\\directory\\ldap* and processes.process=*ds_group* and processes.process="*get ds_samaccountname*") by processes.dest processes.user processes.parent_process processes.process_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `domain_group_discovery_with_wmic_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where (processes.process_name="wmic.exe") (processes.process=*/namespace:\\\\root\\directory\\ldap*) (processes.process="*domain admins*" or processes.process="*enterprise admins*" or processes.process="*schema admins*" or processes.process="*account operators*" or processes.process="*server operators*" or processes.process="*protected users*" or processes.process="*dns admins*") by processes.dest processes.user processes.parent_process processes.process_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `elevated_group_discovery_with_wmic_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where (processes.process_name=advancedrun.exe or processes.original_file_name=advancedrun.exe) processes.process in ("*exefilename*","*/cfg*","*runas*", "*windowstate*") by processes.dest processes.user processes.parent_process_name processes.process_name processes.process processes.original_file_name processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)`| `security_content_ctime(lasttime)` | `windows_nirsoft_advancedrun_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where (processes.process_name=at.exe or processes.original_file_name=at.exe) (processes.process=*\\\\*) by processes.dest processes.user processes.parent_process_name processes.process_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)`| `security_content_ctime(lasttime)` | `scheduled_task_creation_on_remote_endpoint_using_at_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where (processes.process_name=control.exe or processes.original_file_name=control.exe) and processes.process in ("*\\appdata\\*", "*\\windows\\temp\\*", "*\\programdata\\*") by processes.dest processes.user processes.parent_process_name processes.process_name processes.process processes.process_id processes.parent_process_id processes.original_file_name | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `control_loading_from_world_writable_directory_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where (processes.process_name=curl or processes.process_name=wget) by processes.dest processes.user processes.parent_process_name processes.process_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `linux_ingress_tool_transfer_hunting_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where (processes.process_name=mimikatz.exe or processes.original_file_name=mimikatz.exe) by processes.dest processes.user processes.parent_process_name processes.process_name processes.original_file_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `windows_mimikatz_binary_execution_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where (processes.process_name=ntdsutil.exe processes.process=*ntds* processes.process=*create*) by processes.dest processes.user processes.parent_process processes.process_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)`| `security_content_ctime(lasttime)` | `ntdsutil_export_ntds_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where (processes.process_name=powershell.exe or processes.process_name=cmd.exe) (processes.process="*get-localgroup*") by processes.dest processes.user processes.parent_process_name processes.process_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)`| `security_content_ctime(lasttime)` | `powershell_get_localgroup_discovery_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where (processes.process_name=powershell.exe or processes.process_name=cmd.exe) (processes.process="*get-wmiobject*" and processes.process="*win32_group*") by processes.dest processes.user processes.parent_process_name processes.process_name processes.process processes.original_file_name processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)`| `security_content_ctime(lasttime)` | `get_wmiobject_group_discovery_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where (processes.process_name=sc.exe or processes.original_file_name=sc.exe) (processes.process=*\\\\* and processes.process=*create* and processes.process=*binpath*) by processes.dest processes.user processes.parent_process_name processes.process_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)`| `security_content_ctime(lasttime)` | `windows_service_creation_on_remote_endpoint_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where (processes.process_name=sc.exe or processes.original_file_name=sc.exe) (processes.process=*\\\\* and processes.process=*start*) by processes.dest processes.user processes.parent_process_name processes.process_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)`| `security_content_ctime(lasttime)` | `windows_service_initiation_on_remote_endpoint_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where (processes.process_name=schtasks.exe or processes.original_file_name=schtasks.exe) (processes.process=*/s* and processes.process=*/run*) by processes.dest processes.user processes.parent_process_name processes.process_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)`| `security_content_ctime(lasttime)` | `scheduled_task_initiation_on_remote_endpoint_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where (processes.process_name=sharphound.exe or processes.original_file_name=sharphound.exe) by processes.dest processes.user processes.parent_process_name processes.original_file_name processes.process_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `detect_sharphound_usage_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where (processes.process_name=vssadmin.exe processes.process=*create* processes.process=*shadow*) or (processes.process_name=wmic.exe processes.process=*shadowcopy* processes.process=*create*) by processes.dest processes.user processes.process_name processes.process processes.parent_process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)`| `security_content_ctime(lasttime)` | `creation_of_shadow_copy_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where (processes.process_name=winrs.exe or processes.original_file_name=winrs.exe) (processes.process="*-r:*" or processes.process="*-remote:*") by processes.dest processes.user processes.parent_process_name processes.process_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)`| `security_content_ctime(lasttime)` | `remote_process_instantiation_via_winrm_and_winrs_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where (processes.process="* -f *" or processes.process="* -b *") and (processes.process=*objectcategory* or processes.process="* -gcb *" or processes.process="* -sc *") by processes.dest processes.user processes.process_name processes.process processes.parent_process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `windows_adfind_exe_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where (processes.process="*8 lan*" or processes.process="*9 rep*") by processes.dest processes.user processes.parent_process processes.process_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)`| `security_content_ctime(lasttime)` | `ryuk_wake_on_lan_command_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where (processes.process="*wmic* qfe*" or processes.process=*systeminfo* or processes.process=*hostname*) by processes.user processes.process_name processes.process processes.dest processes.parent_process_name | `drop_dm_object_name(processes)` | eventstats dc(process) as dc_processes_by_dest by dest | where dc_processes_by_dest > 2 | stats values(process) as process min(firsttime) as firsttime max(lasttime) as lasttime by user, dest parent_process_name | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `system_information_discovery_detection_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where `process_bitsadmin` processes.process in ("*transfer*", "*addfile*") by processes.dest processes.user processes.parent_process processes.original_file_name processes.process_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `bitsadmin_download_file_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where `process_bitsadmin` processes.process in (*create*, *addfile*, *setnotifyflags*, *setnotifycmdline*, *setminretrydelay*, *setcustomheaders*, *resume* ) by processes.dest processes.user processes.original_file_name processes.parent_process processes.process_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `bits_job_persistence_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where `process_certutil` (processes.process=*urlcache* processes.process=*split*) or processes.process=*urlcache* by processes.dest processes.user processes.parent_process processes.process_name processes.process processes.process_id processes.original_file_name processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `certutil_download_with_urlcache_and_split_arguments_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where `process_certutil` (processes.process=*verifyctl* processes.process=*split*) or processes.process=*verifyctl* by processes.dest processes.user processes.original_file_name processes.parent_process processes.process_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `certutil_download_with_verifyctl_and_split_arguments_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where `process_certutil` processes.process=*decode* by processes.dest processes.user processes.parent_process processes.process_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `certutil_with_decode_argument_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where `process_cmd` (processes.process=*\\system32\\config\\sam* or processes.process=*\\system32\\config\\security* or processes.process=*\\system32\\config\\system* or processes.process=*\\windows\\ntds\\ntds.dit*) by processes.dest processes.user processes.process_name processes.process processes.parent_process processes.original_file_name processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)`| `security_content_ctime(lasttime)` | `credential_dumping_via_copy_command_from_shadow_copy_filter` '
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where `process_cmd` or processes.process=*%comspec%* (processes.process=*echo* and processes.process=*pipe*) by processes.dest processes.user processes.parent_process processes.process_name processes.original_file_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `cmd_echo_pipe___escalation_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where `process_cmd` processes.process=*/c* processes.process="* rd *" processes.process="*/s*" processes.process="*/q*" by processes.user processes.process_name processes.parent_process_name processes.parent_process processes.process processes.process_id processes.dest |`drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `recursive_delete_of_directory_in_batch_cmd_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where `process_cmd` processes.process=*mklink* processes.process=*harddiskvolumeshadowcopy* by processes.dest processes.user processes.process_name processes.process processes.parent_process processes.original_file_name processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)`| `security_content_ctime(lasttime)` | `credential_dumping_via_symlink_to_shadow_copy_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where `process_csc` processes.process = "*/noconfig*" processes.process = "*/fullpaths*" processes.process = "*@*" by processes.dest processes.user processes.parent_process_name processes.parent_process processes.process_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `csc_net_on_the_fly_compilation_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where `process_curl` processes.process in ("*-o *","*--output*") processes.process in ("*\\appdata\\*","*\\programdata\\*","*\\public\\*") by processes.dest processes.user processes.parent_process_name processes.process_name processes.original_file_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `windows_curl_download_to_suspicious_path_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where `process_curl` processes.process in ("*-t *","*--upload-file *", "*-d *", "*--data *", "*-f *") by processes.dest processes.user processes.parent_process_name processes.process_name processes.original_file_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `windows_curl_upload_to_remote_destination_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where `process_diskshadow` (processes.process=*-s* or processes.process=*/s*) by processes.dest processes.user processes.parent_process processes.process_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `windows_diskshadow_proxy_execution_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where `process_dxdiag` and processes.process = "* /t *" by processes.dest processes.user processes.parent_process_name processes.parent_process processes.process_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `system_info_gathering_using_dxdiag_application_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where `process_esentutl` processes.process in ("*ntds*", "*sam*") by processes.dest processes.user processes.parent_process_name processes.process_name processes.original_file_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `esentutl_sam_copy_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where `process_hh` processes.process in ("*its:*", "*mk:@msitstore:*") by processes.dest processes.user processes.parent_process processes.process_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `detect_html_help_using_infotech_storage_handlers_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where `process_hh` processes.process=*-decompile* by processes.dest processes.user processes.parent_process_name processes.process_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `windows_system_binary_proxy_execution_compiled_html_file_decompile_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where `process_hh` processes.process=*http* by processes.dest processes.user processes.parent_process processes.original_file_name processes.process_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `detect_html_help_url_in_command_line_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where `process_installutil` not (processes.process_path in ("*\\windows\\adws\\*","*\\windows\\syswow64*", "*\\windows\\system32*", "*\\windows\\networkcontroller\\*", "*\\windows\\systemapps\\*", "*\\winsxs\\*", "*\\windows\\microsoft.net\\*")) by processes.dest processes.user processes.parent_process processes.process_name processes.process processes.original_file_name processes.process_id processes.parent_process_id processes.process_hash | `drop_dm_object_name("processes")` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `windows_installutil_in_non_standard_path_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where `process_installutil` processes.process in ("*/u*", "*uninstall*") by processes.dest processes.user processes.parent_process_name processes.process_name processes.original_file_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `windows_installutil_uninstall_option_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where `process_installutil` processes.process in ("*http://*","*https://*") by processes.dest processes.user processes.parent_process_name processes.process_name processes.original_file_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `windows_installutil_url_in_command_line_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where `process_microsoftworkflowcompiler` by processes.dest processes.parent_process processes.process_name processes.original_file_name processes.process processes.user | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `suspicious_microsoft_workflow_compiler_usage_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where `process_msiexec` processes.process in ("*/y*", "*-y*") by processes.dest processes.user processes.parent_process_name processes.process_name processes.original_file_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `windows_msiexec_dllregisterserver_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where `process_msiexec` processes.process in ("*/z*", "*-z*") by processes.dest processes.user processes.parent_process_name processes.process_name processes.original_file_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `windows_msiexec_unregister_dllregisterserver_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where `process_msiexec` processes.process in ("*http://*", "*https://*") by processes.dest processes.user processes.parent_process_name processes.process_name processes.original_file_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `windows_msiexec_remote_download_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where `process_net` (processes.process=*user or processes.process=*users) by processes.dest processes.user processes.parent_process processes.process_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `local_account_discovery_with_net_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where `process_net` and processes.process = "* user*" and processes.process = "*/do*" by processes.dest processes.user processes.parent_process processes.process_name processes.process processes.process_id processes.parent_process_id processes.parent_process_name | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `domain_account_discovery_with_net_app_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where `process_net` or processes.process_name = "sc.exe" or processes.original_file_name= "sc.exe" and processes.process="*stop*" by processes.process_name processes.original_file_name processes.process processes.process_id processes.process_guid processes.parent_process_name processes.parent_process processes.parent_process_guid processes.dest processes.user | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `windows_service_stop_via_net__and_sc_application_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where `process_netsh` processes.process= "*firewall*" (processes.process= "*off*" or processes.process= "*disable*") by processes.dest processes.user processes.parent_process processes.process_name processes.original_file_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `disabling_firewall_with_netsh_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where `process_netsh` processes.process= "*firewall*" processes.process= "*group=\"file and printer sharing\"*" processes.process="*enable=yes*" by processes.dest processes.user processes.parent_process processes.process_name processes.process processes.process_id processes.parent_process_id processes.parent_process_name processes.original_file_name | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `allow_file_and_printing_sharing_in_firewall_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where `process_netsh` processes.process= "*firewall*" processes.process= "*group=\"network discovery\"*" processes.process="*enable*" processes.process="*yes*" by processes.dest processes.user processes.parent_process processes.original_file_name processes.process_name processes.process processes.process_id processes.parent_process_id processes.parent_process_name | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `allow_network_discovery_in_firewall_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where `process_netsh`and processes.process = "* show *" processes.process in ("*state*", "*config*", "*wlan*", "*profile*") by processes.process_name processes.original_file_name processes.process processes.process_id processes.process_guid processes.parent_process_name processes.parent_process processes.parent_process_guid processes.dest processes.user | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `windows_system_network_connections_discovery_netsh_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where `process_nltest` (processes.process=*/domain_trusts* or processes.process=*/all_trusts*) by processes.dest processes.user processes.parent_process processes.process_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `nltest_domain_trust_discovery_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where `process_ping` (processes.parent_process = "*ping*" processes.parent_process = *-n* processes.parent_process="* nul*"processes.parent_process="*&gt;*") or (processes.process = "*ping*" processes.process = *-n* processes.process="* nul*"processes.process="*&gt;*") by processes.parent_process_name processes.parent_process processes.process_name processes.original_file_name processes.process processes.process_id processes.process_guid processes.user processes.dest | `drop_dm_object_name("processes")` | `security_content_ctime(firsttime)` |`security_content_ctime(lasttime)` | `ping_sleep_batch_command_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where `process_powershell` (processes.process="*document.activeview.executeshellcommand*" or processes.process="*document.application.shellexecute*") by processes.dest processes.user processes.parent_process_name processes.process_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)`| `security_content_ctime(lasttime)` | `remote_process_instantiation_via_dcom_and_powershell_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where `process_powershell` (processes.process="*invoke-command*" and processes.process="*-computername*") by processes.dest processes.user processes.parent_process_name processes.process_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)`| `security_content_ctime(lasttime)` | `remote_process_instantiation_via_winrm_and_powershell_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where `process_powershell` (processes.process="*invoke-wmimethod*" and processes.process="*-cn*" and processes.process="*-class win32_process*" and processes.process="*-name create*") by processes.dest processes.user processes.parent_process_name processes.process_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)`| `security_content_ctime(lasttime)` | `remote_process_instantiation_via_wmi_and_powershell_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where `process_powershell` (processes.process=*net.sockets.tcpclient* and processes.process=*system.text.asciiencoding*) by processes.dest processes.user processes.parent_process processes.original_file_name processes.process_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)`| `security_content_ctime(lasttime)`| `nishang_powershelltcponeline_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where `process_powershell` processes.process="*set-mppreference*" and processes.process in ("*disablerealtimemonitoring*","*disableioavprotection*","*disableintrusionpreventionsystem*","*disablescriptscanning*","*disableblockatfirstseen*","*disablebehaviormonitoring*","*drtm *","*dioavp *","*dscrptsc *","*dbaf *","*dbm *") by processes.dest processes.user processes.parent_process processes.original_file_name processes.process_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `powershell_disable_security_monitoring_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where `process_powershell` processes.process=*.downloadstring* by processes.dest processes.user processes.parent_process processes.process_name processes.original_file_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)`| `security_content_ctime(lasttime)`| `any_powershell_downloadstring_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where `process_powershell` processes.process=*downloadfile* by processes.dest processes.user processes.parent_process processes.process_name processes.original_file_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)`| `security_content_ctime(lasttime)`| `any_powershell_downloadfile_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where `process_powershell` processes.process=*start-bitstransfer* by processes.dest processes.user processes.parent_process processes.process_name processes.process processes.process_id processes.original_file_name processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `powershell_start_bitstransfer_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where `process_procdump` (processes.process=*-ma* or processes.process=*-mm*) processes.process=*lsass* by processes.user processes.process_name processes.process processes.original_file_name processes.dest | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `dump_lsass_via_procdump_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where `process_rclone` processes.process in ("*copy*", "*mega*", "*pcloud*", "*ftp*", "*--config*", "*--progress*", "*--no-check-certificate*", "*--ignore-existing*", "*--auto-confirm*", "*--transfers*", "*--multi-thread-streams*") by processes.dest processes.user processes.parent_process processes.process_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `detect_rclone_command_line_usage_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where `process_reg` (processes.process=*save* or processes.process=*export*) and (processes.process="*\sam *" or processes.process="*\system *" or processes.process="*\security *") by processes.dest processes.user processes.parent_process processes.process_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `extraction_of_registry_hives_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where `process_reg` and processes.process = "* query *" and processes.process = "*\\software\\microsoft\\windows nt\\currentversion\\winlogon*" and processes.process = "*cachedlogonscount*" by processes.process_name processes.original_file_name processes.process processes.process_id processes.process_guid processes.parent_process_name processes.parent_process processes.parent_process_guid processes.dest processes.user | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `windows_cached_domain_credentials_reg_query_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where `process_reg` and processes.process = "* query *" and processes.process = "*\\system\\currentcontrolset\\control\\lsa*" processes.process in ("*runasppl*" , "*lsacfgflags*") by processes.process_name processes.original_file_name processes.process processes.process_id processes.process_guid processes.parent_process_name processes.parent_process processes.parent_process_guid processes.dest processes.user | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `windows_security_support_provider_reg_query_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where `process_reg` and processes.process = "* query *" and processes.process in ("*\\software\\orl\\winvnc3\\password*", "*\\software\\realvnc\\winvnc4 /v password*", "*\\currentcontrolset\\services\\snmp*", "*\\software\\tightvnc\\server*", "*\\software\\simontatham\\putty\\sessions*", "*\\software\\openssh\\agent\\keys*", "*password*") by processes.process_name processes.original_file_name processes.process processes.process_id processes.process_guid processes.parent_process_name processes.parent_process processes.parent_process_guid processes.dest processes.user | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `windows_credentials_in_registry_reg_query_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where `process_reg` and processes.process = "* restore *" by processes.process_name processes.original_file_name processes.process processes.process_id processes.process_guid processes.parent_process_name processes.parent_process processes.parent_process_guid processes.dest processes.user | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `windows_modify_registry_reg_restore_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where `process_reg` and processes.process = "* save *" by processes.process_name processes.original_file_name processes.process processes.process_id processes.process_guid processes.parent_process_name processes.parent_process processes.parent_process_guid processes.dest processes.user | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `windows_query_registry_reg_save_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where `process_reg` and processes.process="* add *" and processes.process="* hkcr\\*" and processes.process="*\\shell\\open\\command*" and processes.process= *notepad.exe* by processes.process_name processes.original_file_name processes.process processes.process_id processes.process_guid processes.parent_process_name processes.parent_process processes.parent_process_guid processes.dest processes.user | `drop_dm_object_name(processes)` | rex field=process "notepad\.exe (?<file_name_association>.*$)" | rex field=file_name_association "\.(?<extension>[^\.]*$)" | where isnull(extension) and isnotnull(file_name_association) | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `windows_change_default_file_association_for_no_file_ext_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where `process_reg` processes.process=*inprocserver32* by processes.dest processes.user processes.parent_process_name processes.process_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `windows_com_hijacking_inprocserver32_modification_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where `process_regsvr32` (processes.process=*appdata* or processes.process=*programdata* or processes.process=*windows\temp*) (processes.process!=*.dll processes.process!=*.ax processes.process!=*.ocx) by processes.dest processes.user processes.parent_process processes.process_name processes.process processes.original_file_name processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)`| `security_content_ctime(lasttime)` | `suspicious_regsvr32_register_suspicious_path_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where `process_regsvr32` and processes.process="*/i*" by processes.dest processes.parent_process processes.process processes.parent_process_name processes.process_name processes.original_file_name processes.user | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | where match(process,"(?i)[\-|\/][ss]{1}") | `regsvr32_silent_and_install_param_dll_loading_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where `process_regsvr32` by processes.user processes.process_name processes.process processes.parent_process_name processes.original_file_name processes.dest processes.process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | where match(process,"(?i)[\-|\/][ss]{1}") | `regsvr32_with_known_silent_switch_cmdline_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where `process_regsvr32` processes.process=*scrobj* by processes.dest processes.user processes.parent_process processes.process_name processes.process processes.original_file_name processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)`| `security_content_ctime(lasttime)` | `detect_regsvr32_application_control_bypass_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where `process_route` by processes.dest processes.user processes.parent_process_name processes.parent_process processes.process_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `network_discovery_using_route_windows_app_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where `process_runas` and processes.process = "*/user:*" and processes.process = "*admin*" by processes.dest processes.user processes.parent_process_name processes.parent_process processes.process_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `runas_execution_in_commandline_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where `process_rundll32` and processes.process = "*apphelp.dll,shimflushcache*" by processes.dest processes.user processes.parent_process_name processes.process_name processes.process processes.process_id processes.parent_process_id processes.original_file_name | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `rundll32_shimcache_flush_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where `process_rundll32` processes.process=*/i:* by processes.process_name processes.process processes.parent_process_name processes.parent_process processes.process_id processes.parent_process_id processes.dest processes.user | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `suspicious_icedid_rundll32_cmdline_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where `process_rundll32` processes.process=*advpack* by processes.dest processes.user processes.parent_process_name processes.original_file_name processes.process_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `detect_rundll32_application_control_bypass___advpack_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where `process_rundll32` processes.process=*comsvcs.dll* processes.process=*minidump* by processes.user processes.process_name processes.original_file_name processes.process processes.dest | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `dump_lsass_via_comsvcs_dll_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where `process_rundll32` processes.process=*control_rundll* and processes.process in ("*\\appdata\\*", "*\\windows\\temp\\*", "*\\programdata\\*") by processes.dest processes.user processes.parent_process_name processes.process_name processes.process processes.process_id processes.parent_process_id processes.original_file_name | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `rundll32_control_rundll_world_writable_directory_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where `process_rundll32` processes.process=*control_rundll* by processes.dest processes.user processes.parent_process_name processes.process_name processes.process processes.process_id processes.parent_process_id processes.original_file_name | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `rundll32_control_rundll_hunt_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where `process_rundll32` processes.process=*dllregisterserver* by processes.dest processes.user processes.parent_process processes.original_file_name processes.process_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `suspicious_rundll32_dllregisterserver_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where `process_rundll32` processes.process=*plugininit* by processes.process_name processes.process processes.parent_process_name processes.original_file_name processes.parent_process processes.process_id processes.parent_process_id processes.dest processes.user | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `suspicious_rundll32_plugininit_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where `process_rundll32` processes.process=*setupapi* by processes.dest processes.user processes.parent_process_name processes.original_file_name processes.process_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `detect_rundll32_application_control_bypass___setupapi_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where `process_rundll32` processes.process=*start* by processes.dest processes.user processes.parent_process processes.process_name processes.process processes.original_file_name processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `suspicious_rundll32_startw_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where `process_rundll32` processes.process=*syssetup* by processes.dest processes.user processes.parent_process_name processes.original_file_name processes.process_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `detect_rundll32_application_control_bypass___syssetup_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where `process_schtasks` processes.process="*/create *" and processes.process="*/ru *" and processes.process="*system*" by processes.dest processes.user processes.parent_process_name processes.process_name processes.original_file_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `windows_schtasks_create_run_as_system_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where `process_setspn` (processes.process="*-t*" and processes.process="*-f*") or (processes.process="*-q*" and processes.process="**/**") or (processes.process="*-q*") or (processes.process="*-s*") by processes.dest processes.user processes.parent_process_name processes.process_name processes.original_file_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)`| `serviceprincipalnames_discovery_with_setspn_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where `process_wmic` (processes.process="*/node:*" and processes.process="*process*" and processes.process="*call*" and processes.process="*create*") by processes.dest processes.user processes.parent_process_name processes.process_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)`| `security_content_ctime(lasttime)` | `remote_process_instantiation_via_wmi_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where `process_wmic` (processes.process=*useraccount*) by processes.dest processes.user processes.parent_process processes.process_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `local_account_discovery_with_wmic_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where `process_wmic` or `process_powershell` processes.process=*shadowcopy* processes.process=*create* by processes.user processes.process_name processes.original_file_name processes.process processes.dest | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)`| `security_content_ctime(lasttime)` | `creation_of_shadow_copy_with_wmic_and_powershell_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where `process_wmic` processes.process = "* process *" processes.process = "* call *" processes.process = "* create *" by processes.parent_process_name processes.parent_process processes.process_name processes.process processes.original_file_name processes.process_id processes.parent_process_path processes.process_guid processes.parent_process_id processes.dest processes.user processes.process_path | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `windows_wmi_process_call_create_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where `process_wmic` processes.process = "*os get*" processes.process="*/format:*" processes.process = "*.xsl*" by processes.parent_process_name processes.parent_process processes.process_name processes.process_id processes.process processes.dest processes.user | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `xsl_script_execution_with_wmic_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where `process_wmic` processes.process in ("*http://*", "*https://*") processes.process="*/format:*" by processes.parent_process_name processes.original_file_name processes.parent_process processes.process_name processes.process_id processes.process processes.dest processes.user | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `wmic_xsl_execution_via_url_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where `process_wmic` processes.process in ("*process list*", "*service list*") by processes.process_name processes.original_file_name processes.process processes.process_id processes.process_guid processes.parent_process_name processes.parent_process processes.parent_process_guid processes.dest processes.user | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `windows_wmi_process_and_service_list_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where `process_wmic` processes.process=*node* by processes.dest processes.user processes.parent_process processes.process_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `remote_wmi_command_attempt_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where not (processes.parent_process_name in ("msiexec.exe", "iissetup.exe")) processes.process_name=appcmd.exe processes.process in ("*install *", "*module *") and processes.process="*image*" by processes.dest processes.user processes.parent_process_name processes.process_name processes.original_file_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `windows_iis_components_add_new_module_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where not (processes.parent_process_name in ("msiexec.exe", "iissetup.exe")) processes.process_name=appcmd.exe processes.process in ("*set config*", "*httplogging*","*dontlog:true*") by processes.dest processes.user processes.parent_process_name processes.process_name processes.original_file_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `windows_disable_windows_event_logging_disable_http_logging_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where not (processes.process_path in ("*\\windows\\adws\\*","*\\windows\\syswow64*", "*\\windows\\system32*", "*\\windows\\networkcontroller\\*", "*\\windows\\systemapps\\*", "*\\winsxs\\*", "*\\windows\\microsoft.net\\*")) by processes.dest processes.user processes.parent_process processes.process_name processes.process processes.original_file_name processes.process_path processes.process_id processes.parent_process_id | `drop_dm_object_name("processes")` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `is_net_windows_file` | `windows_dotnet_binary_in_non_standard_path_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.dest_category="web_server" and (processes.process="*whoami*" or processes.process="*ping*" or processes.process="*iptables*" or processes.process="*wget*" or processes.process="*service*" or processes.process="*curl*") by processes.process processes.process_name, processes.dest processes.user| `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `web_servers_executing_suspicious_processes_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.original_file_name=ab.exe by processes.dest processes.user processes.parent_process_name processes.process_name processes.original_file_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `windows_apache_benchmark_binary_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.original_file_name=rundll32.exe and processes.process_name!=rundll32.exe by processes.dest processes.user processes.parent_process_name processes.process_name processes.process processes.process_id processes.parent_process_id processes.original_file_name | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `suspicious_rundll32_rename_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.original_file_name=winrar.exe (processes.process_name!=rar.exe or processes.process_name!=winrar.exe) by processes.dest processes.user processes.parent_process_name processes.process_name processes.process processes.process_id processes.parent_process_id processes.original_file_name | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `detect_renamed_winrar_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.parent_process = "*[kworker/*" processes.parent_process_path in ("/home/*", "/tmp/*", "/var/log/*") processes.process="*iptables*" by processes.parent_process_name processes.parent_process processes.process_name processes.process processes.process_id processes.parent_process_id processes.parent_process_path processes.process_guid processes.dest processes.user | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `linux_kworker_process_in_writable_process_path_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.parent_process_name != explorer.exe processes.process_name =cmd.exe by processes.user processes.process_name processes.parent_process_name processes.dest processes.process_id processes.parent_process_id | `drop_dm_object_name("processes")` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | search [| tstats `security_content_summariesonly` count from datamodel=endpoint.processes where processes.parent_process_name=cmd.exe processes.process_name= reg.exe by processes.parent_process_id processes.dest processes.process_name | `drop_dm_object_name("processes")` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | rename parent_process_id as process_id |dedup process_id| table process_id dest] | `suspicious_reg_exe_process_filter` '
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.parent_process_name = "mshta.exe" `process_rundll32` or `process_regsvr32` by processes.parent_process processes.process_name processes.process processes.process_id processes.process_guid processes.user processes.dest | `drop_dm_object_name("processes")` | `security_content_ctime(firsttime)` |`security_content_ctime(lasttime)` | `mshta_spawning_rundll32_or_regsvr32_process_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.parent_process_name = "wermgr.exe" and not (processes.process_name in ("werfaultsecure.exe", "wermgr.exe", "werfault.exe")) by processes.dest processes.user processes.parent_process_name processes.process_name processes.process processes.process_id processes.parent_process_id processes.original_file_name | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `windows_process_injection_wermgr_child_process_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.parent_process_name in ("cscript.exe", "wscript.exe") processes.process_name in ("regsvr32.exe", "rundll32.exe","winhlp32.exe","certutil.exe","msbuild.exe","cmd.exe","powershell*","wmic.exe","mshta.exe") by processes.dest processes.user processes.parent_process_name processes.parent_process processes.process_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `wscript_or_cscript_suspicious_child_process_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.parent_process_name in ("rundll32.exe", "dllhost.exe") processes.process_name=*7z* by processes.dest processes.user processes.parent_process processes.process_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)`| `anomalous_usage_of_7zip_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.parent_process_name in ("winword.exe","excel.exe","powerpnt.exe","mspub.exe","visio.exe") `process_bitsadmin` by processes.dest processes.user processes.parent_process processes.process_name processes.original_file_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)`| `security_content_ctime(lasttime)` | `office_product_spawning_bitsadmin_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.parent_process_name in ("winword.exe","excel.exe","powerpnt.exe","mspub.exe","visio.exe") `process_certutil` by processes.dest processes.user processes.parent_process processes.process_name processes.original_file_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)`| `security_content_ctime(lasttime)` | `office_product_spawning_certutil_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.parent_process_name in ("winword.exe","excel.exe","powerpnt.exe","mspub.exe","visio.exe") `process_mshta` by processes.dest processes.user processes.parent_process processes.process_name processes.original_file_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)`| `security_content_ctime(lasttime)` | `office_product_spawning_mshta_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.parent_process_name in ("winword.exe","excel.exe","powerpnt.exe","mspub.exe","visio.exe") `process_rundll32` (processes.process!=*.dll*) by processes.dest processes.user processes.parent_process processes.process_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)`| `security_content_ctime(lasttime)` | `office_product_spawning_rundll32_with_no_dll_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.parent_process_name in ("winword.exe","excel.exe","powerpnt.exe","mspub.exe","visio.exe") `process_wmic` by processes.dest processes.user processes.parent_process processes.process_name processes.original_file_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)`| `security_content_ctime(lasttime)` | `office_product_spawning_wmic_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.parent_process_name in ("winword.exe","excel.exe","powerpnt.exe","mspub.exe","visio.exe") processes.process in ("*http:*","*https:*") not (processes.original_file_name in("firefox.exe", "chrome.exe","iexplore.exe","msedge.exe")) by processes.dest processes.user processes.parent_process_name processes.process_name processes.process processes.process_id processes.parent_process_id processes.original_file_name | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `office_document_spawned_child_process_to_download_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.parent_process_name in ("winword.exe","excel.exe","powerpnt.exe","mspub.exe","visio.exe") processes.process_name in ("wscript.exe", "cscript.exe") by processes.dest processes.user processes.parent_process processes.process_name processes.original_file_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)`| `security_content_ctime(lasttime)` | `office_product_spawning_windows_script_host_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.parent_process_name in ("winword.exe","excel.exe","powerpnt.exe","mspub.exe","visio.exe","wordpad.exe","wordview.exe") processes.process_name=control.exe by processes.dest processes.user processes.parent_process processes.process_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)`| `security_content_ctime(lasttime)`| `office_spawning_control_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.parent_process_name in ("winword.exe","excel.exe","powerpnt.exe","outlook.exe","mspub.exe","visio.exe") processes.process_name=msdt.exe by processes.dest processes.user processes.parent_process processes.process_name processes.original_file_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)`| `security_content_ctime(lasttime)` | `windows_office_product_spawning_msdt_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.parent_process_name in("cmd.exe", "powershell*","pwsh.exe", "sqlps.exe", "sqltoolsps.exe", "powershell_ise.exe") and `process_copy` and processes.process in("*\\windows\\system32\*", "*\\windows\\syswow64\\*") and processes.process = "*copy*" by processes.dest processes.user processes.parent_process_name processes.process_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)`| `suspicious_copy_on_system32_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.parent_process_name in("cmd.exe", "powershell.exe", "regsvr32.exe") and processes.process_name = "explorer.exe" by processes.parent_process processes.parent_process_name processes.process_name processes.process_id processes.process_guid processes.process processes.user processes.dest processes.parent_process_id | `drop_dm_object_name("processes")` | `security_content_ctime(firsttime)` |`security_content_ctime(lasttime)` | `windows_masquerading_explorer_as_child_process_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.parent_process_name="umworkerprocess.exe" or processes.parent_process_name="umservice.exe" not (processes.process_name in ("wermgr.exe", "werfault.exe")) by processes.dest processes.user processes.parent_process_name processes.process_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `unified_messaging_service_spawning_a_process_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.parent_process_name="winword.exe" `process_powershell` by processes.dest processes.user processes.parent_process processes.process_name processes.original_file_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)`| `security_content_ctime(lasttime)` | `winword_spawning_powershell_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.parent_process_name="winword.exe" processes.process_name in ("cscript.exe", "wscript.exe") by processes.dest processes.user processes.parent_process processes.process_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `winword_spawning_windows_script_host_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.parent_process_name=fodhelper.exe by processes.dest processes.user processes.parent_process processes.process_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)`| `security_content_ctime(lasttime)` | `fodhelper_uac_bypass_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.parent_process_name=hh.exe by processes.dest processes.user processes.parent_process processes.process_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `detect_html_help_spawn_child_process_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.parent_process_name=iscsicpl.exe `windows_shells` by processes.dest processes.user processes.parent_process_name processes.process_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)`| `windows_dll_search_order_hijacking_with_iscsicpl_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.parent_process_name=java or processes.parent_process_name=apache or processes.parent_process_name=tomcat `linux_shells` by processes.dest processes.user processes.parent_process_name processes.process_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `linux_java_spawning_shell_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.parent_process_name=java.exe or processes.parent_process_name=w3wp.exe `windows_shells` by processes.dest processes.user processes.parent_process_name processes.process_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `windows_java_spawning_shells_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.parent_process_name=msiexec.exe processes.process_name in ("powershell.exe","cmd.exe", "nltest.exe","ipconfig.exe","systeminfo.exe") by processes.dest processes.user processes.parent_process_name processes.process_name processes.original_file_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `windows_msiexec_spawn_discovery_command_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.parent_process_name=msra.exe `windows_shells` by processes.dest processes.user processes.parent_process_name processes.process_name processes.original_file_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `windows_remote_assistance_spawning_process_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.parent_process_name=regasm.exe by processes.dest processes.user processes.parent_process processes.process_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `detect_regasm_spawning_a_process_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.parent_process_name=regsvcs.exe by processes.dest processes.user processes.parent_process processes.process_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `detect_regsvcs_spawning_a_process_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.parent_process_name=services.exe by processes.user processes.process_name processes.process processes.dest | `drop_dm_object_name(processes)` | rex field=process "^.*?\\\\(?<service_process>[^\\\\]*\.(?:exe|bat|com|ps1))" | eval process_name = lower(process_name) | eval service_process = lower(service_process) | where process_name != service_process | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `detect_path_interception_by_creation_of_program_exe_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.parent_process_name=services.exe processes.process_path=*admin$* by processes.dest processes.user processes.parent_process processes.process_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `services_escalate_exe_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.parent_process_name=slui.exe by processes.dest processes.user processes.parent_process processes.process_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `slui_spawning_a_process_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.parent_process_name=spoolsv.exe `process_rundll32` by processes.dest processes.user processes.parent_process processes.original_file_name processes.process_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `spoolsv_spawning_rundll32_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.parent_process_name=winhlp32.exe processes.process in ("*\\appdata\\*","*\\programdata\\*", "*\\temp\\*") by processes.dest processes.user processes.parent_process_name processes.process_name processes.original_file_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `winhlp32_spawning_a_process_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.parent_process_name=winword.exe `process_cmd` by processes.dest processes.user processes.parent_process processes.original_file_name processes.process_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `winword_spawning_cmd_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.parent_process_name=wmiprvse.exe by processes.dest processes.user processes.parent_process processes.process_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `process_execution_via_wmi_filter` '
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.parent_process_name=wsmprovhost.exe processes.process_name in ("cmd.exe","sh.exe","bash.exe","powershell.exe","pwsh.exe","schtasks.exe","certutil.exe","whoami.exe","bitsadmin.exe","scp.exe") by processes.dest processes.user processes.parent_process processes.process_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `winrm_spawning_a_process_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.parent_process="*forfiles* /c *" by processes.dest processes.user processes.parent_process processes.parent_process_name processes.process_name processes.process processes.process_id processes.parent_process_id processes.process_path | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `windows_indirect_command_execution_via_forfiles_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.parent_process="*pcalua* -a*" by processes.dest processes.user processes.parent_process processes.parent_process_name processes.process_name processes.process processes.process_id processes.parent_process_id processes.process_path | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `windows_indirect_command_execution_via_pcalua_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process = "* -nolan *" or processes.process = "* -nolocal *" or processes.process = "* -fast *" or processes.process = "* -full *" by processes.process_name processes.process processes.parent_process_name processes.parent_process processes.dest processes.user processes.process_id processes.process_guid | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `revil_common_exec_parameter_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process = "*&amp;&gt;/dev/null*" by processes.process_name processes.process processes.process_id processes.parent_process_id processes.process_guid processes.dest processes.user processes.parent_process_name | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `linux_stdout_redirection_to_dev_null_file_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process = "*\\\\.\\pipe\\*" not (processes.process_path in ("*\\program files*")) by processes.parent_process_name processes.parent_process processes.process_name processes.process processes.original_file_name processes.process_id processes.parent_process_path processes.process_guid processes.parent_process_id processes.dest processes.user processes.process_path | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `windows_process_with_namedpipe_commandline_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process = "*cmd /c set" or processes.process = "*cmd.exe /c set" and not (processes.parent_process_name = "cmd.exe" or processes.parent_process_name = "powershell*" or processes.parent_process_name="pwsh.exe" or processes.parent_process_name = "explorer.exe") by processes.dest processes.user processes.parent_process_name processes.process_name processes.process processes.process_id processes.parent_process_id processes.original_file_name | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `windows_command_shell_fetch_env_variables_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process = "*dir *" or processes.process = "*findstr*" and processes.process in ( "*.kdbx*", "*credential*", "*key3.db*","*pass*", "*cred*", "*key4.db*", "*accesstokens*", "*access_tokens*", "*.htpasswd*", "*ntds.dit*") by processes.process_name processes.original_file_name processes.process processes.process_id processes.process_guid processes.parent_process_name processes.parent_process processes.parent_process_guid processes.dest processes.user | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `windows_password_managers_discovery_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process = "*dir *" or processes.process = "*findstr*" and processes.process in ( "*.rdg*", "*.gpg*", "*.pgp*", "*.p12*", "*.der*", "*.csr*", "*.cer*", "*.ovpn*", "*.key*", "*.ppk*", "*.p12*", "*.pem*", "*.pfx*", "*.p7b*", "*.asc*") by processes.process_name processes.original_file_name processes.process processes.process_id processes.process_guid processes.parent_process_name processes.parent_process processes.parent_process_guid processes.dest processes.user | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `windows_private_keys_discovery_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process = "*echo*" and processes.process in("*~/.bashrc", "*~/.bash_profile", "*/etc/profile", "~/.bash_login", "*~/.profile", "~/.bash_logout") by processes.dest processes.user processes.parent_process_name processes.process_name processes.process processes.process_id processes.parent_process_id processes.process_guid | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `linux_possible_append_command_to_profile_config_file_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process = "*firewall*" processes.process = "*allow*" processes.process = "*add*" processes.process = "*enable*" by processes.dest processes.user processes.parent_process_name processes.parent_process processes.process_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `firewall_allowed_program_enable_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process = "*iptables *" and processes.process = "* --dport *" and processes.process = "* accept*" and processes.process = "*&amp;&gt;/dev/null*" and processes.process = "* tcp *" and not(processes.parent_process_path in("/bin/*", "/lib/*", "/usr/bin/*", "/sbin/*")) by processes.process_name processes.process processes.process_id processes.parent_process_id processes.process_guid processes.dest _time span=10s processes.user processes.parent_process_name processes.parent_process_path processes.process_path | rex field=processes.process "--dport (?<port>3269|636|989|994|995|8443)" | stats values(processes.process) as processes_exec values(port) as ports values(processes.process_guid) as guids values(processes.process_id) as pids dc(port) as port_count count by processes.process_name processes.parent_process_name processes.parent_process_id processes.dest processes.user processes.parent_process_path processes.process_path | where port_count >=3 | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `linux_iptables_firewall_modification_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process = "*ld_preload*" by processes.dest processes.user processes.parent_process_name processes.process_name processes.process processes.process_id processes.parent_process_id processes.process_guid | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `linux_preload_hijack_library_calls_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process = "*-m local*" or processes.process = "*-m net*" or processes.process = "*-m all*" or processes.process = "*-nomutex*" by processes.process_name processes.process processes.parent_process_name processes.parent_process processes.dest processes.user processes.process_id processes.process_guid | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `conti_common_exec_parameter_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process = "*nopasswd:*" by processes.dest processes.user processes.parent_process_name processes.process_name processes.process processes.process_id processes.parent_process_id processes.process_guid | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `linux_nopasswd_entry_in_sudoers_file_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process = "*whoami*" processes.process = "*/group*" processes.process = "* find *" processes.process = "*12288*" by processes.dest processes.user processes.parent_process processes.process_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `check_elevated_cmd_using_whoami_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process = *.doc.exe or processes.process = *.htm.exe or processes.process = *.html.exe or processes.process = *.txt.exe or processes.process = *.pdf.exe or processes.process = *.doc.exe by processes.dest processes.user processes.process processes.parent_process | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `drop_dm_object_name(processes)` | `execution_of_file_with_multiple_extensions_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process in ("*/stext *", "*/shtml *", "*/loadpasswordsie*", "*/loadpasswordsfirefox*", "*/loadpasswordschrome*", "*/loadpasswordsopera*", "*/loadpasswordssafari*" , "*/useoperapasswordfile*", "*/operapasswordfile*","*/stab*", "*/scomma*", "*/stabular*", "*/shtml*", "*/sverhtml*", "*/sxml*", "*/skeepass*" ) and processes.process in ("*\\temp\\*", "*\\users\\public\\*", "*\\programdata\\*") by processes.dest processes.user processes.parent_process_name processes.parent_process processes.process_name processes.process processes.process_id processes.parent_process_id processes.original_file_name | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `possible_browser_pass_view_parameter_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process in ("*base64 -d*","*base64 --decode*") and processes.process="*|*" `linux_shells` by processes.dest processes.user processes.parent_process_name processes.process_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `linux_decode_base64_to_shell_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process in ("*base64 -d*","*base64 --decode*") by processes.dest processes.user processes.parent_process_name processes.process_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `linux_obfuscated_files_or_information_base64_decode_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process in ("*-collectionmethod*","*invoke-bloodhound*") by processes.dest processes.user processes.parent_process processes.process_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `detect_sharphound_command_line_arguments_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process in ("*invoke-azurehound*") by processes.dest processes.user processes.parent_process processes.process_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `detect_azurehound_command_line_arguments_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process in("*docker*-v*/*:*","*docker*--volume*/*:*") or processes.process in("*docker*exec*sh*","*docker*exec*bash*") by processes.dest processes.user processes.parent_process_name processes.process_name processes.process processes.process_id processes.parent_process_id processes.process_guid | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `linux_docker_privilege_escalation_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process_name != regsvr32.exe and processes.original_file_name=regsvr32.exe by processes.dest processes.user processes.parent_process_name processes.process_name processes.process processes.process_id processes.parent_process_id processes.original_file_name | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `windows_regsvr32_renamed_binary_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process_name = "bcdedit.exe" processes.process = "*bootstatuspolicy*" processes.process = "*ignoreallfailures*" by processes.parent_process_name processes.parent_process processes.process_name processes.process processes.dest processes.user processes.process_id processes.process_guid | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)`| `prevent_automatic_repair_mode_using_bcdedit_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process_name = "cipher.exe" processes.process = "*/w:*" by processes.parent_process_name processes.parent_process processes.process_name processes.process processes.dest processes.user processes.process_id processes.process_guid | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `clear_unallocated_sector_using_cipher_app_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process_name = "crontab" processes.process= "* -l*" by processes.parent_process_name processes.process_name processes.process processes.process_id processes.parent_process_id processes.dest processes.user | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `linux_adding_crontab_using_list_parameter_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process_name = "cscript.exe" processes.process="*-e:{f414c262-6ac0-11cf-b6d1-00aa00bbbb58}*" by processes.parent_process_name processes.process_name processes.process processes.parent_process processes.process_id processes.dest processes.user | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `execute_javascript_with_jscript_com_clsid_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process_name = "dd" and processes.process = "*of=*" by processes.dest processes.user processes.parent_process_name processes.process_name processes.process processes.process_id processes.parent_process_id processes.process_guid | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `linux_dd_file_overwrite_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process_name = "doas" by processes.dest processes.user processes.parent_process_name processes.process_name processes.process processes.process_id processes.parent_process_id processes.process_guid | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `linux_doas_tool_execution_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process_name = "python*.exe" processes.process = "*.py*" processes.process = "*-ntds*" (processes.process = "*-system*" or processes.process = "*-sam*" or processes.process = "*-security*" or processes.process = "*-bootkey*") by processes.process_name processes.process processes.parent_process_name processes.parent_process processes.dest processes.user processes.process_id processes.process_guid | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `secretdumps_offline_ntds_dumping_tool_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process_name = "qwinsta.exe" or processes.original_file_name = "qwinsta.exe" by processes.parent_process processes.parent_process_name processes.process_name processes.process_id processes.process_guid processes.process processes.user processes.dest processes.parent_process_id processes.original_file_name | `drop_dm_object_name("processes")` | `security_content_ctime(firsttime)` |`security_content_ctime(lasttime)` | `windows_system_discovery_using_qwinsta_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process_name = "takeown.exe" processes.process = "*/f*" by processes.parent_process_name processes.parent_process processes.process_name processes.process processes.dest processes.user processes.process_id processes.process_guid | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `permission_modification_using_takeown_app_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process_name = "wevtutil.exe" processes.process = "*sl*" processes.process = "*/e:false*" by processes.parent_process_name processes.parent_process processes.process_name processes.process processes.dest processes.user processes.process_id processes.process_guid | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `disable_logs_using_wevtutil_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process_name = bcdedit.exe processes.process="*/deletevalue*" processes.process="*{current}*" processes.process="*safeboot*" by processes.process_name processes.process processes.parent_process_name processes.dest processes.user |`drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `bcdedit_command_back_to_normal_mode_boot_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process_name = bcdedit.exe processes.process="*/set*" processes.process="*{current}*" processes.process="*safeboot*" processes.process="*network*" by processes.process_name processes.process processes.parent_process_name processes.dest processes.user |`drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `change_to_safe_mode_with_network_config_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process_name = bcdedit.exe processes.process="*recoveryenabled*" (processes.process="* no*") by processes.process_name processes.process processes.parent_process_name processes.dest processes.user | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `bcdedit_failure_recovery_modification_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process_name = crontab processes.process = "*crontab *" processes.process = "* -e*" by processes.dest processes.user processes.parent_process_name processes.process_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `linux_edit_cron_table_parameter_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process_name = visudo by processes.dest processes.user processes.parent_process_name processes.process_name processes.process processes.process_id processes.parent_process_id processes.process_guid | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `linux_visudo_utility_execution_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process_name =rm and processes.process= "* -rf *" and processes.process in ("*/boot/*", "*/var/log/*", "*/etc/*", "*/dev/*") by processes.parent_process_name processes.process_name processes.process processes.process_id processes.parent_process_id processes.process_guid processes.dest processes.user | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `linux_deleting_critical_directory_using_rm_command_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process_name =shred and processes.process in ("*-n*", "*-u*", "*-z*", "*-s*") by processes.parent_process_name processes.process_name processes.process processes.process_id processes.parent_process_id processes.process_guid processes.dest processes.user | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `linux_shred_overwrite_command_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process_name in ("bash","cat") processes.process in ("*/authorized_keys*") by processes.dest processes.user processes.parent_process_name processes.process_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `linux_ssh_authorized_keys_modification_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process_name in ("chmod", "chown", "fchmod", "fchmodat", "fchown", "fchownat", "fremovexattr", "fsetxattr", "lchown", "lremovexattr", "lsetxattr", "removexattr", "setuid", "setgid", "setreuid", "setregid", "chattr") or processes.process in ("*chmod *", "*chown *", "*fchmod *", "*fchmodat *", "*fchown *", "*fchownat *", "*fremovexattr *", "*fsetxattr *", "*lchown *", "*lremovexattr *", "*lsetxattr *", "*removexattr *", "*setuid *", "*setgid *", "*setreuid *", "*setregid *", "*setcap *", "*chattr *") by processes.dest processes.user processes.parent_process_name processes.process_name processes.process processes.process_id processes.parent_process_id processes.process_guid | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `linux_common_process_for_elevation_control_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process_name in ("sudo", "su") or processes.parent_process_name in ("sudo", "su") by processes.dest processes.user processes.parent_process_name processes.process_name processes.process processes.process_id processes.parent_process_id processes.process_guid | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `linux_sudo_or_su_execution_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process_name in ("systemctl", "service", "svcadm") processes.process = "* disable*" by processes.parent_process_name processes.process_name processes.process processes.process_id processes.parent_process_id processes.process_guid processes.dest processes.user | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `linux_disable_services_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process_name in ("systemctl", "service", "svcadm") processes.process ="*stop*" by processes.parent_process_name processes.process_name processes.process processes.process_id processes.parent_process_id processes.process_guid processes.dest processes.user | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `linux_stop_services_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process_name in ("wscript.exe","cscript.exe") processes.process="*syncappvpublishingserver.vbs*" by processes.dest processes.user processes.parent_process_name processes.process_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `windows_system_script_proxy_execution_syncappvpublishingserver_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process_name in("cat", "nano*","vim*", "vi*") and processes.process in("*/etc/shadow*", "*/etc/passwd*") by processes.dest processes.user processes.parent_process_name processes.process_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `linux_possible_access_to_credential_files_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process_name in("cat", "nano*","vim*", "vi*") and processes.process in("*/etc/ssh/sshd_config") by processes.dest processes.user processes.parent_process_name processes.process_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `linux_possible_access_or_modification_of_sshd_config_file_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process_name in("cat", "nano*","vim*", "vi*") and processes.process in("*/etc/sudoers*") by processes.dest processes.user processes.parent_process_name processes.process_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `linux_possible_access_to_sudoers_file_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process_name in("kmod", "sudo") and processes.process = *insmod* by processes.dest processes.user processes.parent_process_name processes.process_name processes.process processes.process_id processes.parent_process_id processes.process_guid | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `linux_insert_kernel_module_using_insmod_utility_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process_name in("kmod", "sudo") and processes.process = *modprobe* by processes.dest processes.user processes.parent_process_name processes.process_name processes.process processes.process_id processes.parent_process_id processes.process_guid | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `linux_install_kernel_module_using_modprobe_utility_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process_name!=hh.exe and processes.original_file_name=hh.exe by processes.dest processes.user processes.parent_process_name processes.original_file_name processes.process_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `detect_html_help_renamed_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process_name!=microsoft.workflow.compiler.exe and processes.original_file_name=microsoft.workflow.compiler.exe by processes.dest processes.user processes.parent_process_name processes.process_name processes.process processes.process_id processes.parent_process_id processes.original_file_name | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `suspicious_microsoft_workflow_compiler_rename_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process_name!=msbuild.exe and processes.original_file_name=msbuild.exe by processes.dest processes.user processes.parent_process_name processes.process_name processes.process processes.process_id processes.parent_process_id processes.original_file_name | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `suspicious_msbuild_rename_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process_name!=mshta.exe and processes.original_file_name=mshta.exe by processes.dest processes.user processes.parent_process_name processes.process_name processes.process processes.process_id processes.parent_process_id processes.original_file_name | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `detect_mshta_renamed_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process_name="cmdkey.exe" or processes.original_file_name = "cmdkey.exe" and processes.process = "*/list*" by processes.process_name processes.original_file_name processes.process processes.process_id processes.process_guid processes.parent_process_name processes.parent_process processes.parent_process_guid processes.dest processes.user | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `windows_credentials_from_password_stores_query_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process_name="dsquery.exe" and processes.process = "*user*" by processes.dest processes.user processes.parent_process processes.process_name processes.process processes.process_id processes.parent_process_id processes.parent_process_name | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `domain_account_discovery_with_dsquery_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process_name="fsutil.exe" or processes.original_file_name = "fsutil.exe" and processes.process = "*fsinfo*" by processes.process_name processes.original_file_name processes.process processes.process_id processes.process_guid processes.parent_process_name processes.parent_process processes.parent_process_guid processes.dest processes.user | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `windows_information_discovery_fsutil_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process_name="ipconfig.exe" or processes.original_file_name = "ipconfig.exe" and processes.process = "*/displaydns*" by processes.process_name processes.original_file_name processes.process processes.process_id processes.process_guid processes.parent_process_name processes.parent_process processes.parent_process_guid processes.dest processes.user | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `windows_system_network_config_discovery_display_dns_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process_name="klist.exe" or processes.original_file_name = "klist.exe" processes.parent_process_name in ("cmd.exe", "powershell*") by processes.process_name processes.original_file_name processes.process processes.process_id processes.process_guid processes.parent_process_name processes.parent_process processes.parent_process_guid processes.dest processes.user | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `windows_steal_or_forge_kerberos_tickets_klist_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process_name="quser.exe" or processes.original_file_name = "quser.exe" by processes.process_name processes.original_file_name processes.process processes.process_id processes.process_guid processes.parent_process_name processes.parent_process processes.parent_process_guid processes.dest processes.user | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `windows_system_user_discovery_via_quser_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process_name="wmic.exe" and processes.process = "*/namespace:\\\\root\\directory\\ldap*" and processes.process = "*ds_user*" and processes.process = "*get*" and processes.process = "*ds_samaccountname*" by processes.dest processes.user processes.parent_process processes.process_name processes.process processes.process_id processes.parent_process_id processes.parent_process_name | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `domain_account_discovery_with_wmic_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process_name=chcp.com processes.parent_process_name = cmd.exe processes.parent_process=*/c* by processes.process_name processes.process processes.parent_process_name processes.parent_process processes.process_id processes.parent_process_id processes.dest processes.user | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `chcp_command_execution_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process_name=curl (processes.process="*-s *") or (processes.process="*|*" and processes.process="*bash*") by processes.dest processes.user processes.parent_process_name processes.process_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `curl_download_and_bash_execution_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process_name=curl by processes.dest processes.user processes.parent_process_name processes.process_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | where match(process, "(?i)(-o|-so|-kso|--output)") | `linux_ingress_tool_transfer_with_curl_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process_name=curl processes.process in ("*-f *", "*--form *","*--upload-file *","*-t *","*-d *","*--data *","*--data-raw *", "*-i *", "*--head *") and processes.process in ("*.aws/credentials*". "*.aws/config*") by processes.dest processes.user processes.parent_process_name processes.process_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `linux_curl_upload_file_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process_name=curl processes.process in ("*-x *", "*socks4a://*", "*socks5h://*", "*socks4://*","*socks5://*", "*--preproxy *", "--proxy*") by processes.dest processes.user processes.parent_process_name processes.process_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `linux_proxy_socks_curl_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process_name=curl processes.process=s3.amazonaws.com by processes.dest processes.user processes.parent_process processes.process_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)`| `security_content_ctime(lasttime)` | `suspicious_curl_network_connection_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process_name=dism.exe (processes.process="*/online*" and processes.process="*/disable-feature*" and processes.process="*windows-defender*" and processes.process="*/remove*") by processes.dest processes.user processes.parent_process_name processes.process_name processes.original_file_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `windows_dism_remove_defender_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process_name=dsquery.exe processes.process=*trusteddomain* by processes.dest processes.user processes.parent_process processes.process_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `dsquery_domain_discovery_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process_name=kmod processes.process in ("*lsmod*", "*list*") by processes.dest processes.user processes.parent_process_name processes.process_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `linux_kernel_module_enumeration_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process_name=mavinject.exe processes.process in ("*injectrunning*", "*hmodule=0x*") by processes.dest processes.user processes.parent_process_name processes.process_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `windows_binary_proxy_execution_mavinject_dll_injection_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process_name=msdt.exe processes.process in ("*msdt*","*ms-msdt:*","*ms-msdt:/id*","*ms-msdt:-id*","*/id*") and (processes.process="*it_browseforfile=*" or processes.process="*it_rebrowseforfile=*" or processes.process="*.xml*") and processes.process="*pcwdiagnostic*" by processes.dest processes.user processes.parent_process_name processes.process_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)`| `windows_execute_arbitrary_commands_with_msdt_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process_name=msiexec.exe processes.process= "* /qn *" processes.process= "*/x*" processes.process= "*reboot=*" by processes.dest processes.user processes.parent_process processes.process_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `uninstall_app_using_msiexec_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process_name=net.exe or processes.process_name=net1.exe (processes.process="*localgroup*") by processes.dest processes.user processes.parent_process_name processes.process_name processes.process processes.original_file_name processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)`| `security_content_ctime(lasttime)` | `net_localgroup_discovery_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process_name=ngrok.exe processes.process in ("*start*", "*--config*","*http*","*authtoken*", "*http*", "(*tcp*") by processes.dest processes.user processes.parent_process_name processes.process_name processes.original_file_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)`| `windows_ngrok_reverse_proxy_usage_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process_name=odbcconf.exe by processes.dest processes.user processes.parent_process_name processes.process_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `windows_odbcconf_hunting_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process_name=odbcconf.exe processes.process in ("*/a *", "*-a*") processes.process="*regsvr*" by processes.dest processes.user processes.parent_process_name processes.process_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `windows_odbcconf_load_dll_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process_name=odbcconf.exe processes.process in ("*-f *","*/f *") processes.process="*.rsp*" by processes.dest processes.user processes.parent_process_name processes.process_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `windows_odbcconf_load_response_file_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process_name=plink.exe or processes.original_file_name=plink processes.process in ("*-r *", "*-l *", "*-d *", "*-l *") by processes.dest processes.user processes.parent_process_name processes.process_name processes.original_file_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)`| `windows_protocol_tunneling_with_plink_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process_name=plistbuddy (processes.process=*launchagents* or processes.process=*runatload* or processes.process=*true*) by processes.dest processes.user processes.parent_process processes.process_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)`| `security_content_ctime(lasttime)` | `suspicious_plistbuddy_usage_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process_name=powershell.exe or processes.process_name=cmd.exe processes.process=*get-foresttrust* by processes.dest processes.user processes.parent_process_name processes.process_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `get_foresttrust_with_powershell_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process_name=rasautou.exe processes.process="* -d *"and processes.process="* -p *" by processes.dest processes.user processes.parent_process_name processes.process_name processes.process processes.process_id processes.parent_process_id processes.original_file_name | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `windows_rasautou_dll_execution_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process_name=reg* or processes.process_name=cmd* processes.process=*save* (processes.process=*hkey_local_machine\\security* or processes.process=*hkey_local_machine\\sam* or processes.process=*hkey_local_machine\\system* or processes.process=*hklm\\security* or processes.process=*hklm\\system* or processes.process=*hklm\\sam*) by processes.dest processes.user processes.parent_process processes.process_name processes.original_file_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)`| `security_content_ctime(lasttime)` | `attempted_credential_dump_from_registry_via_reg_exe_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process_name=rundll32.exe processes.process= "*user32.dll,lockworkstation*" by processes.dest processes.user processes.parent_process processes.process_name processes.process processes.process_id processes.parent_process_id processes.parent_process_name | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `rundll32_lockworkstation_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process_name=sc.exe processes.process="*kernel*" by processes.dest processes.user processes.parent_process_name processes.process_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `windows_service_create_kernel_mode_driver_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process_name=schtasks.exe (processes.process=*\\users\\public\\* or processes.process=*\\programdata\\* or processes.process=*windows\\temp*) processes.process=*/create* by processes.dest processes.user processes.parent_process processes.process_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)`| `security_content_ctime(lasttime)`| `suspicious_scheduled_task_from_public_directory_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process_name=schtasks.exe processes.process="*delete*" and processes.process="*raccine*" by processes.dest processes.user processes.parent_process_name processes.process_name processes.original_file_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `windows_raccine_scheduled_task_deletion_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process_name=schtasks.exe processes.process=*/change* processes.process=*/disable* by processes.user processes.process_name processes.process processes.parent_process_name processes.parent_process processes.dest | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `disable_schedule_task_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process_name=scrcons.exe by processes.dest processes.user processes.parent_process processes.process_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `script_execution_via_wmi_filter` '
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process_name=slui.exe (processes.process=*-verb* processes.process=*runas*) by processes.dest processes.user processes.parent_process processes.process_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `slui_runas_elevated_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process_name=sqlite3 processes.process=*lsquarantine* by processes.dest processes.user processes.parent_process processes.process_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)`| `security_content_ctime(lasttime)` | `suspicious_sqlite3_lsquarantine_behavior_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process_name=ssh processes.process in ("*ostricthostkeychecking*", "*oconnecttimeout*", "*obatchmode*") and commandline in ("*http:*","*https:*") by processes.dest processes.user processes.parent_process_name processes.process_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `linux_ssh_remote_services_script_execute_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process_name=wbadmin.exe processes.process="*delete*" and (processes.process="*catalog*" or processes.process="*systemstatebackup*") by processes.process_name processes.process processes.parent_process_name processes.dest processes.user | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)`| `wbadmin_delete_system_backups_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process_name=wget (processes.process="*-q *" or processes.process="*--quiet*" and processes.process="*-o- *") or (processes.process="*|*" and processes.process="*bash*") by processes.dest processes.user processes.parent_process_name processes.process_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `wget_download_and_bash_execution_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process_name=wmic.exe (processes.process="*group get name*") by processes.dest processes.user processes.parent_process_name processes.process_name processes.process processes.original_file_name processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)`| `security_content_ctime(lasttime)` | `wmic_group_discovery_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process_name=wmic.exe processes.process="* product *" processes.process="*where name*" processes.process="*call uninstall*" processes.process="*/nointeractive*" by processes.dest processes.user processes.parent_process_name processes.process_name processes.process processes.original_file_name processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `wmic_noninteractive_app_uninstallation_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process_name=xclip processes.process in ("*-o *", "*-sel *", "*-selection *", "*clip *","*clipboard*") by processes.dest processes.user processes.parent_process_name processes.process_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `linux_clipboard_data_copy_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process_path !="c:\\windows\\system32*" processes.process_path !="c:\\windows\\syswow64*" by processes.dest processes.user processes.parent_process processes.process_name processes.process processes.process_id processes.parent_process_id processes.process_hash | `drop_dm_object_name("processes")` | `security_content_ctime(firsttime)`| `security_content_ctime(lasttime)`| `is_windows_system_file` | `system_processes_run_from_unexpected_locations_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process="*\/..\/..\/..\/*" or processes.process="*\\..\\..\\..\\*" or processes.process="*\/\/..\/\/..\/\/..\/\/*" by processes.dest processes.user processes.parent_process processes.process_name processes.process processes.original_file_name processes.process_id processes.parent_process_id processes.process_hash | `drop_dm_object_name("processes")` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `windows_command_and_scripting_interpreter_path_traversal_exec_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process="*apt*" and processes.process="*apt::update::pre-invoke::*" and processes.process="*sudo*" by processes.dest processes.user processes.parent_process_name processes.process_name processes.process processes.process_id processes.parent_process_id processes.process_guid | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `linux_apt_privilege_escalation_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process="*apt-get*" and processes.process="*apt::update::pre-invoke::*" and processes.process="*sudo*" by processes.dest processes.user processes.parent_process_name processes.process_name processes.process processes.process_id processes.parent_process_id processes.process_guid | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `linux_apt_get_privilege_escalation_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process="*busybox*" and processes.process="*sh*" and processes.process="*sudo*" by processes.dest processes.user processes.parent_process_name processes.process_name processes.process processes.process_id processes.parent_process_id processes.process_guid | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `linux_busybox_privilege_escalation_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process="*c:\\windows\\system32\\conhost.exe* 0xffffffff *-forcev1*" by processes.user processes.process_name processes.process processes.dest | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)`| `security_content_ctime(lasttime)` | `windows_connhost_exe_started_forcefully_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process="*c89*" and processes.process="*-wrapper*" and processes.process="*sudo*" by processes.dest processes.user processes.parent_process_name processes.process_name processes.process processes.process_id processes.parent_process_id processes.process_guid | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `linux_c89_privilege_escalation_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process="*c99*" and processes.process="*-wrapper*" and processes.process="*sudo*" by processes.dest processes.user processes.parent_process_name processes.process_name processes.process processes.process_id processes.parent_process_id processes.process_guid | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `linux_c99_privilege_escalation_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process="*composer*" and processes.process="*run-script*" and processes.process="*sudo*" by processes.dest processes.user processes.parent_process_name processes.process_name processes.process processes.process_id processes.parent_process_id processes.process_guid | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `linux_composer_privilege_escalation_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process="*cpulimit*" and processes.process="*-l*" and processes.process="*-f*" and processes.process="*sudo*" by processes.dest processes.user processes.parent_process_name processes.process_name processes.process processes.process_id processes.parent_process_id processes.process_guid | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `linux_cpulimit_privilege_escalation_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process="*csvtool*" and processes.process="*call*" and processes.process="*sudo*" by processes.dest processes.user processes.parent_process_name processes.process_name processes.process processes.process_id processes.parent_process_id processes.process_guid | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `linux_csvtool_privilege_escalation_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process="*emacs*" and processes.process="*--eval*" and processes.process="*sudo*" by processes.dest processes.user processes.parent_process_name processes.process_name processes.process processes.process_id processes.parent_process_id processes.process_guid | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `linux_emacs_privilege_escalation_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process="*find*" and processes.process="*-exec*" and processes.process="*sudo*" by processes.dest processes.user processes.parent_process_name processes.process_name processes.process processes.process_id processes.parent_process_id processes.process_guid | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `linux_find_privilege_escalation_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process="*gawk*" and processes.process="*begin*{system*" and processes.process="*sudo*" by processes.dest processes.user processes.parent_process_name processes.process_name processes.process processes.process_id processes.parent_process_id processes.process_guid | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `linux_gnu_awk_privilege_escalation_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process="*gdb*" and processes.process="*-nx*" and processes.process="*-ex*!*" and processes.process="*sudo*" by processes.dest processes.user processes.parent_process_name processes.process_name processes.process processes.process_id processes.parent_process_id processes.process_guid | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `linux_gdb_privilege_escalation_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process="*gem*open*-e*" and processes.process="*-c*" and processes.process="*sudo*" by processes.dest processes.user processes.parent_process_name processes.process_name processes.process processes.process_id processes.parent_process_id processes.process_guid | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `linux_gem_privilege_escalation_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process="*make*-s*" and processes.process="*--eval*" and processes.process="*sudo*" by processes.dest processes.user processes.parent_process_name processes.process_name processes.process processes.process_id processes.parent_process_id processes.process_guid | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `linux_make_privilege_escalation_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process="*mysql*-e*" and processes.process="*\!**" and processes.process="*sudo*" by processes.dest processes.user processes.parent_process_name processes.process_name processes.process processes.process_id processes.parent_process_id processes.process_guid | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `linux_mysql_privilege_escalation_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process="*octave-cli*" and processes.process="*--eval*" and processes.process="*system*" and processes.process="*sudo*" by processes.dest processes.user processes.parent_process_name processes.process_name processes.process processes.process_id processes.parent_process_id processes.process_guid | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `linux_octave_privilege_escalation_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process="*openvpn*" and processes.process="*--dev*" and processes.process="*--script-security*" and processes.process="*--up*" and processes.process="*sudo*" by processes.dest processes.user processes.parent_process_name processes.process_name processes.process processes.process_id processes.parent_process_id processes.process_guid | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `linux_openvpn_privilege_escalation_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process="*php*-r*" and processes.process="*system*" and processes.process="*sudo*" by processes.dest processes.user processes.parent_process_name processes.process_name processes.process processes.process_id processes.parent_process_id processes.process_guid | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `linux_php_privilege_escalation_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process="*puppet*" and processes.process="*apply*" and processes.process="*-e*" and processes.process="*exec*" and processes.process="*sudo*" by processes.dest processes.user processes.parent_process_name processes.process_name processes.process processes.process_id processes.parent_process_id processes.process_guid | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `linux_puppet_privilege_escalation_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process="*rpm*--eval*" and processes.process="*lua:os.execute*" and processes.process="*sudo*" by processes.dest processes.user processes.parent_process_name processes.process_name processes.process processes.process_id processes.parent_process_id processes.process_guid | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `linux_rpm_privilege_escalation_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process="*ruby*-e*" and processes.process="*exec*" and processes.process="*sudo*" by processes.dest processes.user processes.parent_process_name processes.process_name processes.process processes.process_id processes.parent_process_id processes.process_guid | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `linux_ruby_privilege_escalation_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process="*sqlite3*" and processes.process="*.shell*" and processes.process="*sudo*" by processes.dest processes.user processes.parent_process_name processes.process_name processes.process processes.process_id processes.parent_process_id processes.process_guid | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `linux_sqlite3_privilege_escalation_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process="*sudo*" and processes.process="*awk*" and processes.process="*begin*system*" by processes.dest processes.user processes.parent_process_name processes.process_name processes.process processes.process_id processes.parent_process_id processes.process_guid | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)`| `linux_awk_privilege_escalation_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process="*sudo*node*" and processes.process="*-e*" and processes.process="*child_process.spawn*" and processes.process="*stdio*" by processes.dest processes.user processes.parent_process_name processes.process_name processes.process processes.process_id processes.parent_process_id processes.process_guid | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `linux_node_privilege_escalation_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process=*get-domaintrust* by processes.dest processes.user processes.parent_process_name processes.process_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `get_domaintrust_with_powershell_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process=*mstsc.exe and processes.dest_category!=common_rdp_source by processes.dest processes.user processes.process | `security_content_ctime(firsttime)`| `security_content_ctime(lasttime)` | `drop_dm_object_name(processes)` | `remote_desktop_process_running_on_system_filter` '
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.registry where (registry.registry_path = "*wmi\\autologger\\defenderapilogger\\start" or registry.registry_path = "*wmi\\autologger\\defenderauditlogger\\start") registry.registry_value_data ="0x00000000" by registry.registry_path registry.registry_value_name registry.registry_value_data registry.process_guid registry.action registry.dest registry.user | `drop_dm_object_name(registry)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `windows_impair_defenses_disable_win_defender_auto_logging_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.registry where (registry.registry_path= "*\\software\\microsoft\\windows\\currentversion\\group policy objects\\*" and registry.registry_path= "*}machine\\software\\policies\\microsoft\\windows\\srpv2*") or registry.registry_path="*\\software\\policies\\microsoft\\windows\\srpv2*" and registry.registry_value_data = "*action\=\"deny\"*" and registry.registry_value_data in("*o=symantec*","*o=mcafee*","*o=kaspersky*","*o=bleeping computer*", "*o=panda security*","*o=systweak software*", "*o=trend micro*", "*o=avast*", "*o=gridinsoft*", "*o=microsoft*", "*o=nano security*", "*o=superantispyware.com*", "*o=doctor web*", "*o=malwarebytes*", "*o=eset*", "*o=avira*", "*o=webroot*") by registry.user registry.registry_path registry.registry_value_data registry.action registry.registry_key_name registry.dest | `drop_dm_object_name(registry)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `windows_impair_defense_deny_security_software_with_applocker_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.registry where (registry.registry_path= "*\\windows\\currentversion\\app paths\\control.exe*" or registry.registry_path= "*\\exefile\\shell\\runas\\command\\*") (registry.registry_value_name = "(default)" or registry.registry_value_name = "isolatedcommand") by _time span=1h registry.dest registry.user registry.registry_path registry.registry_value_name registry.process_guid registry.registry_key_name registry.registry_value_data | `drop_dm_object_name(registry)` |rename process_guid as proc_guid |join proc_guid, _time [| tstats `security_content_summariesonly` count from datamodel=endpoint.processes by _time span=1h processes.process_id processes.process_name processes.process processes.dest processes.parent_process_name processes.parent_process processes.process_guid | `drop_dm_object_name(processes)` |rename process_guid as proc_guid | fields _time dest user parent_process_name parent_process process_name process_path process proc_guid registry_path registry_value_name registry_value_data registry_key_name] | table _time dest user parent_process_name parent_process process_name process_path process proc_guid registry_path registry_value_name registry_value_data registry_key_name | `sdclt_uac_bypass_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.registry where (registry.registry_path="*\\control panel\\desktop\\scrnsave.exe*") by registry.dest registry.user registry.registry_path registry.registry_key_name registry.registry_value_name | `security_content_ctime(lasttime)` | `security_content_ctime(firsttime)` | `drop_dm_object_name(registry)` | `screensaver_event_trigger_execution_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.registry where (registry.registry_path=*\\software\\microsoft\\windows\\currentversion\\runonce or registry.registry_path=*\\software\\microsoft\\windows\\currentversion\\explorer\\startupapproved\\run or registry.registry_path=*\\currentversion\\run* or registry.registry_path=*\\currentversion\\windows\\appinit_dlls* or registry.registry_path=*\\currentversion\\winlogon\\shell* or registry.registry_path=*\\currentversion\\winlogon\\notify* or registry.registry_path=*\\currentversion\\winlogon\\userinit* or registry.registry_path=*\\currentversion\\winlogon\\vmapplet* or registry.registry_path=*\\currentversion\\policies\\explorer\\run* or registry.registry_path=*\\currentversion\\runservices* or registry.registry_path=hklm\\software\\microsoft\\netsh\\* or registry.registry_path= "*\\software\\microsoft\\windows\\currentversion\\explorer\\shell folders\\common startup" or registry.registry_path= *\\software\\microsoft\\windows\\currentversion\\explorer\\sharedtaskscheduler or registry.registry_path= *\\classes\\htmlfile\\shell\\open\\command or (registry.registry_path="*microsoft\\windows nt\\currentversion\\image file execution options*" and registry.registry_key_name=debugger) or (registry.registry_path="*\\currentcontrolset\\control\\lsa" and registry.registry_key_name="security packages") or (registry.registry_path="*\\currentcontrolset\\control\\lsa\\osconfig" and registry.registry_key_name="security packages") or (registry.registry_path="*\\microsoft\\windows nt\\currentversion\\silentprocessexit\\*") or (registry.registry_path="*currentversion\\windows" and registry.registry_key_name="load") or (registry.registry_path="*\\currentversion" and registry.registry_key_name="svchost") or (registry.registry_path="*\\currentcontrolset\control\session manager"and registry.registry_key_name="bootexecute") or (registry.registry_path="*\\software\\run" and registry.registry_key_name="auto_update")) by registry.dest registry.user registry.registry_path registry.registry_value_name registry.registry_value_data registry.process_guid registry.registry_key_name | `drop_dm_object_name(registry)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `registry_keys_used_for_persistence_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.registry where registry.registry_key_name= "*\\software\\microsoft\\windows\\currentversion\\explorer\\recentdocs\\.iso" or registry.registry_key_name= "*\\software\\microsoft\\windows\\currentversion\\explorer\\recentdocs\\.img" by registry.registry_key_name registry.user registry.registry_path registry.registry_value_data registry.action registry.dest | `drop_dm_object_name(registry)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `windows_phishing_recent_iso_exec_registry_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.registry where registry.registry_path = "*\\policies\\microsoft\\windows defender" registry.action = deleted by registry.registry_path registry.registry_value_name registry.registry_value_data registry.process_guid registry.action registry.user registry.dest | `drop_dm_object_name(registry)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `windows_impair_defense_delete_win_defender_profile_registry_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.registry where registry.registry_path = "*\\shellex\\contextmenuhandlers\\epp" registry.action = deleted by registry.registry_path registry.registry_value_name registry.registry_value_data registry.process_guid registry.action registry.dest registry.user | `drop_dm_object_name(registry)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `windows_impair_defense_delete_win_defender_context_menu_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.registry where registry.registry_path = "*\\software\\policies\\microsoft\\windows defender\\exclusions\\*" by _time span=1h registry.dest registry.user registry.registry_path registry.registry_value_name registry.registry_value_data registry.process_guid | `drop_dm_object_name(registry)` |rename process_guid as proc_guid |join proc_guid, _time [| tstats `security_content_summariesonly` count from datamodel=endpoint.processes by _time span=1h processes.process_id processes.process_name processes.process processes.dest processes.parent_process_name processes.parent_process processes.process_guid | `drop_dm_object_name(processes)` |rename process_guid as proc_guid | fields _time dest user parent_process_name parent_process process_name process_path process proc_guid registry_path registry_value_name registry_value_data] | table _time dest user parent_process_name parent_process process_name process_path process proc_guid registry_path registry_value_name registry_value_data | `windows_defender_exclusion_registry_entry_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.registry where registry.registry_path ="*\\control\\print\\environments\\windows x64\\print processors*" by registry.dest registry.user registry.registry_path registry.registry_key_name registry.registry_value_name | `security_content_ctime(lasttime)` | `security_content_ctime(firsttime)` | `drop_dm_object_name(registry)` | `print_processor_registry_autostart_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.registry where registry.registry_path ="*\\currentcontrolset\\services\\w32time\\timeproviders*" by _time span=1h registry.dest registry.user registry.registry_path registry.registry_value_name registry.registry_value_data registry.process_guid | `drop_dm_object_name(registry)` |rename process_guid as proc_guid |join proc_guid, _time [| tstats `security_content_summariesonly` count from datamodel=endpoint.processes by _time span=1h processes.process_id processes.process_name processes.process processes.dest processes.parent_process_name processes.parent_process processes.process_guid | `drop_dm_object_name(processes)` |rename process_guid as proc_guid | fields _time dest user parent_process_name parent_process process_name process_path process proc_guid registry_path registry_value_name registry_value_data] | table _time dest user parent_process_name parent_process process_name process_path process proc_guid registry_path registry_value_name registry_value_data | `time_provider_persistence_registry_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.registry where registry.registry_path ="*\\shell\\open\\command\\*" registry.registry_path = "*hkcr\\*" by registry.dest registry.user registry.registry_path registry.registry_key_name registry.registry_value_name | `security_content_ctime(lasttime)` | `security_content_ctime(firsttime)` | `drop_dm_object_name(registry)` | `change_default_file_association_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.registry where registry.registry_path in ("*\\currentcontrolset\\services\\ntds\\directoryserviceextpt","*\\currentcontrolset\\services\\ntds\\lsadbextpt") by registry.registry_key_name registry.user registry.registry_path registry.registry_value_data registry.action registry.dest registry.process_guid | `drop_dm_object_name(registry)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `windows_autostart_execution_lsass_driver_registry_modification_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.registry where registry.registry_path in ("*\\environment\\userinitmprlogonscript") by registry.dest registry.user registry.registry_path registry.registry_key_name registry.registry_value_name | `security_content_ctime(lasttime)` | `security_content_ctime(firsttime)` | `drop_dm_object_name(registry)` | `logon_script_event_trigger_execution_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.registry where registry.registry_path= "*\\control\\terminal server\\fallowtogethelp*" registry.registry_value_data="0x00000001" by registry.registry_key_name registry.user registry.registry_path registry.registry_value_data registry.action registry.dest | `drop_dm_object_name(registry)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `windows_remote_services_allow_remote_assistance_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.registry where registry.registry_path= "*\\control\\terminal server\\fdenytsconnections*" registry.registry_value_data="0x00000000" by registry.registry_key_name registry.user registry.registry_path registry.registry_value_data registry.action registry.dest | `drop_dm_object_name(registry)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `windows_remote_services_rdp_enable_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.registry where registry.registry_path= "*\\environment\\cor_profiler_path" registry.registry_value_data = "*.dll" by registry.registry_path registry.registry_key_name registry.registry_value_data registry.dest | `drop_dm_object_name(registry)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `net_profiler_uac_bypass_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.registry where registry.registry_path= "*\\software\\microsoft\\windows script\\settings\\amsienable" registry.registry_value_data = "0x00000000" by _time span=1h registry.dest registry.user registry.registry_path registry.registry_value_name registry.registry_value_data registry.process_guid | `drop_dm_object_name(registry)` |rename process_guid as proc_guid |join proc_guid, _time [| tstats `security_content_summariesonly` count from datamodel=endpoint.processes by _time span=1h processes.process_id processes.process_name processes.process processes.dest processes.parent_process_name processes.parent_process processes.process_guid | `drop_dm_object_name(processes)` |rename process_guid as proc_guid | fields _time dest user parent_process_name parent_process process_name process_path process proc_guid registry_path registry_value_name registry_value_data] | table _time dest user parent_process_name parent_process process_name process_path process proc_guid registry_path registry_value_name registry_value_data | `disable_amsi_through_registry_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.registry where registry.registry_path= "*\\software\\microsoft\\windows\\currentversion\\policies\\explorer\\disallowrun*" registry.registry_value_data="0x00000001" by registry.registry_key_name registry.user registry.registry_path registry.registry_value_data registry.action registry.dest | `drop_dm_object_name(registry)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `windows_modify_registry_disallow_windows_app_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.registry where registry.registry_path= "*\\software\\microsoft\\windows\\currentversion\\pushnotifications\\toastenabled*" registry.registry_value_data="0x00000000" by registry.registry_key_name registry.user registry.registry_path registry.registry_value_data registry.action registry.dest | `drop_dm_object_name(registry)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `windows_modify_registry_disable_toast_notifications_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.registry where registry.registry_path= "*\\software\\microsoft\\windows\\windows error reporting\\disable*" registry.registry_value_data="0x00000001" by registry.registry_key_name registry.user registry.registry_path registry.registry_value_data registry.action registry.dest | `drop_dm_object_name(registry)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `windows_modify_registry_disabling_wer_settings_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.registry where registry.registry_path= "*\\system\\currentcontrolset\\services*" and (registry.action = deleted or (registry.registry_value_name = deleteflag and registry.registry_value_data = 0x00000001 and registry.action=modified)) by registry.registry_key_name registry.user registry.registry_path registry.registry_value_data registry.registry_value_name registry.action registry.dest | `drop_dm_object_name(registry)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `windows_service_deletion_in_registry_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.registry where registry.registry_path= "*\\system\\remote manipulator system*" by registry.registry_key_name registry.user registry.registry_path registry.registry_value_data registry.action registry.dest | `drop_dm_object_name(registry)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `windows_remote_access_software_rms_registry_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.registry where registry.registry_path= "*\\windows defender\\real-time protection\\disablerawwritenotification*" registry.registry_value_data="0x00000001" by registry.registry_key_name registry.user registry.registry_path registry.registry_value_data registry.action registry.dest | `drop_dm_object_name(registry)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `windows_modify_registry_disable_win_defender_raw_write_notif_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.registry where registry.registry_path= "*\\windows defender\\ux configuration\\notification_suppress*" registry.registry_value_data="0x00000001" by registry.registry_key_name registry.user registry.registry_path registry.registry_value_data registry.action registry.dest | `drop_dm_object_name(registry)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `windows_modify_registry_suppress_win_defender_notif_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.registry where registry.registry_path= "*\\windows\\currentversion\\immersiveshell\\useactioncenterexperience*" registry.registry_value_data="0x00000000" by registry.registry_key_name registry.user registry.registry_path registry.registry_value_data registry.action registry.dest | `drop_dm_object_name(registry)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `windows_modify_registry_disable_windows_security_center_notif_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.registry where registry.registry_path= "*software\\microsoft\\windows nt\\currentversion\\winlogon*" and registry.registry_value_name=autoadminlogon and registry.registry_value_data=1 by _time span=1h registry.dest registry.user registry.registry_path registry.registry_value_name registry.process_guid registry.registry_key_name registry.registry_value_data | `drop_dm_object_name(registry)` |rename process_guid as proc_guid |join proc_guid, _time [| tstats `security_content_summariesonly` count from datamodel=endpoint.processes by _time span=1h processes.process_id processes.process_name processes.process processes.dest processes.parent_process_name processes.parent_process processes.process_guid | `drop_dm_object_name(processes)` |rename process_guid as proc_guid | fields _time dest user parent_process_name parent_process process_name process_path process proc_guid registry_path registry_value_name registry_value_data registry_key_name] | table _time dest user parent_process_name parent_process process_name process_path process proc_guid registry_path registry_value_name registry_value_data registry_key_name | `auto_admin_logon_registry_entry_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.registry where registry.registry_path="*\\currentversion\\policies\\system*" registry.registry_value_name="localaccounttokenfilterpolicy" registry.registry_value_data="0x00000001" by _time span=1h registry.dest registry.user registry.registry_path registry.registry_value_name registry.registry_value_data registry.process_guid | `drop_dm_object_name(registry)` |rename process_guid as proc_guid |join proc_guid, _time [| tstats `security_content_summariesonly` count from datamodel=endpoint.processes by _time span=1h processes.process_id processes.process_name processes.process processes.dest processes.parent_process_name processes.parent_process processes.process_guid | `drop_dm_object_name(processes)` |rename process_guid as proc_guid | fields _time dest user parent_process_name parent_process process_name process_path process proc_guid registry_path registry_value_name registry_value_data] | table _time dest user parent_process_name parent_process process_name process_path process proc_guid registry_path registry_value_name registry_value_data | `disable_uac_remote_restriction_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.registry where registry.registry_path="*\\software\\microsoft\\.netframework*" registry.registry_value_name = etwenabled registry.registry_value_data=0x00000000 by _time span=1h registry.dest registry.user registry.registry_path registry.registry_value_name registry.process_guid registry.registry_key_name registry.registry_value_data | `drop_dm_object_name(registry)` |rename process_guid as proc_guid |join proc_guid, _time [| tstats `security_content_summariesonly` count from datamodel=endpoint.processes by _time span=1h processes.process_id processes.process_name processes.process processes.dest processes.parent_process_name processes.parent_process processes.process_guid | `drop_dm_object_name(processes)` |rename process_guid as proc_guid | fields _time dest user parent_process_name parent_process process_name process_path process proc_guid registry_path registry_value_name registry_value_data registry_key_name] | table _time dest user parent_process_name parent_process process_name process_path process proc_guid registry_path registry_value_name registry_value_data registry_key_name | `etw_registry_disabled_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.registry where registry.registry_path="*\\system\\currentcontrolset\\control\\securityproviders\\wdigest\\*" registry.registry_value_name = "uselogoncredential" registry.registry_value_data = 0x00000001 by _time span=1h registry.dest registry.user registry.registry_path registry.registry_value_name registry.process_guid registry.registry_key_name registry.registry_value_data | `drop_dm_object_name(registry)` |rename process_guid as proc_guid |join proc_guid, _time [| tstats `security_content_summariesonly` count from datamodel=endpoint.processes by _time span=1h processes.process_id processes.process_name processes.process processes.dest processes.parent_process_name processes.parent_process processes.process_guid | `drop_dm_object_name(processes)` |rename process_guid as proc_guid | fields _time dest user parent_process_name parent_process process_name process_path process proc_guid registry_path registry_value_name registry_value_data registry_key_name] | table _time dest user parent_process_name parent_process process_name process_path process proc_guid registry_path registry_value_name registry_value_data registry_key_name | `enable_wdigest_uselogoncredential_registry_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.registry where registry.registry_path="*\\system\\currentcontrolset\\services*" registry.registry_value_name = imagepath by _time span=1h registry.dest registry.user registry.registry_path registry.registry_value_name registry.registry_value_data registry.process_guid | `drop_dm_object_name(registry)` |rename process_guid as proc_guid |join proc_guid, _time [| tstats `security_content_summariesonly` count from datamodel=endpoint.processes by _time span=1h processes.process_id processes.process_name processes.process processes.dest processes.parent_process_name processes.parent_process processes.process_guid | `drop_dm_object_name(processes)` |rename process_guid as proc_guid | fields _time dest user parent_process_name parent_process process_name process_path process proc_guid registry_path registry_value_name registry_value_data] | table _time dest user parent_process_name parent_process process_name process_path process proc_guid registry_path registry_value_name registry_value_data | `windows_service_creation_using_registry_entry_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.registry where registry.registry_path="*\\windows nt\\currentversion\\winlogon\\specialaccounts\\userlist*" and registry.registry_value_data = "0x00000000" by _time span=1h registry.dest registry.user registry.registry_path registry.registry_value_name registry.process_guid registry.registry_key_name registry.registry_value_data | `drop_dm_object_name(registry)` |rename process_guid as proc_guid |join proc_guid, _time [| tstats `security_content_summariesonly` count from datamodel=endpoint.processes by _time span=1h processes.process_id processes.process_name processes.process processes.dest processes.parent_process_name processes.parent_process processes.process_guid | `drop_dm_object_name(processes)` |rename process_guid as proc_guid | fields _time dest user parent_process_name parent_process process_name process_path process proc_guid registry_path registry_value_name registry_value_data registry_key_name] | table _time dest user parent_process_name parent_process process_name process_path process proc_guid registry_path registry_value_name registry_value_data registry_key_name | `hide_user_account_from_sign_in_screen_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.registry where registry.registry_path="*hklm\\system\\currentcontrolset\\control\\terminal server\\winstations\\rdp-tcp*" registry.registry_value_name = "portnumber" by _time span=1h registry.dest registry.user registry.registry_path registry.registry_value_name registry.process_guid registry.registry_key_name | `drop_dm_object_name(registry)` |rename process_guid as proc_guid |join proc_guid, _time [| tstats `security_content_summariesonly` count from datamodel=endpoint.processes by _time span=1h processes.process_id processes.process_name processes.process processes.dest processes.parent_process_name processes.parent_process processes.process_guid | `drop_dm_object_name(processes)` |rename process_guid as proc_guid | fields _time dest user parent_process_name parent_process process_name process_path process proc_guid registry_path registry_value_name registry_value_data registry_key_name] | table _time dest user parent_process_name parent_process process_name process_path process proc_guid registry_path registry_value_name registry_value_data registry_key_name | `enable_rdp_in_other_port_number_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.registry where registry.registry_path=*hklm\\software\\microsoft\\windows\\currentversion\\policies\\system\\enablelua* registry.registry_value_data="0x00000000" by registry.dest, registry.registry_key_name registry.user registry.registry_path registry.registry_value_data registry.action | `drop_dm_object_name(registry)` | `disabling_remote_user_account_control_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.registry where registry.registry_path=*software\\microsoft\\powershell\\1\\shellids\\microsoft.powershell* registry.registry_value_name=executionpolicy (registry.registry_value_data=unrestricted or registry.registry_value_data=bypass) by registry.registry_path registry.registry_value_name registry.registry_value_data registry.dest | `drop_dm_object_name(registry)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `set_default_powershell_execution_policy_to_unrestricted_or_bypass_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.registry where registry.registry_value_data = "*mshta*" or registry.registry_value_data in ("*javascript:*", "*vbscript:*","*wscript.shell*") by registry.registry_key_name registry.registry_path registry.registry_value_data registry.action registry.dest | `drop_dm_object_name(registry)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `windows_mshta_execution_in_registry_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.registry where registry.registry_value_name="disableantispyware" and registry.registry_value_data="0x00000001" by registry.dest registry.user registry.registry_path registry.registry_value_data | `drop_dm_object_name(registry)` | `security_content_ctime(lasttime)` | `security_content_ctime(firsttime)` | `windows_disableantispyware_registry_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=network_resolution where dns.message_type=response and dns.record_type=txt by dns.src dns.dest dns.answer dns.record_type | `drop_dm_object_name("dns")` | eval anslen=len(answer) | search anslen>100 | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | rename src as "source ip", dest as "destination ip", answer as "dns answer" anslen as "answer length" record_type as "dns record type" firsttime as "first time" lasttime as "last time" count as count | table "source ip" "destination ip" "dns answer" "dns record type" "answer length" count "first time" "last time" | `detect_long_dns_txt_record_response_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=network_resolution where dns.query in ("*.ngrok.com","*.ngrok.io", "ngrok.*.tunnel.com", "korgn.*.lennut.com") by dns.src dns.query dns.answer | `drop_dm_object_name("dns")` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `ngrok_reverse_proxy_on_network_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=network_traffic where (all_traffic.app=dns not all_traffic.dest_port=53) or ((all_traffic.app=web-browsing or all_traffic.app=http) not (all_traffic.dest_port=80 or all_traffic.dest_port=8080 or all_traffic.dest_port=8000)) or (all_traffic.app=ssl not (all_traffic.dest_port=443 or all_traffic.dest_port=8443)) or (all_traffic.app=smtp not all_traffic.dest_port=25) by all_traffic.src_ip, all_traffic.dest_ip, all_traffic.app, all_traffic.dest_port |`security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `drop_dm_object_name("all_traffic")` | `protocol_or_port_mismatch_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=network_traffic where (all_traffic.transport=udp and all_traffic.dest_port=69) or (all_traffic.transport=tcp and all_traffic.dest_port=21) or (all_traffic.transport=tcp and all_traffic.dest_port=22) and all_traffic.dest_category!=common_software_repo_destination and all_traffic.src_category=network or all_traffic.src_category=router or all_traffic.src_category=switch by all_traffic.src all_traffic.dest all_traffic.dest_port | `drop_dm_object_name("all_traffic")` | `security_content_ctime(firsttime)`| `security_content_ctime(lasttime)` | `detect_software_download_to_network_device_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=network_traffic where all_traffic.action = allowed by all_traffic.src_ip all_traffic.dest_ip all_traffic.dest_port all_traffic.action | lookup update=true interesting_ports_lookup dest_port as all_traffic.dest_port output app is_prohibited note transport | search is_prohibited=true | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `drop_dm_object_name("all_traffic")` | `prohibited_network_traffic_allowed_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=network_traffic where all_traffic.app=rdp by all_traffic.src all_traffic.dest all_traffic.dest_port | eventstats stdev(count) as stdev avg(count) as avg p50(count) as p50 | where count>(avg + stdev*2) | rename all_traffic.src as src all_traffic.dest as dest | table firsttime lasttime src dest count avg p50 stdev | `remote_desktop_network_bruteforce_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=network_traffic where all_traffic.app=tor and all_traffic.action=allowed by all_traffic.src_ip all_traffic.dest_ip all_traffic.dest_port all_traffic.action | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `drop_dm_object_name("all_traffic")` | `tor_traffic_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=network_traffic where all_traffic.dest_port=3389 and all_traffic.dest_category!=common_rdp_destination and all_traffic.src_category!=common_rdp_source and all_traffic.action="allowed" by all_traffic.src all_traffic.dest all_traffic.dest_port | `drop_dm_object_name("all_traffic")` | `security_content_ctime(firsttime)`| `security_content_ctime(lasttime)` | `remote_desktop_network_traffic_filter` '
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=web where (web.http_method="get" or web.http_method="head") and (web.url="*/web-console/serverinfo.jsp*" or web.url="*web-console*" or web.url="*jmx-console*" or web.url = "*invoker*") by web.http_method, web.url, web.src, web.dest | `drop_dm_object_name("web")` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `detect_attackers_scanning_for_vulnerable_jboss_servers_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=web where (web.status=200 or web.status=302 or web.status=401) and web.http_method=post by web.src web.status web.uri_path web.dest web.http_method web.uri_query | `drop_dm_object_name("web")` | eval is_autodiscover=if(like(lower(uri_path),"%autodiscover%"),1,0) | eval powershell = if(match(lower(uri_query),"powershell"), "1",0) | eval mapi=if(like(uri_query,"%/mapi/%"),1,0) | addtotals fieldname=score is_autodiscover, powershell, mapi | fields score, src,dest, status, uri_query,uri_path,http_method | where score >= 2 | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `windows_exchange_autodiscover_ssrf_abuse_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=web where web.http_method in (post, get) by web.src web.status web.uri_path web.dest web.http_method web.uri_query web.http_user_agent | `drop_dm_object_name("web")` | eval utf=if(like(lower(uri_query),"%:utf-8:http%"),2,0) | eval lookup = if(like(lower(uri_query), "%url%") or like(lower(uri_query), "%dns%") or like(lower(uri_query), "%script%"),2,0) | eval other_lookups = if(like(lower(uri_query), "%env%") or like(lower(uri_query), "%file%") or like(lower(uri_query), "%java%") or like(lower(uri_query), "%localhost%") or like(lower(uri_query), "%properties%") or like(lower(uri_query), "%resource%") or like(lower(uri_query), "%sys%") or like(lower(uri_query), "%xml%") or like(lower(uri_query), "%base%"),1,0) | addtotals fieldname=score utf lookup other_lookups | fields score, src, dest, status, uri_query, uri_path, http_method, http_user_agent firsttime lasttime | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | where score >= 4 | `exploit_public_facing_application_via_apache_commons_text_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime values(all_changes.user) as user from datamodel=change.all_changes where all_changes.result="*locked out*" by all_changes.dest all_changes.result |`drop_dm_object_name("all_changes")` |`drop_dm_object_name("account_management")`| `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | search count > 5 | `detect_excessive_account_lockouts_from_endpoint_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime values(dns.answer) as answer from datamodel=network_resolution.dns by dns.dest dns.src dns.query host | `drop_dm_object_name(dns)`| rex field=query ".*?(?<domain>[^./:]+\.(\s{2,3}|\s{2,3}.\s{2,3}))$" | stats count values(query) as query by domain dest src answer| search `evilginx_phishlets_amazon` or `evilginx_phishlets_facebook` or `evilginx_phishlets_github` or `evilginx_phishlets_0365` or `evilginx_phishlets_outlook` or `evilginx_phishlets_aws` or `evilginx_phishlets_google` | search not [ inputlookup legit_domains.csv | fields domain]| join domain type=outer [| tstats count `security_content_summariesonly` values(web.url) as url from datamodel=web.web by web.dest web.site | rename "web.*" as * | rex field=site ".*?(?<domain>[^./:]+\.(\s{2,3}|\s{2,3}.\s{2,3}))$" | table dest domain url] | table count src dest query answer domain url | `detect_dns_requests_to_phishing_sites_leveraging_evilginx2_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime values(filesystem.file_path) as file_path values(filesystem.file_name) as file_name from datamodel=endpoint.filesystem where filesystem.file_path = "*$recycle.bin*" by filesystem.process_id filesystem.dest | `drop_dm_object_name("filesystem")`| search [| tstats `security_content_summariesonly` values(processes.user) as user values(processes.process_name) as process_name values(processes.parent_process_name) as parent_process_name from datamodel=endpoint.processes where processes.process_name != "explorer.exe" by processes.process_id processes.dest| `drop_dm_object_name("processes")` | table process_id dest] | `suspicious_writes_to_windows_recycle_bin_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime values(filesystem.user) as user values(filesystem.dest) as dest values(filesystem.file_name) as file_name from datamodel=endpoint.filesystem where filesystem.file_path=*\\windows\\system32\\test.txt by filesystem.file_path | `drop_dm_object_name(filesystem)` | `security_content_ctime(lasttime)` | `security_content_ctime(firsttime)` | `samsam_test_file_write_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime values(filesystem.user) as user values(filesystem.dest) as dest values(filesystem.file_path) as file_path from datamodel=endpoint.filesystem by filesystem.file_name | `drop_dm_object_name(filesystem)` | `security_content_ctime(lasttime)` | `security_content_ctime(firsttime)` | `ransomware_notes` | `common_ransomware_notes_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime values(filesystem.user) as user values(filesystem.dest) as dest values(filesystem.file_path) as file_path from datamodel=endpoint.filesystem where (filesystem.file_path=*\\windows\\system32\\sethc.exe* or filesystem.file_path=*\\windows\\system32\\utilman.exe* or filesystem.file_path=*\\windows\\system32\\osk.exe* or filesystem.file_path=*\\windows\\system32\\magnify.exe* or filesystem.file_path=*\\windows\\system32\\narrator.exe* or filesystem.file_path=*\\windows\\system32\\displayswitch.exe* or filesystem.file_path=*\\windows\\system32\\atbroker.exe*) by filesystem.file_name filesystem.dest | `drop_dm_object_name(filesystem)` | `security_content_ctime(lasttime)` | `security_content_ctime(firsttime)` | `overwriting_accessibility_binaries_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime values(processes.process) as process from datamodel=endpoint.processes where processes.process_name=schtasks.exe (processes.process= "*create*" or processes.process= "*delete*") by processes.parent_process processes.process_name processes.user | `drop_dm_object_name("processes")` | `security_content_ctime(firsttime)`|`security_content_ctime(lasttime)` | search (process=*rhaegal* or process=*drogon* or *viserion_*) | `scheduled_tasks_used_in_badrabbit_ransomware_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime values(processes.process) as process values(processes.parent_process) as parent_process from datamodel=endpoint.processes by processes.dest processes.user processes.process_name processes.process | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `drop_dm_object_name(processes)` | lookup windows_protocol_handlers handler as process output handler ishandler | where ishandler="true" | `windows_identify_protocol_handlers_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime values(processes.process) as process values(processes.parent_process) as parent_process from datamodel=endpoint.processes where processes.dest!=unknown processes.user!=unknown by processes.dest processes.user processes.process_name processes.process | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `drop_dm_object_name(processes)` | lookup attacker_tools attacker_tool_names as process_name output
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime values(processes.process) as process values(processes.parent_process) as parent_process from datamodel=endpoint.processes where processes.dest!=unknown processes.user!=unknown by processes.dest processes.user processes.process_name processes.process | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `drop_dm_object_name(processes)` | lookup remote_access_software remote_utility as process_name output isutility | search isutility = true | `windows_remote_access_software_hunt_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime values(processes.process_name) as process_name from datamodel=endpoint.processes where processes.dest!=unknown processes.user!=unknown not (processes.process_path in ("*\\system32\\*", "*\\syswow64\\*","*\\winsxs\\*")) by processes.dest processes.user processes.parent_process_name processes.process_name processes.process_path | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `drop_dm_object_name(processes)` | lookup hijacklibs library as process_name output islibrary | search islibrary = true | rename parent_process_name as "process name" process_name as imageloaded process_path as module_path | `windows_dll_search_order_hijacking_hunt_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime values(processes.process_name) as process_name values(processes.parent_process_name) as parent_process_name from datamodel=endpoint.processes where processes.process_name!=explorer.exe and processes.process_name!=openwith.exe by processes.process_id processes.dest | `drop_dm_object_name("processes")` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | join [| tstats `security_content_summariesonly` values(registry.registry_path) as registry_path count from datamodel=endpoint.registry where registry.registry_path=*\\explorer\\fileexts* by registry.process_id registry.dest | `drop_dm_object_name("registry")` | table process_id dest registry_path]| `suspicious_changes_to_file_associations_filter` '
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime values(processes.process_name) as process_name values(processes.parent_process_name) as parent_process_name values(processes.user) as user from datamodel=endpoint.processes where processes.process_name=reg.exe processes.process=*reg* processes.process=*add* processes.process=*services* by processes.process_id processes.dest processes.process | `drop_dm_object_name("processes")` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `reg_exe_manipulating_windows_services_registry_keys_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime values(processes.process) as process max(_time) as lasttime from datamodel=endpoint.processes where `process_certutil` (processes.process=*-addstore*) by processes.dest processes.user processes.parent_process processes.process_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name("processes")` | `security_content_ctime(firsttime)` |`security_content_ctime(lasttime)` | `attempt_to_add_certificate_to_untrusted_store_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as firsttime values(processes.process) as process max(_time) as lasttime from datamodel=endpoint.processes where processes.process_name=fltmc.exe and processes.process=*unload* and processes.process=*sysmondrv* by processes.process_name processes.process_id processes.parent_process_name processes.process processes.dest processes.user | `drop_dm_object_name("processes")` | `security_content_ctime(firsttime)`|`security_content_ctime(lasttime)` |`unload_sysmon_filter_driver_filter`| table firsttime lasttime dest user count process_name process_id parent_process_name process'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) as start_time max(_time) as end_time values(dns.src) as src values(dns.dest) as dest from datamodel=network_resolution by dns.query dns.record_type | search dns.record_type=* | `drop_dm_object_name(dns)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | eval query_length = len(query) | apply dns_query_pdfmodel threshold=0.01 | rename "isoutlier(query_length)" as isoutlier | search isoutlier > 0 | sort -query_length | table start_time end_time query record_type count src dest query_length | `dns_query_length_outliers___mltk_filter` '
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) values(processes.process) as process max(_time) as lasttime from datamodel=endpoint.processes where (processes.process="* /stext *" or processes.process="* /scomma *" ) by processes.parent_process processes.process_name processes.user | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` |`security_content_ctime(lasttime)` | `detection_of_tools_built_by_nirsoft_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count min(_time) values(processes.process) as process max(_time) as lasttime from datamodel=endpoint.processes where processes.process_name=attrib.exe (processes.process=*+h*) by processes.parent_process processes.process_name processes.user processes.dest | `drop_dm_object_name("processes")` | `security_content_ctime(firsttime)`|`security_content_ctime(lasttime)`| `hiding_files_and_directories_with_attrib_exe_filter` '
<li><a href="#">search: '| tstats `security_content_summariesonly` count values(all_traffic.dest_ip) as dest values(all_traffic.dest_port) as port from datamodel=network_traffic where all_traffic.dest_port=139 or all_traffic.dest_port=445 or all_traffic.app=smb by _time span=1h, all_traffic.src | eval hourofday=strftime(_time, "%h") | eval dayofweek=strftime(_time, "%a") | `drop_dm_object_name(all_traffic)` | apply smb_pdfmodel threshold=0.001 | rename "isoutlier(count)" as isoutlier | search isoutlier > 0 | sort -count | table _time src dest port count | `smb_traffic_spike___mltk_filter` '
<li><a href="#">search: '| tstats `security_content_summariesonly` count values(dns.answer) as answer min(_time) as firsttime from datamodel=network_resolution by dns.query host | `drop_dm_object_name("dns")` | `security_content_ctime(firsttime)` | `dynamic_dns_providers` | `detect_hosts_connecting_to_dynamic_domain_providers_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count values(filesystem.action) values(filesystem.file_hash) as file_hash values(filesystem.file_path) as file_path min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.filesystem where filesystem.file_path=*windows\\apppatch\\custom* by filesystem.file_name filesystem.dest | `security_content_ctime(lasttime)` | `security_content_ctime(firsttime)` |`drop_dm_object_name(filesystem)` | `shim_database_file_creation_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count values(filesystem.file_path) as file_path min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.filesystem where (filesystem.file_name=*.pst or filesystem.file_name=*.ost) filesystem.file_path != "c:\\users\\*\\my documents\\outlook files\\*" filesystem.file_path!="c:\\users\\*\\appdata\\local\\microsoft\\outlook*" by filesystem.action filesystem.process_id filesystem.file_name filesystem.dest | `drop_dm_object_name("filesystem")` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)`| `email_files_written_outside_of_the_outlook_directory_filter` '
<li><a href="#">search: '| tstats `security_content_summariesonly` count values(processes.process) as process min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where `process_cmd` by processes.parent_process_name processes.process_name processes.original_file_name processes.dest processes.user| `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)`| `security_content_ctime(lasttime)` |search [`prohibited_apps_launching_cmd`] | `detect_prohibited_applications_spawning_cmd_exe_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count values(processes.process) as process min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process_name=netsh.exe by processes.user processes.dest processes.parent_process processes.parent_process_name processes.process_name | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `processes_created_by_netsh_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count values(processes.process) as process values(processes.parent_process) as parent_process min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where (processes.process_name=vssadmin.exe or processes.process_name=wmic.exe) processes.process=*delete* processes.process=*shadow* by processes.user processes.process_name processes.parent_process_name processes.dest | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)`| `security_content_ctime(lasttime)` | `deleting_shadow_copies_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count values(processes.process) as process values(processes.parent_process) as parent_process min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where `process_mshta` (processes.process="*http://*" or processes.process="*https://*") by processes.user processes.process_name processes.parent_process_name processes.original_file_name processes.dest | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)`| `security_content_ctime(lasttime)` | `detect_mshta_url_in_command_line_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count values(processes.process) as process values(processes.parent_process) as parent_process min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where `process_mshta` (processes.process=*vbscript* or processes.process=*javascript* or processes.process=*about*) by processes.user processes.process_name processes.original_file_name processes.parent_process_name processes.dest | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)`| `security_content_ctime(lasttime)` | `detect_mshta_inline_hta_execution_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count values(processes.process) as process values(processes.parent_process) as parent_process min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where `process_powershell` by processes.user processes.process_name processes.original_file_name processes.parent_process_name processes.dest processes.process | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)`| `security_content_ctime(lasttime)`| eval num_obfuscation = (mvcount(split(process,"`"))-1) + (mvcount(split(process, "^"))-1) + (mvcount(split(process, "''"))-1) | `malicious_powershell_process_with_obfuscation_techniques_filter` | search num_obfuscation > 10 '
<li><a href="#">search: '| tstats `security_content_summariesonly` count values(processes.process) as process values(processes.parent_process) as parent_process min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where `process_rundll32` (processes.process=*vbscript* or processes.process=*javascript* or processes.process=*about*) by processes.user processes.process_name processes.parent_process_name processes.original_file_name processes.dest | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)`| `security_content_ctime(lasttime)` | `detect_rundll32_inline_hta_execution_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count values(processes.process) as process values(processes.parent_process) as parent_process min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where not processes.user in ("","unknown") by processes.dest processes.process_name processes.user _time | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `drop_dm_object_name(processes)` | search `system_network_configuration_discovery_tools` | transaction dest connected=false maxpause=5m |where eventcount>=5 | table firsttime lasttime dest user process_name process parent_process eventcount | `detect_processes_used_for_system_network_configuration_discovery_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count values(processes.process) as process values(processes.parent_process) as parent_process min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process_name=fsutil.exe by processes.user processes.process_name processes.parent_process_name processes.dest | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)`| `security_content_ctime(lasttime)` | search process="*deletejournal*" and process="*usn*" | `usn_journal_deletion_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count values(processes.process) as process values(processes.parent_process) as parent_process min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process_name=fsutil.exe processes.process="*setzerodata*" by processes.user processes.process_name processes.parent_process_name processes.dest processes.process processes.parent_process | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `fsutil_zeroing_file_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count values(processes.process) as process values(processes.parent_process) as parent_process min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process_name=powershell.exe by processes.user processes.process_name processes.parent_process_name processes.dest | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)`| `security_content_ctime(lasttime)`| search (process=*-encodedcommand* or process=*-enc*) process=*-exec* | `suspicious_powershell_command_line_arguments_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count values(processes.process) as process values(processes.parent_process) as parent_process min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process_name=schtasks.exe (processes.process=*delete* or processes.process=*create*) by processes.user processes.process_name processes.parent_process_name processes.dest | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)`| `security_content_ctime(lasttime)` | `scheduled_task_deleted_or_created_via_cmd_filter` '
<li><a href="#">search: '| tstats `security_content_summariesonly` count values(processes.process) as processes.process min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where `process_netsh` by processes.parent_process_name processes.parent_process processes.original_file_name processes.process_name processes.user processes.dest |`drop_dm_object_name("processes")` |`security_content_ctime(firsttime)` |`security_content_ctime(lasttime)` |`processes_launching_netsh_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count values(processes.process) min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.parent_process_name="cmd.exe" (processes.process_name=cscript.exe or processes.process_name =wscript.exe) by processes.parent_process processes.process_name processes.user processes.dest | `drop_dm_object_name("processes")` | `security_content_ctime(firsttime)`|`security_content_ctime(lasttime)` | `detect_use_of_cmd_exe_to_launch_script_interpreters_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count values(processes.process) min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.parent_process_name="excel.exe" `process_powershell` by processes.parent_process processes.process_name processes.user processes.dest processes.original_file_name | `drop_dm_object_name("processes")` | `security_content_ctime(firsttime)`|`security_content_ctime(lasttime)` | `excel_spawning_powershell_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count values(processes.process) min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.parent_process_name="excel.exe" processes.process_name in ("cscript.exe", "wscript.exe") by processes.parent_process processes.process_name processes.user processes.dest | `drop_dm_object_name("processes")` | `security_content_ctime(firsttime)`|`security_content_ctime(lasttime)` | `excel_spawning_windows_script_host_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count values(processes.process) values(processes.process_name) values(processes.parent_process_name) dc(processes.process) as distinct_commands dc(processes.process_name) as distinct_process_names min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where [|inputlookup linux_tool_discovery_process.csv | rename process as processes.process |table processes.process] by _time span=5m processes.user processes.dest | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)`| where distinct_commands > 40 and distinct_process_names > 3| `suspicious_linux_discovery_commands_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count values(processes.process_name) as process_name values(processes.process) as process min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where (processes.parent_process_name=svchost.exe or processes.parent_process_name=wmiprvse.exe) and `process_mshta` by processes.dest processes.parent_process processes.user processes.original_file_name| `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `suspicious_mshta_spawn_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count values(processes.process_name) as process_name values(processes.process) as process min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where `process_msbuild` and (processes.process_path!=*\\framework*\\v*\\*) by processes.dest processes.original_file_name processes.parent_process processes.user | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)`| `suspicious_msbuild_path_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count values(processes.process_name) as process_name values(processes.process) as process min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.parent_process_name in ("wscript.exe", "cscript.exe") and `process_msbuild` by processes.dest processes.parent_process processes.parent_process_name processes.process_name processes.original_file_name processes.user | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `msbuild_suspicious_spawned_by_script_process_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count values(processes.process_name) as process_name values(processes.process) as process min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.parent_process_name=mshta.exe and (processes.process_name=powershell.exe or processes.process_name=colorcpl.exe or processes.process_name=msbuild.exe or processes.process_name=microsoft.workflow.compiler.exe or processes.process_name=searchprotocolhost.exe or processes.process_name=scrcons.exe or processes.process_name=cscript.exe or processes.process_name=wscript.exe or processes.process_name=powershell.exe or processes.process_name=cmd.exe) by processes.dest processes.parent_process processes.user | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `suspicious_mshta_child_process_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count values(processes.process_name) as process_name values(processes.process) as process min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.parent_process_name=spoolsv.exe and processes.process_name!=regsvr32.exe by processes.dest processes.parent_process processes.user | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `child_processes_of_spoolsv_exe_filter` '
<li><a href="#">search: '| tstats `security_content_summariesonly` count values(processes.process_name) as process_name values(processes.process) as process min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.parent_process_name=w3wp.exe and `process_cmd` or `process_powershell` by processes.dest processes.parent_process processes.original_file_name processes.user | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)`| `w3wp_spawning_shell_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count values(processes.process_name) as process_name values(processes.process) as process min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.parent_process_name=wmiprvse.exe and `process_msbuild` by processes.dest processes.parent_process processes.original_file_name processes.user | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `suspicious_msbuild_spawn_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count values(processes.process_name) as process_name values(processes.process) as process min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process_path = "*\\windows\\fonts\\*" or processes.process_path = "*\\windows\\temp\\*" or processes.process_path = "*\\users\\public\\*" or processes.process_path = "*\\windows\\debug\\*" or processes.process_path.file_path = "*\\users\\administrator\\music\\*" or processes.process_path.file_path = "*\\windows\\servicing\\*" or processes.process_path.file_path = "*\\users\\default\\*" or processes.process_path.file_path = "*recycle.bin*" or processes.process_path = "*\\windows\\media\\*" or processes.process_path = "\\windows\\repair\\*" or processes.process_path = "*\\temp\\*" or processes.process_path = "*\\perflogs\\*" by processes.parent_process_name processes.parent_process processes.process_path processes.dest processes.user | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `suspicious_process_file_path_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count values(processes.process_name) as process_name_list values(processes.process) as process_list values(processes.process_id) as process_id_list values(processes.parent_process_id) as parent_process_id_list values(processes.process_guid) as process_guid_list dc(processes.process_name) as process_name_count from datamodel=endpoint.processes where processes.process_name in ("arp", "ifconfig", "ip", "netstat", "firewall-cmd", "ufw", "iptables", "ss", "route") by _time span=30m processes.dest processes.user | where process_name_count >=4 | `drop_dm_object_name(processes)`| `linux_system_network_discovery_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count values(processes.process_path) as process_path min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process = "* .*" by processes.dest processes.user processes.process processes.process_name | `security_content_ctime(firsttime)`| `security_content_ctime(lasttime)` | `drop_dm_object_name(processes)` | `execution_of_file_with_spaces_before_extension_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count values(processes.user) as user values(processes.parent_process) as parent_process min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where (processes.process_name=net.exe or processes.process_name=net1.exe) and processes.process=*/add* and (processes.process=*administrators* or processes.process=*administratoren* or processes.process=*administrateurs* or processes.process=*administrador* or processes.process=*amministratori* or processes.process=*administratorer*) by processes.process processes.process_name processes.dest | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `create_local_admin_accounts_using_net_exe_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count values(processes.user) as user values(processes.parent_process) as parent_process min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where `process_net` by processes.process processes.process_name processes.original_file_name processes.dest | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)`| `security_content_ctime(lasttime)` | search process=*share* | `create_or_delete_windows_shares_using_net_exe_filter` '
<li><a href="#">search: '| tstats `security_content_summariesonly` count values(registry.registry_key_name) as registry_key_name values(registry.registry_path) as registry_path min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.registry where registry.registry_path="*mscfile\\shell\\open\\command\\*" by _time span=1h registry.dest registry.user registry.registry_path registry.registry_value_name registry.process_guid registry.registry_key_name registry.registry_value_data | `drop_dm_object_name(registry)` |rename process_guid as proc_guid |join proc_guid, _time [| tstats `security_content_summariesonly` count from datamodel=endpoint.processes by _time span=1h processes.process_id processes.process_name processes.process processes.dest processes.parent_process_name processes.parent_process processes.process_guid | `drop_dm_object_name(processes)` |rename process_guid as proc_guid | fields _time dest user parent_process_name parent_process process_name process_path process proc_guid registry_path registry_value_name registry_value_data registry_key_name] | table _time dest user parent_process_name parent_process process_name process_path process proc_guid registry_path registry_value_name registry_value_data registry_key_name | `eventvwr_uac_bypass_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count values(web.url) as url min(_time) as firsttime from datamodel=web where web.status=200 by web.src web.dest web.status | `drop_dm_object_name("web")` | `security_content_ctime(firsttime)` | `dynamic_dns_web_traffic` | `detect_web_traffic_to_dynamic_domain_providers_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` count, values(dns.dest) as dest dc(dns.dest) as dest_count from datamodel=network_resolution where dns.message_type=query by dns.src | `drop_dm_object_name("network_resolution")` |where dest_count > 5 | `clients_connecting_to_multiple_dns_servers_filter` '
<li><a href="#">search: '| tstats `security_content_summariesonly` dc("dns.query") as count from datamodel=network_resolution where nodename=dns "dns.message_type"="query" not (`cim_corporate_web_domain_search("dns.query")`) not "dns.query"="*.in-addr.arpa" not ("dns.src_category"="svc_infra_dns" or "dns.src_category"="svc_infra_webproxy" or "dns.src_category"="svc_infra_email*" ) by "dns.src","dns.query" | rename "dns.src" as src "dns.query" as message | eval length=len(message) | stats sum(length) as length by src | append [ tstats `security_content_summariesonly` dc("dns.answer") as count from datamodel=network_resolution where nodename=dns "dns.message_type"="query" not (`cim_corporate_web_domain_search("dns.query")`) not "dns.query"="*.in-addr.arpa" not ("dns.src_category"="svc_infra_dns" or "dns.src_category"="svc_infra_webproxy" or "dns.src_category"="svc_infra_email*" ) by "dns.src","dns.answer" | rename "dns.src" as src "dns.answer" as message | eval message=if(message=="unknown","", message) | eval length=len(message) | stats sum(length) as length by src ] | stats sum(length) as length by src | where length > 10000 | `detection_of_dns_tunnels_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` distinct_count(processes.process) as distinct_cmdlines values(processes.process_id) as process_ids min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process_name = "sc.exe" and processes.process="*start= disabled*" by processes.dest processes.user processes.parent_process processes.process_name processes.parent_process_id, _time span=30m | where distinct_cmdlines >= 8 | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `excessive_number_of_service_control_start_as_disabled_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` earliest(_time) as start_time latest(_time) as end_time values(all_traffic.action) as action values(all_traffic.app) as app values(all_traffic.dest_ip) as dest_ip values(all_traffic.dest_port) as dest_port values(sourcetype) as sourcetype count from datamodel=network_traffic where ((all_traffic.dest_port=139 or all_traffic.dest_port=445 or all_traffic.app="smb") and not (all_traffic.action="blocked" or all_traffic.dest_category="internal" or all_traffic.dest_ip=10.0.0.0/8 or all_traffic.dest_ip=172.16.0.0/12 or all_traffic.dest_ip=192.168.0.0/16 or all_traffic.dest_ip=100.64.0.0/10)) by all_traffic.src_ip | `drop_dm_object_name("all_traffic")` | `security_content_ctime(start_time)` | `security_content_ctime(end_time)` | `detect_outbound_smb_traffic_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` earliest(_time) as starttime latest(_time) as endtime latest(sourcetype) as sourcetype values(authentication.src) as src values(authentication.dest) as dest count from datamodel=authentication where nodename=authentication.failed_authentication by "authentication.user" | `drop_dm_object_name(authentication)` | lookup ut_shannon_lookup word as user | where ut_shannon>3 and len(user)>=8 and mvcount(src) == 1 | sort count, - ut_shannon | eval incorrect_cred=user | eval endtime=endtime+1000 | map maxsearches=70 search="| tstats `security_content_summariesonly` earliest(_time) as starttime latest(_time) as endtime latest(sourcetype) as sourcetype values(authentication.src) as src values(authentication.dest) as dest count from datamodel=authentication where nodename=authentication.successful_authentication authentication.src=\"$src$\" authentication.dest=\"$dest$\" sourcetype in (\"$sourcetype$\") earliest=\"$starttime$\" latest=\"$endtime$\" by \"authentication.user\" | `drop_dm_object_name(\"authentication\")` | `potential_password_in_username_false_positive_reduction` | eval incorrect_cred=\"$incorrect_cred$\" | eval ut_shannon=\"$ut_shannon$\" | sort count" | where user!=incorrect_cred | outlier action=rm count | `potential_password_in_username_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` min(_time) as firsttime max(_time) as lasttime count latest(filesystem.user) as user values(filesystem.file_path) as file_path from datamodel=endpoint.filesystem by filesystem.file_name filesystem.dest _time span=1h | `drop_dm_object_name(filesystem)` | rex field=file_name "(?<file_extension>\.[^\.]+)$" | rex field=file_path "(?<true_file_path>([^\\\]*\\\)*).*" | stats min(firsttime) as firsttime max(lasttime) as lasttime latest(user) as user dc(true_file_path) as path_count dc(file_name) as file_count latest(file_name) as file_name latest(true_file_path) as file_path by dest file_extension | `security_content_ctime(lasttime)` | `security_content_ctime(firsttime)` | `ransomware_extensions` | where path_count > 1 or file_count > 20 | `common_ransomware_extensions_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where (processes.process_name = explorer.exe or processes.original_file_name = explorer.exe) and not (processes.parent_process_name in("userinit.exe", "svchost.exe")) processes.process in ("* http://*", "* https://*") by processes.parent_process_name processes.parent_process processes.process_name processes.original_file_name processes.process processes.process_id processes.parent_process_id processes.dest processes.user | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `windows_ingress_tool_transfer_using_explorer_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where `process_cmd` and processes.process="* /c *" by processes.dest processes.user processes.parent_process processes.process_name processes.original_file_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `cmd_carry_out_string_command_parameter_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process_name = cmd.exe processes.process = "* /c *" by processes.process processes.process_name processes.parent_process_name processes.dest| `drop_dm_object_name(processes)`| `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | search [| tstats `security_content_summariesonly` earliest(_time) as firsttime latest(_time) as lasttime from datamodel=endpoint.processes where processes.process_name = cmd.exe processes.process = "* /c *" by processes.process | `drop_dm_object_name(processes)` | inputlookup append=t previously_seen_cmd_line_arguments | stats min(firsttime) as firsttime, max(lasttime) as lasttime by process | outputlookup previously_seen_cmd_line_arguments | eval newcmdlineargument=if(firsttime >= relative_time(now(), "-70m@m"), 1, 0) | where newcmdlineargument=1 | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | table process] | `first_time_seen_command_line_argument_filter` '
<li><a href="#">search: '| tstats `security_content_summariesonly` min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process_name=outlook.exe or processes.process_name=explorer.exe by _time span=5m processes.parent_process_id processes.process_id processes.dest processes.process_name processes.parent_process_name processes.user | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | rename process_id as malicious_id| rename parent_process_id as outlook_id| join malicious_id type=inner[| tstats `security_content_summariesonly` count values(filesystem.file_path) as file_path values(filesystem.file_name) as file_name from datamodel=endpoint.filesystem where (filesystem.file_path=*zip* or filesystem.file_name=*.lnk ) and (filesystem.file_path=c:\\users* or filesystem.file_path=*local\\temp*) by _time span=5m filesystem.process_id filesystem.file_hash filesystem.dest | `drop_dm_object_name(filesystem)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | rename process_id as malicious_id| fields malicious_id outlook_id dest file_path file_name file_hash count file_id] | table firsttime lasttime user malicious_id outlook_id process_name parent_process_name file_name file_path | where file_name != "" | `detect_outlook_exe_writing_a_zip_file_filter` '
<li><a href="#">search: '| tstats `security_content_summariesonly` min(_time) as firsttime max(_time) as lasttime sum(all_risk.calculated_risk_score) as risk_score, count(all_risk.calculated_risk_score) as risk_event_count, values(all_risk.annotations.mitre_attack.mitre_tactic_id) as annotations.mitre_attack.mitre_tactic_id, dc(all_risk.annotations.mitre_attack.mitre_tactic_id) as mitre_tactic_id_count, values(all_risk.analyticstories) as analyticstories values(all_risk.annotations.mitre_attack.mitre_technique_id) as annotations.mitre_attack.mitre_technique_id, dc(all_risk.annotations.mitre_attack.mitre_technique_id) as mitre_technique_id_count, values(all_risk.tag) as tag, values(source) as source, dc(source) as source_count dc(all_risk.analyticstories) as dc_analyticstories from datamodel=risk.all_risk where all_risk.analyticstories in ("proxynotshell","proxyshell", "cobalt strike") all_risk.risk_object_type="system" by _time span=1h all_risk.risk_object all_risk.risk_object_type | `drop_dm_object_name(all_risk)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | where dc_analyticstories >= 5 | `proxyshell_proxynotshell_behavior_detected_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` min(_time) as firsttime max(_time) as lasttime sum(all_risk.calculated_risk_score) as risk_score, count(all_risk.calculated_risk_score) as risk_event_count, values(all_risk.annotations.mitre_attack.mitre_tactic_id) as annotations.mitre_attack.mitre_tactic_id, dc(all_risk.annotations.mitre_attack.mitre_tactic_id) as mitre_tactic_id_count, values(all_risk.annotations.mitre_attack.mitre_technique_id) as annotations.mitre_attack.mitre_technique_id, dc(all_risk.annotations.mitre_attack.mitre_technique_id) as mitre_technique_id_count, values(all_risk.tag) as tag, values(source) as source, dc(source) as source_count from datamodel=risk.all_risk where (all_risk.analyticstories in ("linux privilege escalation", "linux persistence techniques") or source = "*linux*") all_risk.annotations.mitre_attack.mitre_tactic in ("persistence", "privilege-escalation") all_risk.risk_object_type="system" by all_risk.risk_object all_risk.risk_object_type all_risk.annotations.mitre_attack.mitre_tactic | `drop_dm_object_name(all_risk)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | where source_count >= 4 | `linux_persistence_and_privilege_escalation_risk_behavior_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` min(_time) as firsttime max(_time) as lasttime sum(all_risk.calculated_risk_score) as risk_score, count(all_risk.calculated_risk_score) as risk_event_count, values(all_risk.annotations.mitre_attack.mitre_tactic_id) as annotations.mitre_attack.mitre_tactic_id, dc(all_risk.annotations.mitre_attack.mitre_tactic_id) as mitre_tactic_id_count, values(all_risk.annotations.mitre_attack.mitre_technique_id) as annotations.mitre_attack.mitre_technique_id, dc(all_risk.annotations.mitre_attack.mitre_technique_id) as mitre_technique_id_count, values(all_risk.tag) as tag, values(source) as source, dc(source) as source_count from datamodel=risk.all_risk where all_risk.analyticstories="living off the land" all_risk.risk_object_type="system" by all_risk.risk_object all_risk.risk_object_type all_risk.annotations.mitre_attack.mitre_tactic | `drop_dm_object_name(all_risk)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | where source_count >= 5 | `living_off_the_land_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` min(_time) as firsttime max(_time) as lasttime sum(all_risk.calculated_risk_score) as risk_score, count(all_risk.calculated_risk_score) as risk_event_count, values(all_risk.annotations.mitre_attack.mitre_tactic_id) as annotations.mitre_attack.mitre_tactic_id, dc(all_risk.annotations.mitre_attack.mitre_tactic_id) as mitre_tactic_id_count, values(all_risk.annotations.mitre_attack.mitre_technique_id) as annotations.mitre_attack.mitre_technique_id, dc(all_risk.annotations.mitre_attack.mitre_technique_id) as mitre_technique_id_count, values(all_risk.tag) as tag, values(source) as source, dc(source) as source_count from datamodel=risk.all_risk where all_risk.analyticstories="log4shell cve-2021-44228" all_risk.risk_object_type="system" by all_risk.risk_object all_risk.risk_object_type all_risk.annotations.mitre_attack.mitre_tactic | `drop_dm_object_name(all_risk)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | where source_count >= 2 | `log4shell_cve_2021_44228_exploitation_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` min(_time) as firsttime values(processes.parent_process_name) as parent_process_name values(processes.parent_process_id) as parent_process_id values(processes.process_name) as process_name values(processes.process) as process from datamodel=endpoint.processes where (processes.parent_process_name=zoom.exe or processes.parent_process_name=zoom.us) by processes.process_id processes.dest | `drop_dm_object_name(processes)` | lookup zoom_first_time_child_process dest as dest process_name as process_name output firsttimeseen | where isnull(firsttimeseen) or firsttimeseen > relative_time(now(), "`previously_seen_zoom_child_processes_window`") | `security_content_ctime(firsttime)` | table firsttime dest, process_id, process_name, parent_process_id, parent_process_name |`first_time_seen_child_process_of_zoom_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` sum(all_traffic.bytes_in) as bytes_in from datamodel=network_traffic where all_traffic.dest_category=email_server by all_traffic.src_ip _time span=1d | `drop_dm_object_name("all_traffic")` | eventstats avg(bytes_in) as avg_bytes_in stdev(bytes_in) as stdev_bytes_in | eventstats count as num_data_samples avg(eval(if(_time < relative_time(now(), "@d"), bytes_in, null))) as per_source_avg_bytes_in stdev(eval(if(_time < relative_time(now(), "@d"), bytes_in, null))) as per_source_stdev_bytes_in by src_ip | eval minimum_data_samples = 4, deviation_threshold = 3 | where num_data_samples >= minimum_data_samples and bytes_in > (avg_bytes_in + (deviation_threshold * stdev_bytes_in)) and bytes_in > (per_source_avg_bytes_in + (deviation_threshold * per_source_stdev_bytes_in)) and _time >= relative_time(now(), "@d") | eval num_standard_deviations_away_from_server_average = round(abs(bytes_in - avg_bytes_in) / stdev_bytes_in, 2), num_standard_deviations_away_from_client_average = round(abs(bytes_in - per_source_avg_bytes_in) / per_source_stdev_bytes_in, 2) | table src_ip, _time, bytes_in, avg_bytes_in, per_source_avg_bytes_in, num_standard_deviations_away_from_server_average, num_standard_deviations_away_from_client_average | `hosts_receiving_high_volume_of_network_traffic_from_email_server_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` sum(all_traffic.bytes_out) as bytes_out from datamodel=network_traffic where all_traffic.src_category=email_server by all_traffic.dest_ip _time span=1d | `drop_dm_object_name("all_traffic")` | eventstats avg(bytes_out) as avg_bytes_out stdev(bytes_out) as stdev_bytes_out | eventstats count as num_data_samples avg(eval(if(_time < relative_time(now(), "@d"), bytes_out, null))) as per_source_avg_bytes_out stdev(eval(if(_time < relative_time(now(), "@d"), bytes_out, null))) as per_source_stdev_bytes_out by dest_ip | eval minimum_data_samples = 4, deviation_threshold = 3 | where num_data_samples >= minimum_data_samples and bytes_out > (avg_bytes_out + (deviation_threshold * stdev_bytes_out)) and bytes_out > (per_source_avg_bytes_out + (deviation_threshold * per_source_stdev_bytes_out)) and _time >= relative_time(now(), "@d") | eval num_standard_deviations_away_from_server_average = round(abs(bytes_out - avg_bytes_out) / stdev_bytes_out, 2), num_standard_deviations_away_from_client_average = round(abs(bytes_out - per_source_avg_bytes_out) / per_source_stdev_bytes_out, 2) | table dest_ip, _time, bytes_out, avg_bytes_out, per_source_avg_bytes_out, num_standard_deviations_away_from_server_average, num_standard_deviations_away_from_client_average | `email_servers_sending_high_volume_traffic_to_hosts_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` values(all_changes.result_id) as result_id count min(_time) as firsttime max(_time) as lasttime from datamodel=change where all_changes.result_id=4720 by all_changes.user all_changes.dest all_changes.result all_changes.action | `drop_dm_object_name("all_changes")` | `security_content_ctime(lasttime)` | `security_content_ctime(firsttime)` | `windows_create_local_account_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` values(all_changes.result_id) as result_id count min(_time) as firsttime max(_time) as lasttime from datamodel=change where all_changes.result_id=4720 or all_changes.result_id=4726 by _time span=4h all_changes.user all_changes.dest | `security_content_ctime(lasttime)` | `security_content_ctime(firsttime)` | `drop_dm_object_name("all_changes")` | search result_id = 4720 result_id=4726 | transaction user connected=false maxspan=240m | table firsttime lasttime count user dest result_id | `short_lived_windows_accounts_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` values(dns.answer) as ips min(_time) as firsttime max(_time) as lasttime from datamodel=network_resolution by dns.src, dns.query | `drop_dm_object_name("dns")` | rename query as domain | fields ips, src, domain, firsttime, lasttime | apply pretrained_dga_model_dsdl | rename pred_dga_proba as dga_score | where dga_score>0.5 | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | table src, domain, ips, firsttime, lasttime, dga_score | `detect_dga_domains_using_pretrained_model_in_dsdl_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` values(filesystem.file_name) as deletedfilenames values(filesystem.file_path) as deletedfilepath dc(filesystem.file_path) as numofdelfilepath count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.filesystem where filesystem.action=deleted filesystem.file_path = "/boot/*" by _time span=1h filesystem.dest filesystem.process_guid filesystem.action | `drop_dm_object_name(filesystem)` |rename process_guid as proc_guid |join proc_guid, _time [ | tstats `security_content_summariesonly` count from datamodel=endpoint.processes where processes.parent_process_name != unknown not (processes.parent_process_name in ("/usr/bin/dpkg", "*usr/bin/python*", "*/usr/bin/apt-*", "/bin/rm", "*splunkd", "/usr/bin/mandb")) by _time span=1h processes.process_id processes.process_name processes.process processes.dest processes.parent_process_name processes.parent_process processes.process_path processes.process_guid | `drop_dm_object_name(processes)` |rename process_guid as proc_guid | fields _time dest user parent_process_name parent_process process_name process_path process proc_guid registry_path registry_value_name registry_value_data registry_key_name action] | table process_name process proc_guid action _time deletedfilenames deletedfilepath numofdelfilepath parent_process_name parent_process process_path dest user | where numofdelfilepath >= 200 | `linux_high_frequency_of_file_deletion_in_boot_folder_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` values(filesystem.file_name) as deletedfilenames values(filesystem.file_path) as deletedfilepath dc(filesystem.file_path) as numofdelfilepath count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.filesystem where filesystem.action=deleted filesystem.file_path = "/etc/*" by _time span=1h filesystem.dest filesystem.process_guid filesystem.action | `drop_dm_object_name(filesystem)` |rename process_guid as proc_guid |join proc_guid, _time [ | tstats `security_content_summariesonly` count from datamodel=endpoint.processes where processes.parent_process_name != unknown not (processes.parent_process_name in ("/usr/bin/dpkg", "*usr/bin/python*", "*/usr/bin/apt-*", "/bin/rm", "*splunkd", "/usr/bin/mandb")) by _time span=1h processes.process_id processes.process_name processes.process processes.dest processes.parent_process_name processes.parent_process processes.process_path processes.process_guid | `drop_dm_object_name(processes)` |rename process_guid as proc_guid | fields _time dest user parent_process_name parent_process process_name process_path process proc_guid registry_path registry_value_name registry_value_data registry_key_name action] | table process_name process proc_guid action _time deletedfilenames deletedfilepath numofdelfilepath parent_process_name parent_process process_path dest user | where numofdelfilepath >= 200 | `linux_high_frequency_of_file_deletion_in_etc_folder_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` values(processes.process) as cmdline min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.parent_process_name = "wermgr.exe" `process_cmd` or `process_powershell` by processes.parent_process_name processes.original_file_name processes.parent_process_id processes.process_name processes.process processes.process_id processes.process_guid processes.dest processes.user | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `wermgr_process_spawned_cmd_or_powershell_process_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` values(processes.process) as cmdline values(processes.parent_process_name) as parent_process values(processes.process_name) as process_name min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.parent_process_name = "cmd.exe" or processes.parent_process_name = "powershell.exe" or processes.parent_process_name = "powershell_ise.exe" or processes.parent_process_name = "wmic.exe" processes.process_name = "vssadmin.exe" processes.process="*resize*" processes.process="*shadowstorage*" processes.process="*/maxsize*" by processes.parent_process_name processes.parent_process processes.process_name processes.process processes.dest processes.user processes.process_id processes.process_guid | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` |`security_content_ctime(lasttime)` | `resize_shadowstorage_volume_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` values(processes.process) as cmdline values(processes.parent_process_name) as parent_process values(processes.process_name) count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where (processes.process_name = "netsh.exe" or processes.original_file_name= "netsh.exe") and processes.process = "*firewall*" and processes.process = "*add*" and processes.process = "*protocol=tcp*" and processes.process = "*localport=3389*" and processes.process = "*action=allow*" by processes.dest processes.user processes.parent_process processes.process_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `windows_remote_services_allow_rdp_in_firewall_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` values(processes.process) as cmdline values(processes.parent_process_name) as parent_process values(processes.process_name) count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process_name != "*temp.dat*" processes.process = "*runrun*" or processes.process = "*temp.dat*" by processes.dest processes.user processes.parent_process processes.process_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `clop_common_exec_parameter_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` values(processes.process) as process distinct_count(processes.process) as distinct_process_count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process_path = "*\\windows\\temp\\*" by processes.dest processes.user _time span=20m | where distinct_process_count > 37 | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `excessive_distinct_processes_from_windows_temp_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` values(processes.process) as process min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where (processes.process_name = sc.exe or processes.original_file_name = sc.exe) processes.process="* delete *" by processes.dest processes.user processes.parent_process processes.process_name processes.original_file_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `windows_service_stop_by_deletion_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` values(processes.process) as process min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where (processes.process_name = shutdown.exe or processes.original_file_name = shutdown.exe) processes.process="*shutdown*" processes.process="* /l*" processes.process="* /t*" by processes.dest processes.user processes.parent_process processes.process_name processes.original_file_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `windows_system_logoff_commandline_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` values(processes.process) as process min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where (processes.process_name = shutdown.exe or processes.original_file_name = shutdown.exe) processes.process="*shutdown*" processes.process="* /r*" processes.process="* /t*" by processes.dest processes.user processes.parent_process processes.process_name processes.original_file_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `windows_system_reboot_commandline_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` values(processes.process) as process min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where (processes.process_name = shutdown.exe or processes.original_file_name = shutdown.exe) processes.process="*shutdown*" processes.process="* /s*" processes.process="* /t*" by processes.dest processes.user processes.parent_process processes.process_name processes.original_file_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `windows_system_shutdown_commandline_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` values(processes.process) as process min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where (processes.process_name="rdpwinst.exe" or processes.original_file_name="rdpwinst.exe") and processes.process in ("* -i*", "* -s*", "* -o*", "* -w*", "* -r*") by processes.dest processes.user processes.parent_process processes.process_name processes.original_file_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `windows_remote_service_rdpwinst_tool_execution_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` values(processes.process) as process min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where (processes.process_name="regedit.exe" or processes.original_file_name="regedit.exe") and processes.process="* /s *" and processes.process="*.reg*" by processes.dest processes.user processes.parent_process processes.process_name processes.original_file_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `windows_modify_registry_regedit_silent_reg_import_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` values(processes.process) as process min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where `process_net` and processes.process="* accounts *" and processes.process="* /maxpwage:unlimited" by processes.dest processes.user processes.parent_process processes.process_name processes.original_file_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `windows_valid_account_with_never_expires_password_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` values(processes.process) as process min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where `process_net` or processes.process_name = sc.exe processes.process="* stop *" by processes.dest processes.user processes.parent_process processes.process_name processes.original_file_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` |lookup security_services_lookup service as process outputnew category,
<li><a href="#">search: '| tstats `security_content_summariesonly` values(processes.process) as process min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where `process_powershell` and processes.process="*import-module applocker*" and processes.process="*set-applockerpolicy *" and processes.process="* -xmlpolicy *" by processes.dest processes.user processes.parent_process processes.process_name processes.original_file_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `windows_impair_defense_add_xml_applocker_rules_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` values(processes.process) as process min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where `process_psexec` processes.process=*accepteula* by processes.dest processes.user processes.parent_process_name processes.process_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)`| `security_content_ctime(firsttime)`| `security_content_ctime(lasttime)` | `detect_psexec_with_accepteula_flag_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` values(processes.process) as process min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where `process_rundll32` by processes.dest processes.user processes.parent_process_name processes.process_name processes.original_file_name processes.process processes.process_id processes.parent_process_id | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | where match(process,"rundll32.+\#\d+") | `rundll_loading_dll_by_ordinal_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` values(processes.process) as process min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process_name = reg.exe processes.process="*add*" processes.process="*hidden*" processes.process="*reg_dword*" by processes.process_name processes.parent_process_name processes.dest processes.user| `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` |`security_content_ctime(lasttime)`| regex process = "(/d\s+2)" | `reg_exe_used_to_hide_files_directories_via_registry_keys_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` values(processes.process) as process min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process_name = sc.exe (processes.process="* create *" or processes.process="* config *") by processes.process_name processes.parent_process_name processes.dest processes.user | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `sc_exe_manipulating_windows_services_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` values(processes.process) as process min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process_name = sdbinst.exe by processes.process_name processes.parent_process_name processes.dest processes.user | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `shim_database_installation_with_suspicious_parameters_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` values(processes.process) as process min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process_name = w32tm.exe processes.process= "* /stripchart *" processes.process= "* /computer:localhost *" processes.process= "* /period:*" processes.process= "* /dataonly *" processes.process= "* /samples:*" by processes.parent_process processes.process_name processes.original_file_name processes.process processes.process_id processes.parent_process_id processes.dest processes.user | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `windows_system_time_discovery_w32tm_delay_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` values(processes.process) as process min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process_name=schtasks.exe processes.process="*shutdown*" processes.process="*/create *" by processes.process_name processes.parent_process_name processes.dest processes.user | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `schtasks_used_for_forcing_a_reboot_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` values(processes.process) as process min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process_name=wevtutil.exe processes.process in ("* cl *", "*clear-log*") (processes.process="*system*" or processes.process="*security*" or processes.process="*setup*" or processes.process="*application*" or processes.process="*trace*") by processes.process_name processes.parent_process_name processes.dest processes.user| `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` |`security_content_ctime(lasttime)` | `suspicious_wevtutil_usage_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` values(processes.process) as process values(processes.parent_process) as parent_process values(processes.parent_process_id) as parent_process_id values(processes.process_id) as process_id dc(processes.parent_process_id) as parent_process_id_count dc(processes.process_id) as process_id_count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.parent_process_name= "cmd.exe" (processes.process_name = "notepad.exe" or processes.original_file_name= "notepad.exe") processes.parent_process = "*.bat*" by processes.parent_process_name processes.process_name processes.original_file_name processes.parent_process processes.dest processes.user _time span=30s | where parent_process_id_count>= 10 and process_id_count >=10 | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `windows_command_shell_dcrat_forkbomb_payload_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` values(processes.process) as process values(processes.parent_process) as parent_process values(processes.process_id) as process_id count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where `process_net` and (processes.process="* user *" or processes.process="*config*" or processes.process="*view /all*") by processes.process_name processes.dest processes.user processes.parent_process_name | where count >=4 | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `account_discovery_with_net_app_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` values(processes.process) as process values(processes.parent_process) as parent_process values(processes.process_id) as process_id count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where `process_net` and processes.process="*user*" and processes.process="*/active:no*" by processes.process_name processes.original_file_name processes.dest processes.user processes.parent_process_name | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `disabling_net_user_account_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` values(processes.process) as process values(processes.parent_process) as parent_process values(processes.process_id) as process_id count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where `process_net` and processes.process="*user*" and processes.process="*/delete*" by processes.process_name processes.original_file_name processes.dest processes.user processes.parent_process_name | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `deleting_of_net_users_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` values(processes.process) as process values(processes.parent_process) as parent_process values(processes.process_id) as process_id count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where `process_sdelete` by processes.process_name processes.original_file_name processes.dest processes.user processes.parent_process_name processes.parent_process | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `sdelete_application_execution_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` values(processes.process) as process values(processes.parent_process) as parent_process values(processes.process_id) as process_id count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where `process_verclsid` and processes.process="*/s*" processes.process="*/c*" and processes.process="*{*" and processes.process="*}*" by processes.process_name processes.original_file_name processes.dest processes.user processes.parent_process_name processes.parent_process | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `verclsid_clsid_execution_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` values(processes.process) as process values(processes.process_guid) as process_guid values(processes.process_name) as process_name count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process_name = "forfiles.exe" or processes.original_file_name = "forfiles.exe" by processes.parent_process_name processes.parent_process processes.dest processes.user _time span=1m | where count >=20 | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `windows_indirect_command_execution_via_series_of_forfiles_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` values(processes.process) as process values(processes.process_id) as process_id count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where (processes.process_name = "cacls.exe" or processes.process_name = "icacls.exe" or processes.process_name = "xcacls.exe") and processes.process = "*/g*" and (processes.process = "* everyone:*" or processes.process = "* system:*" or processes.process = "* s-1-1-0:*") by processes.parent_process_name processes.process_name processes.dest processes.user | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `modify_acl_permission_to_files_or_folder_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` values(processes.process) as process values(processes.process_id) as process_id count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where `process_net` by processes.process_name processes.parent_process_name processes.original_file_name processes.dest processes.user _time span=1m | where count >=10 | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `excessive_usage_of_net_app_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` values(processes.process) as process values(processes.process_id) as process_id count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where `process_net` or processes.process_name = "sc.exe" or processes.process_name = "net1.exe" and processes.process="*stop*" or processes.process="*delete*" by processes.process_name processes.original_file_name processes.parent_process_name processes.dest processes.user _time span=1m | where count >=5 | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `excessive_service_stop_attempt_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` values(processes.process) as process values(processes.process_id) as process_id count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where `process_wmic` and processes.process="*process*" and processes.process="*executablepath*" and processes.process="*delete*" by processes.parent_process_name processes.process_name processes.original_file_name processes.dest processes.user | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `process_kill_base_on_file_path_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` values(processes.process) as process values(processes.process_id) as process_id count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process_name = "icacls.exe" or processes.process_name = "cacls.exe" or processes.process_name = "xcacls.exe" and processes.process = "*/deny*" by processes.parent_process_name processes.process_name processes.dest processes.user | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `icacls_deny_command_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` values(processes.process) as process values(processes.process_id) as process_id count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process_name = "icacls.exe" or processes.process_name = "cacls.exe" or processes.process_name = "xcacls.exe" and processes.process = "*/grant*" by processes.parent_process_name processes.process_name processes.dest processes.user | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `icacls_grant_command_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` values(processes.process) as process values(processes.process_id) as process_id count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process_name = "sc.exe" and processes.process="*config*" or processes.process="*disabled*" by processes.process_name processes.parent_process_name processes.dest processes.user _time span=1m | where count >=4 | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `excessive_attempt_to_disable_services_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` values(processes.process) as process values(processes.process_id) as process_id count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process_name = "schtasks.exe" processes.process = "*/run*" by processes.process_name processes.parent_process_name processes.dest processes.user | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `schtasks_run_task_on_demand_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` values(processes.process) as process values(processes.process_id) as process_id count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process_name = "taskkill.exe" by processes.parent_process_name processes.process_name processes.dest processes.user _time span=1m | where count >=10 | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `excessive_usage_of_taskkill_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` values(processes.process) as process values(processes.process_id) as process_id values(processes.parent_process) as parent_process count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process_name = "nslookup.exe" processes.process = "*-querytype=*" or processes.process="*-qt=*" or processes.process="*-q=*" or processes.process="-type=*" or processes.process="*-retry=*" by processes.dest processes.user processes.process_name | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `dns_exfiltration_using_nslookup_app_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` values(processes.process) as process values(processes.process_id) as process_id values(processes.process_name) as process_name count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process_name = "cacls.exe" or processes.process_name = "icacls.exe" or processes.process_name = "xcacls.exe" by processes.parent_process_name processes.parent_process processes.dest processes.user _time span=1m | where count >=10 | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `excessive_usage_of_cacls_app_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` values(processes.process_id) as process_id, values(processes.parent_process_id) as parent_process_id values(processes.process) as process min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where `process_powershell` (processes.process="* -ex*" or processes.process="* bypass *") by processes.process_id, processes.user, processes.dest | `drop_dm_object_name(processes)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `malicious_powershell_process___execution_policy_bypass_filter`'
<li><a href="#">search: '| tstats `security_content_summariesonly` values(processes.process_id) as process_ids min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.processes where processes.process_name = "taskhost.exe" or processes.process_name = "taskhostex.exe" by processes.dest processes.process_name _time span=1h | `drop_dm_object_name(processes)` | eval pid_count=mvcount(process_ids) | eval taskhost_count_=if(process_name == "taskhost.exe", pid_count, 0) | eval taskhostex_count_=if(process_name == "taskhostex.exe", pid_count, 0) | stats sum(taskhost_count_) as taskhost_count, sum(taskhostex_count_) as taskhostex_count by _time, dest, firsttime, lasttime | where taskhost_count > 10 and taskhostex_count > 10 | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `excessive_number_of_taskhost_processes_filter`'
<li><a href="#">search: '| tstats count as instances_destroyed values(all_changes.object_id) as object_id from datamodel=change where all_changes.action=deleted and all_changes.status=success and all_changes.object_category=instance by all_changes.user _time span=1h | `drop_dm_object_name("all_changes")` | eval hourofday=strftime(_time, "%h") | eval hourofday=floor(hourofday/4)*4 | eval dayofweek=strftime(_time, "%w") | eval isweekend=if(dayofweek >= 1 and dayofweek <= 5, 0, 1) | join hourofday isweekend [summary cloud_excessive_instances_destroyed_v1] | where cardinality >=16 | apply cloud_excessive_instances_destroyed_v1 threshold=0.005 | rename "isoutlier(instances_destroyed)" as isoutlier | where isoutlier=1 | eval expected_upper_threshold = mvindex(split(mvindex(boundaryranges, -1), ":"), 0) | eval distance_from_threshold = instances_destroyed - expected_upper_threshold | table _time, user, instances_destroyed, expected_upper_threshold, distance_from_threshold, object_id | `abnormally_high_number_of_cloud_instances_destroyed_filter`'
<li><a href="#">search: '| tstats count as instances_launched values(all_changes.object_id) as object_id from datamodel=change where (all_changes.action=created) and all_changes.status=success and all_changes.object_category=instance by all_changes.user _time span=1h | `drop_dm_object_name("all_changes")` | eval hourofday=strftime(_time, "%h") | eval hourofday=floor(hourofday/4)*4 | eval dayofweek=strftime(_time, "%w") | eval isweekend=if(dayofweek >= 1 and dayofweek <= 5, 0, 1) | join hourofday isweekend [summary cloud_excessive_instances_created_v1] | where cardinality >=16 | apply cloud_excessive_instances_created_v1 threshold=0.005 | rename "isoutlier(instances_launched)" as isoutlier | where isoutlier=1 | eval expected_upper_threshold = mvindex(split(mvindex(boundaryranges, -1), ":"), 0) | eval distance_from_threshold = instances_launched - expected_upper_threshold | table _time, user, instances_launched, expected_upper_threshold, distance_from_threshold, object_id | `abnormally_high_number_of_cloud_instances_launched_filter`'
<li><a href="#">search: '| tstats count from datamodel=web where web.http_method in ("get") web.url in ("*.jsp?cmd=*","*j&cmd=*") by web.http_user_agent web.http_method, web.url,web.url_length web.src, web.dest sourcetype | `drop_dm_object_name("web")` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `web_jsp_request_via_url_filter`'
<li><a href="#">search: '| tstats count from datamodel=web where web.http_method in ("get") web.url in ("*tomcatwar.jsp*","*poc.jsp*","*shell.jsp*") by web.http_user_agent web.http_method, web.url,web.url_length web.src, web.dest sourcetype | `drop_dm_object_name("web")` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `spring4shell_payload_url_request_filter`'
<li><a href="#">search: '| tstats count from datamodel=web where web.http_method in ("get") web.url="*/catalog-portal/ui/oauth/verify?error=&deviceudid=*" and web.url="*freemarker.template.utility.execute*" by web.http_user_agent web.http_method, web.url,web.url_length web.src, web.dest sourcetype | `drop_dm_object_name("web")` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `vmware_workspace_one_freemarker_server_side_template_injection_filter`'
<li><a href="#">search: '| tstats count from datamodel=web where web.http_method in ("get") web.url="*deviceudid=*" and web.url in ("*java.lang.processbuilder*","*freemarker.template.utility.objectconstructor*") by web.http_user_agent web.http_method, web.url,web.url_length web.src, web.dest sourcetype | `drop_dm_object_name("web")` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `vmware_server_side_template_injection_hunt_filter`'
<li><a href="#">search: '| tstats count from datamodel=web where web.http_method in ("post") web.url="*/functionrouter*" by web.http_user_agent web.http_method, web.url,web.url_length web.src, web.dest web.status sourcetype | `drop_dm_object_name("web")` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `web_spring_cloud_function_functionrouter_filter`'
<li><a href="#">search: '| tstats count from datamodel=web where web.http_user_agent="*java*" web.http_method="get" web.url="*.class*" by web.http_user_agent web.http_method, web.url,web.url_length web.src, web.dest | `drop_dm_object_name("web")` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `java_class_file_download_by_java_user_agent_filter`'
<li><a href="#">search: '| tstats count from datamodel=web where web.url="*/mgmt/tm/util/bash*" web.http_method="post" by web.http_user_agent web.http_method, web.url,web.url_length web.src, web.dest | `drop_dm_object_name("web")` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `f5_big_ip_icontrol_rest_vulnerability_cve_2022_1388_filter`'
<li><a href="#">search: '| tstats count min(_time) as firsttime max(_time) as lasttime from datamodel=web where web.url in ("*${*", "*%2f%7b*") (web.url="*org.apache.commons.io.ioutils*" web.url="*java.lang.runtime@getruntime().exec*") or (web.url="*java.lang.runtime%40getruntime%28%29.exec*") or (web.url="*getenginebyname*" and web.url="*nashorn*" and web.url="*processbuilder*") by web.http_user_agent web.http_method, web.url,web.url_length web.src, web.dest sourcetype | `drop_dm_object_name("web")` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `confluence_unauthenticated_remote_code_execution_cve_2022_26134_filter`'
<li><a href="#">search: '| tstats count min(_time) as firsttime max(_time) as lasttime from datamodel=web where web.url in ("*/api/v2/cmdb/system/admin*") web.http_method in ("get", "put") by web.http_user_agent, web.http_method, web.url, web.url_length, web.src, web.dest, sourcetype | `drop_dm_object_name("web")` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `fortinet_appliance_auth_bypass_filter`'
<li><a href="#">search: '| tstats earliest(_time) as earliest_time latest(_time) as latest_time values(all_traffic.dest_ip) as dest_ip from datamodel=network_traffic.all_traffic where all_traffic.dest_port = 389 or all_traffic.dest_port = 636 and not (all_traffic.dest_ip = 10.0.0.0/8 or all_traffic.dest_ip=192.168.0.0/16 or all_traffic.dest_ip = 172.16.0.0/12) by all_traffic.src_ip all_traffic.dest_ip |`drop_dm_object_name("all_traffic")` | where src_ip != dest_ip | `security_content_ctime(latest_time)` | `security_content_ctime(earliest_time)` |`detect_outbound_ldap_traffic_filter`'
<li><a href="#">search: '| tstats earliest(_time) as firsttime latest(_time) as lasttime from datamodel=authentication where authentication.signature=consolelogin by authentication.user | `drop_dm_object_name(authentication)` | join user type=outer [ | inputlookup previously_seen_users_console_logins | stats min(firsttime) as earliestseen by user] | eval userstatus=if(earliestseen >= relative_time(now(), "-24h@h") or isnull(earliestseen), "first time logging into aws console", "previously seen user") | where userstatus="first time logging into aws console" | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `detect_aws_console_login_by_new_user_filter`'
<li><a href="#">search: '| tstats earliest(_time) as firsttime latest(_time) as lasttime from datamodel=authentication where authentication.signature=consolelogin by authentication.user authentication.src | iplocation authentication.src | `drop_dm_object_name(authentication)` | rename city as justseencity | table firsttime lasttime user justseencity | join user type=outer [| inputlookup previously_seen_users_console_logins | rename city as previouslyseencity | stats min(firsttime) as earliestseen by user previouslyseencity | fields earliestseen user previouslyseencity] | eval usercity=if(firsttime >= relative_time(now(), "-24h@h"), "new city","previously seen city") | where usercity = "new city" | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | table firsttime lasttime user previouslyseencity justseencity usercity | `detect_aws_console_login_by_user_from_new_city_filter`'
<li><a href="#">search: '| tstats earliest(_time) as firsttime latest(_time) as lasttime from datamodel=authentication where authentication.signature=consolelogin by authentication.user authentication.src | iplocation authentication.src | `drop_dm_object_name(authentication)` | rename country as justseencountry | table firsttime lasttime user justseencountry | join user type=outer [| inputlookup previously_seen_users_console_logins | rename country as previouslyseencountry | stats min(firsttime) as earliestseen by user previouslyseencountry | fields earliestseen user previouslyseencountry] | eval usercountry=if(firsttime >= relative_time(now(), "-24h@h"), "new country","previously seen country") | where usercountry = "new country" | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | table firsttime lasttime user previouslyseencountry justseencountry usercountry | `detect_aws_console_login_by_user_from_new_country_filter`'
<li><a href="#">search: '| tstats earliest(_time) as firsttime latest(_time) as lasttime from datamodel=authentication where authentication.signature=consolelogin by authentication.user authentication.src | iplocation authentication.src | `drop_dm_object_name(authentication)` | rename region as justseenregion | table firsttime lasttime user justseenregion | join user type=outer [| inputlookup previously_seen_users_console_logins | rename region as previouslyseenregion | stats min(firsttime) as earliestseen by user previouslyseenregion | fields earliestseen user previouslyseenregion] | eval userregion=if(firsttime >= relative_time(now(), "-24h@h"), "new region","previously seen region") | where userregion= "new region" | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | table firsttime lasttime user previouslyseenregion justseenregion userregion | `detect_aws_console_login_by_user_from_new_region_filter`'
<li><a href="#">search: '| tstats earliest(_time) as firsttime latest(_time) as lasttime values(all_changes.object_id) as dest, count from datamodel=change where all_changes.action=created by all_changes.vendor_region, all_changes.user | `drop_dm_object_name("all_changes")` | lookup previously_seen_cloud_regions vendor_region as vendor_region outputnew firsttimeseen, enough_data | eventstats max(enough_data) as enough_data | where enough_data=1 | eval firsttimeseenregion=min(firsttimeseen) | where isnull(firsttimeseenregion) or firsttimeseenregion > relative_time(now(), "-24h@h") | table firsttime, user, dest, count , vendor_region | `security_content_ctime(firsttime)` | `cloud_compute_instance_created_in_previously_unused_region_filter`'
<li><a href="#">search: '| tstats earliest(_time) as firsttime, latest(_time) as lasttime from datamodel=change where (all_changes.action=started or all_changes.action=created) all_changes.status=success by all_changes.src, all_changes.user, all_changes.object, all_changes.command | `drop_dm_object_name("all_changes")` | iplocation src | where isnotnull(city) | lookup previously_seen_cloud_provisioning_activity_sources city as city output firsttimeseen, enough_data | eventstats max(enough_data) as enough_data | where enough_data=1 | eval firsttimeseencity=min(firsttimeseen) | where isnull(firsttimeseencity) or firsttimeseencity > relative_time(now(), `previously_unseen_cloud_provisioning_activity_window`) | table firsttime, src, city, user, object, command | `cloud_provisioning_activity_from_previously_unseen_city_filter` | `security_content_ctime(firsttime)`'
<li><a href="#">search: '| tstats earliest(_time) as firsttime, latest(_time) as lasttime from datamodel=change where (all_changes.action=started or all_changes.action=created) all_changes.status=success by all_changes.src, all_changes.user, all_changes.object, all_changes.command | `drop_dm_object_name("all_changes")` | iplocation src | where isnotnull(country) | lookup previously_seen_cloud_provisioning_activity_sources country as country output firsttimeseen, enough_data | eventstats max(enough_data) as enough_data | where enough_data=1 | eval firsttimeseencountry=min(firsttimeseen) | where isnull(firsttimeseencountry) or firsttimeseencountry > relative_time(now(), "-24h@h") | table firsttime, src, country, user, object, command | `cloud_provisioning_activity_from_previously_unseen_country_filter` | `security_content_ctime(firsttime)`'
<li><a href="#">search: '| tstats earliest(_time) as firsttime, latest(_time) as lasttime from datamodel=change where (all_changes.action=started or all_changes.action=created) all_changes.status=success by all_changes.src, all_changes.user, all_changes.object, all_changes.command | `drop_dm_object_name("all_changes")` | iplocation src | where isnotnull(region) | lookup previously_seen_cloud_provisioning_activity_sources region as region output firsttimeseen, enough_data | eventstats max(enough_data) as enough_data | where enough_data=1 | eval firsttimeseenregion=min(firsttimeseen) | where isnull(firsttimeseenregion) or firsttimeseenregion > relative_time(now(), `previously_unseen_cloud_provisioning_activity_window`) | table firsttime, src, region, user, object, command | `cloud_provisioning_activity_from_previously_unseen_region_filter` | `security_content_ctime(firsttime)`'
<li><a href="#">search: '| tstats earliest(_time) as firsttime, latest(_time) as lasttime from datamodel=change where all_changes.user_type=assumedrole and all_changes.status=success by all_changes.user, all_changes.command all_changes.object | `drop_dm_object_name("all_changes")` | lookup previously_seen_cloud_api_calls_per_user_role user as user, command as command output firsttimeseen, enough_data | eventstats max(enough_data) as enough_data | where enough_data=1 | eval firsttimeseenuserapicall=min(firsttimeseen) | where isnull(firsttimeseenuserapicall) or firsttimeseenuserapicall > relative_time(now(),"-24h@h") | table firsttime, user, object, command |`security_content_ctime(firsttime)` | `security_content_ctime(lasttime)`| `cloud_api_calls_from_previously_unseen_user_roles_filter`'
<li><a href="#">search: '| tstats earliest(_time) as firsttime, latest(_time) as lasttime, values(all_changes.object_id) as object_id from datamodel=change where (all_changes.action=started or all_changes.action=created) all_changes.status=success by all_changes.src, all_changes.user, all_changes.command | `drop_dm_object_name("all_changes")` | lookup previously_seen_cloud_provisioning_activity_sources src as src output firsttimeseen, enough_data | eventstats max(enough_data) as enough_data | where enough_data=1 | eval firsttimeseensrc=min(firsttimeseen) | where isnull(firsttimeseensrc) or firsttimeseensrc > relative_time(now(), `previously_unseen_cloud_provisioning_activity_window`) | table firsttime, src, user, object_id, command | `cloud_provisioning_activity_from_previously_unseen_ip_address_filter` | `security_content_ctime(firsttime)`'
<li><a href="#">search: '|tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.filesystem where filesystem.file_name in ("*.dat") filesystem.file_path = "*\\remcos\\*" by _time filesystem.file_name filesystem.file_path filesystem.dest filesystem.file_create_time | `drop_dm_object_name(filesystem)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `remcos_rat_file_creation_in_remcos_folder_filter`'
<li><a href="#">search: '|tstats `security_content_summariesonly` count min(_time) as firsttime max(_time) as lasttime values(all_ueba_events.category) as category from datamodel=ueba where nodename=all_ueba_events.ueba_anomalies all_ueba_events.ueba_anomalies.uba_model = "suspiciousemaildetectionmodel" by all_ueba_events.
<li><a href="#">search: '|tstats `security_content_summariesonly` values(filesystem.file_path) as file_path count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.filesystem where (filesystem.file_name = "msmpeng.exe" or filesystem.file_name = "mpsvc.dll") and filesystem.file_path != "*\\program files\\windows defender\\*" by filesystem.file_create_time filesystem.process_id filesystem.file_name filesystem.user | `drop_dm_object_name(filesystem)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `msmpeng_application_dll_side_loading_filter`'
<li><a href="#">search: '|tstats `security_content_summariesonly` values(filesystem.file_path) as file_path count min(_time) as firsttime max(_time) as lasttime from datamodel=endpoint.filesystem where (filesystem.file_name = *.exe or filesystem.file_name = *.dll or filesystem.file_name = *.sys or filesystem.file_name = *.com or filesystem.file_name = *.vbs or filesystem.file_name = *.vbe or filesystem.file_name = *.js or filesystem.file_name = *.ps1 or filesystem.file_name = *.bat or filesystem.file_name = *.cmd or filesystem.file_name = *.pif) and ( filesystem.file_path = *\\windows\\fonts\\* or filesystem.file_path = *\\windows\\temp\\* or filesystem.file_path = *\\users\\public\\* or filesystem.file_path = *\\windows\\debug\\* or filesystem.file_path = *\\users\\administrator\\music\\* or filesystem.file_path = *\\windows\\servicing\\* or filesystem.file_path = *\\users\\default\\* or filesystem.file_path = *recycle.bin* or filesystem.file_path = *\\windows\\media\\* or filesystem.file_path = *\\windows\\repair\\* or filesystem.file_path = *\\appdata\\local\\temp* or filesystem.file_path = *\\perflogs\\*) by filesystem.file_create_time filesystem.process_id filesystem.file_name filesystem.user | `drop_dm_object_name(filesystem)` | `security_content_ctime(firsttime)` | `security_content_ctime(lasttime)` | `executables_or_script_creation_in_suspicious_path_filter`'
<li><a href="#">search: 'tag in (ssl, tls, certificate) ssl_issuer_common_name=*splunk* | stats values(src) as "host(s) with default cert" count by ssl_issuer ssl_subject_common_name ssl_subject_organization ssl_subject host sourcetype | `splunk_identified_ssl_tls_certificates_filter`'
<li><a href="#">selection: commandline: - '*(gp hkcu:\software).*)|iex*'
<li><a href="#">selection: commandline: - '*.downloadfile([system.text.encoding]::ascii.getstring([system.convert]::frombase64string(*'
<li><a href="#">selection: commandline: - '*/c copy /z c:\windows\syswow64\windowspowershell\v1.0\powershell.exe c:\users*' - '*/c copy /z c:\windows\syswow64\bitsadmin.exe c:\users*'
<li><a href="#">selection: commandline: - '*/c copy*\appdata\local\google\chrome\user data\default\login data*\appdata\local\temp\db1*'
<li><a href="#">selection: commandline: - '*/e:jscript*\\*.txt*' - '*/e:jscript*\\*.pdf*' - '*/e:jscript*\\*.htm*' - '*/e:jscript*\\*.png*' - '*/e:jscript*\\*.jpeg*' - '*/e:jscript*\\*.jpg*'
<li><a href="#">selection: commandline: - '*[reflection.assembly]::load((itemproperty */software*' - '*[system.threading.thread]::getdomain().load((itemproperty hk*'
<li><a href="#">selection: commandline: - '*\mshta.exe*pastebin.com\\*' - '*mshta.exe*pastebin.com\raw*'
<li><a href="#">selection: commandline: - '*\powershell*downloadfile((*),$*))*start-process $*' - '*.downloadfile*start-process*' - '*invoke-expression(new-object net.webclient*.invoke*'
<li><a href="#">selection: commandline: - '*\powershell.exe* $* = [string][system.text.encoding]::ascii.getstring([system.convert]::frombase64string(*;iex $*' - '*frombase64string(*;iex (*' - '*frombase64string(*start-process $*' - '*iex ([system.text.encoding]::ascii.getstring([system.convert]::frombase64string(*' - '*invoke-expression $(new-object io.streamreader ($(new-object io.compression.deflatestream ($(new-object io.memorystream (,$([convert]::frombase64string(*' - '*:frombase64string(*iex $*' - '*.processstartinfo*::frombase64string*'
<li><a href="#">selection: commandline: - '*\powershell.exe* iex *((new-object net.webclient).downloadstring(*' - '*powershell*[string][char[]]@(0x*set-alias*net.webclient*.downloadstring(*' - '*powershell*iex (new-object system.net.webclient).downloadstring*' - '*iex ( [string][system.text.encoding]::ascii.getstring([system.convert]::frombase64string( ((new-object net.webclient).downloadstring(*' - '*powershell*.downloadfile([system.text.encoding]::ascii.getstring([system.convert]::frombase64string(*>&*' - '*iex (new-object net.webclient).downloadstring(*' - '*powershell -command iex (*downloadstring*' - '*iex (new-object net.webclient).downloadfile(*' - '*powershell*-command*iex(*http*' - '*-command iex (new-object*downloadstring*' - '*$path*iex(*.web*-replace*' - '*iex ((new-object system.net.webclient).downloadstring(*' - '*powershell*.webclient)*iex*' - '*iex(new-object net.webclient).downloadstring(*' - '*iex ((new-object net.webclient).downloadstring(*' - '*http*.replace(*iex*'
<li><a href="#">selection: commandline: - '*\programdata\1.exe /urlcache /f http*.php?*.cab c:\programdata\1.tmp*'
<li><a href="#">selection: commandline: - '*\public\\*.com *\\*.html*'
<li><a href="#">selection: commandline: - '*\schtasks.exe* /create *wscript /e:vbscript *\appdata\roaming\\*' - '*schtasks /create *\appdata\roaming\\*.vbs*' - '*schtasks /create *\appdata\roaming\\*.js*'
<li><a href="#">selection: commandline: - '*\system32\regsvr32.exe /s /n /u /i:*\appdata\roaming\\* scrobj*'
<li><a href="#">selection: commandline: - '*\windows\microsoft.net\framework*\csc.exe*/noconfig /fullpaths*\appdata\local\temp*'
<li><a href="#">selection: commandline: - '*\windows\microsoft.net\framework\v**msbuild.exe*\appdata\local\temp\\*.xml*'
<li><a href="#">selection: commandline: - '*add-mppreference -exclusionpath*-exclusionextension*-exclusionprocess*'
<li><a href="#">selection: commandline: - '*-algo=* -o *miner* -u*' - '*cryptonight --url=xmr.*' - '*stratum+tcp://*' - '*--algo=cn*-o * -u *' - '*--coin=monero --*' - '*-o pool.*--nicehash*' - '*--pool stratum:*' - '*--background --donate-level 1 --nicehash*' - '*-o * -u * -p w=a -k -a*' - '* -u * -p x --max-cpu-usage*' - '*--donate-level=*--max-cpu-usage=*' - '*-p stratum1+ssl://* -r --response-timeout*' - '*-o pool.* --cpu-max-threads-hint*' - '*--donate-level * -o pool.*' - '*--cpu-memory-pool=*--donate-level=*' - '*--pool=stratum:*--cinit-max-gpu=*' - '*-o xmr.* -u * -p*' - '*-epool * -ewal * -worker*' - '*-o * -u * --donate-level=*' - '*--cinit-find-e --pool=stratums://*' - '*-o * -u * -p x *' - '*pool.minexmr.*-max-threads-*' - '*--cinit-find-*.nanopool.*' - '*--cinit-find-*--url=*' - '*--url pool* --donate-level*' - '*--user *--donate-level*' - '*-p w=rig -a cn-heavy/xhv -k -o*' - '*-o * -u * --tls*' - '*--user*--server*--algo*'
<li><a href="#">selection: commandline: - '*attrib +s +h *timeout /t *del /f /q*'
<li><a href="#">selection: commandline: - '*bitsadmin /transfer*http*start %appdata%*' - '*/transfer*http*.dll&& rundll32*' - '*powershell*start-bitstransfer*start-process*' - '*bitsadmin /transfer*|iex*'
<li><a href="#">selection: commandline: - '*c:\programdata\curl.com /urlcache /f http*' - '*programdata\\*.exe -urlcache -f -split http*'
<li><a href="#">selection: commandline: - '*certutil*-decodehex*.dll*'
<li><a href="#">selection: commandline: - *chcp 437 & schtasks /query /tn k0adic* - *chcp 437 & schtasks /create /tn k0adic*
<li><a href="#">selection: commandline: - *cmd /c wscript.exe *\appdata\local\temp*/wp-data/*
<li><a href="#">selection: commandline: - '*cmd*net stop*& net stop*& net stop*& net stop*& net stop*& net stop*& net stop*' - '*sc stop *sc stop *sc stop *sc stop *'
<li><a href="#">selection: commandline: - '*cmd*taskkill /f*& taskkill /f*& taskkill /f*& taskkill /f*& taskkill /f*& taskkill /f*& taskkill /f*'
<li><a href="#">selection: commandline: - '*cmd*type*>*\appdata*'
<li><a href="#">selection: commandline: - '*copy-item *\roaming\microsoft\windows\start menu\programs\startup*'
<li><a href="#">selection: commandline: - '*findstr /b /i *.lnk*'
<li><a href="#">selection: commandline: - '*hkcu\software\tektonit\remote manipulator system\host*'
<li><a href="#">selection: commandline: - '*ilzpcnr1ywxcb3h8vk13yxjlfetwtxxivk0i*'
<li><a href="#">selection: commandline: - '*msiexec*/i http* /q onload=*' - '*m^sie^xec /ih^tt^p*>*' - '*m^s^ie^xec /ih^tt^p^*' - '*msiexec /q/ihttp*' - '*msiexec /i http* /qn*'
<li><a href="#">selection: commandline: - '*netsh* wlan show profile*' - '*netsh wlan show profile*'
<li><a href="#">selection: commandline: - '*ping -n * & powershell.exe -executionpolicy bypass -noninteractive -windowstyle hidden*'
<li><a href="#">selection: commandline: - *powershell -c sleep -s *;saps *.exe*
<li><a href="#">selection: commandline: - '*powershell*.createshortcut(*\appdata\roaming\microsoft\windows\start menu\programs\startup*'
<li><a href="#">selection: commandline: - '*powershell*[reflection.assembly]::load((new-object net.webclient).downloaddata(*'
<li><a href="#">selection: commandline: - '*powershell*[wmiclass]*'
<li><a href="#">selection: commandline: - '*powershell*add-mppreference -exclusionpath c:\programdata*' - '*add-mppreference -exclusionpath*\appdata\roaming\microsoft\windows\start menu\programs\startup*'
<li><a href="#">selection: commandline: - '*powershell*api.ipify.org*' - '*invoke-webrequest -uri https://iplogger*'
<li><a href="#">selection: commandline: - '*powershell*downloadfile*/tinyurl.*' - '*powershell*downloadfile*/bitly.*' - '*powershell*downloadfile*/shorturl.*' - '*powershell*downloadfile*/rebrandly.*' - '*powershell*downloadfile*/cutt.*' - '*powershell*downloadfile*/rebrand.*' - '*powershell*downloadfile*/bit.ly*' - '*powershell*new-object net.*https://tinyurl.*' - '*powershell*new-object net.*https://bitly.*' - '*powershell*new-object net.*https://shorturl.*' - '*powershell*new-object net.*https://rebrandly.*' - '*powershell*new-object net.*https://cutt.*' - '*powershell*new-object net.*https://rebrand.*' - '*powershell*new-object net.*https://bit.ly*' - '*powershell*net.web*https://tinyurl.* - '*powershell*net.web*https://bitly.* - '*powershell*net.web*https://shorturl.* - '*powershell*net.web*https://rebrandly.* - '*powershell*net.web*https://cutt.*' - '*powershell*net.web*https://rebrand.*' - '*powershell*net.web*https://bit.ly*' - '*powershell*invoke*tinyurl.*' - '*powershell*invoke*bitly.*' - '*powershell*invoke*shorturl.*' - '*powershell*invoke*rebrandly.*' - '*powershell*invoke*cutt.*' - '*powershell*invoke*rebrand.*' - '*powershell*invoke*bit.ly*'
<li><a href="#">selection: commandline: - '*powershell*downloadstring(*.load([convert]::frombase64string(*' - '*).downloadstring(*[reflection.assembly]::load($*' - '*invoke-webrequest*[system.reflection.assembly]::loadfile($*'
<li><a href="#">selection: commandline: - '*powershell*foreach*(*http*http*'
<li><a href="#">selection: commandline: - '*powershell*iex(get-itemproperty hkcu*' - '*powershell*iex(get-itemproperty khlm*' - '*powershell*iex*::ascii.getstring(( gp*hkcu:*'
<li><a href="#">selection: commandline: - *powershell*regsvr32*
<li><a href="#">selection: commandline: - '*powershell*rwblahqalqbxag0aaqbpagiaagblagmadaagafcaaqbuadmamgbfafmaaabhagqabwb3agmabwbwahkaiab8acaargbvahiarqbhagmaaaatae8aygbqaguaywb0acaaewakaf8algbeaguabablahqazqaoackaowb9aa==*'
<li><a href="#">selection: commandline: - '*powershell*suvykchuzxctb2jqzwn0ig5ldc53zwjjbgllbnqplmrvd25sb2fkc3ryaw5nk*'
<li><a href="#">selection: commandline: - '*powershell*wscript.shell*.run(*wscript.exe /e:*'
<li><a href="#">selection: commandline: - '*r2v0lvvjq3vsdhvyzskutmftzsatbwf0y2ggiknoffjpffjvffvbfejzi*'
<li><a href="#">selection: commandline: - '*reg add *\software\microsoft\windows\currentversion\run /v *\appdata\roaming\\*.jar*'
<li><a href="#">selection: commandline: - '*reg add *\windows\currentversion\run /f /v *\appdata\roaming*' - '*reg add *\windows\currentversion\run /v *\appdata\local*' - '*reg add *\software\microsoft\windows nt\currentversion\windows*/v load*appdata\roaming*'
<li><a href="#">selection: commandline: - '*reg add*\microsoft\windows\currentversion\run*\system32\regsvr32*'
<li><a href="#">selection: commandline: - '*reg add*hkcu\software\classes\ms-settings\shell\open\command*'
<li><a href="#">selection: commandline: - '*regsvr32*/s /u /n /i:http*scrobj*'
<li><a href="#">selection: commandline: - '*regsvr32*\\*.tmp*'
<li><a href="#">selection: commandline: - '*regsvr32*http*scrobj*'
<li><a href="#">selection: commandline: - '*rundll32*.html,dllregisterserver*' - '*regsvr32*\\*.jpg* - '*regsvr32*\\*.png* - '*regsvr32*\\*.jpeg* - '*regsvr32*\\*.pdf* - '*regsvr32*\\*.txt*'
<li><a href="#">selection: commandline: - '*rundll32*.html,dllregisterserver*' - '*rundll32*.htm,dllregisterserver*' - '*rundll32*.txt,dllregisterserver*' - '*rundll32*.png,dllregisterserver*' - '*rundll32*.jpeg,dllregisterserver*' - '*rundll32*.jpg,dllregisterserver*' - '*rundll32 c:\programdata\\*.pdf*' - '*rundll32 c:\programdata\\*.txt*' - '*rundll32 c:\programdata\\*.jpg*' - '*rundll32 c:\programdata\\*.png*' - '*rundll32 c:\programdata\\*.jpeg*' - '*rundll32 c:\users\public\\*.pdf*' - '*rundll32 c:\users\public\\*.txt*' - '*rundll32 c:\users\public\\*.jpg*' - '*rundll32 c:\users\public\\*.png*' - '*rundll32 c:\users\public\\*.jpeg*' - '*rundll32*\\*.pdf*' - '*rundll32*\\*.txt*' - '*rundll32*\\*.jpg*' - '*rundll32*\\*.png*' - '*rundll32*\\*.jpeg*' - '*rundll32*\\*.dat*' selection1: - '*rundll32*.data*'
<li><a href="#">selection: commandline: - '*rundll32*\appdata\local\temp\\*.txt*'
<li><a href="#">selection: commandline: - '*rundll32*http*'
<li><a href="#">selection: commandline: - '*rundll32*mshta*script:http*'
<li><a href="#">selection: commandline: - '*schtasks /create * certutil*'
<li><a href="#">selection: commandline: - '*schtasks /create*:\windows\microsoft.net*'
<li><a href="#">selection: commandline: - '*schtasks /create*svchost*' - '*schtasks /create*rundll32*' - '*schtasks /create*powershell*' - '*schtasks /create*regsvr32*' - '*schtasks /create*spoolsv*' - '*schtasks /create*lsass*' - '*schtasks /create*smss*' - '*schtasks /create*csrss*' - '*schtasks /create*conhost*' - '*schtasks /create*wininit*' - '*schtasks /create*winlogon*' - '*schtasks /create*taskhost*' - '*schtasks /create*taskmgr*' - '*schtasks /create*runtimebroker*' - '*schtasks /create*smartscreen*' - '*schtasks /create*dllhost*' - '*schtasks* /create*svchost*' - '*schtasks* /create*rundll32*' - '*schtasks* /create*powershell*' - '*schtasks* /create*regsvr32*' - '*schtasks* /create*spoolsv*' - '*schtasks* /create*lsass*' - '*schtasks* /create*smss*' - '*schtasks* /create*csrss*' - '*schtasks* /create*conhost*' - '*schtasks* /create*wininit*' - '*schtasks* /create*winlogon*' - '*schtasks* /create*taskhost*' - '*schtasks* /create*taskmgr*' - '*schtasks* /create*runtimebroker*' - '*schtasks* /create*smartscreen*' - '*schtasks* /create*dllhost*'
<li><a href="#">selection: commandline: - '*schtasks /f /create */e:vbscript*'
<li><a href="#">selection: commandline: - '*schtasks*/create*/xml*\temp\\*.tmp*'
<li><a href="#">selection: commandline: - '*schtasks*/create*mshta*http*'
<li><a href="#">selection: commandline: - '*schtasks*/create*regsvr32*'
<li><a href="#">selection: commandline: - '*schtasks*limerat*'
<li><a href="#">selection: commandline: - '*schtasks*powershell -ep bypass -e *'
<li><a href="#">selection: commandline: - '*schtasks*quasar client*'
<li><a href="#">selection: commandline: - *schtasks.exe*/create*powershell*hidden*
<li><a href="#">selection: commandline: - '*whoami /groups | find*12288*'
<li><a href="#">selection: commandline: - '*wmic process call create *msiexec *http*'
<li><a href="#">selection: commandline: - '*wmic process call create *msiexec /i http* /q*'
<li><a href="#">selection: commandline: - '*wmic process list /format:*.xsl*' - '*wmic os get /format:*.xsl*'
<li><a href="#">selection: commandline: - '*wmic*output:clipboard process call create*powershell*'
<li><a href="#">selection: commandline: - '*wmic*powershell*bypass*frombase64string(*decompress*'
<li><a href="#">selection: commandline: - '*wmic*process call create *regsvr32*'
<li><a href="#">selection: commandline: - '*wmic*shadowcopy delete*'
<li><a href="#">selection: commandline: -'*.dll,_reflectiveloader*' -'*.dll,reflectiveloader*'
<li><a href="#">selection: commandline: -'*powershell*downloadfile*shellexecute*'
<li><a href="#">selection: commandline: -'*wmic * path antivirusproduct get displayname*'
<li><a href="#">selection: eventid: 11 image: - '*\microsoft office*\office*\winword.exe*' - '*\microsoft office*\office*\excel.exe*' targetfilename: - '*\appdata\roaming\\*.vbs*' - '*\appdata\roaming\\*.js*' - '*\appdata\roaming\\*.jse*' - '*\appdata\roaming\\*.bat*' - '*\appdata\roaming\\*.url*' - '*\appdata\roaming\\*.cmd*' - '*\appdata\roaming\\*.hta*' - '*\appdata\roaming\\*.ps1*' - '*\appdata\local\temp\\*.vbs*' - '*\appdata\local\temp\\*.js*' - '*\appdata\local\temp\\*.jse*' - '*\appdata\local\temp\\*.bat*' - '*\appdata\local\temp\\*.url*' - '*\appdata\local\temp\\*.cmd*' - '*\appdata\local\temp\\*.hta*' - '*\appdata\local\temp\\*.ps1*' selection1: eventid: 11 image: - '*\microsoft office*\office*\winword.exe*' - '*\microsoft office*\office*\excel.exe*' targetfilename: - '*\appdata\roaming\microsoft\office\recent\\*.url*'
<li><a href="#">selection: eventid: 11 image: - '*\microsoft office*\office*\winword.exe*' - '*\microsoft office*\office*\excel.exe*' targetfilename: - '*\documents\\*.exe*' - '*\documents\\*.dll*' - '*\documents\\*.scr*'
<li><a href="#">selection: eventid: 11 image: - '*\microsoft office\office*' - '*\microsoft office\root\office*' targetfilename: '*temp\oleobject1.bin'
<li><a href="#">selection: eventid: 11 image: - '*\microsoft office\root\office*\onenote.exe' - '*\microsoft office\office*\onenote.exe' targetfilename: - '*\exported*\\*.hta' - '*\exported*\\*.lnk' - '*\exported*\\*.vbs' - '*\exported*\\*.js' - '*\exported*\\*.bat' - '*\onenoteofflinecache_files\\*.hta' - '*\onenoteofflinecache_files\\*.vbs' - '*\onenoteofflinecache_files\\*.js' - '*\onenoteofflinecache_files\\*.bat'
<li><a href="#">selection: eventid: 11 image: '*\equation\eqnedt32.exe*' targetfilename: - '*\\*.exe*' - '*\\*.dll*' - '*\\*.vbs*' - '*\\*.js*' - '*\\*.hta*' - '*\\*.bat*'
<li><a href="#">selection: eventid: 11 image: '*\microsoft office\office*\winword.exe*' targetfilename: - '*\appdata\roaming\microsoft\\*\startup\\*.vbs*' - '*\appdata\roaming\microsoft\\*\startup\\*.js*' - '*\appdata\roaming\microsoft\\*\startup\\*.bat*' - '*\appdata\roaming\microsoft\\*\startup\\*.url*' - '*\appdata\roaming\microsoft\\*\startup\\*.cmd*' - '*\appdata\roaming\microsoft\\*\startup\\*.hta*' - '*\appdata\roaming\microsoft\\*\startup\\*.ps1*'
<li><a href="#">selection: eventid: 11 image: '*\mshta.exe*' targetfilename: - '*\credwiz.exe*'
<li><a href="#">selection: eventid: 11 image: '*\powershell.exe*' targetfilename: - '*\appdata\roaming\\*\nsm.lic*'
<li><a href="#">selection: eventid: 11 targetfilename: - '*\appdata\roaming\microsoft\\*\startup\\*.wll*'
<li><a href="#">selection: eventid: 11 targetfilename: - '*\appdata\roaming\microsoft\windows\start menu\programs\startup\\*.vbs*' - '*\appdata\roaming\microsoft\windows\start menu\programs\startup\\*.js*' - '*\appdata\roaming\microsoft\windows\start menu\programs\startup\\*.jse*' - '*\appdata\roaming\microsoft\windows\start menu\programs\startup\\*.bat*' - '*\appdata\roaming\microsoft\windows\start menu\programs\startup\\*.url*' - '*\appdata\roaming\microsoft\windows\start menu\programs\startup\\*.cmd*' - '*\appdata\roaming\microsoft\windows\start menu\programs\startup\\*.hta*' - '*\appdata\roaming\microsoft\windows\start menu\programs\startup\\*.ps1*' - '*\appdata\roaming\microsoft\windows\start menu\programs\startup\\*.wsf*'
<li><a href="#">selection: eventid: 11 targetfilename: - '*\appdata\roaming\remcos\logs*.dat*' - '*\programdata\remcos\logs.dat*' selection1: eventid: 13 targetobject: - '*\software\remcos*exepath*' - '*\software\rmc-*exepath*' - '*\microsoft\windows\currentversion\run*remcos*'
<li><a href="#">selection: eventid: 11 targetfilename: - 'c:\svchost.exe' - 'c:\rundll32.exe' - 'c:\powershell.exe' - 'c:\regsvr32.exe' - 'c:\spoolsv.exe' - 'c:\lsass.exe' - 'c:\smss.exe' - 'c:\csrss.exe' - 'c:\conhost.exe' - 'c:\wininit.exe' - 'c:\winlogon.exe' - 'c:\taskhost.exe' - 'c:\taskmgr.exe' - 'c:\runtimebroker.exe' - 'c:\smartscreen.exe' - 'c:\dllhost.exe' - 'c:\services.exe'
<li><a href="#">selection: eventid: 11 targetfilename: '*\appdata\roaming\\*-*-*-*-*\run.dat*'
<li><a href="#">selection: eventid: 13 targetobject: - '*\microsoft\windows\currentversion\run*' details: - '*wscript.exe *'
<li><a href="#">selection: eventid: 13 targetobject: - '*\microsoft\windows\currentversion\run*netwire*' details: - '*\appdata\roaming\\*' selection1: eventid: 13 targetobject: - '*hkey_current_user\software\netwire*hostid*'
<li><a href="#">selection: eventid: 13 targetobject: - '*\software\mdslk*self*'
<li><a href="#">selection: eventid: 13 targetobject: - '*hkey_current_user\vjw0rm*'
<li><a href="#">selection: eventid: 13 targetobject: - '*recfg*rnd_ext*'
<li><a href="#">selection: eventid: 3 destinationport: '587' image: '*\microsoft.net\\*msbuild.exe*'
<li><a href="#">selection: eventid: 3 destinationport: '587' image: '*\microsoft.net\\*regasm.exe*'
<li><a href="#">selection: eventid: 3 destinationport: '7'
<li><a href="#">selection: eventid: 3 destinationport: '80' image: '*\equation\eqnedt32.exe*'
<li><a href="#">selection: parentcommandline: '*\\*.scr*' commandline: -'*\microsoft.net\\*\msbuild.exe*'
<li><a href="#">selection: parentcommandline: '*\powershell.exe*' commandline: -'*\wscript.exe*\appdata\roaming\microsoft\word\startup\\*'
<li><a href="#">selection: parentcommandline: '*rundll32.exe c:\\*.dll,reflectiveloader*' commandline: -'*\\*.exe*'
<li><a href="#">selection: parentimage: '*\program files\microsoft office*.exe' commandline: -'*\powershell.exe* -enco *'

</div>
<script>
function myFunction() {
var input, filter, ul, li, a, i, txtValue;
input = document.getElementById("myInput");
filter = input.value.toUpperCase();
ul = document.getElementById("myUL");
li = ul.getElementsByTagName("li");
for (i = 0; i < li.length; i++) {
a = li[i].getElementsByTagName("a")[0];
txtValue = a.textContent || a.innerText;
if (txtValue.toUpperCase().indexOf(filter) > -1) {
li[i].style.display = "";
} else {
li[i].style.display = "none";
}
}
}
</script>
<script src="hilitor.js"></script>
<script>
var myHilitor = new Hilitor("content"); // id of the element to parse
// myHilitor.setBreakRegExp(new RegExp('[^\\w\' -]+', "g")); // expanded to include spaces
myHilitor.apply();
</script>
<script>
window.addEventListener("DOMContentLoaded", function(e) {
var myHilitor2 = new Hilitor("playground");
myHilitor2.setMatchType("left");
document.getElementById("keywords").addEventListener("keyup", function(e) {
myHilitor2.apply(this.value);
}, false);
}, false);
</script>
</html>